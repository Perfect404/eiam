/*
 * eiam-console - Employee Identity and Access Management Program
 * Copyright Â© 2020-2023 TopIAM (support@topiam.cn)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
(self.webpackChunktopiam_console=self.webpackChunktopiam_console||[]).push([[7820],{81618:function(gn){"use strict";(function(Ot,ot){gn.exports=ot()})(this,function(){function Ot(lt){var tt=[];return lt.AMapUI&&tt.push(ot(lt.AMapUI)),lt.Loca&&tt.push(kt(lt.Loca)),Promise.all(tt)}function ot(lt){return new Promise(function(tt,be){var it=[];if(lt.plugins)for(var st=0;st<lt.plugins.length;st+=1)I.AMapUI.plugins.indexOf(lt.plugins[st])==-1&&it.push(lt.plugins[st]);if(xt.AMapUI===bt.failed)be("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(xt.AMapUI===bt.notload){xt.AMapUI=bt.loading,I.AMapUI.version=lt.version||I.AMapUI.version,st=I.AMapUI.version;var Ut=document.body||document.head,P=document.createElement("script");P.type="text/javascript",P.src="https://webapi.amap.com/ui/"+st+"/main.js",P.onerror=function(b){xt.AMapUI=bt.failed,be("\u8BF7\u6C42 AMapUI \u5931\u8D25")},P.onload=function(){if(xt.AMapUI=bt.loaded,it.length)window.AMapUI.loadUI(it,function(){for(var b=0,W=it.length;b<W;b++){var fe=it[b].split("/").slice(-1)[0];window.AMapUI[fe]=arguments[b]}for(tt();K.AMapUI.length;)K.AMapUI.splice(0,1)[0]()});else for(tt();K.AMapUI.length;)K.AMapUI.splice(0,1)[0]()},Ut.appendChild(P)}else xt.AMapUI===bt.loaded?lt.version&&lt.version!==I.AMapUI.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):it.length?window.AMapUI.loadUI(it,function(){for(var b=0,W=it.length;b<W;b++){var fe=it[b].split("/").slice(-1)[0];window.AMapUI[fe]=arguments[b]}tt()}):tt():lt.version&&lt.version!==I.AMapUI.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):K.AMapUI.push(function(b){b?be(b):it.length?window.AMapUI.loadUI(it,function(){for(var W=0,fe=it.length;W<fe;W++){var Ee=it[W].split("/").slice(-1)[0];window.AMapUI[Ee]=arguments[W]}tt()}):tt()})})}function kt(lt){return new Promise(function(tt,be){if(xt.Loca===bt.failed)be("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(xt.Loca===bt.notload){xt.Loca=bt.loading,I.Loca.version=lt.version||I.Loca.version;var it=I.Loca.version,st=I.AMap.version.startsWith("2"),Ut=it.startsWith("2");if(st&&!Ut||!st&&Ut)be("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{st=I.key,Ut=document.body||document.head;var P=document.createElement("script");P.type="text/javascript",P.src="https://webapi.amap.com/loca?v="+it+"&key="+st,P.onerror=function(b){xt.Loca=bt.failed,be("\u8BF7\u6C42 AMapUI \u5931\u8D25")},P.onload=function(){for(xt.Loca=bt.loaded,tt();K.Loca.length;)K.Loca.splice(0,1)[0]()},Ut.appendChild(P)}}else xt.Loca===bt.loaded?lt.version&&lt.version!==I.Loca.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):tt():lt.version&&lt.version!==I.Loca.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):K.Loca.push(function(b){b?be(b):be()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var bt;(function(lt){lt.notload="notload",lt.loading="loading",lt.loaded="loaded",lt.failed="failed"})(bt||(bt={}));var I={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},xt={AMap:bt.notload,AMapUI:bt.notload,Loca:bt.notload},K={AMap:[],AMapUI:[],Loca:[]},ut=[],ht=function(lt){typeof lt=="function"&&(xt.AMap===bt.loaded?lt(window.AMap):ut.push(lt))};return{load:function(lt){return new Promise(function(tt,be){if(xt.AMap==bt.failed)be("");else if(xt.AMap==bt.notload){var it=lt.key,st=lt.version,Ut=lt.plugins;it?(window.AMap&&location.host!=="lbs.amap.com"&&be("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),I.key=it,I.AMap.version=st||I.AMap.version,I.AMap.plugins=Ut||I.AMap.plugins,xt.AMap=bt.loading,st=document.body||document.head,window.___onAPILoaded=function(b){if(delete window.___onAPILoaded,b)xt.AMap=bt.failed,be(b);else for(xt.AMap=bt.loaded,Ot(lt).then(function(){tt(window.AMap)}).catch(be);ut.length;)ut.splice(0,1)[0]()},Ut=document.createElement("script"),Ut.type="text/javascript",Ut.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+I.AMap.version+"&key="+it+"&plugin="+I.AMap.plugins.join(","),Ut.onerror=function(b){xt.AMap=bt.failed,be(b)},st.appendChild(Ut)):be("\u8BF7\u586B\u5199key")}else if(xt.AMap==bt.loaded)if(lt.key&&lt.key!==I.key)be("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(lt.version&&lt.version!==I.AMap.version)be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(it=[],lt.plugins)for(st=0;st<lt.plugins.length;st+=1)I.AMap.plugins.indexOf(lt.plugins[st])==-1&&it.push(lt.plugins[st]);it.length?window.AMap.plugin(it,function(){Ot(lt).then(function(){tt(window.AMap)}).catch(be)}):Ot(lt).then(function(){tt(window.AMap)}).catch(be)}else if(lt.key&&lt.key!==I.key)be("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(lt.version&&lt.version!==I.AMap.version)be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var P=[];if(lt.plugins)for(st=0;st<lt.plugins.length;st+=1)I.AMap.plugins.indexOf(lt.plugins[st])==-1&&P.push(lt.plugins[st]);ht(function(){P.length?window.AMap.plugin(P,function(){Ot(lt).then(function(){tt(window.AMap)}).catch(be)}):Ot(lt).then(function(){tt(window.AMap)}).catch(be)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,I={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},xt={AMap:bt.notload,AMapUI:bt.notload,Loca:bt.notload},K={AMap:[],AMapUI:[],Loca:[]}}}})},67841:function(gn,Ot,ot){"use strict";ot.d(Ot,{Z:function(){return ht}});var kt=ot(1413),bt=ot(67294),I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"},xt=I,K=ot(84089),ut=function(tt,be){return bt.createElement(K.Z,(0,kt.Z)((0,kt.Z)({},tt),{},{ref:be,icon:xt}))};ut.displayName="RocketOutlined";var ht=bt.forwardRef(ut)},98869:function(gn,Ot,ot){"use strict";ot.d(Ot,{Z:function(){return I8}});var kt={};ot.r(kt),ot.d(kt,{add:function(){return mv},adjoint:function(){return Xr},clone:function(){return an},copy:function(){return en},create:function(){return Ke},determinant:function(){return sn},equals:function(){return Kp},exactEquals:function(){return Zg},frob:function(){return ku},fromQuat:function(){return Iu},fromQuat2:function(){return Pi},fromRotation:function(){return gi},fromRotationTranslation:function(){return Xi},fromRotationTranslationScale:function(){return Ea},fromRotationTranslationScaleOrigin:function(){return jo},fromScaling:function(){return Bn},fromTranslation:function(){return Jr},fromValues:function(){return Ri},fromXRotation:function(){return mi},fromYRotation:function(){return pi},fromZRotation:function(){return fi},frustum:function(){return _a},getRotation:function(){return Ni},getScaling:function(){return kn},getTranslation:function(){return Gi},identity:function(){return $e},invert:function(){return yr},lookAt:function(){return rh},mul:function(){return Ih},multiply:function(){return mr},multiplyScalar:function(){return i0},multiplyScalarAndAdd:function(){return $0},ortho:function(){return Y0},orthoNO:function(){return Zl},orthoZO:function(){return Ll},perspective:function(){return Oc},perspectiveFromFieldOfView:function(){return lf},perspectiveNO:function(){return mo},perspectiveZO:function(){return Al},rotate:function(){return Ve},rotateX:function(){return vr},rotateY:function(){return Qe},rotateZ:function(){return Hr},scale:function(){return kr},set:function(){return so},str:function(){return gv},sub:function(){return jm},subtract:function(){return Mh},targetTo:function(){return cp},translate:function(){return pr},transpose:function(){return Fe}});var bt=ot(67294),I=ot(70655),xt=ot(45098),K=ot(1413),ut=ot(15861),ht=ot(97685),lt=ot(15671),tt=ot(43144),be=ot(64687),it=ot.n(be),st=ot(97326),Ut=ot(60136),P=ot(82963),b=ot(61120),W=ot(4942),fe=ot(28660),Ee=ot(26729),Te=ot.n(Ee),Mt=ot(86700),et=ot(84879),Dt={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")};function we(n){var l=131,a=137,s=0;n+="x";for(var o=Math.floor(9007199254740991/a),h=0;h<n.length;h++)s>o&&(s=Math.floor(s/a)),s=s*l+n.charCodeAt(h);return s}function _e(n){n=n.toString();for(var l=5381,a=n.length;a;)l=l*33^n.charCodeAt(--a);return l>>>0}var ge=ot(74902),te=ot(96486),xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ye(n){this.message=n}Ye.prototype=new Error,Ye.prototype.name="InvalidCharacterError";function Lt(n){var l=String(n).replace(/=+$/,"");if(l.length%4===1)throw new Ye("'atob' failed: The string to be decoded is not correctly encoded.");for(var a="",s=0,o,h,v=0;h=l.charAt(v++);~h&&(o=s%4?o*64+h:h,s++%4)?a+=String.fromCharCode(255&o>>(-2*s&6)):0)h=xe.indexOf(h);return a}function Qt(n){n=String(n);for(var l,a,s,o,h="",v=0,m=n.length%3;v<n.length;){if((a=n.charCodeAt(v++))>255||(s=n.charCodeAt(v++))>255||(o=n.charCodeAt(v++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");l=a<<16|s<<8|o,h+=xe.charAt(l>>18&63)+xe.charAt(l>>12&63)+xe.charAt(l>>6&63)+xe.charAt(l&63)}return m?h.slice(0,m-3)+"===".substring(m):h}var ct=function(){function n(l,a){(0,lt.Z)(this,n),this.buffers=l,this.type=a}return(0,tt.Z)(n,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(a,s,o){throw new Error("not implemented")}}]),n}(),Ct,Y=function(){return Ct||(Ct=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof ot.g!="undefined"?ot.g:{})};Ct=Y();var yt;typeof window=="undefined"?yt={devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(l){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(l){return null},clearMeasures:function(l){return null},clearMarks:function(l){return null},measure:function(l,a,s){return{duration:0}},now:function(){return new Date().getTime()}},Blob:"",dispatchEvent:function(l){return!0},Event:function(l,a){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:yt=window;var Xt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ie=Xt?my.getSystemInfoSync().pixelRatio:yt.devicePixelRatio,Ce=(0,tt.Z)(function n(l,a){(0,lt.Z)(this,n),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=l,this.timeStamp=Date.now()});function er(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=Ht(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function Ht(n,l){if(!!n){if(typeof n=="string")return ne(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ne(n,l)}}function ne(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var Me=new WeakMap,ae=function(){function n(){(0,lt.Z)(this,n),Me.set(this,{})}return(0,tt.Z)(n,[{key:"addEventListener",value:function(a,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=Me.get(this);h||(h={}),h[a]||(h[a]=[]),h[a].push(s),Me.set(this,h),o.capture,o.once,o.passive}},{key:"removeEventListener",value:function(a,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=Me.get(this);if(h){var v=h[a];if(v&&v.length>0){for(var m=v.length;m--;m>0)if(v[m]===s){v.splice(m,1);break}}}}},{key:"dispatchEvent",value:function(a){var s=Me.get(this)[a.type];if(s){var o=er(s),h;try{for(o.s();!(h=o.n()).done;){var v=h.value;v(a)}}catch(m){o.e(m)}finally{o.f()}}}}]),n}();function Je(n){var l=or();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function or(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var re=function(n){(0,Ut.Z)(a,n);var l=Je(a);function a(){var s;return(0,lt.Z)(this,a),s=l.call(this),s.childNodes=[],s}return(0,tt.Z)(a,[{key:"appendChild",value:function(o){this.childNodes.push(o)}},{key:"cloneNode",value:function(){var o=Object.create(this);return Object.assign(o,this),o}},{key:"removeChild",value:function(o){var h=this.childNodes.findIndex(function(v){return v===o});return h>-1?this.childNodes.splice(h,1):null}}]),a}(ae);function Jt(n){var l=Et();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Et(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var $t=function(n){(0,Ut.Z)(a,n);var l=Jt(a);function a(){var s;return(0,lt.Z)(this,a),s=l.call(this),s.className="",s.children=[],s}return(0,tt.Z)(a,[{key:"setAttribute",value:function(o,h){this[o]=h}},{key:"getAttribute",value:function(o){return this[o]}},{key:"setAttributeNS",value:function(o,h){this[o]=h}},{key:"getAttributeNS",value:function(o){return this[o]}}]),a}(re),Yt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,St,At,ue,Pe;if(Yt){var je=my.getSystemInfoSync();St=je.screenWidth,At=je.screenHeight,ue=je.windowWidth,Pe=je.windowHeight}else{var Nt=yt.innerWidth,wt=yt.innerHeight;St=Nt,At=wt,ue=Nt,Pe=wt}var Tt={width:St,height:At,availWidth:ue,availHeight:Pe,availLeft:0,availTop:0},Ft=Tt.availWidth,J=Tt.availHeight,gt={style:[]};function jt(n,l){if(!("parentNode"in n)){var a;l===0?a=function(){return null}:l===1?a=function(){return gt}:a=function(){return null},Object.defineProperty(n,"parentNode",{enumerable:!0,get:a})}if(!("parentElement"in n)){var s;l===0?s=function(){return null}:l===1?s=function(){return gt}:s=function(){return null},Object.defineProperty(n,"parentElement",{enumerable:!0,get:s})}}function ve(n){n.style=n.style||{},Object.assign(n.style,{top:"0px",left:"0px",width:Ft+"px",height:J+"px",margin:"0px",padding:"0px"})}function Gt(n){"clientLeft"in n||(n.clientLeft=0,n.clientTop=0),"clientWidth"in n||(n.clientWidth=Ft,n.clientHeight=J),"getBoundingClientRect"in n||(n.getBoundingClientRect=function(){var l={x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight};return l})}function Ae(n){"offsetLeft"in n||(n.offsetLeft=0,n.offsetTop=0),"offsetWidth"in n||(n.offsetWidth=Ft,n.offsetHeight=J)}function He(n){"scrollLeft"in n||(n.scrollLeft=0,n.scrollTop=0),"scrollWidth"in n||(n.scrollWidth=Ft,n.scrollHeight=J)}function qe(n){var l=function(){return!0};n.classList=[],n.classList.add=l,n.classList.remove=l,n.classList.contains=l,n.classList.toggle=l}function hr(n){var l=tr();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function tr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function Br(){}var Lr=function(n){(0,Ut.Z)(a,n);var l=hr(a);function a(){var s,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",h=arguments.length>1?arguments[1]:void 0;return(0,lt.Z)(this,a),s=l.call(this),s.className="",s.children=[],s.focus=Br,s.blur=Br,s.insertBefore=Br,s.appendChild=Br,s.removeChild=Br,s.remove=Br,s.innerHTML="",s.tagName=o.toUpperCase(),jt((0,st.Z)(s),h),ve((0,st.Z)(s)),qe((0,st.Z)(s)),Gt((0,st.Z)(s)),Ae((0,st.Z)(s)),He((0,st.Z)(s)),s}return(0,tt.Z)(a)}($t);function Zr(n){var l=Tn();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Tn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var rn=function(n){(0,Ut.Z)(a,n);var l=Zr(a);function a(s){return(0,lt.Z)(this,a),l.call(this,s)}return(0,tt.Z)(a,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),a}(Lr);function Nn(n){var l=zn();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function zn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var jn=function(n){(0,Ut.Z)(a,n);var l=Nn(a);function a(){return(0,lt.Z)(this,a),l.call(this,"video")}return(0,tt.Z)(a)}(rn),Sn={},Wn={};function Rt(n,l){Sn=n,Sn.id=l,"tagName"in Sn||(Sn.tagName="CANVAS"),Sn.type="canvas",Mixin.parentNode(Sn),Mixin.style(Sn),Mixin.classList(Sn),Mixin.clientRegion(Sn),Mixin.offsetRegion(Sn),Sn.focus=function(){},Sn.blur=function(){}}function Wt(n,l){var a=1024,s=1024;Wn={width:a,height:s,clientWidth:a/devicePixelRatio,clientHeight:s/devicePixelRatio,id:l,type:"canvas"},"tagName"in Wn||(Wn.tagName="CANVAS"),Mixin.parentNode(Wn),Mixin.style(Wn),Mixin.classList(Wn),Mixin.clientRegion(Wn),Mixin.offsetRegion(Wn),Wn.getContext=function(o){if(o==="2d")return n},Wn.focus=function(){},Wn.blur=function(){}}function oe(){return Sn}function Se(){return Wn}var ze=(0,tt.Z)(function n(){(0,lt.Z)(this,n);var l=oe(),a=l.createImage&&l.createImage()||{};return"tagName"in a||(a.tagName="IMG",a.__proto__=n.prototype),jt(a),qe(a),Object.assign(a,{addEventListener:function(o,h){a["on".concat(o)]=h.bind(a)},removeEventListener:function(o){a["on".concat(o)]=null}}),a}),fr={href:"",protocol:"",host:""};function wr(n){var l=Le();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Le(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ur=function(n){(0,Ut.Z)(a,n);var l=wr(a);function a(){return(0,lt.Z)(this,a),l.call(this,"body",0)}return(0,tt.Z)(a,[{key:"addEventListener",value:function(o,h){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(o,h,v){}},{key:"dispatchEvent",value:function(o){}}]),a}(Lr),Wr=function(n){(0,Ut.Z)(a,n);var l=wr(a);function a(){return(0,lt.Z)(this,a),l.call(this,"html",0)}return(0,tt.Z)(a,[{key:"addEventListener",value:function(o,h){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(o,h){}},{key:"dispatchEvent",value:function(o){}}]),a}(Lr),wn={},qr={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:fr,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(l){return l=l.toLowerCase(),l==="canvas"?my.createOffscreenCanvas(1024,128,"2d"):l==="img"?new ze:l==="video"?new jn:new Lr(l)},createElementNS:function(l,a){return this.createElement(a)},createTextNode:function(l){return l},getElementById:function(l){return null},getElementsByTagName:function(l){return l=l.toLowerCase(),[]},getElementsByTagNameNS:function(l,a){return this.getElementsByTagName(a)},getElementsByName:function(l){return[]},querySelector:function(l){return null},querySelectorAll:function(l){return[]},addEventListener:function(l,a,s){wn[l]||(wn[l]=[]),wn[l].push(a)},removeEventListener:function(l,a){var s=wn[l];if(s&&s.length>0){for(var o=s.length;o--;o>0)if(s[o]===a){s.splice(o,1);break}}},dispatchEvent:function(l){var a=l.type,s=wn[a];if(s)for(var o=0;o<s.length;o++)s[o](l);l.target&&typeof l.target["on"+a]=="function"&&l.target["on"+a](l)},createEvent:function(l){return new Ce(l)}};qr.documentElement=new Wr,qr.head=new Lr("head"),qr.body=new ur;var Qr=Object,Mn=ot(71002),bi=function(){function n(){(0,lt.Z)(this,n);var l=arguments.length;if(l===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){this._w=arguments[0],this._h=arguments[1],this._data=new Uint8ClampedArray(this._w*this._h*4);return}}else l===3&&(0,Mn.Z)(arguments[0])==="object"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return(0,tt.Z)(n,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),n}(),wi=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Kr,ai,li;if(wi){var hi=my.getSystemInfoSync();Kr=hi.system,ai=hi.platform,li=hi.language}else{var ra={versions:function(){var n=yt.navigator.userAgent;return{trident:n.indexOf("Trident")>-1,presto:n.indexOf("Presto")>-1,webKit:n.indexOf("AppleWebKit")>-1,gecko:n.indexOf("Gecko")>-1&&n.indexOf("KHTML")===-1,mobile:!!n.match(/AppleWebKit.*Mobile.*/),ios:!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:n.indexOf("Android")>-1||n.indexOf("Linux")>-1,iPhone:n.indexOf("iPhone")>-1,iPad:n.indexOf("iPad")>-1,webApp:n.indexOf("Safari")===-1,weixin:n.indexOf("MicroMessenger")>-1,qq:n.match(/\sQQ/i)===" qq"}}(),language:(yt.navigator.browserLanguage||yt.navigator.language).toLowerCase()};ra.versions.android?ai="android":ra.versions.trident?ai="IE":ra.versions.presto?ai="Opera":ra.versions.webKit?ai="webKit":ra.versions.gecko?ai="Firefox":ra.versions.mobile?ai="mobile":ra.versions.ios?ai="ios":ra.versions.iPhone?ai="iPhone":ra.versions.iPad?ai="ipad":ra.versions.webApp?ai="webApp":ra.versions.weixin?ai="weixin":ra.versions.qq&&(ai="qq"),Kr=yt.navigator.userAgent,li=ra.language}var Ci=Kr.toLowerCase().indexOf("android")!==-1,Ba=Ci?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",po="Mozilla/5.0 (".concat(Ba,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(li),za={platform:ai,language:li,appVersion:"5.0 (".concat(Ba,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:po},Xa={mark:function(l){return null},clearMeasures:function(l){return null},clearMarks:function(l){return null},measure:function(l,a,s){return{duration:0}},now:function(){}},Ta=0,ga=0;function no(n){var l=Date.now(),a=Math.max(Ta+23,l);return ga=setTimeout(function(){n(Ta=a)},a-l),ga}function Vo(n){var l=oe();return l.requestAnimationFrame?l.requestAnimationFrame(n):no(n)}function vo(n){var l=oe();return l.cancelAnimationFrame?l.cancelAnimationFrame(n):clearTimeout(n)}var ja=function(){function n(l){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if((0,lt.Z)(this,n),l.indexOf("http://")==0||l.indexOf("https://")==0){this.href=l;return}this.href=a+l}return(0,tt.Z)(n,null,[{key:"createObjectURL",value:function(a){var s=a.buffers[0],o=a.type,h=to(s),v="data:".concat(o,";base64, ");return v+h}}]),n}();function to(n){for(var l="",a=new Uint8Array(n),s=a.byteLength,o=0;o<s;o++)l+=String.fromCharCode(a[o]);return Qt(l)}var Uo={GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:18446744073709552e3,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},ju={};function Wo(n){var l=bo();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function bo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var nr=new Map,ye=new Map,Ge=new Map,Mr={json:"application/json",text:"application/text",arraybuffer:"application/octet-stream"};function tn(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:this};typeof this["on".concat(n)]=="function"&&this["on".concat(n)].call(this,l)}function In(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{readyState:n};this.readyState=n,tn.call(this,"readystatechange",l)}var Un=function(n){(0,Ut.Z)(a,n);var l=Wo(a);function a(){var s;return(0,lt.Z)(this,a),s=l.call(this),s.onabort=null,s.onerror=null,s.onload=null,s.onloadstart=null,s.onprogress=null,s.ontimeout=null,s.onloadend=null,s.onreadystatechange=null,s.readyState=0,s.response=null,s.responseText=null,s._responseType="text",s.responseXML=null,s.status=0,s.statusText="",s.upload={},s.withCredentials=!1,nr.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),s}return(0,tt.Z)(a,[{key:"responseType",set:function(o){this._responseType=o}},{key:"abort",value:function(){var o=Ge.get("requestTask");o&&o.abort()}},{key:"getAllResponseHeaders",value:function(){var o=ye.get("responseHeader");return Object.keys(o).map(function(h){return"".concat(h,": ").concat(o[h])}).join(`
`)}},{key:"getResponseHeader",value:function(o){return ye.get("responseHeader")[o]}},{key:"open",value:function(o,h,v){this._method=o,this._url=h}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:""}},{key:"setRequestHeader",value:function(o,h){var v=nr.get("requestHeader");v[o]=h,nr.set("requestHeader",v)}},{key:"addEventListener",value:function(o,h){var v=this;typeof h=="function"&&(this["on"+o]=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m.target=m.target||v,h.call(v,m)})}},{key:"removeEventListener",value:function(o,h){this["on"+o]===h&&(this["on"+o]=null)}}]),a}(ae);Un.UNSEND=0,Un.OPENED=1,Un.HEADERS_RECEIVED=2,Un.LOADING=3,Un.DONE=4;function Cn(n){var l=ta();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ta(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Wa=function(n){(0,Ut.Z)(a,n);var l=Cn(a);function a(s){var o;return(0,lt.Z)(this,a),o=l.call(this,s),o.touches=[],o.targetTouches=[],o.changedTouches=[],o.target=oe(),o.currentTarget=oe(),o}return(0,tt.Z)(a)}(Ce);function es(n){var l=n||{},a=l.x,s=a===void 0?0:a,o=l.y,h=o===void 0?0:o,v=l.clientX,m=v===void 0?0:v,E=l.clientY,A=E===void 0?0:E;Object.keys(n).indexOf("x")!==-1?(n.pageX=n.clientX=s,n.pageY=n.clientY=h):(n.x=m,n.y=A)}function ko(n){return function(l){var a=new Wa(n);a.changedTouches=l.changedTouches,a.touches=l.touches,a.targetTouches=Array.prototype.slice.call(l.touches),a.timeStamp=l.timeStamp,a.changedTouches.forEach(function(s){return es(s)}),a.touches.forEach(function(s){return es(s)}),a.targetTouches.forEach(function(s){return es(s)}),qr.dispatchEvent(a)}}function ns(n){return function(l){l.type=n,qr.dispatchEvent(l)}}var Ya=ko("touchstart"),Go=ko("touchmove"),pu=ko("touchend"),ys=ns("mapCameaParams");function Rl(n){var l=mf();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function mf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Wu=function(n){(0,Ut.Z)(a,n);var l=Rl(a);function a(s){var o;return(0,lt.Z)(this,a),o=l.call(this,s),o.target=oe(),o.currentTarget=oe(),o}return(0,tt.Z)(a)}(Ce),Ie=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","pageX","pageY","timeStamp"],We=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,0,0,0],Tr="touch";function un(n,l,a){for(var s=new Wu(n),o=0;o<Ie.length;o++){var h=Ie[o];s[h]=l[h]||We[o]}return s.type=n,s.target=oe(),s.currentTarget=oe(),s.buttons=si(n),s.which=s.buttons,s.pointerId=(l.identifier||0)+2,s.bubbles=!0,s.cancelable=!0,s.button=0,s.width=(l.radiusX||.5)*2,s.height=(l.radiusY||.5)*2,s.pressure=l.force||.5,s.isPrimary=Ma(l),s.pointerType=Tr,s.altKey=a.altKey,s.ctrlKey=a.ctrlKey,s.metaKey=a.metaKey,s.shiftKey=a.shiftKey,a.preventDefault&&(s.preventDefault=function(){a.preventDefault()}),s}function si(n){var l=0;return(n==="touchstart"||n==="touchmove"||n==="pointerdown"||n==="pointermove")&&(l=1),l}var ji=null;function Ma(n){return ji===n.identifier}function ds(n){ji===null&&(ji=n.identifier)}function Ho(n){ji===n.identifier&&(ji=null)}function qo(n){return function(l){for(var a=l.changedTouches,s=0;s<a.length;s++){var o=a[s];s===0&&n==="pointerdown"?ds(o):(n==="pointerup"||n==="pointercancel")&&Ho(o);var h=un(n,o,l);qr.dispatchEvent(h)}}}var Hs=qo("pointerdown"),Xu=qo("pointermove"),_s=qo("pointerup");function vs(n){var l=Ou();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Ou(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var rl=function(n){(0,Ut.Z)(a,n);var l=vs(a);function a(s){return(0,lt.Z)(this,a),l.call(this,s)}return(0,tt.Z)(a)}(Ce);function nu(n){return function(l){l.type=n,qr.dispatchEvent(l)}}var dl=nu("mousedown"),Fu=nu("mousemove"),Fo=nu("mouseup"),rs=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Uc=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),_u=rs||Uc,Zc={atob:Lt,btoa:Qt,devicePixelRatio:ie,Blob:ct,document:qr,Element:$t,Event:Ce,EventTarget:ae,HTMLCanvasElement:Qr,HTMLElement:Lr,HTMLMediaElement:rn,HTMLVideoElement:jn,Image:ze,ImageData:bi,navigator:za,Node:re,requestAnimationFrame:Vo,cancelAnimationFrame:vo,screen:Tt,XMLHttpRequest:Un,performance:Xa,URL:ja,WebGLRenderingContext:Uo,WebGL2RenderingContext:ju,addEventListener:function(l,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};qr.addEventListener(l,a,s)},removeEventListener:function(l,a,s){qr.removeEventListener(l,a)},dispatchEvent:function(l){qr.dispatchEvent(l)},innerWidth:Tt.availWidth,innerHeight:Tt.availHeight,setTimeout,clearTimeout,setInterval,clearInterval},Co=_u?Zc:yt,sc=_u?Un:yt.XMLHttpRequest,Xl=_u?fr:yt.location;function nl(n){var l=n;return typeof n=="string"&&(l=Co.document.getElementById(n)),l}function uc(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function D(n){return uc(n).split(/\s+/)}function X(n){var l,a,s=Co==null||(l=Co.document)===null||l===void 0||(a=l.documentElement)===null||a===void 0?void 0:a.style;if(!s)return n[0];for(var o in n)if(n[o]&&n[o]in s)return n[o];return n[0]}function _t(n,l,a){var s=Co.document.createElement(n);return l&&(s.className=l||""),a&&a.appendChild(s),s}function rt(n){var l=n.parentNode;l&&l.removeChild(n)}function se(n,l){if(n.classList!==void 0)for(var a=D(l),s=0,o=a.length;s<o;s++)n.classList.add(a[s]);else if(!Sr(n,l)){var h=Vr(n);jr(n,(h?h+" ":"")+l)}}function Ze(n,l){n.classList!==void 0?n.classList.remove(l):jr(n,uc((" "+Vr(n)+" ").replace(" "+l+" "," ")))}function Sr(n,l){if(n.classList!==void 0)return n.classList.contains(l);var a=Vr(n);return a.length>0&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(a)}function jr(n,l){n instanceof HTMLElement?n.className=l:n.className.baseVal=l}function Vr(n){return n instanceof SVGElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function Ln(n){for(;n&&n.firstChild;)n.removeChild(n.firstChild)}var Gn=X(["transform","WebkitTransform"]);function $i(n,l){n.style[Gn]=l}function Pa(){if(typeof Event=="function")Co.dispatchEvent(new Event("resize"));else{var n=Co.document.createEvent("UIEvents");n.initUIEvent("resize",!0,!1,Co,0),Co.dispatchEvent(n)}}function ba(n){var l=["padding: "+(n.height/2-8)+"px "+n.width/2+"px;","line-height: "+n.height+"px;","background-image: url("+n.toDataURL()+");"];console.log(`%c
`,l.join(""))}function uo(){var n,l=Co.document.querySelector('meta[name="viewport"]');if(!l)return 1;var a=(n=l.content)===null||n===void 0?void 0:n.split(","),s=a.find(function(o){var h=o.split("="),v=(0,ht.Z)(h,1),m=v[0];return m==="initial-scale"});return s?s.split("=")[1]*1:1}var Ca=uo()<1?1:Co.devicePixelRatio;function Ao(n,l){n.setAttribute("style","".concat(n.style.cssText).concat(l))}function qa(n){return n.split(";").map(function(l){return l.trim()}).filter(function(l){return l})}function gs(n,l){var a,s=qa((a=n.getAttribute("style"))!==null&&a!==void 0?a:""),o=qa(l),h=te.pull.apply(void 0,[s].concat((0,ge.Z)(o)));n.setAttribute("style",h.join(";"))}function xu(n){return Object.entries(n).map(function(l){var a=(0,ht.Z)(l,2),s=a[0],o=a[1];return"".concat(s,": ").concat(o)}).join(";")}function il(n,l){return{left:n.left-l.left,top:n.top-l.top,right:l.left+l.width-n.left-n.width,bottom:l.top+l.height-n.top-n.height}}function bu(n,l){n.checked=l,l?n.setAttribute("checked","true"):n.removeAttribute("checked")}function iu(n){n.innerHTML=""}function Vc(n){n.setAttribute("draggable","false")}function $s(n,l){if(typeof l=="string"){var a=document.createElement("div");for(a.innerHTML=l;a.firstChild;)n.append(a.firstChild)}else Array.isArray(l)?n.append.apply(n,(0,ge.Z)(l)):n.append(l)}function Yl(n){if(n.length===0)throw new Error("max requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]>l&&(l=n[a]);return l*1}function me(n){if(n.length===0)throw new Error("min requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]<l&&(l=n[a]);return l*1}function ir(n){if(n.length===0)return 0;for(var l=n[0]*1,a=1;a<n.length;a++)l+=n[a]*1;return l}function Or(n){if(n.length===0)throw new Error("mean requires at least one data point");return ir(n)/n.length}function $r(n){if(n.length===0)throw new Error("mean requires at least one data point");if(n.length<3)return n[0];n.sort();for(var l=n[0],a=NaN,s=0,o=1,h=1;h<n.length+1;h++)n[h]!==l?(o>s&&(s=o,a=l),o=1,l=n[h]):o++;return a*1}var xn={min:me,max:Yl,mean:Or,sum:ir,mode:$r};function _i(n,l){return n.map(function(a){return a[l]})}function qi(n,l){return xn[n](l)}var Ia=ot(89611);function du(n){return Function.toString.call(n).indexOf("[native code]")!==-1}var qs=ot(78814);function $a(n,l,a){return(0,qs.Z)()?$a=Reflect.construct.bind():$a=function(o,h,v){var m=[null];m.push.apply(m,h);var E=Function.bind.apply(o,m),A=new E;return v&&(0,Ia.Z)(A,v.prototype),A},$a.apply(null,arguments)}function Dl(n){var l=typeof Map=="function"?new Map:void 0;return Dl=function(s){if(s===null||!du(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof l!="undefined"){if(l.has(s))return l.get(s);l.set(s,o)}function o(){return $a(s,arguments,(0,b.Z)(this).constructor)}return o.prototype=Object.create(s.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),(0,Ia.Z)(o,s)},Dl(n)}function av(n){var l=yf();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function yf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var vd=function(n){(0,Ut.Z)(a,n);var l=av(a);function a(s,o,h,v){var m;return(0,lt.Z)(this,a),m=l.call(this,"AJAXError: ".concat(o," (").concat(s,"): ").concat(h)),m.status=s,m.statusText=o,m.url=h,m.body=v,m}return(0,tt.Z)(a)}(Dl(Error));function ov(n,l){var a=new sc,s=Array.isArray(n.url)?n.url[0]:n.url;a.open(n.method||"GET",s,!0),n.type==="arrayBuffer"&&(a.responseType="arraybuffer");for(var o in n.headers)n.headers.hasOwnProperty(o)&&a.setRequestHeader(o,n.headers[o]);return n.type==="json"&&(a.responseType="text",a.setRequestHeader("Accept","application/json")),a.withCredentials=n.credentials==="include",a.onerror=function(){l(new Error(a.statusText))},a.onload=function(){if((a.status>=200&&a.status<300||a.status===0)&&a.response!==null){var h=a.response;if(n.type==="json")try{h=JSON.parse(a.response)}catch(m){return l(m)}l(null,h,a.getResponseHeader("Cache-Control"),a.getResponseHeader("Expires"),a)}else{var v=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});l(new vd(a.status,a.statusText,s.toString(),v))}},a.send(n.body),a}function sv(n){return new Promise(function(l,a){ov(n,function(s,o,h,v,m){s?a({err:s,data:null,xhr:m}):l({err:null,data:o,cacheControl:h,expires:v,xhr:m})})})}function dh(n,l){return ov(n,l)}var zf=function(l,a){return dh((0,K.Z)((0,K.Z)({},l),{},{type:"json"}),a)},Gc=function(l,a){return dh((0,K.Z)((0,K.Z)({},l),{},{type:"arrayBuffer"}),a)},vh=function(l,a){return dh(_objectSpread(_objectSpread({},l),{},{method:"POST"}),a)};function Uf(n){var l=$window.document.createElement("a");return l.href=n,l.protocol===$window.document.location.protocol&&l.host===$window.document.location.host}var lc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function al(n,l){var a=new Co.Image,s=Co.URL||Co.webkitURL;a.crossOrigin="anonymous",a.onload=function(){l(null,a),s.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(function(){a.src=lc})},a.onerror=function(){return l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var o=new Blob([new Uint8Array(n)],{type:"image/png"});a.src=n.byteLength?s.createObjectURL(o):lc}function _f(n,l){var a=new Blob([new Uint8Array(n)],{type:"image/png"});createImageBitmap(a).then(function(s){l(null,s)}).catch(function(s){l(new Error("Could not load image because of ".concat(s.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var vl=function(l,a,s){var o=function(v,m){if(v)a(v);else if(m){var E=typeof createImageBitmap=="function",A=s?s(m):m;E?_f(A,a):al(A,a)}};return l.type==="json"?zf(l,o):Gc(l,o)},Eu=63710088e-1,Yh={centimeters:Eu*100,centimetres:Eu*100,degrees:Eu/111325,feet:Eu*3.28084,inches:Eu*39.37,kilometers:Eu/1e3,kilometres:Eu/1e3,meters:Eu,metres:Eu,miles:Eu/1609.344,millimeters:Eu*1e3,millimetres:Eu*1e3,nauticalmiles:Eu/1852,radians:1,yards:Eu*1.0936},Pp={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Eu,yards:1.0936133},wc={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function gl(n,l,a){a===void 0&&(a={});var s={type:"Feature"};return(a.id===0||a.id)&&(s.id=a.id),a.bbox&&(s.bbox=a.bbox),s.properties=l||{},s.geometry=n,s}function $h(n,l,a){switch(a===void 0&&(a={}),n){case"Point":return qh(l).geometry;case"LineString":return $l(l).geometry;case"Polygon":return Hc(l).geometry;case"MultiPoint":return gd(l).geometry;case"MultiLineString":return Tl(l).geometry;case"MultiPolygon":return md(l).geometry;default:throw new Error(n+" is invalid")}}function qh(n,l,a){if(a===void 0&&(a={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Yu(n[0])||!Yu(n[1]))throw new Error("coordinates must contain numbers");var s={type:"Point",coordinates:n};return gl(s,l,a)}function Op(n,l,a){return a===void 0&&(a={}),Zf(n.map(function(s){return qh(s,l)}),a)}function Hc(n,l,a){a===void 0&&(a={});for(var s=0,o=n;s<o.length;s++){var h=o[s];if(h.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var v=0;v<h[h.length-1].length;v++)if(h[h.length-1][v]!==h[0][v])throw new Error("First and last Position are not equivalent.")}var m={type:"Polygon",coordinates:n};return gl(m,l,a)}function Kh(n,l,a){return a===void 0&&(a={}),Zf(n.map(function(s){return Hc(s,l)}),a)}function $l(n,l,a){if(a===void 0&&(a={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var s={type:"LineString",coordinates:n};return gl(s,l,a)}function Qh(n,l,a){return a===void 0&&(a={}),Zf(n.map(function(s){return $l(s,l)}),a)}function Zf(n,l){l===void 0&&(l={});var a={type:"FeatureCollection"};return l.id&&(a.id=l.id),l.bbox&&(a.bbox=l.bbox),a.features=n,a}function Tl(n,l,a){a===void 0&&(a={});var s={type:"MultiLineString",coordinates:n};return gl(s,l,a)}function gd(n,l,a){a===void 0&&(a={});var s={type:"MultiPoint",coordinates:n};return gl(s,l,a)}function md(n,l,a){a===void 0&&(a={});var s={type:"MultiPolygon",coordinates:n};return gl(s,l,a)}function yd(n,l,a){a===void 0&&(a={});var s={type:"GeometryCollection",geometries:n};return gl(s,l,a)}function gh(n,l){if(l===void 0&&(l=0),l&&!(l>=0))throw new Error("precision must be a positive number");var a=Math.pow(10,l||0);return Math.round(n*a)/a}function _d(n,l){l===void 0&&(l="kilometers");var a=Yh[l];if(!a)throw new Error(l+" units is invalid");return n*a}function xf(n,l){l===void 0&&(l="kilometers");var a=Yh[l];if(!a)throw new Error(l+" units is invalid");return n/a}function xs(n,l){return Vf(xf(n,l))}function Jh(n){var l=n%360;return l<0&&(l+=360),l}function Vf(n){var l=n%(2*Math.PI);return l*180/Math.PI}function Bl(n){var l=n%360;return l*Math.PI/180}function go(n,l,a){if(l===void 0&&(l="kilometers"),a===void 0&&(a="kilometers"),!(n>=0))throw new Error("length must be a positive number");return _d(xf(n,l),a)}function is(n,l,a){if(l===void 0&&(l="meters"),a===void 0&&(a="kilometers"),!(n>=0))throw new Error("area must be a positive number");var s=wc[l];if(!s)throw new Error("invalid original units");var o=wc[a];if(!o)throw new Error("invalid final units");return n/s*o}function Yu(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function Fp(n){return!!n&&n.constructor===Object}function bf(n){if(!n)throw new Error("bbox is required");if(!Array.isArray(n))throw new Error("bbox must be an Array");if(n.length!==4&&n.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");n.forEach(function(l){if(!Yu(l))throw new Error("bbox must only contain numbers")})}function tp(n){if(!n)throw new Error("id is required");if(["string","number"].indexOf(typeof n)===-1)throw new Error("id must be a number or a string")}function xd(n){return typeof n=="number"}function ep(n,l,a){if(n!==null)for(var s,o,h,v,m,E,A,F=0,B=0,V,j=n.type,nt=j==="FeatureCollection",at=j==="Feature",mt=nt?n.features.length:1,Bt=0;Bt<mt;Bt++){A=nt?n.features[Bt].geometry:at?n.geometry:n,V=A?A.type==="GeometryCollection":!1,m=V?A.geometries.length:1;for(var de=0;de<m;de++){var ce=0,Be=0;if(v=V?A.geometries[de]:A,v!==null){E=v.coordinates;var Xe=v.type;switch(F=a&&(Xe==="Polygon"||Xe==="MultiPolygon")?1:0,Xe){case null:break;case"Point":if(l(E,B,Bt,ce,Be)===!1)return!1;B++,ce++;break;case"LineString":case"MultiPoint":for(s=0;s<E.length;s++){if(l(E[s],B,Bt,ce,Be)===!1)return!1;B++,Xe==="MultiPoint"&&ce++}Xe==="LineString"&&ce++;break;case"Polygon":case"MultiLineString":for(s=0;s<E.length;s++){for(o=0;o<E[s].length-F;o++){if(l(E[s][o],B,Bt,ce,Be)===!1)return!1;B++}Xe==="MultiLineString"&&ce++,Xe==="Polygon"&&Be++}Xe==="Polygon"&&ce++;break;case"MultiPolygon":for(s=0;s<E.length;s++){for(Be=0,o=0;o<E[s].length;o++){for(h=0;h<E[s][o].length-F;h++){if(l(E[s][o][h],B,Bt,ce,Be)===!1)return!1;B++}Be++}ce++}break;case"GeometryCollection":for(s=0;s<v.geometries.length;s++)if(ep(v.geometries[s],l,a)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Rp(n,l,a,s){var o=a;return ep(n,function(h,v,m,E,A){v===0&&a===void 0?o=h:o=l(o,h,v,m,E,A)},s),o}function rp(n,l){var a;switch(n.type){case"FeatureCollection":for(a=0;a<n.features.length&&l(n.features[a].properties,a)!==!1;a++);break;case"Feature":l(n.properties,0);break}}function Ef(n,l,a){var s=a;return rp(n,function(o,h){h===0&&a===void 0?s=o:s=l(s,o,h)}),s}function au(n,l){if(n.type==="Feature")l(n,0);else if(n.type==="FeatureCollection")for(var a=0;a<n.features.length&&l(n.features[a],a)!==!1;a++);}function Sf(n,l,a){var s=a;return au(n,function(o,h){h===0&&a===void 0?s=o:s=l(s,o,h)}),s}function np(n){var l=[];return ep(n,function(a){l.push(a)}),l}function As(n,l){var a,s,o,h,v,m,E,A,F,B,V=0,j=n.type==="FeatureCollection",nt=n.type==="Feature",at=j?n.features.length:1;for(a=0;a<at;a++){for(m=j?n.features[a].geometry:nt?n.geometry:n,A=j?n.features[a].properties:nt?n.properties:{},F=j?n.features[a].bbox:nt?n.bbox:void 0,B=j?n.features[a].id:nt?n.id:void 0,E=m?m.type==="GeometryCollection":!1,v=E?m.geometries.length:1,o=0;o<v;o++){if(h=E?m.geometries[o]:m,h===null){if(l(null,V,A,F,B)===!1)return!1;continue}switch(h.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(h,V,A,F,B)===!1)return!1;break}case"GeometryCollection":{for(s=0;s<h.geometries.length;s++)if(l(h.geometries[s],V,A,F,B)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}V++}}function Zi(n,l,a){var s=a;return As(n,function(o,h,v,m,E){h===0&&a===void 0?s=o:s=l(s,o,h,v,m,E)}),s}function as(n,l){As(n,function(a,s,o,h,v){var m=a===null?null:a.type;switch(m){case null:case"Point":case"LineString":case"Polygon":return l(gl(a,o,{bbox:h,id:v}),s,0)===!1?!1:void 0}var E;switch(m){case"MultiPoint":E="Point";break;case"MultiLineString":E="LineString";break;case"MultiPolygon":E="Polygon";break}for(var A=0;A<a.coordinates.length;A++){var F=a.coordinates[A],B={type:E,coordinates:F};if(l(gl(B,o),s,A)===!1)return!1}})}function wf(n,l,a){var s=a;return as(n,function(o,h,v){h===0&&v===0&&a===void 0?s=o:s=l(s,o,h,v)}),s}function Gf(n,l){as(n,function(a,s,o){var h=0;if(!!a.geometry){var v=a.geometry.type;if(!(v==="Point"||v==="MultiPoint")){var m,E=0,A=0,F=0;if(ep(a,function(B,V,j,nt,at){if(m===void 0||s>E||nt>A||at>F){m=B,E=s,A=nt,F=at,h=0;return}var mt=lineString([m,B],a.properties);if(l(mt,s,o,at,h)===!1)return!1;h++,m=B})===!1)return!1}}})}function cc(n,l,a){var s=a,o=!1;return Gf(n,function(h,v,m,E,A){o===!1&&a===void 0?s=h:s=l(s,h,v,m,E,A),o=!0}),s}function ml(n,l){if(!n)throw new Error("geojson is required");as(n,function(a,s,o){if(a.geometry!==null){var h=a.geometry.type,v=a.geometry.coordinates;switch(h){case"LineString":if(l(a,s,o,0,0)===!1)return!1;break;case"Polygon":for(var m=0;m<v.length;m++)if(l(lineString(v[m],a.properties),s,o,m)===!1)return!1;break}}})}function Dp(n,l,a){var s=a;return ml(n,function(o,h,v,m){h===0&&a===void 0?s=o:s=l(s,o,h,v,m)}),s}function Ai(n,l){if(l=l||{},!isObject(l))throw new Error("options is invalid");var a=l.featureIndex||0,s=l.multiFeatureIndex||0,o=l.geometryIndex||0,h=l.segmentIndex||0,v=l.properties,m;switch(n.type){case"FeatureCollection":a<0&&(a=n.features.length+a),v=v||n.features[a].properties,m=n.features[a].geometry;break;case"Feature":v=v||n.properties,m=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":m=n;break;default:throw new Error("geojson is invalid")}if(m===null)return null;var E=m.coordinates;switch(m.type){case"Point":case"MultiPoint":return null;case"LineString":return h<0&&(h=E.length+h-1),lineString([E[h],E[h+1]],v,l);case"Polygon":return o<0&&(o=E.length+o),h<0&&(h=E[o].length+h-1),lineString([E[o][h],E[o][h+1]],v,l);case"MultiLineString":return s<0&&(s=E.length+s),h<0&&(h=E[s].length+h-1),lineString([E[s][h],E[s][h+1]],v,l);case"MultiPolygon":return s<0&&(s=E.length+s),o<0&&(o=E[s].length+o),h<0&&(h=E[s][o].length-h-1),lineString([E[s][o][h],E[s][o][h+1]],v,l)}throw new Error("geojson is invalid")}function Hf(n,l){if(l=l||{},!isObject(l))throw new Error("options is invalid");var a=l.featureIndex||0,s=l.multiFeatureIndex||0,o=l.geometryIndex||0,h=l.coordIndex||0,v=l.properties,m;switch(n.type){case"FeatureCollection":a<0&&(a=n.features.length+a),v=v||n.features[a].properties,m=n.features[a].geometry;break;case"Feature":v=v||n.properties,m=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":m=n;break;default:throw new Error("geojson is invalid")}if(m===null)return null;var E=m.coordinates;switch(m.type){case"Point":return point(E,v,l);case"MultiPoint":return s<0&&(s=E.length+s),point(E[s],v,l);case"LineString":return h<0&&(h=E.length+h),point(E[h],v,l);case"Polygon":return o<0&&(o=E.length+o),h<0&&(h=E[o].length+h),point(E[o][h],v,l);case"MultiLineString":return s<0&&(s=E.length+s),h<0&&(h=E[s].length+h),point(E[s][h],v,l);case"MultiPolygon":return s<0&&(s=E.length+s),o<0&&(o=E[s].length+o),h<0&&(h=E[s][o].length-h),point(E[s][o][h],v,l)}throw new Error("geojson is invalid")}function Cc(n){var l=[1/0,1/0,-1/0,-1/0];return ep(n,function(a){l[0]>a[0]&&(l[0]=a[0]),l[1]>a[1]&&(l[1]=a[1]),l[2]<a[0]&&(l[2]=a[0]),l[3]<a[1]&&(l[3]=a[1])}),l}Cc.default=Cc;var Cf=Cc,ma=2*Math.PI*6378137/2;function yl(n,l){var a=(0,ht.Z)(l,4),s=a[0],o=a[1],h=a[2],v=a[3];return n.lng>s&&n.lng<=h&&n.lat>o&&n.lat<=v}function jf(n){var l=[1/0,1/0,-1/0,-1/0];return n.forEach(function(a){var s=a.coordinates;fc(l,s)}),l}function fc(n,l){return Array.isArray(l[0])?l.forEach(function(a){fc(n,a)}):(n[0]>l[0]&&(n[0]=l[0]),n[1]>l[1]&&(n[1]=l[1]),n[2]<l[0]&&(n[2]=l[0]),n[3]<l[1]&&(n[3]=l[1])),n}function _l(n,l){return sa(n,l)}function sa(n,l){return Array.isArray(n[0])?n.map(function(a){return sa(a,l)}):l(n)}function Bp(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};n=Ml(n,l);var s=n[0],o=n[1],h=s*ma/180,v=Math.log(Math.tan((90+o)*Math.PI/360))/(Math.PI/180);return v=v*ma/180,a.enable&&(h=Number(h.toFixed(a.decimal)),v=Number(v.toFixed(a.decimal))),n.length===3?[h,v,n[2]]:[h,v]}function Np(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=n[0],s=n[1],o=a/ma*180,h=s/ma*180;return h=180/Math.PI*(2*Math.atan(Math.exp(h*Math.PI/180))-Math.PI/2),l!=null&&(o=Number(o.toFixed(l)),h=Number(h.toFixed(l))),n.length===3?[o,h,n[2]]:[o,h]}function bd(n){if(n==null)throw new Error("lng is required");return(n>180||n<-180)&&(n=n%360,n>180&&(n=-360+n),n<-180&&(n=360+n),n===0&&(n=0)),n}function Ed(n){if(n==null)throw new Error("lat is required");return(n>90||n<-90)&&(n=n%180,n>90&&(n=-180+n),n<-90&&(n=180+n),n===0&&(n=0)),n}function Ml(n,l){if(l===!1)return n;var a=bd(n[0]),s=Ed(n[1]);return s>85&&(s=85),s<-85&&(s=-85),n.length===3?[a,s,n[2]]:[a,s]}function Ko(n){var l=85.0511287798,a=Math.max(Math.min(l,n[1]),-l),s=256<<20,o=Math.PI/180,h=n[0]*o,v=a*o;v=Math.log(Math.tan(Math.PI/4+v/2));var m=.5/Math.PI,E=.5,A=-.5/Math.PI;return o=.5,h=s*(m*h+E),v=s*(A*v+o),[Math.floor(h),Math.floor(v)]}function Ka(n){var l=.5/Math.PI,a=.5,s=-.5/Math.PI,o=.5,h=256<<20,v=_slicedToArray(n,2),m=v[0],E=v[1];m=(m/h-a)/l,E=(E/h-o)/s,E=(Math.atan(Math.pow(Math.E,E))-Math.PI/4)*2,o=Math.PI/180;var A=E/o,F=m/o;return[F,A]}function xl(n,l){var a=85.0511287798,s=Math.PI/180,o=6378137;return l=Math.max(Math.min(a,l),-a),n*=s,l*=s,l=Math.log(Math.tan(Math.PI/4+l/2)),[n*o,l*o]}function ql(n,l){var a=Math.PI/180,s=6378137,o=n/s/a,h=2*(Math.atan(Math.exp(l/s))-Math.PI/4)/a;return[o,h]}function Ts(n,l,a){var s=Bl(l[1]-n[1]),o=Bl(l[0]-n[0]),h=Bl(n[1]),v=Bl(l[1]),m=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(h)*Math.cos(v);return _d(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),a="meters")}function jc(n){var l=Math.PI/180,a=85.0511287798,s=6378137,o=Math.max(Math.min(a,n[1]),-a),h=Math.sin(o*l),v=s*n[0]*l,m=s*Math.log((1+h)/(1-h))/2;return[v,m]}function Nl(n,l){var a=Math.abs(n[1][1]-n[0][1])*l,s=Math.abs(n[1][0]-n[0][0])*l;return[[n[0][0]-s,n[0][1]-a],[n[1][0]+s,n[1][1]+a]]}function Su(n,l){return n[0][0]<=l[0][0]&&n[0][1]<=l[0][1]&&n[1][0]>=l[1][0]&&n[1][1]>=l[1][1]}function wu(n){return[[n[0],n[1]],[n[2],n[3]]]}function Il(n){var l=Ki(n,[0,0]);return[n[0]/l,n[1]/l]}function Ki(n,l){return Math.sqrt(Math.pow(n[0]-l[0],2)+Math.pow(n[1]-l[1],2))}function Wi(n,l){return n[0]*l[0]+n[1]*l[1]}function Af(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function ol(n,l){return Math.acos(Wi(n,l)/(Af(n)*Af(l)))*180/Math.PI}function sl(n,l){return l[0]>0?l[1]>0?90-Math.atan(l[1]/l[0])*180/Math.PI:90+Math.atan(-l[1]/l[0])*180/Math.PI:l[1]<0?180+(90-Math.atan(l[1]/l[0])*180/Math.PI):270+Math.atan(l[1]/-l[0])*180/Math.PI}function Ru(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!n||n.length<2)){for(var a=[0,1],s=0,o=[],h=0;h<n.length-1;h++){var v=n[h],m=n[h+1],E=Ki(v,m);s+=E;var A=[v[0]-m[0],v[1]-m[1]],F=sl(a,A);if(h>0){var B=o[h-1].rotation;B-F>360-B+F&&(F=F+360)}o.push({start:v,end:m,dis:E,rotation:F,duration:0})}return o.map(function(V){V.duration=l*(V.dis/s)}),o}}function bs(n){if(xd(n[0]))return n;if(xd(n[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(xd(n[0][0][0])){var l=n,a=0,s=0,o=0;return l.forEach(function(h){h.forEach(function(v){a+=v[0],s+=v[1],o++})}),[a/o,s/o,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Ac(n){for(var l=n[0],a=n[1],s=n[0],o=n[1],h=0,v=0,m=0,E=0;E<n.length;E+=2){var A=n[E],F=n[E+1];A&&F&&(l=Math.max(A,l),a=Math.max(F,a),s=Math.min(A,s),o=Math.min(F,o),h+=A,v+=F,m++)}return{center:[h/m,v/m],radius:Math.sqrt(Math.pow(l-s,2)+Math.pow(a-o,2))/2}}function Tc(n){return Cf(Zf([$l(n)]))}var No=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,a=arguments.length>1?arguments[1]:void 0;(0,lt.Z)(this,n),this.limit=l,this.destroy=a||this.defaultDestroy,this.order=[],this.clear()}return(0,tt.Z)(n,[{key:"clear",value:function(){var a=this;this.order.forEach(function(s){a.delete(s)}),this.cache={},this.order=[]}},{key:"get",value:function(a){var s=this.cache[a];return s&&(this.deleteOrder(a),this.appendOrder(a)),s}},{key:"set",value:function(a,s){this.cache[a]?(this.delete(a),this.cache[a]=s,this.appendOrder(a)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[a]=s,this.appendOrder(a))}},{key:"delete",value:function(a){var s=this.cache[a];s&&(this.deleteCache(a),this.deleteOrder(a),this.destroy(s,a))}},{key:"deleteCache",value:function(a){delete this.cache[a]}},{key:"deleteOrder",value:function(a){var s=this.order.findIndex(function(o){return o===a});s>=0&&this.order.splice(s,1)}},{key:"appendOrder",value:function(a){this.order.push(a)}},{key:"defaultDestroy",value:function(a,s){return null}}]),n}();function os(n,l){n.forEach(function(a){!l[a]||(l[a]=l[a].bind(l))})}var ip=null;function Wc(n,l,a){n.prototype=l.prototype=a,a.constructor=n}function hc(n,l){var a=Object.create(n.prototype);for(var s in l)a[s]=l[s];return a}function ul(){}var Fs=.7,Ms=1/Fs,$u="\\s*([+-]?\\d+)\\s*",Xc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ll="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wf=/^#([0-9a-f]{3,8})$/,Mc=new RegExp("^rgb\\("+[$u,$u,$u]+"\\)$"),mh=new RegExp("^rgb\\("+[ll,ll,ll]+"\\)$"),Xf=new RegExp("^rgba\\("+[$u,$u,$u,Xc]+"\\)$"),Sd=new RegExp("^rgba\\("+[ll,ll,ll,Xc]+"\\)$"),Rs=new RegExp("^hsl\\("+[Xc,ll,ll]+"\\)$"),Ic=new RegExp("^hsla\\("+[Xc,ll,ll,Xc]+"\\)$"),ap={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Wc(ul,pc,{copy:function(n){return Object.assign(new this.constructor,this,n)},displayable:function(){return this.rgb().displayable()},hex:bl,formatHex:bl,formatHsl:zl,formatRgb:op,toString:op});function bl(){return this.rgb().formatHex()}function zl(){return ft(this).formatHsl()}function op(){return this.rgb().formatRgb()}function pc(n){var l,a;return n=(n+"").trim().toLowerCase(),(l=Wf.exec(n))?(a=l[1].length,l=parseInt(l[1],16),a===6?zp(l):a===3?new S(l>>8&15|l>>4&240,l>>4&15|l&240,(l&15)<<4|l&15,1):a===8?Yc(l>>24&255,l>>16&255,l>>8&255,(l&255)/255):a===4?Yc(l>>12&15|l>>8&240,l>>8&15|l>>4&240,l>>4&15|l&240,((l&15)<<4|l&15)/255):null):(l=Mc.exec(n))?new S(l[1],l[2],l[3],1):(l=mh.exec(n))?new S(l[1]*255/100,l[2]*255/100,l[3]*255/100,1):(l=Xf.exec(n))?Yc(l[1],l[2],l[3],l[4]):(l=Sd.exec(n))?Yc(l[1]*255/100,l[2]*255/100,l[3]*255/100,l[4]):(l=Rs.exec(n))?$(l[1],l[2]/100,l[3]/100,1):(l=Ic.exec(n))?$(l[1],l[2]/100,l[3]/100,l[4]):ap.hasOwnProperty(n)?zp(ap[n]):n==="transparent"?new S(NaN,NaN,NaN,0):null}function zp(n){return new S(n>>16&255,n>>8&255,n&255,1)}function Yc(n,l,a,s){return s<=0&&(n=l=a=NaN),new S(n,l,a,s)}function x(n){return n instanceof ul||(n=pc(n)),n?(n=n.rgb(),new S(n.r,n.g,n.b,n.opacity)):new S}function C(n,l,a,s){return arguments.length===1?x(n):new S(n,l,a,s==null?1:s)}function S(n,l,a,s){this.r=+n,this.g=+l,this.b=+a,this.opacity=+s}Wc(S,C,hc(ul,{brighter:function(n){return n=n==null?Ms:Math.pow(Ms,n),new S(this.r*n,this.g*n,this.b*n,this.opacity)},darker:function(n){return n=n==null?Fs:Math.pow(Fs,n),new S(this.r*n,this.g*n,this.b*n,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:M,formatHex:M,formatRgb:z,toString:z}));function M(){return"#"+H(this.r)+H(this.g)+H(this.b)}function z(){var n=this.opacity;return n=isNaN(n)?1:Math.max(0,Math.min(1,n)),(n===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(n===1?")":", "+n+")")}function H(n){return n=Math.max(0,Math.min(255,Math.round(n)||0)),(n<16?"0":"")+n.toString(16)}function $(n,l,a,s){return s<=0?n=l=a=NaN:a<=0||a>=1?n=l=NaN:l<=0&&(n=NaN),new ee(n,l,a,s)}function ft(n){if(n instanceof ee)return new ee(n.h,n.s,n.l,n.opacity);if(n instanceof ul||(n=pc(n)),!n)return new ee;if(n instanceof ee)return n;n=n.rgb();var l=n.r/255,a=n.g/255,s=n.b/255,o=Math.min(l,a,s),h=Math.max(l,a,s),v=NaN,m=h-o,E=(h+o)/2;return m?(l===h?v=(a-s)/m+(a<s)*6:a===h?v=(s-l)/m+2:v=(l-a)/m+4,m/=E<.5?h+o:2-h-o,v*=60):m=E>0&&E<1?0:v,new ee(v,m,E,n.opacity)}function zt(n,l,a,s){return arguments.length===1?ft(n):new ee(n,l,a,s==null?1:s)}function ee(n,l,a,s){this.h=+n,this.s=+l,this.l=+a,this.opacity=+s}Wc(ee,zt,hc(ul,{brighter:function(n){return n=n==null?Ms:Math.pow(Ms,n),new ee(this.h,this.s,this.l*n,this.opacity)},darker:function(n){return n=n==null?Fs:Math.pow(Fs,n),new ee(this.h,this.s,this.l*n,this.opacity)},rgb:function(){var n=this.h%360+(this.h<0)*360,l=isNaN(n)||isNaN(this.s)?0:this.s,a=this.l,s=a+(a<.5?a:1-a)*l,o=2*a-s;return new S(Re(n>=240?n-240:n+120,o,s),Re(n,o,s),Re(n<120?n+240:n-120,o,s),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var n=this.opacity;return n=isNaN(n)?1:Math.max(0,Math.min(1,n)),(n===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(n===1?")":", "+n+")")}}));function Re(n,l,a){return(n<60?l+(a-l)*n/60:n<180?a:n<240?l+(a-l)*(240-n)/60:l)*255}function De(n){return typeof n=="string"?!!d3.color(n):!1}function ke(n){var l=pc(n),a=[0,0,0,0];return l!=null&&(a[0]=l.r/255,a[1]=l.g/255,a[2]=l.b/255,a[3]=l.opacity),a}function cr(n){var l=n&&n[0],a=n&&n[1],s=n&&n[2],o=l+a*256+s*65536-1;return o}function ar(n){return[n+1&255,n+1>>8&255,n+1>>8>>8&255]}function br(n){var l=Co.document.createElement("canvas"),a=l.getContext("2d");l.width=256,l.height=1;var s=null;if(n.weights){var o=0;n.weights.map(function(V,j){var nt=n.colors[j]||"rgba(0, 0, 0, 0)",at=o+V;a.fillStyle=nt,a.fillRect(o*256,0,at*256,1),o=at})}else{for(var h=a.createLinearGradient(0,0,256,1),v=n.positions[0],m=n.positions[n.positions.length-1],E=0;E<n.colors.length;++E){var A=(n.positions[E]-v)/(m-v);h.addColorStop(A,n.colors[E])}a.fillStyle=h,a.fillRect(0,0,256,1)}if(_u)return s=new Uint8ClampedArray(a.getImageData(0,0,256,1).data),l=null,a=null,{data:s,width:256,height:1};s=a.getImageData(0,0,256,1).data;for(var F=a.createImageData(256,1),B=0;B<F.data.length;B+=4)F.data[B+0]=s[B+0],F.data[B+1]=s[B+1],F.data[B+2]=s[B+2],F.data[B+3]=s[B+3];return l=null,a=null,F}var rr;(function(n){n.CENTER="center",n.TOP="top",n["TOP-LEFT"]="top-left",n["TOP-RIGHT"]="top-right",n.BOTTOM="bottom",n["BOTTOM-LEFT"]="bottom-left",n["BOTTOM-RIGHT"]="bottom-right",n.LEFT="left",n.RIGHT="right"})(rr||(rr={}));var xr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Pr(n,l,a){var s=n.classList;for(var o in xr)xr.hasOwnProperty(o)&&s.remove("l7-".concat(a,"-anchor-").concat(o));s.add("l7-".concat(a,"-anchor-").concat(l))}function Rr(n,l){return{enable:n,mask:255,func:{cmp:514,ref:l?1:0,mask:255}}}function vn(n,l){if(!n)throw new Error(l||"web worker helper assertion failed.")}var ln={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},bn=ln.self||ln.window||{},Zn=ln.window||ln.self||{},Kn=ln.self||ln.window||{},ci=ln.document||{},Oi=typeof importScripts=="function",na=typeof window!="undefined"&&typeof window.orientation!="undefined",ia=function(){function n(l,a){var s=this;this.name=l,this.workerThread=a,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(o,h){s.resolve=o,s.reject=h})}return n.prototype.postMessage=function(l,a){this.workerThread.postMessage({source:"Main thread",type:l,payload:a})},n.prototype.done=function(l){vn(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(l)},n.prototype.error=function(l){vn(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(l)},n}(),ua=ia,Qa=new Map;function Fi(n){vn(n.source&&!n.url||!n.source&&n.url);var l=Qa.get(n.source||n.url);return l||(n.url&&(l=Ra(n.url),Qa.set(n.url,l)),n.source&&(l=Aa(n.source),Qa.set(n.source,l))),vn(l),l}function Ra(n){if(!n.startsWith("http"))return n;var l=ka(n);return Aa(l)}function Aa(n){var l=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(l)}function ka(n){return`try {
  importScripts('`+n+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function la(n,l,a){l===void 0&&(l=!0);var s=a||new Set;if(n){if(Na(n))s.add(n);else if(Na(n.buffer))s.add(n.buffer);else if(!ArrayBuffer.isView(n)){if(l&&typeof n=="object")for(var o in n)la(n[o],l,s)}}return a===void 0?Array.from(s):[]}function Na(n){return n?n instanceof ArrayBuffer||typeof MessagePort!="undefined"&&n instanceof MessagePort||typeof ImageBitmap!="undefined"&&n instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&n instanceof OffscreenCanvas:!1}var pa=function(){},da=function(){function n(l){this.terminated=!1,this.loadableURL="";var a=l.name,s=l.source,o=l.url;vn(s||o),this.name=a,this.source=s,this.url=o,this.onMessage=pa,this.onError=function(h){return console.log(h)},this.worker=this.createBrowserWorker()}return n.isSupported=function(){return typeof Worker!="undefined"},n.prototype.destroy=function(){this.onMessage=pa,this.onError=pa,this.worker.terminate(),this.terminated=!0},Object.defineProperty(n.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),n.prototype.postMessage=function(l,a){a=a||la(l),this.worker.postMessage(l,a)},n.prototype.getErrorFromErrorEvent=function(l){var a="Failed to load ";return a+="worker "+this.name+" from "+this.url+". ",l.message&&(a+=l.message+" in "),l.lineno&&(a+=":"+l.lineno+":"+l.colno),new Error(a)},n.prototype.createBrowserWorker=function(){var l=this;this.loadableURL=Fi({source:this.source,url:this.url});var a=new Worker(this.loadableURL,{name:this.name});return a.onmessage=function(s){s.data?l.onMessage(s.data):l.onError(new Error("No data received"))},a.onerror=function(s){l.onError(l.getErrorFromErrorEvent(s)),l.terminated=!0},a.onmessageerror=function(s){return console.error("worker "+l.name+", message error: "+s)},a},n}(),Ds=da,ss=function(){return ss=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(n[o]=l[o])}return n},ss.apply(this,arguments)},ou=function(n,l,a,s){function o(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(F){try{A(s.next(F))}catch(B){v(B)}}function E(F){try{A(s.throw(F))}catch(B){v(B)}}function A(F){F.done?h(F.value):o(F.value).then(m,E)}A((s=s.apply(n,l||[])).next())})},Ks=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,o,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(F){return E([A,F])}}function E(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(h=A[0]&2?o.return:A[0]?o.throw||((h=o.return)&&h.call(o),0):o.next)&&!(h=h.call(o,A[1])).done)return h;switch(o=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,o=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(F){A=[6,F],o=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},ls=function(){function n(l){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=l.source,this.url=l.url,this.setProps(l)}return n.prototype.destroy=function(){this.idleQueue.forEach(function(l){return l.destroy()}),this.isDestroyed=!0},n.prototype.setProps=function(l){this.props=ss(ss({},this.props),l),l.name!==void 0&&(this.name=l.name),l.maxConcurrency!==void 0&&(this.maxConcurrency=l.maxConcurrency),l.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=l.maxMobileConcurrency),l.reuseWorkers!==void 0&&(this.reuseWorkers=l.reuseWorkers),l.onDebug!==void 0&&(this.onDebug=l.onDebug)},n.prototype.startJob=function(l,a,s){return a===void 0&&(a=function(o,h,v){return o.done(v)}),s===void 0&&(s=function(o,h){return o.error(h)}),ou(this,void 0,void 0,function(){var o,h=this;return Ks(this,function(v){switch(v.label){case 0:return o=new Promise(function(m){return h.jobQueue.push({name:l,onMessage:a,onError:s,onStart:m}),h}),this.startQueuedJob(),[4,o];case 1:return[2,v.sent()]}})})},n.prototype.startQueuedJob=function(){return ou(this,void 0,void 0,function(){var l,a,s;return Ks(this,function(o){switch(o.label){case 0:if(!this.jobQueue.length)return[2];if(l=this.getAvailableWorker(),!l)return[2];if(a=this.jobQueue.shift(),!a)return[3,4];this.onDebug({message:"Starting job",name:a.name,backlog:this.jobQueue.length,workerThread:l}),s=new ua(a.name,l),l.onMessage=function(h){return a.onMessage(s,h.type,h.payload)},l.onError=function(h){return a.onError(s,h)},a.onStart(s),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,s.result];case 2:return o.sent(),[3,4];case 3:return this.returnWorkerToQueue(l),[7];case 4:return[2]}})})},n.prototype.returnWorkerToQueue=function(l){var a=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();a?(l.destroy(),this.count--):this.idleQueue.push(l),this.isDestroyed||this.startQueuedJob()},n.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var l=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new Ds({name:l,source:this.source,url:this.url})}return null},n.prototype.getMaxConcurrency=function(){return na?this.maxMobileConcurrency:this.maxConcurrency},n}(),cs=ls,vu=function(){return vu=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(n[o]=l[o])}return n},vu.apply(this,arguments)},Du=function(n){var l=typeof Symbol=="function"&&Symbol.iterator,a=l&&n[l],s=0;if(a)return a.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")},kc={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},qu=function(){function n(l){this.workerPools=new Map,this.props=vu({},kc),this.setProps(l),this.workerPools=new Map}return n.isSupported=function(){return Ds.isSupported()},n.getWorkerFarm=function(l){return l===void 0&&(l={}),n.workerFarm=n.workerFarm||new n({}),n.workerFarm.setProps(l),n.workerFarm},n.prototype.destroy=function(){var l,a;try{for(var s=Du(this.workerPools.values()),o=s.next();!o.done;o=s.next()){var h=o.value;h.destroy()}}catch(v){l={error:v}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(l)throw l.error}}},n.prototype.setProps=function(l){var a,s;this.props=vu(vu({},this.props),l);try{for(var o=Du(this.workerPools.values()),h=o.next();!h.done;h=o.next()){var v=h.value;v.setProps(this.getWorkerPoolProps())}}catch(m){a={error:m}}finally{try{h&&!h.done&&(s=o.return)&&s.call(o)}finally{if(a)throw a.error}}},n.prototype.getWorkerPool=function(l){var a=l.name,s=l.source,o=l.url,h=this.workerPools.get(a);return h||(h=new cs({name:a,source:s,url:o}),h.setProps(this.getWorkerPoolProps()),this.workerPools.set(a,h)),h},n.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},n}(),Kl=qu,cl=new Map,yh=function(){function n(){}return Object.defineProperty(n,"onmessage",{set:function(l){self.onmessage=function(a){if(!!Ql(a)){var s=a.data,o=s.type,h=s.payload;l(o,h)}}},enumerable:!1,configurable:!0}),n.addEventListener=function(l){var a=cl.get(l);a||(a=function(s){if(!!Ql(s)){var o=s.data,h=o.type,v=o.payload;l(h,v)}}),self.addEventListener("message",a)},n.removeEventListener=function(l){var a=cl.get(l);cl.delete(l),self.removeEventListener("message",a)},n.postMessage=function(l,a){if(self){var s={source:"Worker thread",type:l,payload:a},o=la(a);self.postMessage(s,o)}},n}(),El=yh;function Ql(n){var l=n.type,a=n.data;return l==="message"&&a&&typeof a.source=="string"&&a.source==="Main thread"}function _h(n){return JSON.parse(Yf(n))}function Yf(n){var l=new Set;return JSON.stringify(n,function(a,s){if(typeof s=="object"&&s!==null){if(l.has(s))try{return JSON.parse(JSON.stringify(s))}catch(o){return}l.add(s)}return s})}function dc(n){return""+n.name}function xh(n,l){l===void 0&&(l={});var a=l[n.id]||{},s=n.name+".worker.js",o=a.workerUrl;return l._workerType==="test"&&(o=n.module+"/dist/"+s),o||(o="https://unpkg.com/"+n.module+"/dist/"+s),assert(o),o}var Jl=function(n,l,a,s){function o(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(F){try{A(s.next(F))}catch(B){v(B)}}function E(F){try{A(s.throw(F))}catch(B){v(B)}}function A(F){F.done?h(F.value):o(F.value).then(m,E)}A((s=s.apply(n,l||[])).next())})},js=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,o,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(F){return E([A,F])}}function E(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(h=A[0]&2?o.return:A[0]?o.throw||((h=o.return)&&h.call(o),0):o.next)&&!(h=h.call(o,A[1])).done)return h;switch(o=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,o=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(F){A=[6,F],o=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}};function $c(n,l){return WorkerFarm.isSupported()?n.worker&&(l==null?void 0:l.worker):!1}function Tf(n,l,a,s){return a===void 0&&(a={}),s===void 0&&(s={}),Jl(this,void 0,void 0,function(){var o,h,v,m,E,A,F,B;return js(this,function(V){switch(V.label){case 0:return o=getWorkerName(n),h=getWorkerURL(n,a),v=WorkerFarm.getWorkerFarm(a),m=v.getWorkerPool({name:o,url:h}),E=a.jobName||n.name,[4,m.startJob(E,vc.bind(null,s))];case 1:return A=V.sent(),F=removeNontransferableOptions(a),A.postMessage("process",{input:l,options:F}),[4,A.result];case 2:return B=V.sent(),[2,B.result]}})})}function vc(n,l,a,s){return Jl(this,void 0,void 0,function(){var o,h,v,m,E,A,F;return js(this,function(B){switch(B.label){case 0:switch(o=a,o){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return l.done(s),[3,9];case 2:return l.error(new Error(s.error)),[3,9];case 3:h=s.id,v=s.input,m=s.options,B.label=4;case 4:return B.trys.push([4,6,,7]),n.process?[4,n.process(v,m)]:(l.postMessage("error",{id:h,error:"Worker not set up to process on main thread"}),[2]);case 5:return E=B.sent(),l.postMessage("done",{id:h,result:E}),[3,7];case 6:return A=B.sent(),F=A instanceof Error?A.message:"unknown error",l.postMessage("error",{id:h,error:F}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+a),B.label=9;case 9:return[2]}})})}var Lo=function(){function n(){this._values=[],this._settlers=[],this._closed=!1}return n.prototype[Symbol.asyncIterator]=function(){return this},n.prototype.push=function(l){return this.enqueue(l)},n.prototype.enqueue=function(l){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var a=this._settlers.shift();l instanceof Error?a.reject(l):a.resolve({value:l})}else this._values.push(l)},n.prototype.close=function(){for(;this._settlers.length>0;){var l=this._settlers.shift();l.resolve({done:!0})}this._closed=!0},n.prototype.next=function(){var l=this;if(this._values.length>0){var a=this._values.shift();return a instanceof Error?Promise.reject(a):Promise.resolve({done:!1,value:a})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(s,o){l._settlers.push({resolve:s,reject:o})})},n}(),Sl=Lo,Ku=function(n,l,a,s){function o(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(F){try{A(s.next(F))}catch(B){v(B)}}function E(F){try{A(s.throw(F))}catch(B){v(B)}}function A(F){F.done?h(F.value):o(F.value).then(m,E)}A((s=s.apply(n,l||[])).next())})},qc=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,o,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(F){return E([A,F])}}function E(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(h=A[0]&2?o.return:A[0]?o.throw||((h=o.return)&&h.call(o),0):o.next)&&!(h=h.call(o,A[1])).done)return h;switch(o=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,o=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(F){A=[6,F],o=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},Kc=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=n[Symbol.asyncIterator],a;return l?l.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),a={},s("next"),s("throw"),s("return"),a[Symbol.asyncIterator]=function(){return this},a);function s(h){a[h]=n[h]&&function(v){return new Promise(function(m,E){v=n[h](v),o(m,E,v.done,v.value)})}}function o(h,v,m,E){Promise.resolve(E).then(function(A){h({value:A,done:m})},v)}},$f=0,Qc,Bu;function bh(n,l){var a=this;if(typeof self!="undefined"){var s={process:tc};El.onmessage=function(o,h){return Ku(a,void 0,void 0,function(){var v,m,E,A,F,B,V,j,nt,at,mt;return qc(this,function(Bt){switch(Bt.label){case 0:switch(Bt.trys.push([0,19,,20]),v=o,v){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!n)throw new Error("Worker does not support atomic processing");return[4,n(h.input,h.options||{},s)];case 2:return m=Bt.sent(),El.postMessage("done",{result:m}),[3,18];case 3:if(!l)throw new Error("Worker does not support batched processing");Qc=new Sl,Bu=h.options||{},E=l(Qc,Bu,s),Bt.label=4;case 4:Bt.trys.push([4,9,10,15]),A=Kc(E),Bt.label=5;case 5:return[4,A.next()];case 6:if(F=Bt.sent(),!!F.done)return[3,8];B=F.value,El.postMessage("output-batch",{result:B}),Bt.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return V=Bt.sent(),at={error:V},[3,15];case 10:return Bt.trys.push([10,,13,14]),F&&!F.done&&(mt=A.return)?[4,mt.call(A)]:[3,12];case 11:Bt.sent(),Bt.label=12;case 12:return[3,14];case 13:if(at)throw at.error;return[7];case 14:return[7];case 15:return El.postMessage("done",{}),[3,18];case 16:return Qc.push(h.input),[3,18];case 17:return Qc.close(),[3,18];case 18:return[3,20];case 19:return j=Bt.sent(),nt=j instanceof Error?j.message:"",El.postMessage("error",{error:nt}),[3,20];case 20:return[2]}})})}}}function tc(n,l){return l===void 0&&(l={}),new Promise(function(a,s){var o=$f++,h=function(m,E){if(E.id===o)switch(m){case"done":El.removeEventListener(h),a(E.result);break;case"error":El.removeEventListener(h),s(E.error);break;default:}};El.addEventListener(h);var v={id:o,input:n,options:l};El.postMessage("process",v)})}var Jc=function(n,l,a,s){function o(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(F){try{A(s.next(F))}catch(B){v(B)}}function E(F){try{A(s.throw(F))}catch(B){v(B)}}function A(F){F.done?h(F.value):o(F.value).then(m,E)}A((s=s.apply(n,l||[])).next())})},Eh=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,o,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(F){return E([A,F])}}function E(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(h=A[0]&2?o.return:A[0]?o.throw||((h=o.return)&&h.call(o),0):o.next)&&!(h=h.call(o,A[1])).done)return h;switch(o=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,o=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(F){A=[6,F],o=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},kl={};function Cu(n,l,a){return l===void 0&&(l=null),a===void 0&&(a={}),Jc(this,void 0,void 0,function(){return Eh(this,function(s){switch(s.label){case 0:return l&&(n=sp(n,l,a)),kl[n]=kl[n]||wd(n),[4,kl[n]];case 1:return[2,s.sent()]}})})}function sp(n,l,a){if(n.startsWith("http"))return n;var s=a.modules||{};return s[n]?s[n]:a.CDN?(assert(a.CDN.startsWith("http")),a.CDN+"/"+l+"/dist/libs/"+n):isWorker?"../src/libs/"+n:"modules/"+l+"/src/libs/"+n}function wd(n){return Jc(this,void 0,void 0,function(){var l,a,s;return Eh(this,function(o){switch(o.label){case 0:return n.endsWith("wasm")?[4,fetch(n)]:[3,3];case 1:return l=o.sent(),[4,l.arrayBuffer()];case 2:return[2,o.sent()];case 3:return isWorker?[2,importScripts(n)]:[4,fetch(n)];case 4:return a=o.sent(),[4,a.text()];case 5:return s=o.sent(),[2,uv(s,n)]}})})}function uv(n,l){if(isWorker)return eval.call(global,n),null;var a=document.createElement("script");a.id=l;try{a.appendChild(document.createTextNode(n))}catch(s){a.text=n}return document.body.appendChild(a),null}var lv="0.0.3",G0={id:"null",name:"null",module:"web-worker-helper",options:{}};function Up(n){var l=n.color;return!l||!l.length?[1,1,1,1]:l}function Lc(n,l,a){return a.length===2?[a[0],a[1],0]:[a[0],a[1],a[2]]}function tf(n){var l=n.filter;return l?[1]:[0]}function Sh(n,l){return[l]}var cv=ot(9187),wl=ot.n(cv),ei=ot(31437),Cd=ei.Ue(),Gm=ei.Ue(),Bs=ei.Ue(),Mf=ei.Ue(),Zp=ei.Ue();function ef(n,l,a,s,o){ei.IH(n,a,s),ei.Fv(n,n),l=ei.al(-n[1],n[0]);var h=ei.al(-a[1],a[0]);return[o/ei.AK(l,h),l]}function Cl(n,l){return ei.t8(n,-l[1],l[0])}function Pc(n,l,a){return ei.lu(n,l,a),ei.Fv(n,n),n}function Vp(n,l){return n[0]===l[0]&&n[1]===l[1]}function wh(n){for(var l=new Map,a=0;a<n.length;a++){var s=n[0].toString()+"-"+n[1].toString();l.get(s)?(n.splice(a,1),a++):l.set(s,s)}return n}var fv=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,lt.Z)(this,n),(0,W.Z)(this,"lastFlip",-1),(0,W.Z)(this,"miter",ei.al(0,0)),(0,W.Z)(this,"started",!1),(0,W.Z)(this,"dash",!1),(0,W.Z)(this,"totalDistance",0),(0,W.Z)(this,"currentIndex",0),this.join=l.join||"miter",this.cap=l.cap||"butt",this.miterLimit=l.miterLimit||10,this.thickness=l.thickness||1,this.dash=l.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,tt.Z)(n,[{key:"extrude_gaode2",value:function(a,s){var o=this.complex;if(a.length<=1)return o;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=o.startIndex,m=1;m<h;m++){var E,A,F,B=a[m-1];B.push((E=s[m-1][2])!==null&&E!==void 0?E:0);var V=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var nt=s[m],at=m<a.length-1?[].concat((0,ge.Z)(a[m+1]),[(F=s[m+1][2])!==null&&F!==void 0?F:0]):null,mt=m<s.length-1?s[m+1]:null,Bt=this.segment_gaode2(o,v,B,j,at,V,nt,mt);v+=Bt}if(this.dash)for(var de=0;de<o.positions.length/6;de++)o.positions[de*6+5]=this.totalDistance;return o.startIndex=o.positions.length/6,o}},{key:"simpleExtrude_gaode2",value:function(a,s){var o=this.complex;if(a.length<=1)return o;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=o.startIndex,m=1;m<h;m++){var E,A,F,B=a[m-1];B.push((E=s[m-1][2])!==null&&E!==void 0?E:0);var V=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var nt=s[m],at=m<a.length-1?[].concat((0,ge.Z)(a[m+1]),[(F=s[m+1][2])!==null&&F!==void 0?F:0]):null,mt=m<s.length-1?s[m+1]:null,Bt=this.simpleSegment(o,v,B,j,at,V,nt,mt);v+=Bt}if(this.dash)for(var de=0;de<o.positions.length/6;de++)o.positions[de*6+5]=this.totalDistance;return o.startIndex=o.positions.length/6,o}},{key:"extrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var o=a.length,h=s.startIndex,v=1;v<o;v++){var m=a[v-1],E=a[v],A=v<a.length-1?a[v+1]:null,F=this.segment(s,h,m,E,A);h+=F}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"simpleExtrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var o=a.length,h=s.startIndex,v=1;v<o;v++){var m=a[v-1],E=a[v],A=v<a.length-1?a[v+1]:null,F=this.simpleSegment(s,h,m,E,A);h+=F}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"segment_gaode2",value:function(a,s,o,h,v,m,E,A){var F=0,B=a.indices,V=a.positions,j=a.normals,nt=this.cap==="square",at=this.join==="bevel",mt=Ko([E[0],E[1]]),Bt=Ko([m[0],m[1]]);Pc(Bs,h,o);var de=0;if(this.dash&&(de=this.lineSegmentDistance(mt,Bt),this.totalDistance+=de),this.normal||(this.normal=ei.Ue(),Cl(this.normal,Bs)),!this.started)if(this.started=!0,nt){var ce=ei.Ue(),Be=ei.Ue();ei.IH(ce,this.normal,Bs),ei.IH(Be,this.normal,Bs),j.push(Be[0],Be[1],0),j.push(ce[0],ce[1],0),V.push(o[0],o[1],o[2]|0,this.totalDistance-de,-this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),V.push(o[0],o[1],o[2]|0,this.totalDistance-de,this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(V,j,o,this.normal,this.thickness,this.totalDistance-de);if(B.push(s+0,s+1,s+2),v){Vp(h,v)&&ei.IH(v,h,ei.Fv(v,ei.$X(v,h,o))),Pc(Mf,v,h);var Ir=ef(Zp,ei.Ue(),Bs,Mf,this.thickness),Nr=(0,ht.Z)(Ir,2),Yr=Nr[0],yn=Nr[1],fn=ei.AK(Zp,this.normal)<0?-1:1,$n=at;if(!$n&&this.join==="miter"){var di=Yr;di>this.miterLimit&&($n=!0)}$n?(j.push(this.normal[0],this.normal[1],0),j.push(yn[0],yn[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,B.push.apply(B,(0,ge.Z)(this.lastFlip!==-fn?[s,s+2,s+3]:[s+2,s+1,s+3])),B.push(s+2,s+3,s+4),Cl(Cd,Mf),ei.JG(this.normal,Cd),j.push(this.normal[0],this.normal[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,F+=3):(this.extrusions(V,j,h,yn,Yr,this.totalDistance),B.push.apply(B,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),fn=-1,ei.JG(this.normal,yn),F+=2),this.lastFlip=fn}else{if(Cl(this.normal,Bs),nt){var Xe=ei.Ue(),_r=ei.Ue();ei.lu(_r,Bs,this.normal),ei.IH(Xe,Bs,this.normal),j.push(_r[0],_r[1],0),j.push(Xe[0],Xe[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(V,j,h,this.normal,this.thickness,this.totalDistance);B.push.apply(B,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),F+=2}return F}},{key:"simpleSegment",value:function(a,s,o,h,v){var m=0,E=a.indices,A=a.positions,F=a.normals,B=Ko([h[0],h[1]]),V=Ko([o[0],o[1]]);Pc(Bs,B,V);var j=0;if(this.dash&&(j=this.lineSegmentDistance(B,V),this.totalDistance+=j),this.normal||(this.normal=ei.Ue(),Cl(this.normal,Bs)),this.started||(this.started=!0,this.extrusions(A,F,o,this.normal,this.thickness,this.totalDistance-j)),E.push(s+0,s+1,s+2),!v)Cl(this.normal,Bs),this.extrusions(A,F,h,this.normal,this.thickness,this.totalDistance),E.push.apply(E,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2;else{var nt=Ko([v[0],v[1]]);Vp(B,nt)&&ei.IH(nt,B,ei.Fv(nt,ei.$X(nt,B,V))),Pc(Mf,nt,B);var at=ef(Zp,ei.Ue(),Bs,Mf,this.thickness),mt=(0,ht.Z)(at,2),Bt=mt[0],de=mt[1],ce=ei.AK(Zp,this.normal)<0?-1:1;this.extrusions(A,F,h,de,Bt,this.totalDistance),E.push.apply(E,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),ce=-1,ei.JG(this.normal,de),m+=2,this.lastFlip=ce}return m}},{key:"segment",value:function(a,s,o,h,v){var m=0,E=a.indices,A=a.positions,F=a.normals,B=this.cap==="square",V=this.join==="bevel",j=Ko([h[0],h[1]]),nt=Ko([o[0],o[1]]);Pc(Bs,j,nt);var at=0;if(this.dash&&(at=this.lineSegmentDistance(j,nt),this.totalDistance+=at),this.normal||(this.normal=ei.Ue(),Cl(this.normal,Bs)),!this.started)if(this.started=!0,B){var mt=ei.Ue(),Bt=ei.Ue();ei.IH(mt,this.normal,Bs),ei.IH(Bt,this.normal,Bs),F.push(Bt[0],Bt[1],0),F.push(mt[0],mt[1],0),A.push(o[0],o[1],o[2]|0,this.totalDistance-at,-this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),A.push(o[0],o[1],o[2]|0,this.totalDistance-at,this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,F,o,this.normal,this.thickness,this.totalDistance-at);if(E.push(s+0,s+1,s+2),v){var Be=Ko([v[0],v[1]]);Vp(j,Be)&&ei.IH(Be,j,ei.Fv(Be,ei.$X(Be,j,nt))),Pc(Mf,Be,j);var Xe=ef(Zp,ei.Ue(),Bs,Mf,this.thickness),_r=(0,ht.Z)(Xe,2),Ir=_r[0],Nr=_r[1],Yr=ei.AK(Zp,this.normal)<0?-1:1,yn=V;if(!yn&&this.join==="miter"){var fn=Ir;fn>this.miterLimit&&(yn=!0)}yn?(F.push(this.normal[0],this.normal[1],0),F.push(Nr[0],Nr[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,E.push.apply(E,(0,ge.Z)(this.lastFlip!==-Yr?[s,s+2,s+3]:[s+2,s+1,s+3])),E.push(s+2,s+3,s+4),Cl(Cd,Mf),ei.JG(this.normal,Cd),F.push(this.normal[0],this.normal[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,m+=3):(this.extrusions(A,F,h,Nr,Ir,this.totalDistance),E.push.apply(E,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),Yr=-1,ei.JG(this.normal,Nr),m+=2),this.lastFlip=Yr}else{if(Cl(this.normal,Bs),B){var de=ei.Ue(),ce=ei.Ue();ei.lu(ce,Bs,this.normal),ei.IH(de,Bs,this.normal),F.push(ce[0],ce[1],0),F.push(de[0],de[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,F,h,this.normal,this.thickness,this.totalDistance);E.push.apply(E,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2}return m}},{key:"extrusions",value:function(a,s,o,h,v,m){s.push(h[0],h[1],0),s.push(h[0],h[1],0),a.push(o[0],o[1],o[2]|0,m,-v,o[2]|0),this.complex.indexes.push(this.currentIndex),a.push(o[0],o[1],o[2]|0,m,v,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(a,s){var o=s[0]-a[0],h=s[1]-a[1];return Math.sqrt(o*o+h*h)}}]),n}();function Ns(n){var l=n.coordinates,a=n.originCoordinates,s=n.version,o=new fv({dash:!0,join:"bevel"});if(s==="GAODE2.x"){var h=l;Array.isArray(h[0][0])||(h=[l]);var v=a;Array.isArray(v[0][0])||(v=[a]);for(var m=0;m<h.length;m++){var E=h[m],A=v[m];o.extrude_gaode2(E,A)}}else{var F=l;F[0]&&!Array.isArray(F[0][0])&&(F=[l]),F.forEach(function(V){o.extrude(V)})}var B=o.complex;return{vertices:B.positions,indices:B.indices,normals:B.normals,indexes:B.indexes,size:6}}function qf(n){var l=bs(n.coordinates);return{vertices:[].concat((0,ge.Z)(l),(0,ge.Z)(l),(0,ge.Z)(l),(0,ge.Z)(l)),indices:[0,1,2,2,3,0],size:l.length}}function Ad(n){for(var l=n.coordinates,a=wl().flatten(l),s=a.vertices,o=a.dimensions,h=a.holes,v=0;v<s.length;v+=o)s[v+1]=gc(s[v+1]);for(var m=wl()(s,h,o),E=0;E<s.length;E+=o)s[E+1]=hv(s[E+1]);return{indices:m,vertices:s,size:o}}function gc(n){return n>85||n<-85?n:Math.log(Math.tan(Math.PI*n/360))}function hv(n){return n>85||n<-85?n:Math.atan(Math.exp(n))*360/Math.PI}var Td=function(){var n=(0,ut.Z)(it().mark(function l(a){var s,o,h,v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return s=a.descriptors,o=a.features,h=a.enablePicking,v=a.iconMap,m={a_Color:Up,a_Position:Lc,filter:tf,a_vertexId:Sh,a_PickingColor:function(at){var mt=at.id;return h?ar(mt):[0,0,0]},a_DistanceAndIndex:function(at,mt,Bt,de,ce,Be){return Be===void 0?[Bt[3],10]:[Bt[3],Be]},a_Total_Distance:function(at,mt,Bt){return[Bt[5]]},a_Size:function(at){var mt=at.size,Bt=mt===void 0?1:mt;return Array.isArray(Bt)?[Bt[0],Bt[1]]:[Bt,0]},a_Normal:function(at,mt,Bt,de,ce){return ce},a_Miter:function(at,mt,Bt){return[Bt[4]]},a_iconMapUV:function(at){var mt=at.texture,Bt=v[mt]||{x:0,y:0},de=Bt.x,ce=Bt.y;return[de,ce]}},E={sizePerElement:0,elements:[]},A=0,F=[],B=3,o.forEach(function(nt,at){var mt=Ns(nt),Bt=mt.indices,de=mt.vertices,ce=mt.normals,Be=mt.size,Xe=mt.indexes;Bt.forEach(function(Yr){F.push(Yr+A)}),B=Be;var _r=de.length/Be;E.sizePerElement=B,E.elements.push({featureIdx:at,vertices:de,normals:ce,offset:A}),A+=_r;for(var Ir=function(yn){var fn=(ce==null?void 0:ce.slice(yn*3,yn*3+3))||[],$n=de.slice(yn*Be,yn*Be+Be),di=0;Xe&&Xe[yn]!==void 0&&(di=Xe[yn]),s.forEach(function(Yi){if(Yi&&m[Yi.name]){var ho;(ho=Yi.buffer.data).push.apply(ho,(0,ge.Z)(m[Yi.name](nt,at,$n,yn,fn,di)))}})},Nr=0;Nr<_r;Nr++)Ir(Nr)}),j.abrupt("return",{descriptors:s,featureLayout:E,indices:F});case 8:case"end":return j.stop()}},l)}));return function(a){return n.apply(this,arguments)}}(),pv=function(){var n=(0,ut.Z)(it().mark(function l(a){var s,o,h,v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return s=a.descriptors,o=a.features,h=a.enablePicking,v=a.shape2d,m={a_Color:Up,a_Position:Lc,filter:tf,a_vertexId:Sh,a_PickingColor:function(at){var mt=at.id;return h?ar(mt):[0,0,0]},a_Shape:function(at){var mt=at.shape,Bt=mt===void 0?2:mt,de=v.indexOf(Bt);return[de]},a_Extrude:function(at,mt,Bt,de){var ce=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],Be=de%4*3;return[ce[Be],ce[Be+1],ce[Be+2]]},a_Size:function(at){var mt=at.size,Bt=mt===void 0?5:mt;return Array.isArray(Bt)?[Bt[0]]:[Bt]}},E={sizePerElement:0,elements:[]},A=0,F=[],B=3,o.forEach(function(nt,at){var mt=qf(nt),Bt=mt.indices,de=mt.vertices,ce=mt.normals,Be=mt.size,Xe=mt.indexes;Bt.forEach(function(Yr){F.push(Yr+A)}),B=Be;var _r=de.length/Be;E.sizePerElement=B,E.elements.push({featureIdx:at,vertices:de,normals:ce,offset:A}),A+=_r;for(var Ir=function(yn){var fn=(ce==null?void 0:ce.slice(yn*3,yn*3+3))||[],$n=de.slice(yn*Be,yn*Be+Be),di=0;Xe&&Xe[yn]!==void 0&&(di=Xe[yn]),s.forEach(function(Yi){if(Yi&&m[Yi.name]){var ho;(ho=Yi.buffer.data).push.apply(ho,(0,ge.Z)(m[Yi.name](nt,at,$n,yn,fn,di)))}})},Nr=0;Nr<_r;Nr++)Ir(Nr)}),j.abrupt("return",{descriptors:s,featureLayout:E,indices:F});case 8:case"end":return j.stop()}},l)}));return function(a){return n.apply(this,arguments)}}(),Md=function(){var n=(0,ut.Z)(it().mark(function l(a){var s,o,h,v,m,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return s=a.descriptors,o=a.features,h=a.enablePicking,v={a_Color:Up,a_Position:Lc,filter:tf,a_vertexId:Sh,a_PickingColor:function(nt){var at=nt.id;return h?ar(at):[0,0,0]}},m={sizePerElement:0,elements:[]},E=0,A=[],F=3,o.forEach(function(j,nt){var at=Ad(j),mt=at.indices,Bt=at.vertices,de=at.normals,ce=at.size,Be=at.indexes;mt.forEach(function(Nr){A.push(Nr+E)}),F=ce;var Xe=Bt.length/ce;m.sizePerElement=F,m.elements.push({featureIdx:nt,vertices:Bt,normals:de,offset:E}),E+=Xe;for(var _r=function(Yr){var yn=(de==null?void 0:de.slice(Yr*3,Yr*3+3))||[],fn=Bt.slice(Yr*ce,Yr*ce+ce),$n=0;Be&&Be[Yr]!==void 0&&($n=Be[Yr]),s.forEach(function(di){if(di&&v[di.name]){var Yi;(Yi=di.buffer.data).push.apply(Yi,(0,ge.Z)(v[di.name](j,nt,fn,Yr,yn,$n)))}})},Ir=0;Ir<Xe;Ir++)_r(Ir)}),V.abrupt("return",{descriptors:s,featureLayout:m,indices:A});case 8:case"end":return V.stop()}},l)}));return function(a){return n.apply(this,arguments)}}(),Kf={pointFill:pv,line:Td,polygonFill:Md},up=(0,K.Z)({},Kf);function Id(n){return Gp.apply(this,arguments)}function Gp(){return Gp=(0,ut.Z)(it().mark(function n(l){var a,s;return it().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(a=l.workerType,s=l.data,!up[a]){h.next=3;break}return h.abrupt("return",up[a](s));case 3:return h.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(a,'" non-existent.'))));case 4:case"end":return h.stop()}},n)})),Gp.apply(this,arguments)}bh(Id);var Qf=new Map;function dv(n,l){Qf.set(n,l)}function rf(n){var l=Qf.get(n);return l}var vv=`var L7=function(t){"use strict";function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(){r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:E(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var h={};function p(){}function v(){}function d(){}var y={};c(y,a,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(k([])));m&&m!==e&&n.call(m,a)&&(y=m);var x=d.prototype=p.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){var r;o(this,"_invoke",{value:function(o,i){function a(){return new e((function(r,a){!function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return I()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=A(a,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function A(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,h;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function k(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return v.prototype=d,o(x,"constructor",{value:d,configurable:!0}),o(d,"constructor",{value:v,configurable:!0}),v.displayName=c(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,u,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(x),c(x,s,"Generator"),c(x,a,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function n(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,s,"next",t)}function s(t){n(a,o,i,u,s,"throw",t)}u(void 0)}))}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(t){if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function b(t,e){return t(e={exports:{}},e.exports),e.exports}var w,E,A=function(t){return t&&t.Math==Math&&t},O=A("object"==typeof globalThis&&globalThis)||A("object"==typeof window&&window)||A("object"==typeof self&&self)||A("object"==typeof x&&x)||function(){return this}()||Function("return this")(),S=Object.defineProperty,T=function(t,e){try{S(O,t,{value:e,configurable:!0,writable:!0})}catch(r){O[t]=e}return e},k=O["__core-js_shared__"]||T("__core-js_shared__",{}),I=b((function(t){(t.exports=function(t,e){return k[t]||(k[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.26.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.1/LICENSE",source:"https://github.com/zloirock/core-js"})})),j=function(t){try{return!!t()}catch(t){return!0}},P=!j((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),_=Function.prototype,M=_.call,L=P&&_.bind.bind(M,M),R=P?L:function(t){return function(){return M.apply(t,arguments)}},C=function(t){return null==t},N=TypeError,D=function(t){if(C(t))throw N("Can't call method on "+t);return t},F=Object,W=function(t){return F(D(t))},z=R({}.hasOwnProperty),B=Object.hasOwn||function(t,e){return z(W(t),e)},U=0,G=Math.random(),H=R(1..toString),V=function(t){return"Symbol("+(void 0===t?"":t)+")_"+H(++U+G,36)},q="object"==typeof document&&document.all,Z={all:q,IS_HTMLDDA:void 0===q&&void 0!==q},Y=Z.all,$=Z.IS_HTMLDDA?function(t){return"function"==typeof t||t===Y}:function(t){return"function"==typeof t},K=function(t){return $(t)?t:void 0},Q=function(t,e){return arguments.length<2?K(O[t]):O[t]&&O[t][e]},X=Q("navigator","userAgent")||"",J=O.process,tt=O.Deno,et=J&&J.versions||tt&&tt.version,rt=et&&et.v8;rt&&(E=(w=rt.split("."))[0]>0&&w[0]<4?1:+(w[0]+w[1])),!E&&X&&(!(w=X.match(/Edge\\/(\\d+)/))||w[1]>=74)&&(w=X.match(/Chrome\\/(\\d+)/))&&(E=+w[1]);var nt=E,ot=!!Object.getOwnPropertySymbols&&!j((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&nt&&nt<41})),it=ot&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,at=I("wks"),ut=O.Symbol,st=ut&&ut.for,ct=it?ut:ut&&ut.withoutSetter||V,ft=function(t){if(!B(at,t)||!ot&&"string"!=typeof at[t]){var e="Symbol."+t;ot&&B(ut,t)?at[t]=ut[t]:at[t]=it&&st?st(e):ct(e)}return at[t]},lt={};lt[ft("toStringTag")]="z";var ht="[object z]"===String(lt),pt=!j((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),vt=Z.all,dt=Z.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:$(t)||t===vt}:function(t){return"object"==typeof t?null!==t:$(t)},yt=O.document,gt=dt(yt)&&dt(yt.createElement),mt=function(t){return gt?yt.createElement(t):{}},xt=!pt&&!j((function(){return 7!=Object.defineProperty(mt("div"),"a",{get:function(){return 7}}).a})),bt=pt&&j((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),wt=String,Et=TypeError,At=function(t){if(dt(t))return t;throw Et(wt(t)+" is not an object")},Ot=Function.prototype.call,St=P?Ot.bind(Ot):function(){return Ot.apply(Ot,arguments)},Tt=R({}.isPrototypeOf),kt=Object,It=it?function(t){return"symbol"==typeof t}:function(t){var e=Q("Symbol");return $(e)&&Tt(e.prototype,kt(t))},jt=String,Pt=function(t){try{return jt(t)}catch(t){return"Object"}},_t=TypeError,Mt=function(t){if($(t))return t;throw _t(Pt(t)+" is not a function")},Lt=function(t,e){var r=t[e];return C(r)?void 0:Mt(r)},Rt=TypeError,Ct=TypeError,Nt=ft("toPrimitive"),Dt=function(t,e){if(!dt(t)||It(t))return t;var r,n=Lt(t,Nt);if(n){if(void 0===e&&(e="default"),r=St(n,t,e),!dt(r)||It(r))return r;throw Ct("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var r,n;if("string"===e&&$(r=t.toString)&&!dt(n=St(r,t)))return n;if($(r=t.valueOf)&&!dt(n=St(r,t)))return n;if("string"!==e&&$(r=t.toString)&&!dt(n=St(r,t)))return n;throw Rt("Can't convert object to primitive value")}(t,e)},Ft=function(t){var e=Dt(t,"string");return It(e)?e:e+""},Wt=TypeError,zt=Object.defineProperty,Bt=Object.getOwnPropertyDescriptor,Ut={f:pt?bt?function(t,e,r){if(At(t),e=Ft(e),At(r),"function"==typeof t&&"prototype"===e&&"value"in r&&"writable"in r&&!r.writable){var n=Bt(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return zt(t,e,r)}:zt:function(t,e,r){if(At(t),e=Ft(e),At(r),xt)try{return zt(t,e,r)}catch(t){}if("get"in r||"set"in r)throw Wt("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},Gt=Function.prototype,Ht=pt&&Object.getOwnPropertyDescriptor,Vt=B(Gt,"name"),qt={EXISTS:Vt,PROPER:Vt&&"something"===function(){}.name,CONFIGURABLE:Vt&&(!pt||pt&&Ht(Gt,"name").configurable)},Zt=R(Function.toString);$(k.inspectSource)||(k.inspectSource=function(t){return Zt(t)});var Yt,$t,Kt,Qt=k.inspectSource,Xt=O.WeakMap,Jt=$(Xt)&&/native code/.test(String(Xt)),te=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},ee=pt?function(t,e,r){return Ut.f(t,e,te(1,r))}:function(t,e,r){return t[e]=r,t},re=I("keys"),ne=function(t){return re[t]||(re[t]=V(t))},oe={},ie=O.TypeError,ae=O.WeakMap;if(Jt||k.state){var ue=k.state||(k.state=new ae);ue.get=ue.get,ue.has=ue.has,ue.set=ue.set,Yt=function(t,e){if(ue.has(t))throw ie("Object already initialized");return e.facade=t,ue.set(t,e),e},$t=function(t){return ue.get(t)||{}},Kt=function(t){return ue.has(t)}}else{var se=ne("state");oe[se]=!0,Yt=function(t,e){if(B(t,se))throw ie("Object already initialized");return e.facade=t,ee(t,se,e),e},$t=function(t){return B(t,se)?t[se]:{}},Kt=function(t){return B(t,se)}}var ce={set:Yt,get:$t,has:Kt,enforce:function(t){return Kt(t)?$t(t):Yt(t,{})},getterFor:function(t){return function(e){var r;if(!dt(e)||(r=$t(e)).type!==t)throw ie("Incompatible receiver, "+t+" required");return r}}},fe=b((function(t){var e=qt.CONFIGURABLE,r=ce.enforce,n=ce.get,o=Object.defineProperty,i=pt&&!j((function(){return 8!==o((function(){}),"length",{value:8}).length})),a=String(String).split("String"),u=t.exports=function(t,n,u){"Symbol("===String(n).slice(0,7)&&(n="["+String(n).replace(/^Symbol\\(([^)]*)\\)/,"$1")+"]"),u&&u.getter&&(n="get "+n),u&&u.setter&&(n="set "+n),(!B(t,"name")||e&&t.name!==n)&&(pt?o(t,"name",{value:n,configurable:!0}):t.name=n),i&&u&&B(u,"arity")&&t.length!==u.arity&&o(t,"length",{value:u.arity});try{u&&B(u,"constructor")&&u.constructor?pt&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var s=r(t);return B(s,"source")||(s.source=a.join("string"==typeof n?n:"")),t};Function.prototype.toString=u((function(){return $(this)&&n(this).source||Qt(this)}),"toString")})),le=function(t,e,r,n){n||(n={});var o=n.enumerable,i=void 0!==n.name?n.name:e;if($(r)&&fe(r,i,n),n.global)o?t[e]=r:T(e,r);else{try{n.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=r:Ut.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},he=R({}.toString),pe=R("".slice),ve=function(t){return pe(he(t),8,-1)},de=ft("toStringTag"),ye=Object,ge="Arguments"==ve(function(){return arguments}()),me=ht?ve:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=ye(t),de))?r:ge?ve(e):"Object"==(n=ve(e))&&$(e.callee)?"Arguments":n},xe=ht?{}.toString:function(){return"[object "+me(this)+"]"};ht||le(Object.prototype,"toString",xe,{unsafe:!0});var be={}.propertyIsEnumerable,we=Object.getOwnPropertyDescriptor,Ee={f:we&&!be.call({1:2},1)?function(t){var e=we(this,t);return!!e&&e.enumerable}:be},Ae=Object,Oe=R("".split),Se=j((function(){return!Ae("z").propertyIsEnumerable(0)}))?function(t){return"String"==ve(t)?Oe(t,""):Ae(t)}:Ae,Te=function(t){return Se(D(t))},ke=Object.getOwnPropertyDescriptor,Ie={f:pt?ke:function(t,e){if(t=Te(t),e=Ft(e),xt)try{return ke(t,e)}catch(t){}if(B(t,e))return te(!St(Ee.f,t,e),t[e])}},je=Math.ceil,Pe=Math.floor,_e=Math.trunc||function(t){var e=+t;return(e>0?Pe:je)(e)},Me=function(t){var e=+t;return e!=e||0===e?0:_e(e)},Le=Math.max,Re=Math.min,Ce=function(t,e){var r=Me(t);return r<0?Le(r+e,0):Re(r,e)},Ne=Math.min,De=function(t){return t>0?Ne(Me(t),9007199254740991):0},Fe=function(t){return De(t.length)},We=function(t){return function(e,r,n){var o,i=Te(e),a=Fe(i),u=Ce(n,a);if(t&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}},ze={includes:We(!0),indexOf:We(!1)},Be=ze.indexOf,Ue=R([].push),Ge=function(t,e){var r,n=Te(t),o=0,i=[];for(r in n)!B(oe,r)&&B(n,r)&&Ue(i,r);for(;e.length>o;)B(n,r=e[o++])&&(~Be(i,r)||Ue(i,r));return i},He=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ve=He.concat("length","prototype"),qe={f:Object.getOwnPropertyNames||function(t){return Ge(t,Ve)}},Ze={f:Object.getOwnPropertySymbols},Ye=R([].concat),$e=Q("Reflect","ownKeys")||function(t){var e=qe.f(At(t)),r=Ze.f;return r?Ye(e,r(t)):e},Ke=function(t,e,r){for(var n=$e(e),o=Ut.f,i=Ie.f,a=0;a<n.length;a++){var u=n[a];B(t,u)||r&&B(r,u)||o(t,u,i(e,u))}},Qe=/#|\\.prototype\\./,Xe=function(t,e){var r=tr[Je(t)];return r==rr||r!=er&&($(e)?j(e):!!e)},Je=Xe.normalize=function(t){return String(t).replace(Qe,".").toLowerCase()},tr=Xe.data={},er=Xe.NATIVE="N",rr=Xe.POLYFILL="P",nr=Xe,or=Ie.f,ir=function(t,e){var r,n,o,i,a,u=t.target,s=t.global,c=t.stat;if(r=s?O:c?O[u]||T(u,{}):(O[u]||{}).prototype)for(n in e){if(i=e[n],o=t.dontCallGetSet?(a=or(r,n))&&a.value:r[n],!nr(s?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Ke(i,o)}(t.sham||o&&o.sham)&&ee(i,"sham",!0),le(r,n,i,t)}},ar="process"==ve(O.process),ur=String,sr=TypeError,cr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=R(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return At(r),function(t){if("object"==typeof t||$(t))return t;throw sr("Can't set "+ur(t)+" as a prototype")}(n),e?t(r,n):r.__proto__=n,r}}():void 0),fr=Ut.f,lr=ft("toStringTag"),hr=function(t,e,r){t&&!r&&(t=t.prototype),t&&!B(t,lr)&&fr(t,lr,{configurable:!0,value:e})},pr=ft("species"),vr=function(t){var e=Q(t),r=Ut.f;pt&&e&&!e[pr]&&r(e,pr,{configurable:!0,get:function(){return this}})},dr=TypeError,yr=function(t,e){if(Tt(e,t))return t;throw dr("Incorrect invocation")},gr=function(){},mr=[],xr=Q("Reflect","construct"),br=/^\\s*(?:class|function)\\b/,wr=R(br.exec),Er=!br.exec(gr),Ar=function(t){if(!$(t))return!1;try{return xr(gr,mr,t),!0}catch(t){return!1}},Or=function(t){if(!$(t))return!1;switch(me(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Er||!!wr(br,Qt(t))}catch(t){return!0}};Or.sham=!0;var Sr,Tr,kr,Ir,jr=!xr||j((function(){var t;return Ar(Ar.call)||!Ar(Object)||!Ar((function(){t=!0}))||t}))?Or:Ar,Pr=TypeError,_r=function(t){if(jr(t))return t;throw Pr(Pt(t)+" is not a constructor")},Mr=ft("species"),Lr=function(t,e){var r,n=At(t).constructor;return void 0===n||C(r=At(n)[Mr])?e:_r(r)},Rr=Function.prototype,Cr=Rr.apply,Nr=Rr.call,Dr="object"==typeof Reflect&&Reflect.apply||(P?Nr.bind(Cr):function(){return Nr.apply(Cr,arguments)}),Fr=function(t){if("Function"===ve(t))return R(t)},Wr=Fr(Fr.bind),zr=function(t,e){return Mt(t),void 0===e?t:P?Wr(t,e):function(){return t.apply(e,arguments)}},Br=Q("document","documentElement"),Ur=R([].slice),Gr=TypeError,Hr=function(t,e){if(t<e)throw Gr("Not enough arguments");return t},Vr=/(?:ipad|iphone|ipod).*applewebkit/i.test(X),qr=O.setImmediate,Zr=O.clearImmediate,Yr=O.process,$r=O.Dispatch,Kr=O.Function,Qr=O.MessageChannel,Xr=O.String,Jr=0,tn={};try{Sr=O.location}catch(t){}var en=function(t){if(B(tn,t)){var e=tn[t];delete tn[t],e()}},rn=function(t){return function(){en(t)}},nn=function(t){en(t.data)},on=function(t){O.postMessage(Xr(t),Sr.protocol+"//"+Sr.host)};qr&&Zr||(qr=function(t){Hr(arguments.length,1);var e=$(t)?t:Kr(t),r=Ur(arguments,1);return tn[++Jr]=function(){Dr(e,void 0,r)},Tr(Jr),Jr},Zr=function(t){delete tn[t]},ar?Tr=function(t){Yr.nextTick(rn(t))}:$r&&$r.now?Tr=function(t){$r.now(rn(t))}:Qr&&!Vr?(Ir=(kr=new Qr).port2,kr.port1.onmessage=nn,Tr=zr(Ir.postMessage,Ir)):O.addEventListener&&$(O.postMessage)&&!O.importScripts&&Sr&&"file:"!==Sr.protocol&&!j(on)?(Tr=on,O.addEventListener("message",nn,!1)):Tr="onreadystatechange"in mt("script")?function(t){Br.appendChild(mt("script")).onreadystatechange=function(){Br.removeChild(this),en(t)}}:function(t){setTimeout(rn(t),0)});var an,un,sn,cn,fn,ln,hn,pn,vn={set:qr,clear:Zr},dn=/ipad|iphone|ipod/i.test(X)&&void 0!==O.Pebble,yn=/web0s(?!.*chrome)/i.test(X),gn=Ie.f,mn=vn.set,xn=O.MutationObserver||O.WebKitMutationObserver,bn=O.document,wn=O.process,En=O.Promise,An=gn(O,"queueMicrotask"),On=An&&An.value;On||(an=function(){var t,e;for(ar&&(t=wn.domain)&&t.exit();un;){e=un.fn,un=un.next;try{e()}catch(t){throw un?cn():sn=void 0,t}}sn=void 0,t&&t.enter()},Vr||ar||yn||!xn||!bn?!dn&&En&&En.resolve?((hn=En.resolve(void 0)).constructor=En,pn=zr(hn.then,hn),cn=function(){pn(an)}):ar?cn=function(){wn.nextTick(an)}:(mn=zr(mn,O),cn=function(){mn(an)}):(fn=!0,ln=bn.createTextNode(""),new xn(an).observe(ln,{characterData:!0}),cn=function(){ln.data=fn=!fn}));var Sn=On||function(t){var e={fn:t,next:void 0};sn&&(sn.next=e),un||(un=e,cn()),sn=e},Tn=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},kn=function(){this.head=null,this.tail=null};kn.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var In,jn,Pn,_n=kn,Mn=O.Promise,Ln="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Rn=!Ln&&!ar&&"object"==typeof window&&"object"==typeof document,Cn=(Mn&&Mn.prototype,ft("species")),Nn=!1,Dn=$(O.PromiseRejectionEvent),Fn={CONSTRUCTOR:nr("Promise",(function(){var t=Qt(Mn),e=t!==String(Mn);if(!e&&66===nt)return!0;if(!nt||nt<51||!/native code/.test(t)){var r=new Mn((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[Cn]=n,!(Nn=r.then((function(){}))instanceof n))return!0}return!e&&(Rn||Ln)&&!Dn})),REJECTION_EVENT:Dn,SUBCLASSING:Nn},Wn=TypeError,zn=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw Wn("Bad Promise constructor");e=t,r=n})),this.resolve=Mt(e),this.reject=Mt(r)},Bn={f:function(t){return new zn(t)}},Un=vn.set,Gn=Fn.CONSTRUCTOR,Hn=Fn.REJECTION_EVENT,Vn=Fn.SUBCLASSING,qn=ce.getterFor("Promise"),Zn=ce.set,Yn=Mn&&Mn.prototype,$n=Mn,Kn=Yn,Qn=O.TypeError,Xn=O.document,Jn=O.process,to=Bn.f,eo=to,ro=!!(Xn&&Xn.createEvent&&O.dispatchEvent),no=function(t){var e;return!(!dt(t)||!$(e=t.then))&&e},oo=function(t,e){var r,n,o,i=e.value,a=1==e.state,u=a?t.ok:t.fail,s=t.resolve,c=t.reject,f=t.domain;try{u?(a||(2===e.rejection&&co(e),e.rejection=1),!0===u?r=i:(f&&f.enter(),r=u(i),f&&(f.exit(),o=!0)),r===t.promise?c(Qn("Promise-chain cycle")):(n=no(r))?St(n,r,s,c):s(r)):c(i)}catch(t){f&&!o&&f.exit(),c(t)}},io=function(t,e){t.notified||(t.notified=!0,Sn((function(){for(var r,n=t.reactions;r=n.get();)oo(r,t);t.notified=!1,e&&!t.rejection&&uo(t)})))},ao=function(t,e,r){var n,o;ro?((n=Xn.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),O.dispatchEvent(n)):n={promise:e,reason:r},!Hn&&(o=O["on"+t])?o(n):"unhandledrejection"===t&&function(t,e){var r=O.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)},uo=function(t){St(Un,O,(function(){var e,r=t.facade,n=t.value;if(so(t)&&(e=Tn((function(){ar?Jn.emit("unhandledRejection",n,r):ao("unhandledrejection",r,n)})),t.rejection=ar||so(t)?2:1,e.error))throw e.value}))},so=function(t){return 1!==t.rejection&&!t.parent},co=function(t){St(Un,O,(function(){var e=t.facade;ar?Jn.emit("rejectionHandled",e):ao("rejectionhandled",e,t.value)}))},fo=function(t,e,r){return function(n){t(e,n,r)}},lo=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,io(t,!0))},ho=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Qn("Promise can't be resolved itself");var n=no(e);n?Sn((function(){var r={done:!1};try{St(n,e,fo(ho,r,t),fo(lo,r,t))}catch(e){lo(r,e,t)}})):(t.value=e,t.state=1,io(t,!1))}catch(e){lo({done:!1},e,t)}}};if(Gn&&(Kn=($n=function(t){yr(this,Kn),Mt(t),St(In,this);var e=qn(this);try{t(fo(ho,e),fo(lo,e))}catch(t){lo(e,t)}}).prototype,(In=function(t){Zn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new _n,rejection:!1,state:0,value:void 0})}).prototype=le(Kn,"then",(function(t,e){var r=qn(this),n=to(Lr(this,$n));return r.parent=!0,n.ok=!$(t)||t,n.fail=$(e)&&e,n.domain=ar?Jn.domain:void 0,0==r.state?r.reactions.add(n):Sn((function(){oo(n,r)})),n.promise})),jn=function(){var t=new In,e=qn(t);this.promise=t,this.resolve=fo(ho,e),this.reject=fo(lo,e)},Bn.f=to=function(t){return t===$n||void 0===t?new jn(t):eo(t)},$(Mn)&&Yn!==Object.prototype)){Pn=Yn.then,Vn||le(Yn,"then",(function(t,e){var r=this;return new $n((function(t,e){St(Pn,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete Yn.constructor}catch(t){}cr&&cr(Yn,Kn)}ir({global:!0,constructor:!0,wrap:!0,forced:Gn},{Promise:$n}),hr($n,"Promise",!1),vr("Promise");var po={},vo=ft("iterator"),yo=Array.prototype,go=function(t){return void 0!==t&&(po.Array===t||yo[vo]===t)},mo=ft("iterator"),xo=function(t){if(!C(t))return Lt(t,mo)||Lt(t,"@@iterator")||po[me(t)]},bo=TypeError,wo=function(t,e){var r=arguments.length<2?xo(t):e;if(Mt(r))return At(St(r,t));throw bo(Pt(t)+" is not iterable")},Eo=function(t,e,r){var n,o;At(t);try{if(!(n=Lt(t,"return"))){if("throw"===e)throw r;return r}n=St(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw r;if(o)throw n;return At(n),r},Ao=TypeError,Oo=function(t,e){this.stopped=t,this.result=e},So=Oo.prototype,To=function(t,e,r){var n,o,i,a,u,s,c,f=r&&r.that,l=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),v=!(!r||!r.INTERRUPTED),d=zr(e,f),y=function(t){return n&&Eo(n,"normal",t),new Oo(!0,t)},g=function(t){return l?(At(t),v?d(t[0],t[1],y):d(t[0],t[1])):v?d(t,y):d(t)};if(h)n=t.iterator;else if(p)n=t;else{if(!(o=xo(t)))throw Ao(Pt(t)+" is not iterable");if(go(o)){for(i=0,a=Fe(t);a>i;i++)if((u=g(t[i]))&&Tt(So,u))return u;return new Oo(!1)}n=wo(t,o)}for(s=h?t.next:n.next;!(c=St(s,n)).done;){try{u=g(c.value)}catch(t){Eo(n,"throw",t)}if("object"==typeof u&&u&&Tt(So,u))return u}return new Oo(!1)},ko=ft("iterator"),Io=!1;try{var jo=0,Po={next:function(){return{done:!!jo++}},return:function(){Io=!0}};Po[ko]=function(){return this},Array.from(Po,(function(){throw 2}))}catch(t){}var _o=function(t,e){if(!e&&!Io)return!1;var r=!1;try{var n={};n[ko]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},Mo=Fn.CONSTRUCTOR||!_o((function(t){Mn.all(t).then(void 0,(function(){}))}));ir({target:"Promise",stat:!0,forced:Mo},{all:function(t){var e=this,r=Bn.f(e),n=r.resolve,o=r.reject,i=Tn((function(){var r=Mt(e.resolve),i=[],a=0,u=1;To(t,(function(t){var s=a++,c=!1;u++,St(r,e,t).then((function(t){c||(c=!0,i[s]=t,--u||n(i))}),o)})),--u||n(i)}));return i.error&&o(i.value),r.promise}});var Lo=Fn.CONSTRUCTOR,Ro=Mn&&Mn.prototype;if(ir({target:"Promise",proto:!0,forced:Lo,real:!0},{catch:function(t){return this.then(void 0,t)}}),$(Mn)){var Co=Q("Promise").prototype.catch;Ro.catch!==Co&&le(Ro,"catch",Co,{unsafe:!0})}ir({target:"Promise",stat:!0,forced:Mo},{race:function(t){var e=this,r=Bn.f(e),n=r.reject,o=Tn((function(){var o=Mt(e.resolve);To(t,(function(t){St(o,e,t).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}}),ir({target:"Promise",stat:!0,forced:Fn.CONSTRUCTOR},{reject:function(t){var e=Bn.f(this);return St(e.reject,void 0,t),e.promise}});var No=Fn.CONSTRUCTOR;Q("Promise");function Do(t,e){if(!t)throw new Error(e||"web worker helper assertion failed.")}ir({target:"Promise",stat:!0,forced:No},{resolve:function(t){return function(t,e){if(At(t),dt(e)&&e.constructor===t)return e;var r=Bn.f(t);return(0,r.resolve)(e),r.promise}(this,t)}});var Fo="undefined"!=typeof window&&void 0!==window.orientation,Wo=function(){function t(t,e){var r=this;this.name=t,this.workerThread=e,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise((function(t,e){r.resolve=t,r.reject=e}))}return t.prototype.postMessage=function(t,e){this.workerThread.postMessage({source:"Main thread",type:t,payload:e})},t.prototype.done=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},t.prototype.error=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},t}(),zo=new Map;function Bo(t){Do(t.source&&!t.url||!t.source&&t.url);var e=zo.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Uo((e=t,"try {\\n  importScripts('"+e+"');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}"));var e}(t.url),zo.set(t.url,e)),t.source&&(e=Uo(t.source),zo.set(t.source,e))),Do(e),e}function Uo(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Go(t,e,r){void 0===e&&(e=!0);var n=r||new Set;if(t){if(Ho(t))n.add(t);else if(Ho(t.buffer))n.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(var o in t)Go(t[o],e,n)}else;return void 0===r?Array.from(n):[]}function Ho(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var Vo=function(){},qo=function(){function t(t){this.terminated=!1,this.loadableURL="";var e=t.name,r=t.source,n=t.url;Do(r||n),this.name=e,this.source=r,this.url=n,this.onMessage=Vo,this.onError=function(t){return console.log(t)},this.worker=this.createBrowserWorker()}return t.isSupported=function(){return"undefined"!=typeof Worker},t.prototype.destroy=function(){this.onMessage=Vo,this.onError=Vo,this.worker.terminate(),this.terminated=!0},Object.defineProperty(t.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),t.prototype.postMessage=function(t,e){e=e||Go(t),this.worker.postMessage(t,e)},t.prototype.getErrorFromErrorEvent=function(t){var e="Failed to load ";return e+="worker "+this.name+" from "+this.url+". ",t.message&&(e+=t.message+" in "),t.lineno&&(e+=":"+t.lineno+":"+t.colno),new Error(e)},t.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=Bo({source:this.source,url:this.url});var e=new Worker(this.loadableURL,{name:this.name});return e.onmessage=function(e){e.data?t.onMessage(e.data):t.onError(new Error("No data received"))},e.onerror=function(e){t.onError(t.getErrorFromErrorEvent(e)),t.terminated=!0},e.onmessageerror=function(e){return console.error("worker "+t.name+", message error: "+e)},e},t}(),Zo=self&&self.__assign||function(){return(Zo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Yo=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},$o=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ko=function(){function t(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return t.prototype.destroy=function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0},t.prototype.setProps=function(t){this.props=Zo(Zo({},this.props),t),void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)},t.prototype.startJob=function(t,e,r){return void 0===e&&(e=function(t,e,r){return t.done(r)}),void 0===r&&(r=function(t,e){return t.error(e)}),Yo(this,void 0,void 0,(function(){var n,o=this;return $o(this,(function(i){switch(i.label){case 0:return n=new Promise((function(n){return o.jobQueue.push({name:t,onMessage:e,onError:r,onStart:n}),o})),this.startQueuedJob(),[4,n];case 1:return[2,i.sent()]}}))}))},t.prototype.startQueuedJob=function(){return Yo(this,void 0,void 0,(function(){var t,e,r;return $o(this,(function(n){switch(n.label){case 0:if(!this.jobQueue.length)return[2];if(!(t=this.getAvailableWorker()))return[2];if(!(e=this.jobQueue.shift()))return[3,4];this.onDebug({message:"Starting job",name:e.name,backlog:this.jobQueue.length,workerThread:t}),r=new Wo(e.name,t),t.onMessage=function(t){return e.onMessage(r,t.type,t.payload)},t.onError=function(t){return e.onError(r,t)},e.onStart(r),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r.result];case 2:return n.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}}))}))},t.prototype.returnWorkerToQueue=function(t){this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},t.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new qo({name:t,source:this.source,url:this.url})}return null},t.prototype.getMaxConcurrency=function(){return Fo?this.maxMobileConcurrency:this.maxConcurrency},t}(),Qo=self&&self.__assign||function(){return(Qo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Xo=self&&self.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Jo={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},ti=(function(){function t(t){this.workerPools=new Map,this.props=Qo({},Jo),this.setProps(t),this.workerPools=new Map}t.isSupported=function(){return qo.isSupported()},t.getWorkerFarm=function(e){return void 0===e&&(e={}),t.workerFarm=t.workerFarm||new t({}),t.workerFarm.setProps(e),t.workerFarm},t.prototype.destroy=function(){var t,e;try{for(var r=Xo(this.workerPools.values()),n=r.next();!n.done;n=r.next()){n.value.destroy()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.setProps=function(t){var e,r;this.props=Qo(Qo({},this.props),t);try{for(var n=Xo(this.workerPools.values()),o=n.next();!o.done;o=n.next()){o.value.setProps(this.getWorkerPoolProps())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.getWorkerPool=function(t){var e=t.name,r=t.source,n=t.url,o=this.workerPools.get(e);return o||((o=new Ko({name:e,source:r,url:n})).setProps(this.getWorkerPoolProps()),this.workerPools.set(e,o)),o},t.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(),new Map),ei=function(){function t(){}return Object.defineProperty(t,"onmessage",{set:function(t){self.onmessage=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}},enumerable:!1,configurable:!0}),t.addEventListener=function(t){var e=ti.get(t);e||(e=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}),self.addEventListener("message",e)},t.removeEventListener=function(t){var e=ti.get(t);ti.delete(t),self.removeEventListener("message",e)},t.postMessage=function(t,e){if(self){var r={source:"Worker thread",type:t,payload:e},n=Go(e);self.postMessage(r,n)}},t}();function ri(t){var e=t.type,r=t.data;return"message"===e&&r&&"string"==typeof r.source&&"Main thread"===r.source}self&&self.__awaiter,self&&self.__generator;var ni,oi,ii=function(){function t(){this._values=[],this._settlers=[],this._closed=!1}return t.prototype[Symbol.asyncIterator]=function(){return this},t.prototype.push=function(t){return this.enqueue(t)},t.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var e=this._settlers.shift();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.push(t)},t.prototype.close=function(){for(;this._settlers.length>0;){this._settlers.shift().resolve({done:!0})}this._closed=!0},t.prototype.next=function(){var t=this;if(this._values.length>0){var e=this._values.shift();return e instanceof Error?Promise.reject(e):Promise.resolve({done:!1,value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise((function(e,r){t._settlers.push({resolve:e,reject:r})}))},t}(),ai=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},ui=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},si=self&&self.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}},ci=0;function fi(t,e){var r=this;if("undefined"!=typeof self){var n={process:li};ei.onmessage=function(o,i){return ai(r,void 0,void 0,(function(){var r,a,u,s,c,f,l,h,p,v;return ui(this,(function(d){switch(d.label){case 0:switch(d.trys.push([0,19,,20]),o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!t)throw new Error("Worker does not support atomic processing");return[4,t(i.input,i.options||{},n)];case 2:return r=d.sent(),ei.postMessage("done",{result:r}),[3,18];case 3:if(!e)throw new Error("Worker does not support batched processing");ni=new ii,oi=i.options||{},a=e(ni,oi,n),d.label=4;case 4:d.trys.push([4,9,10,15]),u=si(a),d.label=5;case 5:return[4,u.next()];case 6:if((s=d.sent()).done)return[3,8];c=s.value,ei.postMessage("output-batch",{result:c}),d.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return f=d.sent(),p={error:f},[3,15];case 10:return d.trys.push([10,,13,14]),s&&!s.done&&(v=u.return)?[4,v.call(u)]:[3,12];case 11:d.sent(),d.label=12;case 12:return[3,14];case 13:if(p)throw p.error;return[7];case 14:return[7];case 15:return ei.postMessage("done",{}),[3,18];case 16:return ni.push(i.input),[3,18];case 17:return ni.close(),[3,18];case 18:return[3,20];case 19:return l=d.sent(),h=l instanceof Error?l.message:"",ei.postMessage("error",{error:h}),[3,20];case 20:return[2]}}))}))}}}function li(t,e){return void 0===e&&(e={}),new Promise((function(r,n){var o=ci++,i=function(t,e){if(e.id===o)switch(t){case"done":ei.removeEventListener(i),r(e.result);break;case"error":ei.removeEventListener(i),n(e.error)}};ei.addEventListener(i);var a={id:o,input:t,options:e};ei.postMessage("process",a)}))}self&&self.__awaiter,self&&self.__generator;var hi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},pi=mt("span").classList,vi=pi&&pi.constructor&&pi.constructor.prototype,di=vi===Object.prototype?void 0:vi,yi=Array.isArray||function(t){return"Array"==ve(t)},gi=ft("species"),mi=Array,xi=function(t,e){return new(function(t){var e;return yi(t)&&(e=t.constructor,(jr(e)&&(e===mi||yi(e.prototype))||dt(e)&&null===(e=e[gi]))&&(e=void 0)),void 0===e?mi:e}(t))(0===e?0:e)},bi=R([].push),wi=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,u=5==t||i;return function(s,c,f,l){for(var h,p,v=W(s),d=Se(v),y=zr(c,f),g=Fe(d),m=0,x=l||xi,b=e?x(s,g):r||a?x(s,0):void 0;g>m;m++)if((u||m in d)&&(p=y(h=d[m],m,v),t))if(e)b[m]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return m;case 2:bi(b,h)}else switch(t){case 4:return!1;case 7:bi(b,h)}return i?-1:n||o?o:b}},Ei={forEach:wi(0),map:wi(1),filter:wi(2),some:wi(3),every:wi(4),find:wi(5),findIndex:wi(6),filterReject:wi(7)},Ai=function(t,e){var r=[][t];return!!r&&j((function(){r.call(null,e||function(){return 1},1)}))},Oi=Ei.forEach,Si=Ai("forEach")?[].forEach:function(t){return Oi(this,t,arguments.length>1?arguments[1]:void 0)},Ti=function(t){if(t&&t.forEach!==Si)try{ee(t,"forEach",Si)}catch(e){t.forEach=Si}};for(var ki in hi)hi[ki]&&Ti(O[ki]&&O[ki].prototype);Ti(di);var Ii=function(t,e,r){var n=Ft(e);n in t?Ut.f(t,n,te(0,r)):t[n]=r},ji=ft("species"),Pi=function(t){return nt>=51||!j((function(){var e=[];return(e.constructor={})[ji]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},_i=Pi("slice"),Mi=ft("species"),Li=Array,Ri=Math.max;ir({target:"Array",proto:!0,forced:!_i},{slice:function(t,e){var r,n,o,i=Te(this),a=Fe(i),u=Ce(t,a),s=Ce(void 0===e?a:e,a);if(yi(i)&&(r=i.constructor,(jr(r)&&(r===Li||yi(r.prototype))||dt(r)&&null===(r=r[Mi]))&&(r=void 0),r===Li||void 0===r))return Ur(i,u,s);for(n=new(void 0===r?Li:r)(Ri(s-u,0)),o=0;u<s;u++,o++)u in i&&Ii(n,o,i[u]);return n.length=o,n}});var Ci=qt.EXISTS,Ni=Ut.f,Di=Function.prototype,Fi=R(Di.toString),Wi=/function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/,zi=R(Wi.exec);pt&&!Ci&&Ni(Di,"name",{configurable:!0,get:function(){try{return zi(Wi,Fi(this))[1]}catch(t){return""}}});var Bi=Ei.map,Ui=Pi("map");ir({target:"Array",proto:!0,forced:!Ui},{map:function(t){return Bi(this,t,arguments.length>1?arguments[1]:void 0)}});var Gi,Hi=Object.keys||function(t){return Ge(t,He)},Vi={f:pt&&!bt?Object.defineProperties:function(t,e){At(t);for(var r,n=Te(e),o=Hi(e),i=o.length,a=0;i>a;)Ut.f(t,r=o[a++],n[r]);return t}},qi=ne("IE_PROTO"),Zi=function(){},Yi=function(t){return"<script>"+t+"<\\/script>"},$i=function(t){t.write(Yi("")),t.close();var e=t.parentWindow.Object;return t=null,e},Ki=function(){try{Gi=new ActiveXObject("htmlfile")}catch(t){}var t,e;Ki="undefined"!=typeof document?document.domain&&Gi?$i(Gi):((e=mt("iframe")).style.display="none",Br.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Yi("document.F=Object")),t.close(),t.F):$i(Gi);for(var r=He.length;r--;)delete Ki.prototype[He[r]];return Ki()};oe[qi]=!0;var Qi=Object.create||function(t,e){var r;return null!==t?(Zi.prototype=At(t),r=new Zi,Zi.prototype=null,r[qi]=t):r=Ki(),void 0===e?r:Vi.f(r,e)},Xi=Ut.f,Ji=ft("unscopables"),ta=Array.prototype;null==ta[Ji]&&Xi(ta,Ji,{configurable:!0,value:Qi(null)});var ea,ra,na,oa=function(t){ta[Ji][t]=!0},ia=!j((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),aa=ne("IE_PROTO"),ua=Object,sa=ua.prototype,ca=ia?ua.getPrototypeOf:function(t){var e=W(t);if(B(e,aa))return e[aa];var r=e.constructor;return $(r)&&e instanceof r?r.prototype:e instanceof ua?sa:null},fa=ft("iterator"),la=!1;[].keys&&("next"in(na=[].keys())?(ra=ca(ca(na)))!==Object.prototype&&(ea=ra):la=!0),(!dt(ea)||j((function(){var t={};return ea[fa].call(t)!==t})))&&(ea={}),$(ea[fa])||le(ea,fa,(function(){return this}));var ha={IteratorPrototype:ea,BUGGY_SAFARI_ITERATORS:la},pa=ha.IteratorPrototype,va=function(){return this},da=qt.PROPER,ya=qt.CONFIGURABLE,ga=ha.IteratorPrototype,ma=ha.BUGGY_SAFARI_ITERATORS,xa=ft("iterator"),ba=function(){return this},wa=function(t,e,r,n,o,i,a){!function(t,e,r,n){var o=e+" Iterator";t.prototype=Qi(pa,{next:te(+!n,r)}),hr(t,o,!1),po[o]=va}(r,e,n);var u,s,c,f=function(t){if(t===o&&d)return d;if(!ma&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},l=e+" Iterator",h=!1,p=t.prototype,v=p[xa]||p["@@iterator"]||o&&p[o],d=!ma&&v||f(o),y="Array"==e&&p.entries||v;if(y&&(u=ca(y.call(new t)))!==Object.prototype&&u.next&&(ca(u)!==ga&&(cr?cr(u,ga):$(u[xa])||le(u,xa,ba)),hr(u,l,!0)),da&&"values"==o&&v&&"values"!==v.name&&(ya?ee(p,"name","values"):(h=!0,d=function(){return St(v,this)})),o)if(s={values:f("values"),keys:i?d:f("keys"),entries:f("entries")},a)for(c in s)(ma||h||!(c in p))&&le(p,c,s[c]);else ir({target:e,proto:!0,forced:ma||h},s);return p[xa]!==d&&le(p,xa,d,{name:o}),po[e]=d,s},Ea=function(t,e){return{value:t,done:e}},Aa=Ut.f,Oa=ce.set,Sa=ce.getterFor("Array Iterator"),Ta=wa(Array,"Array",(function(t,e){Oa(this,{type:"Array Iterator",target:Te(t),index:0,kind:e})}),(function(){var t=Sa(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,Ea(void 0,!0)):Ea("keys"==r?n:"values"==r?e[n]:[n,e[n]],!1)}),"values"),ka=po.Arguments=po.Array;if(oa("keys"),oa("values"),oa("entries"),pt&&"values"!==ka.name)try{Aa(ka,"name",{value:"values"})}catch(t){}var Ia,ja,Pa,_a="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Ma=Ut.f,La=ce.enforce,Ra=ce.get,Ca=O.Int8Array,Na=Ca&&Ca.prototype,Da=O.Uint8ClampedArray,Fa=Da&&Da.prototype,Wa=Ca&&ca(Ca),za=Na&&ca(Na),Ba=Object.prototype,Ua=O.TypeError,Ga=ft("toStringTag"),Ha=V("TYPED_ARRAY_TAG"),Va=_a&&!!cr&&"Opera"!==me(O.opera),qa=!1,Za={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ya={BigInt64Array:8,BigUint64Array:8},$a=function(t){var e=ca(t);if(dt(e)){var r=Ra(e);return r&&B(r,"TypedArrayConstructor")?r.TypedArrayConstructor:$a(e)}},Ka=function(t){if(!dt(t))return!1;var e=me(t);return B(Za,e)||B(Ya,e)};for(Ia in Za)(Pa=(ja=O[Ia])&&ja.prototype)?La(Pa).TypedArrayConstructor=ja:Va=!1;for(Ia in Ya)(Pa=(ja=O[Ia])&&ja.prototype)&&(La(Pa).TypedArrayConstructor=ja);if((!Va||!$(Wa)||Wa===Function.prototype)&&(Wa=function(){throw Ua("Incorrect invocation")},Va))for(Ia in Za)O[Ia]&&cr(O[Ia],Wa);if((!Va||!za||za===Ba)&&(za=Wa.prototype,Va))for(Ia in Za)O[Ia]&&cr(O[Ia].prototype,za);if(Va&&ca(Fa)!==za&&cr(Fa,za),pt&&!B(za,Ga))for(Ia in qa=!0,Ma(za,Ga,{get:function(){return dt(this)?this[Ha]:void 0}}),Za)O[Ia]&&ee(O[Ia],Ha,Ia);var Qa={NATIVE_ARRAY_BUFFER_VIEWS:Va,TYPED_ARRAY_TAG:qa&&Ha,aTypedArray:function(t){if(Ka(t))return t;throw Ua("Target is not a typed array")},aTypedArrayConstructor:function(t){if($(t)&&(!cr||Tt(Wa,t)))return t;throw Ua(Pt(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(pt){if(r)for(var o in Za){var i=O[o];if(i&&B(i.prototype,t))try{delete i.prototype[t]}catch(r){try{i.prototype[t]=e}catch(t){}}}za[t]&&!r||le(za,t,r?e:Va&&Na[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(pt){if(cr){if(r)for(n in Za)if((o=O[n])&&B(o,t))try{delete o[t]}catch(t){}if(Wa[t]&&!r)return;try{return le(Wa,t,r?e:Va&&Wa[t]||e)}catch(t){}}for(n in Za)!(o=O[n])||o[t]&&!r||le(o,t,e)}},getTypedArrayConstructor:$a,isView:function(t){if(!dt(t))return!1;var e=me(t);return"DataView"===e||B(Za,e)||B(Ya,e)},isTypedArray:Ka,TypedArray:Wa,TypedArrayPrototype:za},Xa=Qa.NATIVE_ARRAY_BUFFER_VIEWS,Ja=O.ArrayBuffer,tu=O.Int8Array,eu=!Xa||!j((function(){tu(1)}))||!j((function(){new tu(-1)}))||!_o((function(t){new tu,new tu(null),new tu(1.5),new tu(t)}),!0)||j((function(){return 1!==new tu(new Ja(2),1,void 0).length})),ru=function(t,e,r){for(var n in e)le(t,n,e[n],r);return t},nu=RangeError,ou=function(t){if(void 0===t)return 0;var e=Me(t),r=De(e);if(e!==r)throw nu("Wrong length or index");return r},iu=Array,au=Math.abs,uu=Math.pow,su=Math.floor,cu=Math.log,fu=Math.LN2,lu=function(t,e,r){var n,o,i,a=iu(r),u=8*r-e-1,s=(1<<u)-1,c=s>>1,f=23===e?uu(2,-24)-uu(2,-77):0,l=t<0||0===t&&1/t<0?1:0,h=0;for((t=au(t))!=t||t===1/0?(o=t!=t?1:0,n=s):(n=su(cu(t)/fu),t*(i=uu(2,-n))<1&&(n--,i*=2),(t+=n+c>=1?f/i:f*uu(2,1-c))*i>=2&&(n++,i/=2),n+c>=s?(o=0,n=s):n+c>=1?(o=(t*i-1)*uu(2,e),n+=c):(o=t*uu(2,c-1)*uu(2,e),n=0));e>=8;)a[h++]=255&o,o/=256,e-=8;for(n=n<<e|o,u+=e;u>0;)a[h++]=255&n,n/=256,u-=8;return a[--h]|=128*l,a},hu=function(t,e){var r,n=t.length,o=8*n-e-1,i=(1<<o)-1,a=i>>1,u=o-7,s=n-1,c=t[s--],f=127&c;for(c>>=7;u>0;)f=256*f+t[s--],u-=8;for(r=f&(1<<-u)-1,f>>=-u,u+=e;u>0;)r=256*r+t[s--],u-=8;if(0===f)f=1-a;else{if(f===i)return r?NaN:c?-1/0:1/0;r+=uu(2,e),f-=a}return(c?-1:1)*r*uu(2,f-e)},pu=function(t){for(var e=W(this),r=Fe(e),n=arguments.length,o=Ce(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:Ce(i,r);a>o;)e[o++]=t;return e},vu=Array,du=Math.max,yu=function(t,e,r){for(var n=Fe(t),o=Ce(e,n),i=Ce(void 0===r?n:r,n),a=vu(du(i-o,0)),u=0;o<i;o++,u++)Ii(a,u,t[o]);return a.length=u,a},gu=qe.f,mu=Ut.f,xu=qt.PROPER,bu=qt.CONFIGURABLE,wu=ce.get,Eu=ce.set,Au=O.ArrayBuffer,Ou=Au,Su=Ou&&Ou.prototype,Tu=O.DataView,ku=Tu&&Tu.prototype,Iu=Object.prototype,ju=O.Array,Pu=O.RangeError,_u=R(pu),Mu=R([].reverse),Lu=lu,Ru=hu,Cu=function(t){return[255&t]},Nu=function(t){return[255&t,t>>8&255]},Du=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},Fu=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Wu=function(t){return Lu(t,23,4)},zu=function(t){return Lu(t,52,8)},Bu=function(t,e){mu(t.prototype,e,{get:function(){return wu(this)[e]}})},Uu=function(t,e,r,n){var o=ou(r),i=wu(t);if(o+e>i.byteLength)throw Pu("Wrong index");var a=wu(i.buffer).bytes,u=o+i.byteOffset,s=yu(a,u,u+e);return n?s:Mu(s)},Gu=function(t,e,r,n,o,i){var a=ou(r),u=wu(t);if(a+e>u.byteLength)throw Pu("Wrong index");for(var s=wu(u.buffer).bytes,c=a+u.byteOffset,f=n(+o),l=0;l<e;l++)s[c+l]=f[i?l:e-l-1]};if(_a){var Hu=xu&&"ArrayBuffer"!==Au.name;if(j((function(){Au(1)}))&&j((function(){new Au(-1)}))&&!j((function(){return new Au,new Au(1.5),new Au(NaN),1!=Au.length||Hu&&!bu})))Hu&&bu&&ee(Au,"name","ArrayBuffer");else{(Ou=function(t){return yr(this,Su),new Au(ou(t))}).prototype=Su;for(var Vu,qu=gu(Au),Zu=0;qu.length>Zu;)(Vu=qu[Zu++])in Ou||ee(Ou,Vu,Au[Vu]);Su.constructor=Ou}cr&&ca(ku)!==Iu&&cr(ku,Iu);var Yu=new Tu(new Ou(2)),$u=R(ku.setInt8);Yu.setInt8(0,2147483648),Yu.setInt8(1,2147483649),!Yu.getInt8(0)&&Yu.getInt8(1)||ru(ku,{setInt8:function(t,e){$u(this,t,e<<24>>24)},setUint8:function(t,e){$u(this,t,e<<24>>24)}},{unsafe:!0})}else Su=(Ou=function(t){yr(this,Su);var e=ou(t);Eu(this,{bytes:_u(ju(e),0),byteLength:e}),pt||(this.byteLength=e)}).prototype,ku=(Tu=function(t,e,r){yr(this,ku),yr(t,Su);var n=wu(t).byteLength,o=Me(e);if(o<0||o>n)throw Pu("Wrong offset");if(o+(r=void 0===r?n-o:De(r))>n)throw Pu("Wrong length");Eu(this,{buffer:t,byteLength:r,byteOffset:o}),pt||(this.buffer=t,this.byteLength=r,this.byteOffset=o)}).prototype,pt&&(Bu(Ou,"byteLength"),Bu(Tu,"buffer"),Bu(Tu,"byteLength"),Bu(Tu,"byteOffset")),ru(ku,{getInt8:function(t){return Uu(this,1,t)[0]<<24>>24},getUint8:function(t){return Uu(this,1,t)[0]},getInt16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return Ru(Uu(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return Ru(Uu(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Gu(this,1,t,Cu,e)},setUint8:function(t,e){Gu(this,1,t,Cu,e)},setInt16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Gu(this,4,t,Wu,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Gu(this,8,t,zu,e,arguments.length>2?arguments[2]:void 0)}});hr(Ou,"ArrayBuffer"),hr(Tu,"DataView");var Ku={ArrayBuffer:Ou,DataView:Tu},Qu=Math.floor,Xu=Number.isInteger||function(t){return!dt(t)&&isFinite(t)&&Qu(t)===t},Ju=RangeError,ts=RangeError,es=function(t,e){var r=function(t){var e=Me(t);if(e<0)throw Ju("The argument can't be less than 0");return e}(t);if(r%e)throw ts("Wrong offset");return r},rs=R("".slice),ns=function(t){return"Big"===rs(me(t),0,3)},os=TypeError,is=function(t){var e=Dt(t,"number");if("number"==typeof e)throw os("Can't convert number to bigint");return BigInt(e)},as=Qa.aTypedArrayConstructor,us=function(t){var e,r,n,o,i,a,u,s,c=_r(this),f=W(t),l=arguments.length,h=l>1?arguments[1]:void 0,p=void 0!==h,v=xo(f);if(v&&!go(v))for(s=(u=wo(f,v)).next,f=[];!(a=St(s,u)).done;)f.push(a.value);for(p&&l>2&&(h=zr(h,arguments[2])),r=Fe(f),n=new(as(c))(r),o=ns(n),e=0;r>e;e++)i=p?h(f[e],e):f[e],n[e]=o?is(i):+i;return n},ss=function(t,e,r){var n,o;return cr&&$(n=e.constructor)&&n!==r&&dt(o=n.prototype)&&o!==r.prototype&&cr(t,o),t},cs=b((function(t){var e=qe.f,r=Ei.forEach,n=ce.get,o=ce.set,i=ce.enforce,a=Ut.f,u=Ie.f,s=Math.round,c=O.RangeError,f=Ku.ArrayBuffer,l=f.prototype,h=Ku.DataView,p=Qa.NATIVE_ARRAY_BUFFER_VIEWS,v=Qa.TYPED_ARRAY_TAG,d=Qa.TypedArray,y=Qa.TypedArrayPrototype,g=Qa.aTypedArrayConstructor,m=Qa.isTypedArray,x=function(t,e){g(t);for(var r=0,n=e.length,o=new t(n);n>r;)o[r]=e[r++];return o},b=function(t,e){a(t,e,{get:function(){return n(this)[e]}})},w=function(t){var e;return Tt(l,t)||"ArrayBuffer"==(e=me(t))||"SharedArrayBuffer"==e},E=function(t,e){return m(t)&&!It(e)&&e in t&&Xu(+e)&&e>=0},A=function(t,e){return e=Ft(e),E(t,e)?te(2,t[e]):u(t,e)},S=function(t,e,r){return e=Ft(e),!(E(t,e)&&dt(r)&&B(r,"value"))||B(r,"get")||B(r,"set")||r.configurable||B(r,"writable")&&!r.writable||B(r,"enumerable")&&!r.enumerable?a(t,e,r):(t[e]=r.value,t)};pt?(p||(Ie.f=A,Ut.f=S,b(y,"buffer"),b(y,"byteOffset"),b(y,"byteLength"),b(y,"length")),ir({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:A,defineProperty:S}),t.exports=function(t,u,l){var g=t.match(/\\d+$/)[0]/8,b=t+(l?"Clamped":"")+"Array",E="get"+t,A="set"+t,S=O[b],T=S,k=T&&T.prototype,I={},j=function(t,e){a(t,e,{get:function(){return function(t,e){var r=n(t);return r.view[E](e*g+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var o=n(t);l&&(r=(r=s(r))<0?0:r>255?255:255&r),o.view[A](e*g+o.byteOffset,r,!0)}(this,e,t)},enumerable:!0})};p?eu&&(T=u((function(t,e,r,n){return yr(t,k),ss(dt(e)?w(e)?void 0!==n?new S(e,es(r,g),n):void 0!==r?new S(e,es(r,g)):new S(e):m(e)?x(T,e):St(us,T,e):new S(ou(e)),t,T)})),cr&&cr(T,d),r(e(S),(function(t){t in T||ee(T,t,S[t])})),T.prototype=k):(T=u((function(t,e,r,n){yr(t,k);var i,a,u,s=0,l=0;if(dt(e)){if(!w(e))return m(e)?x(T,e):St(us,T,e);i=e,l=es(r,g);var p=e.byteLength;if(void 0===n){if(p%g)throw c("Wrong length");if((a=p-l)<0)throw c("Wrong length")}else if((a=De(n)*g)+l>p)throw c("Wrong length");u=a/g}else u=ou(e),i=new f(a=u*g);for(o(t,{buffer:i,byteOffset:l,byteLength:a,length:u,view:new h(i)});s<u;)j(t,s++)})),cr&&cr(T,d),k=T.prototype=Qi(y)),k.constructor!==T&&ee(k,"constructor",T),i(k).TypedArrayConstructor=T,v&&ee(k,v,b);var P=T!=S;I[b]=T,ir({global:!0,constructor:!0,forced:P,sham:!p},I),"BYTES_PER_ELEMENT"in T||ee(T,"BYTES_PER_ELEMENT",g),"BYTES_PER_ELEMENT"in k||ee(k,"BYTES_PER_ELEMENT",g),vr(b)}):t.exports=function(){}}));cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0);var fs=TypeError,ls=function(t,e){if(!delete t[e])throw fs("Cannot delete property "+Pt(e)+" of "+Pt(t))},hs=Math.min,ps=R([].copyWithin||function(t,e){var r=W(this),n=Fe(r),o=Ce(t,n),i=Ce(e,n),a=arguments.length>2?arguments[2]:void 0,u=hs((void 0===a?n:Ce(a,n))-i,n-o),s=1;for(i<o&&o<i+u&&(s=-1,i+=u-1,o+=u-1);u-- >0;)i in r?r[o]=r[i]:ls(r,o),o+=s,i+=s;return r}),vs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("copyWithin",(function(t,e){return ps(vs(this),t,e,arguments.length>2?arguments[2]:void 0)}));var ds=Ei.every,ys=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("every",(function(t){return ds(ys(this),t,arguments.length>1?arguments[1]:void 0)}));var gs=Qa.aTypedArray,ms=Qa.exportTypedArrayMethod,xs=R("".slice);ms("fill",(function(t){var e=arguments.length;gs(this);var r="Big"===xs(me(this),0,3)?is(t):+t;return St(pu,this,r,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),j((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var bs=Qa.aTypedArrayConstructor,ws=Qa.getTypedArrayConstructor,Es=function(t){return bs(Lr(t,ws(t)))},As=function(t,e){return function(t,e){for(var r=0,n=Fe(e),o=new t(n);n>r;)o[r]=e[r++];return o}(Es(t),e)},Os=Ei.filter,Ss=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("filter",(function(t){var e=Os(Ss(this),t,arguments.length>1?arguments[1]:void 0);return As(this,e)}));var Ts=Ei.find,ks=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("find",(function(t){return Ts(ks(this),t,arguments.length>1?arguments[1]:void 0)}));var Is=Ei.findIndex,js=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("findIndex",(function(t){return Is(js(this),t,arguments.length>1?arguments[1]:void 0)}));var Ps=Ei.forEach,_s=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("forEach",(function(t){Ps(_s(this),t,arguments.length>1?arguments[1]:void 0)}));var Ms=ze.includes,Ls=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("includes",(function(t){return Ms(Ls(this),t,arguments.length>1?arguments[1]:void 0)}));var Rs=ze.indexOf,Cs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("indexOf",(function(t){return Rs(Cs(this),t,arguments.length>1?arguments[1]:void 0)}));var Ns=ft("iterator"),Ds=O.Uint8Array,Fs=R(Ta.values),Ws=R(Ta.keys),zs=R(Ta.entries),Bs=Qa.aTypedArray,Us=Qa.exportTypedArrayMethod,Gs=Ds&&Ds.prototype,Hs=!j((function(){Gs[Ns].call([1])})),Vs=!!Gs&&Gs.values&&Gs[Ns]===Gs.values&&"values"===Gs.values.name,qs=function(){return Fs(Bs(this))};Us("entries",(function(){return zs(Bs(this))}),Hs),Us("keys",(function(){return Ws(Bs(this))}),Hs),Us("values",qs,Hs||!Vs,{name:"values"}),Us(Ns,qs,Hs||!Vs,{name:"values"});var Zs=Qa.aTypedArray,Ys=Qa.exportTypedArrayMethod,$s=R([].join);Ys("join",(function(t){return $s(Zs(this),t)}));var Ks=Math.min,Qs=[].lastIndexOf,Xs=!!Qs&&1/[1].lastIndexOf(1,-0)<0,Js=Ai("lastIndexOf"),tc=Xs||!Js?function(t){if(Xs)return Dr(Qs,this,arguments)||0;var e=Te(this),r=Fe(e),n=r-1;for(arguments.length>1&&(n=Ks(n,Me(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:Qs,ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("lastIndexOf",(function(t){var e=arguments.length;return Dr(tc,ec(this),e>1?[t,arguments[1]]:[t])}));var rc=Ei.map,nc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("map",(function(t){return rc(nc(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(Es(t))(e)}))}));var oc=TypeError,ic=function(t){return function(e,r,n,o){Mt(r);var i=W(e),a=Se(i),u=Fe(i),s=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=c;break}if(s+=c,t?s<0:u<=s)throw oc("Reduce of empty array with no initial value")}for(;t?s>=0:u>s;s+=c)s in a&&(o=r(o,a[s],s,i));return o}},ac={left:ic(!1),right:ic(!0)},uc=ac.left,sc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduce",(function(t){var e=arguments.length;return uc(sc(this),t,e,e>1?arguments[1]:void 0)}));var cc=ac.right,fc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduceRight",(function(t){var e=arguments.length;return cc(fc(this),t,e,e>1?arguments[1]:void 0)}));var lc=Qa.aTypedArray,hc=Qa.exportTypedArrayMethod,pc=Math.floor;hc("reverse",(function(){for(var t,e=lc(this).length,r=pc(e/2),n=0;n<r;)t=this[n],this[n++]=this[--e],this[e]=t;return this}));var vc=O.RangeError,dc=O.Int8Array,yc=dc&&dc.prototype,gc=yc&&yc.set,mc=Qa.aTypedArray,xc=Qa.exportTypedArrayMethod,bc=!j((function(){var t=new Uint8ClampedArray(2);return St(gc,t,{length:1,0:3},1),3!==t[1]})),wc=bc&&Qa.NATIVE_ARRAY_BUFFER_VIEWS&&j((function(){var t=new dc(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));xc("set",(function(t){mc(this);var e=es(arguments.length>1?arguments[1]:void 0,1),r=W(t);if(bc)return St(gc,this,r,e);var n=this.length,o=Fe(r),i=0;if(o+e>n)throw vc("Wrong length");for(;i<o;)this[e+i]=r[i++]}),!bc||wc);var Ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("slice",(function(t,e){for(var r=Ur(Ec(this),t,e),n=Es(this),o=0,i=r.length,a=new n(i);i>o;)a[o]=r[o++];return a}),j((function(){new Int8Array(1).slice()})));var Ac=Ei.some,Oc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("some",(function(t){return Ac(Oc(this),t,arguments.length>1?arguments[1]:void 0)}));var Sc=Math.floor,Tc=function(t,e){var r=t.length,n=Sc(r/2);return r<8?kc(t,e):Ic(t,Tc(yu(t,0,n),e),Tc(yu(t,n),e),e)},kc=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},Ic=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,u=0;a<o||u<i;)t[a+u]=a<o&&u<i?n(e[a],r[u])<=0?e[a++]:r[u++]:a<o?e[a++]:r[u++];return t},jc=Tc,Pc=X.match(/firefox\\/(\\d+)/i),_c=!!Pc&&+Pc[1],Mc=/MSIE|Trident/.test(X),Lc=X.match(/AppleWebKit\\/(\\d+)\\./),Rc=!!Lc&&+Lc[1],Cc=Qa.aTypedArray,Nc=Qa.exportTypedArrayMethod,Dc=O.Uint16Array,Fc=Dc&&Fr(Dc.prototype.sort),Wc=!(!Fc||j((function(){Fc(new Dc(2),null)}))&&j((function(){Fc(new Dc(2),{})}))),zc=!!Fc&&!j((function(){if(nt)return nt<74;if(_c)return _c<67;if(Mc)return!0;if(Rc)return Rc<602;var t,e,r=new Dc(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(Fc(r,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0}));Nc("sort",(function(t){return void 0!==t&&Mt(t),zc?Fc(this,t):jc(Cc(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))}),!zc||Wc);var Bc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("subarray",(function(t,e){var r=Bc(this),n=r.length,o=Ce(t,n);return new(Es(r))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,De((void 0===e?n:Ce(e,n))-o))}));var Uc=O.Int8Array,Gc=Qa.aTypedArray,Hc=Qa.exportTypedArrayMethod,Vc=[].toLocaleString,qc=!!Uc&&j((function(){Vc.call(new Uc(1))}));Hc("toLocaleString",(function(){return Dr(Vc,qc?Ur(Gc(this)):Gc(this),Ur(arguments))}),j((function(){return[1,2].toLocaleString()!=new Uc([1,2]).toLocaleString()}))||!j((function(){Uc.prototype.toLocaleString.call([1,2])})));var Zc=Qa.exportTypedArrayMethod,Yc=O.Uint8Array,$c=Yc&&Yc.prototype||{},Kc=[].toString,Qc=R([].join);j((function(){Kc.call({})}))&&(Kc=function(){return Qc(this)});var Xc=$c.toString!=Kc;Zc("toString",Kc,Xc);var Jc,tf,ef=String,rf=function(t){if("Symbol"===me(t))throw TypeError("Cannot convert a Symbol value to a string");return ef(t)},nf=function(){var t=At(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},of=O.RegExp,af=j((function(){var t=of("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),uf=af||j((function(){return!of("a","y").sticky})),sf={BROKEN_CARET:af||j((function(){var t=of("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:uf,UNSUPPORTED_Y:af},cf=O.RegExp,ff=j((function(){var t=cf(".","s");return!(t.dotAll&&t.exec("\\n")&&"s"===t.flags)})),lf=O.RegExp,hf=j((function(){var t=lf("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),pf=ce.get,vf=I("native-string-replace",String.prototype.replace),df=RegExp.prototype.exec,yf=df,gf=R("".charAt),mf=R("".indexOf),xf=R("".replace),bf=R("".slice),wf=(tf=/b*/g,St(df,Jc=/a/,"a"),St(df,tf,"a"),0!==Jc.lastIndex||0!==tf.lastIndex),Ef=sf.BROKEN_CARET,Af=void 0!==/()??/.exec("")[1];(wf||Af||Ef||ff||hf)&&(yf=function(t){var e,r,n,o,i,a,u,s=this,c=pf(s),f=rf(t),l=c.raw;if(l)return l.lastIndex=s.lastIndex,e=St(yf,l,f),s.lastIndex=l.lastIndex,e;var h=c.groups,p=Ef&&s.sticky,v=St(nf,s),d=s.source,y=0,g=f;if(p&&(v=xf(v,"y",""),-1===mf(v,"g")&&(v+="g"),g=bf(f,s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\\n"!==gf(f,s.lastIndex-1))&&(d="(?: "+d+")",g=" "+g,y++),r=new RegExp("^(?:"+d+")",v)),Af&&(r=new RegExp("^"+d+"$(?!\\\\s)",v)),wf&&(n=s.lastIndex),o=St(df,p?r:s,g),p?o?(o.input=bf(o.input,y),o[0]=bf(o[0],y),o.index=s.lastIndex,s.lastIndex+=o[0].length):s.lastIndex=0:wf&&o&&(s.lastIndex=s.global?o.index+o[0].length:n),Af&&o&&o.length>1&&St(vf,o[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&h)for(o.groups=a=Qi(null),i=0;i<h.length;i++)a[(u=h[i])[0]]=o[u[1]];return o});var Of=yf;ir({target:"RegExp",proto:!0,forced:/./.exec!==Of},{exec:Of});var Sf,Tf=ft("species"),kf=RegExp.prototype,If=function(t,e,r,n){var o=ft(t),i=!j((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),a=i&&!j((function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[Tf]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return e=!0,null},r[o](""),!e}));if(!i||!a||r){var u=Fr(/./[o]),s=e(o,""[t],(function(t,e,r,n,o){var a=Fr(t),s=e.exec;return s===Of||s===kf.exec?i&&!o?{done:!0,value:u(e,r,n)}:{done:!0,value:a(r,e,n)}:{done:!1}}));le(String.prototype,t,s[0]),le(kf,o,s[1])}n&&ee(kf[o],"sham",!0)},jf=R("".charAt),Pf=R("".charCodeAt),_f=R("".slice),Mf=function(t){return function(e,r){var n,o,i=rf(D(e)),a=Me(r),u=i.length;return a<0||a>=u?t?"":void 0:(n=Pf(i,a))<55296||n>56319||a+1===u||(o=Pf(i,a+1))<56320||o>57343?t?jf(i,a):n:t?_f(i,a,a+2):o-56320+(n-55296<<10)+65536}},Lf={codeAt:Mf(!1),charAt:Mf(!0)},Rf=Lf.charAt,Cf=function(t,e,r){return e+(r?Rf(t,e).length:1)},Nf=Math.floor,Df=R("".charAt),Ff=R("".replace),Wf=R("".slice),zf=/\\$([$&'\`]|\\d{1,2}|<[^>]*>)/g,Bf=/\\$([$&'\`]|\\d{1,2})/g,Uf=function(t,e,r,n,o,i){var a=r+t.length,u=n.length,s=Bf;return void 0!==o&&(o=W(o),s=zf),Ff(i,s,(function(i,s){var c;switch(Df(s,0)){case"$":return"$";case"&":return t;case"\`":return Wf(e,0,r);case"'":return Wf(e,a);case"<":c=o[Wf(s,1,-1)];break;default:var f=+s;if(0===f)return i;if(f>u){var l=Nf(f/10);return 0===l?i:l<=u?void 0===n[l-1]?Df(s,1):n[l-1]+Df(s,1):i}c=n[f-1]}return void 0===c?"":c}))},Gf=TypeError,Hf=function(t,e){var r=t.exec;if($(r)){var n=St(r,t,e);return null!==n&&At(n),n}if("RegExp"===ve(t))return St(Of,t,e);throw Gf("RegExp#exec called on incompatible receiver")},Vf=ft("replace"),qf=Math.max,Zf=Math.min,Yf=R([].concat),$f=R([].push),Kf=R("".indexOf),Qf=R("".slice),Xf="$0"==="a".replace(/./,"$0"),Jf=!!/./[Vf]&&""===/./[Vf]("a","$0");function tl(t){this.message=t}If("replace",(function(t,e,r){var n=Jf?"$":"$0";return[function(t,r){var n=D(this),o=C(t)?void 0:Lt(t,Vf);return o?St(o,t,n,r):St(e,rf(n),t,r)},function(t,o){var i=At(this),a=rf(t);if("string"==typeof o&&-1===Kf(o,n)&&-1===Kf(o,"$<")){var u=r(e,i,a,o);if(u.done)return u.value}var s=$(o);s||(o=rf(o));var c=i.global;if(c){var f=i.unicode;i.lastIndex=0}for(var l=[];;){var h=Hf(i,a);if(null===h)break;if($f(l,h),!c)break;""===rf(h[0])&&(i.lastIndex=Cf(a,De(i.lastIndex),f))}for(var p,v="",d=0,y=0;y<l.length;y++){for(var g=rf((h=l[y])[0]),m=qf(Zf(Me(h.index),a.length),0),x=[],b=1;b<h.length;b++)$f(x,void 0===(p=h[b])?p:String(p));var w=h.groups;if(s){var E=Yf([g],x,m,a);void 0!==w&&$f(E,w);var A=rf(Dr(o,void 0,E))}else A=Uf(g,a,m,x,w,o);m>=d&&(v+=Qf(a,d,m)+A,d=m+g.length)}return v+Qf(a,d)}]}),!!j((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!Xf||Jf),tl.prototype=new Error,tl.prototype.name="InvalidCharacterError",ir({global:!0,forced:O.globalThis!==O},{globalThis:O}),Sf="undefined"==typeof window?{devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(t){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,e,r){return{duration:0}},now:function(){return(new Date).getTime()}},Blob:"",dispatchEvent:function(t){return!0},Event:function(t,e){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:window,"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM?my.getSystemInfoSync().pixelRatio:Sf.devicePixelRatio;var el=TypeError,rl=Object.getOwnPropertyDescriptor,nl=pt&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(yi(t)&&!rl(t,"length").writable)throw el("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},ol=TypeError,il=function(t){if(t>9007199254740991)throw ol("Maximum allowed index exceeded");return t},al=Pi("splice"),ul=Math.max,sl=Math.min;ir({target:"Array",proto:!0,forced:!al},{splice:function(t,e){var r,n,o,i,a,u,s=W(this),c=Fe(s),f=Ce(t,c),l=arguments.length;for(0===l?r=n=0:1===l?(r=0,n=c-f):(r=l-2,n=sl(ul(Me(e),0),c-f)),il(c+r-n),o=xi(s,n),i=0;i<n;i++)(a=f+i)in s&&Ii(o,i,s[a]);if(o.length=n,r<n){for(i=f;i<c-n;i++)u=i+r,(a=i+n)in s?s[u]=s[a]:ls(s,u);for(i=c;i>c-n+r;i--)ls(s,i-1)}else if(r>n)for(i=c-n;i>f;i--)u=i+r-1,(a=i+n-1)in s?s[u]=s[a]:ls(s,u);for(i=0;i<r;i++)s[i+f]=arguments[i+2];return nl(s,c-n+r),o}});var cl=u((function t(e,r){i(this,t),s(this,"cancelBubble",void 0),s(this,"cancelable",void 0),s(this,"target",void 0),s(this,"currentTarget",void 0),s(this,"preventDefault",void 0),s(this,"stopPropagation",void 0),s(this,"type",void 0),s(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=e,this.timeStamp=Date.now()})),fl=Object.assign,ll=Object.defineProperty,hl=R([].concat),pl=!fl||j((function(){if(pt&&1!==fl({b:1},fl(ll({},"a",{enumerable:!0,get:function(){ll(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=fl({},t)[r]||"abcdefghijklmnopqrst"!=Hi(fl({},e)).join("")}))?function(t,e){for(var r=W(t),n=arguments.length,o=1,i=Ze.f,a=Ee.f;n>o;)for(var u,s=Se(arguments[o++]),c=i?hl(Hi(s),i(s)):Hi(s),f=c.length,l=0;f>l;)u=c[l++],pt&&!St(a,s,u)||(r[u]=s[u]);return r}:fl;ir({target:"Object",stat:!0,arity:2,forced:Object.assign!==pl},{assign:pl});var vl=Ei.findIndex,dl=!0;"findIndex"in[]&&Array(1).findIndex((function(){dl=!1})),ir({target:"Array",proto:!0,forced:dl},{findIndex:function(t){return vl(this,t,arguments.length>1?arguments[1]:void 0)}}),oa("findIndex");var yl=Lf.charAt,gl=ce.set,ml=ce.getterFor("String Iterator");wa(String,"String",(function(t){gl(this,{type:"String Iterator",string:rf(t),index:0})}),(function(){var t,e=ml(this),r=e.string,n=e.index;return n>=r.length?Ea(void 0,!0):(t=yl(r,n),e.index+=t.length,Ea(t,!1))}));var xl=qe.f,bl="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],wl={f:function(t){return bl&&"Window"==ve(t)?function(t){try{return xl(t)}catch(t){return yu(bl)}}(t):xl(Te(t))}},El=j((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Al=Object.isExtensible,Ol=j((function(){Al(1)}))||El?function(t){return!!dt(t)&&((!El||"ArrayBuffer"!=ve(t))&&(!Al||Al(t)))}:Al,Sl=!j((function(){return Object.isExtensible(Object.preventExtensions({}))})),Tl=b((function(t){var e=Ut.f,r=!1,n=V("meta"),o=0,i=function(t){e(t,n,{value:{objectID:"O"+o++,weakData:{}}})},a=t.exports={enable:function(){a.enable=function(){},r=!0;var t=qe.f,e=R([].splice),o={};o[n]=1,t(o).length&&(qe.f=function(r){for(var o=t(r),i=0,a=o.length;i<a;i++)if(o[i]===n){e(o,i,1);break}return o},ir({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:wl.f}))},fastKey:function(t,e){if(!dt(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!B(t,n)){if(!Ol(t))return"F";if(!e)return"E";i(t)}return t[n].objectID},getWeakData:function(t,e){if(!B(t,n)){if(!Ol(t))return!0;if(!e)return!1;i(t)}return t[n].weakData},onFreeze:function(t){return Sl&&r&&Ol(t)&&!B(t,n)&&i(t),t}};oe[n]=!0})),kl=(Tl.enable,Tl.fastKey,Tl.getWeakData,Tl.onFreeze,function(t,e,r){var n=-1!==t.indexOf("Map"),o=-1!==t.indexOf("Weak"),i=n?"set":"add",a=O[t],u=a&&a.prototype,s=a,c={},f=function(t){var e=R(u[t]);le(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(o&&!dt(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return o&&!dt(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(o&&!dt(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(nr(t,!$(a)||!(o||u.forEach&&!j((function(){(new a).entries().next()})))))s=r.getConstructor(e,t,n,i),Tl.enable();else if(nr(t,!0)){var l=new s,h=l[i](o?{}:-0,1)!=l,p=j((function(){l.has(1)})),v=_o((function(t){new a(t)})),d=!o&&j((function(){for(var t=new a,e=5;e--;)t[i](e,e);return!t.has(-0)}));v||((s=e((function(t,e){yr(t,u);var r=ss(new a,t,s);return C(e)||To(e,r[i],{that:r,AS_ENTRIES:n}),r}))).prototype=u,u.constructor=s),(p||d)&&(f("delete"),f("has"),n&&f("get")),(d||h)&&f(i),o&&u.clear&&delete u.clear}return c[t]=s,ir({global:!0,constructor:!0,forced:s!=a},c),hr(s,t),o||r.setStrong(s,t,n),s}),Il=Tl.getWeakData,jl=ce.set,Pl=ce.getterFor,_l=Ei.find,Ml=Ei.findIndex,Ll=R([].splice),Rl=0,Cl=function(t){return t.frozen||(t.frozen=new Nl)},Nl=function(){this.entries=[]},Dl=function(t,e){return _l(t.entries,(function(t){return t[0]===e}))};Nl.prototype={get:function(t){var e=Dl(this,t);if(e)return e[1]},has:function(t){return!!Dl(this,t)},set:function(t,e){var r=Dl(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=Ml(this.entries,(function(e){return e[0]===t}));return~e&&Ll(this.entries,e,1),!!~e}};var Fl,Wl={getConstructor:function(t,e,r,n){var o=t((function(t,o){yr(t,i),jl(t,{type:e,id:Rl++,frozen:void 0}),C(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Pl(e),u=function(t,e,r){var n=a(t),o=Il(At(e),!0);return!0===o?Cl(n).set(e,r):o[n.id]=r,t};return ru(i,{delete:function(t){var e=a(this);if(!dt(t))return!1;var r=Il(t);return!0===r?Cl(e).delete(t):r&&B(r,e.id)&&delete r[e.id]},has:function(t){var e=a(this);if(!dt(t))return!1;var r=Il(t);return!0===r?Cl(e).has(t):r&&B(r,e.id)}}),ru(i,r?{get:function(t){var e=a(this);if(dt(t)){var r=Il(t);return!0===r?Cl(e).get(t):r?r[e.id]:void 0}},set:function(t,e){return u(this,t,e)}}:{add:function(t){return u(this,t,!0)}}),o}},zl=ce.enforce,Bl=!O.ActiveXObject&&"ActiveXObject"in O,Ul=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Gl=kl("WeakMap",Ul,Wl);if(Jt&&Bl){Fl=Wl.getConstructor(Ul,"WeakMap",!0),Tl.enable();var Hl=Gl.prototype,Vl=R(Hl.delete),ql=R(Hl.has),Zl=R(Hl.get),Yl=R(Hl.set);ru(Hl,{delete:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),Vl(this,t)||e.frozen.delete(t)}return Vl(this,t)},has:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)||e.frozen.has(t)}return ql(this,t)},get:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)?Zl(this,t):e.frozen.get(t)}return Zl(this,t)},set:function(t,e){if(dt(t)&&!Ol(t)){var r=zl(this);r.frozen||(r.frozen=new Fl),ql(this,t)?Yl(this,t,e):r.frozen.set(t,e)}else Yl(this,t,e);return this}})}var $l=ft("iterator"),Kl=ft("toStringTag"),Ql=Ta.values,Xl=function(t,e){if(t){if(t[$l]!==Ql)try{ee(t,$l,Ql)}catch(e){t[$l]=Ql}if(t[Kl]||ee(t,Kl,e),hi[e])for(var r in Ta)if(t[r]!==Ta[r])try{ee(t,r,Ta[r])}catch(e){t[r]=Ta[r]}}};for(var Jl in hi)Xl(O[Jl]&&O[Jl].prototype,Jl);Xl(di,"DOMTokenList");var th,eh,rh,nh,oh=new WeakMap,ih=function(){function t(){i(this,t),oh.set(this,{})}return u(t,[{key:"addEventListener",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=oh.get(this);n||(n={}),n[t]||(n[t]=[]),n[t].push(e),oh.set(this,n),r.capture,r.once,r.passive}},{key:"removeEventListener",value:function(t,e){var r=oh.get(this);if(r){var n=r[t];if(n&&n.length>0)for(var o=n.length;o--;o>0)if(n[o]===e){n.splice(o,1);break}}}},{key:"dispatchEvent",value:function(t){var e=oh.get(this)[t.type];if(e){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=g(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(e);try{for(n.s();!(r=n.n()).done;){(0,r.value)(t)}}catch(t){n.e(t)}finally{n.f()}}}}]),t}(),ah=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),t.className="",t.children=[],t}return u(r,[{key:"setAttribute",value:function(t,e){this[t]=e}},{key:"getAttribute",value:function(t){return this[t]}},{key:"setAttributeNS",value:function(t,e){this[t]=e}},{key:"getAttributeNS",value:function(t){return this[t]}}]),r}(function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"childNodes",void 0),t.childNodes=[],t}return u(r,[{key:"appendChild",value:function(t){this.childNodes.push(t)}},{key:"cloneNode",value:function(){var t=Object.create(this);return Object.assign(t,this),t}},{key:"removeChild",value:function(t){var e=this.childNodes.findIndex((function(e){return e===t}));return e>-1?this.childNodes.splice(e,1):null}}]),r}(ih));if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var uh=my.getSystemInfoSync();th=uh.screenWidth,eh=uh.screenHeight,rh=uh.windowWidth,nh=uh.windowHeight}else{var sh=Sf.innerWidth,ch=Sf.innerHeight;th=sh,eh=ch,rh=sh,nh=ch}var fh={width:th,height:eh,availWidth:rh,availHeight:nh,availLeft:0,availTop:0},lh=fh.availWidth,hh=fh.availHeight,ph={style:[]};function vh(t,e){var r,n;"parentNode"in t||(r=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentNode",{enumerable:!0,get:r}));"parentElement"in t||(n=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentElement",{enumerable:!0,get:n}))}function dh(t){t.style=t.style||{},Object.assign(t.style,{top:"0px",left:"0px",width:lh+"px",height:hh+"px",margin:"0px",padding:"0px"})}function yh(t){"clientLeft"in t||(t.clientLeft=0,t.clientTop=0),"clientWidth"in t||(t.clientWidth=lh,t.clientHeight=hh),"getBoundingClientRect"in t||(t.getBoundingClientRect=function(){return{x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight}})}function gh(t){"offsetLeft"in t||(t.offsetLeft=0,t.offsetTop=0),"offsetWidth"in t||(t.offsetWidth=lh,t.offsetHeight=hh)}function mh(t){"scrollLeft"in t||(t.scrollLeft=0,t.scrollTop=0),"scrollWidth"in t||(t.scrollWidth=lh,t.scrollHeight=hh)}function xh(t){var e=function(){return!0};t.classList=[],t.classList.add=e,t.classList.remove=e,t.classList.contains=e,t.classList.toggle=e}function bh(){}var wh=function(t){c(r,t);var e=v(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),s(h(t),"focus",void 0),s(h(t),"blur",void 0),s(h(t),"insertBefore",void 0),s(h(t),"appendChild",void 0),s(h(t),"removeChild",void 0),s(h(t),"remove",void 0),s(h(t),"innerHTML",void 0),s(h(t),"tagName",void 0),t.className="",t.children=[],t.focus=bh,t.blur=bh,t.insertBefore=bh,t.appendChild=bh,t.removeChild=bh,t.remove=bh,t.innerHTML="",t.tagName=n.toUpperCase(),vh(h(t),o),dh(h(t)),xh(h(t)),yh(h(t)),gh(h(t)),mh(h(t)),t}return u(r)}(ah),Eh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"video")}return u(r)}(function(t){c(r,t);var e=v(r);function r(t){return i(this,r),e.call(this,t)}return u(r,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),r}(wh)),Ah={};function Oh(){return Ah}var Sh=u((function t(){i(this,t);var e=Oh(),r=e.createImage&&e.createImage()||{};return"tagName"in r||(r.tagName="IMG",r.__proto__=t.prototype),vh(r),xh(r),Object.assign(r,{addEventListener:function(t,e){r["on".concat(t)]=e.bind(r)},removeEventListener:function(t){r["on".concat(t)]=null}}),r})),Th={href:"",protocol:"",host:""},kh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"body",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e,r){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),Ih=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"html",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),jh={},Ph={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:Th,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(t){return"canvas"===(t=t.toLowerCase())?my.createOffscreenCanvas(1024,128,"2d"):"img"===t?new Sh:"video"===t?new Eh:new wh(t)},createElementNS:function(t,e){return this.createElement(e)},createTextNode:function(t){return t},getElementById:function(t){return null},getElementsByTagName:function(t){return t=t.toLowerCase(),[]},getElementsByTagNameNS:function(t,e){return this.getElementsByTagName(e)},getElementsByName:function(t){return[]},querySelector:function(t){return null},querySelectorAll:function(t){return[]},addEventListener:function(t,e,r){jh[t]||(jh[t]=[]),jh[t].push(e)},removeEventListener:function(t,e){var r=jh[t];if(r&&r.length>0)for(var n=r.length;n--;n>0)if(r[n]===e){r.splice(n,1);break}},dispatchEvent:function(t){var e=t.type,r=jh[e];if(r)for(var n=0;n<r.length;n++)r[n](t);t.target&&"function"==typeof t.target["on"+e]&&t.target["on"+e](t)},createEvent:function(t){return new cl(t)}};Ph.documentElement=new Ih,Ph.head=new wh("head"),Ph.body=new kh,If("match",(function(t,e,r){return[function(e){var r=D(this),n=C(e)?void 0:Lt(e,t);return n?St(n,e,r):new RegExp(e)[t](rf(r))},function(t){var n=At(this),o=rf(t),i=r(e,n,o);if(i.done)return i.value;if(!n.global)return Hf(n,o);var a=n.unicode;n.lastIndex=0;for(var u,s=[],c=0;null!==(u=Hf(n,o));){var f=rf(u[0]);s[c]=f,""===f&&(n.lastIndex=Cf(o,De(n.lastIndex),a)),c++}return 0===c?null:s}]}));var _h,Mh,Lh=ft("isConcatSpreadable"),Rh=nt>=51||!j((function(){var t=[];return t[Lh]=!1,t.concat()[0]!==t})),Ch=Pi("concat"),Nh=function(t){if(!dt(t))return!1;var e=t[Lh];return void 0!==e?!!e:yi(t)};if(ir({target:"Array",proto:!0,arity:1,forced:!Rh||!Ch},{concat:function(t){var e,r,n,o,i,a=W(this),u=xi(a,0),s=0;for(e=-1,n=arguments.length;e<n;e++)if(Nh(i=-1===e?a:arguments[e]))for(o=Fe(i),il(s+o),r=0;r<o;r++,s++)r in i&&Ii(u,s,i[r]);else il(s+1),Ii(u,s++,i);return u.length=s,u}}),"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var Dh=my.getSystemInfoSync();_h=Dh.system,Dh.platform,Dh.language}else{var Fh={versions:(Mh=Sf.navigator.userAgent,{trident:Mh.indexOf("Trident")>-1,presto:Mh.indexOf("Presto")>-1,webKit:Mh.indexOf("AppleWebKit")>-1,gecko:Mh.indexOf("Gecko")>-1&&-1===Mh.indexOf("KHTML"),mobile:!!Mh.match(/AppleWebKit.*Mobile.*/),ios:!!Mh.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),android:Mh.indexOf("Android")>-1||Mh.indexOf("Linux")>-1,iPhone:Mh.indexOf("iPhone")>-1,iPad:Mh.indexOf("iPad")>-1,webApp:-1===Mh.indexOf("Safari"),weixin:Mh.indexOf("MicroMessenger")>-1,qq:" qq"===Mh.match(/\\sQQ/i)}),language:(Sf.navigator.browserLanguage||Sf.navigator.language).toLowerCase()};Fh.versions.android?"android":Fh.versions.trident?"IE":Fh.versions.presto?"Opera":Fh.versions.webKit?"webKit":Fh.versions.gecko?"Firefox":Fh.versions.mobile?"mobile":Fh.versions.ios?"ios":Fh.versions.iPhone?"iPhone":Fh.versions.iPad?"ipad":Fh.versions.webApp?"webApp":Fh.versions.weixin?"weixin":Fh.versions.qq&&"qq",_h=Sf.navigator.userAgent,Fh.language}_h.toLowerCase().indexOf("android");cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}));var Wh=Ut.f,zh=Tl.fastKey,Bh=ce.set,Uh=ce.getterFor;kl("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(t,e,r,n){var o=t((function(t,o){yr(t,i),Bh(t,{type:e,index:Qi(null),first:void 0,last:void 0,size:0}),pt||(t.size=0),C(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Uh(e),u=function(t,e,r){var n,o,i=a(t),u=s(t,e);return u?u.value=r:(i.last=u={index:o=zh(e,!0),key:e,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=u),n&&(n.next=u),pt?i.size++:t.size++,"F"!==o&&(i.index[o]=u)),t},s=function(t,e){var r,n=a(t),o=zh(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==e)return r};return ru(i,{clear:function(){for(var t=a(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,pt?t.size=0:this.size=0},delete:function(t){var e=a(this),r=s(this,t);if(r){var n=r.next,o=r.previous;delete e.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first==r&&(e.first=n),e.last==r&&(e.last=o),pt?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=a(this),n=zr(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!s(this,t)}}),ru(i,r?{get:function(t){var e=s(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),pt&&Wh(i,"size",{get:function(){return a(this).size}}),o},setStrong:function(t,e,r){var n=e+" Iterator",o=Uh(e),i=Uh(n);wa(t,e,(function(t,e){Bh(this,{type:n,target:t,state:o(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?Ea("keys"==e?r.key:"values"==e?r.value:[r.key,r.value],!1):(t.target=void 0,Ea(void 0,!0))}),r?"entries":"values",!r,!0),vr(e)}});var Gh=R([].join),Hh=Se!=Object,Vh=Ai("join",",");ir({target:"Array",proto:!0,forced:Hh||!Vh},{join:function(t){return Gh(Te(this),void 0===t?",":t)}});var qh=j((function(){Hi(1)}));ir({target:"Object",stat:!0,forced:qh},{keys:function(t){return Hi(W(t))}});var Zh=new Map,Yh=new Map,$h=new Map,Kh=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"onabort",void 0),s(h(t),"onerror",void 0),s(h(t),"onload",void 0),s(h(t),"onloadstart",void 0),s(h(t),"onprogress",void 0),s(h(t),"ontimeout",void 0),s(h(t),"onloadend",void 0),s(h(t),"onreadystatechange",void 0),s(h(t),"readyState",void 0),s(h(t),"response",void 0),s(h(t),"responseText",void 0),s(h(t),"_responseType",void 0),s(h(t),"responseXML",void 0),s(h(t),"status",void 0),s(h(t),"statusText",void 0),s(h(t),"upload",void 0),s(h(t),"withCredentials",void 0),s(h(t),"timeout",void 0),s(h(t),"_url",void 0),s(h(t),"_method",void 0),t.onabort=null,t.onerror=null,t.onload=null,t.onloadstart=null,t.onprogress=null,t.ontimeout=null,t.onloadend=null,t.onreadystatechange=null,t.readyState=0,t.response=null,t.responseText=null,t._responseType="text",t.responseXML=null,t.status=0,t.statusText="",t.upload={},t.withCredentials=!1,Zh.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),t}return u(r,[{key:"responseType",set:function(t){this._responseType=t}},{key:"abort",value:function(){var t=$h.get("requestTask");t&&t.abort()}},{key:"getAllResponseHeaders",value:function(){var t=Yh.get("responseHeader");return Object.keys(t).map((function(e){return"".concat(e,": ").concat(t[e])})).join("\\n")}},{key:"getResponseHeader",value:function(t){return Yh.get("responseHeader")[t]}},{key:"open",value:function(t,e,r){this._method=t,this._url=e}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(t,e){var r=Zh.get("requestHeader");r[t]=e,Zh.set("requestHeader",r)}},{key:"addEventListener",value:function(t,e){var r=this;"function"==typeof e&&(this["on"+t]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.target=t.target||r,e.call(r,t)})}},{key:"removeEventListener",value:function(t,e){this["on"+t]===e&&(this["on"+t]=null)}}]),r}(ih);s(Kh,"UNSEND",void 0),s(Kh,"OPENED",void 0),s(Kh,"HEADERS_RECEIVED",void 0),s(Kh,"LOADING",void 0),s(Kh,"DONE",void 0),Kh.UNSEND=0,Kh.OPENED=1,Kh.HEADERS_RECEIVED=2,Kh.LOADING=3,Kh.DONE=4;var Qh="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,Xh="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),Jh=Qh||Xh;Jh||Sf.XMLHttpRequest,Jh||Sf.location;function tp(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]}var ep=Ei.filter,rp=Pi("filter");function np(t){var e=t.color;return e&&e.length?e:[1,1,1,1]}function op(t,e,r){return 2===r.length?[r[0],r[1],0]:[r[0],r[1],r[2]]}function ip(t){return t.filter?[1]:[0]}function ap(t,e){return[e]}ir({target:"Array",proto:!0,forced:!rp},{filter:function(t){return ep(this,t,arguments.length>1?arguments[1]:void 0)}});var up=cp,sp=cp;function cp(t,e,r){r=r||2;var n,o,i,a,u,s,c,f=e&&e.length,l=f?e[0]*r:t.length,h=fp(t,0,l,r,!0),p=[];if(!h||h.next===h.prev)return p;if(f&&(h=function(t,e,r,n){var o,i,a,u,s,c=[];for(o=0,i=e.length;o<i;o++)a=e[o]*n,u=o<i-1?e[o+1]*n:t.length,(s=fp(t,a,u,n,!1))===s.next&&(s.steiner=!0),c.push(wp(s));for(c.sort(gp),o=0;o<c.length;o++)r=mp(c[o],r);return r}(t,e,h,r)),t.length>80*r){n=i=t[0],o=a=t[1];for(var v=r;v<l;v+=r)(u=t[v])<n&&(n=u),(s=t[v+1])<o&&(o=s),u>i&&(i=u),s>a&&(a=s);c=0!==(c=Math.max(i-n,a-o))?32767/c:0}return hp(h,p,r,n,o,c,0),p}function fp(t,e,r,n,o){var i,a;if(o===Rp(t,e,r,n)>0)for(i=e;i<r;i+=n)a=_p(i,t[i],t[i+1],a);else for(i=r-n;i>=e;i-=n)a=_p(i,t[i],t[i+1],a);return a&&Sp(a,a.next)&&(Mp(a),a=a.next),a}function lp(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Sp(n,n.next)&&0!==Op(n.prev,n,n.next))n=n.next;else{if(Mp(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function hp(t,e,r,n,o,i,a){if(t){!a&&i&&function(t,e,r,n){var o=t;do{0===o.z&&(o.z=bp(o.x,o.y,e,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,r,n,o,i,a,u,s,c=1;do{for(r=t,t=null,i=null,a=0;r;){for(a++,n=r,u=0,e=0;e<c&&(u++,n=n.nextZ);e++);for(s=c;u>0||s>0&&n;)0!==u&&(0===s||!n||r.z<=n.z)?(o=r,r=r.nextZ,u--):(o=n,n=n.nextZ,s--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;r=n}i.nextZ=null,c*=2}while(a>1)}(o)}(t,n,o,i);for(var u,s,c=t;t.prev!==t.next;)if(u=t.prev,s=t.next,i?vp(t,n,o,i):pp(t))e.push(u.i/r|0),e.push(t.i/r|0),e.push(s.i/r|0),Mp(t),t=s.next,c=s.next;else if((t=s)===c){a?1===a?hp(t=dp(lp(t),e,r),e,r,n,o,i,2):2===a&&yp(t,e,r,n,o,i):hp(lp(t),e,r,n,o,i,1);break}}}function pp(t){var e=t.prev,r=t,n=t.next;if(Op(e,r,n)>=0)return!1;for(var o=e.x,i=r.x,a=n.x,u=e.y,s=r.y,c=n.y,f=o<i?o<a?o:a:i<a?i:a,l=u<s?u<c?u:c:s<c?s:c,h=o>i?o>a?o:a:i>a?i:a,p=u>s?u>c?u:c:s>c?s:c,v=n.next;v!==e;){if(v.x>=f&&v.x<=h&&v.y>=l&&v.y<=p&&Ep(o,u,i,s,a,c,v.x,v.y)&&Op(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function vp(t,e,r,n){var o=t.prev,i=t,a=t.next;if(Op(o,i,a)>=0)return!1;for(var u=o.x,s=i.x,c=a.x,f=o.y,l=i.y,h=a.y,p=u<s?u<c?u:c:s<c?s:c,v=f<l?f<h?f:h:l<h?l:h,d=u>s?u>c?u:c:s>c?s:c,y=f>l?f>h?f:h:l>h?l:h,g=bp(p,v,e,r,n),m=bp(d,y,e,r,n),x=t.prevZ,b=t.nextZ;x&&x.z>=g&&b&&b.z<=m;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=m;){if(b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function dp(t,e,r){var n=t;do{var o=n.prev,i=n.next.next;!Sp(o,i)&&Tp(o,n,n.next,i)&&jp(o,i)&&jp(i,o)&&(e.push(o.i/r|0),e.push(n.i/r|0),e.push(i.i/r|0),Mp(n),Mp(n.next),n=t=i),n=n.next}while(n!==t);return lp(n)}function yp(t,e,r,n,o,i){var a=t;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&Ap(a,u)){var s=Pp(a,u);return a=lp(a,a.next),s=lp(s,s.next),hp(a,e,r,n,o,i,0),void hp(s,e,r,n,o,i,0)}u=u.next}a=a.next}while(a!==t)}function gp(t,e){return t.x-e.x}function mp(t,e){var r=function(t,e){var r,n=e,o=t.x,i=t.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var u=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=o&&u>a&&(a=u,r=n.x<n.next.x?n:n.next,u===o))return r}n=n.next}while(n!==e);if(!r)return null;var s,c=r,f=r.x,l=r.y,h=1/0;n=r;do{o>=n.x&&n.x>=f&&o!==n.x&&Ep(i<l?o:a,i,f,l,i<l?a:o,i,n.x,n.y)&&(s=Math.abs(i-n.y)/(o-n.x),jp(n,t)&&(s<h||s===h&&(n.x>r.x||n.x===r.x&&xp(r,n)))&&(r=n,h=s)),n=n.next}while(n!==c);return r}(t,e);if(!r)return e;var n=Pp(r,t);return lp(n,n.next),lp(r,r.next)}function xp(t,e){return Op(t.prev,t,e.prev)<0&&Op(e.next,t,t.next)<0}function bp(t,e,r,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wp(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Ep(t,e,r,n,o,i,a,u){return(o-a)*(e-u)>=(t-a)*(i-u)&&(t-a)*(n-u)>=(r-a)*(e-u)&&(r-a)*(i-u)>=(o-a)*(n-u)}function Ap(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Tp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(jp(t,e)&&jp(e,t)&&function(t,e){var r=t,n=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(Op(t.prev,t,e.prev)||Op(t,e.prev,e))||Sp(t,e)&&Op(t.prev,t,t.next)>0&&Op(e.prev,e,e.next)>0)}function Op(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Sp(t,e){return t.x===e.x&&t.y===e.y}function Tp(t,e,r,n){var o=Ip(Op(t,e,r)),i=Ip(Op(t,e,n)),a=Ip(Op(r,n,t)),u=Ip(Op(r,n,e));return o!==i&&a!==u||(!(0!==o||!kp(t,r,e))||(!(0!==i||!kp(t,n,e))||(!(0!==a||!kp(r,t,n))||!(0!==u||!kp(r,e,n)))))}function kp(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ip(t){return t>0?1:t<0?-1:0}function jp(t,e){return Op(t.prev,t,t.next)<0?Op(t,e,t.next)>=0&&Op(t,t.prev,e)>=0:Op(t,e,t.prev)<0||Op(t,t.next,e)<0}function Pp(t,e){var r=new Lp(t.i,t.x,t.y),n=new Lp(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function _p(t,e,r,n){var o=new Lp(t,e,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Mp(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Lp(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Rp(t,e,r,n){for(var o=0,i=e,a=r-n;i<r;i+=n)o+=(t[a]-t[i])*(t[i+1]+t[a+1]),a=i;return o}cp.deviation=function(t,e,r,n){var o=e&&e.length,i=o?e[0]*r:t.length,a=Math.abs(Rp(t,0,i,r));if(o)for(var u=0,s=e.length;u<s;u++){var c=e[u]*r,f=u<s-1?e[u+1]*r:t.length;a-=Math.abs(Rp(t,c,f,r))}var l=0;for(u=0;u<n.length;u+=3){var h=n[u]*r,p=n[u+1]*r,v=n[u+2]*r;l+=Math.abs((t[h]-t[v])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[v+1]-t[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},cp.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var a=0;a<e;a++)r.vertices.push(t[o][i][a]);o>0&&(n+=t[o-1].length,r.holes.push(n))}return r},up.default=sp;var Cp=R(1..valueOf),Np=R("".replace),Dp="[\\t\\n\\v\\f\\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\\u2028\\u2029\\ufeff]",Fp=RegExp("^"+Dp+Dp+"*"),Wp=RegExp(Dp+Dp+"*$"),zp=function(t){return function(e){var r=rf(D(e));return 1&t&&(r=Np(r,Fp,"")),2&t&&(r=Np(r,Wp,"")),r}},Bp={start:zp(1),end:zp(2),trim:zp(3)},Up=qe.f,Gp=Ie.f,Hp=Ut.f,Vp=Bp.trim,qp=O.Number,Zp=qp.prototype,Yp=O.TypeError,$p=R("".slice),Kp=R("".charCodeAt),Qp=function(t){var e=Dt(t,"number");return"bigint"==typeof e?e:Xp(e)},Xp=function(t){var e,r,n,o,i,a,u,s,c=Dt(t,"number");if(It(c))throw Yp("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=Vp(c),43===(e=Kp(c,0))||45===e){if(88===(r=Kp(c,2))||120===r)return NaN}else if(48===e){switch(Kp(c,1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(a=(i=$p(c,2)).length,u=0;u<a;u++)if((s=Kp(i,u))<48||s>o)return NaN;return parseInt(i,n)}return+c};if(nr("Number",!qp(" 0o1")||!qp("0b1")||qp("+0x1"))){for(var Jp,tv=function(t){var e=arguments.length<1?0:qp(Qp(t)),r=this;return Tt(Zp,r)&&j((function(){Cp(r)}))?ss(Object(e),r,tv):e},ev=pt?Up(qp):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),rv=0;ev.length>rv;rv++)B(qp,Jp=ev[rv])&&!B(tv,Jp)&&Hp(tv,Jp,Gp(qp,Jp));tv.prototype=Zp,Zp.constructor=tv,le(O,"Number",tv,{constructor:!0})}var nv=RangeError,ov=RangeError,iv=String,av=Math.floor,uv=R((function(t){var e=rf(D(this)),r="",n=Me(t);if(n<0||n==1/0)throw nv("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(r+=e);return r})),sv=R("".slice),cv=R(1..toFixed),fv=function(t,e,r){return 0===e?r:e%2==1?fv(t,e-1,r*t):fv(t*t,e/2,r)},lv=function(t,e,r){for(var n=-1,o=r;++n<6;)o+=e*t[n],t[n]=o%1e7,o=av(o/1e7)},hv=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=av(n/e),n=n%e*1e7},pv=function(t){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==t[e]){var n=iv(t[e]);r=""===r?n:r+uv("0",7-n.length)+n}return r},vv=j((function(){return"0.000"!==cv(8e-5,3)||"1"!==cv(.9,0)||"1.25"!==cv(1.255,2)||"1000000000000000128"!==cv(0xde0b6b3a7640080,0)}))||!j((function(){cv({})}));function dv(t){return"number"==typeof t}function yv(t){var e=Math.max(Math.min(85.0511287798,t[1]),-85.0511287798),r=Math.PI/180,n=t[0]*r,o=e*r;o=Math.log(Math.tan(Math.PI/4+o/2));return n=(256<<20)*(.5/Math.PI*n+.5),o=(256<<20)*(-.5/Math.PI*o+(r=.5)),[Math.floor(n),Math.floor(o)]}ir({target:"Number",proto:!0,forced:vv},{toFixed:function(t){var e,r,n,o,i=Cp(this),a=Me(t),u=[0,0,0,0,0,0],s="",c="0";if(a<0||a>20)throw ov("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return iv(i);if(i<0&&(s="-",i=-i),i>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(i*fv(2,69,1))-69)<0?i*fv(2,-e,1):i/fv(2,e,1),r*=4503599627370496,(e=52-e)>0){for(lv(u,0,r),n=a;n>=7;)lv(u,1e7,0),n-=7;for(lv(u,fv(10,n,1),0),n=e-1;n>=23;)hv(u,1<<23),n-=23;hv(u,1<<n),lv(u,1,1),hv(u,2),c=pv(u)}else lv(u,0,r),lv(u,1<<-e,0),c=pv(u)+uv("0",a);return c=a>0?s+((o=c.length)<=a?"0."+uv("0",a-o)+c:sv(c,0,o-a)+"."+sv(c,o-a)):s+c}});var gv,mv=/"/g,xv=R("".replace);ir({target:"String",proto:!0,forced:(gv="sub",j((function(){var t=""[gv]('"');return t!==t.toLowerCase()||t.split('"').length>3})))},{sub:function(){return t="sub",e="",r="",n=rf(D(this)),o="<"+t,""!==e&&(o+=" "+e+'="'+xv(rf(r),mv,"&quot;")+'"'),o+">"+n+"</"+t+">";var t,e,r,n,o}});var bv=RegExp.prototype,wv=qt.PROPER,Ev=RegExp.prototype.toString,Av=j((function(){return"/a/b"!=Ev.call({source:"a",flags:"b"})})),Ov=wv&&"toString"!=Ev.name;(Av||Ov)&&le(RegExp.prototype,"toString",(function(){var t=At(this);return"/"+rf(t.source)+"/"+rf(function(t){var e=t.flags;return void 0!==e||"flags"in bv||B(t,"flags")||!Tt(bv,t)?e:St(nf,t)}(t))}),{unsafe:!0});var Sv="undefined"!=typeof Float32Array?Float32Array:Array;function Tv(){var t=new Sv(2);return Sv!=Float32Array&&(t[0]=0,t[1]=0),t}function kv(t,e){var r=new Sv(2);return r[0]=t,r[1]=e,r}function Iv(t,e){return t[0]=e[0],t[1]=e[1],t}function jv(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Pv(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function _v(t,e){var r=e[0],n=e[1],o=r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t}function Mv(t,e){return t[0]*e[0]+t[1]*e[1]}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Lv,Rv=Pv,Cv=(Lv=Tv(),Tv()),Nv=(Tv(),Tv()),Dv=Tv(),Fv=Tv();function Wv(t,e,r,n,o){return jv(t,r,n),_v(t,t),[o/Mv(e=kv(-t[1],t[0]),kv(-r[1],r[0])),e]}function zv(t,e){return function(t,e,r){return t[0]=e,t[1]=r,t}(t,-e[1],e[0])}function Bv(t,e,r){return Rv(t,e,r),_v(t,t),t}function Uv(t,e){return t[0]===e[0]&&t[1]===e[1]}var Gv=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),s(this,"complex",void 0),s(this,"join",void 0),s(this,"cap",void 0),s(this,"miterLimit",void 0),s(this,"thickness",void 0),s(this,"normal",void 0),s(this,"lastFlip",-1),s(this,"miter",kv(0,0)),s(this,"started",!1),s(this,"dash",!1),s(this,"totalDistance",0),s(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return u(t,[{key:"extrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.segment_gaode2(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.simpleSegment(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.segment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleExtrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.simpleSegment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"segment_gaode2",value:function(t,e,r,n,o,i,a,u){var s=0,c=t.indices,f=t.positions,l=t.normals,h="square"===this.cap,p="bevel"===this.join,v=yv([a[0],a[1]]),g=yv([i[0],i[1]]);Bv(Nv,n,r);var m=0;if(this.dash&&(m=this.lineSegmentDistance(v,g),this.totalDistance+=m),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,h){var x=Tv(),b=Tv();jv(x,this.normal,Nv),jv(b,this.normal,Nv),l.push(b[0],b[1],0),l.push(x[0],x[1],0),f.push(r[0],r[1],0|r[2],this.totalDistance-m,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),f.push(r[0],r[1],0|r[2],this.totalDistance-m,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,r,this.normal,this.thickness,this.totalDistance-m);if(c.push(e+0,e+1,e+2),o){Uv(n,o)&&jv(o,n,_v(o,Pv(o,n,r))),Bv(Dv,o,n);var w=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),E=w[0],A=w[1],O=Mv(Fv,this.normal)<0?-1:1,S=p;if(!S&&"miter"===this.join)E>this.miterLimit&&(S=!0);S?(l.push(this.normal[0],this.normal[1],0),l.push(A[0],A[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c.push.apply(c,y(this.lastFlip!==-O?[e,e+2,e+3]:[e+2,e+1,e+3])),c.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),l.push(this.normal[0],this.normal[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(f,l,n,A,E,this.totalDistance),c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),O=-1,Iv(this.normal,A),s+=2),this.lastFlip=O}else{if(zv(this.normal,Nv),h){var T=Tv(),k=Tv();Rv(k,Nv,this.normal),jv(T,Nv,this.normal),l.push(k[0],k[1],0),l.push(T[0],T[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,n,this.normal,this.thickness,this.totalDistance);c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),s+=2}return s}},{key:"simpleSegment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c=yv([n[0],n[1]]),f=yv([r[0],r[1]]);Bv(Nv,c,f);var l=0;if(this.dash&&(l=this.lineSegmentDistance(c,f),this.totalDistance+=l),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),this.started||(this.started=!0,this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-l)),a.push(e+0,e+1,e+2),o){var h=yv([o[0],o[1]]);Uv(c,h)&&jv(h,c,_v(h,Pv(h,c,f))),Bv(Dv,h,c);var p=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),v=p[0],g=p[1];Mv(Fv,this.normal);this.extrusions(u,s,n,g,v,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),-1,Iv(this.normal,g),i+=2,this.lastFlip=-1}else zv(this.normal,Nv),this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2;return i}},{key:"segment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c="square"===this.cap,f="bevel"===this.join,l=yv([n[0],n[1]]),h=yv([r[0],r[1]]);Bv(Nv,l,h);var p=0;if(this.dash&&(p=this.lineSegmentDistance(l,h),this.totalDistance+=p),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,c){var v=Tv(),g=Tv();jv(v,this.normal,Nv),jv(g,this.normal,Nv),s.push(g[0],g[1],0),s.push(v[0],v[1],0),u.push(r[0],r[1],0|r[2],this.totalDistance-p,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),u.push(r[0],r[1],0|r[2],this.totalDistance-p,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-p);if(a.push(e+0,e+1,e+2),o){var m=yv([o[0],o[1]]);Uv(l,m)&&jv(m,l,_v(m,Pv(m,l,h))),Bv(Dv,m,l);var x=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),b=x[0],w=x[1],E=Mv(Fv,this.normal)<0?-1:1,A=f;if(!A&&"miter"===this.join)b>this.miterLimit&&(A=!0);A?(s.push(this.normal[0],this.normal[1],0),s.push(w[0],w[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push.apply(a,y(this.lastFlip!==-E?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),s.push(this.normal[0],this.normal[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,i+=3):(this.extrusions(u,s,n,w,b,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),E=-1,Iv(this.normal,w),i+=2),this.lastFlip=E}else{if(zv(this.normal,Nv),c){var O=Tv(),S=Tv();Rv(S,Nv,this.normal),jv(O,Nv,this.normal),s.push(S[0],S[1],0),s.push(O[0],O[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance);a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2}return i}},{key:"extrusions",value:function(t,e,r,n,o,i){e.push(n[0],n[1],0),e.push(n[0],n[1],0),t.push(r[0],r[1],0|r[2],i,-o,0|r[2]),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],0|r[2],i,o,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}}]),t}();function Hv(t){var e=t.coordinates,r=t.originCoordinates,n=t.version,o=new Gv({dash:!0,join:"bevel"});if("GAODE2.x"===n){var i=e;Array.isArray(i[0][0])||(i=[e]);var a=r;Array.isArray(a[0][0])||(a=[r]);for(var u=0;u<i.length;u++){var s=i[u],c=a[u];o.extrude_gaode2(s,c)}}else{var f=e;f[0]&&!Array.isArray(f[0][0])&&(f=[e]),f.forEach((function(t){o.extrude(t)}))}var l=o.complex;return{vertices:l.positions,indices:l.indices,normals:l.normals,indexes:l.indexes,size:6}}function Vv(t){var e=function(t){if(dv(t[0]))return t;if(dv(t[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(dv(t[0][0][0])){var e=0,r=0,n=0;return t.forEach((function(t){t.forEach((function(t){e+=t[0],r+=t[1],n++}))})),[e/n,r/n,0]}throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}(t.coordinates);return{vertices:[].concat(y(e),y(e),y(e),y(e)),indices:[0,1,2,2,3,0],size:e.length}}function qv(t){var e=t.coordinates,r=up.flatten(e),n=r.vertices,o=r.dimensions,i=r.holes;return{indices:up(n,i,o),vertices:n,size:o}}var Zv=function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.iconMap,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_DistanceAndIndex:function(t,e,r,n,o,i){return void 0===i?[r[3],10]:[r[3],i]},a_Total_Distance:function(t,e,r){return[r[5]]},a_Size:function(t){var e=t.size,r=void 0===e?1:e;return Array.isArray(r)?[r[0],r[1]]:[r,0]},a_Normal:function(t,e,r,n,o){return o},a_Miter:function(t,e,r){return[r[4]]},a_iconMapUV:function(t){var e=t.texture,r=a[e]||{x:0,y:0};return[r.x,r.y]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Hv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size,p=r.indexes;o.forEach((function(t){f.push(t+c)})),l=h;var v=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=v;for(var d=function(r){var o=(null==a?void 0:a.slice(3*r,3*r+3))||[],s=i.slice(r*h,r*h+h),c=0;p&&void 0!==p[r]&&(c=p[r]),n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,s,r,o,c)))}))},g=0;g<v;g++)d(g)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Yv={pointFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.shape2d,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_Shape:function(t){var e=t.shape,r=void 0===e?2:e;return[a.indexOf(r)]},a_Extrude:function(t,e,r,n){var o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],i=n%4*3;return[o[i],o[i+1],o[i+2]]},a_Size:function(t){var e=t.size,r=void 0===e?5:e;return Array.isArray(r)?[r[0]]:[r]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Vv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size;o.forEach((function(t){f.push(t+c)})),l=h;var p=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=p;for(var v=function(r){var o=[],a=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,a,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),line:Zv,polygonFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]}},u={sizePerElement:0,elements:[]},s=0,c=[],f=3,o.forEach((function(t,e){var r=qv(t),o=r.indices,i=r.vertices,l=r.normals,h=r.size;o.forEach((function(t){c.push(t+s)})),f=h;var p=i.length/h;u.sizePerElement=f,u.elements.push({featureIdx:e,vertices:i,normals:l,offset:s}),s+=p;for(var v=function(r){var o=[],u=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&a[n.name]&&(i=n.buffer.data).push.apply(i,y(a[n.name](t,e,u,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:u,indices:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},$v=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Yv);function Kv(t){return Qv.apply(this,arguments)}function Qv(){return(Qv=o(r().mark((function t(e){var n,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.workerType,o=e.data,!$v[n]){t.next=3;break}return t.abrupt("return",$v[n](o));case 3:return t.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(n,'" non-existent.'))));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return fi(Kv),t.WorkerSourceMap=Yv,t.createWorker=fi,t.worker=Kv,t}({});
`,nf="l7-worker",Hp=3,Ul=!0;function kd(n){dv(nf,n)}function Ld(){var n=rf(nf);if(!n)throw new Error("get worker failed by workerName: ".concat(nf,"."));return n}function Pd(n,l){return jp.apply(this,arguments)}function jp(){return jp=(0,ut.Z)(it().mark(function n(l,a){var s,o,h,v,m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return s=Ld(),o=Kl.getWorkerFarm({maxConcurrency:Hp,reuseWorkers:Ul}),h=o.getWorkerPool({name:nf,source:s}),A.next=5,h.startJob(nf,function(F,B,V){return F.done(V)});case 5:return v=A.sent,v.postMessage("process",{input:{workerType:l,data:a}}),A.next=9,v.result;case 9:return m=A.sent,A.abrupt("return",m.result);case 11:case"end":return A.stop()}},n)})),jp.apply(this,arguments)}kd(vv);var af={BACK:1029,FRONT:1028};function ec(n){switch(n){case"GAODE1.x":return af.BACK;case"GAODE2.x":return af.BACK;case"MAPBOX":return af.FRONT;case"SIMPLE":return af.FRONT;case"GLOBEL":return af.BACK;case"DEBAULT":return af.FRONT;default:return af.FRONT}}function Wp(n){return typeof ImageBitmap!="undefined"&&n instanceof ImageBitmap}function H0(){return typeof importScripts=="function"}var Qv=H0()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href},If;(function(n){n.Realtime="realtime",n.Overlap="overlap",n.Replace="replace"})(If||(If={}));var mc;(function(n){n.Loading="Loading",n.Loaded="Loaded",n.Failure="Failure",n.Cancelled="Cancelled"})(mc||(mc={}));var j0=0,rc=1,Od=2;function Jv(n){n.forEach(function(l){l.isCurrent&&(l.isVisible=l.isLoaded)})}function of(n){n.forEach(function(l){l.properties.state=j0}),n.forEach(function(l){l.isCurrent&&!Fd(l)&&t0(l)}),n.forEach(function(l){l.isVisible=Boolean(l.properties.state&Od)})}function sf(n){n.forEach(function(a){a.properties.state=j0}),n.forEach(function(a){a.isCurrent&&Fd(a)});var l=n.slice().sort(function(a,s){return a.z-s.z});l.forEach(function(a){a.isVisible=Boolean(a.properties.state&Od),a.children.length&&(a.isVisible||a.properties.state&rc)?a.children.forEach(function(s){s.properties.state=rc}):a.isCurrent&&t0(a)})}function Fd(n){for(;n;){if(n.isLoaded)return n.properties.state|=Od,!0;n=n.parent}return!1}function t0(n){n.children.forEach(function(l){l.isLoaded?l.properties.state|=Od:t0(l)})}var nc,Rd=256,Ch=[-1/0,-1/0,1/0,1/0],Ah=.2,e0=5,r0=(nc={},(0,W.Z)(nc,If.Realtime,Jv),(0,W.Z)(nc,If.Overlap,of),(0,W.Z)(nc,If.Replace,sf),nc),lp=function(){};function Dd(n,l,a){var s=Math.floor((n+180)/360*Math.pow(2,a)),o=Math.floor((1-Math.log(Math.tan(l*Math.PI/180)+1/Math.cos(l*Math.PI/180))/Math.PI)/2*Math.pow(2,a));return[s,o]}function Ro(n,l,a){var s=n/Math.pow(2,a)*360-180,o=Math.PI-2*Math.PI*l/Math.pow(2,a),h=180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)));return[s,h]}var kf=function(l,a,s){var o=Ro(l,a,s),h=(0,ht.Z)(o,2),v=h[0],m=h[1],E=Ro(l+1,a+1,s),A=(0,ht.Z)(E,2),F=A[0],B=A[1];return[v,B,F,m]};function co(n){var l=n.zoom,a=n.latLonBounds,s=n.maxZoom,o=s===void 0?1/0:s,h=n.minZoom,v=h===void 0?0:h,m=n.zoomOffset,E=m===void 0?0:m,A=n.extent,F=A===void 0?Ch:A,B=Math.ceil(l)+E;if(Number.isFinite(v)&&B<v)return[];Number.isFinite(o)&&B>o&&(B=o);for(var V=(0,ht.Z)(a,4),j=V[0],nt=V[1],at=V[2],mt=V[3],Bt=[Math.max(j,F[0]),Math.max(nt,F[1]),Math.min(at,F[2]),Math.min(mt,F[3])],de=[],ce=Dd(Bt[0],Bt[1],B),Be=(0,ht.Z)(ce,2),Xe=Be[0],_r=Be[1],Ir=Dd(Bt[2],Bt[3],B),Nr=(0,ht.Z)(Ir,2),Yr=Nr[0],yn=Nr[1],fn=Xe;fn<=Yr;fn++)for(var $n=yn;$n<=_r;$n++)de.push({x:fn,y:$n,z:B});var di=(Yr+Xe)/2,Yi=(_r+yn)/2,ho=function(Vs,hu){return Math.abs(Vs-di)+Math.abs(hu-Yi)};return de.sort(function(zo,Vs){return ho(zo.x,zo.y)-ho(Vs.x,Vs.y)}),de}var gu=function(l,a,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,h=Math.pow(2,s),v=h-1,m=h,E=l,A=a;return o&&(E<0?E=E+m:E>v&&(E=E%m)),{warpX:E,warpY:A}};function W0(n){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(n)}function Xp(n){var l=[],a=/\{([a-z])-([a-z])\}/.exec(n);if(a){var s=a[1].charCodeAt(0),o=a[2].charCodeAt(0),h;for(h=s;h<=o;++h)l.push(n.replace(a[0],String.fromCharCode(h)));return l}if(a=/\{(\d+)-(\d+)\}/.exec(n),a){for(var v=parseInt(a[2],10),m=parseInt(a[1],10);m<=v;m++)l.push(n.replace(a[0],m.toString()));return l}return l.push(n),l}function Bd(n,l){if(!n||!n.length)throw new Error("url is not allowed to be empty");var a=l.x,s=l.y,o=l.z,h=Xp(n),v=Math.abs(a+s)%h.length,m=h[v];return m.replace(/\{x\}/g,a.toString()).replace(/\{y\}/g,s.toString()).replace(/\{z\}/g,o.toString()).replace(/\{bbox\}/g,kf(a,s,o).join(",")).replace(/\{-y\}/g,(Math.pow(2,o)-s-1).toString())}function X0(n,l){var a=l.x,s=l.y,o=l.z,h=l.layer,v=l.version,m=v===void 0?"1.0.0":v,E=l.style,A=E===void 0?"default":E,F=l.format,B=l.service,V=B===void 0?"WMTS":B,j=l.tileMatrixset,nt="".concat(n,"&SERVICE=").concat(V,"&REQUEST=GetTile&VERSION=").concat(m,"&LAYER=").concat(h,"&STYLE=").concat(A,"&TILEMATRIXSET=").concat(j,"&FORMAT=").concat(F,"&TILECOL=").concat(a,"&TILEROW=").concat(s,"&TILEMATRIX=").concat(o);return nt}function Yp(n,l){l===void 0&&(l={});var a=Number(n[0]),s=Number(n[1]),o=Number(n[2]),h=Number(n[3]);if(n.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var v=[a,s],m=[a,h],E=[o,h],A=[o,s];return Hc([[v,A,E,m,v]],l.properties,{bbox:n,id:l.id})}function n0(n){var l=ic();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ic(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Th=function(n){(0,Ut.Z)(a,n);var l=n0(a);function a(s){var o;(0,lt.Z)(this,a),o=l.call(this),(0,W.Z)((0,st.Z)(o),"tileSize",256),(0,W.Z)((0,st.Z)(o),"isVisible",!1),(0,W.Z)((0,st.Z)(o),"isCurrent",!1),(0,W.Z)((0,st.Z)(o),"isVisibleChange",!1),(0,W.Z)((0,st.Z)(o),"loadedLayers",0),(0,W.Z)((0,st.Z)(o),"isLayerLoaded",!1),(0,W.Z)((0,st.Z)(o),"isLoad",!1),(0,W.Z)((0,st.Z)(o),"isChildLoad",!1),(0,W.Z)((0,st.Z)(o),"parent",null),(0,W.Z)((0,st.Z)(o),"children",[]),(0,W.Z)((0,st.Z)(o),"data",null),(0,W.Z)((0,st.Z)(o),"properties",{}),(0,W.Z)((0,st.Z)(o),"loadDataId",0);var h=s.x,v=s.y,m=s.z,E=s.tileSize,A=s.warp,F=A===void 0?!0:A;return o.x=h,o.y=v,o.z=m,o.warp=F||!0,o.tileSize=E,o}return(0,tt.Z)(a,[{key:"isLoading",get:function(){return this.loadStatus===mc.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===mc.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===mc.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===mc.Cancelled}},{key:"isDone",get:function(){return[mc.Loaded,mc.Cancelled,mc.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return kf(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var o=(0,ht.Z)(this.bounds,4),h=o[0],v=o[1],m=o[2],E=o[3],A=[(m-h)/2,(E-v)/2],F=Yp(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:A,meta:`
      `.concat(this.key,`
      `)}});return F}},{key:"key",get:function(){var o="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return o}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var s=(0,ut.Z)(it().mark(function h(v){var m,E,A,F,B,V,j,nt,at,mt,Bt,de,ce,Be,Xe,_r,Ir;return it().wrap(function(Yr){for(;;)switch(Yr.prev=Yr.next){case 0:return m=v.getData,E=v.onLoad,A=v.onError,this.loadDataId++,F=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=mc.Loading,B=null,Yr.prev=7,j=this.x,nt=this.y,at=this.z,mt=this.bounds,Bt=this.tileSize,de=this.warp,ce=gu(j,nt,at,de),Be=ce.warpX,Xe=ce.warpY,_r=this.abortController.signal,Ir={x:Be,y:Xe,z:at,bounds:mt,tileSize:Bt,signal:_r,warp:de},Yr.next=14,m(Ir,this);case 14:B=Yr.sent,Yr.next=20;break;case 17:Yr.prev=17,Yr.t0=Yr.catch(7),V=Yr.t0;case 20:if(F===this.loadDataId){Yr.next=22;break}return Yr.abrupt("return");case 22:if(!(this.isCancelled&&!B)){Yr.next=24;break}return Yr.abrupt("return");case 24:if(!(V||!B)){Yr.next=28;break}return this.loadStatus=mc.Failure,A(V,this),Yr.abrupt("return");case 28:this.loadStatus=mc.Loaded,this.data=B,E(this);case 31:case"end":return Yr.stop()}},h,this,[[7,17]])}));function o(h){return s.apply(this,arguments)}return o}()},{key:"reloadData",value:function(o){this.isLoading&&this.abortLoad(),this.loadData(o)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=mc.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),a}(Ee.EventEmitter),Nu=function(l,a){var s=wu(l),o=Nl(s,a),h=360*3-180,v=85.0511287798065,m=[Math.max(o[0][0],-h),Math.max(o[0][1],-v),Math.min(o[1][0],h),Math.min(o[1][1],v)];return m},Ug=function(l,a){var s=wu(l),o=wu(a),h=Su(s,o);return h};function Jf(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=th(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function th(n,l){if(!!n){if(typeof n=="string")return Qo(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Qo(n,l)}}function Qo(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function $p(n){var l=eh();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function eh(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var uf=function(n){(0,Ut.Z)(a,n);var l=$p(a);function a(s){var o;return(0,lt.Z)(this,a),o=l.call(this),(0,W.Z)((0,st.Z)(o),"currentTiles",[]),(0,W.Z)((0,st.Z)(o),"cacheTiles",new Map),(0,W.Z)((0,st.Z)(o),"throttleUpdate",(0,te.throttle)(function(h,v){o.update(h,v)},16)),(0,W.Z)((0,st.Z)(o),"onTileLoad",function(h){o.emit("tile-loaded",h),o.updateTileVisible()}),(0,W.Z)((0,st.Z)(o),"onTileError",function(h,v){o.emit("tile-error",{error:h,tile:v}),o.updateTileVisible()}),(0,W.Z)((0,st.Z)(o),"onTileUnload",function(h){o.emit("tile-unload",h)}),o.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:Ch,getTileData:lp,warp:!0,updateStrategy:If.Overlap},o.updateOptions(s),o}return(0,tt.Z)(a,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(o){return o.isDone})}},{key:"tiles",get:function(){var o=Array.from(this.cacheTiles.values()).sort(function(h,v){return h.z-v.z});return o}},{key:"updateOptions",value:function(o){var h=o.minZoom===void 0?this.options.minZoom:Math.ceil(o.minZoom),v=o.maxZoom===void 0?this.options.maxZoom:Math.floor(o.maxZoom);this.options=(0,K.Z)((0,K.Z)((0,K.Z)({},this.options),o),{},{minZoom:h,maxZoom:v})}},{key:"update",value:function(o,h){var v=this,m=Math.max(0,Math.ceil(o));if(!(this.lastViewStates&&this.lastViewStates.zoom===m&&Ug(this.lastViewStates.latLonBoundsBuffer,h))){var E=Nu(h,Ah);this.lastViewStates={zoom:m,latLonBounds:h,latLonBoundsBuffer:E};var A=!1,F=this.getTileIndices(m,E).filter(function(B){return v.options.warp||B.x>=0&&B.x<Math.pow(2,m)});this.currentTiles=F.map(function(B){var V=B.x,j=B.y,nt=B.z,at=v.getTile(V,j,nt);if(at){var mt,Bt,de=((mt=at)===null||mt===void 0?void 0:mt.isFailure)||((Bt=at)===null||Bt===void 0?void 0:Bt.isCancelled);return de&&at.loadData({getData:v.options.getTileData,onLoad:v.onTileLoad,onError:v.onTileError}),at}return at=v.createTile(V,j,nt),A=!0,at}),A&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var o=Jf(this.cacheTiles),h;try{for(o.s();!(h=o.n()).done;){var v=(0,ht.Z)(h.value,2),m=v[0],E=v[1];this.currentTiles.includes(E)||(this.cacheTiles.delete(m),this.onTileUnload(E)),this.onTileUnload(E),E.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(A){o.e(A)}finally{o.f()}}},{key:"pruneRequests",value:function(){var o=[],h=Jf(this.cacheTiles.values()),v;try{for(h.s();!(v=h.n()).done;){var m=v.value;m.isLoading&&!m.isCurrent&&!m.isVisible&&o.push(m)}}catch(A){h.e(A)}finally{h.f()}for(;o.length>0;){var E=o.shift();E.abortLoad()}}},{key:"getTileByLngLat",value:function(o,h,v){var m=this.options.zoomOffset,E=Math.ceil(v)+m,A=Dd(o,h,E),F=this.tiles.filter(function(B){return B.key==="".concat(A[0],"_").concat(A[1],"_").concat(E)});return F[0]}},{key:"destroy",value:function(){var o=Jf(this.cacheTiles.values()),h;try{for(o.s();!(h=o.n()).done;){var v=h.value;v.isLoading&&v.abortLoad()}}catch(m){o.e(m)}finally{o.f()}this.cacheTiles.clear(),this.currentTiles=[],this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var o=this.options.updateStrategy,h=new Map,v=Jf(this.cacheTiles.values()),m;try{for(v.s();!(m=v.n()).done;){var E=m.value;h.set(E.key,E.isVisible),E.isCurrent=!1,E.isVisible=!1}}catch(nt){v.e(nt)}finally{v.f()}var A=Jf(this.currentTiles),F;try{for(A.s();!(F=A.n()).done;){var B=F.value;B.isCurrent=!0,B.isVisible=!0}}catch(nt){A.e(nt)}finally{A.f()}var V=Array.from(this.cacheTiles.values());typeof o=="function"?o(V):r0[o](V);var j=!1;Array.from(this.cacheTiles.values()).forEach(function(nt){nt.isVisible!==h.get(nt.key)?(nt.isVisibleChange=!0,j=!0):nt.isVisibleChange=!1}),j&&this.emit("tile-update")}},{key:"getTileIndices",value:function(o,h){var v=this.options,m=v.tileSize,E=v.extent,A=v.zoomOffset,F=Math.floor(this.options.maxZoom),B=Math.ceil(this.options.minZoom),V=co({maxZoom:F,minZoom:B,zoomOffset:A,tileSize:m,zoom:o,latLonBounds:h,extent:E});return V}},{key:"getTileId",value:function(o,h,v){var m="".concat(o,",").concat(h,",").concat(v);return m}},{key:"getTile",value:function(o,h,v){var m=this.getTileId(o,h,v),E=this.cacheTiles.get(m);return E}},{key:"createTile",value:function(o,h,v){var m=this.getTileId(o,h,v),E=new Th({x:o,y:h,z:v,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(m,E),E.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),E}},{key:"resizeCacheTiles",value:function(){var o=e0*this.currentTiles.length,h=this.cacheTiles.size>o;if(h){var v=Jf(this.cacheTiles),m;try{for(v.s();!(m=v.n()).done;){var E=(0,ht.Z)(m.value,2),A=E[0],F=E[1];if(!F.isVisible&&!this.currentTiles.includes(F)&&(this.cacheTiles.delete(A),this.onTileUnload(F)),this.cacheTiles.size<=o)break}}catch(B){v.e(B)}finally{v.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var o=Jf(this.cacheTiles.values()),h;try{for(o.s();!(h=o.n()).done;){var v=h.value;v.parent=null,v.children.length=0}}catch(B){o.e(B)}finally{o.f()}var m=Jf(this.cacheTiles.values()),E;try{for(m.s();!(E=m.n()).done;){var A=E.value,F=this.getNearestAncestor(A.x,A.y,A.z);A.parent=F,F!=null&&F.children&&F.children.push(A)}}catch(B){m.e(B)}finally{m.f()}}},{key:"getNearestAncestor",value:function(o,h,v){for(;v>this.options.minZoom;){o=Math.floor(o/2),h=Math.floor(h/2),v=v-1;var m=this.getTile(o,h,v);if(m)return m}return null}}]),a}(Te()),qp;(function(n){n["GAODE1.x"]="GAODE1.x",n["GAODE2.x"]="GAODE2.x",n.MAPBOX="MAPBOX",n.DEFAULT="DEFAUlTMAP",n.SIMPLE="SIMPLE",n.GLOBEL="GLOBEL"})(qp||(qp={}));function Hm(n,l,a,s,o){var h=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,v=arguments.length>6?arguments[6]:void 0,m=a;return v&&(m=Math.round(a*(h-1))/(h-1)),s?cn(n,l,m,s,o):cn(n,l,m,.314,o)}function It(n,l){var a=1-l;return(n[0]*a+n[1]*l)*a+(n[1]*a+n[2]*l)*l}function Ue(n,l){return Math.sqrt(Math.pow(n[0]-l[0],2)+Math.pow(n[1]-l[1],2))}function dr(n,l,a){var s=[l[0]-n[0],l[1]-n[1]],o=Ue(s,[0,0]),h=Math.atan2(s[1],s[0]),v=o/2/Math.cos(a),m=h+a,E=[v*Math.cos(m)+n[0],v*Math.sin(m)+n[1]];return E}function cn(n,l,a,s,o){if(o===Version["GAODE2.x"]){var h=amap2Project(n[0],n[1]),v=amap2Project(l[0],l[1]),m=dr(h,v,s),E=[h[0],m[0],v[0]],A=[h[1],m[1],v[1]];return[].concat(_toConsumableArray(amap2UnProject(It(E,a),It(A,a))),[0])}else{var F=dr(n,l,s),B=[n[0],F[0],l[0]],V=[n[1],F[1],l[1]];return[It(B,a),It(V,a),0]}}function On(n,l,a,s,o){var h=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,v=arguments.length>6?arguments[6]:void 0,m=a;return v&&(m=Math.round(a*29)/29),Hn(n,l,m,o)}function on(n,l){var a=[l[0]-n[0],l[1]-n[1]],s=calDistance(a,[0,0]),o=Math.atan2(a[1],a[0]),h=.314,v=s/2/Math.cos(h),m=o+h,E=[v*Math.cos(m)+n[0],v*Math.sin(m)+n[1]];return E}function En(n,l){var a=1-l;return(n[0]*a+n[1]*l)*a+(n[1]*a+n[2]*l)*l}function Dn(n,l){var a=[n[0]-l[0],n[1]-l[1]],s=[Math.sin(a[0]/2),Math.sin(a[1]/2)],o=s[1]*s[1]+Math.cos(n[1])*Math.cos(l[1])*s[0]*s[0];return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}function Hn(n,l,a,s){var o=[degreesToRadians(n[0]),degreesToRadians(n[1])],h=[degreesToRadians(l[0]),degreesToRadians(l[1])];if(s==="GAODE2.x"){var v=on(o,h),m=[o[0],v[0],h[0]],E=[o[1],v[1],h[1]];return[En(m,a),En(E,a),0]}else{var A=Dn(o,h);if(Math.abs(A-Math.PI)<.001)return[(1-a)*o[0]+a*h[0],(1-a)*o[1]+a*h[1]];var F=Math.sin((1-a)*A)/Math.sin(A),B=Math.sin(a*A)/Math.sin(A),V=[Math.sin(o[0]),Math.sin(o[1])],j=[Math.cos(o[0]),Math.cos(o[1])],nt=[Math.sin(h[0]),Math.sin(h[1])],at=[Math.cos(h[0]),Math.cos(h[1])],mt=F*j[1]*j[0]+B*at[1]*at[0],Bt=F*j[1]*V[0]+B*at[1]*nt[0],de=F*V[1]+B*nt[1];return[radiansToDegrees(Math.atan2(Bt,mt)),radiansToDegrees(Math.atan2(de,Math.sqrt(mt*mt+Bt*Bt)))]}}function Jn(n,l){for(var a=0,s=[],o=0;o<n.length-1;o++){var h=n[o],v=n[o+1],m=ui(h,v),E=a;a+=m,s.push({p1:h,p2:v,totalDistance:a,distance:m,lastTotalDistance:E})}for(var A=a*l,F,B,V=0,j=s;V<j.length;V++){var nt=j[V],at=nt.totalDistance;if(at>A){var mt=nt.p1,Bt=nt.p2,de=(A-nt.lastTotalDistance)/nt.distance,ce=ii(Bt,mt,de);F=ce[0],B=ce[1];break}}return{lng:F,lat:B,height:0}}function ii(n,l,a){return[n[0]*a+l[0]*(1-a),n[1]*a+l[1]*(1-a)]}function ui(n,l){return Math.sqrt(Math.pow(n[0]-l[0],2)+Math.pow(n[1]-l[1],2))}function yi(n,l){var a=l.featureId,s=n.data.dataArray;return typeof a=="number"&&(s=s.filter(function(o){var h=o.id;return h===a})),s.map(function(o){var h=ri(o,l);return _objectSpread(_objectSpread({},o),h)})}function qn(n,l){return new Promise(function(a){n.inited?a(yi(n,l)):n.once("update",function(){a(yi(n,l))})})}function ri(n,l){var a=l.offset,s=l.shape,o=l.thetaOffset,h=l.mapVersion,v=l.segmentNumber,m=v===void 0?30:v,E=l.autoFit,A=E===void 0?!0:E,F=n.coordinates;if(s==="line")return pathLineAtOffset(F,a);var B=F[0],V=F[1],j=typeof o=="string"?n[o]||0:o,nt;switch(s){case"arc":nt=arcLineAtOffset;break;case"greatcircle":nt=greatCircleLineAtOffset;break;default:nt=arcLineAtOffset}var at=nt(B,V,a,j,h,m,A),mt=_slicedToArray(at,3),Bt=mt[0],de=mt[1],ce=mt[2];return{lng:Bt,lat:de,height:ce}}var Gr=ot(31745),dn=ot.n(Gr);function Xn(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=vi(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function vi(n,l){if(!!n){if(typeof n=="string")return Rn(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Rn(n,l)}}function Rn(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var Qn=30;function Ti(n){var l=n.characterSet,a=n.getFontWidth,s=n.fontHeight,o=n.buffer,h=n.maxCanvasWidth,v=n.mapping,m=v===void 0?{}:v,E=n.xOffset,A=E===void 0?0:E,F=n.yOffset,B=F===void 0?0:F,V=0,j=A;Array.from(l).forEach(function(at,mt){if(!m[at]){var Bt=a(at,mt);j+Qn>h&&(j=0,V++),m[at]={x:j,y:B+V*Qn,width:Qn,height:Qn,advance:Bt},j+=Qn}});var nt=s+o*2;return{mapping:m,xOffset:j,yOffset:B+V*nt,canvasHeight:An(B+(V+1)*nt)}}function aa(n,l,a){var s=0,o=0,h=0,v=[],m={},E=Xn(n),A;try{for(E.s();!(A=E.n()).done;){var F=A.value;if(!m[F.id]){var B=F.size;s+B+l>a&&(_n(m,v,o),s=0,o=h+o+l,h=0,v=[]),v.push({icon:F,xOffset:s}),s=s+B+l,h=Math.max(h,B)}}}catch(j){E.e(j)}finally{E.f()}v.length>0&&_n(m,v,o);var V=An(h+o+l);return{mapping:m,canvasHeight:V}}function _n(n,l,a){var s=Xn(l),o;try{for(s.s();!(o=s.n()).done;){var h=o.value,v=h.icon,m=h.xOffset;n[v.id]=(0,K.Z)((0,K.Z)({},v),{},{x:m,y:a,image:v.image,width:v.width,height:v.height})}}catch(E){s.e(E)}finally{s.f()}}function An(n){return Math.pow(2,Math.ceil(Math.log2(n)))}var oi,Ei;function ti(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=xi(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function xi(n,l){if(!!n){if(typeof n=="string")return Mi(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Mi(n,l)}}function Mi(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function Ua(n){var l=Yn();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Yn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ii=Tu(),Li="sans-serif",Sa="normal",Da=24,oo=3,Is=.25,zs=8,io=1024,Au=1,Xo=1,Qs=3,su=null;function Tu(){for(var n=[],l=32;l<128;l++)n.push(String.fromCharCode(l));return n}function Js(n,l,a,s){n.font="".concat(s," ").concat(a,"px ").concat(l),n.fillStyle="black",n.textBaseline="middle"}function zu(n,l){for(var a=0;a<n.length;a++)l.data[4*a+3]=n[a]}var Jo=(oi=(0,Mt.b2)(),oi(Ei=function(n){(0,Ut.Z)(a,n);var l=Ua(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"fontAtlas",void 0),(0,W.Z)((0,st.Z)(s),"iconFontMap",void 0),(0,W.Z)((0,st.Z)(s),"iconFontGlyphs",{}),(0,W.Z)((0,st.Z)(s),"fontOptions",void 0),(0,W.Z)((0,st.Z)(s),"key",void 0),(0,W.Z)((0,st.Z)(s),"cache",new No(Qs)),s}return(0,tt.Z)(a,[{key:"scale",get:function(){return Xo}},{key:"canvas",get:function(){var o=this.cache.get(this.key);return o&&o.data}},{key:"mapping",get:function(){var o=this.cache.get(this.key);return o&&o.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Li,fontWeight:Sa,characterSet:Ii,fontSize:Da,buffer:oo,sdf:!0,cutoff:Is,radius:zs,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(o){var h=this;o.forEach(function(v){h.iconFontGlyphs[v.name]=v.unicode})}},{key:"addIconFont",value:function(o,h){this.iconFontMap.set(o,h)}},{key:"getIconFontKey",value:function(o){return this.iconFontMap.get(o)||o}},{key:"getGlyph",value:function(o){return this.iconFontGlyphs[o]?String.fromCharCode(parseInt(this.iconFontGlyphs[o],16)):""}},{key:"setFontOptions",value:function(o){this.fontOptions=(0,K.Z)((0,K.Z)({},this.fontOptions),o),this.key=this.getKey();var h=this.getNewChars(this.key,this.fontOptions.characterSet),v=this.cache.get(this.key);if(!(v&&h.length===0)){var m=this.generateFontAtlas(this.key,h,v);this.fontAtlas=m,this.cache.set(this.key,m)}}},{key:"addFontFace",value:function(o,h){var v=this,m=document.createElement("style");m.type="text/css",m.innerText=`
        @font-face{
            font-family: '`.concat(o,`';
            src: url('`).concat(h,`') format('woff2'),
            url('`).concat(h,`') format('woff'),
            url('`).concat(h,`') format('truetype');
        }`),m.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(o),"L7text"),document.fonts.ready.then(function(){v.emit("fontloaded",{fontFamily:o})})}catch(E){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(E)}},document.getElementsByTagName("head")[0].appendChild(m)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(o,h,v){var m=this.fontOptions,E=m.fontFamily,A=m.fontWeight,F=m.fontSize,B=m.buffer,V=m.sdf,j=m.radius,nt=m.cutoff,at=m.iconfont,mt=v&&v.data;mt||(mt=Co.document.createElement("canvas"),mt.width=io);var Bt=mt.getContext("2d",{willReadFrequently:!0});Js(Bt,E,F,A);var de=Ti((0,K.Z)({getFontWidth:function(Gu){return Bt.measureText(Gu).width},fontHeight:F*Xo,buffer:B,characterSet:h,maxCanvasWidth:io},v&&{mapping:v.mapping,xOffset:v.xOffset,yOffset:v.yOffset})),ce=de.mapping,Be=de.canvasHeight,Xe=de.xOffset,_r=de.yOffset,Ir=Bt.getImageData(0,0,mt.width,mt.height);if(mt.height=Be,Bt.putImageData(Ir,0,0),Js(Bt,E,F,A),V){var Nr=new(dn())(F,B,j,nt,E,A),Yr=Bt.getImageData(0,0,Nr.size,Nr.size),yn=ti(h),fn;try{for(yn.s();!(fn=yn.n()).done;){var $n=fn.value;if(at){var di=String.fromCharCode(parseInt($n.replace("&#x","").replace(";",""),16)),Yi=Nr.draw(di);zu(Yi,Yr)}else zu(Nr.draw($n),Yr);Bt.putImageData(Yr,ce[$n].x,ce[$n].y)}}catch(hu){yn.e(hu)}finally{yn.f()}}else{var ho=ti(h),zo;try{for(ho.s();!(zo=ho.n()).done;){var Vs=zo.value;Bt.fillText(Vs,ce[Vs].x,ce[Vs].y+F*Au)}}catch(hu){ho.e(hu)}finally{ho.f()}}return{xOffset:Xe,yOffset:_r,mapping:ce,data:mt,width:mt.width,height:mt.height}}},{key:"getKey",value:function(){return"key";var o,h,v,m,E,A,F,B}},{key:"getNewChars",value:function(o,h){var v=this.cache.get(o);if(!v)return h;var m=[],E=v.mapping,A=new Set(Object.keys(E)),F=new Set(h);return F.forEach(function(B){A.has(B)||m.push(B)}),m}}]),a}(Ee.EventEmitter))||Ei),La,tu;function fo(n){var l=Mu();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Mu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ya=3,eo=1024,Eo=64,So=(La=(0,Mt.b2)(),La(tu=function(n){(0,Ut.Z)(a,n);var l=fo(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"canvasHeight",128),(0,W.Z)((0,st.Z)(s),"texture",void 0),(0,W.Z)((0,st.Z)(s),"canvas",void 0),(0,W.Z)((0,st.Z)(s),"iconData",void 0),(0,W.Z)((0,st.Z)(s),"iconMap",void 0),(0,W.Z)((0,st.Z)(s),"ctx",void 0),(0,W.Z)((0,st.Z)(s),"loadingImageCount",0),s}return(0,tt.Z)(a,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=Co.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var s=(0,ut.Z)(it().mark(function h(v,m){var E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return E=new Image,this.loadingImageCount++,this.hasImage(v)?console.warn("Image Id already exists"):this.iconData.push({id:v,size:Eo}),this.updateIconMap(),B.next=6,this.loadImage(m);case 6:E=B.sent,A=this.iconData.find(function(V){return V.id===v}),A&&(A.image=E,A.width=E.width,A.height=E.height),this.update();case 10:case"end":return B.stop()}},h,this)}));function o(h,v){return s.apply(this,arguments)}return o}()},{key:"addImageMini",value:function(o,h,v){var m=this,E=v.getSceneConfig().canvas,A=E.createImage();if(this.loadingImageCount++,this.hasImage(o))throw new Error("Image Id already exists");this.iconData.push({id:o,size:Eo}),this.updateIconMap(),this.loadImageMini(h,E).then(function(F){A=F;var B=m.iconData.find(function(V){return V.id===o});B&&(B.image=A,B.width=A.width,B.height=A.height),m.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(o){return this.iconMap.hasOwnProperty(o)}},{key:"removeImage",value:function(o){this.hasImage(o)&&(this.iconData=this.iconData.filter(function(h){return h.id!==o}),delete this.iconMap[o],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(o){return new Promise(function(h,v){if(o instanceof HTMLImageElement){h(o);return}var m=new Image;m.crossOrigin="anonymous",m.onload=function(){h(m)},m.onerror=function(){v(new Error("Could not load image at "+o))},m.src=o instanceof File?URL.createObjectURL(o):o})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var o=this;this.canvas.width=eo,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(h){var v=o.iconMap[h],m=v.x,E=v.y,A=v.image,F=v.width,B=F===void 0?64:F,V=v.height,j=V===void 0?64:V,nt=Math.max(B,j),at=nt/Eo,mt=j/at,Bt=B/at;A&&o.ctx.drawImage(A,m+(Eo-Bt)/2,E+(Eo-mt)/2,Bt,mt)})}},{key:"updateIconMap",value:function(){var o=aa(this.iconData,ya,eo),h=o.mapping,v=o.canvasHeight;this.iconMap=h,this.canvasHeight=v}},{key:"loadImageMini",value:function(o,h){return new Promise(function(v,m){var E=h.createImage();E.crossOrigin="anonymous",E.onload=function(){v(E)},E.onerror=function(){m(new Error("Could not load image at "+o))},E.src=o})}}]),a}(Ee.EventEmitter))||tu),Po=ot(49685);function Ke(){var n=new Po.WT(16);return Po.WT!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function an(n){var l=new Po.WT(16);return l[0]=n[0],l[1]=n[1],l[2]=n[2],l[3]=n[3],l[4]=n[4],l[5]=n[5],l[6]=n[6],l[7]=n[7],l[8]=n[8],l[9]=n[9],l[10]=n[10],l[11]=n[11],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15],l}function en(n,l){return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[8]=l[8],n[9]=l[9],n[10]=l[10],n[11]=l[11],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15],n}function Ri(n,l,a,s,o,h,v,m,E,A,F,B,V,j,nt,at){var mt=new Po.WT(16);return mt[0]=n,mt[1]=l,mt[2]=a,mt[3]=s,mt[4]=o,mt[5]=h,mt[6]=v,mt[7]=m,mt[8]=E,mt[9]=A,mt[10]=F,mt[11]=B,mt[12]=V,mt[13]=j,mt[14]=nt,mt[15]=at,mt}function so(n,l,a,s,o,h,v,m,E,A,F,B,V,j,nt,at,mt){return n[0]=l,n[1]=a,n[2]=s,n[3]=o,n[4]=h,n[5]=v,n[6]=m,n[7]=E,n[8]=A,n[9]=F,n[10]=B,n[11]=V,n[12]=j,n[13]=nt,n[14]=at,n[15]=mt,n}function $e(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Fe(n,l){if(n===l){var a=l[1],s=l[2],o=l[3],h=l[6],v=l[7],m=l[11];n[1]=l[4],n[2]=l[8],n[3]=l[12],n[4]=a,n[6]=l[9],n[7]=l[13],n[8]=s,n[9]=h,n[11]=l[14],n[12]=o,n[13]=v,n[14]=m}else n[0]=l[0],n[1]=l[4],n[2]=l[8],n[3]=l[12],n[4]=l[1],n[5]=l[5],n[6]=l[9],n[7]=l[13],n[8]=l[2],n[9]=l[6],n[10]=l[10],n[11]=l[14],n[12]=l[3],n[13]=l[7],n[14]=l[11],n[15]=l[15];return n}function yr(n,l){var a=l[0],s=l[1],o=l[2],h=l[3],v=l[4],m=l[5],E=l[6],A=l[7],F=l[8],B=l[9],V=l[10],j=l[11],nt=l[12],at=l[13],mt=l[14],Bt=l[15],de=a*m-s*v,ce=a*E-o*v,Be=a*A-h*v,Xe=s*E-o*m,_r=s*A-h*m,Ir=o*A-h*E,Nr=F*at-B*nt,Yr=F*mt-V*nt,yn=F*Bt-j*nt,fn=B*mt-V*at,$n=B*Bt-j*at,di=V*Bt-j*mt,Yi=de*di-ce*$n+Be*fn+Xe*yn-_r*Yr+Ir*Nr;return Yi?(Yi=1/Yi,n[0]=(m*di-E*$n+A*fn)*Yi,n[1]=(o*$n-s*di-h*fn)*Yi,n[2]=(at*Ir-mt*_r+Bt*Xe)*Yi,n[3]=(V*_r-B*Ir-j*Xe)*Yi,n[4]=(E*yn-v*di-A*Yr)*Yi,n[5]=(a*di-o*yn+h*Yr)*Yi,n[6]=(mt*Be-nt*Ir-Bt*ce)*Yi,n[7]=(F*Ir-V*Be+j*ce)*Yi,n[8]=(v*$n-m*yn+A*Nr)*Yi,n[9]=(s*yn-a*$n-h*Nr)*Yi,n[10]=(nt*_r-at*Be+Bt*de)*Yi,n[11]=(B*Be-F*_r-j*de)*Yi,n[12]=(m*Yr-v*fn-E*Nr)*Yi,n[13]=(a*fn-s*Yr+o*Nr)*Yi,n[14]=(at*ce-nt*Xe-mt*de)*Yi,n[15]=(F*Xe-B*ce+V*de)*Yi,n):null}function Xr(n,l){var a=l[0],s=l[1],o=l[2],h=l[3],v=l[4],m=l[5],E=l[6],A=l[7],F=l[8],B=l[9],V=l[10],j=l[11],nt=l[12],at=l[13],mt=l[14],Bt=l[15];return n[0]=m*(V*Bt-j*mt)-B*(E*Bt-A*mt)+at*(E*j-A*V),n[1]=-(s*(V*Bt-j*mt)-B*(o*Bt-h*mt)+at*(o*j-h*V)),n[2]=s*(E*Bt-A*mt)-m*(o*Bt-h*mt)+at*(o*A-h*E),n[3]=-(s*(E*j-A*V)-m*(o*j-h*V)+B*(o*A-h*E)),n[4]=-(v*(V*Bt-j*mt)-F*(E*Bt-A*mt)+nt*(E*j-A*V)),n[5]=a*(V*Bt-j*mt)-F*(o*Bt-h*mt)+nt*(o*j-h*V),n[6]=-(a*(E*Bt-A*mt)-v*(o*Bt-h*mt)+nt*(o*A-h*E)),n[7]=a*(E*j-A*V)-v*(o*j-h*V)+F*(o*A-h*E),n[8]=v*(B*Bt-j*at)-F*(m*Bt-A*at)+nt*(m*j-A*B),n[9]=-(a*(B*Bt-j*at)-F*(s*Bt-h*at)+nt*(s*j-h*B)),n[10]=a*(m*Bt-A*at)-v*(s*Bt-h*at)+nt*(s*A-h*m),n[11]=-(a*(m*j-A*B)-v*(s*j-h*B)+F*(s*A-h*m)),n[12]=-(v*(B*mt-V*at)-F*(m*mt-E*at)+nt*(m*V-E*B)),n[13]=a*(B*mt-V*at)-F*(s*mt-o*at)+nt*(s*V-o*B),n[14]=-(a*(m*mt-E*at)-v*(s*mt-o*at)+nt*(s*E-o*m)),n[15]=a*(m*V-E*B)-v*(s*V-o*B)+F*(s*E-o*m),n}function sn(n){var l=n[0],a=n[1],s=n[2],o=n[3],h=n[4],v=n[5],m=n[6],E=n[7],A=n[8],F=n[9],B=n[10],V=n[11],j=n[12],nt=n[13],at=n[14],mt=n[15],Bt=l*v-a*h,de=l*m-s*h,ce=l*E-o*h,Be=a*m-s*v,Xe=a*E-o*v,_r=s*E-o*m,Ir=A*nt-F*j,Nr=A*at-B*j,Yr=A*mt-V*j,yn=F*at-B*nt,fn=F*mt-V*nt,$n=B*mt-V*at;return Bt*$n-de*fn+ce*yn+Be*Yr-Xe*Nr+_r*Ir}function mr(n,l,a){var s=l[0],o=l[1],h=l[2],v=l[3],m=l[4],E=l[5],A=l[6],F=l[7],B=l[8],V=l[9],j=l[10],nt=l[11],at=l[12],mt=l[13],Bt=l[14],de=l[15],ce=a[0],Be=a[1],Xe=a[2],_r=a[3];return n[0]=ce*s+Be*m+Xe*B+_r*at,n[1]=ce*o+Be*E+Xe*V+_r*mt,n[2]=ce*h+Be*A+Xe*j+_r*Bt,n[3]=ce*v+Be*F+Xe*nt+_r*de,ce=a[4],Be=a[5],Xe=a[6],_r=a[7],n[4]=ce*s+Be*m+Xe*B+_r*at,n[5]=ce*o+Be*E+Xe*V+_r*mt,n[6]=ce*h+Be*A+Xe*j+_r*Bt,n[7]=ce*v+Be*F+Xe*nt+_r*de,ce=a[8],Be=a[9],Xe=a[10],_r=a[11],n[8]=ce*s+Be*m+Xe*B+_r*at,n[9]=ce*o+Be*E+Xe*V+_r*mt,n[10]=ce*h+Be*A+Xe*j+_r*Bt,n[11]=ce*v+Be*F+Xe*nt+_r*de,ce=a[12],Be=a[13],Xe=a[14],_r=a[15],n[12]=ce*s+Be*m+Xe*B+_r*at,n[13]=ce*o+Be*E+Xe*V+_r*mt,n[14]=ce*h+Be*A+Xe*j+_r*Bt,n[15]=ce*v+Be*F+Xe*nt+_r*de,n}function pr(n,l,a){var s=a[0],o=a[1],h=a[2],v,m,E,A,F,B,V,j,nt,at,mt,Bt;return l===n?(n[12]=l[0]*s+l[4]*o+l[8]*h+l[12],n[13]=l[1]*s+l[5]*o+l[9]*h+l[13],n[14]=l[2]*s+l[6]*o+l[10]*h+l[14],n[15]=l[3]*s+l[7]*o+l[11]*h+l[15]):(v=l[0],m=l[1],E=l[2],A=l[3],F=l[4],B=l[5],V=l[6],j=l[7],nt=l[8],at=l[9],mt=l[10],Bt=l[11],n[0]=v,n[1]=m,n[2]=E,n[3]=A,n[4]=F,n[5]=B,n[6]=V,n[7]=j,n[8]=nt,n[9]=at,n[10]=mt,n[11]=Bt,n[12]=v*s+F*o+nt*h+l[12],n[13]=m*s+B*o+at*h+l[13],n[14]=E*s+V*o+mt*h+l[14],n[15]=A*s+j*o+Bt*h+l[15]),n}function kr(n,l,a){var s=a[0],o=a[1],h=a[2];return n[0]=l[0]*s,n[1]=l[1]*s,n[2]=l[2]*s,n[3]=l[3]*s,n[4]=l[4]*o,n[5]=l[5]*o,n[6]=l[6]*o,n[7]=l[7]*o,n[8]=l[8]*h,n[9]=l[9]*h,n[10]=l[10]*h,n[11]=l[11]*h,n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15],n}function Ve(n,l,a,s){var o=s[0],h=s[1],v=s[2],m=Math.hypot(o,h,v),E,A,F,B,V,j,nt,at,mt,Bt,de,ce,Be,Xe,_r,Ir,Nr,Yr,yn,fn,$n,di,Yi,ho;return m<Po.Ib?null:(m=1/m,o*=m,h*=m,v*=m,E=Math.sin(a),A=Math.cos(a),F=1-A,B=l[0],V=l[1],j=l[2],nt=l[3],at=l[4],mt=l[5],Bt=l[6],de=l[7],ce=l[8],Be=l[9],Xe=l[10],_r=l[11],Ir=o*o*F+A,Nr=h*o*F+v*E,Yr=v*o*F-h*E,yn=o*h*F-v*E,fn=h*h*F+A,$n=v*h*F+o*E,di=o*v*F+h*E,Yi=h*v*F-o*E,ho=v*v*F+A,n[0]=B*Ir+at*Nr+ce*Yr,n[1]=V*Ir+mt*Nr+Be*Yr,n[2]=j*Ir+Bt*Nr+Xe*Yr,n[3]=nt*Ir+de*Nr+_r*Yr,n[4]=B*yn+at*fn+ce*$n,n[5]=V*yn+mt*fn+Be*$n,n[6]=j*yn+Bt*fn+Xe*$n,n[7]=nt*yn+de*fn+_r*$n,n[8]=B*di+at*Yi+ce*ho,n[9]=V*di+mt*Yi+Be*ho,n[10]=j*di+Bt*Yi+Xe*ho,n[11]=nt*di+de*Yi+_r*ho,l!==n&&(n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n)}function vr(n,l,a){var s=Math.sin(a),o=Math.cos(a),h=l[4],v=l[5],m=l[6],E=l[7],A=l[8],F=l[9],B=l[10],V=l[11];return l!==n&&(n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n[4]=h*o+A*s,n[5]=v*o+F*s,n[6]=m*o+B*s,n[7]=E*o+V*s,n[8]=A*o-h*s,n[9]=F*o-v*s,n[10]=B*o-m*s,n[11]=V*o-E*s,n}function Qe(n,l,a){var s=Math.sin(a),o=Math.cos(a),h=l[0],v=l[1],m=l[2],E=l[3],A=l[8],F=l[9],B=l[10],V=l[11];return l!==n&&(n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n[0]=h*o-A*s,n[1]=v*o-F*s,n[2]=m*o-B*s,n[3]=E*o-V*s,n[8]=h*s+A*o,n[9]=v*s+F*o,n[10]=m*s+B*o,n[11]=E*s+V*o,n}function Hr(n,l,a){var s=Math.sin(a),o=Math.cos(a),h=l[0],v=l[1],m=l[2],E=l[3],A=l[4],F=l[5],B=l[6],V=l[7];return l!==n&&(n[8]=l[8],n[9]=l[9],n[10]=l[10],n[11]=l[11],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n[0]=h*o+A*s,n[1]=v*o+F*s,n[2]=m*o+B*s,n[3]=E*o+V*s,n[4]=A*o-h*s,n[5]=F*o-v*s,n[6]=B*o-m*s,n[7]=V*o-E*s,n}function Jr(n,l){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=l[0],n[13]=l[1],n[14]=l[2],n[15]=1,n}function Bn(n,l){return n[0]=l[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=l[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=l[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function gi(n,l,a){var s=a[0],o=a[1],h=a[2],v=Math.hypot(s,o,h),m,E,A;return v<Po.Ib?null:(v=1/v,s*=v,o*=v,h*=v,m=Math.sin(l),E=Math.cos(l),A=1-E,n[0]=s*s*A+E,n[1]=o*s*A+h*m,n[2]=h*s*A-o*m,n[3]=0,n[4]=s*o*A-h*m,n[5]=o*o*A+E,n[6]=h*o*A+s*m,n[7]=0,n[8]=s*h*A+o*m,n[9]=o*h*A-s*m,n[10]=h*h*A+E,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}function mi(n,l){var a=Math.sin(l),s=Math.cos(l);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=a,n[7]=0,n[8]=0,n[9]=-a,n[10]=s,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function pi(n,l){var a=Math.sin(l),s=Math.cos(l);return n[0]=s,n[1]=0,n[2]=-a,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=a,n[9]=0,n[10]=s,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function fi(n,l){var a=Math.sin(l),s=Math.cos(l);return n[0]=s,n[1]=a,n[2]=0,n[3]=0,n[4]=-a,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Xi(n,l,a){var s=l[0],o=l[1],h=l[2],v=l[3],m=s+s,E=o+o,A=h+h,F=s*m,B=s*E,V=s*A,j=o*E,nt=o*A,at=h*A,mt=v*m,Bt=v*E,de=v*A;return n[0]=1-(j+at),n[1]=B+de,n[2]=V-Bt,n[3]=0,n[4]=B-de,n[5]=1-(F+at),n[6]=nt+mt,n[7]=0,n[8]=V+Bt,n[9]=nt-mt,n[10]=1-(F+j),n[11]=0,n[12]=a[0],n[13]=a[1],n[14]=a[2],n[15]=1,n}function Pi(n,l){var a=new Po.WT(3),s=-l[0],o=-l[1],h=-l[2],v=l[3],m=l[4],E=l[5],A=l[6],F=l[7],B=s*s+o*o+h*h+v*v;return B>0?(a[0]=(m*v+F*s+E*h-A*o)*2/B,a[1]=(E*v+F*o+A*s-m*h)*2/B,a[2]=(A*v+F*h+m*o-E*s)*2/B):(a[0]=(m*v+F*s+E*h-A*o)*2,a[1]=(E*v+F*o+A*s-m*h)*2,a[2]=(A*v+F*h+m*o-E*s)*2),Xi(n,l,a),n}function Gi(n,l){return n[0]=l[12],n[1]=l[13],n[2]=l[14],n}function kn(n,l){var a=l[0],s=l[1],o=l[2],h=l[4],v=l[5],m=l[6],E=l[8],A=l[9],F=l[10];return n[0]=Math.hypot(a,s,o),n[1]=Math.hypot(h,v,m),n[2]=Math.hypot(E,A,F),n}function Ni(n,l){var a=new Po.WT(3);kn(a,l);var s=1/a[0],o=1/a[1],h=1/a[2],v=l[0]*s,m=l[1]*o,E=l[2]*h,A=l[4]*s,F=l[5]*o,B=l[6]*h,V=l[8]*s,j=l[9]*o,nt=l[10]*h,at=v+F+nt,mt=0;return at>0?(mt=Math.sqrt(at+1)*2,n[3]=.25*mt,n[0]=(B-j)/mt,n[1]=(V-E)/mt,n[2]=(m-A)/mt):v>F&&v>nt?(mt=Math.sqrt(1+v-F-nt)*2,n[3]=(B-j)/mt,n[0]=.25*mt,n[1]=(m+A)/mt,n[2]=(V+E)/mt):F>nt?(mt=Math.sqrt(1+F-v-nt)*2,n[3]=(V-E)/mt,n[0]=(m+A)/mt,n[1]=.25*mt,n[2]=(B+j)/mt):(mt=Math.sqrt(1+nt-v-F)*2,n[3]=(m-A)/mt,n[0]=(V+E)/mt,n[1]=(B+j)/mt,n[2]=.25*mt),n}function Ea(n,l,a,s){var o=l[0],h=l[1],v=l[2],m=l[3],E=o+o,A=h+h,F=v+v,B=o*E,V=o*A,j=o*F,nt=h*A,at=h*F,mt=v*F,Bt=m*E,de=m*A,ce=m*F,Be=s[0],Xe=s[1],_r=s[2];return n[0]=(1-(nt+mt))*Be,n[1]=(V+ce)*Be,n[2]=(j-de)*Be,n[3]=0,n[4]=(V-ce)*Xe,n[5]=(1-(B+mt))*Xe,n[6]=(at+Bt)*Xe,n[7]=0,n[8]=(j+de)*_r,n[9]=(at-Bt)*_r,n[10]=(1-(B+nt))*_r,n[11]=0,n[12]=a[0],n[13]=a[1],n[14]=a[2],n[15]=1,n}function jo(n,l,a,s,o){var h=l[0],v=l[1],m=l[2],E=l[3],A=h+h,F=v+v,B=m+m,V=h*A,j=h*F,nt=h*B,at=v*F,mt=v*B,Bt=m*B,de=E*A,ce=E*F,Be=E*B,Xe=s[0],_r=s[1],Ir=s[2],Nr=o[0],Yr=o[1],yn=o[2],fn=(1-(at+Bt))*Xe,$n=(j+Be)*Xe,di=(nt-ce)*Xe,Yi=(j-Be)*_r,ho=(1-(V+Bt))*_r,zo=(mt+de)*_r,Vs=(nt+ce)*Ir,hu=(mt-de)*Ir,Gu=(1-(V+at))*Ir;return n[0]=fn,n[1]=$n,n[2]=di,n[3]=0,n[4]=Yi,n[5]=ho,n[6]=zo,n[7]=0,n[8]=Vs,n[9]=hu,n[10]=Gu,n[11]=0,n[12]=a[0]+Nr-(fn*Nr+Yi*Yr+Vs*yn),n[13]=a[1]+Yr-($n*Nr+ho*Yr+hu*yn),n[14]=a[2]+yn-(di*Nr+zo*Yr+Gu*yn),n[15]=1,n}function Iu(n,l){var a=l[0],s=l[1],o=l[2],h=l[3],v=a+a,m=s+s,E=o+o,A=a*v,F=s*v,B=s*m,V=o*v,j=o*m,nt=o*E,at=h*v,mt=h*m,Bt=h*E;return n[0]=1-B-nt,n[1]=F+Bt,n[2]=V-mt,n[3]=0,n[4]=F-Bt,n[5]=1-A-nt,n[6]=j+at,n[7]=0,n[8]=V+mt,n[9]=j-at,n[10]=1-A-B,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function _a(n,l,a,s,o,h,v){var m=1/(a-l),E=1/(o-s),A=1/(h-v);return n[0]=h*2*m,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h*2*E,n[6]=0,n[7]=0,n[8]=(a+l)*m,n[9]=(o+s)*E,n[10]=(v+h)*A,n[11]=-1,n[12]=0,n[13]=0,n[14]=v*h*2*A,n[15]=0,n}function mo(n,l,a,s,o){var h=1/Math.tan(l/2),v;return n[0]=h/a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,o!=null&&o!==1/0?(v=1/(s-o),n[10]=(o+s)*v,n[14]=2*o*s*v):(n[10]=-1,n[14]=-2*s),n}var Oc=mo;function Al(n,l,a,s,o){var h=1/Math.tan(l/2),v;return n[0]=h/a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,o!=null&&o!==1/0?(v=1/(s-o),n[10]=o*v,n[14]=o*s*v):(n[10]=-1,n[14]=-s),n}function lf(n,l,a,s){var o=Math.tan(l.upDegrees*Math.PI/180),h=Math.tan(l.downDegrees*Math.PI/180),v=Math.tan(l.leftDegrees*Math.PI/180),m=Math.tan(l.rightDegrees*Math.PI/180),E=2/(v+m),A=2/(o+h);return n[0]=E,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=A,n[6]=0,n[7]=0,n[8]=-((v-m)*E*.5),n[9]=(o-h)*A*.5,n[10]=s/(a-s),n[11]=-1,n[12]=0,n[13]=0,n[14]=s*a/(a-s),n[15]=0,n}function Zl(n,l,a,s,o,h,v){var m=1/(l-a),E=1/(s-o),A=1/(h-v);return n[0]=-2*m,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*E,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*A,n[11]=0,n[12]=(l+a)*m,n[13]=(o+s)*E,n[14]=(v+h)*A,n[15]=1,n}var Y0=Zl;function Ll(n,l,a,s,o,h,v){var m=1/(l-a),E=1/(s-o),A=1/(h-v);return n[0]=-2*m,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*E,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=A,n[11]=0,n[12]=(l+a)*m,n[13]=(o+s)*E,n[14]=h*A,n[15]=1,n}function rh(n,l,a,s){var o,h,v,m,E,A,F,B,V,j,nt=l[0],at=l[1],mt=l[2],Bt=s[0],de=s[1],ce=s[2],Be=a[0],Xe=a[1],_r=a[2];return Math.abs(nt-Be)<Po.Ib&&Math.abs(at-Xe)<Po.Ib&&Math.abs(mt-_r)<Po.Ib?$e(n):(F=nt-Be,B=at-Xe,V=mt-_r,j=1/Math.hypot(F,B,V),F*=j,B*=j,V*=j,o=de*V-ce*B,h=ce*F-Bt*V,v=Bt*B-de*F,j=Math.hypot(o,h,v),j?(j=1/j,o*=j,h*=j,v*=j):(o=0,h=0,v=0),m=B*v-V*h,E=V*o-F*v,A=F*h-B*o,j=Math.hypot(m,E,A),j?(j=1/j,m*=j,E*=j,A*=j):(m=0,E=0,A=0),n[0]=o,n[1]=m,n[2]=F,n[3]=0,n[4]=h,n[5]=E,n[6]=B,n[7]=0,n[8]=v,n[9]=A,n[10]=V,n[11]=0,n[12]=-(o*nt+h*at+v*mt),n[13]=-(m*nt+E*at+A*mt),n[14]=-(F*nt+B*at+V*mt),n[15]=1,n)}function cp(n,l,a,s){var o=l[0],h=l[1],v=l[2],m=s[0],E=s[1],A=s[2],F=o-a[0],B=h-a[1],V=v-a[2],j=F*F+B*B+V*V;j>0&&(j=1/Math.sqrt(j),F*=j,B*=j,V*=j);var nt=E*V-A*B,at=A*F-m*V,mt=m*B-E*F;return j=nt*nt+at*at+mt*mt,j>0&&(j=1/Math.sqrt(j),nt*=j,at*=j,mt*=j),n[0]=nt,n[1]=at,n[2]=mt,n[3]=0,n[4]=B*mt-V*at,n[5]=V*nt-F*mt,n[6]=F*at-B*nt,n[7]=0,n[8]=F,n[9]=B,n[10]=V,n[11]=0,n[12]=o,n[13]=h,n[14]=v,n[15]=1,n}function gv(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}function ku(n){return Math.hypot(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}function mv(n,l,a){return n[0]=l[0]+a[0],n[1]=l[1]+a[1],n[2]=l[2]+a[2],n[3]=l[3]+a[3],n[4]=l[4]+a[4],n[5]=l[5]+a[5],n[6]=l[6]+a[6],n[7]=l[7]+a[7],n[8]=l[8]+a[8],n[9]=l[9]+a[9],n[10]=l[10]+a[10],n[11]=l[11]+a[11],n[12]=l[12]+a[12],n[13]=l[13]+a[13],n[14]=l[14]+a[14],n[15]=l[15]+a[15],n}function Mh(n,l,a){return n[0]=l[0]-a[0],n[1]=l[1]-a[1],n[2]=l[2]-a[2],n[3]=l[3]-a[3],n[4]=l[4]-a[4],n[5]=l[5]-a[5],n[6]=l[6]-a[6],n[7]=l[7]-a[7],n[8]=l[8]-a[8],n[9]=l[9]-a[9],n[10]=l[10]-a[10],n[11]=l[11]-a[11],n[12]=l[12]-a[12],n[13]=l[13]-a[13],n[14]=l[14]-a[14],n[15]=l[15]-a[15],n}function i0(n,l,a){return n[0]=l[0]*a,n[1]=l[1]*a,n[2]=l[2]*a,n[3]=l[3]*a,n[4]=l[4]*a,n[5]=l[5]*a,n[6]=l[6]*a,n[7]=l[7]*a,n[8]=l[8]*a,n[9]=l[9]*a,n[10]=l[10]*a,n[11]=l[11]*a,n[12]=l[12]*a,n[13]=l[13]*a,n[14]=l[14]*a,n[15]=l[15]*a,n}function $0(n,l,a,s){return n[0]=l[0]+a[0]*s,n[1]=l[1]+a[1]*s,n[2]=l[2]+a[2]*s,n[3]=l[3]+a[3]*s,n[4]=l[4]+a[4]*s,n[5]=l[5]+a[5]*s,n[6]=l[6]+a[6]*s,n[7]=l[7]+a[7]*s,n[8]=l[8]+a[8]*s,n[9]=l[9]+a[9]*s,n[10]=l[10]+a[10]*s,n[11]=l[11]+a[11]*s,n[12]=l[12]+a[12]*s,n[13]=l[13]+a[13]*s,n[14]=l[14]+a[14]*s,n[15]=l[15]+a[15]*s,n}function Zg(n,l){return n[0]===l[0]&&n[1]===l[1]&&n[2]===l[2]&&n[3]===l[3]&&n[4]===l[4]&&n[5]===l[5]&&n[6]===l[6]&&n[7]===l[7]&&n[8]===l[8]&&n[9]===l[9]&&n[10]===l[10]&&n[11]===l[11]&&n[12]===l[12]&&n[13]===l[13]&&n[14]===l[14]&&n[15]===l[15]}function Kp(n,l){var a=n[0],s=n[1],o=n[2],h=n[3],v=n[4],m=n[5],E=n[6],A=n[7],F=n[8],B=n[9],V=n[10],j=n[11],nt=n[12],at=n[13],mt=n[14],Bt=n[15],de=l[0],ce=l[1],Be=l[2],Xe=l[3],_r=l[4],Ir=l[5],Nr=l[6],Yr=l[7],yn=l[8],fn=l[9],$n=l[10],di=l[11],Yi=l[12],ho=l[13],zo=l[14],Vs=l[15];return Math.abs(a-de)<=Po.Ib*Math.max(1,Math.abs(a),Math.abs(de))&&Math.abs(s-ce)<=Po.Ib*Math.max(1,Math.abs(s),Math.abs(ce))&&Math.abs(o-Be)<=Po.Ib*Math.max(1,Math.abs(o),Math.abs(Be))&&Math.abs(h-Xe)<=Po.Ib*Math.max(1,Math.abs(h),Math.abs(Xe))&&Math.abs(v-_r)<=Po.Ib*Math.max(1,Math.abs(v),Math.abs(_r))&&Math.abs(m-Ir)<=Po.Ib*Math.max(1,Math.abs(m),Math.abs(Ir))&&Math.abs(E-Nr)<=Po.Ib*Math.max(1,Math.abs(E),Math.abs(Nr))&&Math.abs(A-Yr)<=Po.Ib*Math.max(1,Math.abs(A),Math.abs(Yr))&&Math.abs(F-yn)<=Po.Ib*Math.max(1,Math.abs(F),Math.abs(yn))&&Math.abs(B-fn)<=Po.Ib*Math.max(1,Math.abs(B),Math.abs(fn))&&Math.abs(V-$n)<=Po.Ib*Math.max(1,Math.abs(V),Math.abs($n))&&Math.abs(j-di)<=Po.Ib*Math.max(1,Math.abs(j),Math.abs(di))&&Math.abs(nt-Yi)<=Po.Ib*Math.max(1,Math.abs(nt),Math.abs(Yi))&&Math.abs(at-ho)<=Po.Ib*Math.max(1,Math.abs(at),Math.abs(ho))&&Math.abs(mt-zo)<=Po.Ib*Math.max(1,Math.abs(mt),Math.abs(zo))&&Math.abs(Bt-Vs)<=Po.Ib*Math.max(1,Math.abs(Bt),Math.abs(Vs))}var Ih=mr,jm=Mh,Vg,Gg,Lu=(Vg=(0,Mt.b2)(),Vg(Gg=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"viewport",void 0),(0,W.Z)(this,"overridedViewProjectionMatrix",void 0),(0,W.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,W.Z)(this,"jitteredProjectionMatrix",void 0),(0,W.Z)(this,"viewMatrixInverse",void 0),(0,W.Z)(this,"cameraPosition",void 0)}return(0,tt.Z)(n,[{key:"init",value:function(){}},{key:"update",value:function(a){this.viewport=a,this.viewMatrixInverse=Ke(),yr(this.viewMatrixInverse,a.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var a=this.viewport.getCenter(),s=(0,ht.Z)(a,2),o=s[0],h=s[1];return[o,h]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(a,s){return this.viewport.projectFlat(a,s)}},{key:"setViewProjectionMatrix",value:function(a){this.overridedViewProjectionMatrix=a}},{key:"jitterProjectionMatrix",value:function(a,s){var o=Jr(Ke(),[a,s,0]);this.jitteredProjectionMatrix=mr(Ke(),o,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=mr(Ke(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),n}())||Gg),Vl;(function(n){n.TOPRIGHT="topright",n.TOPLEFT="topleft",n.BOTTOMRIGHT="bottomright",n.BOTTOMLEFT="bottomleft",n.TOPCENTER="topcenter",n.BOTTOMCENTER="bottomcenter",n.LEFTCENTER="leftcenter",n.RIGHTCENTER="rightcenter",n.LEFTTOP="lefttop",n.RIGHTTOP="righttop",n.LEFTBOTTOM="leftbottom",n.RIGHTBOTTOM="rightbottom"})(Vl||(Vl={}));var q0,f;function d(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=y(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function y(n,l){if(!!n){if(typeof n=="string")return T(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return T(n,l)}}function T(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var O={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},N=(q0=(0,Mt.b2)(),q0(f=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"container",void 0),(0,W.Z)(this,"controlCorners",void 0),(0,W.Z)(this,"controlContainer",void 0),(0,W.Z)(this,"scene",void 0),(0,W.Z)(this,"mapsService",void 0),(0,W.Z)(this,"controls",[]),(0,W.Z)(this,"unAddControls",[])}return(0,tt.Z)(n,[{key:"init",value:function(a,s){this.container=a.container,this.scene=s,this.mapsService=s.get(Dt.IMapService),this.initControlPos()}},{key:"addControl",value:function(a,s){var o=s.get(Dt.IMapService);o.map?(a.addTo(this.scene),this.controls.push(a)):this.unAddControls.push(a)}},{key:"getControlByName",value:function(a){return this.controls.find(function(s){return s.controlOption.name===a})}},{key:"removeControl",value:function(a){var s=this.controls.indexOf(a);return s>-1&&this.controls.splice(s,1),a.remove(),this}},{key:"addControls",value:function(){var a=this;this.unAddControls.forEach(function(s){s.addTo(a.scene),a.controls.push(s)}),this.unAddControls=[]}},{key:"destroy",value:function(){var a=d(this.controls),s;try{for(a.s();!(s=a.n()).done;){var o=s.value;o.remove()}}catch(h){a.e(h)}finally{a.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var a=this.controlCorners={},s="l7-",o=this.controlContainer=_t("div",s+"control-container",this.container);function h(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],E=m.map(function(A){return s+A}).join(" ");a[m.filter(function(A){return!["row","column"].includes(A)}).join("")]=_t("div",E,o)}function v(m){var E=m.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat((0,ge.Z)(E),[O[m]])}Object.values(Vl).forEach(function(m){h(v(m))})}},{key:"clearControlPos",value:function(){for(var a in this.controlCorners)this.controlCorners[a]&&rt(this.controlCorners[a]);this.controlContainer&&rt(this.controlContainer)}}]),n}())||f),Z,q,dt=(Z=(0,Mt.b2)(),Z(q=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"container",void 0),(0,W.Z)(this,"scene",void 0),(0,W.Z)(this,"mapsService",void 0),(0,W.Z)(this,"markers",[]),(0,W.Z)(this,"markerLayers",[]),(0,W.Z)(this,"unAddMarkers",[]),(0,W.Z)(this,"unAddMarkerLayers",[])}return(0,tt.Z)(n,[{key:"addMarkerLayer",value:function(a){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(a),a.addTo(this.scene)):this.unAddMarkerLayers.push(a)}},{key:"removeMarkerLayer",value:function(a){a.destroy(),this.markerLayers.indexOf(a);var s=this.markerLayers.indexOf(a);s>-1&&this.markerLayers.splice(s,1)}},{key:"addMarker",value:function(a){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(a),a.addTo(this.scene)):this.unAddMarkers.push(a)}},{key:"addMarkers",value:function(){var a=this;this.unAddMarkers.forEach(function(s){s.addTo(a.scene),a.markers.push(s)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var a=this;this.unAddMarkerLayers.forEach(function(s){a.markerLayers.push(s),s.addTo(a.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(a){a.remove(),this.markers.indexOf(a);var s=this.markers.indexOf(a);s>-1&&this.markers.splice(s,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(a){this.scene=a,this.mapsService=a.get(Dt.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(a){a.remove()}),this.markers=[],this.markerLayers.forEach(function(a){a.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(a){a.destroy()}}]),n}())||q),Pt,Zt,qt=(Pt=(0,Mt.b2)(),Pt(Zt=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"scene",void 0),(0,W.Z)(this,"mapsService",void 0),(0,W.Z)(this,"popups",[]),(0,W.Z)(this,"unAddPopups",[])}return(0,tt.Z)(n,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(a){a!=null&&a.isOpen()&&a.remove();var s=this.popups.indexOf(a);s>-1&&this.popups.splice(s,1);var o=this.unAddPopups.indexOf(a);o>-1&&this.unAddPopups.splice(o,1)}},{key:"destroy",value:function(){this.popups.forEach(function(a){return a.remove()})}},{key:"addPopup",value:function(a){var s=this;a&&a.getOptions().autoClose&&[].concat((0,ge.Z)(this.popups),(0,ge.Z)(this.unAddPopups)).forEach(function(o){o.getOptions().autoClose&&s.removePopup(o)}),this.isMarkerReady?(a.addTo(this.scene),this.popups.push(a)):this.unAddPopups.push(a),a.on("close",function(){s.removePopup(a)})}},{key:"initPopup",value:function(){var a=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(s){a.addPopup(s),a.unAddPopups=[]})}},{key:"init",value:function(a){this.scene=a,this.mapsService=a.get(Dt.IMapService)}}]),n}())||Zt),pe={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Oe=pe,sr,lr,Cr={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},gr={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},Ur=(sr=(0,Mt.b2)(),sr(lr=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"sceneConfigCache",{}),(0,W.Z)(this,"layerConfigCache",{}),(0,W.Z)(this,"layerAttributeConfigCache",{})}return(0,tt.Z)(n,[{key:"getSceneConfig",value:function(a){return this.sceneConfigCache[a]}},{key:"getSceneWarninfo",value:function(a){return Oe[a]}},{key:"setSceneConfig",value:function(a,s){this.sceneConfigCache[a]=(0,K.Z)((0,K.Z)({},Cr),s)}},{key:"getLayerConfig",value:function(a){return this.layerConfigCache[a]}},{key:"setLayerConfig",value:function(a,s,o){this.layerConfigCache[s]=(0,K.Z)({},(0,te.merge)({},this.sceneConfigCache[a],gr,o))}},{key:"getAttributeConfig",value:function(a){return this.layerAttributeConfigCache[a]}},{key:"setAttributeConfig",value:function(a,s){this.layerAttributeConfigCache[a]=(0,K.Z)((0,K.Z)({},this.layerAttributeConfigCache[a]),s)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),n}())||lr);function Ar(n,l,a,s){!a||Object.defineProperty(n,l,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(s):void 0})}function Dr(n,l,a,s,o){var h={};return Object.keys(s).forEach(function(v){h[v]=s[v]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=a.slice().reverse().reduce(function(v,m){return m(n,l,v)||v},h),o&&h.initializer!==void 0&&(h.value=h.initializer?h.initializer.call(o):void 0,h.initializer=void 0),h.initializer===void 0&&(Object.defineProperty(n,l,h),h=null),h}function mn(){var n=new Po.WT(4);return Po.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function Fn(n){var l=new glMatrix.ARRAY_TYPE(4);return l[0]=n[0],l[1]=n[1],l[2]=n[2],l[3]=n[3],l}function ni(n,l,a,s){var o=new Po.WT(4);return o[0]=n,o[1]=l,o[2]=a,o[3]=s,o}function ki(n,l){return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n}function oa(n,l,a,s,o){return n[0]=l,n[1]=a,n[2]=s,n[3]=o,n}function Di(n,l,a){return n[0]=l[0]+a[0],n[1]=l[1]+a[1],n[2]=l[2]+a[2],n[3]=l[3]+a[3],n}function ca(n,l,a){return n[0]=l[0]-a[0],n[1]=l[1]-a[1],n[2]=l[2]-a[2],n[3]=l[3]-a[3],n}function zi(n,l,a){return n[0]=l[0]*a[0],n[1]=l[1]*a[1],n[2]=l[2]*a[2],n[3]=l[3]*a[3],n}function Oa(n,l,a){return n[0]=l[0]/a[0],n[1]=l[1]/a[1],n[2]=l[2]/a[2],n[3]=l[3]/a[3],n}function xa(n,l){return n[0]=Math.ceil(l[0]),n[1]=Math.ceil(l[1]),n[2]=Math.ceil(l[2]),n[3]=Math.ceil(l[3]),n}function Qi(n,l){return n[0]=Math.floor(l[0]),n[1]=Math.floor(l[1]),n[2]=Math.floor(l[2]),n[3]=Math.floor(l[3]),n}function lo(n,l,a){return n[0]=Math.min(l[0],a[0]),n[1]=Math.min(l[1],a[1]),n[2]=Math.min(l[2],a[2]),n[3]=Math.min(l[3],a[3]),n}function Ja(n,l,a){return n[0]=Math.max(l[0],a[0]),n[1]=Math.max(l[1],a[1]),n[2]=Math.max(l[2],a[2]),n[3]=Math.max(l[3],a[3]),n}function To(n,l){return n[0]=Math.round(l[0]),n[1]=Math.round(l[1]),n[2]=Math.round(l[2]),n[3]=Math.round(l[3]),n}function ea(n,l,a){return n[0]=l[0]*a,n[1]=l[1]*a,n[2]=l[2]*a,n[3]=l[3]*a,n}function Zo(n,l,a,s){return n[0]=l[0]+a[0]*s,n[1]=l[1]+a[1]*s,n[2]=l[2]+a[2]*s,n[3]=l[3]+a[3]*s,n}function Es(n,l){var a=l[0]-n[0],s=l[1]-n[1],o=l[2]-n[2],h=l[3]-n[3];return Math.hypot(a,s,o,h)}function uu(n,l){var a=l[0]-n[0],s=l[1]-n[1],o=l[2]-n[2],h=l[3]-n[3];return a*a+s*s+o*o+h*h}function Ws(n){var l=n[0],a=n[1],s=n[2],o=n[3];return Math.hypot(l,a,s,o)}function ks(n){var l=n[0],a=n[1],s=n[2],o=n[3];return l*l+a*a+s*s+o*o}function eu(n,l){return n[0]=-l[0],n[1]=-l[1],n[2]=-l[2],n[3]=-l[3],n}function Qu(n,l){return n[0]=1/l[0],n[1]=1/l[1],n[2]=1/l[2],n[3]=1/l[3],n}function lu(n,l){var a=l[0],s=l[1],o=l[2],h=l[3],v=a*a+s*s+o*o+h*h;return v>0&&(v=1/Math.sqrt(v)),n[0]=a*v,n[1]=s*v,n[2]=o*v,n[3]=h*v,n}function Gl(n,l){return n[0]*l[0]+n[1]*l[1]+n[2]*l[2]+n[3]*l[3]}function us(n,l,a,s){var o=a[0]*s[1]-a[1]*s[0],h=a[0]*s[2]-a[2]*s[0],v=a[0]*s[3]-a[3]*s[0],m=a[1]*s[2]-a[2]*s[1],E=a[1]*s[3]-a[3]*s[1],A=a[2]*s[3]-a[3]*s[2],F=l[0],B=l[1],V=l[2],j=l[3];return n[0]=B*A-V*E+j*m,n[1]=-(F*A)+V*v-j*h,n[2]=F*E-B*v+j*o,n[3]=-(F*m)+B*h-V*o,n}function Hl(n,l,a,s){var o=l[0],h=l[1],v=l[2],m=l[3];return n[0]=o+s*(a[0]-o),n[1]=h+s*(a[1]-h),n[2]=v+s*(a[2]-v),n[3]=m+s*(a[3]-m),n}function mu(n,l){l=l||1;var a,s,o,h,v,m;do a=glMatrix.RANDOM()*2-1,s=glMatrix.RANDOM()*2-1,v=a*a+s*s;while(v>=1);do o=glMatrix.RANDOM()*2-1,h=glMatrix.RANDOM()*2-1,m=o*o+h*h;while(m>=1);var E=Math.sqrt((1-v)/m);return n[0]=l*a,n[1]=l*s,n[2]=l*o*E,n[3]=l*h*E,n}function cu(n,l,a){var s=l[0],o=l[1],h=l[2],v=l[3];return n[0]=a[0]*s+a[4]*o+a[8]*h+a[12]*v,n[1]=a[1]*s+a[5]*o+a[9]*h+a[13]*v,n[2]=a[2]*s+a[6]*o+a[10]*h+a[14]*v,n[3]=a[3]*s+a[7]*o+a[11]*h+a[15]*v,n}function ro(n,l,a){var s=l[0],o=l[1],h=l[2],v=a[0],m=a[1],E=a[2],A=a[3],F=A*s+m*h-E*o,B=A*o+E*s-v*h,V=A*h+v*o-m*s,j=-v*s-m*o-E*h;return n[0]=F*A+j*-v+B*-E-V*-m,n[1]=B*A+j*-m+V*-v-F*-E,n[2]=V*A+j*-E+F*-m-B*-v,n[3]=l[3],n}function va(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n}function ts(n){return"vec4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"}function Do(n,l){return n[0]===l[0]&&n[1]===l[1]&&n[2]===l[2]&&n[3]===l[3]}function jl(n,l){var a=n[0],s=n[1],o=n[2],h=n[3],v=l[0],m=l[1],E=l[2],A=l[3];return Math.abs(a-v)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-m)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(o-E)<=glMatrix.EPSILON*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(h-A)<=glMatrix.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))}var Uu=null,Ss=null,Pu=null,fu=null,Oo=null,cf=null,ff=null,nh=function(){var n=mn();return function(l,a,s,o,h,v){var m,E;for(a||(a=4),s||(s=0),o?E=Math.min(o*a+s,l.length):E=l.length,m=s;m<E;m+=a)n[0]=l[m],n[1]=l[m+1],n[2]=l[m+2],n[3]=l[m+3],h(n,n,v),l[m]=n[0],l[m+1]=n[1],l[m+2]=n[2],l[m+3]=n[3];return l}}(),ru=Math.PI/180,kh=512,fl=4003e4;function Qp(n){var l=n.latitude,a=l===void 0?0:l,s=n.zoom,o=s===void 0?0:s,h=n.scale,v=n.highPrecision,m=v===void 0?!1:v,E=n.flipY,A=E===void 0?!1:E;h=h!==void 0?h:Math.pow(2,o);var F={},B=kh*h,V=Math.cos(a*ru),j=B/360,nt=j/V,at=B/fl/V;if(F.pixelsPerMeter=[at,-at,at],F.metersPerPixel=[1/at,-1/at,1/at],F.pixelsPerDegree=[j,-nt,at],F.degreesPerPixel=[1/j,-1/nt,1/at],m){var mt=ru*Math.tan(a*ru)/V,Bt=j*mt/2,de=B/fl*mt,ce=de/nt*at;F.pixelsPerDegree2=[0,-Bt,de],F.pixelsPerMeter2=[ce,0,ce],A&&(F.pixelsPerDegree2[1]=-F.pixelsPerDegree2[1],F.pixelsPerMeter2[1]=-F.pixelsPerMeter2[1])}return A&&(F.pixelsPerMeter[1]=-F.pixelsPerMeter[1],F.metersPerPixel[1]=-F.metersPerPixel[1],F.pixelsPerDegree[1]=-F.pixelsPerDegree[1],F.degreesPerPixel[1]=-F.degreesPerPixel[1]),F}var Pl;(function(n){n[n.LNGLAT=1]="LNGLAT",n[n.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",n[n.VECTOR_TILE=3]="VECTOR_TILE",n[n.IDENTITY=4]="IDENTITY",n[n.P20=5]="P20",n[n.P20_OFFSET=6]="P20_OFFSET",n[n.METER_OFFSET=7]="METER_OFFSET",n[n.P20_2=8]="P20_2"})(Pl||(Pl={}));var Lf={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},ih,Nd,a0,fp,yv,zd=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],_v=(ih=(0,Mt.b2)(),Nd=(0,Mt.f3)(Dt.ICameraService),ih(a0=(fp=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"needRefresh",!0),Ar(this,"cameraService",yv,this),(0,W.Z)(this,"coordinateSystem",void 0),(0,W.Z)(this,"viewportCenter",void 0),(0,W.Z)(this,"viewportCenterProjection",void 0),(0,W.Z)(this,"pixelsPerDegree",void 0),(0,W.Z)(this,"pixelsPerDegree2",void 0),(0,W.Z)(this,"pixelsPerMeter",void 0)}return(0,tt.Z)(n,[{key:"refresh",value:function(a){var s=this.cameraService.getZoom(),o=this.cameraService.getZoomScale(),h=a||this.cameraService.getCenter(),v=Qp({latitude:h[1],zoom:s}),m=v.pixelsPerMeter,E=v.pixelsPerDegree;this.viewportCenter=h,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=m,this.pixelsPerDegree=E,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Pl.LNGLAT||this.coordinateSystem===Pl.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Pl.LNGLAT_OFFSET?this.calculateLnglatOffset(h,s):this.coordinateSystem===Pl.P20_OFFSET&&this.calculateLnglatOffset(h,s,o,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(a){this.coordinateSystem=a}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(a,s,o,h){var v=Qp({latitude:a[1],zoom:s,scale:o,flipY:h,highPrecision:!0}),m=v.pixelsPerMeter,E=v.pixelsPerDegree,A=v.pixelsPerDegree2,F=this.cameraService.getViewMatrix(),B=this.cameraService.getProjectionMatrix(),V=mr([],B,F),j=this.cameraService.projectFlat([Math.fround(a[0]),Math.fround(a[1])],Math.pow(2,s));this.viewportCenterProjection=cu([],[j[0],j[1],0,1],V),F=this.cameraService.getViewMatrixUncentered()||F,V=mr([],B,F),V=mr([],V,zd),this.cameraService.setViewProjectionMatrix(V),this.pixelsPerMeter=m,this.pixelsPerDegree=E,this.pixelsPerDegree2=A}}]),n}(),yv=Dr(fp.prototype,"cameraService",[Nd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fp))||a0),yc=ot(20396),hp=ot.n(yc),Zu;(function(n){n.Hover="hover",n.Click="click",n.Select="select",n.Active="active",n.Drag="drag"})(Zu||(Zu={}));var pp,Jp,Ud,Zd,xv;function bv(n){var l=Ev();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Ev(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Sv={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},td=(pp=(0,Mt.b2)(),Jp=(0,Mt.f3)(Dt.IMapService),pp(Ud=(Zd=function(n){(0,Ut.Z)(a,n);var l=bv(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"indragging",!1),Ar((0,st.Z)(s),"mapService",xv,(0,st.Z)(s)),(0,W.Z)((0,st.Z)(s),"hammertime",void 0),(0,W.Z)((0,st.Z)(s),"lastClickTime",0),(0,W.Z)((0,st.Z)(s),"lastClickXY",[-1,-1]),(0,W.Z)((0,st.Z)(s),"clickTimer",void 0),(0,W.Z)((0,st.Z)(s),"$containter",void 0),(0,W.Z)((0,st.Z)(s),"onDrag",function(m){var E=s.interactionEvent(m);E.type=Sv[E.type],E.type==="dragging"?s.indragging=!0:s.indragging=!1,s.emit(Zu.Drag,E)}),(0,W.Z)((0,st.Z)(s),"onHammer",function(m){m.srcEvent.stopPropagation();var E=s.interactionEvent(m);s.emit(Zu.Hover,E)}),(0,W.Z)((0,st.Z)(s),"onTouch",function(m){var E=m.touches[0];s.onHover({x:E.pageX,y:E.pageY,type:"touch"})}),(0,W.Z)((0,st.Z)(s),"onHover",function(m){var E=m.clientX,A=m.clientY,F=E,B=A,V=m.type,j=s.mapService.getMapContainer();if(j)if(_u)F=F-j.left-0,B=B-j.top-0;else{var nt=j.getBoundingClientRect(),at=nt.top,mt=nt.left;F=F-mt-j.clientLeft,B=B-at-j.clientTop}var Bt=s.mapService.containerToLngLat([F,B]);if(V==="click"){if(!_u&&"ontouchstart"in document.documentElement)return;s.isDoubleTap(F,B,Bt);return}if(V==="touch"){s.isDoubleTap(F,B,Bt);return}V!=="click"&&V!=="dblclick"&&s.emit(Zu.Hover,{x:F,y:B,lngLat:Bt,type:V,target:m})}),s}return(0,tt.Z)(a,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Zu.Hover)}},{key:"triggerHover",value:function(o){var h=o.x,v=o.y;this.emit(Zu.Hover,{x:h,y:v})}},{key:"triggerSelect",value:function(o){this.emit(Zu.Select,{featureId:o})}},{key:"triggerActive",value:function(o){this.emit(Zu.Active,{featureId:o})}},{key:"handleMiniEvent",value:function(o){this.onHover({clientX:o.touches[0].pageX,clientY:o.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var o=this.mapService.getMapContainer();if(o)if(_u)Co.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var h=new(hp()).Manager(o);h.add(new(hp()).Tap({event:"dblclick",taps:2})),h.add(new(hp()).Tap({event:"click"})),h.add(new(hp()).Pan({threshold:0,pointers:0})),h.add(new(hp()).Press({})),h.on("dblclick click",this.onHammer),h.on("panstart panmove panend pancancel",this.onDrag),o.addEventListener("mousemove",this.onHover),o.addEventListener("mousedown",this.onHover,!0),o.addEventListener("mouseup",this.onHover),o.addEventListener("contextmenu",this.onHover),this.hammertime=h}}},{key:"removeEventListenerOnMap",value:function(){if(_u)Co.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var o=this.mapService.getMapContainer();o&&(o.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),o.removeEventListener("mousedown",this.onHover),o.removeEventListener("mouseup",this.onHover),o.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(o){var h=o.type,v=o.pointerType,m,E;v==="touch"?(E=Math.floor(o.pointers[0].clientY),m=Math.floor(o.pointers[0].clientX)):(E=Math.floor(o.srcEvent.y),m=Math.floor(o.srcEvent.x));var A=this.mapService.getMapContainer();if(A){var F=A.getBoundingClientRect(),B=F.top,V=F.left;m-=V,E-=B}var j=this.mapService.containerToLngLat([m,E]);return{x:m,y:E,lngLat:j,type:h,target:o.srcEvent}}},{key:"isDoubleTap",value:function(o,h,v){var m=this,E=new Date().getTime(),A="click";E-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-o)<10&&Math.abs(this.lastClickXY[1]-h)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),A="dblclick",this.emit(Zu.Hover,{x:o,y:h,lngLat:v,type:A})):(this.lastClickTime=E,this.lastClickXY=[o,h],this.clickTimer=setTimeout(function(){A="click",m.emit(Zu.Hover,{x:o,y:h,lngLat:v,type:A})},400))}}]),a}(Te()),xv=Dr(Zd.prototype,"mapService",[Jp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zd))||Ud),wv=0;function o0(n){if(_u)return null;var l=n;if(typeof n=="string"&&(l=document.getElementById(n)),l){var a=document.createElement("div");return a.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,a.id="l7-scene-".concat(wv++),a.classList.add("l7-scene"),l.appendChild(a),a}return null}function Us(n){var l,a,s=!0;return n==null||(l=n.target)===null||l===void 0||(a=l.path)===null||a===void 0||a.map(function(o){if(o!=null&&o.classList){var h;o==null||(h=o.classList)===null||h===void 0||h.forEach(function(v){(v==="l7-marker"||v==="l7-popup")&&(s=!1)})}}),s}var Kt;(function(n){n[n.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",n[n.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",n[n.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.SRC_COLOR=768]="SRC_COLOR",n[n.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",n[n.SRC_ALPHA=770]="SRC_ALPHA",n[n.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",n[n.DST_ALPHA=772]="DST_ALPHA",n[n.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",n[n.DST_COLOR=774]="DST_COLOR",n[n.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",n[n.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",n[n.FUNC_ADD=32774]="FUNC_ADD",n[n.BLEND_EQUATION=32777]="BLEND_EQUATION",n[n.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",n[n.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",n[n.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",n[n.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",n[n.MAX_EXT=32776]="MAX_EXT",n[n.MIN_EXT=32775]="MIN_EXT",n[n.BLEND_DST_RGB=32968]="BLEND_DST_RGB",n[n.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",n[n.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",n[n.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",n[n.CONSTANT_COLOR=32769]="CONSTANT_COLOR",n[n.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",n[n.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",n[n.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",n[n.BLEND_COLOR=32773]="BLEND_COLOR",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",n[n.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",n[n.STREAM_DRAW=35040]="STREAM_DRAW",n[n.STATIC_DRAW=35044]="STATIC_DRAW",n[n.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",n[n.BUFFER_SIZE=34660]="BUFFER_SIZE",n[n.BUFFER_USAGE=34661]="BUFFER_USAGE",n[n.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",n[n.FRONT=1028]="FRONT",n[n.BACK=1029]="BACK",n[n.FRONT_AND_BACK=1032]="FRONT_AND_BACK",n[n.CULL_FACE=2884]="CULL_FACE",n[n.BLEND=3042]="BLEND",n[n.DITHER=3024]="DITHER",n[n.STENCIL_TEST=2960]="STENCIL_TEST",n[n.DEPTH_TEST=2929]="DEPTH_TEST",n[n.SCISSOR_TEST=3089]="SCISSOR_TEST",n[n.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",n[n.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",n[n.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",n[n.NO_ERROR=0]="NO_ERROR",n[n.INVALID_ENUM=1280]="INVALID_ENUM",n[n.INVALID_VALUE=1281]="INVALID_VALUE",n[n.INVALID_OPERATION=1282]="INVALID_OPERATION",n[n.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",n[n.CW=2304]="CW",n[n.CCW=2305]="CCW",n[n.LINE_WIDTH=2849]="LINE_WIDTH",n[n.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",n[n.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",n[n.CULL_FACE_MODE=2885]="CULL_FACE_MODE",n[n.FRONT_FACE=2886]="FRONT_FACE",n[n.DEPTH_RANGE=2928]="DEPTH_RANGE",n[n.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",n[n.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",n[n.DEPTH_FUNC=2932]="DEPTH_FUNC",n[n.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",n[n.STENCIL_FUNC=2962]="STENCIL_FUNC",n[n.STENCIL_FAIL=2964]="STENCIL_FAIL",n[n.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",n[n.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",n[n.STENCIL_REF=2967]="STENCIL_REF",n[n.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",n[n.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",n[n.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",n[n.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",n[n.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",n[n.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",n[n.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",n[n.VIEWPORT=2978]="VIEWPORT",n[n.SCISSOR_BOX=3088]="SCISSOR_BOX",n[n.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",n[n.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",n[n.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",n[n.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",n[n.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",n[n.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",n[n.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",n[n.RED_BITS=3410]="RED_BITS",n[n.GREEN_BITS=3411]="GREEN_BITS",n[n.BLUE_BITS=3412]="BLUE_BITS",n[n.ALPHA_BITS=3413]="ALPHA_BITS",n[n.DEPTH_BITS=3414]="DEPTH_BITS",n[n.STENCIL_BITS=3415]="STENCIL_BITS",n[n.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",n[n.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",n[n.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",n[n.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",n[n.SAMPLES=32937]="SAMPLES",n[n.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",n[n.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",n[n.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",n[n.DONT_CARE=4352]="DONT_CARE",n[n.FASTEST=4353]="FASTEST",n[n.NICEST=4354]="NICEST",n[n.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",n[n.BYTE=5120]="BYTE",n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.SHORT=5122]="SHORT",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.INT=5124]="INT",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.FLOAT=5126]="FLOAT",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.ALPHA=6406]="ALPHA",n[n.RGB=6407]="RGB",n[n.RGBA=6408]="RGBA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",n[n.VERTEX_SHADER=35633]="VERTEX_SHADER",n[n.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",n[n.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",n[n.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",n[n.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",n[n.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",n[n.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",n[n.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",n[n.SHADER_TYPE=35663]="SHADER_TYPE",n[n.DELETE_STATUS=35712]="DELETE_STATUS",n[n.LINK_STATUS=35714]="LINK_STATUS",n[n.VALIDATE_STATUS=35715]="VALIDATE_STATUS",n[n.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",n[n.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",n[n.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",n[n.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",n[n.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",n[n.NEVER=512]="NEVER",n[n.LESS=513]="LESS",n[n.EQUAL=514]="EQUAL",n[n.LEQUAL=515]="LEQUAL",n[n.GREATER=516]="GREATER",n[n.NOTEQUAL=517]="NOTEQUAL",n[n.GEQUAL=518]="GEQUAL",n[n.ALWAYS=519]="ALWAYS",n[n.KEEP=7680]="KEEP",n[n.REPLACE=7681]="REPLACE",n[n.INCR=7682]="INCR",n[n.DECR=7683]="DECR",n[n.INVERT=5386]="INVERT",n[n.INCR_WRAP=34055]="INCR_WRAP",n[n.DECR_WRAP=34056]="DECR_WRAP",n[n.VENDOR=7936]="VENDOR",n[n.RENDERER=7937]="RENDERER",n[n.VERSION=7938]="VERSION",n[n.NEAREST=9728]="NEAREST",n[n.LINEAR=9729]="LINEAR",n[n.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",n[n.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",n[n.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",n[n.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",n[n.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",n[n.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",n[n.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",n[n.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE=5890]="TEXTURE",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n[n.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",n[n.TEXTURE0=33984]="TEXTURE0",n[n.TEXTURE1=33985]="TEXTURE1",n[n.TEXTURE2=33986]="TEXTURE2",n[n.TEXTURE3=33987]="TEXTURE3",n[n.TEXTURE4=33988]="TEXTURE4",n[n.TEXTURE5=33989]="TEXTURE5",n[n.TEXTURE6=33990]="TEXTURE6",n[n.TEXTURE7=33991]="TEXTURE7",n[n.TEXTURE8=33992]="TEXTURE8",n[n.TEXTURE9=33993]="TEXTURE9",n[n.TEXTURE10=33994]="TEXTURE10",n[n.TEXTURE11=33995]="TEXTURE11",n[n.TEXTURE12=33996]="TEXTURE12",n[n.TEXTURE13=33997]="TEXTURE13",n[n.TEXTURE14=33998]="TEXTURE14",n[n.TEXTURE15=33999]="TEXTURE15",n[n.TEXTURE16=34e3]="TEXTURE16",n[n.TEXTURE17=34001]="TEXTURE17",n[n.TEXTURE18=34002]="TEXTURE18",n[n.TEXTURE19=34003]="TEXTURE19",n[n.TEXTURE20=34004]="TEXTURE20",n[n.TEXTURE21=34005]="TEXTURE21",n[n.TEXTURE22=34006]="TEXTURE22",n[n.TEXTURE23=34007]="TEXTURE23",n[n.TEXTURE24=34008]="TEXTURE24",n[n.TEXTURE25=34009]="TEXTURE25",n[n.TEXTURE26=34010]="TEXTURE26",n[n.TEXTURE27=34011]="TEXTURE27",n[n.TEXTURE28=34012]="TEXTURE28",n[n.TEXTURE29=34013]="TEXTURE29",n[n.TEXTURE30=34014]="TEXTURE30",n[n.TEXTURE31=34015]="TEXTURE31",n[n.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",n[n.REPEAT=10497]="REPEAT",n[n.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n[n.FLOAT_VEC2=35664]="FLOAT_VEC2",n[n.FLOAT_VEC3=35665]="FLOAT_VEC3",n[n.FLOAT_VEC4=35666]="FLOAT_VEC4",n[n.INT_VEC2=35667]="INT_VEC2",n[n.INT_VEC3=35668]="INT_VEC3",n[n.INT_VEC4=35669]="INT_VEC4",n[n.BOOL=35670]="BOOL",n[n.BOOL_VEC2=35671]="BOOL_VEC2",n[n.BOOL_VEC3=35672]="BOOL_VEC3",n[n.BOOL_VEC4=35673]="BOOL_VEC4",n[n.FLOAT_MAT2=35674]="FLOAT_MAT2",n[n.FLOAT_MAT3=35675]="FLOAT_MAT3",n[n.FLOAT_MAT4=35676]="FLOAT_MAT4",n[n.SAMPLER_2D=35678]="SAMPLER_2D",n[n.SAMPLER_CUBE=35680]="SAMPLER_CUBE",n[n.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",n[n.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",n[n.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",n[n.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",n[n.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",n[n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",n[n.COMPILE_STATUS=35713]="COMPILE_STATUS",n[n.LOW_FLOAT=36336]="LOW_FLOAT",n[n.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",n[n.HIGH_FLOAT=36338]="HIGH_FLOAT",n[n.LOW_INT=36339]="LOW_INT",n[n.MEDIUM_INT=36340]="MEDIUM_INT",n[n.HIGH_INT=36341]="HIGH_INT",n[n.FRAMEBUFFER=36160]="FRAMEBUFFER",n[n.RENDERBUFFER=36161]="RENDERBUFFER",n[n.RGBA4=32854]="RGBA4",n[n.RGB5_A1=32855]="RGB5_A1",n[n.RGB565=36194]="RGB565",n[n.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",n[n.STENCIL_INDEX=6401]="STENCIL_INDEX",n[n.STENCIL_INDEX8=36168]="STENCIL_INDEX8",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n[n.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",n[n.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",n[n.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",n[n.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",n[n.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",n[n.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",n[n.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",n[n.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",n[n.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",n[n.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",n[n.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",n[n.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",n[n.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",n[n.NONE=0]="NONE",n[n.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",n[n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",n[n.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",n[n.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",n[n.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",n[n.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",n[n.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",n[n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",n[n.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",n[n.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",n[n.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(Kt||(Kt={}));var dp,Cv,vp,Av,gp,K0,Q0,ed,Wm,Hg,_c,hf,Va,Ju=(dp=(0,Mt.b2)(),Cv=(0,Mt.f3)(Dt.IMapService),vp=(0,Mt.f3)(Dt.IRendererService),Av=(0,Mt.f3)(Dt.IGlobalConfigService),gp=(0,Mt.f3)(Dt.IInteractionService),K0=(0,Mt.f3)(Dt.ILayerService),dp(Q0=(ed=function(){function n(){var l=this;(0,lt.Z)(this,n),(0,W.Z)(this,"pickedColors",void 0),(0,W.Z)(this,"pickedTileLayers",[]),Ar(this,"mapService",Wm,this),Ar(this,"rendererService",Hg,this),Ar(this,"configService",_c,this),Ar(this,"interactionService",hf,this),Ar(this,"layerService",Va,this),(0,W.Z)(this,"pickingFBO",void 0),(0,W.Z)(this,"width",0),(0,W.Z)(this,"height",0),(0,W.Z)(this,"alreadyInPicking",!1),(0,W.Z)(this,"pickBufferScale",1),(0,W.Z)(this,"pickFromPickingFBO",function(a,s){var o=s.x,h=s.y,v=s.lngLat,m=s.type,E=s.target,A=!1,F=l.rendererService,B=F.readPixels,V=F.getContainer,j=l.getContainerSize(V()),nt=j.width,at=j.height;nt*=Ca,at*=Ca;var mt=a.getLayerConfig(),Bt=mt.enableHighlight,de=mt.enableSelect,ce=o*Ca,Be=h*Ca;if(ce>nt-1*Ca||ce<0||Be>at-1*Ca||Be<0)return!1;var Xe=B({x:Math.floor(ce/l.pickBufferScale),y:Math.floor((at-(h+1)*Ca)/l.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:l.pickingFBO});if(l.pickedColors=Xe,Xe[0]!==0||Xe[1]!==0||Xe[2]!==0){var _r=cr(Xe),Ir=a.layerPickService.getFeatureById(_r);_r!==a.getCurrentPickId()&&m==="mousemove"&&(m="mouseenter");var Nr={x:o,y:h,type:m,lngLat:v,featureId:_r,feature:Ir,target:E};Ir&&(A=!0,a.setCurrentPickId(_r),l.triggerHoverOnLayer(a,Nr))}else{var Yr={x:o,y:h,lngLat:v,type:a.getCurrentPickId()!==null&&m==="mousemove"?"mouseout":"un"+m,featureId:null,target:E,feature:null};l.triggerHoverOnLayer(a,(0,K.Z)((0,K.Z)({},Yr),{},{type:"unpick"})),l.triggerHoverOnLayer(a,Yr),a.setCurrentPickId(null)}if(Bt&&a.layerPickService.highlightPickedFeature(Xe),de&&m==="click"&&(Xe==null?void 0:Xe.toString())!==[0,0,0,0].toString()){var yn=cr(Xe);a.getCurrentSelectedId()===null||yn!==a.getCurrentSelectedId()?(a.layerPickService.selectFeature(Xe),a.setCurrentSelectedId(yn)):(a.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),a.setCurrentSelectedId(null))}return A})}return(0,tt.Z)(n,[{key:"init",value:function(a){var s=this.rendererService,o=s.createTexture2D,h=s.createFramebuffer,v=s.getContainer,m=this.getContainerSize(v()),E=m.width,A=m.height;E*=Ca,A*=Ca,this.pickBufferScale=this.configService.getSceneConfig(a).pickBufferScale||1,this.pickingFBO=h({color:o({width:Math.round(E/this.pickBufferScale),height:Math.round(A/this.pickBufferScale),wrapS:Kt.CLAMP_TO_EDGE,wrapT:Kt.CLAMP_TO_EDGE})}),this.interactionService.on(Zu.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var l=(0,ut.Z)(it().mark(function s(o,h,v){var m=this,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:E=this.rendererService,A=E.useFramebuffer,F=E.clear,this.resizePickingFBO(),A(this.pickingFBO,function(){F({framebuffer:m.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),o.hooks.beforePickingEncode.call(),o.renderModels(),o.hooks.afterPickingEncode.call();var j=m.pickBox(o,h);v(j)});case 3:case"end":return V.stop()}},s,this)}));function a(s,o,h){return l.apply(this,arguments)}return a}()},{key:"pickBox",value:function(a,s){var o=this,h=s.map(function(yn){var fn=yn<0?0:yn;return Math.floor(fn*Ca/o.pickBufferScale)}),v=(0,ht.Z)(h,4),m=v[0],E=v[1],A=v[2],F=v[3],B=this.rendererService,V=B.readPixels,j=B.getContainer,nt=this.getContainerSize(j()),at=nt.width,mt=nt.height;if(at*=Ca,mt*=Ca,m>(at-1)*Ca/this.pickBufferScale||A<0||E>(mt-1)*Ca/this.pickBufferScale||F<0)return[];for(var Bt=Math.min(at/this.pickBufferScale,A)-m,de=Math.min(mt/this.pickBufferScale,F)-E,ce=V({x:m,y:Math.floor(mt/this.pickBufferScale-(F+1)),width:Bt,height:de,data:new Uint8Array(Bt*de*4),framebuffer:this.pickingFBO}),Be=[],Xe={},_r=0;_r<ce.length/4;_r=_r+1){var Ir=ce.slice(_r*4,_r*4+4),Nr=cr(Ir);if(Nr!==-1&&!Xe[Nr]){var Yr=a.layerPickService.getFeatureById(Nr);Be.push((0,K.Z)((0,K.Z)({},Yr),{},{pickedFeatureIdx:Nr})),Xe[Nr]=!0}}return Be}},{key:"handleCursor",value:function(a,s){var o=a.getLayerConfig(),h=o.cursor,v=h===void 0?"":h,m=o.cursorEnabled;if(m){var E=this.mapService.version,A=E==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),F=A==null?void 0:A.style.getPropertyValue("cursor");s==="unmousemove"&&F!==""?A==null||A.style.setProperty("cursor",""):s==="mousemove"&&(A==null||A.style.setProperty("cursor",v))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(a){return a.getContext?{width:a.width/Ca,height:a.height/Ca}:a.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var l=(0,ut.Z)(it().mark(function s(o){return it().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(!this.layerService.needPick(o.type)||!this.isPickingAllLayer())){v.next=2;break}return v.abrupt("return");case 2:return this.alreadyInPicking=!0,v.next=5,this.pickingLayers(o);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return v.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var a=this.rendererService.getContainer,s=this.getContainerSize(a()),o=s.width,h=s.height;o*=Ca,h*=Ca,(this.width!==o||this.height!==h)&&(this.pickingFBO.resize({width:Math.round(o/this.pickBufferScale),height:Math.round(h/this.pickBufferScale)}),this.width=o,this.height=h)}},{key:"pickingLayers",value:function(){var l=(0,ut.Z)(it().mark(function s(o){var h=this,v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:v=this.rendererService,m=v.useFramebuffer,E=v.clear,this.resizePickingFBO(),m(this.pickingFBO,function(){var B=h.layerService.getRenderList();B.filter(function(V){return V.needPick(o.type)}).reverse().some(function(V){E({framebuffer:h.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),V.layerPickService.pickRender(o);var j=h.pickFromPickingFBO(V,o);return h.layerService.pickedLayerId=j?+V.id:-1,j&&!V.getLayerConfig().enablePropagation})});case 3:case"end":return F.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"triggerHoverOnLayer",value:function(a,s){Us(s)&&(this.handleCursor(a,s.type),a.emit(s.type,s))}}]),n}(),Wm=Dr(ed.prototype,"mapService",[Cv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hg=Dr(ed.prototype,"rendererService",[vp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_c=Dr(ed.prototype,"configService",[Av],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hf=Dr(ed.prototype,"interactionService",[gp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Va=Dr(ed.prototype,"layerService",[K0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ed))||Q0),Y_=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,lt.Z)(this,n),(0,W.Z)(this,"autoStart",void 0),(0,W.Z)(this,"startTime",0),(0,W.Z)(this,"oldTime",0),(0,W.Z)(this,"running",!1),(0,W.Z)(this,"elapsedTime",0),this.autoStart=l}return(0,tt.Z)(n,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var s=(typeof performance=="undefined"?Date:performance).now();a=(s-this.oldTime)/1e3,this.oldTime=s,this.elapsedTime+=a}return a}}]),n}(),mp,J0,jg,s0,Fc,ah,Lh;function tg(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=u0(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function u0(n,l){if(!!n){if(typeof n=="string")return eg(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return eg(n,l)}}function eg(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function Xm(n){var l=l0();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function l0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Wg=(mp=(0,Mt.b2)(),J0=(0,Mt.f3)(Dt.IRendererService),jg=(0,Mt.f3)(Dt.IMapService),mp(s0=(Fc=function(n){(0,Ut.Z)(a,n);var l=Xm(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"pickedLayerId",-1),(0,W.Z)((0,st.Z)(s),"clock",new Y_),(0,W.Z)((0,st.Z)(s),"alreadyInRendering",!1),(0,W.Z)((0,st.Z)(s),"layers",[]),(0,W.Z)((0,st.Z)(s),"layerList",[]),(0,W.Z)((0,st.Z)(s),"layerRenderID",void 0),(0,W.Z)((0,st.Z)(s),"sceneInited",!1),(0,W.Z)((0,st.Z)(s),"animateInstanceCount",0),(0,W.Z)((0,st.Z)(s),"shaderPicking",!0),(0,W.Z)((0,st.Z)(s),"enableRender",!0),Ar((0,st.Z)(s),"renderService",ah,(0,st.Z)(s)),Ar((0,st.Z)(s),"mapService",Lh,(0,st.Z)(s)),(0,W.Z)((0,st.Z)(s),"reRender",(0,te.throttle)(function(){s.updateLayerRenderList(),s.renderLayers()},32)),(0,W.Z)((0,st.Z)(s),"throttleRenderLayers",(0,te.throttle)(function(){s.renderLayers()},16)),s}return(0,tt.Z)(a,[{key:"needPick",value:function(o){return this.layerList.some(function(h){return h.needPick(o)})}},{key:"add",value:function(o){var h=this;this.layers.push(o),this.sceneInited&&o.init().then(function(){h.updateLayerRenderList(),h.renderLayers()})}},{key:"addMask",value:function(o){var h=this;this.sceneInited&&o.init().then(function(){h.renderLayers()})}},{key:"initLayers",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v=this;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var A=(0,ut.Z)(it().mark(function F(B){return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(B.startInit){j.next=4;break}return j.next=3,B.init();case 3:v.updateLayerRenderList();case 4:case"end":return j.stop()}},F)}));return function(F){return A.apply(this,arguments)}}());case 2:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(o){return this.layers.find(function(h){return h.id===o})}},{key:"getLayerByName",value:function(o){return this.layers.find(function(h){return h.name===o})}},{key:"remove",value:function(o,h){if(h){var v=h.layerChildren.indexOf(o);v>-1&&h.layerChildren.splice(v,1)}else{var m=this.layers.indexOf(o);m>-1&&this.layers.splice(m,1)}this.updateLayerRenderList(),o.destroy(),this.renderLayers(),this.emit("layerChange",this.layers)}},{key:"removeAllLayers",value:function(){this.destroy(),this.renderLayers()}},{key:"setEnableRender",value:function(o){this.enableRender=o}},{key:"renderLayers",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){F.next=2;break}return F.abrupt("return");case 2:this.alreadyInRendering=!0,this.clear(),v=tg(this.layerList),F.prev=5,v.s();case 7:if((m=v.n()).done){F.next=19;break}if(E=m.value,E.masks.filter(function(B){return B.inited}).length>0&&(this.renderService.clear({stencil:0,depth:1,framebuffer:null}),E.masks.map(function(){var B=(0,ut.Z)(it().mark(function V(j){return it().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:j.render();case 1:case"end":return at.stop()}},V)}));return function(V){return B.apply(this,arguments)}}())),!E.getLayerConfig().enableMultiPassRenderer){F.next=15;break}return F.next=13,E.renderMultiPass();case 13:F.next=17;break;case 15:return F.next=17,E.render();case 17:F.next=7;break;case 19:F.next=24;break;case 21:F.prev=21,F.t0=F.catch(5),v.e(F.t0);case 24:return F.prev=24,v.f(),F.finish(24);case 27:this.alreadyInRendering=!1;case 28:case"end":return F.stop()}},h,this,[[5,21,24,27]])}));function o(){return s.apply(this,arguments)}return o}()},{key:"renderMask",value:function(o){o.filter(function(h){return h.inited}).map(function(h){h.render()})}},{key:"beforeRenderData",value:function(){var s=(0,ut.Z)(it().mark(function h(v){var m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,v.hooks.beforeRenderData.promise();case 2:m=A.sent,m&&this.renderLayers();case 4:case"end":return A.stop()}},h,this)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"renderLayer",value:function(){var s=(0,ut.Z)(it().mark(function h(v){var m=this;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(v.masks.filter(function(F){return F.inited}).length>0&&v.masks.map(function(F){m.renderService.clear({stencil:0,depth:1,framebuffer:null}),F.render()}),!v.getLayerConfig().enableMultiPassRenderer){A.next=6;break}return A.next=4,v.renderMultiPass();case 4:A.next=8;break;case 6:return A.next=8,v.render();case 8:case"end":return A.stop()}},h)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"updateLayerRenderList",value:function(){var o=this;this.layerList=[],this.layers.filter(function(h){return h.inited}).filter(function(h){return h.isVisible()}).sort(function(h,v){return h.zIndex-v.zIndex}).forEach(function(h){o.layerList.push(h)})}},{key:"destroy",value:function(){this.layers.forEach(function(o){o.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var o=ke(this.mapService.bgColor);this.renderService.clear({color:o,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=Co.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){Co.cancelAnimationFrame(this.layerRenderID)}}]),a}(Ee.EventEmitter),ah=Dr(Fc.prototype,"renderService",[J0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lh=Dr(Fc.prototype,"mapService",[jg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fc))||s0),Wl=ot(91),Ym=function(){function n(l){var a=this;(0,lt.Z)(this,n),(0,W.Z)(this,"name",void 0),(0,W.Z)(this,"type",void 0),(0,W.Z)(this,"scale",void 0),(0,W.Z)(this,"descriptor",void 0),(0,W.Z)(this,"featureBufferLayout",[]),(0,W.Z)(this,"needRescale",!1),(0,W.Z)(this,"needRemapping",!1),(0,W.Z)(this,"needRegenerateVertices",!1),(0,W.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,W.Z)(this,"vertexAttribute",void 0),(0,W.Z)(this,"defaultCallback",function(s){if(s.length===0){var o;return((o=a.scale)===null||o===void 0?void 0:o.defaultValues)||[]}return s.map(function(h,v){var m,E=(m=a.scale)===null||m===void 0?void 0:m.scalers[v].func,A=E(h);return A})}),this.setProps(l)}return(0,tt.Z)(n,[{key:"setProps",value:function(a){Object.assign(this,a)}},{key:"mapping",value:function(a){var s;if((s=this.scale)!==null&&s!==void 0&&s.callback){var o,h=(o=this.scale)===null||o===void 0?void 0:o.callback.apply(o,(0,ge.Z)(a));if(!(0,te.isNil)(h))return[h]}return this.defaultCallback(a)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),n}(),$m=["modelType"],qm=["buffer","update","name"],Rc=["buffer","update","name"],rg=["buffer","update","name"],yp,pf,Xg,Tv,Pf,Ph,rd=(yp={},(0,W.Z)(yp,Kt.FLOAT,4),(0,W.Z)(yp,Kt.UNSIGNED_BYTE,1),(0,W.Z)(yp,Kt.UNSIGNED_SHORT,2),yp),_p=(pf=(0,Mt.b2)(),Xg=(0,Mt.f3)(Dt.IRendererService),pf(Tv=(Pf=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"attributesAndIndices",void 0),Ar(this,"rendererService",Ph,this),(0,W.Z)(this,"attributes",[]),(0,W.Z)(this,"triangulation",void 0),(0,W.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,tt.Z)(n,[{key:"registerStyleAttribute",value:function(a){var s=this.getLayerStyleAttribute(a.name||"");return s?s.setProps(a):(s=new Ym(a),this.attributes.push(s)),s}},{key:"updateStyleAttribute",value:function(a,s,o){var h=this.getLayerStyleAttribute(a);h||(h=this.registerStyleAttribute((0,K.Z)((0,K.Z)({},s),{},{name:a})));var v=s.scale;v&&h&&(h.scale=v,h.needRescale=!0,h.needRemapping=!0,h.needRegenerateVertices=!0,o&&o.featureRange&&(h.featureRange=o.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(a){return this.attributes.find(function(s){return s.name===a})}},{key:"getLayerAttributeScale",value:function(a){var s,o=this.getLayerStyleAttribute(a),h=o==null||(s=o.scale)===null||s===void 0?void 0:s.scalers;return h&&h[0]?h[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(a,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,h=arguments.length>3?arguments[3]:void 0,v=arguments.length>4?arguments[4]:void 0,m=this.attributes.find(function(Xe){return Xe.name===a});if(m&&m.descriptor){var E=m.descriptor,A=E.update,F=E.buffer,B=E.size,V=B===void 0?0:B,j=rd[F.type||Kt.FLOAT];if(A){var nt=this.featureLayout,at=nt.elements,mt=nt.sizePerElement,Bt=at.slice(o,h);if(!Bt.length)return;var de=Bt[0].offset,ce=de*V*j,Be=Bt.map(function(Xe,_r){for(var Ir=Xe.featureIdx,Nr=Xe.vertices,Yr=Xe.normals,yn=Nr.length/mt,fn=[],$n=0;$n<yn;$n++){var di=Yr?Yr.slice($n*3,$n*3+3):[];fn.push.apply(fn,(0,ge.Z)(A(s[Ir],Ir,Nr.slice($n*mt,$n*mt+mt),_r,di)))}return fn}).reduce(function(Xe,_r){return Xe.push.apply(Xe,(0,ge.Z)(_r)),Xe},[]);m.vertexAttribute.updateBuffer({data:Be,offset:ce}),v==null||v.emit("legend:".concat(a),{type:a,attr:m})}}}},{key:"createAttributesAndIndicesAscy",value:function(a,s,o){var h=this;this.featureLayout={sizePerElement:0,elements:[]};var v=this.attributes.map(function(nt){return nt.resetDescriptor(),nt.descriptor}).filter(function(nt){return nt}),m=o.modelType,E=(0,Wl.Z)(o,$m),A=this.rendererService,F=A.createAttribute,B=A.createBuffer,V=A.createElements,j={};return new Promise(function(nt,at){Pd(m,(0,K.Z)({descriptors:h.getDescriptorsWithOutFunc(v),features:a,segmentNumber:s},E)).then(function(mt){mt.descriptors.forEach(function(de,ce){if(de){var Be=de.buffer,Xe=de.update,_r=de.name,Ir=(0,Wl.Z)(de,qm),Nr=F((0,K.Z)({buffer:B(Be)},Ir));j[de.name||""]=Nr,h.attributes[ce].vertexAttribute=Nr}}),h.featureLayout=mt.featureLayout;var Bt=V({data:mt.indices,type:Kt.UNSIGNED_INT,count:mt.indices.length});h.attributesAndIndices={attributes:j,elements:Bt,count:null},nt(h.attributesAndIndices)}).catch(function(mt){console.warn(mt),at(mt)})})}},{key:"createAttributesAndIndices",value:function(a,s,o){var h=this;this.featureLayout={sizePerElement:0,elements:[]},s&&(this.triangulation=s);var v=this.attributes.map(function(ce){return ce.resetDescriptor(),ce.descriptor}),m=0,E=0,A=[],F=[],B=[],V=3;a.forEach(function(ce,Be){var Xe=h.triangulation(ce,o),_r=Xe.indices,Ir=Xe.vertices,Nr=Xe.normals,Yr=Xe.size,yn=Xe.indexes,fn=Xe.count;typeof fn=="number"&&(E+=fn),_r.forEach(function(ho){F.push(ho+m)}),V=Yr;var $n=Ir.length/Yr;h.featureLayout.sizePerElement=V,h.featureLayout.elements.push({featureIdx:Be,vertices:Ir,normals:Nr,offset:m}),m+=$n;for(var di=function(zo){var Vs=(Nr==null?void 0:Nr.slice(zo*3,zo*3+3))||[],hu=Ir.slice(zo*Yr,zo*Yr+Yr),Gu=0;yn&&yn[zo]!==void 0&&(Gu=yn[zo]),v.forEach(function(Wh,s2){if(Wh&&Wh.update){var X_;(X_=Wh.buffer.data).push.apply(X_,(0,ge.Z)(Wh.update(ce,Be,hu,zo,Vs,Gu)))}})},Yi=0;Yi<$n;Yi++)di(Yi)});var j=this.rendererService,nt=j.createAttribute,at=j.createBuffer,mt=j.createElements,Bt={};v.forEach(function(ce,Be){if(ce){var Xe=ce.buffer,_r=ce.update,Ir=ce.name,Nr=(0,Wl.Z)(ce,Rc),Yr=nt((0,K.Z)({buffer:at(Xe)},Nr));Bt[ce.name||""]=Yr,h.attributes[Be].vertexAttribute=Yr}});var de=mt({data:F,type:Kt.UNSIGNED_INT,count:F.length});return this.attributesAndIndices={attributes:Bt,elements:de,count:E},this.attributesAndIndices}},{key:"createAttributes",value:function(a,s){var o=this;this.featureLayout={sizePerElement:0,elements:[]},s&&(this.triangulation=s);var h=this.attributes.map(function(j){return j.resetDescriptor(),j.descriptor}),v=0,m=[],E=3;a.forEach(function(j,nt){var at=o.triangulation(j),mt=at.indices,Bt=at.vertices,de=at.normals,ce=at.size,Be=at.indexes;mt.forEach(function(Nr){m.push(Nr+v)}),E=ce;var Xe=Bt.length/ce;o.featureLayout.sizePerElement=E,o.featureLayout.elements.push({featureIdx:nt,vertices:Bt,normals:de,offset:v}),v+=Xe;for(var _r=function(Yr){var yn=(de==null?void 0:de.slice(Yr*3,Yr*3+3))||[],fn=Bt.slice(Yr*ce,Yr*ce+ce),$n=0;Be&&Be[Yr]!==void 0&&($n=Be[Yr]),h.forEach(function(di,Yi){if(di&&di.update){var ho;(ho=di.buffer.data).push.apply(ho,(0,ge.Z)(di.update(j,nt,fn,Yr,yn,$n)))}})},Ir=0;Ir<Xe;Ir++)_r(Ir)});var A=this.rendererService,F=A.createAttribute,B=A.createBuffer,V={};return h.forEach(function(j,nt){if(j){var at=j.buffer,mt=j.update,Bt=j.name,de=(0,Wl.Z)(j,rg),ce=F((0,K.Z)({buffer:B(at)},de));V[j.name||""]=ce,o.attributes[nt].vertexAttribute=ce}}),{attributes:V}}},{key:"clearAllAttributes",value:function(){var a;this.attributes.forEach(function(s){s.vertexAttribute&&s.vertexAttribute.destroy()}),(a=this.attributesAndIndices)===null||a===void 0||a.elements.destroy(),this.attributes=[]}},{key:"getDescriptorsWithOutFunc",value:function(a){return a.map(function(s){return{buffer:s.buffer,name:s.name,size:s.size}})}}]),n}(),Ph=Dr(Pf.prototype,"rendererService",[Xg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pf))||Tv),xp=ot(34155);function c0(n,l,a,s){function o(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(F){try{A(s.next(F))}catch(B){v(B)}}function E(F){try{A(s.throw(F))}catch(B){v(B)}}function A(F){F.done?h(F.value):o(F.value).then(m,E)}A((s=s.apply(n,l||[])).next())})}function Oh(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,o,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(F){return E([A,F])}}function E(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(h=A[0]&2?o.return:A[0]?o.throw||((h=o.return)&&h.call(o),0):o.next)&&!(h=h.call(o,A[1])).done)return h;switch(o=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,o=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(F){A=[6,F],o=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function Vd(n,l){var a=typeof Symbol=="function"&&n[Symbol.iterator];if(!a)return n;var s=a.call(n),o,h=[],v;try{for(;(l===void 0||l-- >0)&&!(o=s.next()).done;)h.push(o.value)}catch(m){v={error:m}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(v)throw v.error}}return h}function Gd(n,l,a){if(a||arguments.length===2)for(var s=0,o=l.length,h;s<o;s++)(h||!(s in l))&&(h||(h=Array.prototype.slice.call(l,0,s)),h[s]=l[s]);return n.concat(h||Array.prototype.slice.call(l))}function Mv(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Fh={exports:{}},Dc={exports:{}},Iv={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s){return s&&typeof s.length=="number"&&s.length>=0&&s.length%1===0}n.exports=l.default})(Iv,Iv.exports);var Ol={},kv={exports:{}},Lv={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(a){return function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=s.pop();return a.call(this,s,h)}},n.exports=l.default})(Lv,Lv.exports);var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0}),Rh.fallback=Kg,Rh.wrap=Pv;var Yg=Rh.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,$g=Rh.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,qg=Rh.hasNextTick=typeof xp=="object"&&typeof xp.nextTick=="function";function Kg(n){setTimeout(n,0)}function Pv(n){return function(l){for(var a=[],s=arguments.length-1;s-- >0;)a[s]=arguments[s+1];return n(function(){return l.apply(void 0,a)})}}var Ov;Yg?Ov=queueMicrotask:$g?Ov=setImmediate:qg?Ov=xp.nextTick:Ov=Kg,Rh.default=Pv(Ov),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=E;var a=Lv.exports,s=m(a),o=Rh,h=m(o),v=Ol;function m(B){return B&&B.__esModule?B:{default:B}}function E(B){return(0,v.isAsync)(B)?function(){for(var V=[],j=arguments.length;j--;)V[j]=arguments[j];var nt=V.pop(),at=B.apply(this,V);return A(at,nt)}:(0,s.default)(function(V,j){var nt;try{nt=B.apply(this,V)}catch(at){return j(at)}if(nt&&typeof nt.then=="function")return A(nt,j);j(null,nt)})}function A(B,V){return B.then(function(j){F(V,null,j)},function(j){F(V,j&&j.message?j:new Error(j))})}function F(B,V,j){try{B(V,j)}catch(nt){(0,h.default)(function(at){throw at},nt)}}n.exports=l.default}(kv,kv.exports),Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.isAsyncIterable=Ol.isAsyncGenerator=Ol.isAsync=void 0;var Fv=kv.exports,$_=Of(Fv);function Of(n){return n&&n.__esModule?n:{default:n}}function Km(n){return n[Symbol.toStringTag]==="AsyncFunction"}function q_(n){return n[Symbol.toStringTag]==="AsyncGenerator"}function ng(n){return typeof n[Symbol.asyncIterator]=="function"}function K_(n){if(typeof n!="function")throw new Error("expected a function");return Km(n)?(0,$_.default)(n):n}Ol.default=K_,Ol.isAsync=Km,Ol.isAsyncGenerator=q_,Ol.isAsyncIterable=ng;var Hd={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s,o){if(o===void 0&&(o=s.length),!o)throw new Error("arity is undefined");function h(){for(var v=this,m=[],E=arguments.length;E--;)m[E]=arguments[E];return typeof m[o-1]=="function"?s.apply(this,m):new Promise(function(A,F){m[o-1]=function(B){for(var V=[],j=arguments.length-1;j-- >0;)V[j]=arguments[j+1];if(B)return F(B);A(V.length>1?V:V[0])},s.apply(v,m)})}return h}n.exports=l.default})(Hd,Hd.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Iv.exports,s=E(a),o=Ol,h=E(o),v=Hd.exports,m=E(v);function E(A){return A&&A.__esModule?A:{default:A}}l.default=(0,m.default)(function(A,F,B){var V=(0,s.default)(F)?[]:{};A(F,function(j,nt,at){(0,h.default)(j)(function(mt){for(var Bt,de=[],ce=arguments.length-1;ce-- >0;)de[ce]=arguments[ce+1];de.length<2&&(Bt=de,de=Bt[0]),V[nt]=de,at(mt)})},function(j){return B(j,V)})},3),n.exports=l.default}(Dc,Dc.exports);var ig={exports:{}},ag={exports:{}},Qg={exports:{}},Ls={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s){function o(){for(var h=[],v=arguments.length;v--;)h[v]=arguments[v];if(s!==null){var m=s;s=null,m.apply(this,h)}}return Object.assign(o,s),o}n.exports=l.default})(Ls,Ls.exports);var df={exports:{}},og={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(a){return a[Symbol.iterator]&&a[Symbol.iterator]()},n.exports=l.default})(og,og.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=F;var a=Iv.exports,s=v(a),o=og.exports,h=v(o);function v(B){return B&&B.__esModule?B:{default:B}}function m(B){var V=-1,j=B.length;return function(){return++V<j?{value:B[V],key:V}:null}}function E(B){var V=-1;return function(){var nt=B.next();return nt.done?null:(V++,{value:nt.value,key:V})}}function A(B){var V=B?Object.keys(B):[],j=-1,nt=V.length;return function at(){var mt=V[++j];return mt==="__proto__"?at():j<nt?{value:B[mt],key:mt}:null}}function F(B){if((0,s.default)(B))return m(B);var V=(0,h.default)(B);return V?E(V):A(B)}n.exports=l.default}(df,df.exports);var bp={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s){return function(){for(var o=[],h=arguments.length;h--;)o[h]=arguments[h];if(s===null)throw new Error("Callback was already called.");var v=s;s=null,v.apply(this,o)}}n.exports=l.default})(bp,bp.exports);var sg={exports:{}},Jg={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a={};l.default=a,n.exports=l.default})(Jg,Jg.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=h;var a=Jg.exports,s=o(a);function o(v){return v&&v.__esModule?v:{default:v}}function h(v,m,E,A){var F=!1,B=!1,V=!1,j=0,nt=0;function at(){j>=m||V||F||(V=!0,v.next().then(function(de){var ce=de.value,Be=de.done;if(!(B||F)){if(V=!1,Be){F=!0,j<=0&&A(null);return}j++,E(ce,nt,mt),nt++,at()}}).catch(Bt))}function mt(de,ce){if(j-=1,!B){if(de)return Bt(de);if(de===!1){F=!0,B=!0;return}if(ce===s.default||F&&j<=0)return F=!0,A(null);at()}}function Bt(de){B||(V=!1,F=!0,A(de))}at()}n.exports=l.default}(sg,sg.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Ls.exports,s=j(a),o=df.exports,h=j(o),v=bp.exports,m=j(v),E=Ol,A=sg.exports,F=j(A),B=Jg.exports,V=j(B);function j(nt){return nt&&nt.__esModule?nt:{default:nt}}l.default=function(nt){return function(at,mt,Bt){if(Bt=(0,s.default)(Bt),nt<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!at)return Bt(null);if((0,E.isAsyncGenerator)(at))return(0,F.default)(at,nt,mt,Bt);if((0,E.isAsyncIterable)(at))return(0,F.default)(at[Symbol.asyncIterator](),nt,mt,Bt);var de=(0,h.default)(at),ce=!1,Be=!1,Xe=0,_r=!1;function Ir(Yr,yn){if(!Be)if(Xe-=1,Yr)ce=!0,Bt(Yr);else if(Yr===!1)ce=!0,Be=!0;else{if(yn===V.default||ce&&Xe<=0)return ce=!0,Bt(null);_r||Nr()}}function Nr(){for(_r=!0;Xe<nt&&!ce;){var Yr=de();if(Yr===null){ce=!0,Xe<=0&&Bt(null);return}Xe+=1,mt(Yr.value,Yr.key,(0,m.default)(Ir))}_r=!1}Nr()}},n.exports=l.default}(Qg,Qg.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Qg.exports,s=E(a),o=Ol,h=E(o),v=Hd.exports,m=E(v);function E(F){return F&&F.__esModule?F:{default:F}}function A(F,B,V,j){return(0,s.default)(B)(F,(0,h.default)(V),j)}l.default=(0,m.default)(A,4),n.exports=l.default}(ag,ag.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=ag.exports,s=v(a),o=Hd.exports,h=v(o);function v(E){return E&&E.__esModule?E:{default:E}}function m(E,A,F){return(0,s.default)(E,1,A,F)}l.default=(0,h.default)(m,3),n.exports=l.default}(ig,ig.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=m;var a=Dc.exports,s=v(a),o=ig.exports,h=v(o);function v(E){return E&&E.__esModule?E:{default:E}}function m(E,A){return(0,s.default)(h.default,E,A)}n.exports=l.default}(Fh,Fh.exports);var Qm=Mv(Fh.exports),Ep=function(){function n(){this.args=[],this.tasks=[]}return n.prototype.call=function(){for(var l=arguments,a=[],s=0;s<arguments.length;s++)a[s]=l[s];return this.args=a,Qm(this.tasks)},n.prototype.tap=function(l,a){var s=this;this.tasks.push(function(o){a.apply(void 0,Gd([],Vd(s.args),!1)),o(null,l)})},n}(),Q_={exports:{}},tm={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Iv.exports,s=mt(a),o=Jg.exports,h=mt(o),v=ag.exports,m=mt(v),E=Ls.exports,A=mt(E),F=bp.exports,B=mt(F),V=Ol,j=mt(V),nt=Hd.exports,at=mt(nt);function mt(Be){return Be&&Be.__esModule?Be:{default:Be}}function Bt(Be,Xe,_r){_r=(0,A.default)(_r);var Ir=0,Nr=0,Yr=Be.length,yn=!1;Yr===0&&_r(null);function fn($n,di){$n===!1&&(yn=!0),yn!==!0&&($n?_r($n):(++Nr===Yr||di===h.default)&&_r(null))}for(;Ir<Yr;Ir++)Xe(Be[Ir],Ir,(0,B.default)(fn))}function de(Be,Xe,_r){return(0,m.default)(Be,1/0,Xe,_r)}function ce(Be,Xe,_r){var Ir=(0,s.default)(Be)?Bt:de;return Ir(Be,(0,j.default)(Xe),_r)}l.default=(0,at.default)(ce,3),n.exports=l.default})(tm,tm.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=m;var a=tm.exports,s=v(a),o=Dc.exports,h=v(o);function v(E){return E&&E.__esModule?E:{default:E}}function m(E,A){return(0,h.default)(s.default,E,A)}n.exports=l.default}(Q_,Q_.exports);var hT=Mv(Q_.exports),pT=function(){function n(){this.tasks=[]}return n.prototype.promise=function(){return hT(this.tasks)},n.prototype.tapPromise=function(l,a){var s=this;this.tasks.push(function(o){return c0(s,void 0,void 0,function(){return Oh(this,function(h){switch(h.label){case 0:return[4,a()];case 1:return h.sent(),o(null,l),[2]}})})})},n}(),f0={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Ls.exports,s=F(a),o=bp.exports,h=F(o),v=Ol,m=F(v),E=Hd.exports,A=F(E);function F(V){return V&&V.__esModule?V:{default:V}}function B(V,j){if(j=(0,s.default)(j),!Array.isArray(V))return j(new Error("First argument to waterfall must be an array of functions"));if(!V.length)return j();var nt=0;function at(Bt){var de=(0,m.default)(V[nt++]);de.apply(void 0,Bt.concat([(0,h.default)(mt)]))}function mt(Bt){for(var de=[],ce=arguments.length-1;ce-- >0;)de[ce]=arguments[ce+1];if(Bt!==!1){if(Bt||nt===V.length)return j.apply(void 0,[Bt].concat(de));at(de)}}at([])}l.default=(0,A.default)(B),n.exports=l.default})(f0,f0.exports);var l2=Mv(f0.exports),lO=function(){function n(){this.tasks=[]}return n.prototype.call=function(){return l2(this.tasks)},n.prototype.tap=function(l,a){this.tasks.length===0?this.tasks.push(function(s){var o=a();s(o?null:!1,o)}):this.tasks.push(function(s,o){var h=a.apply(void 0,Gd([],Vd(s),!1));o(h?null:!1,l)})},n}(),c2=function(){function n(){this.tasks=[]}return n.prototype.call=function(){return Qm(this.tasks)},n.prototype.tap=function(l,a){this.tasks.push(function(s){var o=a();s(o,l)})},n}(),dT=function(){function n(){this.args=[],this.tasks=[]}return n.prototype.promise=function(){for(var l=arguments,a=[],s=0;s<arguments.length;s++)a[s]=l[s];return this.args=a,Qm(this.tasks)},n.prototype.tapPromise=function(l,a){var s=this;this.tasks.push(function(o){return c0(s,void 0,void 0,function(){return Oh(this,function(h){switch(h.label){case 0:return[4,a.apply(void 0,Gd([],Vd(this.args),!1))];case 1:return h.sent(),o(null,l),[2]}})})})},n}(),Jm=function(){function n(){this.args=[],this.tasks=[]}return n.prototype.promise=function(){for(var l=arguments,a=[],s=0;s<arguments.length;s++)a[s]=l[s];return this.args=a,Qm(this.tasks)},n.prototype.tapPromise=function(l,a){var s=this;this.tasks.push(function(o){return c0(s,void 0,void 0,function(){var h;return Oh(this,function(v){switch(v.label){case 0:return[4,a.apply(void 0,Gd([],Vd(this.args),!1))];case 1:return h=v.sent(),o(h,l),[2]}})})})},n}(),f2=function(){function n(){this.tasks=[]}return n.prototype.promise=function(){return l2(this.tasks)},n.prototype.tapPromise=function(l,a){this.tasks.length===0?this.tasks.push(function(s){a().then(function(o){s(null,o)})}):this.tasks.push(function(s,o){a(s).then(function(h){o(null,h)})})},n}(),h2=ot(67709),J_=ot.n(h2),t1,p2,d2,v2,g2,m2,y2,_2,x2,b2,E2,S2,e1,r1,n1,w2,C2,xc,ty,Yo,vT,oh,i1,a1,A2,T2,ug,lg,o1,s1,M2,ey,I2;function Dh(n){var l=gT();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function gT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var mT=(t1=(0,Mt.b2)(),p2=(0,Mt.f3)(Dt.SceneID),d2=(0,Mt.f3)(Dt.IIconService),v2=(0,Mt.f3)(Dt.IFontService),g2=(0,Mt.f3)(Dt.IControlService),m2=(0,Mt.f3)(Dt.IGlobalConfigService),y2=(0,Mt.f3)(Dt.IMapService),_2=(0,Mt.f3)(Dt.ICoordinateSystemService),x2=(0,Mt.f3)(Dt.IRendererService),b2=(0,Mt.f3)(Dt.ILayerService),E2=(0,Mt.f3)(Dt.ICameraService),S2=(0,Mt.f3)(Dt.IInteractionService),e1=(0,Mt.f3)(Dt.IPickingService),r1=(0,Mt.f3)(Dt.IShaderModuleService),n1=(0,Mt.f3)(Dt.IMarkerService),w2=(0,Mt.f3)(Dt.IPopupService),t1(C2=(xc=function(n){(0,Ut.Z)(a,n);var l=Dh(a);function a(){var s;return(0,lt.Z)(this,a),s=l.call(this),(0,W.Z)((0,st.Z)(s),"destroyed",!1),(0,W.Z)((0,st.Z)(s),"loaded",!1),Ar((0,st.Z)(s),"id",ty,(0,st.Z)(s)),Ar((0,st.Z)(s),"iconService",Yo,(0,st.Z)(s)),Ar((0,st.Z)(s),"fontService",vT,(0,st.Z)(s)),Ar((0,st.Z)(s),"controlService",oh,(0,st.Z)(s)),Ar((0,st.Z)(s),"configService",i1,(0,st.Z)(s)),Ar((0,st.Z)(s),"map",a1,(0,st.Z)(s)),Ar((0,st.Z)(s),"coordinateSystemService",A2,(0,st.Z)(s)),Ar((0,st.Z)(s),"rendererService",T2,(0,st.Z)(s)),Ar((0,st.Z)(s),"layerService",ug,(0,st.Z)(s)),Ar((0,st.Z)(s),"cameraService",lg,(0,st.Z)(s)),Ar((0,st.Z)(s),"interactionService",o1,(0,st.Z)(s)),Ar((0,st.Z)(s),"pickingService",s1,(0,st.Z)(s)),Ar((0,st.Z)(s),"shaderModuleService",M2,(0,st.Z)(s)),Ar((0,st.Z)(s),"markerService",ey,(0,st.Z)(s)),Ar((0,st.Z)(s),"popupService",I2,(0,st.Z)(s)),(0,W.Z)((0,st.Z)(s),"inited",!1),(0,W.Z)((0,st.Z)(s),"initPromise",void 0),(0,W.Z)((0,st.Z)(s),"rendering",!1),(0,W.Z)((0,st.Z)(s),"$container",void 0),(0,W.Z)((0,st.Z)(s),"canvas",void 0),(0,W.Z)((0,st.Z)(s),"markerContainer",void 0),(0,W.Z)((0,st.Z)(s),"hooks",void 0),(0,W.Z)((0,st.Z)(s),"handleWindowResized",function(){s.emit("resize"),s.$container&&(s.initContainer(),Pa(),s.coordinateSystemService.needRefresh=!0,s.render())}),(0,W.Z)((0,st.Z)(s),"handleMapCameraChanged",function(o){s.cameraService.update(o),s.render()}),s.hooks={init:new dT},s}return(0,tt.Z)(a,[{key:"init",value:function(o){var h=this;this.configService.setSceneConfig(this.id,o),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return h.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,ut.Z)(it().mark(function v(){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,new Promise(function(A){h.map.onCameraChanged(function(F){h.cameraService.init(),h.cameraService.update(F),A()}),h.map.init()});case 2:h.map.onCameraChanged(h.handleMapCameraChanged),h.map.addMarkerContainer(),h.markerService.addMarkers(),h.markerService.addMarkerLayers(),h.popupService.initPopup(),h.interactionService.init(),h.interactionService.on(Zu.Drag,h.addSceneEvent.bind(h));case 9:case"end":return E.stop()}},v)}))),this.hooks.init.tapPromise("initRenderer",(0,ut.Z)(it().mark(function v(){var m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(m=h.map.getOverlayContainer(),m?h.$container=m:h.$container=o0(h.configService.getSceneConfig(h.id).id||""),!h.$container){F.next=12;break}return h.canvas=_t("canvas","",h.$container),h.setCanvas(),F.next=7,h.rendererService.init(h.canvas,h.configService.getSceneConfig(h.id),o.gl);case 7:h.initContainer(),J_()(h.$container,h.handleWindowResized),Co.matchMedia&&((E=Co.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||E===void 0||E.addListener(h.handleWindowResized)),F.next=13;break;case 12:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 13:h.pickingService.init(h.id);case 14:case"end":return F.stop()}},v)}))),this.render()}},{key:"initMiniScene",value:function(o){var h=this;this.configService.setSceneConfig(this.id,o),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return h.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,ut.Z)(it().mark(function v(){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,new Promise(function(A){h.map.onCameraChanged(function(F){h.cameraService.init(),h.cameraService.update(F),h.map.version!=="GAODE2.x"&&A()}),h.map.initMiniMap()});case 2:h.map.onCameraChanged(h.handleMapCameraChanged),h.interactionService.init(),h.interactionService.on(Zu.Drag,h.addSceneEvent.bind(h));case 5:case"end":return E.stop()}},v)}))),this.hooks.init.tapPromise("initRenderer",(0,ut.Z)(it().mark(function v(){var m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(m=o.canvas,h.$container=m||null,!h.$container){A.next=7;break}return A.next=5,h.rendererService.init(o.canvas,h.configService.getSceneConfig(h.id),void 0);case 5:A.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:h.pickingService.init(h.id);case 9:case"end":return A.stop()}},v)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(o){this.layerService.sceneService=this,this.layerService.add(o)}},{key:"addMask",value:function(o){this.layerService.sceneService=this,this.layerService.addMask(o)}},{key:"render",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.rendering||this.destroyed)){m.next=2;break}return m.abrupt("return");case 2:if(this.rendering=!0,this.inited){m.next=16;break}return m.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),m.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,m.next=20;break;case 16:return m.next=18,this.layerService.initLayers();case 18:return m.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"addFontFace",value:function(o,h){this.fontService.addFontFace(o,h)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(o){var h,v=(h=this.$container)===null||h===void 0?void 0:h.getElementsByTagName("canvas")[0];this.render();var m=o==="jpg"?v==null?void 0:v.toDataURL("image/jpeg"):v==null?void 0:v.toDataURL("image/png");return m}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var o=this.$container.parentElement;o!==null&&(this.markerContainer=_t("div","l7-marker-container",o))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var o=this,h,v;if(!this.inited){this.destroyed=!0;return}if((0,h2.unbind)(this.$container,this.handleWindowResized),Co.matchMedia){var m;(m=Co.matchMedia("screen and (min-resolution: 2dppx)"))===null||m===void 0||m.removeListener(this.handleWindowResized)}this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var E;(E=o.$container)===null||E===void 0||E.removeChild(o.canvas),o.canvas=null,o.rendererService.destroy()}),(h=this.$container)===null||h===void 0||(v=h.parentNode)===null||v===void 0||v.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var o,h,v=Ca,m=((o=this.$container)===null||o===void 0?void 0:o.clientWidth)||400,E=((h=this.$container)===null||h===void 0?void 0:h.clientHeight)||300,A=this.canvas;A&&(A.width=m*v,A.height=E*v),this.rendererService.viewport({x:0,y:0,width:v*m,height:v*E})}},{key:"setCanvas",value:function(){var o,h,v=Ca,m=((o=this.$container)===null||o===void 0?void 0:o.clientWidth)||400,E=((h=this.$container)===null||h===void 0?void 0:h.clientHeight)||300,A=this.canvas;A.width=m*v,A.height=E*v,A.style.width="100%",A.style.height="100%"}},{key:"addSceneEvent",value:function(o){this.emit(o.type,o)}}]),a}(Ee.EventEmitter),ty=Dr(xc.prototype,"id",[p2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yo=Dr(xc.prototype,"iconService",[d2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vT=Dr(xc.prototype,"fontService",[v2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oh=Dr(xc.prototype,"controlService",[g2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i1=Dr(xc.prototype,"configService",[m2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a1=Dr(xc.prototype,"map",[y2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A2=Dr(xc.prototype,"coordinateSystemService",[_2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T2=Dr(xc.prototype,"rendererService",[x2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ug=Dr(xc.prototype,"layerService",[b2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lg=Dr(xc.prototype,"cameraService",[E2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o1=Dr(xc.prototype,"interactionService",[S2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s1=Dr(xc.prototype,"pickingService",[e1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M2=Dr(xc.prototype,"shaderModuleService",[r1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ey=Dr(xc.prototype,"markerService",[n1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I2=Dr(xc.prototype,"popupService",[w2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xc))||C2);function yT(n){var l=0;switch(n){case"vec2":case"ivec2":l=2;break;case"vec3":case"ivec3":l=3;break;case"vec4":case"ivec4":case"mat2":l=4;break;case"mat3":l=9;break;case"mat4":l=16;break;default:}return l}var _T=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function k2(n){var l={};return n=n.replace(_T,function(a,s,o){var h=o.split(":"),v=h[0].trim(),m="";switch(h.length>1&&(m=h[1].trim()),s){case"bool":m=m==="true";break;case"float":case"int":m=Number(m);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":m?m=m.replace("[","").replace("]","").split(",").reduce(function(E,A){return E.push(Number(A.trim())),E},[]):m=new Array(yT(s)).fill(0);break;default:}return l[v]=m,"uniform ".concat(s," ").concat(v,`;
`)}),{content:n,uniforms:l}}var L2,P2,O2="#define PI 3.14159265359",xT=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,bT=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,ry=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,F2=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,ET=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,ST=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,wT=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom));
  }
  return pixel * 2.0;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,CT=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,AT=`attribute float a_vertexId;

uniform mat4 u_cellTypeLayout;      // \u63CF\u8FF0\u6570\u636E\u7EB9\u7406 cell \u7ED3\u6784\u7684\u77E9\u9635
uniform sampler2D u_dataTexture;    // \u6570\u636E\u7EB9\u7406

bool hasOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 opacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeOpacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeWidth() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeWidth \u7684\u6570\u636E
  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStroke() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 stroke \u7684\u6570\u636E
  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasOffsets() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 offsets \u7684\u6570\u636E
  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasThetaOffset() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 thetaOffset \u7684\u6570\u636E
  return u_cellTypeLayout[2][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

// \u6839\u636E\u5750\u6807\u4F4D\u7F6E\u5148\u662F\u8BA1\u7B97 uv \uFF0C\u7136\u540E\u6839\u636E uv \u4ECE\u6570\u636E\u7EB9\u7406\u4E2D\u53D6\u503C
float pos2value(vec2 pos, float columnWidth, float rowHeight) {
  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;
  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);
  return texture2D(u_dataTexture, vec2(u, v)).r;
}

/*
  currentRow \u5F53\u524D\u884C
  currentColumn \u5F53\u524D\u5217
  columnCount \u6709\u591A\u5C11\u5217
  nextStep \u9700\u8981\u8BA1\u7B97\u5F53\u524D cell \u540E\u7684\u7B2C\u51E0\u4E2A cell \uFF08\u5F53\u524D cell \u5219 nextStep = 0\uFF09
*/
vec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {
  float nextColumn = currentColumn;
  float nextRow = currentRow;
  if(currentColumn + nextStep <= columnCount){
    nextColumn = currentColumn + nextStep;
  } else {
    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4E0D\u4F1A\u51FA\u73B0\u8DE8\u4E24\u884C
    nextRow = currentRow + 1.0;
  }
  return vec2(nextColumn, nextRow);
}

// \u8BA1\u7B97\u5F53\u524D\u5355\u4E2A cell \u7684\u5927\u5C0F
float calCellCount() { 
  //   u_cellTypeLayout
  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51E0\u884C\u51E0\u5217
  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793A\u6709\u6570\u636E\u6620\u5C04\u30010.0 \u8868\u793A\u6CA1\u6709
  //   1.0, 1.0, 0.0, 0.0, // offsets thetaOffset
  //   0.0, 0.0, 0.0, 0.0
  
  return  u_cellTypeLayout[1][0] +        // opacity
          u_cellTypeLayout[1][1] +        // strokeOpacity
          u_cellTypeLayout[1][2] +        // strokeWidth
          u_cellTypeLayout[1][3] * 4.0 +  // stroke
          u_cellTypeLayout[2][0] * 2.0 +  // offsets
          u_cellTypeLayout[2][1];         // thetaOffset
}`,TT=`
// \u8BA1\u7B97 opacity \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasOpacity()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 opacity \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureOpacity, textureOffset + 1.0);
  }
}
`,MT=`
// \u8BA1\u7B97 strokeOpaicty \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeOpacity()) {
    return vec2(u_stroke_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeOpacity, textureOffset + 1.0);
  }
}
`,IT=`
// \u8BA1\u7B97 strokeWidth \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeWidth()) {
    return vec2(u_stroke_width, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeWidth, textureOffset + 1.0);
  }
}
`,kT=`
// \u8BA1\u7B97 thetaOffset \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calThetaOffsetAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasThetaOffset()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 thetaOffset \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_thetaOffset, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureThetaOffset = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureThetaOffset, textureOffset + 1.0);
  }
}
`,LT=/precision\s+(high|low|medium)p\s+float/,PT=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,cO=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,OT=(L2=(0,Mt.b2)(),L2(P2=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"moduleCache",{}),(0,W.Z)(this,"rawContentCache",{})}return(0,tt.Z)(n,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:O2,fs:O2}),this.registerModule("decode",{vs:xT,fs:""}),this.registerModule("projection",{vs:wT,fs:""}),this.registerModule("project",{vs:ST,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:CT}),this.registerModule("lighting",{vs:ry,fs:""}),this.registerModule("light",{vs:bT,fs:""}),this.registerModule("picking",{vs:ET,fs:F2}),this.registerModule("styleMapping",{vs:AT,fs:""}),this.registerModule("styleMappingCalThetaOffset",{vs:kT,fs:""}),this.registerModule("styleMappingCalOpacity",{vs:TT,fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:MT,fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:IT,fs:""})}},{key:"registerModule",value:function(a,s){if(!this.rawContentCache[a]){var o=s.vs,h=s.fs,v=s.uniforms,m=k2(o),E=m.content,A=m.uniforms,F=k2(h),B=F.content,V=F.uniforms;this.rawContentCache[a]={fs:B,uniforms:(0,K.Z)((0,K.Z)((0,K.Z)({},A),V),v),vs:E}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(a){var s=this;if(this.moduleCache[a])return this.moduleCache[a];var o=this.rawContentCache[a].vs,h=this.rawContentCache[a].fs,v=this.processModule(o,[],"vs"),m=v.content,E=v.includeList,A=this.processModule(h,[],"fs"),F=A.content,B=A.includeList,V=F,j=(0,te.uniq)(E.concat(B).concat(a)).reduce(function(nt,at){return(0,K.Z)((0,K.Z)({},nt),s.rawContentCache[at].uniforms)},{});return LT.test(F)||(V=PT+F),this.moduleCache[a]={fs:V.trim(),uniforms:j,vs:m.trim()},this.moduleCache[a]}},{key:"processModule",value:function(a,s,o){var h=this,v=a.replace(cO,function(m,E){var A=E.split(" "),F=A[0].replace(/"/g,"");if(s.indexOf(F)>-1)return"";var B=h.rawContentCache[F][o];s.push(F);var V=h.processModule(B,s,o),j=V.content;return j});return{content:v,includeList:s}}}]),n}())||P2);function FT(n,l){for(;!Object.prototype.hasOwnProperty.call(n,l)&&(n=(0,b.Z)(n),n!==null););return n}function $o(){return typeof Reflect!="undefined"&&Reflect.get?$o=Reflect.get.bind():$o=function(l,a,s){var o=FT(l,a);if(!!o){var h=Object.getOwnPropertyDescriptor(o,a);return h.get?h.get.call(arguments.length<3?l:s):h.value}},$o.apply(this,arguments)}var jd;(function(n){n.Normal="normal",n.PostProcessing="post-processing"})(jd||(jd={}));var R2,D2,ny=(R2=(0,Mt.b2)(),R2(D2=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"shaderModuleService",void 0),(0,W.Z)(this,"rendererService",void 0),(0,W.Z)(this,"cameraService",void 0),(0,W.Z)(this,"mapService",void 0),(0,W.Z)(this,"interactionService",void 0),(0,W.Z)(this,"layerService",void 0),(0,W.Z)(this,"config",void 0)}return(0,tt.Z)(n,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return jd.Normal}},{key:"init",value:function(a,s){this.config=s,this.rendererService=a.getContainer().get(Dt.IRendererService),this.cameraService=a.getContainer().get(Dt.ICameraService),this.mapService=a.getContainer().get(Dt.IMapService),this.interactionService=a.getContainer().get(Dt.IInteractionService),this.layerService=a.getContainer().get(Dt.ILayerService),this.shaderModuleService=a.getContainer().get(Dt.IShaderModuleService)}},{key:"render",value:function(a){}}]),n}())||D2),B2,N2;function RT(n){var l=DT();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function DT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var BT=(B2=(0,Mt.b2)(),B2(N2=function(n){(0,Ut.Z)(a,n);var l=RT(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(o,h){$o((0,b.Z)(a.prototype),"init",this).call(this,o,h)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),a}(ny))||N2),u1,z2,U2,l1,Z2;function NT(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=zT(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function zT(n,l){if(!!n){if(typeof n=="string")return V2(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return V2(n,l)}}function V2(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var UT=(u1=(0,Mt.b2)(),z2=(0,Mt.f3)(Dt.IPostProcessor),u1(U2=(l1=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"passes",[]),Ar(this,"postProcessor",Z2,this),(0,W.Z)(this,"layer",void 0),(0,W.Z)(this,"renderFlag",void 0),(0,W.Z)(this,"width",0),(0,W.Z)(this,"height",0)}return(0,tt.Z)(n,[{key:"setLayer",value:function(a){this.layer=a}},{key:"setRenderFlag",value:function(a){this.renderFlag=a}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var l=(0,ut.Z)(it().mark(function s(){var o,h,v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:o=NT(this.passes),E.prev=1,o.s();case 3:if((h=o.n()).done){E.next=9;break}return v=h.value,E.next=7,v.render(this.layer);case 7:E.next=3;break;case 9:E.next=14;break;case 11:E.prev=11,E.t0=E.catch(1),o.e(E.t0);case 14:return E.prev=14,o.f(),E.finish(14);case 17:return E.next=19,this.postProcessor.render(this.layer);case 19:case"end":return E.stop()}},s,this,[[1,11,14,17]])}));function a(){return l.apply(this,arguments)}return a}()},{key:"resize",value:function(a,s){(this.width!==a||this.height!==s)&&(this.postProcessor.resize(a,s),this.width=a,this.height=s)}},{key:"add",value:function(a,s){a.getType()===jd.PostProcessing?this.postProcessor.add(a,this.layer,s):(a.init(this.layer,s),this.passes.push(a))}},{key:"insert",value:function(a,s,o){a.init(this.layer,s),this.passes.splice(o,0,a)}},{key:"destroy",value:function(){this.passes.length=0}}]),n}(),Z2=Dr(l1.prototype,"postProcessor",[z2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l1))||U2),G2,c1;function ZT(n){var l=VT();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function VT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var GT=(G2=(0,Mt.b2)(),G2(c1=function(n){(0,Ut.Z)(a,n);var l=ZT(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"pickingFBO",void 0),(0,W.Z)((0,st.Z)(s),"layer",void 0),(0,W.Z)((0,st.Z)(s),"width",0),(0,W.Z)((0,st.Z)(s),"height",0),(0,W.Z)((0,st.Z)(s),"alreadyInRendering",!1),(0,W.Z)((0,st.Z)(s),"pickFromPickingFBO",function(m){var E=m.x,A=m.y,F=m.lngLat,B=m.type;if(!(!s.layer.isVisible()||!s.layer.needPick(B))){var V=s.rendererService,j=V.getViewportSize,nt=V.readPixels,at=V.useFramebuffer,mt=j(),Bt=mt.width,de=mt.height,ce=s.layer.getLayerConfig(),Be=ce.enableHighlight,Xe=ce.enableSelect,_r=E*Ca,Ir=A*Ca;if(!(_r>Bt||_r<0||Ir>de||Ir<0)){var Nr;at(s.pickingFBO,function(){var Yr;if(Nr=nt({x:Math.round(_r),y:Math.round(de-(A+1)*Ca),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:s.pickingFBO}),Nr[0]!==0||Nr[1]!==0||Nr[2]!==0){var yn=cr(Nr),fn=s.layer.getSource().getFeatureById(yn),$n={x:E,y:A,type:B,lngLat:F,featureId:yn,feature:fn};fn&&(s.layer.setCurrentPickId(yn),s.triggerHoverOnLayer($n))}else{var di={x:E,y:A,lngLat:F,type:s.layer.getCurrentPickId()===null?"un"+B:"mouseout",featureId:null,feature:null};s.triggerHoverOnLayer((0,K.Z)((0,K.Z)({},di),{},{type:"unpick"})),s.triggerHoverOnLayer(di),s.layer.setCurrentPickId(null)}Be&&s.highlightPickedFeature(Nr),Xe&&B==="click"&&((Yr=Nr)===null||Yr===void 0?void 0:Yr.toString())!==[0,0,0,0].toString()&&s.selectFeature(Nr)})}}}),s}return(0,tt.Z)(a,[{key:"getType",value:function(){return jd.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(o,h){$o((0,b.Z)(a.prototype),"init",this).call(this,o,h),this.layer=o;var v=this.rendererService,m=v.createTexture2D,E=v.createFramebuffer,A=v.getViewportSize,F=A(),B=F.width,V=F.height;this.pickingFBO=E({color:m({width:B,height:V,wrapS:Kt.CLAMP_TO_EDGE,wrapT:Kt.CLAMP_TO_EDGE})}),this.interactionService.on(Zu.Hover,this.pickFromPickingFBO),this.interactionService.on(Zu.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Zu.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(o){var h=this;if(!this.alreadyInRendering){var v=this.rendererService,m=v.getViewportSize,E=v.useFramebuffer,A=v.clear,F=m(),B=F.width,V=F.height;this.alreadyInRendering=!0,(this.width!==B||this.height!==V)&&(this.pickingFBO.resize({width:B,height:V}),this.width=B,this.height=V),E(this.pickingFBO,function(){A({framebuffer:h.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var j=h.layer.multiPassRenderer.getRenderFlag();h.layer.multiPassRenderer.setRenderFlag(!1),o.hooks.beforePickingEncode.call(),o.render(),o.hooks.afterPickingEncode.call(),h.layer.multiPassRenderer.setRenderFlag(j),h.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(o){this.layer.emit(o.type,o)}},{key:"highlightPickedFeature",value:function(o){var h=(0,ht.Z)(o,3),v=h[0],m=h[1],E=h[2];this.layer.hooks.beforeHighlight.call([v,m,E]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(o){var h=(0,ht.Z)(o,3),v=h[0],m=h[1],E=h[2];this.layer.hooks.beforeSelect.call([v,m,E]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(o){var h=o.featureId,v=ar(h);this.selectFeature(new Uint8Array(v))}},{key:"highlightFeatureHandle",value:function(o){var h=o.featureId,v=ar(h);this.highlightPickedFeature(new Uint8Array(v))}}]),a}(ny))||c1),H2,j2,W2,f1,X2,HT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Wd=(H2=(0,Mt.b2)(),j2=(0,Mt.f3)(Dt.IShaderModuleService),H2(W2=(f1=function(){function n(){(0,lt.Z)(this,n),Ar(this,"shaderModuleService",X2,this),(0,W.Z)(this,"rendererService",void 0),(0,W.Z)(this,"config",void 0),(0,W.Z)(this,"quad",HT),(0,W.Z)(this,"enabled",!0),(0,W.Z)(this,"renderToScreen",!1),(0,W.Z)(this,"model",void 0),(0,W.Z)(this,"name",void 0),(0,W.Z)(this,"optionsToUpdate",{})}return(0,tt.Z)(n,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(a){this.name=a}},{key:"getType",value:function(){return jd.PostProcessing}},{key:"init",value:function(a,s){this.config=s,this.rendererService=a.getContainer().get(Dt.IRendererService),this.shaderModuleService=a.getContainer().get(Dt.IShaderModuleService);var o=this.rendererService,h=o.createAttribute,v=o.createBuffer,m=o.createModel,E=this.setupShaders(),A=E.vs,F=E.fs,B=E.uniforms;this.model=m({vs:A,fs:F,attributes:{a_Position:h({buffer:v({data:[-4,-4,4,-4,0,4],type:Kt.FLOAT}),size:2})},uniforms:(0,K.Z)((0,K.Z)({u_Texture:null},B),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(a,s){var o=this,h=a.multiPassRenderer.getPostProcessor(),v=this.rendererService,m=v.useFramebuffer,E=v.getViewportSize,A=v.clear,F=E(),B=F.width,V=F.height;m(this.renderToScreen?null:h.getWriteFBO(),function(){A({framebuffer:h.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var j=(0,K.Z)({u_BloomFinal:0,u_Texture:h.getReadFBO(),u_ViewportSize:[B,V]},o.convertOptionsToUniforms(o.optionsToUpdate));s&&(j.u_BloomFinal=1,j.u_Texture2=s),o.model.draw({uniforms:j})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(a){this.enabled=a}},{key:"setRenderToScreen",value:function(a){this.renderToScreen=a}},{key:"updateOptions",value:function(a){this.optionsToUpdate=(0,K.Z)((0,K.Z)({},this.optionsToUpdate),a)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(a){var s={};return Object.keys(a).forEach(function(o){(0,te.isNil)(a[o])||(s["u_".concat((0,te.upperFirst)((0,te.camelCase)(o)))]=a[o])}),s}}]),n}(),X2=Dr(f1.prototype,"shaderModuleService",[j2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f1))||W2),Y2,iy;function jT(n){var l=ay();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ay(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var $2=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,fO=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,hO=(Y2=(0,Mt.b2)(),Y2(iy=function(n){(0,Ut.Z)(a,n);var l=jT(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:fO,fs:$2});var o=this.shaderModuleService.getModule("blur-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,F]})}}},{key:"convertOptionsToUniforms",value:function(o){var h={};return(0,te.isNil)(o.bloomRadius)||(h.u_radius=o.bloomRadius),(0,te.isNil)(o.bloomIntensity)||(h.u_intensity=o.bloomIntensity),(0,te.isNil)(o.bloomBaseRadio)||(h.u_baseRadio=o.bloomBaseRadio),h}}]),a}(Wd))||iy),q2,K2;function pO(n){var l=dO();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function dO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var WT=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,XT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,YT=(q2=(0,Mt.b2)(),q2(K2=function(n){(0,Ut.Z)(a,n);var l=pO(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:XT,fs:WT});var o=this.shaderModuleService.getModule("blur-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,F]})}}},{key:"convertOptionsToUniforms",value:function(o){var h={};return(0,te.isNil)(o.blurRadius)||(h.u_BlurDir=[o.blurRadius,0]),h}}]),a}(Wd))||K2),Q2,oy;function h1(n){var l=J2();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function J2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var tE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,$T=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,eE=(Q2=(0,Mt.b2)(),Q2(oy=function(n){(0,Ut.Z)(a,n);var l=h1(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:$T,fs:tE});var o=this.shaderModuleService.getModule("blur-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,F]})}}},{key:"convertOptionsToUniforms",value:function(o){var h={};return(0,te.isNil)(o.blurRadius)||(h.u_BlurDir=[0,o.blurRadius]),h}}]),a}(Wd))||oy),cg,rE;function vO(n){var l=gO();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function gO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var qT=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,KT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,p1=(cg=(0,Mt.b2)(),cg(rE=function(n){(0,Ut.Z)(a,n);var l=vO(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:KT,fs:qT});var o=this.shaderModuleService.getModule("colorhalftone-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,F]})}}}]),a}(Wd))||rE),nE,iE;function QT(n){var l=JT();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function JT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var aE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,tM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,d1=(nE=(0,Mt.b2)(),nE(iE=function(n){(0,Ut.Z)(a,n);var l=QT(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:tM,fs:aE}),this.shaderModuleService.getModule("copy-pass")}}]),a}(Wd))||iE),eM,rM;function nM(n){var l=iM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function iM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var aM=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,mO=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,yO=(eM=(0,Mt.b2)(),eM(rM=function(n){(0,Ut.Z)(a,n);var l=nM(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:mO,fs:aM});var o=this.shaderModuleService.getModule("hexagonalpixelate-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,F]})}}}]),a}(Wd))||rM),oE,sE;function _O(n){var l=xO();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function xO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var oM=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,sM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,uM=(oE=(0,Mt.b2)(),oE(sE=function(n){(0,Ut.Z)(a,n);var l=_O(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:sM,fs:oM});var o=this.shaderModuleService.getModule("ink-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,F]})}}}]),a}(Wd))||sE),lM,cM;function fM(n){var l=hM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function hM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var v1=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,g1=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,pM=(lM=(0,Mt.b2)(),lM(cM=function(n){(0,Ut.Z)(a,n);var l=fM(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:g1,fs:v1}),this.shaderModuleService.getModule("noise-pass")}}]),a}(Wd))||cM),uE,lE;function sy(n){var l=dM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function dM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var vM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,gM=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,mM=(uE=(0,Mt.b2)(),uE(lE=function(n){(0,Ut.Z)(a,n);var l=sy(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:vM,fs:gM}),this.shaderModuleService.getModule("sepia-pass")}}]),a}(Wd))||lE),cE,fE,hE,pE,h0,m1,yM=(cE=(0,Mt.b2)(),fE=(0,Mt.f3)(Dt.IRendererService),hE=(0,Mt.zY)(),cE(pE=(h0=function(){function n(){(0,lt.Z)(this,n),Ar(this,"rendererService",m1,this),(0,W.Z)(this,"passes",[]),(0,W.Z)(this,"readFBO",void 0),(0,W.Z)(this,"writeFBO",void 0)}return(0,tt.Z)(n,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var a=this.rendererService,s=a.getViewportSize,o=a.createTexture2D,h=s(),v=h.width,m=h.height;return o({x:0,y:0,width:v,height:m,copy:!0})}},{key:"getReadFBOTex",value:function(){var a=this,s=this.rendererService.useFramebuffer;return new Promise(function(o){s(a.readFBO,(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:o(a.getCurrentFBOTex());case 1:case"end":return m.stop()}},h)})))})}},{key:"renderBloomPass",value:function(){var l=(0,ut.Z)(it().mark(function s(o,h){var v,m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.getReadFBOTex();case 2:v=A.sent,m=0;case 4:if(!(m<4)){A.next=11;break}return A.next=7,h.render(o,v);case 7:this.swap(),m++,A.next=4;break;case 11:case"end":return A.stop()}},s,this)}));function a(s,o){return l.apply(this,arguments)}return a}()},{key:"render",value:function(){var l=(0,ut.Z)(it().mark(function s(o){var h,v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:h=0;case 1:if(!(h<this.passes.length)){E.next=15;break}if(v=this.passes[h],v.setRenderToScreen(this.isLastEnabledPass(h)),v.getName()!=="bloom"){E.next=9;break}return E.next=7,this.renderBloomPass(o,v);case 7:E.next=12;break;case 9:return E.next=11,v.render(o);case 11:h!==this.passes.length-1&&this.swap();case 12:h++,E.next=1;break;case 15:case"end":return E.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"resize",value:function(a,s){this.readFBO.resize({width:a,height:s}),this.writeFBO.resize({width:a,height:s})}},{key:"add",value:function(a,s,o){a.init(s,o),this.passes.push(a)}},{key:"insert",value:function(a,s,o,h){a.init(o,h),this.passes.splice(s,0,a)}},{key:"getPostProcessingPassByName",value:function(a){return this.passes.find(function(s){return s.getName()===a})}},{key:"init",value:function(){var a=this.rendererService,s=a.createFramebuffer,o=a.createTexture2D;this.readFBO=s({color:o({width:1,height:1,wrapS:Kt.CLAMP_TO_EDGE,wrapT:Kt.CLAMP_TO_EDGE})}),this.writeFBO=s({color:o({width:1,height:1,wrapS:Kt.CLAMP_TO_EDGE,wrapT:Kt.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(a){for(var s=a+1;s<this.passes.length;s++)if(this.passes[s].isEnabled())return!1;return!0}},{key:"swap",value:function(){var a=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=a}}]),n}(),m1=Dr(h0.prototype,"rendererService",[fE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dr(h0.prototype,"init",[hE],Object.getOwnPropertyDescriptor(h0.prototype,"init"),h0.prototype),h0))||pE),dE,y1;function _M(n){var l=xM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function xM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var bM=(dE=(0,Mt.b2)(),dE(y1=function(n){(0,Ut.Z)(a,n);var l=_M(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getType",value:function(){return jd.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(o,h){$o((0,b.Z)(a.prototype),"init",this).call(this,o,h)}},{key:"render",value:function(o){var h=this.rendererService,v=h.useFramebuffer,m=h.clear,E=o.multiPassRenderer.getPostProcessor().getReadFBO();v(E,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:E}),o.multiPassRenderer.setRenderFlag(!1),o.models.forEach(function(A){A.draw({uniforms:o.layerModel.getUninforms()})}),o.multiPassRenderer.setRenderFlag(!0)})}}]),a}(ny))||y1),vE,em,gE,uy,mE;function EM(n){var l=yE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function yE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var SM=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,_E=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,xE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function _1(n,l){for(var a=0,s=1/l,o=n;o>0;)a=a+s*(o%l),o=Math.floor(o/l),s=s/l;return a}var wM=1,CM=(vE=(0,Mt.b2)(),em=(0,Mt.f3)(Dt.IShaderModuleService),vE(gE=(uy=function(n){(0,Ut.Z)(a,n);var l=EM(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),Ar((0,st.Z)(s),"shaderModuleService",mE,(0,st.Z)(s)),(0,W.Z)((0,st.Z)(s),"haltonSequence",[]),(0,W.Z)((0,st.Z)(s),"accumulatingId",0),(0,W.Z)((0,st.Z)(s),"frame",0),(0,W.Z)((0,st.Z)(s),"timer",void 0),(0,W.Z)((0,st.Z)(s),"sampleRenderTarget",void 0),(0,W.Z)((0,st.Z)(s),"prevRenderTarget",void 0),(0,W.Z)((0,st.Z)(s),"outputRenderTarget",void 0),(0,W.Z)((0,st.Z)(s),"copyRenderTarget",void 0),(0,W.Z)((0,st.Z)(s),"blendModel",void 0),(0,W.Z)((0,st.Z)(s),"outputModel",void 0),(0,W.Z)((0,st.Z)(s),"copyModel",void 0),s}return(0,tt.Z)(a,[{key:"getType",value:function(){return jd.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(o,h){$o((0,b.Z)(a.prototype),"init",this).call(this,o,h);var v=this.rendererService,m=v.createFramebuffer,E=v.createTexture2D;this.sampleRenderTarget=m({color:E({width:1,height:1,wrapS:Kt.CLAMP_TO_EDGE,wrapT:Kt.CLAMP_TO_EDGE})}),this.prevRenderTarget=m({color:E({width:1,height:1,wrapS:Kt.CLAMP_TO_EDGE,wrapT:Kt.CLAMP_TO_EDGE})}),this.outputRenderTarget=m({color:E({width:1,height:1,wrapS:Kt.CLAMP_TO_EDGE,wrapT:Kt.CLAMP_TO_EDGE})}),this.copyRenderTarget=m({color:E({width:1,height:1,wrapS:Kt.CLAMP_TO_EDGE,wrapT:Kt.CLAMP_TO_EDGE})});for(var A=0;A<30;A++)this.haltonSequence.push([_1(A,2),_1(A,3)]);this.blendModel=this.createTriangleModel("blend-pass",SM),this.outputModel=this.createTriangleModel("copy-pass",_E,{blend:{enable:!0,func:{srcRGB:Kt.ONE,dstRGB:Kt.ONE_MINUS_SRC_ALPHA,srcAlpha:Kt.ONE,dstAlpha:Kt.ONE_MINUS_SRC_ALPHA},equation:{rgb:Kt.FUNC_ADD,alpha:Kt.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",_E)}},{key:"render",value:function(o){var h=this,v=this.rendererService,m=v.clear,E=v.getViewportSize,A=v.useFramebuffer,F=E(),B=F.width,V=F.height;this.sampleRenderTarget.resize({width:B,height:V}),this.prevRenderTarget.resize({width:B,height:V}),this.outputRenderTarget.resize({width:B,height:V}),this.copyRenderTarget.resize({width:B,height:V}),this.resetFrame(),this.stopAccumulating();var j=o.multiPassRenderer.getPostProcessor().getReadFBO();A(j,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:j}),o.multiPassRenderer.setRenderFlag(!1),o.render(),o.multiPassRenderer.setRenderFlag(!0)});var nt=function at(mt){!h.accumulatingId||mt!==h.accumulatingId||h.isFinished()||(h.doRender(o),Co.requestAnimationFrame(function(){at(mt)}))};this.accumulatingId=wM++,this.timer=Co.setTimeout(function(){nt(h.accumulatingId)},50)}},{key:"doRender",value:function(o){var h=this,v=this.rendererService,m=v.clear,E=v.getViewportSize,A=v.useFramebuffer,F=E(),B=F.width,V=F.height,j=o.getLayerConfig(),nt=j.jitterScale,at=nt===void 0?1:nt,mt=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((mt[0]*2-1)/B*at,(mt[1]*2-1)/V*at),o.multiPassRenderer.setRenderFlag(!1),o.hooks.beforeRender.call(),A(this.sampleRenderTarget,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:h.sampleRenderTarget}),o.render()}),o.hooks.afterRender.call(),o.multiPassRenderer.setRenderFlag(!0);var Bt=o.getLayerConfig();A(this.outputRenderTarget,function(){h.blendModel.draw({uniforms:{u_opacity:Bt.opacity||1,u_MixRatio:h.frame===0?1:.9,u_Diffuse1:h.sampleRenderTarget,u_Diffuse2:h.frame===0?o.multiPassRenderer.getPostProcessor().getReadFBO():h.prevRenderTarget}})}),this.frame===0&&m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(A(this.copyRenderTarget,function(){h.outputModel.draw({uniforms:{u_Texture:h.outputRenderTarget}})}),A(o.multiPassRenderer.getPostProcessor().getReadFBO(),function(){h.copyModel.draw({uniforms:{u_Texture:h.copyRenderTarget}})}),o.multiPassRenderer.getPostProcessor().render(o));var de=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=de,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,Co.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(o,h,v){this.shaderModuleService.registerModule(o,{vs:xE,fs:h});var m=this.shaderModuleService.getModule(o),E=m.vs,A=m.fs,F=m.uniforms,B=this.rendererService,V=B.createAttribute,j=B.createBuffer,nt=B.createModel;return nt((0,K.Z)({vs:E,fs:A,attributes:{a_Position:V({buffer:j({data:[-4,-4,4,-4,0,4],type:Kt.FLOAT}),size:2})},uniforms:(0,K.Z)({},F),depth:{enable:!1},count:3},v))}}]),a}(ny),mE=Dr(uy.prototype,"shaderModuleService",[em],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uy))||gE),p0=new Mt.W2;p0.bind(Dt.IGlobalConfigService).to(Ur).inSingletonScope(),(0,Mt.GW)((0,Mt.b2)(),Ee.EventEmitter),p0.bind(Dt.IEventEmitter).to(Ee.EventEmitter);var bE=(0,et.Z)(p0,!1),ly=function(l){var a=bE.lazyInject(l);return function(s,o,h){a.call(this,s,o),h&&(h.initializer=function(){return s[o]})}},bO=function(l){var a=bE.lazyMultiInject(l);return function(s,o,h){a.call(this,s,o),h&&(h.initializer=function(){return s[o]})}},sh=p0,AM=0;function TM(){var n=new Mt.W2;return n.parent=p0,n.bind(Dt.SceneID).toConstantValue("".concat(AM++)),n.bind(Dt.IShaderModuleService).to(OT).inSingletonScope(),n.bind(Dt.ILayerService).to(Wg).inSingletonScope(),n.bind(Dt.ISceneService).to(mT).inSingletonScope(),n.bind(Dt.ICameraService).to(Lu).inSingletonScope(),n.bind(Dt.ICoordinateSystemService).to(_v).inSingletonScope(),n.bind(Dt.IInteractionService).to(td).inSingletonScope(),n.bind(Dt.IPickingService).to(Ju).inSingletonScope(),n.bind(Dt.IControlService).to(N).inSingletonScope(),n.bind(Dt.IMarkerService).to(dt).inSingletonScope(),n.bind(Dt.IIconService).to(So).inSingletonScope(),n.bind(Dt.IFontService).to(Jo).inSingletonScope(),n.bind(Dt.IPopupService).to(qt).inSingletonScope(),n.bind(Dt.INormalPass).to(BT).whenTargetNamed("clear"),n.bind(Dt.INormalPass).to(GT).whenTargetNamed("pixelPicking"),n.bind(Dt.INormalPass).to(bM).whenTargetNamed("render"),n.bind(Dt.INormalPass).to(CM).whenTargetNamed("taa"),n.bind(Dt.IFactoryNormalPass).toFactory(function(l){return function(a){return l.container.getNamed(Dt.INormalPass,a)}}),n.bind(Dt.IPostProcessingPass).to(d1).whenTargetNamed("copy"),n.bind(Dt.IPostProcessingPass).to(hO).whenTargetNamed("bloom"),n.bind(Dt.IPostProcessingPass).to(YT).whenTargetNamed("blurH"),n.bind(Dt.IPostProcessingPass).to(eE).whenTargetNamed("blurV"),n.bind(Dt.IPostProcessingPass).to(pM).whenTargetNamed("noise"),n.bind(Dt.IPostProcessingPass).to(mM).whenTargetNamed("sepia"),n.bind(Dt.IPostProcessingPass).to(p1).whenTargetNamed("colorHalftone"),n.bind(Dt.IPostProcessingPass).to(yO).whenTargetNamed("hexagonalPixelate"),n.bind(Dt.IPostProcessingPass).to(uM).whenTargetNamed("ink"),n.bind(Dt.IFactoryPostProcessingPass).toFactory(function(l){return function(a){var s=l.container.getNamed(Dt.IPostProcessingPass,a);return s.setName(a),s}}),n}function cy(n){var l=new Mt.W2;return l.parent=n,l.bind(Dt.IStyleAttributeService).to(_p).inSingletonScope(),l.bind(Dt.IMultiPassRenderer).to(UT).inSingletonScope(),l.bind(Dt.IPostProcessor).to(yM).inSingletonScope(),l}var EE=null;function EO(n){return EE.indexOf(n)}var MM=2,SO=4,IM=64,wO=128,SE=256,fy=512,kM=8192,LM=16384,CO=32768,PM=null,x1=131072,AO=262144,OM=524288,TO=1048576,FM=2097152,MO=4194304,RM=8388608,b1=16777216,E1=null;function rm(n,l){return n=clamp(Math.floor(n),0,255),l=clamp(Math.floor(l),0,255),256*n+l}function IO(n){var l=n.color,a=n.radius,s=n.tileX,o=n.tileY,h=n.shape,v=n.opacity,m=n.stroke,E=n.strokeWidth,A=n.strokeOpacity,F=[],B=[],V=[],j=[rm(l[0],l[1]),rm(l[2],l[3])],nt=[rm(m[0],m[1]),rm(m[2],m[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(at){var mt=_slicedToArray(at,2),Bt=mt[0],de=mt[1];F.push([].concat(j,[(Bt+1)*RM+(de+1)*FM+getShapeIndex(h)*x1+a,(s+512)*OM+(o+512)*IM])),B.push([].concat(nt,[E,A])),V.push([v,0,0,0])}),{packedBuffer:F,packedBuffer2:B,packedBuffer3:V}}function DM(n,l){if(n===0&&!l)return 0;if(n===1&&l)return 4294967295;var a=l?1:0,s=Math.floor(n*127);return s*E1+a*b1+s*x1+a*PM+s*fy+a*SE+s*MM+a}var Sp;(function(n){n.normal="normal",n.additive="additive",n.subtractive="subtractive",n.min="min",n.max="max",n.none="none"})(Sp||(Sp={}));var Ps;(function(n){n.LINEAR="linear",n.SEQUENTIAL="sequential",n.POWER="power",n.LOG="log",n.IDENTITY="identity",n.TIME="time",n.QUANTILE="quantile",n.QUANTIZE="quantize",n.THRESHOLD="threshold",n.CAT="cat",n.DIVERGING="diverging"})(Ps||(Ps={}));var Rv;(function(n){n.CONSTANT="constant",n.VARIABLE="variable"})(Rv||(Rv={}));var Vi;(function(n){n[n.Attribute=0]="Attribute",n[n.InstancedAttribute=1]="InstancedAttribute",n[n.Uniform=2]="Uniform"})(Vi||(Vi={}));var wp;(function(n){n.IMAGE="image",n.ARRAYBUFFER="arraybuffer",n.RGB="rgb",n.CUSTOMRGB="customRGB",n.CUSTOMARRAYBUFFER="customArrayBuffer"})(wp||(wp={}));var S1=["mapload","mapchange","mapAfterFrameChange"],d0={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},hy=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];function BM(n){var l=wE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function wE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var w1=function(n){(0,Ut.Z)(a,n);var l=BM(a);function a(s){var o;return(0,lt.Z)(this,a),o=l.call(this),(0,W.Z)((0,st.Z)(o),"added",!1),(0,W.Z)((0,st.Z)(o),"eventHandle",function(h){o.emit(h.type,{target:h,data:o.markerOption.extData,lngLat:o.lngLat})}),o.markerOption=(0,K.Z)((0,K.Z)({},o.getDefault()),s),os(["update","onMove","onMapClick"],(0,st.Z)(o)),o.init(),o}return(0,tt.Z)(a,[{key:"getMarkerLayerContainerSize",value:function(){}},{key:"getDefault",value:function(){return{element:void 0,anchor:rr.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(o){this.scene=o,this.mapsService=o.get(Dt.IMapService),this.sceneSerive=o.get(Dt.ISceneService);var h=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(h),this.registerMarkerEvent(h),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();var o=this.markerOption.element;return o&&rt(o),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(o){return this.lngLat=o,Array.isArray(o)&&(this.lngLat={lng:o[0],lat:o[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(o){var h=this;if(!this.added)return this.once("added",function(){h.setElement(o)}),this;var v=this.markerOption.element;return v&&rt(v),this.markerOption.element=o,this.init(),this.mapsService.getMarkerContainer().appendChild(o),this.registerMarkerEvent(o),this.update(),this}},{key:"openPopup",value:function(){var o=this;if(!this.added)return this.once("added",function(){o.openPopup()}),this;var h=this.popup;return h?(h.isOpen()||h.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var o=this;this.added||this.once("added",function(){o.closePopup()});var h=this.popup;return h&&h.remove(),this}},{key:"setPopup",value:function(o){return this.popup=o,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var o=this.popup;if(o)o.isOpen()?o.remove():o.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(o){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(o){this.markerOption.extData=o}},{key:"update",value:function(){if(!!this.mapsService){var o=this.markerOption,h=o.element,v=o.anchor;this.updatePosition(),$i(h,"".concat(xr[v]))}}},{key:"onMapClick",value:function(o){var h=this.markerOption.element;this.popup&&h&&this.togglePopup()}},{key:"getCurrentContainerSize",value:function(){var o=this.mapsService.getContainer();return{containerHeight:(o==null?void 0:o.scrollHeight)||0,containerWidth:(o==null?void 0:o.scrollWidth)||0,bounds:this.mapsService.getBounds()}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var o=this.markerOption,h=o.element,v=o.offsets,m=this.lngLat,E=m.lng,A=m.lat,F=this.mapsService.lngLatToContainer([E,A]);if(h){h.style.display="block",h.style.whiteSpace="nowrap";var B=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize(),V=B.containerHeight,j=B.containerWidth,nt=B.bounds;if(!nt)return;if(Math.abs(nt[0][0])>180||Math.abs(nt[1][0])>180){if(F.x>j){var at=this.mapsService.lngLatToContainer([E-360,A]);F.x=at.x}if(F.x<0){var mt=this.mapsService.lngLatToContainer([E+360,A]);F.x=mt.x}}(F.x>j||F.x<0||F.y>V||F.y<0)&&(h.style.display="none"),h.style.left=F.x+v[0]+"px",h.style.top=F.y-v[1]+"px"}}}},{key:"init",value:function(){var o=this,h=this.markerOption.element,v=this.markerOption,m=v.color,E=v.anchor;if(!h){this.defaultMarker=!0,h=_t("div"),this.markerOption.element=h;var A=document.createElementNS("http://www.w3.org/2000/svg","svg");A.setAttributeNS(null,"display","block"),A.setAttributeNS(null,"height","48px"),A.setAttributeNS(null,"width","48px"),A.setAttributeNS(null,"viewBox","0 0 1024 1024");var F=document.createElementNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),F.setAttributeNS(null,"fill",m),A.appendChild(F),h.appendChild(A)}se(h,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(B){var V,j,nt=((V=o.markerOption)===null||V===void 0?void 0:V.style)&&((j=o.markerOption)===null||j===void 0?void 0:j.style[B]);h&&(h.style[B]=nt)}),h.addEventListener("click",function(B){o.onMapClick(B)}),h.addEventListener("click",this.eventHandle),Pr(h,E,"marker")}},{key:"registerMarkerEvent",value:function(o){o.addEventListener("mousemove",this.eventHandle),o.addEventListener("click",this.eventHandle),o.addEventListener("mousedown",this.eventHandle),o.addEventListener("mouseup",this.eventHandle),o.addEventListener("dblclick",this.eventHandle),o.addEventListener("contextmenu",this.eventHandle),o.addEventListener("mouseover",this.eventHandle),o.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var o=this.getElement();o.removeEventListener("mousemove",this.eventHandle),o.removeEventListener("click",this.eventHandle),o.removeEventListener("mousedown",this.eventHandle),o.removeEventListener("mouseup",this.eventHandle),o.removeEventListener("dblclick",this.eventHandle),o.removeEventListener("contextmenu",this.eventHandle),o.removeEventListener("mouseover",this.eventHandle),o.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(o){return null}},{key:"onUp",value:function(o){throw new Error("Method not implemented.")}}]),a}(Ee.EventEmitter),CE=ot(69848),AE=ot.n(CE);function NM(n){var l=TE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function TE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var kO=function(n){(0,Ut.Z)(a,n);var l=NM(a);function a(s){var o,h;return(0,lt.Z)(this,a),h=l.call(this),(0,W.Z)((0,st.Z)(h),"markers",[]),(0,W.Z)((0,st.Z)(h),"points",[]),(0,W.Z)((0,st.Z)(h),"clusterMarkers",[]),h.markerLayerOption=(0,te.merge)(h.getDefault(),s),os(["update"],(0,st.Z)(h)),h.zoom=((o=h.markerLayerOption.clusterOption)===null||o===void 0?void 0:o.zoom)||-99,h}return(0,tt.Z)(a,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(o){return this.scene=o,this.mapsService=o.get(Dt.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}},{key:"setContainerSize",value:function(){if(!!this.mapsService){var o=this.mapsService.getContainer();this.containerSize={containerWidth:(o==null?void 0:o.scrollWidth)||0,containerHeight:(o==null?void 0:o.scrollHeight)||0,bounds:this.mapsService.getBounds()}}}},{key:"getContainerSize",value:function(){return this.containerSize}},{key:"addMarker",value:function(o){var h=this.markerLayerOption.cluster;if(o.getMarkerLayerContainerSize=this.getContainerSize.bind(this),h&&(this.addPoint(o,this.markers.length),this.mapsService)){var v=this.mapsService.getZoom(),m=this.mapsService.getBounds();this.bbox=Nl(m,.5),this.zoom=Math.floor(v),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(o)}},{key:"removeMarker",value:function(o){this.markers.indexOf(o);var h=this.markers.indexOf(o);h>-1&&this.markers.splice(h,1)}},{key:"hide",value:function(){this.markers.map(function(o){o.getElement().style.opacity="0"}),this.clusterMarkers.map(function(o){o.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(o){o.getElement().style.opacity="1"}),this.clusterMarkers.map(function(o){o.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var o=this.markerLayerOption.cluster;return o?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var o=this;this.getMarkers().forEach(function(h){h.addTo(o.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(o){o.remove()}),this.clusterMarkers.forEach(function(o){o.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}},{key:"addPoint",value:function(o,h){var v=o.getLnglat(),m=v.lng,E=v.lat,A={geometry:{type:"Point",coordinates:[m,E]},properties:(0,K.Z)((0,K.Z)({},o.getExtData()),{},{marker_id:h})};this.points.push(A),this.clusterIndex&&this.clusterIndex.load(this.points)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var o=this.markerLayerOption.clusterOption,h=o.radius,v=o.minZoom,m=v===void 0?0:v,E=o.maxZoom;this.clusterIndex=new(AE())({radius:h,minZoom:m,maxZoom:E}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(o,h){var v=this,m=o[0].concat(o[1]),E=this.clusterIndex.getClusters(m,h);this.clusterMarkers.forEach(function(A){A.remove()}),this.clusterMarkers=[],E.forEach(function(A){var F,B=v.markerLayerOption.clusterOption,V=B.field,j=B.method;if((F=A.properties)!==null&&F!==void 0&&F.cluster_id){var nt,at=v.getLeaves((nt=A.properties)===null||nt===void 0?void 0:nt.cluster_id);if(A.properties.clusterData=at,V&&j){var mt=at==null?void 0:at.map(function(Xe){var _r=(0,W.Z)({},V,Xe.properties[V]);return _r}),Bt=_i(mt,V),de=qi(j,Bt),ce="point_"+j;A.properties[ce]=de.toFixed(2)}}var Be=v.clusterMarker(A);v.clusterMarkers.push(Be),Be.addTo(v.scene)})}},{key:"getLeaves",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return o?this.clusterIndex.getLeaves(o,h,v):null}},{key:"clusterMarker",value:function(o){var h=this.markerLayerOption.clusterOption,v=h,m=v.element,E=m===void 0?this.generateElement.bind(this):m,A=new w1({element:E(o)}).setLnglat({lng:o.geometry.coordinates[0],lat:o.geometry.coordinates[1]});return A}},{key:"normalMarker",value:function(o){var h=o.properties.marker_id;return this.markers[h]}},{key:"update",value:function(){if(!!this.mapsService&&this.markers.length!==0){var o=this.mapsService.getZoom(),h=this.mapsService.getBounds();(!this.bbox||Math.abs(o-this.zoom)>=1||!Su(this.bbox,h))&&(this.bbox=Nl(h,.5),this.zoom=Math.floor(o),this.getClusterMarker(this.bbox,this.zoom))}}},{key:"generateElement",value:function(o){var h=_t("div","l7-marker-cluster"),v=_t("div","",h),m=_t("span","",v),E=this.markerLayerOption.clusterOption,A=E.field,F=E.method;o.properties.point_count=o.properties.point_count||1;var B=A&&F?o.properties["point_"+F]||o.properties[A]:o.properties.point_count;return m.textContent=B,h}}]),a}(Ee.EventEmitter),zM=ot(4157);function UM(n){var l=C1();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function C1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var v0=function(n){(0,Ut.Z)(a,n);var l=UM(a);function a(s){var o;return(0,lt.Z)(this,a),o=l.call(this),a.controlCount++,o.controlOption=(0,K.Z)((0,K.Z)({},o.getDefault(s)),s||{}),o}return(0,tt.Z)(a,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(o){var h=this.getDefault(o);Object.entries(o).forEach(function(v){var m=(0,ht.Z)(v,2),E=m[0],A=m[1];A===void 0&&(o[E]=h[E])}),"position"in o&&this.setPosition(o.position),"className"in o&&this.setClassName(o.className),"style"in o&&this.setStyle(o.style),this.controlOption=(0,K.Z)((0,K.Z)({},this.controlOption),o)}},{key:"addTo",value:function(o){this.mapsService=o.get(Dt.IMapService),this.renderService=o.get(Dt.IRendererService),this.layerService=o.get(Dt.ILayerService),this.controlService=o.get(Dt.IControlService),this.configService=o.get(Dt.IGlobalConfigService),this.scene=o.get(Dt.ISceneService),this.sceneContainer=o,this.isShow=!0,this.container=this.onAdd(),se(this.container,"l7-control");var h=this.controlOption,v=h.className,m=h.style;return v&&this.setClassName(v),m&&this.setStyle(m),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;rt(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return _t("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var o=this.container;Ze(o,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var o=this.container;se(o,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(o){return{position:Vl.TOPRIGHT,name:"".concat(a.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(o){if(this.mapsService&&o&&o.screenX>0&&o.screenY>0){var h=this.mapsService.getContainer();h!==null&&h.focus()}}},{key:"setPosition",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Vl.TOPLEFT,h=this.controlService;return h&&h.removeControl(this),this.controlOption.position=o,h&&h.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(o){var h=this.container,v=this.controlOption.className;v&&Ze(h,v),o&&se(h,o)}},{key:"setStyle",value:function(o){var h=this.container;o?h.setAttribute("style",o):h.removeAttribute("style")}},{key:"insertContainer",value:function(){var o=this.controlOption.position,h=this.container;if(o instanceof Element)o.appendChild(h);else{var v=this.controlService.controlCorners[o];o.indexOf("bottom")!==-1?v.insertBefore(h,v.firstChild):v.appendChild(h)}}},{key:"checkUpdateOption",value:function(o,h){return h.some(function(v){return v in o})}}]),a}(Te());(0,W.Z)(v0,"controlCount",0);function py(n){var l=ZM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ZM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dy=function(n){(0,Ut.Z)(a,n);var l=py(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"isDisable",!1),s}return(0,tt.Z)(a,[{key:"setIsDisable",value:function(o){if(this.isDisable=o,o){var h;(h=this.button)===null||h===void 0||h.setAttribute("disabled","true")}else{var v;(v=this.button)===null||v===void 0||v.removeAttribute("disabled")}}},{key:"createButton",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return _t("button","l7-button-control ".concat(o))}},{key:"onAdd",value:function(){this.button=this.createButton(),this.isDisable=!1;var o=this.controlOption,h=o.title,v=o.btnText,m=o.btnIcon;return this.setBtnTitle(h),this.setBtnText(v),this.setBtnIcon(m),this.button}},{key:"onRemove",value:function(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}},{key:"setOptions",value:function(o){var h=o.title,v=o.btnText,m=o.btnIcon;this.checkUpdateOption(o,["title"])&&this.setBtnTitle(h),this.checkUpdateOption(o,["btnIcon"])&&this.setBtnIcon(m),this.checkUpdateOption(o,["btnText"])&&this.setBtnText(v),$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o)}},{key:"setBtnTitle",value:function(o){var h;(h=this.button)===null||h===void 0||h.setAttribute("title",o!=null?o:"")}},{key:"setBtnIcon",value:function(o){if(this.buttonIcon&&rt(this.buttonIcon),o){var h,v=(h=this.button)===null||h===void 0?void 0:h.firstChild;if(v){var m;(m=this.button)===null||m===void 0||m.insertBefore(o,v)}else{var E;(E=this.button)===null||E===void 0||E.appendChild(o)}this.buttonIcon=o}}},{key:"setBtnText",value:function(o){if(!!this.button)if(Ze(this.button,"l7-button-control--row"),Ze(this.button,"l7-button-control--column"),o){var h=this.buttonText;if(!h){var v;h=_t("div","l7-button-control__text"),(v=this.button)===null||v===void 0||v.appendChild(h),this.buttonText=h}h.innerText=o,se(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!o&&this.buttonText&&(rt(this.buttonText),this.buttonText=void 0)}}]),a}(v0);function VM(n){var l=GM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function GM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ME=function(n){(0,Ut.Z)(a,n);var l=VM(a);function a(s,o){var h;return(0,lt.Z)(this,a),h=l.call(this),(0,W.Z)((0,st.Z)(h),"isShow",!1),(0,W.Z)((0,st.Z)(h),"timeout",null),(0,W.Z)((0,st.Z)(h),"show",function(){return h.isShow||!h.contentDOM.innerHTML||(h.resetPopperPosition(),Ze(h.popperDOM,"l7-popper-hide"),h.isShow=!0,h.option.unique&&a.conflictPopperList.forEach(function(v){v!==(0,st.Z)(h)&&v.isShow&&v.hide()}),h.emit("show")),(0,st.Z)(h)}),(0,W.Z)((0,st.Z)(h),"hide",function(){return h.isShow&&(se(h.popperDOM,"l7-popper-hide"),h.isShow=!1,h.emit("hide")),(0,st.Z)(h)}),(0,W.Z)((0,st.Z)(h),"setHideTimeout",function(){h.timeout||(h.timeout=window.setTimeout(function(){!h.isShow||(h.hide(),h.timeout=null)},300))}),(0,W.Z)((0,st.Z)(h),"clearHideTimeout",function(){h.timeout&&(window.clearTimeout(h.timeout),h.timeout=null)}),(0,W.Z)((0,st.Z)(h),"onBtnClick",function(){h.isShow?h.hide():h.show()}),(0,W.Z)((0,st.Z)(h),"onBtnMouseLeave",function(){h.setHideTimeout()}),(0,W.Z)((0,st.Z)(h),"onBtnMouseMove",function(){h.clearHideTimeout(),!h.isShow&&h.show()}),h.button=s,h.option=o,h.init(),o.unique&&a.conflictPopperList.push((0,st.Z)(h)),h}return(0,tt.Z)(a,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(o){typeof o=="string"?this.contentDOM.innerHTML=o:o instanceof HTMLElement&&(iu(this.contentDOM),this.contentDOM.appendChild(o)),this.content=o}},{key:"init",value:function(){var o=this.option.trigger;this.popperDOM=this.createPopper(),o==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),rt(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var o={},h=this.option,v=h.container,m=h.offset,E=m===void 0?[0,0]:m,A=h.placement,F=(0,ht.Z)(E,2),B=F[0],V=F[1],j=this.button.getBoundingClientRect(),nt=v.getBoundingClientRect(),at=il(j,nt),mt=at.left,Bt=at.right,de=at.top,ce=at.bottom,Be=!1,Xe=!1;/^(left|right)/.test(A)?(A.includes("left")?o.right="".concat(j.width+Bt,"px"):A.includes("right")&&(o.left="".concat(j.width+mt,"px")),A.includes("start")?o.top="".concat(de,"px"):A.includes("end")?o.bottom="".concat(ce,"px"):(o.top="".concat(de+j.height/2,"px"),Xe=!0,o.transform="translate(".concat(B,"px, calc(").concat(V,"px - 50%))"))):/^(top|bottom)/.test(A)&&(A.includes("top")?o.bottom="".concat(j.height+ce,"px"):A.includes("bottom")&&(o.top="".concat(j.height+de,"px")),A.includes("start")?o.left="".concat(mt,"px"):A.includes("end")?o.right="".concat(Bt,"px"):(o.left="".concat(mt+j.width/2,"px"),Be=!0,o.transform="translate(calc(".concat(B,"px - 50%), ").concat(V,"px)"))),o.transform="translate(calc(".concat(B,"px - ").concat(Be?"50%":"0%","), calc(").concat(V,"px - ").concat(Xe?"50%":"0%",")");var _r=A.split("-");_r.length&&se(this.popperDOM,_r.map(function(Ir){return"l7-popper-".concat(Ir)}).join(" ")),Ao(this.popperDOM,xu(o))}},{key:"createPopper",value:function(){var o=this.option,h=o.container,v=o.className,m=v===void 0?"":v,E=o.content,A=_t("div","l7-popper l7-popper-hide ".concat(m)),F=_t("div","l7-popper-content"),B=_t("div","l7-popper-arrow");return A.appendChild(F),A.appendChild(B),h.appendChild(A),this.popperDOM=A,this.contentDOM=F,E&&this.setContent(E),A}}]),a}(Ee.EventEmitter);(0,W.Z)(ME,"conflictPopperList",[]);function A1(n){var l=HM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function HM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var jM={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"},WM=function(n){(0,Ut.Z)(a,n);var l=A1(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getPopper",value:function(){return this.popper}},{key:"hide",value:function(){this.popper.hide(),$o((0,b.Z)(a.prototype),"hide",this).call(this)}},{key:"getDefault",value:function(o){var h,v=$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o),m=(h=o==null?void 0:o.position)!==null&&h!==void 0?h:v.position;return(0,K.Z)((0,K.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{popperPlacement:m instanceof Element?"bottom":jM[m],popperTrigger:"click"})}},{key:"onAdd",value:function(){var o=$o((0,b.Z)(a.prototype),"onAdd",this).call(this);return this.initPopper(),o}},{key:"onRemove",value:function(){this.popper.destroy()}},{key:"initPopper",value:function(){var o=this,h=this.controlOption,v=h.popperClassName,m=h.popperPlacement,E=h.popperTrigger,A=this.mapsService.getMapContainer();return this.popper=new ME(this.button,{className:v,placement:m,trigger:E,container:A,unique:!0}),this.popper.on("show",function(){o.emit("popperShow",o)}).on("hide",function(){o.emit("popperHide",o)}),this.popper}},{key:"setOptions",value:function(o){if($o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),this.checkUpdateOption(o,["popperPlacement","popperTrigger","popperClassName"])){var h=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(h)}}}]),a}(dy);function XM(n){var l=YM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function YM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Xd;(function(n){n.ActiveOptionClassName="l7-select-control-item-active",n.OptionValueAttrKey="data-option-value",n.OptionIndexAttrKey="data-option-index"})(Xd||(Xd={}));var IE=function(n){(0,Ut.Z)(a,n);var l=XM(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"selectValue",[]),(0,W.Z)((0,st.Z)(s),"createNormalOption",function(m){var E=s.selectValue.includes(m.value),A=_t("div","l7-select-control-item ".concat(E?Xd.ActiveOptionClassName:""));s.getIsMultiple()&&A.appendChild(s.createCheckbox(E)),m.icon&&A.appendChild(m.icon);var F=_t("span");return F.innerText=m.text,A.appendChild(F),A}),(0,W.Z)((0,st.Z)(s),"onItemClick",function(m){if(s.getIsMultiple()){var E=s.selectValue.findIndex(function(A){return A===m.value});E>-1?s.selectValue.splice(E,1):s.selectValue=[].concat((0,ge.Z)(s.selectValue),[m.value])}else s.selectValue=[m.value];s.setSelectValue(s.selectValue)}),s}return(0,tt.Z)(a,[{key:"setOptions",value:function(o){$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o);var h=o.options;h&&this.popper.setContent(this.getPopperContent(h))}},{key:"onAdd",value:function(){var o=$o((0,b.Z)(a.prototype),"onAdd",this).call(this),h=this.controlOption.defaultValue;return h&&(this.selectValue=this.transSelectValue(h)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),o}},{key:"getSelectValue",value:function(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}},{key:"setSelectValue",value:function(o){var h=this,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m=this.transSelectValue(o);this.optionDOMList.forEach(function(E){var A=E.getAttribute(Xd.OptionValueAttrKey),F=h.getIsMultiple()?E.querySelector("input[type=checkbox]"):void 0;m.includes(A)?(se(E,Xd.ActiveOptionClassName),F&&bu(F,!0)):(Ze(E,Xd.ActiveOptionClassName),F&&bu(F,!1))}),this.selectValue=m,v&&this.emit("selectChange",this.getIsMultiple()?m:m[0])}},{key:"getIsMultiple",value:function(){return!1}},{key:"getPopperContent",value:function(o){var h=this,v=this.isImageOptions(),m=_t("div",v?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&se(m,"l7-select-control--multiple");var E=o.map(function(A,F){var B=v?h.createImageOption(A):h.createNormalOption(A);return B.setAttribute(Xd.OptionValueAttrKey,A.value),B.setAttribute(Xd.OptionIndexAttrKey,window.String(F)),B.addEventListener("click",h.onItemClick.bind(h,A)),B});return m.append.apply(m,(0,ge.Z)(E)),this.optionDOMList=E,m}},{key:"createImageOption",value:function(o){var h=this.selectValue.includes(o.value),v=_t("div","l7-select-control-item ".concat(h?Xd.ActiveOptionClassName:"")),m=_t("img");m.setAttribute("src",o.img),Vc(m),v.appendChild(m);var E=_t("div","l7-select-control-item-row");this.getIsMultiple()&&v.appendChild(this.createCheckbox(h));var A=_t("span");return A.innerText=o.text,E.appendChild(A),v.appendChild(E),v}},{key:"createCheckbox",value:function(o){var h=_t("input");return h.setAttribute("type","checkbox"),o&&bu(h,!0),h}},{key:"isImageOptions",value:function(){return!!this.controlOption.options.find(function(o){return o.img})}},{key:"transSelectValue",value:function(o){return Array.isArray(o)?o:[o]}}]),a}(WM);function kE(n){var l=LE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function LE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var PE=function(n){(0,Ut.Z)(a,n);var l=kE(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getDefault",value:function(){return{position:Vl.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var o=_t("div","l7-control-logo");return this.setLogoContent(o),o}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(o){$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),this.checkUpdateOption(o,["img","href"])&&(iu(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(o){var h=this.controlOption,v=h.href,m=h.img,E=_t("img");if(E.setAttribute("src",m),E.setAttribute("aria-label","AntV logo"),Vc(E),v){var A=_t("a","l7-control-logo-link");A.target="_blank",A.href=v,A.rel="noopener nofollow",A.setAttribute("rel","noopener nofollow"),A.appendChild(E),o.appendChild(A)}else o.appendChild(E)}}]),a}(v0),Yd=function(l){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.classList.add("l7-iconfont"),a.setAttribute("aria-hidden","true");var s=document.createElementNS("http://www.w3.org/2000/svg","use");return s.setAttributeNS("http://www.w3.org/1999/xlink","href","#".concat(l)),a.appendChild(s),a};function OE(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=T1(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function T1(n,l){if(!!n){if(typeof n=="string")return FE(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return FE(n,l)}}function FE(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var RE=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],bc=function(){if(typeof document=="undefined")return!1;var n=RE[0],l={},a=OE(RE),s;try{for(a.s();!(s=a.n()).done;){var o=s.value,h=o==null?void 0:o[1];if(h in document){var v=OE(o.entries()),m;try{for(v.s();!(m=v.n()).done;){var E=(0,ht.Z)(m.value,2),A=E[0],F=E[1];l[n[A]]=F}}catch(B){v.e(B)}finally{v.f()}return l}}}catch(B){a.e(B)}finally{a.f()}return!1}(),vy={change:bc.fullscreenchange,error:bc.fullscreenerror},uh={request:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,a=arguments.length>1?arguments[1]:void 0;return new Promise(function(s,o){var h=function m(){uh.off("change",m),s()};uh.on("change",h);var v=l[bc.requestFullscreen](a);v instanceof Promise&&v.then(h).catch(o)})},exit:function(){return new Promise(function(l,a){if(!uh.isFullscreen){l();return}var s=function h(){uh.off("change",h),l()};uh.on("change",s);var o=document[bc.exitFullscreen]();o instanceof Promise&&o.then(s).catch(a)})},toggle:function(l,a){return uh.isFullscreen?uh.exit():uh.request(l,a)},onchange:function(l){uh.on("change",l)},onerror:function(l){uh.on("error",l)},on:function(l,a){var s=vy[l];s&&document.addEventListener(s,a,!1)},off:function(l,a){var s=vy[l];s&&document.removeEventListener(s,a,!1)},raw:bc};Object.defineProperties(uh,{isFullscreen:{get:function(){return Boolean(document[bc.fullscreenElement])}},element:{enumerable:!0,get:function(){var l;return(l=document[bc.fullscreenElement])!==null&&l!==void 0?l:void 0}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[bc.fullscreenEnabled])}}}),bc||(uh={isEnabled:!1});var M1=uh;function $M(n){var l=qM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function qM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var LO=function(n){(0,Ut.Z)(a,n);var l=$M(a);function a(s){var o;return(0,lt.Z)(this,a),o=l.call(this,s),(0,W.Z)((0,st.Z)(o),"isFullscreen",!1),(0,W.Z)((0,st.Z)(o),"toggleFullscreen",(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!M1.isEnabled){m.next=3;break}return m.next=3,M1.toggle(o.mapContainer);case 3:case"end":return m.stop()}},h)}))),(0,W.Z)((0,st.Z)(o),"onClick",function(){o.toggleFullscreen()}),(0,W.Z)((0,st.Z)(o),"onFullscreenChange",function(){o.isFullscreen=!!document.fullscreenElement;var h=o.controlOption,v=h.btnText,m=h.btnIcon,E=h.title,A=h.exitBtnText,F=h.exitBtnIcon,B=h.exitTitle;o.isFullscreen?(o.setBtnTitle(B),o.setBtnText(A),o.setBtnIcon(F)):(o.setBtnTitle(E),o.setBtnText(v),o.setBtnIcon(m)),o.emit("fullscreenChange",o.isFullscreen)}),M1.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316"),o}return(0,tt.Z)(a,[{key:"setOptions",value:function(o){var h=o.exitBtnText,v=o.exitBtnIcon,m=o.exitTitle;this.isFullscreen&&(this.checkUpdateOption(o,["exitBtnIcon"])&&this.setBtnIcon(v),this.checkUpdateOption(o,["exitBtnText"])&&this.setBtnText(h),this.checkUpdateOption(o,["exitTitle"])&&this.setBtnTitle(m)),$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o)}},{key:"onAdd",value:function(){var o=$o((0,b.Z)(a.prototype),"onAdd",this).call(this);return o.addEventListener("click",this.onClick),this.mapContainer=nl(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),o}},{key:"onRemove",value:function(){$o((0,b.Z)(a.prototype),"onRemove",this).call(this),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}},{key:"getDefault",value:function(o){return(0,K.Z)((0,K.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{title:"\u5168\u5C4F",btnIcon:Yd("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:Yd("l7-icon-exit-fullscreen")})}}]),a}(dy);function KM(n){var l=QM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function QM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var PO=function(n){(0,Ut.Z)(a,n);var l=KM(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"onClick",(0,ut.Z)(it().mark(function m(){var E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(E=s.controlOption.onExport,E!=null){F.next=5;break}F.next=10;break;case 5:return F.t0=E,F.next=8,s.getImage();case 8:F.t1=F.sent,(0,F.t0)(F.t1);case 10:case"end":return F.stop()}},m)}))),(0,W.Z)((0,st.Z)(s),"mergeImage",(0,ut.Z)(it().mark(function m(){var E,A,F,B,V,j,nt,at,mt,Bt,de,ce,Be,Xe,_r=arguments;return it().wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:for(F=s.controlOption.imageType,B=(E=(A=s.mapsService.getContainer())===null||A===void 0?void 0:A.getBoundingClientRect())!==null&&E!==void 0?E:{},V=B.width,j=V===void 0?0:V,nt=B.height,at=nt===void 0?0:nt,mt=document.createElement("canvas"),mt.width=j,mt.height=at,Bt=mt.getContext("2d"),de=_r.length,ce=new Array(de),Be=0;Be<de;Be++)ce[Be]=_r[Be];return Nr.next=9,Promise.all(ce.map(function(Yr){return new Promise(function(yn){var fn=new Image;fn.onload=function(){yn(fn)},fn.src=Yr})}));case 9:return Xe=Nr.sent,Xe.forEach(function(Yr){Bt==null||Bt.drawImage(Yr,0,0,j,at)}),Nr.abrupt("return",mt.toDataURL("image/".concat(F)));case 12:case"end":return Nr.stop()}},m)}))),s}return(0,tt.Z)(a,[{key:"onAdd",value:function(){var o=$o((0,b.Z)(a.prototype),"onAdd",this).call(this);return o.addEventListener("click",this.onClick),o}},{key:"getDefault",value:function(o){return(0,K.Z)((0,K.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:Yd("l7-icon-export-picture"),imageType:"png"})}},{key:"getImage",value:function(){var o=this.mapsService.exportMap("png"),h=this.scene.exportPng("png");return this.mergeImage(o,h)}}]),a}(dy);function JM(n){var l=t3();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function t3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var OO=function(n){(0,Ut.Z)(a,n);var l=JM(a);function a(s){var o;return(0,lt.Z)(this,a),o=l.call(this,s),(0,W.Z)((0,st.Z)(o),"getGeoLocation",function(){return new Promise(function(h,v){window.navigator.geolocation.getCurrentPosition(function(m){var E=m.coords,A=E!=null?E:{},F=A.longitude,B=A.latitude;!(0,te.isNaN)(F)&&!(0,te.isNaN)(B)?h([F,B]):v()},function(m){v(m)})})}),(0,W.Z)((0,st.Z)(o),"onClick",(0,ut.Z)(it().mark(function h(){var v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(window.navigator.geolocation){F.next=2;break}return F.abrupt("return");case 2:return v=o.controlOption.transform,F.next=5,o.getGeoLocation();case 5:if(m=F.sent,E=o.mapsService.getZoom(),F.t0=o.mapsService,F.t1=E>15?E:15,!v){F.next=15;break}return F.next=12,v(m);case 12:F.t2=F.sent,F.next=16;break;case 15:F.t2=m;case 16:F.t3=F.t2,F.t0.setZoomAndCenter.call(F.t0,F.t1,F.t3);case 18:case"end":return F.stop()}},h)}))),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D"),o}return(0,tt.Z)(a,[{key:"getDefault",value:function(o){return(0,K.Z)((0,K.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{title:"\u5B9A\u4F4D",btnIcon:Yd("l7-icon-reposition")})}},{key:"onAdd",value:function(){var o=$o((0,b.Z)(a.prototype),"onAdd",this).call(this);return o.addEventListener("click",this.onClick),o}}]),a}(dy),e3={normal:{text:"\u6807\u51C6",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-nqiT6Vu948AAAAAAAAAAAAAARQnAQ"},light:{text:"\u6708\u5149\u94F6",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*J_wYQL_PaUEAAAAAAAAAAAAAARQnAQ"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*U7M9QI1yat4AAAAAAAAAAAAAARQnAQ"},fresh:{text:"\u8349\u8272\u9752",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*T-oBT4hB5ucAAAAAAAAAAAAAARQnAQ"},grey:{text:"\u96C5\u58EB\u7070",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*OREXQ4vgQRIAAAAAAAAAAAAAARQnAQ"},graffiti:{text:"\u6D82\u9E26",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*4UApTKmeiy4AAAAAAAAAAAAAARQnAQ"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*0GrCQLtDjNcAAAAAAAAAAAAAARQnAQ"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*uWxqSZQlPkkAAAAAAAAAAAAAARQnAQ"},wine:{text:"\u9171\u7C7D",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*OFPrTbg3an0AAAAAAAAAAAAAARQnAQ"}},DE={normal:{text:"\u6807\u51C6",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*AnfJTbIBJOkAAAAAAAAAAAAAARQnAQ"},light:{text:"\u4EAE",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*gnuiQIok9qIAAAAAAAAAAAAAARQnAQ"},dark:{text:"\u6697",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*NwG-TbOlBH0AAAAAAAAAAAAAARQnAQ"},satellite:{text:"\u536B\u661F",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*2X5EQLKul3IAAAAAAAAAAAAAARQnAQ"},outdoors:{text:"\u6237\u5916",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*gXFLRIaBUI0AAAAAAAAAAAAAARQnAQ"}};function r3(n){var l=gy();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function gy(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var I1=function(n){(0,Ut.Z)(a,n);var l=r3(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"onMapThemeChange",function(){s.mapsService.setMapStyle(s.selectValue[0])}),s}return(0,tt.Z)(a,[{key:"getDefault",value:function(o){return(0,K.Z)((0,K.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:Yd("l7-icon-color"),options:[]})}},{key:"getStyleOptions",value:function(){var o=this.mapsService.getType()==="mapbox"?DE:e3;return Object.entries(this.mapsService.getMapStyleConfig()).filter(function(h){var v=(0,ht.Z)(h,2),m=v[0],E=v[1];return typeof E=="string"&&m!=="blank"}).map(function(h){var v,m=(0,ht.Z)(h,2),E=m[0],A=m[1],F=(v=o[E])!==null&&v!==void 0?v:{},B=F.text,V=F.img;return{text:B!=null?B:E,value:A,img:V,key:E}})}},{key:"getMapStyle",value:function(){return this.mapsService.getMapStyle()}},{key:"onAdd",value:function(){var o,h=this;if((o=this.controlOption.options)!==null&&o!==void 0&&o.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var v,m,E=this.controlOption.defaultValue;this.controlOption.defaultValue=(v=(m=this.controlOption.options.find(function(F){return F.key===E}))===null||m===void 0?void 0:m.value)!==null&&v!==void 0?v:E}else{var A=this.getMapStyle();A?this.controlOption.defaultValue=A:this.mapsService.map.once("styledata",function(){var F=h.mapsService.getMapStyle();h.controlOption.defaultValue=F,h.setSelectValue(F,!1)})}return this.on("selectChange",this.onMapThemeChange),$o((0,b.Z)(a.prototype),"onAdd",this).call(this)}},{key:"getIsMultiple",value:function(){return!1}}]),a}(IE);function n3(n){var l=i3();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function i3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var a3=function(n){(0,Ut.Z)(a,n);var l=n3(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"onLayerChange",function(){var m;(m=s.controlOption.layers)!==null&&m!==void 0&&m.length||(s.selectValue=s.getLayerVisible(),s.setOptions({options:s.getLayerOptions()}))}),(0,W.Z)((0,st.Z)(s),"onLayerVisibleChane",function(){s.setSelectValue(s.getLayerVisible())}),(0,W.Z)((0,st.Z)(s),"onSelectChange",function(){s.layers.forEach(function(m){var E=s.selectValue.includes(m.name),A=m.isVisible();E&&!A&&m.show(),!E&&A&&m.hide()})}),s}return(0,tt.Z)(a,[{key:"layers",get:function(){var o=this.layerService,h=this.controlOption.layers;if(Array.isArray(h)&&h.length){var v=[];return h.forEach(function(m){if(m instanceof Object&&v.push(m),typeof m=="string"){var E=o.getLayer(m)||o.getLayerByName(m);E&&v.push(E)}}),v}return o.getLayers()||[]}},{key:"getDefault",value:function(o){return(0,K.Z)((0,K.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:Yd("l7-icon-layer"),options:[]})}},{key:"getLayerVisible",value:function(){return this.layers.filter(function(o){return o.isVisible()}).map(function(o){return o.name})}},{key:"getLayerOptions",value:function(){return this.layers.map(function(o){return{text:o.name,value:o.name}})}},{key:"setOptions",value:function(o){var h=this.checkUpdateOption(o,["layers"]);$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),h&&(this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}},{key:"onAdd",value:function(){var o;return(o=this.controlOption.options)!==null&&o!==void 0&&o.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),$o((0,b.Z)(a.prototype),"onAdd",this).call(this)}},{key:"onRemove",value:function(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}},{key:"getIsMultiple",value:function(){return!0}}]),a}(IE);function yy(n){var l=k1();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function k1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var o3=function(n){(0,Ut.Z)(a,n);var l=yy(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"location",[0,0]),(0,W.Z)((0,st.Z)(s),"onMouseMove",function(m){var E=s.location,A=m.lngLat||m.lnglat,F=s.controlOption.transform;A&&(E=[A.lng,A.lat]),s.location=E,F&&(E=F(E)),s.insertLocation2HTML(E),s.emit("locationChange",E)}),s}return(0,tt.Z)(a,[{key:"getLocation",value:function(){return this.location}},{key:"getDefault",value:function(o){return(0,K.Z)((0,K.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{position:Vl.BOTTOMLEFT,transform:function(v){var m=(0,ht.Z)(v,2),E=m[0],A=m[1];return[+(+E).toFixed(6),+(+A).toFixed(6)]}})}},{key:"onAdd",value:function(){var o=_t("div","l7-control-mouse-location");return o.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),o}},{key:"onRemove",value:function(){this.mapsService.off("mousemove",this.onMouseMove)}},{key:"insertLocation2HTML",value:function(o){this.container.innerText=o.join(", ")}}]),a}(v0);function Dv(n){var l=BE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function BE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var s3=function(n){(0,Ut.Z)(a,n);var l=Dv(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"zoomIn",function(){!s.disabled&&s.mapsService.getZoom()<s.mapsService.getMaxZoom()&&s.mapsService.zoomIn()}),(0,W.Z)((0,st.Z)(s),"zoomOut",function(){!s.disabled&&s.mapsService.getZoom()>s.mapsService.getMinZoom()&&s.mapsService.zoomOut()}),(0,W.Z)((0,st.Z)(s),"updateDisabled",function(){var m=s.mapsService;s.zoomInButton.removeAttribute("disabled"),s.zoomOutButton.removeAttribute("disabled"),(s.disabled||m.getZoom()<=m.getMinZoom())&&s.zoomOutButton.setAttribute("disabled","true"),(s.disabled||m.getZoom()>=m.getMaxZoom())&&s.zoomInButton.setAttribute("disabled","true")}),s}return(0,tt.Z)(a,[{key:"getDefault",value:function(o){return(0,K.Z)((0,K.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{position:Vl.BOTTOMRIGHT,name:"zoom",zoomInText:Yd("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:Yd("l7-icon-narrow"),zoomOutTitle:"Zoom out"})}},{key:"setOptions",value:function(o){$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),this.checkUpdateOption(o,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle"])&&this.resetButtonGroup(this.container)}},{key:"onAdd",value:function(){var o=_t("div","l7-control-zoom");return this.resetButtonGroup(o),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),o}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"resetButtonGroup",value:function(o){iu(o),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",o,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",o,this.zoomOut),this.updateDisabled()}},{key:"createButton",value:function(o,h,v,m,E){var A=_t("button",v,m);return typeof o=="string"?A.innerHTML=o:A.append(o),A.title=h,A.addEventListener("click",E),A}}]),a}(v0);function u3(n){var l=Bv();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Bv(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var l3=function(n){(0,Ut.Z)(a,n);var l=u3(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"update",function(){var m=s.mapsService,E=s.controlOption.maxWidth,A=m.getSize()[1]/2,F=m.containerToLngLat([0,A]),B=m.containerToLngLat([E,A]),V=Ts([F.lng,F.lat],[B.lng,B.lat]);s.updateScales(V)}),s}return(0,tt.Z)(a,[{key:"getDefault",value:function(o){return(0,K.Z)((0,K.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{name:"scale",position:Vl.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}},{key:"onAdd",value:function(){var o="l7-control-scale",h=_t("div",o);this.resetScaleLines(h);var v=this.controlOption.updateWhenIdle;return this.mapsService.on(v?"moveend":"mapmove",this.update),this.mapsService.on(v?"zoomend":"zoomchange",this.update),h}},{key:"onRemove",value:function(){var o=this.controlOption.updateWhenIdle;this.mapsService.off(o?"zoomend":"zoomchange",this.update),this.mapsService.off(o?"moveend":"mapmove",this.update)}},{key:"setOptions",value:function(o){$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),this.checkUpdateOption(o,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}},{key:"updateScales",value:function(o){var h=this.controlOption,v=h.metric,m=h.imperial;v&&o&&this.updateMetric(o),m&&o&&this.updateImperial(o)}},{key:"resetScaleLines",value:function(o){iu(o);var h=this.controlOption,v=h.metric,m=h.imperial,E=h.maxWidth,A=h.lockWidth;A&&Ao(o,"width: ".concat(E,"px")),v&&(this.mScale=_t("div","l7-control-scale-line",o)),m&&(this.iScale=_t("div","l7-control-scale-line",o)),this.update()}},{key:"updateScale",value:function(o,h,v){var m=this.controlOption.maxWidth;o.style.width=Math.round(m*v)+"px",o.innerHTML=h}},{key:"getRoundNum",value:function(o){var h=Math.pow(10,(Math.floor(o)+"").length-1),v=o/h;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,h*v}},{key:"updateMetric",value:function(o){var h=this.getRoundNum(o),v=h<1e3?h+" m":h/1e3+" km";this.updateScale(this.mScale,v,h/o)}},{key:"updateImperial",value:function(o){var h=o*3.2808399,v,m,E;h>5280?(v=h/5280,m=this.getRoundNum(v),this.updateScale(this.iScale,m+" mi",m/v)):(E=this.getRoundNum(h),this.updateScale(this.iScale,E+" ft",E/h))}}]),a}(v0);function NE(n){var l=zE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function zE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var c3=function(n){(0,Ut.Z)(a,n);var l=NE(a);function a(s){var o;(0,lt.Z)(this,a),o=l.call(this),(0,W.Z)((0,st.Z)(o),"isShow",!0),(0,W.Z)((0,st.Z)(o),"onMouseMove",function(v){var m,E=o.mapsService.getMapContainer(),A=(m=E==null?void 0:E.getBoundingClientRect())!==null&&m!==void 0?m:{},F=A.left,B=F===void 0?0:F,V=A.top,j=V===void 0?0:V;o.setPopupPosition(v.clientX-B,v.clientY-j)}),(0,W.Z)((0,st.Z)(o),"updateLngLatPosition",function(){if(!(!o.mapsService||o.popupOption.followCursor)){var v=o.lngLat,m=v.lng,E=v.lat,A=o.mapsService.lngLatToContainer([m,E]),F=A.x,B=A.y;o.setPopupPosition(F,B)}}),(0,W.Z)((0,st.Z)(o),"onKeyDown",function(v){v.keyCode===27&&o.remove()}),(0,W.Z)((0,st.Z)(o),"onCloseButtonClick",function(v){v.stopPropagation&&v.stopPropagation(),o.hide()}),(0,W.Z)((0,st.Z)(o),"update",function(){var v=!!o.lngLat,m=o.popupOption,E=m.className,A=m.style,F=m.maxWidth,B=m.anchor,V=m.stopPropagation;if(!(!o.mapsService||!v||!o.content)){var j=o.mapsService.getMarkerContainer();if(!o.container&&j&&(o.container=_t("div","l7-popup ".concat(E!=null?E:""," ").concat(o.isShow?"":"l7-popup-hide"),j),A&&o.container.setAttribute("style",A),o.tip=_t("div","l7-popup-tip",o.container),o.container.appendChild(o.content),V&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(mt){o.container.addEventListener(mt,function(Bt){Bt.stopPropagation()})}),o.container.style.whiteSpace="nowrap"),o.updateLngLatPosition(),$i(o.container,"".concat(xr[B])),Pr(o.container,B,"popup"),F){var nt=o.container.getBoundingClientRect(),at=nt.width;at>parseFloat(F)&&(o.container.style.width=F)}else o.container.style.removeProperty("width")}}),o.popupOption=(0,K.Z)((0,K.Z)({},o.getDefault(s!=null?s:{})),s);var h=o.popupOption.lngLat;return h&&(o.lngLat=h),o}return(0,tt.Z)(a,[{key:"lngLat",get:function(){var o;return(o=this.popupOption.lngLat)!==null&&o!==void 0?o:{lng:0,lat:0}},set:function(o){this.popupOption.lngLat=o}},{key:"getIsShow",value:function(){return this.isShow}},{key:"addTo",value:function(o){this.mapsService=o.get(Dt.IMapService),this.sceneService=o.get(Dt.ISceneService),this.layerService=o.get(Dt.ILayerService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=o,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();var h=this.popupOption,v=h.html,m=h.text,E=h.title;return v?this.setHTML(v):m&&this.setText(m),E&&this.setTitle(E),this.emit("open"),this}},{key:"remove",value:function(){if(!!(this!==null&&this!==void 0&&this.isOpen()))return this.content&&rt(this.content),this.container&&(rt(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}},{key:"getOptions",value:function(){return this.popupOption}},{key:"setOptions",value:function(o){return this.show(),this.popupOption=(0,K.Z)((0,K.Z)({},this.popupOption),o),this.checkUpdateOption(o,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","className","style","lngLat","offsets"])&&(this.container&&(rt(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(o,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(o,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(o,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(o,["html"])&&o.html?this.setHTML(o.html):this.checkUpdateOption(o,["text"])&&o.text&&this.setText(o.text),this.checkUpdateOption(o,["lngLat"])&&o.lngLat&&this.setLnglat(o.lngLat),this}},{key:"open",value:function(){return this.addTo(this.scene),this}},{key:"close",value:function(){return this.remove(),this}},{key:"show",value:function(){if(!this.isShow)return this.container&&Ze(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}},{key:"hide",value:function(){if(!!this.isShow)return this.container&&se(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}},{key:"setHTML",value:function(o){return this.popupOption.html=o,this.setDOMContent(o)}},{key:"setText",value:function(o){return this.popupOption.text=o,this.setDOMContent(window.document.createTextNode(o))}},{key:"setTitle",value:function(o){this.show(),this.popupOption.title=o,o?(this.contentTitle||(this.contentTitle=_t("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),iu(this.contentTitle),$s(this.contentTitle,o)):this.contentTitle&&(rt(this.contentTitle),this.contentTitle=void 0)}},{key:"panToPopup",value:function(){var o=this.lngLat,h=o.lng,v=o.lat;return this.popupOption.autoPan&&this.mapsService.panTo([h,v]),this}},{key:"setLngLat",value:function(o){return this.setLnglat(o)}},{key:"setLnglat",value:function(o){var h=this;return this.show(),this.lngLat=o,Array.isArray(o)&&(this.lngLat={lng:o[0],lat:o[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(function(){h.panToPopup()},0),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setMaxWidth",value:function(o){return this.popupOption.maxWidth=o,this.update(),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"getDefault",value:function(o){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:rr.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}},{key:"setDOMContent",value:function(o){return this.show(),this.createContent(),$s(this.contentPanel,o),this.update(),this}},{key:"updateCloseOnClick",value:function(o){var h=this,v=this.mapsService;v&&(v==null||v.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!o&&requestAnimationFrame(function(){v==null||v.on("click",h.onCloseButtonClick)}))}},{key:"updateCloseOnEsc",value:function(o){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!o&&window.addEventListener("keydown",this.onKeyDown)}},{key:"updateFollowCursor",value:function(o){var h,v=(h=this.mapsService)===null||h===void 0?void 0:h.getContainer();v&&(v==null||v.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!o&&(v==null||v.addEventListener("mousemove",this.onMouseMove)))}},{key:"createContent",value:function(){var o=this;if(this.content&&rt(this.content),this.contentTitle=void 0,this.content=_t("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){var h=Yd("l7-icon-guanbi");se(h,"l7-popup-close-button"),this.content.appendChild(h),this.popupOption.closeButtonOffsets&&(h.style.right=this.popupOption.closeButtonOffsets[0]+"px",h.style.top=this.popupOption.closeButtonOffsets[1]+"px"),h.setAttribute("aria-label","Close popup"),h.addEventListener("click",function(){o.hide()}),this.closeButton=h}else this.closeButton=void 0;this.contentPanel=_t("div","l7-popup-content__panel",this.content)}},{key:"setPopupPosition",value:function(o,h){if(this.container){var v=this.popupOption.offsets;this.container.style.left=o+v[0]+"px",this.container.style.top=h-v[1]+"px"}}},{key:"checkUpdateOption",value:function(o,h){return h.some(function(v){return v in o})}}]),a}(Ee.EventEmitter);function f3(n){var l=FO();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function FO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var h3=function(n){(0,Ut.Z)(a,n);var l=f3(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"layerConfigMap",new WeakMap),s}return(0,tt.Z)(a,[{key:"layerConfigItems",get:function(){var o,h=this.popupOption,v=h.config,m=h.items;return(o=v!=null?v:m)!==null&&o!==void 0?o:[]}},{key:"addTo",value:function(o){return $o((0,b.Z)(a.prototype),"addTo",this).call(this,o),this.bindLayerEvent(),this.hide(),this}},{key:"remove",value:function(){return $o((0,b.Z)(a.prototype),"remove",this).call(this),this.unbindLayerEvent(),this}},{key:"setOptions",value:function(o){return this.unbindLayerEvent(),$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),this.bindLayerEvent(),this}},{key:"getDefault",value:function(o){var h=o.trigger==="click";return(0,K.Z)((0,K.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{trigger:"hover",followCursor:!h,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!1,autoClose:!1,closeOnEsc:!1})}},{key:"bindLayerEvent",value:function(){var o=this,h=this.popupOption.trigger;this.layerConfigItems.forEach(function(v){var m,E=o.getLayerByConfig(v);if(!!E){var A=(0,K.Z)({},v);if(h==="hover"){var F=o.onLayerMouseMove.bind(o,E),B=o.onLayerMouseOut.bind(o,E);A.onMouseMove=F,A.onMouseOut=B,E==null||E.on("mousemove",F),E==null||E.on("mouseout",B)}else{var V=o.onLayerClick.bind(o,E);A.onClick=V,E==null||E.on("click",V)}var j=E==null||(m=E.getSource)===null||m===void 0?void 0:m.call(E),nt=o.onSourceUpdate.bind(o,E);j==null||j.on("update",nt),A.onSourceUpdate=nt,o.layerConfigMap.set(E,A)}})}},{key:"unbindLayerEvent",value:function(){var o=this;this.layerConfigItems.forEach(function(h){var v=o.getLayerByConfig(h),m=v&&o.layerConfigMap.get(v);if(!!m){var E=m.onMouseMove,A=m.onMouseOut,F=m.onClick,B=m.onSourceUpdate;if(E&&v.off("mousemove",E),A&&v.off("mouseout",A),F&&v.off("click",F),B){var V;v==null||(V=v.getSource())===null||V===void 0||V.off("update",B)}}})}},{key:"onLayerMouseMove",value:function(o,h){if(!this.isSameFeature(o,h.featureId)){var v=this.getLayerInfoFrag(o,h),m=v.title,E=v.content;this.setDOMContent(E),this.setTitle(m),this.displayFeatureInfo={layer:o,featureId:h.featureId},this.show()}}},{key:"onLayerMouseOut",value:function(o,h){this.displayFeatureInfo=void 0,this.isShow&&this.hide()}},{key:"onLayerClick",value:function(o,h){if(this.isShow&&this.isSameFeature(o,h.featureId))this.hide();else{var v=this.getLayerInfoFrag(o,h),m=v.title,E=v.content;this.setDOMContent(E),this.setLnglat(h.lngLat),this.setTitle(m),this.displayFeatureInfo={layer:o,featureId:h.featureId},this.show()}}},{key:"onSourceUpdate",value:function(o){var h;((h=this.displayFeatureInfo)===null||h===void 0?void 0:h.layer)===o&&(this.hide(),this.displayFeatureInfo=void 0)}},{key:"getLayerInfoFrag",value:function(o,h){var v=this.layerConfigMap.get(o),m,E=document.createDocumentFragment();if(v){var A=h.feature;A.type==="Feature"&&"properties"in A&&"geometry"in A&&(A=A.properties);var F=v.title,B=v.fields,V=v.customContent;if(F){m=document.createDocumentFragment();var j=F instanceof Function?F(A):F;$s(m,j)}if(V){var nt=V instanceof Function?V(A):V;$s(E,nt)}else B!=null&&B.length&&(B==null||B.forEach(function(at){var mt,Bt,de=typeof at=="string"?{field:at}:at,ce=de.field,Be=de.formatField,Xe=de.formatValue,_r=de.getValue,Ir=_t("div","l7-layer-popup__row"),Nr=_r?_r(h.feature):(0,te.get)(A,ce),Yr=(mt=Be instanceof Function?Be(ce,A):Be)!==null&&mt!==void 0?mt:ce,yn=(Bt=Xe instanceof Function?Xe(Nr,A):Xe)!==null&&Bt!==void 0?Bt:Nr,fn=_t("span","l7-layer-popup__key",Ir);$s(fn,Yr),$s(fn,document.createTextNode("\uFF1A"));var $n=_t("span","l7-layer-popup__value",Ir);$s($n,yn),E.appendChild(Ir)}))}return{title:m,content:E}}},{key:"getLayerByConfig",value:function(o){var h=o.layer;if(h instanceof Object)return h;if(typeof h=="string")return this.layerService.getLayer(h)||this.layerService.getLayerByName(h)}},{key:"isSameFeature",value:function(o,h){var v=this.displayFeatureInfo;return v&&o===v.layer&&h===v.featureId}}]),a}(c3);function _y(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var o=l.head||l.getElementsByTagName("head")[0];if(!o){o=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(o,h):l.documentElement.appendChild(o)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),o.appendChild(v),v}}_y(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 800;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  height: 24px;
  line-height: 24px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 16px;
  font-size: 12px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  height: 14px;
  width: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  padding: 12px 12px 0 12px;
  width: 474px;
  height: 320px;
  overflow: auto;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-select-control--image .l7-select-control-item {
  margin-right: 12px;
  border-radius: 2px;
  overflow: hidden;
  border: 1px solid #fff;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  width: calc((100% - 36px) / 3);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  margin-bottom: 12px;
  position: relative;
  font-size: 12px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 142px;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  right: 0;
  top: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control--image .l7-select-control-item:nth-child(3n) {
  margin-right: 0;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  overflow: hidden;
}
.l7-control-zoom .l7-button-control {
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
  border-radius: 0;
  font-size: 16px;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:first-child {
  border-bottom: 1px solid #f0f0f0;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
`);var UE={},ZE={},VE=function(l){return ZE[l]},nd=function(l,a){ZE[l]=a},xy=function(l){return UE[l]},g0=function(l,a){UE[l]=a},GE={},L1={},P1=34,nm=10,O1=13;function HE(n){return new Function("d","return {"+n.map(function(l,a){return JSON.stringify(l)+": d["+a+'] || ""'}).join(",")+"}")}function p3(n,l){var a=HE(n);return function(s,o){return l(a(s),o,n)}}function jE(n){var l=Object.create(null),a=[];return n.forEach(function(s){for(var o in s)o in l||a.push(l[o]=o)}),a}function Ff(n,l){var a=n+"",s=a.length;return s<l?new Array(l-s+1).join(0)+a:a}function WE(n){return n<0?"-"+Ff(-n,6):n>9999?"+"+Ff(n,6):Ff(n,4)}function v3(n){var l=n.getUTCHours(),a=n.getUTCMinutes(),s=n.getUTCSeconds(),o=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":WE(n.getUTCFullYear(),4)+"-"+Ff(n.getUTCMonth()+1,2)+"-"+Ff(n.getUTCDate(),2)+(o?"T"+Ff(l,2)+":"+Ff(a,2)+":"+Ff(s,2)+"."+Ff(o,3)+"Z":s?"T"+Ff(l,2)+":"+Ff(a,2)+":"+Ff(s,2)+"Z":a||l?"T"+Ff(l,2)+":"+Ff(a,2)+"Z":"")}function g3(n){var l=new RegExp('["'+n+`
\r]`),a=n.charCodeAt(0);function s(B,V){var j,nt,at=o(B,function(mt,Bt){if(j)return j(mt,Bt-1);nt=mt,j=V?p3(mt,V):HE(mt)});return at.columns=nt||[],at}function o(B,V){var j=[],nt=B.length,at=0,mt=0,Bt,de=nt<=0,ce=!1;B.charCodeAt(nt-1)===nm&&--nt,B.charCodeAt(nt-1)===O1&&--nt;function Be(){if(de)return L1;if(ce)return ce=!1,GE;var _r,Ir=at,Nr;if(B.charCodeAt(Ir)===P1){for(;at++<nt&&B.charCodeAt(at)!==P1||B.charCodeAt(++at)===P1;);return(_r=at)>=nt?de=!0:(Nr=B.charCodeAt(at++))===nm?ce=!0:Nr===O1&&(ce=!0,B.charCodeAt(at)===nm&&++at),B.slice(Ir+1,_r-1).replace(/""/g,'"')}for(;at<nt;){if((Nr=B.charCodeAt(_r=at++))===nm)ce=!0;else if(Nr===O1)ce=!0,B.charCodeAt(at)===nm&&++at;else if(Nr!==a)continue;return B.slice(Ir,_r)}return de=!0,B.slice(Ir,nt)}for(;(Bt=Be())!==L1;){for(var Xe=[];Bt!==GE&&Bt!==L1;)Xe.push(Bt),Bt=Be();V&&(Xe=V(Xe,mt++))==null||j.push(Xe)}return j}function h(B,V){return B.map(function(j){return V.map(function(nt){return F(j[nt])}).join(n)})}function v(B,V){return V==null&&(V=jE(B)),[V.map(F).join(n)].concat(h(B,V)).join(`
`)}function m(B,V){return V==null&&(V=jE(B)),h(B,V).join(`
`)}function E(B){return B.map(A).join(`
`)}function A(B){return B.map(F).join(n)}function F(B){return B==null?"":B instanceof Date?v3(B):l.test(B+="")?'"'+B.replace(/"/g,'""')+'"':B}return{parse:s,parseRows:o,format:v,formatBody:m,formatRows:E,formatRow:A,formatValue:F}}var m0=g3(","),m3=m0.parse,RO=m0.parseRows,XE=m0.format,y3=m0.formatBody,DO=m0.formatRows,YE=m0.formatRow,BO=m0.formatValue,_3=ot(38163),F1=ot.n(_3);function NO(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function $E(n){if(Array.isArray(n))return n;if(n.type==="Feature"){if(n.geometry!==null)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function R1(n){if(n.length>1&&isNumber(n[0])&&isNumber(n[1]))return!0;if(Array.isArray(n[0])&&n[0].length)return R1(n[0]);throw new Error("coordinates must only contain numbers")}function zO(n,l,a){if(!l||!a)throw new Error("type and name required");if(!n||n.type!==l)throw new Error("Invalid input to "+a+": must be a "+l+", given "+n.type)}function UO(n,l,a){if(!n)throw new Error("No feature passed");if(!a)throw new Error(".featureOf() requires a name");if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!n.geometry||n.geometry.type!==l)throw new Error("Invalid input to "+a+": must be a "+l+", given "+n.geometry.type)}function ZO(n,l,a){if(!n)throw new Error("No featureCollection passed");if(!a)throw new Error(".collectionOf() requires a name");if(!n||n.type!=="FeatureCollection")throw new Error("Invalid input to "+a+", FeatureCollection required");for(var s=0,o=n.features;s<o.length;s++){var h=o[s];if(!h||h.type!=="Feature"||!h.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!h.geometry||h.geometry.type!==l)throw new Error("Invalid input to "+a+": must be a "+l+", given "+h.geometry.type)}}function by(n){return n.type==="Feature"?n.geometry:n}function VO(n,l){return n.type==="FeatureCollection"?"FeatureCollection":n.type==="GeometryCollection"?"GeometryCollection":n.type==="Feature"&&n.geometry!==null?n.geometry.type:n.type}function qE(n,l){var a=l.x,s=l.y,o=l.x1,h=l.y1,v=l.coordinates,m=l.geometry,E=[];if(!Array.isArray(n))return{dataArray:[]};if(m)return n.filter(function(Bt){return Bt[m]&&Bt[m].type&&Bt[m].coordinates&&Bt[m].coordinates.length>0}).forEach(function(Bt,de){var ce=F1()((0,K.Z)({},Bt[m]),!0);as(ce,function(Be){var Xe=$E(Be),_r=(0,K.Z)((0,K.Z)({},Bt),{},{_id:de,coordinates:Xe});E.push(_r)})}),{dataArray:E};for(var A=0;A<n.length;A++){var F=n[A],B=[];if(v){var V="Polygon";Array.isArray(v[0])||(V="Point"),Array.isArray(v[0])&&!Array.isArray(v[0][0])&&(V="LineString");var j=F1()({type:V,coordinates:(0,ge.Z)(F[v])},!0);B=j.coordinates}else if(a&&s&&o&&h){var nt=[parseFloat(F[a]),parseFloat(F[s])],at=[parseFloat(F[o]),parseFloat(F[h])];B=[nt,at]}else a&&s&&(B=[parseFloat(F[a]),parseFloat(F[s])]);var mt=(0,K.Z)((0,K.Z)({},F),{},{_id:A,coordinates:B});E.push(mt)}return{dataArray:E}}function im(n,l){var a=m3(n);return qE(a,l)}function am(n){for(var l=n.toString(),a=5381,s=l.length;s;)a=a*33^l.charCodeAt(--s);return a>>>0}function D1(n,l){return l===void 0?null:n.properties[l]?n.properties[l]:n.properties&&n.properties[l]?am(n.properties[l]+"")%1000019:null}function KE(n,l){var a=[],s={};return n.features?(n.features=n.features.filter(function(o){var h=o.geometry;return o!=null&&h&&h.type&&h.coordinates&&h.coordinates.length>0}),F1()(n,!0),n.features.length===0?{dataArray:[],featureKeys:s}:(as(n,function(o,h){var v=D1(o,l==null?void 0:l.featureId);v===null&&(v=h);var m=v,E=$E(o),A=(0,K.Z)((0,K.Z)({},o.properties),{},{coordinates:E,_id:m});a.push(A)}),{dataArray:a,featureKeys:s})):(n.features=[],{dataArray:[]})}function Nv(n,l){var a=l.extent,s=a===void 0?[121.168,30.2828,121.384,30.4219]:a,o=new Promise(function(v){n instanceof HTMLImageElement||Wp(n)?v([n]):$d(n,function(m){v(m)})}),h={originData:n,images:o,_id:1,dataArray:[{_id:0,coordinates:[[s[0],s[1]],[s[2],s[3]]]}]};return h}function $d(n,l){var a=n,s=[];if(typeof a=="string")vl({url:a},function(v,m){m&&(s.push(m),l(s))});else{var o=a.length,h=0;a.forEach(function(v){vl({url:v},function(m,E){h++,E&&s.push(E),h===o&&l(s)})})}return Nv}var x3=ot(38929),B1=ot(3614),b3=ot.n(B1),E3=function(){function n(l,a,s,o){(0,lt.Z)(this,n),(0,W.Z)(this,"vectorLayerCache",{}),this.x=a,this.y=s,this.z=o,this.vectorTile=new x3.VectorTile(new(b3())(l))}return(0,tt.Z)(n,[{key:"getTileData",value:function(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];var s=this.vectorTile.layers[a];if(Array.isArray(s.features))return this.vectorLayerCache[a]=s.features,s.features;for(var o=[],h=0;h<s.length;h++){var v=s.feature(h),m=v.toGeoJSON(this.x,this.y,this.z);o.push((0,K.Z)((0,K.Z)({},m),{},{properties:(0,K.Z)({id:m.id},m.properties)}))}return this.vectorLayerCache[a]=o,o}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),n}(),S3={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},w3=function(){var n=(0,ut.Z)(it().mark(function l(a,s,o,h){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=Bd(a,s),E.abrupt("return",new Promise(function(A){var F=Gc((0,K.Z)((0,K.Z)({},h),{},{url:v}),function(B,V){if(B||!V)A(void 0);else{var j=new E3(V,o.x,o.y,o.z);A(j)}});o.xhrCancel=function(){return F.abort()}}));case 2:case"end":return E.stop()}},l)}));return function(a,s,o,h){return n.apply(this,arguments)}}();function id(n,l){var a=Array.isArray(n)?n[0]:n,s=function(v,m){return w3(a,v,m,l==null?void 0:l.requestParameters)},o=(0,K.Z)((0,K.Z)((0,K.Z)({},S3),l),{},{getTileData:s});return{data:a,dataArray:[],tilesetOptions:o,isTile:!0}}function N1(n,l,a,s){for(var o=s,h=a-l>>1,v=a-l,m,E=n[l],A=n[l+1],F=n[a],B=n[a+1],V=l+3;V<a;V+=3){var j=QE(n[V],n[V+1],E,A,F,B);if(j>o)m=V,o=j;else if(j===o){var nt=Math.abs(V-h);nt<v&&(m=V,v=nt)}}o>s&&(m-l>3&&N1(n,l,m,s),n[m+2]=o,a-m>3&&N1(n,m,a,s))}function QE(n,l,a,s,o,h){var v=o-a,m=h-s;if(v!==0||m!==0){var E=((n-a)*v+(l-s)*m)/(v*v+m*m);E>1?(a=o,s=h):E>0&&(a+=v*E,s+=m*E)}return v=n-a,m=l-s,v*v+m*m}function om(n,l,a,s){var o={id:typeof n=="undefined"?null:n,type:l,geometry:a,tags:s,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return C3(o),o}function C3(n){var l=n.geometry,a=n.type;if(a==="Point"||a==="MultiPoint"||a==="LineString")z1(n,l);else if(a==="Polygon"||a==="MultiLineString")for(var s=0;s<l.length;s++)z1(n,l[s]);else if(a==="MultiPolygon")for(s=0;s<l.length;s++)for(var o=0;o<l[s].length;o++)z1(n,l[s][o])}function z1(n,l){for(var a=0;a<l.length;a+=3)n.minX=Math.min(n.minX,l[a]),n.minY=Math.min(n.minY,l[a+1]),n.maxX=Math.max(n.maxX,l[a]),n.maxY=Math.max(n.maxY,l[a+1])}function A3(n,l){var a=[];if(n.type==="FeatureCollection")for(var s=0;s<n.features.length;s++)Ey(a,n.features[s],l,s);else n.type==="Feature"?Ey(a,n,l):Ey(a,{geometry:n},l);return a}function Ey(n,l,a,s){if(!!l.geometry){var o=l.geometry.coordinates,h=l.geometry.type,v=Math.pow(a.tolerance/((1<<a.maxZoom)*a.extent),2),m=[],E=l.id;if(a.promoteId?E=l.properties[a.promoteId]:a.generateId&&(E=s||0),h==="Point")JE(o,m);else if(h==="MultiPoint")for(var A=0;A<o.length;A++)JE(o[A],m);else if(h==="LineString")U1(o,m,v,!1);else if(h==="MultiLineString")if(a.lineMetrics){for(A=0;A<o.length;A++)m=[],U1(o[A],m,v,!1),n.push(om(E,"LineString",m,l.properties));return}else Z1(o,m,v,!1);else if(h==="Polygon")Z1(o,m,v,!0);else if(h==="MultiPolygon")for(A=0;A<o.length;A++){var F=[];Z1(o[A],F,v,!0),m.push(F)}else if(h==="GeometryCollection"){for(A=0;A<l.geometry.geometries.length;A++)Ey(n,{id:E,geometry:l.geometry.geometries[A],properties:l.properties},a,s);return}else throw new Error("Input data is not a valid GeoJSON object.");n.push(om(E,h,m,l.properties))}}function JE(n,l){l.push(tS(n[0])),l.push(zv(n[1])),l.push(0)}function U1(n,l,a,s){for(var o,h,v=0,m=0;m<n.length;m++){var E=tS(n[m][0]),A=zv(n[m][1]);l.push(E),l.push(A),l.push(0),m>0&&(s?v+=(o*A-E*h)/2:v+=Math.sqrt(Math.pow(E-o,2)+Math.pow(A-h,2))),o=E,h=A}var F=l.length-3;l[2]=1,N1(l,0,F,a),l[F+2]=1,l.size=Math.abs(v),l.start=0,l.end=l.size}function Z1(n,l,a,s){for(var o=0;o<n.length;o++){var h=[];U1(n[o],h,a,s),l.push(h)}}function tS(n){return n/360+.5}function zv(n){var l=Math.sin(n*Math.PI/180),a=.5-.25*Math.log((1+l)/(1-l))/Math.PI;return a<0?0:a>1?1:a}function qd(n,l,a,s,o,h,v,m){if(a/=l,s/=l,h>=a&&v<s)return n;if(v<a||h>=s)return null;for(var E=[],A=0;A<n.length;A++){var F=n[A],B=F.geometry,V=F.type,j=o===0?F.minX:F.minY,nt=o===0?F.maxX:F.maxY;if(j>=a&&nt<s){E.push(F);continue}else if(nt<a||j>=s)continue;var at=[];if(V==="Point"||V==="MultiPoint")T3(B,at,a,s,o);else if(V==="LineString")V1(B,at,a,s,o,!1,m.lineMetrics);else if(V==="MultiLineString")H1(B,at,a,s,o,!1);else if(V==="Polygon")H1(B,at,a,s,o,!0);else if(V==="MultiPolygon")for(var mt=0;mt<B.length;mt++){var Bt=[];H1(B[mt],Bt,a,s,o,!0),Bt.length&&at.push(Bt)}if(at.length){if(m.lineMetrics&&V==="LineString"){for(mt=0;mt<at.length;mt++)E.push(om(F.id,V,at[mt],F.tags));continue}(V==="LineString"||V==="MultiLineString")&&(at.length===1?(V="LineString",at=at[0]):V="MultiLineString"),(V==="Point"||V==="MultiPoint")&&(V=at.length===3?"Point":"MultiPoint"),E.push(om(F.id,V,at,F.tags))}}return E.length?E:null}function T3(n,l,a,s,o){for(var h=0;h<n.length;h+=3){var v=n[h+o];v>=a&&v<=s&&(l.push(n[h]),l.push(n[h+1]),l.push(n[h+2]))}}function V1(n,l,a,s,o,h,v){for(var m=G1(n),E=o===0?_0:M3,A=n.start,F,B,V=0;V<n.length-3;V+=3){var j=n[V],nt=n[V+1],at=n[V+2],mt=n[V+3],Bt=n[V+4],de=o===0?j:nt,ce=o===0?mt:Bt,Be=!1;v&&(F=Math.sqrt(Math.pow(j-mt,2)+Math.pow(nt-Bt,2))),de<a?ce>a&&(B=E(m,j,nt,mt,Bt,a),v&&(m.start=A+F*B)):de>s?ce<s&&(B=E(m,j,nt,mt,Bt,s),v&&(m.start=A+F*B)):y0(m,j,nt,at),ce<a&&de>=a&&(B=E(m,j,nt,mt,Bt,a),Be=!0),ce>s&&de<=s&&(B=E(m,j,nt,mt,Bt,s),Be=!0),!h&&Be&&(v&&(m.end=A+F*B),l.push(m),m=G1(n)),v&&(A+=F)}var Xe=n.length-3;j=n[Xe],nt=n[Xe+1],at=n[Xe+2],de=o===0?j:nt,de>=a&&de<=s&&y0(m,j,nt,at),Xe=m.length-3,h&&Xe>=3&&(m[Xe]!==m[0]||m[Xe+1]!==m[1])&&y0(m,m[0],m[1],m[2]),m.length&&l.push(m)}function G1(n){var l=[];return l.size=n.size,l.start=n.start,l.end=n.end,l}function H1(n,l,a,s,o,h){for(var v=0;v<n.length;v++)V1(n[v],l,a,s,o,h,!1)}function y0(n,l,a,s){n.push(l),n.push(a),n.push(s)}function _0(n,l,a,s,o,h){var v=(h-l)/(s-l);return n.push(h),n.push(a+(o-a)*v),n.push(1),v}function M3(n,l,a,s,o,h){var v=(h-a)/(o-a);return n.push(l+(s-l)*v),n.push(h),n.push(1),v}function j1(n,l){var a=l.buffer/l.extent,s=n,o=qd(n,1,-1-a,a,0,-1,2,l),h=qd(n,1,1-a,2+a,0,-1,2,l);return(o||h)&&(s=qd(n,1,-a,1+a,0,-1,2,l)||[],o&&(s=eS(o,1).concat(s)),h&&(s=s.concat(eS(h,-1)))),s}function eS(n,l){for(var a=[],s=0;s<n.length;s++){var o=n[s],h=o.type,v;if(h==="Point"||h==="MultiPoint"||h==="LineString")v=W1(o.geometry,l);else if(h==="MultiLineString"||h==="Polygon"){v=[];for(var m=0;m<o.geometry.length;m++)v.push(W1(o.geometry[m],l))}else if(h==="MultiPolygon")for(v=[],m=0;m<o.geometry.length;m++){for(var E=[],A=0;A<o.geometry[m].length;A++)E.push(W1(o.geometry[m][A],l));v.push(E)}a.push(om(o.id,h,v,o.tags))}return a}function W1(n,l){var a=[];a.size=n.size,n.start!==void 0&&(a.start=n.start,a.end=n.end);for(var s=0;s<n.length;s+=3)a.push(n[s]+l,n[s+1],n[s+2]);return a}function rS(n,l){if(n.transformed)return n;var a=1<<n.z,s=n.x,o=n.y,h,v,m;for(h=0;h<n.features.length;h++){var E=n.features[h],A=E.geometry,F=E.type;if(E.geometry=[],F===1)for(v=0;v<A.length;v+=2)E.geometry.push(nS(A[v],A[v+1],l,a,s,o));else for(v=0;v<A.length;v++){var B=[];for(m=0;m<A[v].length;m+=2)B.push(nS(A[v][m],A[v][m+1],l,a,s,o));E.geometry.push(B)}}return n.transformed=!0,n}function nS(n,l,a,s,o,h){return[Math.round(a*(n*s-o)),Math.round(a*(l*s-h))]}function fg(n,l,a,s,o){for(var h=l===o.maxZoom?0:o.tolerance/((1<<l)*o.extent),v={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:a,y:s,z:l,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},m=0;m<n.length;m++){v.numFeatures++,Sy(v,n[m],h,o);var E=n[m].minX,A=n[m].minY,F=n[m].maxX,B=n[m].maxY;E<v.minX&&(v.minX=E),A<v.minY&&(v.minY=A),F>v.maxX&&(v.maxX=F),B>v.maxY&&(v.maxY=B)}return v}function Sy(n,l,a,s){var o=l.geometry,h=l.type,v=[];if(h==="Point"||h==="MultiPoint")for(var m=0;m<o.length;m+=3)v.push(o[m]),v.push(o[m+1]),n.numPoints++,n.numSimplified++;else if(h==="LineString")X1(v,o,n,a,!1,!1);else if(h==="MultiLineString"||h==="Polygon")for(m=0;m<o.length;m++)X1(v,o[m],n,a,h==="Polygon",m===0);else if(h==="MultiPolygon")for(var E=0;E<o.length;E++){var A=o[E];for(m=0;m<A.length;m++)X1(v,A[m],n,a,!0,m===0)}if(v.length){var F=l.tags||null;if(h==="LineString"&&s.lineMetrics){F={};for(var B in l.tags)F[B]=l.tags[B];F.mapbox_clip_start=o.start/o.size,F.mapbox_clip_end=o.end/o.size}var V={geometry:v,type:h==="Polygon"||h==="MultiPolygon"?3:h==="LineString"||h==="MultiLineString"?2:1,tags:F};l.id!==null&&(V.id=l.id),n.features.push(V)}}function X1(n,l,a,s,o,h){var v=s*s;if(s>0&&l.size<(o?v:s)){a.numPoints+=l.length/3;return}for(var m=[],E=0;E<l.length;E+=3)(s===0||l[E+2]>v)&&(a.numSimplified++,m.push(l[E]),m.push(l[E+1])),a.numPoints++;o&&I3(m,h),n.push(m)}function I3(n,l){for(var a=0,s=0,o=n.length,h=o-2;s<o;h=s,s+=2)a+=(n[s]-n[h])*(n[s+1]+n[h+1]);if(a>0===l)for(s=0,o=n.length;s<o/2;s+=2){var v=n[s],m=n[s+1];n[s]=n[o-2-s],n[s+1]=n[o-1-s],n[o-2-s]=v,n[o-1-s]=m}}function hg(n,l){return new wy(n,l)}function wy(n,l){l=this.options=iS(Object.create(this.options),l);var a=l.debug;if(a&&console.time("preprocess data"),l.maxZoom<0||l.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(l.promoteId&&l.generateId)throw new Error("promoteId and generateId cannot be used together.");var s=A3(n,l);this.tiles={},this.tileCoords=[],a&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",l.indexMaxZoom,l.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),s=j1(s,l),s.length&&this.splitTile(s,0,0,0),a&&(s.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}wy.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},wy.prototype.splitTile=function(n,l,a,s,o,h,v){for(var m=[n,l,a,s],E=this.options,A=E.debug;m.length;){s=m.pop(),a=m.pop(),l=m.pop(),n=m.pop();var F=1<<l,B=Y1(l,a,s),V=this.tiles[B];if(!V&&(A>1&&console.time("creation"),V=this.tiles[B]=fg(n,l,a,s,E),this.tileCoords.push({z:l,x:a,y:s}),A)){A>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",l,a,s,V.numFeatures,V.numPoints,V.numSimplified),console.timeEnd("creation"));var j="z"+l;this.stats[j]=(this.stats[j]||0)+1,this.total++}if(V.source=n,o){if(l===E.maxZoom||l===o)continue;var nt=1<<o-l;if(a!==Math.floor(h/nt)||s!==Math.floor(v/nt))continue}else if(l===E.indexMaxZoom||V.numPoints<=E.indexMaxPoints)continue;if(V.source=null,n.length!==0){A>1&&console.time("clipping");var at=.5*E.buffer/E.extent,mt=.5-at,Bt=.5+at,de=1+at,ce,Be,Xe,_r,Ir,Nr;ce=Be=Xe=_r=null,Ir=qd(n,F,a-at,a+Bt,0,V.minX,V.maxX,E),Nr=qd(n,F,a+mt,a+de,0,V.minX,V.maxX,E),n=null,Ir&&(ce=qd(Ir,F,s-at,s+Bt,1,V.minY,V.maxY,E),Be=qd(Ir,F,s+mt,s+de,1,V.minY,V.maxY,E),Ir=null),Nr&&(Xe=qd(Nr,F,s-at,s+Bt,1,V.minY,V.maxY,E),_r=qd(Nr,F,s+mt,s+de,1,V.minY,V.maxY,E),Nr=null),A>1&&console.timeEnd("clipping"),m.push(ce||[],l+1,a*2,s*2),m.push(Be||[],l+1,a*2,s*2+1),m.push(Xe||[],l+1,a*2+1,s*2),m.push(_r||[],l+1,a*2+1,s*2+1)}}},wy.prototype.getTile=function(n,l,a){var s=this.options,o=s.extent,h=s.debug;if(n<0||n>24)return null;var v=1<<n;l=(l%v+v)%v;var m=Y1(n,l,a);if(this.tiles[m])return rS(this.tiles[m],o);h>1&&console.log("drilling down to z%d-%d-%d",n,l,a);for(var E=n,A=l,F=a,B;!B&&E>0;)E--,A=Math.floor(A/2),F=Math.floor(F/2),B=this.tiles[Y1(E,A,F)];return!B||!B.source?null:(h>1&&console.log("found parent tile z%d-%d-%d",E,A,F),h>1&&console.time("drilling down"),this.splitTile(B.source,E,A,F,n,l,a),h>1&&console.timeEnd("drilling down"),this.tiles[m]?rS(this.tiles[m],o):null)};function Y1(n,l,a){return((1<<n)*a+l)*32+n}function iS(n,l){for(var a in l)n[a]=l[a];return n}var $1=function(){function n(l,a,s,o){(0,lt.Z)(this,n),(0,W.Z)(this,"vectorLayerCache",{}),this.x=a,this.y=s,this.z=o,this.vectorTile=l}return(0,tt.Z)(n,[{key:"getTileData",value:function(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];var s=this.vectorTile.layers[a];return s.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),n}(),k3={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function L3(n){for(var l=0,a=0,s=n.length,o=s-1,h,v;a<s;o=a++)h=n[a],v=n[o],l+=(v.x-h.x)*(h.y+v.y);return l}function P3(n){var l=n.length;if(l<=1)return[n];for(var a=[],s,o,h=0;h<l;h++){var v=L3(n[h]);v!==0&&(o===void 0&&(o=v<0),o===v<0?(s&&a.push(s),s=[n[h]]):s.push(n[h]))}return s&&a.push(s),a}var q1=["Unknown","Point","LineString","Polygon"];function O3(n,l,a,s,o){var h=o.geometry,v=o.type,m=o.tags,E=o.id,A=n*Math.pow(2,s),F=n*l,B=n*a,V=q1[v],j,nt;function at(de){for(var ce=0;ce<de.length;ce++){var Be=de[ce];if(Be[3])break;var Xe=180-(Be[1]+B)*360/A,_r=(Be[0]+F)*360/A-180,Ir=360/Math.PI*Math.atan(Math.exp(Xe*Math.PI/180))-90;de[ce]=[_r,Ir,0,1]}}switch(v){case 1:var mt=[];for(j=0;j<h.length;j++)mt[j]=h[j][0];h=mt,at(h);break;case 2:for(j=0;j<h.length;j++)at(h[j]);break;case 3:for(h=P3(h),j=0;j<h.length;j++)for(nt=0;nt<h[j].length;nt++)at(h[j][nt]);break}h.length===1?h=h[0]:V="Multi"+V;var Bt={type:"Feature",geometry:{type:V,coordinates:h},properties:m,id:E,tileOrigin:[0,0],coord:""};return Bt}var F3=function(){var n=(0,ut.Z)(it().mark(function l(a,s,o,h){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",new Promise(function(E){var A=s.getTile(a.z,a.x,a.y),F=A?A.features.map(function(j){return O3(h,o.x,o.y,o.z,j)}):[],B={layers:{defaultLayer:{features:F}}},V=new $1(B,a.x,a.y,a.z);E(V)}));case 1:case"end":return m.stop()}},l)}));return function(a,s,o,h){return n.apply(this,arguments)}}();function R3(n){var l={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return n===void 0||typeof n.geojsonvtOptions=="undefined"?l:(0,K.Z)((0,K.Z)({},l),n.geojsonvtOptions)}function aS(n,l){var a=R3(l),s=a.extent||4096,o=hg(n,a),h=function(E,A){return F3(A,o,E,s)},v=(0,K.Z)((0,K.Z)((0,K.Z)({},k3),l),{},{getTileData:h});return{data:n,dataArray:[],tilesetOptions:v,isTile:!0}}function oS(n,l,a){switch(n){case"+":return l+a;case"-":return l-a;case"*":return l*a;case"/":return l/a;case"%":return l%a;case"^":return Math.pow(l,a);case"abs":return Math.abs(l);case"floor":return Math.floor(l);case"round":return Math.round(l);case"ceil":return Math.ceil(l);case"sin":return Math.sin(l);case"cos":return Math.cos(l);case"atan":return a===-1?Math.atan(l):Math.atan2(l,a);default:return console.warn("Calculate symbol err! Return default 0"),0}}function sm(n,l){for(var a=l[0],s=a.width,o=a.height,h=l.map(function(j){return j.rasterData}),v=s*o,m=[],E=JSON.stringify(n),A=0;A<v;A++){var F=JSON.parse(E),B=K1(F,h,A);if(typeof B=="number")m.push(B);else{var V=Cy(F);m.push(V)}}return m}function K1(n,l,a){if(n.length===2&&n[0]==="band"&&typeof n[1]=="number")try{return l[n[1]][a]}catch(s){return console.warn("Raster Data err!"),0}n.map(function(s,o){if(Array.isArray(s)&&s.length>0)switch(s[0]){case"band":try{n[o]=l[s[1]][a]}catch(h){console.warn("Raster Data err!"),n[o]=0}break;default:K1(s,l,a)}})}function D3(n){var l=(0,ht.Z)(n,3),a=l[0],s=l[1],o=s===void 0?-1:s,h=l[2],v=h===void 0?-1:h;if(a===void 0)return console.warn("Express err!"),["+",0,0];var m=a.replace(/\s+/g,"");return[m,o,v]}function Cy(n){var l=D3(n),a=l[0],s=l[1],o=l[2];return Array.isArray(s)&&(s=Cy(n[1])),Array.isArray(o)&&(o=Cy(n[2])),oS(a,s,o)}var B3={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:N3}};function N3(n,l){for(var a=n[0].rasterData,s=n[1].rasterData,o=n[2].rasterData,h=[],v=(l==null?void 0:l.countCut)||[2,98],m=(0,ht.Z)(v,2),E=m[0],A=m[1],F=(l==null?void 0:l.RMinMax)||Q1(a,E,A),B=(l==null?void 0:l.GMinMax)||Q1(s,E,A),V=(l==null?void 0:l.BMinMax)||Q1(o,E,A),j=0;j<a.length;j++)h.push(Math.max(0,a[j]-F[0])),h.push(Math.max(0,s[j]-B[0])),h.push(Math.max(0,o[j]-V[0]));return{rasterData:h,rMinMax:F,gMinMax:B,bMinMax:V}}function Q1(n,l,a){var s=n.slice().sort(function(m,E){return m-E}),o=s.length,h=s[Math.ceil(o*l/100)],v=s[Math.ceil(o*a/100)];return[h,v]}function J1(n,l,a){return tx.apply(this,arguments)}function tx(){return tx=(0,ut.Z)(it().mark(function n(l,a,s){var o,h,v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(l.length!==0){B.next=2;break}return B.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return B.next=4,Promise.all(l.map(function(V){var j=V.data,nt=V.bands,at=nt===void 0?[0]:nt;return a(j,at)}));case 4:o=B.sent,h=[],o.forEach(function(V){Array.isArray(V)?h.push.apply(h,(0,ge.Z)(V)):h.push(V)}),v=h[0],m=v.width,E=v.height,B.t0=(0,Mn.Z)(s),B.next=B.t0==="function"?11:B.t0==="object"?13:15;break;case 11:return A=s(h),B.abrupt("break",16);case 13:return Array.isArray(s)?A={rasterData:sm(s,h)}:A=z3(s,h),B.abrupt("break",16);case 15:A={rasterData:h[0].rasterData};case 16:return B.abrupt("return",(0,K.Z)((0,K.Z)({},A),{},{width:m,height:E}));case 17:case"end":return B.stop()}},n)})),tx.apply(this,arguments)}function z3(n,l){var a=B3[n.type];if(a.type==="function")return a.method(l,n==null?void 0:n.options);if(a.type==="operation")return n.type==="rgb"?sS(a.expression,l):{rasterData:sm(a.expression,l)}}function sS(n,l){n.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),n.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),n.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var a=sm(n.r||["band",0],l),s=sm(n.g||["band",0],l),o=sm(n.b||["band",0],l);return[a,s,o]}function Bc(n,l,a,s){return ex.apply(this,arguments)}function ex(){return ex=(0,ut.Z)(it().mark(function n(l,a,s,o){var h;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,J1(l,a,s);case 2:h=m.sent,o(null,{data:h});case 4:case"end":return m.stop()}},n)})),ex.apply(this,arguments)}function Ay(n,l){return n.map(function(a){return a[l]*1})}function U3(n){return n===void 0?!1:!Array.isArray(n)&&n.data!==void 0}function uS(n){return Array.isArray(n)?n.length===0?!1:!!U3(n[0]):!1}function lS(n){return Array.isArray(n)?n.length===0||typeof n[0]=="number":!1}function Z3(n,l){var a=l.extent,s=l.width,o=l.height,h=l.min,v=l.max,m=l.format,E=l.operation,A,F,B;if(m===void 0||lS(n))A=Array.from(n),F=s,B=o;else{var V=Array.isArray(n)?n:[n];A=J1(V,m,E)}var j={_id:1,dataArray:[{_id:1,data:A,width:F,height:B,min:h,max:v,coordinates:[[a[0],a[1]],[a[2],a[3]]]}]};return j}var V3=["extent","min","max","width","height","format","operation"];function cS(n,l){var a=l.extent,s=l.min,o=l.max,h=l.width,v=l.height,m=l.format,E=l.operation,A=(0,Wl.Z)(l,V3),F;if(m===void 0||lS(n))F=Array.from(n);else{var B=Array.isArray(n)?n:[n];F=J1(B,m,E)}var V={_id:1,dataArray:[(0,K.Z)((0,K.Z)({_id:1,data:F,width:h,height:v},A),{},{min:s,max:o,coordinates:[[a[0],a[1]],[a[2],a[3]]]})]};return V}var G3=function(){var n=(0,ut.Z)(it().mark(function l(a,s,o,h){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",new Promise(function(E,A){s({x:a.x,y:a.y,z:a.z},function(F,B){if(F||B.length===0){A(F);return}B&&Bc([{data:B,bands:[0]}],o,h,function(V,j){V?A(V):j&&E(j)})})}));case 1:case"end":return m.stop()}},l)}));return function(a,s,o,h){return n.apply(this,arguments)}}();function H3(n,l){return Array.isArray(n)?typeof n[0]=="string"?n.map(function(a){return Bd(a,l)}):n.map(function(a){return{url:Bd(a.url,l),bands:a.bands||[0]}}):Bd(n,l)}function j3(n){return typeof n=="string"?[{url:n,bands:[0]}]:typeof n[0]=="string"?n.map(function(l){return{url:l,bands:[0]}}):n}function fS(n,l){n.xhrCancel=function(){l.map(function(a){a.abort()})}}var W3=function(){var n=(0,ut.Z)(it().mark(function l(a,s,o,h,v){var m,E,A,F,B,V;return it().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(m=j3(s.url),!(m.length>1)){nt.next=15;break}return nt.next=4,X3(m,s);case 4:if(E=nt.sent,A=E.rasterFiles,F=E.xhrList,B=E.errList,fS(a,F),!(B.length>0)){nt.next=12;break}return o(B,null),nt.abrupt("return");case 12:Bc(A,h,v,o),nt.next=17;break;case 15:V=Gc(s,function(at,mt){if(at)o(at);else if(mt){var Bt=[{data:mt,bands:m[0].bands}];Bc(Bt,h,v,o)}}),fS(a,[V]);case 17:case"end":return nt.stop()}},l)}));return function(a,s,o,h,v){return n.apply(this,arguments)}}();function X3(n,l){return rx.apply(this,arguments)}function rx(){return rx=(0,ut.Z)(it().mark(function n(l,a){var s,o,h,v,m,E,A,F,B,V,j;return it().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:s=[],o=[],h=[],v=0;case 4:if(!(v<l.length)){at.next=20;break}return m=l[v],E=(0,K.Z)((0,K.Z)({},a),{},{url:m.url}),A=m.bands,at.next=10,sv((0,K.Z)((0,K.Z)({},E),{},{type:"arrayBuffer"}));case 10:F=at.sent,B=F.err,V=F.data,j=F.xhr,B&&h.push(B),o.push(j),s.push({data:V,bands:A});case 17:v++,at.next=4;break;case 20:return at.abrupt("return",{rasterFiles:s,xhrList:o,errList:h});case 21:case"end":return at.stop()}},n)})),rx.apply(this,arguments)}var Y3=function(){var n=(0,ut.Z)(it().mark(function l(a,s,o,h,v){var m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return m={url:H3(a,s)},A.abrupt("return",new Promise(function(F,B){W3(o,m,function(V,j){V?B(V):j&&F(j)},h,v)}));case 2:case"end":return A.stop()}},l)}));return function(a,s,o,h,v){return n.apply(this,arguments)}}(),hS=function(){var n=(0,ut.Z)(it().mark(function l(a,s,o,h){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return m=Array.isArray(a)?a[0]:a,h.wmtsOptions?(E=(h==null?void 0:h.getURLFromTemplate)||X0,v=E(m,(0,K.Z)((0,K.Z)({},s),h.wmtsOptions))):(A=(h==null?void 0:h.getURLFromTemplate)||Bd,v=A(m,s)),B.abrupt("return",new Promise(function(V,j){var nt,at=vl({url:v,type:(h==null||(nt=h.requestParameters)===null||nt===void 0?void 0:nt.type)||"arrayBuffer"},function(mt,Bt){mt?j(mt):Bt&&V(Bt)},h.transformResponse);o.xhrCancel=function(){return at.abort()}}));case 3:case"end":return B.stop()}},l)}));return function(a,s,o,h){return n.apply(this,arguments)}}(),pS=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},dS={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},$3=[wp.ARRAYBUFFER,wp.RGB];function q3(n){return!!(Array.isArray(n)&&n.length===0||!Array.isArray(n)&&typeof n!="string")}function vS(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(q3(n))throw new Error("tile server url is error");var a=(l==null?void 0:l.dataType)||wp.IMAGE;a===wp.RGB&&(a=wp.ARRAYBUFFER);var s=function(v,m){switch(a){case wp.IMAGE:return hS(n,v,m,l);case wp.ARRAYBUFFER:return Y3(n,v,m,(l==null?void 0:l.format)||pS,l==null?void 0:l.operation);case wp.CUSTOMARRAYBUFFER:case wp.CUSTOMRGB:return G3(m,l==null?void 0:l.getCustomData,(l==null?void 0:l.format)||pS,l==null?void 0:l.operation);default:return hS(n,v,m,l)}},o=(0,K.Z)((0,K.Z)((0,K.Z)({},dS),l),{},{getTileData:s});return{data:n,dataArray:[],tilesetOptions:o,isTile:!0}}var K3={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},Q3=function(){var n=(0,ut.Z)(it().mark(function l(a){return it().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",new Promise(function(h){var v=(0,ht.Z)(a.bounds,4),m=v[0],E=v[1],A=v[2],F=v[3],B={layers:{testTile:{features:[{type:"Feature",properties:{key:a.x+"/"+a.y+"/"+a.z,textLng:(m+A)/2,textLat:(E+F)/2},geometry:{type:"LineString",coordinates:[[A,F],[A,E],[m,E],[m,E]]}}]}}};h(B)}));case 1:case"end":return o.stop()}},l)}));return function(a){return n.apply(this,arguments)}}();function J3(n,l){var a=function(h){return Q3(h)},s=(0,K.Z)((0,K.Z)((0,K.Z)({},K3),l),{},{getTileData:a});return{data:n,dataArray:[],tilesetOptions:s,isTile:!0}}function gS(n,l){var a=l.radius,s=a===void 0?40:a,o=l.maxZoom,h=o===void 0?18:o,v=l.minZoom,m=v===void 0?0:v,E=l.zoom,A=E===void 0?2:E;if(n.pointIndex){var F=n.pointIndex.getClusters(n.extent,Math.floor(A));return n.dataArray=t5(F),n}var B=new(AE())({radius:s,minZoom:m,maxZoom:h}),V={type:"FeatureCollection",features:[]};return V.features=n.dataArray.map(function(j){return{type:"Feature",geometry:{type:"Point",coordinates:j.coordinates},properties:(0,K.Z)({},j)}}),B.load(V.features),B}function t5(n){return n.map(function(l,a){return(0,K.Z)({coordinates:l.geometry.coordinates,_id:a+1},l.properties)})}function e5(n){if(n.length===0)throw new Error("max requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]>l&&(l=n[a]);return l}function r5(n){if(n.length===0)throw new Error("min requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]<l&&(l=n[a]);return l}function mS(n){if(n.length===0)return 0;for(var l=n[0],a=0,s,o=1;o<n.length;o++)s=l+n[o]*1,Math.abs(l)>=Math.abs(n[o])?a+=l-s+n[o]:a+=n[o]-s+l,l=s;return l+a*1}function n5(n){if(n.length===0)throw new Error("mean requires at least one data point");return mS(n)/n.length}var i5={min:r5,max:e5,mean:n5,sum:mS};function a5(n){var l=Uv();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Uv(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function yS(n,l){if(Array.isArray(l))return l}var Rf=function(n){(0,Ut.Z)(a,n);var l=a5(a);function a(s,o){var h;return(0,lt.Z)(this,a),h=l.call(this),(0,W.Z)((0,st.Z)(h),"type","source"),(0,W.Z)((0,st.Z)(h),"isTile",!1),(0,W.Z)((0,st.Z)(h),"inited",!1),(0,W.Z)((0,st.Z)(h),"hooks",{init:new Ep}),(0,W.Z)((0,st.Z)(h),"parser",{type:"geojson"}),(0,W.Z)((0,st.Z)(h),"transforms",[]),(0,W.Z)((0,st.Z)(h),"cluster",!1),(0,W.Z)((0,st.Z)(h),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,W.Z)((0,st.Z)(h),"invalidExtent",!1),(0,W.Z)((0,st.Z)(h),"dataArrayChanged",!1),(0,W.Z)((0,st.Z)(h),"cfg",{autoRender:!0}),h.originData=s,h.initCfg(o),h.init().then(function(){h.inited=!0,h.emit("update",{type:"inited"})}),h}return(0,tt.Z)(a,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(o){return this.clusterIndex.getClusters(this.caculClusterExtent(2),o)}},{key:"getClustersLeaves",value:function(o){return this.clusterIndex.getLeaves(o,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(o){var h=this,v=this.clusterOptions,m=v.method,E=m===void 0?"sum":m,A=v.field,F=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(o));this.clusterOptions.zoom=o,F.forEach(function(B){B.id||(B.properties.point_count=1)}),(A||(0,te.isFunction)(E))&&(F=F.map(function(B){var V=B.id;if(V){var j=h.clusterIndex.getLeaves(V,1/0),nt=j.map(function(Bt){return Bt.properties}),at;if((0,te.isString)(E)&&A){var mt=Ay(nt,A);at=i5[E](mt)}(0,te.isFunction)(E)&&(at=E(nt)),B.properties.stat=at}else B.properties.point_count=1;return B})),this.data=VE("geojson")({type:"FeatureCollection",features:F}),this.executeTrans()}},{key:"getFeatureById",value:function(o){var h=this.parser,v=h.type,m=v===void 0?"geojson":v,E=h.geometry;if(m==="geojson"&&!this.cluster){var A=o<this.originData.features.length?this.originData.features[o]:"null",F=(0,te.cloneDeep)(A);if(F!=null&&F.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var B=this.data.dataArray.find(function(V){return V._id===o});F.properties=B}return F}else return m==="json"&&E?this.data.dataArray.find(function(V){return V._id===o}):o<this.data.dataArray.length?this.data.dataArray[o]:"null"}},{key:"updateFeaturePropertiesById",value:function(o,h){this.data.dataArray=this.data.dataArray.map(function(v){return v._id===o?(0,K.Z)((0,K.Z)({},v),h):v}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(o,h){var v=this.data.dataArray.find(function(m){return m[o]===h});return v==null?void 0:v._id}},{key:"setData",value:function(o,h){var v=this;this.originData=o,this.dataArrayChanged=!1,this.initCfg(h),this.init().then(function(){v.emit("update",{type:"update"})})}},{key:"destroy",value:function(){var o;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(o=this.tileset)===null||o===void 0||o.destroy()}},{key:"processData",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v=this;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,new Promise(function(A,F){try{v.excuteParser(),v.initCluster(),v.executeTrans(),A({})}catch(B){F(B)}});case 2:return E.abrupt("return",E.sent);case 3:case"end":return E.stop()}},h)}));function o(){return s.apply(this,arguments)}return o}()},{key:"initCfg",value:function(o){this.cfg=(0,te.mergeWith)(this.cfg,o,yS);var h=this.cfg;h&&(h.parser&&(this.parser=h.parser),h.transforms&&(this.transforms=h.transforms),this.cluster=h.cluster||!1,h.clusterOptions&&(this.cluster=!0,this.clusterOptions=(0,K.Z)((0,K.Z)({},this.clusterOptions),h.clusterOptions)))}},{key:"init",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.inited=!1,m.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"excuteParser",value:function(){var o=this.parser,h=o.type||"geojson",v=VE(h);this.data=v(this.originData,o),this.tileset=this.initTileset(),!o.cancelExtent&&(this.extent=jf(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(o){this.center=[(o[0]+o[2])/2,(o[1]+o[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var o=this.data.tilesetOptions;if(!!o){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(o),this.tileset;var h=new uf((0,K.Z)({},o));return h}}},{key:"executeTrans",value:function(){var o=this,h=this.transforms;h.forEach(function(v){var m=v.type,E=xy(m)(o.data,v);Object.assign(o.data,E)})}},{key:"initCluster",value:function(){if(!!this.cluster){var o=this.clusterOptions||{};this.clusterIndex=gS(this.data,o)}}},{key:"caculClusterExtent",value:function(o){var h=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(h=Nl(wu(this.extent),o)),h[0].concat(h[1])}}]),a}(Ee.EventEmitter);function Cp(n,l){var a=l.callback;return a&&(n.dataArray=n.dataArray.filter(a)),n}function nx(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=_S(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function _S(n,l){if(!!n){if(typeof n=="string")return o5(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o5(n,l)}}function o5(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var Ap=6378e3;function fs(n,l){var a=n.dataArray,s=l.size,o=s===void 0?10:s,h=o/(2*Math.PI*Ap)*(256<<20)/2,v=ix(a,o),m=v.gridHash,E=v.gridOffset,A=u5(m,E,l);return{yOffset:h,xOffset:h,radius:h,type:"grid",dataArray:A}}function ix(n,l){var a=1/0,s=-1/0,o,h=nx(n),v;try{for(h.s();!(v=h.n()).done;){var m=v.value;o=m.coordinates[1],Number.isFinite(o)&&(a=o<a?o:a,s=o>s?o:s)}}catch(ce){h.e(ce)}finally{h.f()}var E=(a+s)/2,A=xS(l,E);if(A.xOffset<=0||A.yOffset<=0)return{gridHash:{},gridOffset:A};var F={},B=nx(n),V;try{for(B.s();!(V=B.n()).done;){var j=V.value,nt=j.coordinates[1],at=j.coordinates[0];if(Number.isFinite(nt)&&Number.isFinite(at)){var mt=Math.floor((nt+90)/A.yOffset),Bt=Math.floor((at+180)/A.xOffset),de="".concat(mt,"-").concat(Bt);F[de]=F[de]||{count:0,points:[]},F[de].count+=1,F[de].points.push(j)}}}catch(ce){B.e(ce)}finally{B.f()}return{gridHash:F,gridOffset:A}}function xS(n,l){var a=pg(n),s=s5(l,n);return{yOffset:a,xOffset:s}}function pg(n){return n/Ap*(180/Math.PI)}function s5(n,l){return l/Ap*(180/Math.PI)/Math.cos(n*Math.PI/180)}function u5(n,l,a){return Object.keys(n).reduce(function(s,o,h){var v=o.split("-"),m=parseInt(v[0],10),E=parseInt(v[1],10),A={};if(a.field&&a.method){var F=_i(n[o].points,a.field);A[a.method]=xn[a.method](F)}return Object.assign(A,{_id:h,coordinates:Ko([-180+l.xOffset*(E+.5),-90+l.yOffset*(m+.5)]),rawData:n[o].points,count:n[o].count}),s.push(A),s},[])}var x0=Math.PI/3,l5=[0,x0,2*x0,3*x0,4*x0,5*x0];function c5(n){return n[0]}function bS(n){return n[1]}function ES(){var n=0,l=0,a=1,s=1,o=c5,h=bS,v,m,E;function A(B){var V={},j=[],nt,at=B.length;for(nt=0;nt<at;++nt)if(!(isNaN(Bt=+o.call(null,mt=B[nt],nt,B))||isNaN(de=+h.call(null,mt,nt,B)))){var mt,Bt,de,ce=Math.round(de=de/E),Be=Math.round(Bt=Bt/m-(ce&1)/2),Xe=de-ce;if(Math.abs(Xe)*3>1){var _r=Bt-Be,Ir=Be+(Bt<Be?-1:1)/2,Nr=ce+(de<ce?-1:1),Yr=Bt-Ir,yn=de-Nr;_r*_r+Xe*Xe>Yr*Yr+yn*yn&&(Be=Ir+(ce&1?1:-1)/2,ce=Nr)}var fn=Be+"-"+ce,$n=V[fn];$n?$n.push(mt):(j.push($n=V[fn]=[mt]),$n.x=(Be+(ce&1)/2)*m,$n.y=ce*E)}return j}function F(B){var V=0,j=0;return l5.map(function(nt){var at=Math.sin(nt)*B,mt=-Math.cos(nt)*B,Bt=at-V,de=mt-j;return V=at,j=mt,[Bt,de]})}return A.hexagon=function(B){return"m"+F(B==null?v:+B).join("l")+"z"},A.centers=function(){for(var B=[],V=Math.round(l/E),j=Math.round(n/m),nt=V*E;nt<s+v;nt+=E,++V)for(var at=j*m+(V&1)*m/2;at<a+m/2;at+=m)B.push([at,nt]);return B},A.mesh=function(){var B=F(v).slice(0,4).join("l");return A.centers().map(function(V){return"M"+V+"m"+B}).join("")},A.x=function(B){return arguments.length?(o=B,A):o},A.y=function(B){return arguments.length?(h=B,A):h},A.radius=function(B){return arguments.length?(v=+B,m=v*2*Math.sin(x0),E=v*1.5,A):v},A.size=function(B){return arguments.length?(n=l=0,a=+B[0],s=+B[1],A):[a-n,s-l]},A.extent=function(B){return arguments.length?(n=+B[0][0],l=+B[0][1],a=+B[1][0],s=+B[1][1],A):[[n,l],[a,s]]},A.radius(1)}var hn=6378e3;function ax(n,l){var a=n.dataArray,s=l.size,o=s===void 0?10:s,h=l.method,v=h===void 0?"sum":h,m=o/(2*Math.PI*hn)*(256<<20)/2,E=a.map(function(V){var j=Ko(V.coordinates),nt=(0,ht.Z)(j,2),at=nt[0],mt=nt[1];return(0,K.Z)((0,K.Z)({},V),{},{coordinates:[at,mt]})}),A=ES().radius(m).x(function(V){return V.coordinates[0]}).y(function(V){return V.coordinates[1]}),F=A(E),B={dataArray:F.map(function(V,j){var nt;if(l.field&&v){var at=_i(V,l.field);V[v]=xn[v](at)}return nt={},(0,W.Z)(nt,l.method,V[v]),(0,W.Z)(nt,"count",V.length),(0,W.Z)(nt,"rawData",V),(0,W.Z)(nt,"coordinates",[V.x,V.y]),(0,W.Z)(nt,"_id",j),nt}),radius:m,xOffset:m,yOffset:m,type:"hexagon"};return B}function Ga(n,l){var a=l.sourceField,s=l.targetField,o=l.data,h={};return o.forEach(function(v){h[v[a]]=v}),n.dataArray=n.dataArray.map(function(v){var m=v[s];return(0,K.Z)((0,K.Z)({},v),h[m])}),n}function Ec(n,l){var a=l.callback;return a&&(n.dataArray=n.dataArray.map(a)),n}nd("rasterTile",vS),nd("mvt",id),nd("geojsonvt",aS),nd("testTile",J3),nd("geojson",KE),nd("image",Nv),nd("csv",im),nd("json",qE),nd("raster",Z3),nd("rasterRgb",cS),g0("cluster",gS),g0("filter",Cp),g0("join",Ga),g0("map",Ec),g0("grid",fs),g0("hexagon",ax);var Zv=Rf,Bh,ox=(Bh={},(0,W.Z)(Bh,Sp.additive,{enable:!0,func:{srcRGB:Kt.ONE,dstRGB:Kt.ONE,srcAlpha:1,dstAlpha:1}}),(0,W.Z)(Bh,Sp.none,{enable:!1}),(0,W.Z)(Bh,Sp.normal,{enable:!0,func:{srcRGB:Kt.SRC_ALPHA,dstRGB:Kt.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,W.Z)(Bh,Sp.subtractive,{enable:!0,func:{srcRGB:Kt.ONE,dstRGB:Kt.ONE,srcAlpha:Kt.ZERO,dstAlpha:Kt.ONE_MINUS_SRC_COLOR},equation:{rgb:Kt.FUNC_SUBTRACT,alpha:Kt.FUNC_SUBTRACT}}),(0,W.Z)(Bh,Sp.max,{enable:!0,func:{srcRGB:Kt.ONE,dstRGB:Kt.ONE},equation:{rgb:Kt.MAX_EXT}}),(0,W.Z)(Bh,Sp.min,{enable:!0,func:{srcRGB:Kt.ONE,dstRGB:Kt.ONE},equation:{rgb:Kt.MIN_EXT}}),Bh);function Os(n,l,a,s,o){l.updateStyleAttribute(n,a,s,o)}function sx(n,l){l.tileLayer||l.isTileLayer||(n.opacity&&Ty("opacity",l,n.opacity),n.strokeWidth&&Ty("strokeWidth",l,n.strokeWidth),n.strokeOpacity&&Ty("strokeOpacity",l,n.strokeOpacity),n.stroke&&b0("stroke",l,n.stroke),n.offsets&&f5("offsets",l,n.offsets),n.textOffset&&f5("textOffset",l,n.textOffset),n.thetaOffset&&Ty("thetaOffset",l,n.thetaOffset))}function Ty(n,l,a){(0,te.isString)(a)?Os(n,l,a,function(s){return s}):(0,te.isNumber)(a)||(Array.isArray(a)&&a.length===2?(0,te.isString)(a[0])&&(0,te.isFunction)(a[1])||(0,te.isString)(a[0])&&Array.isArray(a[1])&&(0,te.isNumber)(a[1][0])&&(0,te.isNumber)(a[1][1])?Os(n,l,a[0],a[1]):Os(n,l,[1],void 0):Os(n,l,[1],void 0))}function f5(n,l,a){(0,te.isString)(a)?Os(n,l,a,function(s){return s}):Array.isArray(a)&&a.length===2&&(0,te.isString)(a[0])&&(0,te.isFunction)(a[1])?Os(n,l,a[0],a[1]):Array.isArray(a)&&a.length===2&&(0,te.isNumber)(a[0])&&(0,te.isNumber)(a[1])?Os(n,l,a,void 0):Os(n,l,[0,0],void 0)}function b0(n,l,a){(0,te.isString)(a)||(Array.isArray(a)&&a.length===2&&((0,te.isString)(a[0])&&(0,te.isFunction)(a[1])||(0,te.isString)(a[0])&&Array.isArray(a[1])&&a[1].length>0)?Os(n,l,a[0],a[1]):Os(n,l,"#fff",void 0))}var yu;(function(n){n["GAODE1.x"]="GAODE1.x",n["GAODE2.x"]="GAODE2.x",n.MAPBOX="MAPBOX",n.DEFUALT="DEFUALTMAP",n.SIMPLE="SIMPLE",n.GLOBEL="GLOBEL"})(yu||(yu={}));function Vv(n,l){var a=[l[0]-n[0],l[1]-n[1]],s=Il(a),o=[n[0]+s[0]*1e-4,n[1]+s[1]*1e-4];return o}function My(n,l,a){if(n.length>0&&l.version===yu["GAODE2.x"]){var s=a.coordCenter;typeof n[0].coordinates[0]=="number"?n.filter(function(o){return!o.originCoordinates}).map(function(o){o.version=yu["GAODE2.x"],o.originCoordinates=(0,te.cloneDeep)(o.coordinates),o.coordinates=l.lngLatToCoordByLayer(o.coordinates,s)}):n.filter(function(o){return!o.originCoordinates}).map(function(o){o.version=yu["GAODE2.x"],o.originCoordinates=(0,te.cloneDeep)(o.coordinates),o.coordinates=l.lngLatToCoordsByLayer(o.coordinates,s)})}}function ux(n,l){n.length>0&&l.version===yu.SIMPLE&&n.map(function(a){a.simpleCoordinate||(a.coordinates=h5(a.coordinates,l),a.simpleCoordinate=!0)})}function h5(n,l){if(typeof n[0]=="number")return l.simpleMapCoord.unproject(n);if(n[0]&&n[0][0]instanceof Array){var a=[];return n.map(function(o){var h=[];o.map(function(v){h.push(l.simpleMapCoord.unproject(v))}),a.push(h)}),a}else{var s=[];return n.map(function(o){s.push(l.simpleMapCoord.unproject(o))}),s}}function p5(n,l){var a;if(!n.scale)return[];var s=(n==null||(a=n.scale)===null||a===void 0?void 0:a.scalers)||[],o=[];s.forEach(function(v){var m,E=v.field;(l.hasOwnProperty(E)||((m=n.scale)===null||m===void 0?void 0:m.type)==="variable")&&o.push(l[E])});var h=n.mapping?n.mapping(o):[];return h}function d5(n,l,a,s,o){var h=o==null?void 0:o.getLayerConfig(),v=h.arrow,m=v===void 0?{enable:!1}:v,E=l.map(function(A){var F={id:A._id,coordinates:A.coordinates};if(n.filter(function(j){return j.scale!==void 0}).forEach(function(j){var nt=p5(j,A);j.needRemapping=!1,j.name==="color"&&(nt=nt.map(function(at){return ke(at)})),F[j.name]=Array.isArray(nt)&&nt.length===1?nt[0]:nt,j.name==="shape"&&(F.shape=a.getIconFontKey(F[j.name]))}),F.shape==="line"&&m.enable){var B=F.coordinates,V=Vv(B[0],B[1]);F.coordinates.splice(1,0,V,V)}return F});return My(E,s,o),ux(E,s),E}function v5(n,l,a,s,o,h){var v=new Zv(o,h),m=s.getLayerStyleAttributes()||[],E=v.data.dataArray,A=E,F=d5(m,A,l,a,n);return v.destroy(),F}function lx(n){return n.map(function(l){return typeof l=="string"&&(l=[l,{}]),l})}function cx(n,l,a,s){var o=n.multiPassRenderer,h=n.getLayerConfig(),v=h.enableTAA;return v?o.add(s("taa")):o.add(s("render")),lx(l).forEach(function(m){var E=(0,ht.Z)(m,2),A=E[0],F=E[1];o.add(a(A),F)}),o.add(a("copy")),o}var SS=[["circle","cylinder"],["square","cylinder"],["triangle","cylinder"],["pentagon","cylinder"],["hexagon","cylinder"],["octogon","cylinder"],["hexagram","cylinder"],["rhombus","cylinder"],["vesica","cylinder"]];function Iy(n,l,a){if(typeof l=="string"&&typeof a=="string"&&l!==a){if(n.type==="PointLayer"){n.dataState.dataSourceNeedUpdate=!0;return}SS.map(function(s){if(s.includes(l)&&s.includes(a)){n.dataState.dataSourceNeedUpdate=!0;return}})}}var g5=function(){function n(l){(0,lt.Z)(this,n),this.layer=l}return(0,tt.Z)(n,[{key:"pickRender",value:function(a){var s=this.layer;if(s.tileLayer)return s.tileLayer.pickRender(a);s.hooks.beforePickingEncode.call(),s.masks.length>0&&s.masks.filter(function(o){return o.inited}).forEach(function(){var o=(0,ut.Z)(it().mark(function h(v){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:v.render();case 1:case"end":return E.stop()}},h)}));return function(h){return o.apply(this,arguments)}}()),s.renderModels(!0),s.hooks.afterPickingEncode.call()}},{key:"pick",value:function(a,s){var o=this.layer.getContainer(),h=o.get(Dt.IPickingService);return a.type==="RasterLayer"?this.pickRasterLayer(a,s):(this.pickRender(s),h.pickFromPickingFBO(a,s))}},{key:"pickRasterLayer",value:function(a,s,o){var h=this.layer.getContainer(),v=h.get(Dt.IPickingService),m=h.get(Dt.IMapService),E=this.layer.getSource().extent,A=yl(s.lngLat,E),F={x:s.x,y:s.y,type:s.type,lngLat:s.lngLat,target:s,rasterValue:null},B=o||a;if(A){var V=this.readRasterValue(a,E,m,s.x,s.y);return F.rasterValue=V,v.triggerHoverOnLayer(B,F),!0}else return F.type=s.type==="mousemove"?"mouseout":"un"+s.type,v.triggerHoverOnLayer(B,(0,K.Z)((0,K.Z)({},F),{},{type:"unpick"})),v.triggerHoverOnLayer(B,F),!1}},{key:"readRasterValue",value:function(a,s,o,h,v){var m=a.getSource().data.dataArray[0],E=(0,ht.Z)(s,4),A=E[0],F=A===void 0?0:A,B=E[1],V=B===void 0?0:B,j=E[2],nt=j===void 0?10:j,at=E[3],mt=at===void 0?-10:at,Bt=o.lngLatToContainer([F,V]),de=o.lngLatToContainer([nt,mt]),ce=de.x-Bt.x,Be=Bt.y-de.y,Xe=[(h-Bt.x)/ce,(v-de.y)/Be],_r=m.width||1,Ir=m.height||1,Nr=Math.floor(Xe[0]*_r),Yr=Math.floor(Xe[1]*Ir),yn=Math.max(0,Yr-1)*_r+Nr,fn=m.data[yn];return fn}},{key:"selectFeature",value:function(a){var s=this.layer,o=(0,ht.Z)(a,3),h=o[0],v=o[1],m=o[2];s.hooks.beforeSelect.call([h,v,m])}},{key:"highlightPickedFeature",value:function(a){var s=(0,ht.Z)(a,3),o=s[0],h=s[1],v=s[2];this.layer.hooks.beforeHighlight.call([o,h,v])}},{key:"getFeatureById",value:function(a){return this.layer.getSource().getFeatureById(a)}}]),n}(),wS=function(){function n(l){(0,lt.Z)(this,n),this.layer=l;var a=this.layer.getContainer();this.rendererService=a.get(Dt.IRendererService)}return(0,tt.Z)(n,[{key:"getColorTexture",value:function(a){var s=this.getTextureKey(a);return this.key===s?this.colorTexture:(this.createColorTexture(a),this.key=s,this.colorTexture)}},{key:"createColorTexture",value:function(a){var s=this.rendererService.createTexture2D,o=br(a),h=s({data:o.data,width:o.width,height:o.height,flipY:!1});return this.colorTexture=h,h}},{key:"setColorTexture",value:function(a,s){this.key=this.getTextureKey(s),this.colorTexture=a}},{key:"destroy",value:function(){var a;(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"getTextureKey",value:function(a){return"".concat(a.colors.join("_"),"_").concat(a.positions.join("_"))}}]),n}(),yo=["passes"],um=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber","workerEnabled","workerOptions"],fx,E0,lm;function hx(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=px(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function px(n,l){if(!!n){if(typeof n=="string")return dx(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return dx(n,l)}}function dx(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function CS(n){var l=vx();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function vx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var AS=0,dg=(fx=ly(Dt.IGlobalConfigService),E0=function(n){(0,Ut.Z)(a,n);var l=CS(a);function a(){var s,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,lt.Z)(this,a),s=l.call(this),(0,W.Z)((0,st.Z)(s),"id","".concat(AS++)),(0,W.Z)((0,st.Z)(s),"name","".concat(AS)),(0,W.Z)((0,st.Z)(s),"visible",!0),(0,W.Z)((0,st.Z)(s),"zIndex",0),(0,W.Z)((0,st.Z)(s),"inited",!1),(0,W.Z)((0,st.Z)(s),"layerModelNeedUpdate",!1),(0,W.Z)((0,st.Z)(s),"pickedFeatureID",null),(0,W.Z)((0,st.Z)(s),"selectedFeatureID",null),(0,W.Z)((0,st.Z)(s),"styleNeedUpdate",!1),(0,W.Z)((0,st.Z)(s),"forceRender",!1),(0,W.Z)((0,st.Z)(s),"clusterZoom",0),(0,W.Z)((0,st.Z)(s),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,W.Z)((0,st.Z)(s),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,W.Z)((0,st.Z)(s),"hooks",{init:new Jm,afterInit:new c2,beforeRender:new c2,beforeRenderData:new f2,afterRender:new Ep,beforePickingEncode:new Ep,afterPickingEncode:new Ep,beforeHighlight:new Ep(["pickedColor"]),afterHighlight:new Ep,beforeSelect:new Ep(["pickedColor"]),afterSelect:new Ep,beforeDestroy:new Ep,afterDestroy:new Ep}),(0,W.Z)((0,st.Z)(s),"models",[]),(0,W.Z)((0,st.Z)(s),"startInit",!1),(0,W.Z)((0,st.Z)(s),"layerChildren",[]),(0,W.Z)((0,st.Z)(s),"masks",[]),Ar((0,st.Z)(s),"configService",lm,(0,st.Z)(s)),(0,W.Z)((0,st.Z)(s),"animateOptions",{enable:!1}),(0,W.Z)((0,st.Z)(s),"currentPickId",null),(0,W.Z)((0,st.Z)(s),"pendingStyleAttributes",[]),(0,W.Z)((0,st.Z)(s),"scaleOptions",{}),(0,W.Z)((0,st.Z)(s),"animateStatus",!1),(0,W.Z)((0,st.Z)(s),"isDestroyed",!1),(0,W.Z)((0,st.Z)(s),"encodeDataLength",0),(0,W.Z)((0,st.Z)(s),"sourceEvent",function(){s.dataState.dataSourceNeedUpdate=!0;var h=s.getLayerConfig();h&&h.autoFit&&s.fitBounds(h.fitBoundsOptions);var v=s.layerSource.getSourceCfg().autoRender;v&&s.reRender()}),s.name=o.name||s.id,s.zIndex=o.zIndex||0,s.rawConfig=o,s}return(0,tt.Z)(a,[{key:"addMaskLayer",value:function(o){this.masks.push(o)}},{key:"removeMaskLayer",value:function(o){var h=this.masks.indexOf(o);h>-1&&this.masks.splice(h,1),o.destroy()}},{key:"getAttribute",value:function(o){return this.styleAttributeService.getLayerStyleAttribute(o)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(o){var h=this;if(Object.keys(o).map(function(m){m in h.rawConfig&&(h.rawConfig[m]=o[m])}),!this.startInit)this.needUpdateConfig=(0,K.Z)((0,K.Z)({},this.needUpdateConfig),o);else{var v=this.container.get(Dt.SceneID);sx(o,this),this.configService.setLayerConfig(v,this.id,(0,K.Z)((0,K.Z)((0,K.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),o)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(o,h){this.container=o,this.sceneContainer=h}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(o){return this.plugins.push(o),this}},{key:"init",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v=this,m,E,A,F,B,V,j;return it().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:m=this.container.get(Dt.SceneID),this.startInit=!0,this.configService.setLayerConfig(m,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(Dt.IIconService),this.fontService=this.container.get(Dt.IFontService),this.rendererService=this.container.get(Dt.IRendererService),this.layerService=this.container.get(Dt.ILayerService),this.interactionService=this.container.get(Dt.IInteractionService),this.pickingService=this.container.get(Dt.IPickingService),this.mapService=this.container.get(Dt.IMapService),E=this.getLayerConfig(),A=E.enableMultiPassRenderer,F=E.passes,A&&F!==null&&F!==void 0&&F.length&&F.length>0&&this.mapService.on("mapAfterFrameChange",function(){v.renderLayers()}),this.cameraService=this.container.get(Dt.ICameraService),this.coordinateService=this.container.get(Dt.ICoordinateSystemService),this.shaderModuleService=this.container.get(Dt.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Dt.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Dt.IFactoryNormalPass),this.styleAttributeService=this.container.get(Dt.IStyleAttributeService),A&&(this.multiPassRenderer=this.container.get(Dt.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(mt){var Bt=mt.attributeName,de=mt.attributeField,ce=mt.attributeValues,Be=mt.updateOptions;v.styleAttributeService.updateStyleAttribute(Bt,{scale:(0,K.Z)({field:de},v.splitValuesAndCallbackInAttribute(ce,v.getLayerConfig()[Bt]))},Be)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Dt.ILayerPlugin),B=hx(this.plugins);try{for(B.s();!(V=B.n()).done;)j=V.value,j.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(mt){B.e(mt)}finally{B.f()}return this.layerPickService=new g5(this),this.textureService=new wS(this),at.next=29,this.hooks.init.promise();case 29:this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 33:case"end":return at.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"updateModelData",value:function(o){o.attributes&&o.elements?this.models.map(function(h){h.updateAttributesAndElements(o.attributes,o.elements)}):console.warn("data error")}},{key:"createModelData",value:function(o,h){var v;if((v=this.layerModel)!==null&&v!==void 0&&v.createModelData)return this.layerModel.createModelData(h);var m=this.calculateEncodeData(o,h),E=this.triangulation;return m&&E?this.styleAttributeService.createAttributesAndIndices(m,E):{attributes:void 0,elements:void 0}}},{key:"setLayerPickService",value:function(o){this.layerPickService=o}},{key:"calculateEncodeData",value:function(o,h){return this.inited?v5(this,this.fontService,this.mapService,this.styleAttributeService,o,h):(console.warn("layer not inited!"),null)}},{key:"prepareBuildModel",value:function(){this.updateLayerConfig((0,K.Z)((0,K.Z)((0,K.Z)({},this.getDefaultConfig()),this.rawConfig),this.needUpdateConfig));var o=this.getLayerConfig(),h=o.animateOption;h!=null&&h.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(o,h,v){return this.updateStyleAttribute("color",o,h,v),this}},{key:"texture",value:function(o,h,v){return this.updateStyleAttribute("texture",o,h,v),this}},{key:"rotate",value:function(o,h,v){return this.updateStyleAttribute("rotate",o,h,v),this}},{key:"size",value:function(o,h,v){return this.updateStyleAttribute("size",o,h,v),this}},{key:"filter",value:function(o,h,v){return this.updateStyleAttribute("filter",o,h,v),this}},{key:"shape",value:function(o,h,v){var m,E,A,F=(m=this.styleAttributeService)===null||m===void 0||(E=m.getLayerStyleAttribute("shape"))===null||E===void 0||(A=E.scale)===null||A===void 0?void 0:A.field,B=o;return this.shapeOption={field:o,values:h},this.updateStyleAttribute("shape",o,h,v),this.tileLayer||Iy(this,F,B),this}},{key:"label",value:function(o,h,v){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:o,attributeValues:h,updateOptions:v}),this}},{key:"animate",value:function(o){var h={};return(0,te.isObject)(o)?(h.enable=!0,h=(0,K.Z)((0,K.Z)({},h),o)):h.enable=o,this.updateLayerConfig({animateOption:h}),this}},{key:"source",value:function(o,h){return(o==null?void 0:o.type)==="source"?(this.setSource(o),this):(this.sourceOption={data:o,options:h},this.clusterZoom=0,this)}},{key:"setData",value:function(o,h){var v=this;return this.inited?this.layerSource.setData(o,h):this.on("inited",function(){var m=v.getSource();m?v.layerSource.setData(o,h):v.source(new Zv(o,h))}),this}},{key:"style",value:function(o){var h=this,v=o.passes,m=(0,Wl.Z)(o,yo);return v&&lx(v).forEach(function(E){var A=h.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(E[0]);A&&A.updateOptions(E[1])}),this.rawConfig=(0,K.Z)((0,K.Z)({},this.rawConfig),m),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(o,h){return(0,te.isObject)(o)?this.scaleOptions=(0,K.Z)((0,K.Z)({},this.scaleOptions),o):this.scaleOptions[o]=h,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(),this))}},{key:"renderMultiPass",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){m.next=2;break}return m.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){m.next=7;break}return m.next=5,this.multiPassRenderer.render();case 5:m.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"active",value:function(o){var h={};return h.enableHighlight=(0,te.isObject)(o)?!0:o,(0,te.isObject)(o)?(h.enableHighlight=!0,o.color&&(h.highlightColor=o.color),o.mix&&(h.activeMix=o.mix)):h.enableHighlight=!!o,this.updateLayerConfig(h),this}},{key:"setActive",value:function(o,h){var v=this;if((0,te.isObject)(o)){var m=o.x,E=m===void 0?0:m,A=o.y,F=A===void 0?0:A;this.updateLayerConfig({highlightColor:(0,te.isObject)(h)?h.color:this.getLayerConfig().highlightColor,activeMix:(0,te.isObject)(h)?h.mix:this.getLayerConfig().activeMix}),this.pick({x:E,y:F})}else this.updateLayerConfig({pickedFeatureID:o,highlightColor:(0,te.isObject)(h)?h.color:this.getLayerConfig().highlightColor,activeMix:(0,te.isObject)(h)?h.mix:this.getLayerConfig().activeMix}),this.hooks.beforeSelect.call(ar(o)).then(function(){setTimeout(function(){v.reRender()},1)})}},{key:"select",value:function(o){var h={};return h.enableSelect=(0,te.isObject)(o)?!0:o,(0,te.isObject)(o)?(h.enableSelect=!0,o.color&&(h.selectColor=o.color),o.mix&&(h.selectMix=o.mix)):h.enableSelect=!!o,this.updateLayerConfig(h),this}},{key:"setSelect",value:function(o,h){var v=this;if((0,te.isObject)(o)){var m=o.x,E=m===void 0?0:m,A=o.y,F=A===void 0?0:A;this.updateLayerConfig({selectColor:(0,te.isObject)(h)?h.color:this.getLayerConfig().selectColor,selectMix:(0,te.isObject)(h)?h.mix:this.getLayerConfig().selectMix}),this.pick({x:E,y:F})}else this.updateLayerConfig({pickedFeatureID:o,selectColor:(0,te.isObject)(h)?h.color:this.getLayerConfig().selectColor,selectMix:(0,te.isObject)(h)?h.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(ar(o)).then(function(){setTimeout(function(){v.reRender()},1)})}},{key:"setBlend",value:function(o){return this.updateLayerConfig({blend:o}),this.layerModelNeedUpdate=!0,this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(o){return this.zIndex=o,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(o){this.currentPickId=o}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(o){this.selectedFeatureID=o}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var o=this.mapService.getZoom(),h=this.getLayerConfig(),v=h.visible,m=h.minZoom,E=m===void 0?-1/0:m,A=h.maxZoom,F=A===void 0?1/0:A;return!!v&&o>=E&&o<F}},{key:"setMultiPass",value:function(o,h){if(this.updateLayerConfig({enableMultiPassRenderer:o}),h&&this.updateLayerConfig({passes:h}),o){var v=this.getLayerConfig(),m=v.passes,E=m===void 0?[]:m;this.multiPassRenderer=cx(this,E,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var A=this.rendererService.getViewportSize(),F=A.width,B=A.height;this.multiPassRenderer.resize(F,B)}return this}},{key:"setMinZoom",value:function(o){return this.updateLayerConfig({minZoom:o}),this}},{key:"getMinZoom",value:function(){var o=this.getLayerConfig(),h=o.minZoom;return h}},{key:"getMaxZoom",value:function(){var o=this.getLayerConfig(),h=o.maxZoom;return h}},{key:"get",value:function(o){var h=this.getLayerConfig();return h[o]}},{key:"setMaxZoom",value:function(o){return this.updateLayerConfig({maxZoom:o}),this}},{key:"setAutoFit",value:function(o){return this.updateLayerConfig({autoFit:o}),this}},{key:"fitBounds",value:function(o){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var h=this.getSource(),v=h.extent,m=v.some(function(E){return Math.abs(E)===1/0});return m?this:(this.mapService.fitBounds([[v[0],v[1]],[v[2],v[3]]],o),this)}},{key:"destroy",value:function(){var o,h,v,m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isDestroyed||(this.layerChildren.map(function(E){return E.destroy(!1)}),this.layerChildren=[],this.masks.map(function(E){return E.destroy(!1)}),this.masks=[],this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(o=this.multiPassRenderer)===null||o===void 0||o.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(h=this.layerModel)===null||h===void 0||h.clearModels(m),(v=this.tileLayer)===null||v===void 0||v.destroy(),this.models=[],this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0)}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var o;this.models.forEach(function(h){return h.destroy()}),(o=this.layerModel)===null||o===void 0||o.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(o){return o.needRescale||o.needRemapping||o.needRegenerateVertices}).length}},{key:"setSource",value:function(o){var h=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=o,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var v=this.mapService.getZoom();this.layerSource.updateClusterData(v)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(m){var E=m.type;if(h.coordCenter===void 0){var A,F=h.layerSource.center;h.coordCenter=F,(A=h.mapService)!==null&&A!==void 0&&A.setCoordCenter&&h.mapService.setCoordCenter(F)}E==="update"&&h.sourceEvent()})}},{key:"initSource",value:function(o){this.layerSource=o,this.clusterZoom=0,this.addSourceEvent()}},{key:"getSource",value:function(){return this.layerSource}},{key:"addSourceEvent",value:function(){var o=this;this.layerSource.on("update",function(){if(o.coordCenter===void 0){var h,v=o.layerSource.center;o.coordCenter=v,(h=o.mapService)!==null&&h!==void 0&&h.setCoordCenter&&o.mapService.setCoordCenter(v)}o.sourceEvent()})}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(o){this.encodedData=o,this.encodeDataLength=o.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(o){return this.styleAttributeService.getLayerAttributeScale(o)}},{key:"getLegend",value:function(o){var h,v,m,E=this.styleAttributeService.getLayerStyleAttribute(o),A=(E==null||(h=E.scale)===null||h===void 0?void 0:h.scalers)||[];return{type:(v=A[0].option)===null||v===void 0?void 0:v.type,field:E==null||(m=E.scale)===null||m===void 0?void 0:m.field,items:this.getLegendItems(o)}}},{key:"getLegendItems",value:function(o){var h=this.styleAttributeService.getLayerAttributeScale(o);if(!h)return[];if(h.invertExtent){var v=h.range().map(function(A){return(0,W.Z)({value:h.invertExtent(A)},o,A)});return v}else if(h.ticks){var m=h.ticks().map(function(A){return(0,W.Z)({value:A},o,h(A))});return m}else if(h!=null&&h.domain){var E=h.domain().filter(function(A){return!(0,te.isUndefined)(A)}).map(function(A){return(0,W.Z)({value:A},o,h(A))});return E}return[]}},{key:"pick",value:function(o){var h=o.x,v=o.y;this.interactionService.triggerHover({x:h,y:v})}},{key:"boxSelect",value:function(o,h){this.pickingService.boxPickLayer(this,o,h)}},{key:"buildLayerModel",value:function(){var s=(0,ut.Z)(it().mark(function h(v){var m=this,E,A,F,B,V,j,nt,at,mt,Bt,de,ce,Be,Xe;return it().wrap(function(Ir){for(;;)switch(Ir.prev=Ir.next){case 0:return E=v.moduleName,A=v.vertexShader,F=v.fragmentShader,B=v.triangulation,V=v.segmentNumber,j=v.workerEnabled,nt=j===void 0?!1:j,at=v.workerOptions,mt=(0,Wl.Z)(v,um),this.shaderModuleService.registerModule(E,{vs:A,fs:F}),Bt=this.shaderModuleService.getModule(E),de=Bt.vs,ce=Bt.fs,Be=Bt.uniforms,Xe=this.rendererService.createModel,Ir.abrupt("return",new Promise(function(Nr,Yr){if(at&&at.modelType in Kf&&nt)m.styleAttributeService.createAttributesAndIndicesAscy(m.encodedData,V,at).then(function(zo){var Vs=zo.attributes,hu=zo.elements,Gu=Xe((0,K.Z)({attributes:Vs,uniforms:Be,fs:ce,vs:de,elements:hu,blend:ox[Sp.normal]},mt));Nr(Gu)}).catch(function(zo){return Yr(zo)});else{var yn=m.styleAttributeService.createAttributesAndIndices(m.encodedData,B,V),fn=yn.attributes,$n=yn.elements,di=yn.count,Yi=(0,K.Z)({attributes:fn,uniforms:Be,fs:ce,vs:de,elements:$n,blend:ox[Sp.normal]},mt);di&&(Yi.count=di);var ho=Xe(Yi);Nr(ho)}}));case 5:case"end":return Ir.stop()}},h,this)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"createAttributes",value:function(o){var h=o.triangulation,v=this.styleAttributeService.createAttributes(this.encodedData,h),m=v.attributes;return m}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(o){var h=this.getLayerConfig(),v=h.enableHighlight,m=v===void 0?!0:v,E=h.enableSelect,A=E===void 0?!0:E,F=this.eventNames().indexOf(o)!==-1||this.eventNames().indexOf("un"+o)!==-1;return(o==="click"||o==="dblclick")&&A&&(F=!0),o==="mousemove"&&(m||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(F=!0),this.isVisible()&&F}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return m.stop()}},h)}));function o(){return s.apply(this,arguments)}return o}()},{key:"rebuildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"renderMulPass",value:function(){var s=(0,ut.Z)(it().mark(function h(v){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,v.render();case 2:case"end":return E.stop()}},h)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"renderModels",value:function(o){var h=this;return this.encodeDataLength<=0&&!this.forceRender?this:(this.hooks.beforeRender.call(),this.models.forEach(function(v){v.draw({uniforms:h.layerModel.getUninforms()},o)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(o,h,v,m){["color","size","texture","rotate","filter","label","shape"].indexOf(o)!==-1&&this.configService.setAttributeConfig(this.id,(0,W.Z)({},o,{field:h,values:v})),this.startInit?this.styleAttributeService.updateStyleAttribute(o,{scale:(0,K.Z)({field:h},this.splitValuesAndCallbackInAttribute(v,this.getLayerConfig()[h]))},m):this.pendingStyleAttributes.push({attributeName:o,attributeField:h,attributeValues:v,updateOptions:m})}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(o){console.warn("empty fn")}},{key:"processData",value:function(o){return o}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.models.forEach(function(E){return E.destroy()}),this.models=[],m.next=4,this.layerModel.initModels();case 4:this.models=m.sent;case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(o,h){return{values:(0,te.isFunction)(o)?void 0:o||h,callback:(0,te.isFunction)(o)?o:void 0}}}]),a}(Ee.EventEmitter),lm=Dr(E0.prototype,"configService",[fx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E0),TS,gx,MS;function m5(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=y5(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function y5(n,l){if(!!n){if(typeof n=="string")return IS(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return IS(n,l)}}function IS(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var ws=(TS=ly(Dt.IGlobalConfigService),gx=function(){function n(l){(0,lt.Z)(this,n),Ar(this,"configService",MS,this),this.layer=l,this.rendererService=l.getContainer().get(Dt.IRendererService),this.pickingService=l.getContainer().get(Dt.IPickingService),this.shaderModuleService=l.getContainer().get(Dt.IShaderModuleService),this.styleAttributeService=l.getContainer().get(Dt.IStyleAttributeService),this.mapService=l.getContainer().get(Dt.IMapService),this.iconService=l.getContainer().get(Dt.IIconService),this.fontService=l.getContainer().get(Dt.IFontService),this.cameraService=l.getContainer().get(Dt.ICameraService),this.layerService=l.getContainer().get(Dt.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var a=this.rendererService.createTexture2D;this.createTexture2D=a,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={thetaOffset:void 0,opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8Array(4),mag:Kt.NEAREST,min:Kt.NEAREST,width:1,height:1}))}return(0,tt.Z)(n,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertiesExist.hasOpacity,this.stylePropertiesExist.hasStrokeOpacity,this.stylePropertiesExist.hasStrokeWidth,this.stylePropertiesExist.hasStroke,this.stylePropertiesExist.hasOffsets,this.stylePropertiesExist.hasThetaOffset,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(a){var s=!1;return(0,te.isEqual)(a.thetaOffset,this.cacheStyleProperties.thetaOffset)||(s=!0,this.cacheStyleProperties.thetaOffset=a.thetaOffset),(0,te.isEqual)(a.opacity,this.cacheStyleProperties.opacity)||(s=!0,this.cacheStyleProperties.opacity=a.opacity),(0,te.isEqual)(a.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(s=!0,this.cacheStyleProperties.strokeOpacity=a.strokeOpacity),(0,te.isEqual)(a.strokeWidth,this.cacheStyleProperties.strokeWidth)||(s=!0,this.cacheStyleProperties.strokeWidth=a.strokeWidth),(0,te.isEqual)(a.stroke,this.cacheStyleProperties.stroke)||(s=!0,this.cacheStyleProperties.stroke=a.stroke),(0,te.isEqual)(a.offsets,this.cacheStyleProperties.offsets)||(s=!0,this.cacheStyleProperties.offsets=a.offsets),this.dataTexture===void 0&&(s=!0),s}},{key:"judgeStyleAttributes",value:function(a){this.clearLastCalRes(),a.opacity!==void 0&&!(0,te.isNumber)(a.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertiesExist.hasOpacity=1,this.cellLength+=1),a.strokeOpacity!==void 0&&!(0,te.isNumber)(a.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertiesExist.hasStrokeOpacity=1,this.cellLength+=1),a.strokeWidth!==void 0&&!(0,te.isNumber)(a.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertiesExist.hasStrokeWidth=1,this.cellLength+=1),a.stroke!==void 0&&!this.isStaticColor(a.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertiesExist.hasStroke=1,this.cellLength+=4),a.offsets!==void 0&&!this.isOffsetStatic(a.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertiesExist.hasOffsets=1,this.cellLength+=2),a.thetaOffset!==void 0&&!(0,te.isNumber)(a.thetaOffset)&&(this.cellProperties.push({attr:"thetaOffset",count:1}),this.stylePropertiesExist.hasThetaOffset=1,this.cellLength+=1)}},{key:"isStaticColor",value:function(a){return(0,te.isString)(a)?!!pc(a):!1}},{key:"getStrokeColor",value:function(a){if(this.isStaticColor(a)){var s=ke(a);return s[0]=s[0]?s[0]:0,s[1]=s[1]?s[1]:0,s[2]=s[2]?s[2]:0,s[3]=s[3]?s[3]:0,s}else return[0,0,0,0]}},{key:"isOffsetStatic",value:function(a){return!!(Array.isArray(a)&&a.length===2&&(0,te.isNumber)(a[0])&&(0,te.isNumber)(a[1]))}},{key:"patchMod",value:function(a,s){for(var o=0;o<s;o++)a.push(-1)}},{key:"patchData",value:function(a,s,o){var h=m5(o),v;try{for(h.s();!(v=h.n()).done;){var m=v.value,E=m.attr,A=m.count,F=s[E];F!==void 0?E==="stroke"?a.push.apply(a,(0,ge.Z)(ke(F))):E==="offsets"?this.isOffsetStatic(F)?a.push(-F[0],F[1]):a.push(0,0):a.push((0,te.isNumber)(F)?F:1):this.patchMod(a,A)}}catch(B){h.e(B)}finally{h.f()}}},{key:"calDataFrame",value:function(a,s,o){for(var h=s.length,v=Math.ceil(h*a/this.DATA_TEXTURE_WIDTH),m=v*this.DATA_TEXTURE_WIDTH,E=[],A=0;A<h;A++){var F=s[A];this.patchData(E,F,o)}for(var B=E.length;B<m;B++)E.push(-1);return{data:E,width:this.DATA_TEXTURE_WIDTH,height:v}}},{key:"getBlend",value:function(){var a=this.layer.getLayerConfig(),s=a.blend,o=s===void 0?"normal":s;return ox[Sp[o]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){var l=(0,ut.Z)(it().mark(function s(){return it().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",!1);case 1:case"end":return h.stop()}},s)}));function a(){return l.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var l=(0,ut.Z)(it().mark(function s(){return it().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return h.stop()}},s)}));function a(){return l.apply(this,arguments)}return a}()},{key:"initModels",value:function(){var l=(0,ut.Z)(it().mark(function s(){return it().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return h.stop()}},s)}));function a(){return l.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(a){return[a.enable?0:1,a.duration||4,a.interval||.2,a.trailLength||.1]}},{key:"startModelAnimate",value:function(){var a=this.layer.getLayerConfig(),s=a.animateOption;s.enable&&this.layer.setAnimateStartTime()}}]),n}(),MS=Dr(gx.prototype,"configService",[TS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gx),mx=100,Nh=36,vg=40;function hl(n){return n/180*Math.acos(-1)}function Xs(n){var l=hl(n[0])+Math.PI/2,a=hl(n[1]),s=mx+Math.random()*.4,o=s*Math.cos(a)*Math.cos(l),h=s*Math.cos(a)*Math.sin(l),v=s*Math.sin(a);return[h,v,o]}function ms(n,l){var a=mat4.create(),s=mat4.create(),o=vec3.fromValues(0,1,0),h=vec3.fromValues(0,0,0);l=l||{},n=typeof n!="undefined"?n:1;for(var v=typeof l.segments!="undefined"?l.segments:32,m=2+v,E=2*m,A=[],F=[],B=[],V=[],j=[],nt=[],at=0;at<=m;at++){for(var mt=at/m,Bt=mt*Math.PI,de=0;de<=E;de++){var ce=de/E,Be=ce*Math.PI*2;mat4.identity(s),mat4.rotateZ(s,s,-Bt),mat4.identity(a),mat4.rotateY(a,a,Be),vec3.transformMat4(h,o,s),vec3.transformMat4(h,h,a),vec3.scale(h,h,-n),B.push(h.slice()),V.push.apply(V,_toConsumableArray(h.slice())),vec3.normalize(h,h),j.push.apply(j,_toConsumableArray(h.slice())),nt.push([ce,1-mt]),V.push(ce,1-mt)}if(at>0)for(var Xe=B.length,_r=Xe-2*(E+1);_r+E+2<Xe;_r++)A.push([_r,_r+1,_r+E+1]),F.push(_r,_r+1,_r+E+1),A.push([_r+E+1,_r+1,_r+E+2]),F.push(_r+E+1,_r+1,_r+E+2)}return{cells:A,positions:B,uvs:nt,positionsArr:V,indicesArr:F,normalArr:j}}var Bo=ei.Ue(),S0=ei.Ue(),Vu=ei.Ue(),ad=ei.Ue(),Zs=ei.Ue();function Ys(n,l,a,s,o){ei.IH(n,a,s),ei.Fv(n,n),l=ei.al(-n[1],n[0]);var h=ei.al(-a[1],a[0]);return[o/ei.AK(l,h),l]}function Df(n,l){return ei.t8(n,-l[1],l[0])}function w0(n,l,a){return ei.lu(n,l,a),ei.Fv(n,n),n}function ky(n,l){return n[0]===l[0]&&n[1]===l[1]}function FR(n){for(var l=new Map,a=0;a<n.length;a++){var s=n[0].toString()+"-"+n[1].toString();l.get(s)?(n.splice(a,1),a++):l.set(s,s)}return n}var Ly=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,lt.Z)(this,n),(0,W.Z)(this,"lastFlip",-1),(0,W.Z)(this,"miter",ei.al(0,0)),(0,W.Z)(this,"started",!1),(0,W.Z)(this,"dash",!1),(0,W.Z)(this,"totalDistance",0),(0,W.Z)(this,"currentIndex",0),this.join=l.join||"miter",this.cap=l.cap||"butt",this.miterLimit=l.miterLimit||10,this.thickness=l.thickness||1,this.dash=l.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,tt.Z)(n,[{key:"simpleExtrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var o=a.length,h=s.startIndex,v=1;v<o;v++){var m=a[v-1],E=a[v],A=v<a.length-1?a[v+1]:null,F=this.simpleSegment(s,h,m,E,A);h+=F}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"simpleExtrude_gaode2",value:function(a,s){var o=this.complex;if(a.length<=1)return o;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=o.startIndex,m=1;m<h;m++){var E,A,F,B=a[m-1];B.push((E=s[m-1][2])!==null&&E!==void 0?E:0);var V=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var nt=s[m],at=m<a.length-1?[].concat((0,ge.Z)(a[m+1]),[(F=s[m+1][2])!==null&&F!==void 0?F:0]):null,mt=m<s.length-1?s[m+1]:null,Bt=this.simpleSegment(o,v,B,j,at,V,nt,mt);v+=Bt}if(this.dash)for(var de=0;de<o.positions.length/6;de++)o.positions[de*6+5]=this.totalDistance;return o.startIndex=o.positions.length/6,o}},{key:"extrude_gaode2",value:function(a,s){var o=this.complex;if(a.length<=1)return o;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=o.startIndex,m=1;m<h;m++){var E,A,F,B=a[m-1];B.push((E=s[m-1][2])!==null&&E!==void 0?E:0);var V=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var nt=s[m],at=m<a.length-1?[].concat((0,ge.Z)(a[m+1]),[(F=s[m+1][2])!==null&&F!==void 0?F:0]):null,mt=m<s.length-1?s[m+1]:null,Bt=this.segment_gaode2(o,v,B,j,at,V,nt,mt);v+=Bt}if(this.dash)for(var de=0;de<o.positions.length/6;de++)o.positions[de*6+5]=this.totalDistance;return o.startIndex=o.positions.length/6,o}},{key:"extrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var o=a.length,h=s.startIndex,v=1;v<o;v++){var m=a[v-1],E=a[v],A=v<a.length-1?a[v+1]:null,F=this.segment(s,h,m,E,A);h+=F}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"simpleSegment",value:function(a,s,o,h,v){var m=0,E=a.indices,A=a.positions,F=a.normals,B=Ko([h[0],h[1]]),V=Ko([o[0],o[1]]);w0(Vu,B,V);var j=0;if(this.dash&&(j=this.lineSegmentDistance(B,V),this.totalDistance+=j),this.normal||(this.normal=ei.Ue(),Df(this.normal,Vu)),this.started||(this.started=!0,this.extrusions(A,F,o,this.normal,this.thickness,this.totalDistance-j)),E.push(s+0,s+1,s+2),!v)Df(this.normal,Vu),this.extrusions(A,F,h,this.normal,this.thickness,this.totalDistance),E.push.apply(E,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2;else{var nt=Ko([v[0],v[1]]);ky(B,nt)&&ei.IH(nt,B,ei.Fv(nt,ei.$X(nt,B,V))),w0(ad,nt,B);var at=Ys(Zs,ei.Ue(),Vu,ad,this.thickness),mt=(0,ht.Z)(at,2),Bt=mt[0],de=mt[1],ce=ei.AK(Zs,this.normal)<0?-1:1;this.extrusions(A,F,h,de,Bt,this.totalDistance),E.push.apply(E,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),ce=-1,ei.JG(this.normal,de),m+=2,this.lastFlip=ce}return m}},{key:"segment_gaode2",value:function(a,s,o,h,v,m,E,A){var F=0,B=a.indices,V=a.positions,j=a.normals,nt=this.cap==="square",at=this.join==="bevel",mt=Ko([E[0],E[1]]),Bt=Ko([m[0],m[1]]);w0(Vu,h,o);var de=0;if(this.dash&&(de=this.lineSegmentDistance(mt,Bt),this.totalDistance+=de),this.normal||(this.normal=ei.Ue(),Df(this.normal,Vu)),!this.started)if(this.started=!0,nt){var ce=ei.Ue(),Be=ei.Ue();ei.IH(ce,this.normal,Vu),ei.IH(Be,this.normal,Vu),j.push(Be[0],Be[1],0),j.push(ce[0],ce[1],0),V.push(o[0],o[1],o[2]|0,this.totalDistance-de,-this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),V.push(o[0],o[1],o[2]|0,this.totalDistance-de,this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(V,j,o,this.normal,this.thickness,this.totalDistance-de);if(B.push(s+0,s+1,s+2),v){ky(h,v)&&ei.IH(v,h,ei.Fv(v,ei.$X(v,h,o))),w0(ad,v,h);var Ir=Ys(Zs,ei.Ue(),Vu,ad,this.thickness),Nr=(0,ht.Z)(Ir,2),Yr=Nr[0],yn=Nr[1],fn=ei.AK(Zs,this.normal)<0?-1:1,$n=at;if(!$n&&this.join==="miter"){var di=Yr;di>this.miterLimit&&($n=!0)}$n?(j.push(this.normal[0],this.normal[1],0),j.push(yn[0],yn[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,B.push.apply(B,(0,ge.Z)(this.lastFlip!==-fn?[s,s+2,s+3]:[s+2,s+1,s+3])),B.push(s+2,s+3,s+4),Df(Bo,ad),ei.JG(this.normal,Bo),j.push(this.normal[0],this.normal[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,F+=3):(this.extrusions(V,j,h,yn,Yr,this.totalDistance),B.push.apply(B,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),fn=-1,ei.JG(this.normal,yn),F+=2),this.lastFlip=fn}else{if(Df(this.normal,Vu),nt){var Xe=ei.Ue(),_r=ei.Ue();ei.lu(_r,Vu,this.normal),ei.IH(Xe,Vu,this.normal),j.push(_r[0],_r[1],0),j.push(Xe[0],Xe[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(V,j,h,this.normal,this.thickness,this.totalDistance);B.push.apply(B,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),F+=2}return F}},{key:"segment",value:function(a,s,o,h,v){var m=0,E=a.indices,A=a.positions,F=a.normals,B=this.cap==="square",V=this.join==="bevel",j=Ko([h[0],h[1]]),nt=Ko([o[0],o[1]]);w0(Vu,j,nt);var at=0;if(this.dash&&(at=this.lineSegmentDistance(j,nt),this.totalDistance+=at),this.normal||(this.normal=ei.Ue(),Df(this.normal,Vu)),!this.started)if(this.started=!0,B){var mt=ei.Ue(),Bt=ei.Ue();ei.IH(mt,this.normal,Vu),ei.IH(Bt,this.normal,Vu),F.push(Bt[0],Bt[1],0),F.push(mt[0],mt[1],0),A.push(o[0],o[1],o[2]|0,this.totalDistance-at,-this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),A.push(o[0],o[1],o[2]|0,this.totalDistance-at,this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,F,o,this.normal,this.thickness,this.totalDistance-at);if(E.push(s+0,s+1,s+2),v){var Be=Ko([v[0],v[1]]);ky(j,Be)&&ei.IH(Be,j,ei.Fv(Be,ei.$X(Be,j,nt))),w0(ad,Be,j);var Xe=Ys(Zs,ei.Ue(),Vu,ad,this.thickness),_r=(0,ht.Z)(Xe,2),Ir=_r[0],Nr=_r[1],Yr=ei.AK(Zs,this.normal)<0?-1:1,yn=V;if(!yn&&this.join==="miter"){var fn=Ir;fn>this.miterLimit&&(yn=!0)}yn?(F.push(this.normal[0],this.normal[1],0),F.push(Nr[0],Nr[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,E.push.apply(E,(0,ge.Z)(this.lastFlip!==-Yr?[s,s+2,s+3]:[s+2,s+1,s+3])),E.push(s+2,s+3,s+4),Df(Bo,ad),ei.JG(this.normal,Bo),F.push(this.normal[0],this.normal[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,m+=3):(this.extrusions(A,F,h,Nr,Ir,this.totalDistance),E.push.apply(E,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),Yr=-1,ei.JG(this.normal,Nr),m+=2),this.lastFlip=Yr}else{if(Df(this.normal,Vu),B){var de=ei.Ue(),ce=ei.Ue();ei.lu(ce,Vu,this.normal),ei.IH(de,Vu,this.normal),F.push(ce[0],ce[1],0),F.push(de[0],de[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,F,h,this.normal,this.thickness,this.totalDistance);E.push.apply(E,(0,ge.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2}return m}},{key:"extrusions",value:function(a,s,o,h,v,m){s.push(h[0],h[1],0),s.push(h[0],h[1],0),a.push(o[0],o[1],o[2]|0,m,-v,o[2]|0),this.complex.indexes.push(this.currentIndex),a.push(o[0],o[1],o[2]|0,m,v,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(a,s){var o=s[0]-a[0],h=s[1]-a[1];return Math.sqrt(o*o+h*h)}}]),n}(),wo=ot(77160);function yx(n){var l=n[0][0],a=n[0][n[0].length-1];l[0]===a[0]&&l[1]===a[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var s=n[0].length,o=earcut.flatten(n),h=o.vertices,v=o.dimensions,m=[],E=[],A=0;A<h.length/v;A++)v===2?m.push(h[A*2],h[A*2+1],1):m.push(h[A*3],h[A*3+1],1);var F=earcut(o.vertices,o.holes,o.dimensions);E.push.apply(E,_toConsumableArray(F));for(var B=function(nt){var at=o.vertices.slice(nt*v,(nt+1)*v),mt=o.vertices.slice((nt+1)*v,(nt+2)*v);mt.length===0&&(mt=o.vertices.slice(0,v));var Bt=m.length/3;m.push(at[0],at[1],1,mt[0],mt[1],1,at[0],at[1],0,mt[0],mt[1],0),E.push.apply(E,_toConsumableArray([0,2,1,2,3,1].map(function(de){return de+Bt})))},V=0;V<s;V++)B(V);return{positions:m,index:E}}function GO(n){var l=earcut.flatten(n),a=earcut(l.vertices,l.holes,l.dimensions);return{positions:l.vertices,index:a}}function kS(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=n[0][0],s=n[0][n[0].length-1];a[0]===s[0]&&a[1]===s[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var o=n[0].length,h=wl().flatten(n),v=h.vertices,m=h.dimensions,E=[],A=[],F=[],B=0;B<v.length/m;B++)m===2?E.push(v[B*2],v[B*2+1],1,-1,-1):E.push(v[B*3],v[B*3+1],1,-1,-1),F.push(0,0,1);var V=wl()(h.vertices,h.holes,h.dimensions);A.push.apply(A,(0,ge.Z)(V));for(var j=function(mt){var Bt=h.vertices.slice(mt*m,(mt+1)*m),de=h.vertices.slice((mt+1)*m,(mt+2)*m);de.length===0&&(de=h.vertices.slice(0,m));var ce=E.length/5;E.push(Bt[0],Bt[1],1,0,0,de[0],de[1],1,.1,0,Bt[0],Bt[1],0,0,.8,de[0],de[1],0,.1,.8);var Be=zh([de[0],de[1],1],[Bt[0],Bt[1],0],[Bt[0],Bt[1],1],l);F.push.apply(F,(0,ge.Z)(Be).concat((0,ge.Z)(Be),(0,ge.Z)(Be),(0,ge.Z)(Be))),A.push.apply(A,(0,ge.Z)([1,2,0,3,2,1].map(function(Xe){return Xe+ce})))},nt=0;nt<o;nt++)j(nt);return{positions:E,index:A,normals:F}}function zh(n,l,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=wo.create(),h=wo.create(),v=wo.create();s&&(n=Bp(n),l=Bp(l),a=Bp(a));var m=wo.fromValues.apply(wo,(0,ge.Z)(n)),E=wo.fromValues.apply(wo,(0,ge.Z)(l)),A=wo.fromValues.apply(wo,(0,ge.Z)(a));wo.sub(o,A,E),wo.sub(h,m,E),wo.cross(v,o,h);var F=wo.create();return wo.normalize(F,v),F}var vf,Uh;(function(n){n.CYLINDER="cylinder",n.SQUARECOLUMN="squareColumn",n.TRIANGLECOLUMN="triangleColumn",n.HEXAGONCOLUMN="hexagonColumn",n.PENTAGONCOLUMN="pentagonColumn"})(Uh||(Uh={}));var Fl;(function(n){n.CIRCLE="circle",n.SQUARE="square",n.TRIANGLE="triangle",n.HEXAGON="hexagon",n.PENTAGON="pentagon"})(Fl||(Fl={}));function Gv(n){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Math.PI*2/n,s=[],o=0;o<n;o++)s.push(a*o+l*Math.PI/12);var h=s.map(function(v){var m=Math.sin(v+Math.PI/4),E=Math.cos(v+Math.PI/4);return[m,E,0]});return h}function _x(){return Gv(30)}function LS(){return Gv(4)}function ac(){return Gv(3)}function C0(){return Gv(6,1)}function Bf(){return Gv(5)}var gg=(vf={},(0,W.Z)(vf,Fl.CIRCLE,_x),(0,W.Z)(vf,Fl.HEXAGON,C0),(0,W.Z)(vf,Fl.TRIANGLE,ac),(0,W.Z)(vf,Fl.SQUARE,LS),(0,W.Z)(vf,Fl.PENTAGON,Bf),(0,W.Z)(vf,Uh.CYLINDER,_x),(0,W.Z)(vf,Uh.HEXAGONCOLUMN,C0),(0,W.Z)(vf,Uh.TRIANGLECOLUMN,ac),(0,W.Z)(vf,Uh.SQUARECOLUMN,LS),(0,W.Z)(vf,Uh.PENTAGONCOLUMN,Bf),vf),mg={};function A0(n){var l=bs(n.coordinates);return{vertices:[].concat((0,ge.Z)(l),(0,ge.Z)(l),(0,ge.Z)(l),(0,ge.Z)(l)),indices:[0,1,2,2,3,0],size:l.length}}function PS(n){var l=bs(n.coordinates),a=Xs(l);return{vertices:[].concat((0,ge.Z)(a),(0,ge.Z)(a),(0,ge.Z)(a),(0,ge.Z)(a)),indices:[0,1,2,2,3,0],size:a.length}}function xx(n){var l=n.shape,a=DS(l,!1),s=a.positions,o=a.index,h=a.normals;return{vertices:s,indices:o,normals:h,size:5}}function OS(n){var l=bs(n.coordinates);return{vertices:(0,ge.Z)(l),indices:[0],size:l.length}}function Ha(n){var l=n.coordinates,a=n.originCoordinates,s=n.version,o=new Ly({dash:!0,join:"bevel"});if(s==="GAODE2.x"){var h=l;Array.isArray(h[0][0])||(h=[l]);var v=a;Array.isArray(v[0][0])||(v=[a]);for(var m=0;m<h.length;m++){var E=h[m],A=v[m];o.extrude_gaode2(E,A)}}else{var F=l;F[0]&&!Array.isArray(F[0][0])&&(F=[l]),F.forEach(function(V){o.extrude(V)})}var B=o.complex;return{vertices:B.positions,indices:B.indices,normals:B.normals,indexes:B.indexes,size:6}}function FS(n){var l=n.coordinates,a=[];if(!Array.isArray(l[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var s=Py(l),o=s.results,h=s.totalDistance;return o.map(function(v){a.push(v[0],v[1],v[2],v[3],0,h)}),{vertices:a,indices:[],normals:[],size:6,count:o.length}}function HO(n){var l=n.coordinates,a=[];if(!Array.isArray(l[0]))return{vertices:[],indices:[],size:4,count:0};var s=_5(l),o=s.results;return o.map(function(h){a.push(h[0],h[1],h[2],h[3])}),{vertices:a,indices:[],size:4,count:o.length}}function yg(n,l){var a=l[0]-n[0],s=l[1]-n[1];return Math.sqrt(a*a+s*s)}function _g(n,l){return n.length<3&&n.push(0),l!==void 0&&n.push(l),n}function Py(n){var l=n;Array.isArray(l)&&Array.isArray(l[0])&&Array.isArray(l[0][0])&&(l=n.flat());var a=0;if(l.length<2)return{results:l,totalDistance:0};var s=[],o=_g(l[0],a);s.push(o);for(var h=1;h<l.length-1;h++){var v=yg(l[h-1],l[h]);a+=v;var m=_g(l[h],a);s.push(m),s.push(m)}var E=yg(l[l.length-2],l[l.length-1]);return a+=E,s.push(_g(l[l.length-1],a)),{results:s,totalDistance:a}}function _5(n){if(n.length<2)return{results:n};var l=[],a=_g(n[0]);l.push(a);for(var s=1;s<n.length-1;s++){var o=_g(n[s]);l.push(o),l.push(o)}return l.push(_g(n[n.length-1])),{results:l}}function xg(n){var l=n.coordinates,a=wl().flatten(l),s=a.vertices,o=a.dimensions,h=a.holes;return{indices:wl()(s,h,o),vertices:s,size:o}}function RS(n){var l=n.coordinates,a=wl().flatten(l),s=a.vertices,o=a.dimensions,h=a.holes;return{indices:wl()(s,h,o),vertices:x5(s),size:o+4}}function x5(n){for(var l=[],a=Ac(n),s=a.center,o=a.radius,h=0;h<n.length;h+=2){var v=n[h],m=n[h+1];l.push.apply(l,[v,m,0].concat((0,ge.Z)(s),[o]))}return l}function b5(n){var l=n.coordinates,a=kS(l,!0),s=a.positions,o=a.index,h=a.normals;return{vertices:s,indices:o,normals:h,size:5}}function E5(n){var l=n.shape,a=w5(l),s=a.positions,o=a.index;return{vertices:s,indices:o,size:3}}function Oy(n){var l=n.coordinates,a=[].concat((0,ge.Z)(l[0]),[0,0,1,l[1][0],l[0][1],0,1,1],(0,ge.Z)(l[1]),[0,1,0],(0,ge.Z)(l[0]),[0,0,1],(0,ge.Z)(l[1]),[0,1,0,l[0][0],l[1][1],0,0,0]),s=[0,1,2,3,4,5];return{vertices:a,indices:s,size:5}}function Fy(n,l){for(var a=l||30,s=n.coordinates,o=[],h=[],v=function(A){o.push(A,1,A,s[0][0],s[0][1],s[1][0],s[1][1],A,-1,A,s[0][0],s[0][1],s[1][0],s[1][1]),A!==a-1&&h.push.apply(h,(0,ge.Z)([0,1,2,1,3,2].map(function(F){return A*2+F})))},m=0;m<a;m++)v(m);return{vertices:o,indices:h,size:7}}function jO(n){var l=n.coordinates;l.length===2&&l.push(0);var a=Ry(-1,1),s=Ry(1,1),o=Ry(-1,-1),h=Ry(1,-1),v=[].concat(_toConsumableArray(l),_toConsumableArray(a),_toConsumableArray(l),_toConsumableArray(o),_toConsumableArray(l),_toConsumableArray(h),_toConsumableArray(l),_toConsumableArray(s)),m=[0,1,2,3,0,2];return{vertices:v,indices:m,size:5}}function DS(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(mg&&mg[n])return mg[n];var a=gg[n]?gg[n]():gg.cylinder(),s=kS([a],l);return mg[n]=s,s}function WO(n,l){for(var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=new Float32Array(n.length/a*3),h,v,m,E=vec3.create(),A=vec3.create(),F=vec3.create(),B=0,V=l.length;B<V;B+=3){h=l[B+0]*3,v=l[B+1]*3,m=l[B+2]*3;var j=[n[h],n[h+1]],nt=[n[v],n[v+1]],at=[n[m],n[m+1]];s&&(j=lngLatToMeters(j),nt=lngLatToMeters(nt),at=lngLatToMeters(at));var mt=j,Bt=_slicedToArray(mt,2),de=Bt[0],ce=Bt[1],Be=vec3.fromValues(de,ce,n[h+2]),Xe=nt,_r=_slicedToArray(Xe,2),Ir=_r[0],Nr=_r[1],Yr=vec3.fromValues(Ir,Nr,n[v+2]),yn=at,fn=_slicedToArray(yn,2),$n=fn[0],di=fn[1],Yi=vec3.fromValues($n,di,n[m+2]);vec3.sub(E,Yi,Yr),vec3.sub(A,Be,Yr),vec3.cross(F,E,A),o[h]+=E[0],o[h+1]+=E[1],o[h+2]+=E[2],o[v]+=E[0],o[v+1]+=E[1],o[v+2]+=E[2],o[m]+=E[0],o[m+1]+=E[1],o[m+2]+=E[2]}return S5(o),o}function S5(n){for(var l=0,a=n.length;l<a;l+=3){var s=vec3.fromValues(n[l],n[l+1],n[l+2]),o=vec3.create();vec3.normalize(o,s),n.set(o,l)}}function XO(n){var l=n[0][0],a=n[0][n[0].length-1];return l[0]===a[0]&&l[1]===a[1]}function w5(n){var l=["cylinder","triangleColumn","hexagonColumn","squareColumn"],a=geometryShape[n]?geometryShape[n]():geometryShape.circle(),s=l.indexOf(n)===-1?fillPolygon([a]):extrudePolygon([a]);return s}function Ry(n,l){var a=(n+1)/2,s=(l+1)/2;return[a,s]}function YO(){var n=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),l=n.positionsArr,a=n.indicesArr,s=n.normalArr;return{vertices:l,indices:a,size:5,normals:s}}function Hv(){var n=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),l=n.positionsArr,a=n.indicesArr,s=n.normalArr;return{vertices:l,indices:a,size:5,normals:s}}function T0(n){var l=BS();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function BS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var NS=`
uniform float u_opacity;

varying vec4 v_dash_array;
varying vec4 v_color;

uniform float segmentNumber;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;

  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  };
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,M0=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;

  styleMappingMat[3].b = segmentIndex / segmentNumber;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  gl_PointSize = 5.0;
  setPickingColor(a_PickingColor);
}
`,bx=`
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  
  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = styleMappingMat[3].g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = styleMappingMat[3].a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
}`,C5=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  float arcThetaOffset = styleMappingMat[0][1];
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, arcThetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, arcThetaOffset), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
     styleMappingMat[3].g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,zS=`#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}`,A5=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,Dy={solid:0,dash:1},T5=function(n){(0,Ut.Z)(a,n);var l=T0(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Kt.NEAREST,min:Kt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.lineType,V=B===void 0?"solid":B,j=o.dashArray,nt=j===void 0?[10,5]:j,at=o.forward,mt=at===void 0?!0:at,Bt=o.lineTexture,de=Bt===void 0?!1:Bt,ce=o.iconStep,Be=ce===void 0?100:ce,Xe=o.segmentNumber,_r=Xe===void 0?30:Xe,Ir=o.thetaOffset,Nr=Ir===void 0?.314:Ir;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,thetaOffset:Nr})){this.judgeStyleAttributes({opacity:v,thetaOffset:Nr});var Yr=this.layer.getEncodedData(),yn=this.calDataFrame(this.cellLength,Yr,this.cellProperties),fn=yn.data,$n=yn.width,di=yn.height;this.rowCount=di,this.dataTexture=this.cellLength>0&&fn.length>0?this.createTexture2D({flipY:!0,data:fn,format:Kt.LUMINANCE,type:Kt.FLOAT,width:$n,height:di}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}nt.length===2&&nt.push(0,0);var Yi=0,ho=[0,0,0,0],zo=[0,0,0,0];return m&&E&&(ho=ke(m),zo=ke(E),Yi=1),this.rendererService.getDirty()&&this.texture.bind(),{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_thetaOffset:(0,te.isNumber)(Nr)?Nr:0,u_opacity:(0,te.isNumber)(v)?v:1,u_textureBlend:F==="normal"?0:1,segmentNumber:_r,u_line_type:Dy[V||"solid"],u_dash_array:nt,u_blur:.9,u_lineDir:mt?1:-1,u_texture:this.texture,u_line_texture:de?1:0,u_icon_step:Be,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Yi,u_sourceColor:ho,u_targetColor:zo}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.sourceColor,v=o.targetColor,m=o.lineType;return m==="dash"?{frag:NS,vert:M0,type:"Dash"}:h&&v?{frag:zS,vert:A5,type:"Linear"}:{frag:bx,vert:C5,type:""}}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at,mt,Bt;return it().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return v=this.layer.getLayerConfig(),m=v.segmentNumber,E=m===void 0?30:m,A=v.mask,F=A===void 0?!1:A,B=v.maskInside,V=B===void 0?!0:B,j=this.getShaders(),nt=j.frag,at=j.vert,mt=j.type,ce.next=4,this.layer.buildLayerModel({moduleName:"lineArc2d"+mt,vertexShader:at,fragmentShader:nt,triangulation:Fy,depth:{enable:!1},blend:this.getBlend(),segmentNumber:E,stencil:Rr(F,V)});case 4:return Bt=ce.sent,ce.abrupt("return",[Bt]);case 6:case"end":return ce.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Vi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:4,update:function(v,m,E){return[E[3],E[4],E[5],E[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(ws);function M5(n){var l=I5();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function I5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var k5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,L5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,P5=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Ex=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,O5={solid:0,dash:1},F5=function(n){(0,Ut.Z)(a,n);var l=M5(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Kt.NEAREST,min:Kt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.lineType,V=B===void 0?"solid":B,j=o.dashArray,nt=j===void 0?[10,5]:j,at=o.lineTexture,mt=at===void 0?!1:at,Bt=o.iconStep,de=Bt===void 0?100:Bt,ce=o.segmentNumber,Be=ce===void 0?30:ce,Xe=o.globalArcHeight,_r=Xe===void 0?10:Xe;nt.length===2&&nt.push(0,0);var Ir=0,Nr=[0,0,0,0],Yr=[0,0,0,0];if(m&&E&&(Nr=ke(m),Yr=ke(E),Ir=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var yn=this.layer.getEncodedData(),fn=this.calDataFrame(this.cellLength,yn,this.cellProperties),$n=fn.data,di=fn.width,Yi=fn.height;this.rowCount=Yi,this.dataTexture=this.cellLength>0&&$n.length>0?this.createTexture2D({flipY:!0,data:$n,format:Kt.LUMINANCE,type:Kt.FLOAT,width:di,height:Yi}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:mx,u_global_height:_r,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(v)?v:1,u_textureBlend:F==="normal"?0:1,segmentNumber:Be,u_line_type:O5[V]||0,u_dash_array:nt,u_texture:this.texture,u_line_texture:mt?1:0,u_icon_step:de,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Ir,u_sourceColor:Nr,u_targetColor:Yr}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.sourceColor,v=o.targetColor;return h&&v?{frag:P5,vert:Ex,type:"Linear"}:{frag:k5,vert:L5,type:""}}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at,mt,Bt;return it().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return v=this.layer.getLayerConfig(),m=v.segmentNumber,E=m===void 0?30:m,A=v.mask,F=A===void 0?!1:A,B=v.maskInside,V=B===void 0?!0:B,j=this.getShaders(),nt=j.frag,at=j.vert,mt=j.type,ce.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+mt,vertexShader:at,fragmentShader:nt,triangulation:Fy,blend:this.getBlend(),segmentNumber:E,stencil:Rr(F,V)});case 4:return Bt=ce.sent,ce.abrupt("return",[Bt]);case 6:case"end":return ce.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Vi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:4,update:function(v,m,E){return[E[3],E[4],E[5],E[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(ws);function R5(n){var l=D5();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function D5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var By=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,B5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,N5=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,z5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,U5={solid:0,dash:1},Z5=function(n){(0,Ut.Z)(a,n);var l=R5(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Kt.NEAREST,min:Kt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.lineType,V=B===void 0?"solid":B,j=o.dashArray,nt=j===void 0?[10,5]:j,at=o.lineTexture,mt=at===void 0?!1:at,Bt=o.iconStep,de=Bt===void 0?100:Bt,ce=o.segmentNumber,Be=ce===void 0?30:ce,Xe=o.globalArcHeight,_r=Xe===void 0?10:Xe;nt.length===2&&nt.push(0,0);var Ir=0,Nr=[0,0,0,0],Yr=[0,0,0,0];if(m&&E&&(Nr=ke(m),Yr=ke(E),Ir=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var yn=this.layer.getEncodedData(),fn=this.calDataFrame(this.cellLength,yn,this.cellProperties),$n=fn.data,di=fn.width,Yi=fn.height;this.rowCount=Yi,this.dataTexture=this.cellLength>0&&$n.length>0?this.createTexture2D({flipY:!0,data:$n,format:Kt.LUMINANCE,type:Kt.FLOAT,width:di,height:Yi}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_globel:1,u_globel_radius:mx,u_global_height:_r,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(v)?v:1,u_textureBlend:F==="normal"?0:1,segmentNumber:Be,u_line_type:U5[V]||0,u_dash_array:nt,u_texture:this.texture,u_line_texture:mt?1:0,u_icon_step:de,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Ir,u_sourceColor:Nr,u_targetColor:Yr}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.sourceColor,v=o.targetColor;return h&&v?{frag:N5,vert:z5,type:"Linear"}:{frag:By,vert:B5,type:""}}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at,mt,Bt;return it().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return v=this.layer.getLayerConfig(),m=v.segmentNumber,E=m===void 0?30:m,A=v.mask,F=A===void 0?!1:A,B=v.maskInside,V=B===void 0?!0:B,j=this.getShaders(),nt=j.frag,at=j.vert,mt=j.type,ce.next=4,this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+mt,vertexShader:at,fragmentShader:nt,triangulation:Fy,depth:{enable:!0},blend:this.getBlend(),segmentNumber:E,stencil:Rr(F,V)});case 4:return Bt=ce.sent,ce.abrupt("return",[Bt]);case 6:case"end":return ce.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Vi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:4,update:function(v,m,E){return[E[3],E[4],E[5],E[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(ws);function US(n){var l=V5();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function V5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ZS=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0;
  float d_segmentIndex = styleMappingMat[3].g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = gl_FragColor.a/opacity;
    }

    float v = styleMappingMat[3].a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,G5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  styleMappingMat[3].g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,VS={solid:0,dash:1},Sx=function(n){(0,Ut.Z)(a,n);var l=US(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Kt.NEAREST,min:Kt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.lineType,V=B===void 0?"solid":B,j=o.dashArray,nt=j===void 0?[10,5]:j,at=o.lineTexture,mt=at===void 0?!1:at,Bt=o.iconStep,de=Bt===void 0?100:Bt,ce=o.segmentNumber,Be=ce===void 0?30:ce;nt.length===2&&nt.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var Xe=0,_r=[0,0,0,0],Ir=[0,0,0,0];if(m&&E&&(_r=ke(m),Ir=ke(E),Xe=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var Nr=this.layer.getEncodedData(),Yr=this.calDataFrame(this.cellLength,Nr,this.cellProperties),yn=Yr.data,fn=Yr.width,$n=Yr.height;this.rowCount=$n,this.dataTexture=this.cellLength>0&&yn.length>0?this.createTexture2D({flipY:!0,data:yn,format:Kt.LUMINANCE,type:Kt.FLOAT,width:fn,height:$n}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(v)?v:1,u_textureBlend:F==="normal"?0:1,segmentNumber:Be,u_line_type:VS[V]||0,u_dash_array:nt,u_texture:this.texture,u_line_texture:mt?1:0,u_icon_step:de,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Xe,u_sourceColor:_r,u_targetColor:Ir}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:G5,fragmentShader:ZS,triangulation:Fy,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Vi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:4,update:function(v,m,E){return[E[3],E[4],E[5],E[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(ws);function jv(n){var l=Wv();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Wv(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Kd=`#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0
uniform float u_CoordinateSystem;
varying vec4 v_color;
uniform float u_arrow: 0.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

varying mat4 styleMappingMat;
void main() {
  float distanceAndIndex = styleMappingMat[0][3];
  float miter = styleMappingMat[0][2];

  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B


  if(u_arrow > 0.0 && distanceAndIndex < 2.0) { // arrow
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) { 
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z < 0.0) { // amap
        discard;
      }
    } else { // amap2 mapbox map
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z > 0.0) { 
        discard;
      }
    }
  } else { // line body
    if(miter < 0.0) {
      discard;
    }
  }


  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,Cx=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute vec4 a_dirPoints;
attribute vec3 a_DistanceAndIndex;

uniform vec4 u_lineDir;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - a_Miter - a_DistanceAndIndex
    0.0, 0.0, 0.0, 0.0, // originX - originY - vectorX - vectorY
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );
  styleMappingMat[0][3] = a_DistanceAndIndex.y;
  styleMappingMat[0][2] = a_Miter;

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97


  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  // styleMappingMat[1].rg = a_Position.xy + offset;

  vec2 copyOffset = vec2(offset.x, offset.y);

  float lineDistance = a_DistanceAndIndex.x;
  float total_Distance = a_DistanceAndIndex.z;
  float currentLinePointRatio = lineDistance / total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z); // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }
  
  if(u_arrow > 0.0 && a_DistanceAndIndex.y < 2.0) {
    vec2 startPoint = a_dirPoints.rg;
    vec2 endPoint = a_dirPoints.ba;
    vec4 t1 = project_position(vec4(startPoint, 0, 1.0));
    vec4 t2 = project_position(vec4(endPoint, 0, 1.0));
    // TODO\uFF1A \u540E\u7EED\u4F18\u5316\u53EF\u4EE5\u628A\u4F4D\u7F6E\u8BA1\u7B97\u653E\u5728 cpu \u4E2D\u5B8C\u6210
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      vec2 p1 = (u_Mvp * vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = (u_Mvp * vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    } else {
      vec2 p1 = project_common_position_to_clipspace(vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = project_common_position_to_clipspace(vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    }
  }

  setPickingColor(a_PickingColor);
}
`,cm=function(n){(0,Ut.Z)(a,n);var l=jv(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.arrow,F=A===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:A,B=0,V=[0,0,0,0],j=[0,0,0,0];if(m&&E&&(V=ke(m),j=ke(E),B=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var nt=this.layer.getEncodedData(),at=this.calDataFrame(this.cellLength,nt,this.cellProperties),mt=at.data,Bt=at.width,de=at.height;this.rowCount=de,this.dataTexture=this.cellLength>0&&mt.length>0?this.createTexture2D({flipY:!0,data:mt,format:Kt.LUMINANCE,type:Kt.FLOAT,width:Bt,height:de}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(v)?v:1,u_linearColor:B,u_sourceColor:V,u_targetColor:j,u_arrow:Number(F.enable),u_arrowHeight:F.arrowHeight||3,u_arrowWidth:F.arrowWidth||2,u_tailWidth:F.tailWidth===void 0?1:F.tailWidth}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at,mt;return it().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.depth,V=B===void 0?!1:B,j=this.getShaders(),nt=j.frag,at=j.vert,this.layer.triangulation=Ha,de.next=5,this.layer.buildLayerModel({moduleName:"lineHalf",vertexShader:at,fragmentShader:nt,triangulation:Ha,depth:{enable:V},blend:this.getBlend(),stencil:Rr(E,F)});case 5:return mt=de.sent,de.abrupt("return",[mt]);case 7:case"end":return de.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getShaders",value:function(){return{frag:Kd,vert:Cx,type:"normal"}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Vi.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(h,v,m,E,A,F){return F===void 0?[m[3],10,m[5]]:[m[3],F,m[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"dirPoints",type:Vi.Attribute,descriptor:{name:"a_dirPoints",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:4,update:function(h){var v=h.coordinates[0]||[0,0],m=h.coordinates[3]||[0,0];return[v[0],v[1],m[0],m[1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0],m[1]]:[m,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(h,v,m,E,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Vi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(h,v,m){return[m[4]]}}})}}]),a}(ws),bg;(function(n){n[n.solid=0]="solid",n[n.dash=1]="dash"})(bg||(bg={}));var Eg;(function(n){n.VERTICAL="vertical",n.HORIZONTAL="horizontal"})(Eg||(Eg={}));var Ny;(function(n){n.NORMAL="normal",n.REPLACE="replace"})(Ny||(Ny={}));var zy;(function(n){n.ALWAYS="always",n.DRAGEND="dragend"})(zy||(zy={}));function Ax(n){var l=H5();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function H5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var j5=`#define LineTypeSolid 0.0
uniform float u_opacity : 1.0;

varying vec4 v_color;

// dash
varying vec4 v_dash_array;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
 
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    // \u5B9E\u7EBF\u90E8\u5206
  } else {
    // \u865A\u7EBF\u90E8\u5206
    discard;
  };

  gl_FragColor = filterColor(gl_FragColor);
}
`,W5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_DistanceAndIndex.x / a_Total_Distance; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_DistanceAndIndex.x;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));
  } else {
    float lineHeight = a_Size.y;
 
    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,GS=`#define Animate 0.0
#define LineTexture 1.0
uniform float u_opacity : 1.0;
uniform float u_textureBlend;

uniform float u_borderWidth: 0.0;

uniform vec3 u_blur;
uniform vec4 u_borderColor;
varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying vec2 v_iconMapUV;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = styleMappingMat[3].a;
  float borderWidth = min(0.5, u_borderWidth);
  // \u7ED8\u5236 border
  if(borderWidth > 0.01) {
    float borderOuterWidth = borderWidth/2.0;

    if(v >= 1.0 - borderWidth || v <= borderWidth) {
      if(v > borderWidth) {
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);
      } else if(v <= borderWidth) {
        float linear = smoothstep(0.0, 1.0, v/borderWidth);
        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = styleMappingMat[3][3];
  if(blurV < 0.5) {
    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  gl_FragColor = filterColor(gl_FragColor);
}
`,Tx=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,X5=`varying vec4 v_color;
uniform float u_linearDir: 1.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3][0]; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,Y5={solid:0,dash:1},Mx=function(n){(0,Ut.Z)(a,n);var l=Ax(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"texture",s.createTexture2D({data:[0,0,0,0],mag:Kt.NEAREST,min:Kt.NEAREST,premultiplyAlpha:!1,width:1,height:1})),(0,W.Z)((0,st.Z)(s),"dataTexture",s.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})),(0,W.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Kt.NEAREST,min:Kt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.lineType,V=B===void 0?"solid":B,j=o.dashArray,nt=j===void 0?[10,5,0,0]:j,at=o.lineTexture,mt=at===void 0?!1:at,Bt=o.iconStep,de=Bt===void 0?100:Bt,ce=o.vertexHeightScale,Be=ce===void 0?20:ce,Xe=o.borderWidth,_r=Xe===void 0?0:Xe,Ir=o.borderColor,Nr=Ir===void 0?"#ccc":Ir,Yr=o.raisingHeight,yn=Yr===void 0?0:Yr,fn=o.heightfixed,$n=fn===void 0?!1:fn,di=o.linearDir,Yi=di===void 0?Eg.VERTICAL:di,ho=o.blur,zo=ho===void 0?[1,1,1]:ho,Vs=o.arrow,hu=Vs===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:Vs;nt.length===2&&nt.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var Gu=0,Wh=[0,0,0,0],s2=[0,0,0,0];if(m&&E&&(Wh=ke(m),s2=ke(E),Gu=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var X_=this.layer.getEncodedData(),u2=this.calDataFrame(this.cellLength,X_,this.cellProperties),cT=u2.data,uO=u2.width,fT=u2.height;this.rowCount=fT,this.dataTexture=this.cellLength>0&&cT.length>0?this.createTexture2D({flipY:!0,data:cT,format:Kt.LUMINANCE,type:Kt.FLOAT,width:uO,height:fT}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(v)?v:1,u_textureBlend:F===Ny.NORMAL?0:1,u_line_type:Y5[V],u_dash_array:nt,u_blur:zo,u_texture:this.texture,u_line_texture:mt?1:0,u_icon_step:de,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:_r,u_borderColor:ke(Nr),u_linearDir:Yi===Eg.VERTICAL?1:0,u_linearColor:Gu,u_sourceColor:Wh,u_targetColor:s2,u_heightfixed:Number($n),u_vertexScale:Be,u_raisingHeight:Number(yn),u_arrow:Number(hu.enable),u_arrowHeight:hu.arrowHeight||3,u_arrowWidth:hu.arrowWidth||2,u_tailWidth:hu.tailWidth===void 0?1:hu.tailWidth}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at,mt,Bt,de,ce,Be;return it().wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.depth,V=B===void 0?!1:B,j=v.workerEnabled,nt=j===void 0?!1:j,at=v.enablePicking,mt=this.getShaders(),Bt=mt.frag,de=mt.vert,ce=mt.type,this.layer.triangulation=Ns,_r.next=5,this.layer.buildLayerModel({moduleName:"line"+ce,vertexShader:de,fragmentShader:Bt,triangulation:Ns,depth:{enable:V},blend:this.getBlend(),stencil:Rr(E,F),workerEnabled:nt,workerOptions:{modelType:"line"+ce,enablePicking:at,iconMap:this.iconService.getIconMap()}});case 5:return Be=_r.sent,_r.abrupt("return",[Be]);case 7:case"end":return _r.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.sourceColor,v=o.targetColor,m=o.lineType;return m==="dash"?{frag:j5,vert:W5,type:"Dash"}:h&&v?{frag:X5,vert:Tx,type:"Linear"}:{frag:GS,vert:Tx,type:""}}},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Vi.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v,m,E,A,F,B){return B===void 0?[E[3],10]:[E[3],B]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Vi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v,m,E){return[E[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0],E[1]]:[E,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(v,m,E,A,F){return F}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Vi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v,m,E){return[E[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(ws);function $5(n){var l=q5();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function q5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var K5=`uniform float u_opacity : 1.0;
uniform sampler2D u_texture;
uniform float u_linearDir: 1.0;

#pragma include "picking"

varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  gl_FragColor = texture2D(u_texture, vec2(linearRadio, 0.5));

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,Q5=`
attribute float a_Miter;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

uniform float u_opacity: 1.0;

#pragma include "projection"
#pragma include "picking"

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,J5=function(n){(0,Ut.Z)(a,n);var l=$5(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;s.colorTexture&&s.colorTexture.destroy();var E=s.layer.getLayerConfig(),A=E.rampColors,F=br(A);s.colorTexture=m({data:new Uint8Array(F.data),width:F.width,height:F.height,wrapS:Kt.CLAMP_TO_EDGE,wrapT:Kt.CLAMP_TO_EDGE,min:Kt.NEAREST,mag:Kt.NEAREST,flipY:!1})}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.vertexHeightScale,E=m===void 0?20:m,A=o.raisingHeight,F=A===void 0?0:A,B=o.heightfixed,V=B===void 0?!1:B,j=o.linearDir,nt=j===void 0?Eg.VERTICAL:j;if(this.rendererService.getDirty()&&this.colorTexture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var at=this.layer.getEncodedData(),mt=this.calDataFrame(this.cellLength,at,this.cellProperties),Bt=mt.data,de=mt.width,ce=mt.height;this.rowCount=ce,this.dataTexture=this.cellLength>0&&Bt.length>0?this.createTexture2D({flipY:!0,data:Bt,format:Kt.LUMINANCE,type:Kt.FLOAT,width:de,height:ce}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_linearDir:nt===Eg.VERTICAL?1:0,u_opacity:(0,te.isNumber)(v)?v:1,u_texture:this.colorTexture,u_heightfixed:Number(V),u_vertexScale:E,u_raisingHeight:Number(F)}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.colorTexture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j;return it().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.depth,V=B===void 0?!1:B,this.layer.triangulation=Ha,at.next=4,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:Q5,fragmentShader:K5,triangulation:Ha,depth:{enable:V},blend:this.getBlend(),stencil:Rr(E,F)});case 4:return j=at.sent,at.abrupt("return",[j]);case 6:case"end":return at.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Vi.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(h,v,m,E,A,F){return F===void 0?[m[3],10]:[m[3],F]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Vi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(h,v,m){return[m[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0],m[1]]:[m,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(h,v,m,E,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Vi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(h,v,m){return[m[4]]}}})}}]),a}(ws);function tI(n){var l=eI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function eI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var rI=`
varying vec4 v_color;
varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,nI=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];

  // styleMappingMat[3][0] \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = mix(u_sourceColor, u_targetColor, styleMappingMat[3][0]);
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,HS=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;

attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_vertexScale: 1.0;

#pragma include "projection"

varying vec4 v_color;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  v_color = a_Color; 
  styleMappingMat[3][0] = a_Distance / a_Total_Distance;

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,iI=function(n){(0,Ut.Z)(a,n);var l=tI(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.vertexHeightScale,F=A===void 0?20:A,B=0,V=[0,0,0,0],j=[0,0,0,0];if(m&&E&&(V=ke(m),j=ke(E),B=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var nt=this.layer.getEncodedData(),at=this.calDataFrame(this.cellLength,nt,this.cellProperties),mt=at.data,Bt=at.width,de=at.height;this.rowCount=de,this.dataTexture=this.cellLength>0&&mt.length>0?this.createTexture2D({flipY:!0,data:mt,format:Kt.LUMINANCE,type:Kt.FLOAT,width:Bt,height:de}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(v)?v:1,u_linearColor:B,u_sourceColor:V,u_targetColor:j,u_vertexScale:F}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.sourceColor,v=o.targetColor;return h&&v?{frag:nI,vert:HS,type:"lineSimpleLinear"}:{frag:rI,vert:HS,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at;return it().wrap(function(Bt){for(;;)switch(Bt.prev=Bt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=this.getShaders(),V=B.frag,j=B.vert,nt=B.type,Bt.next=4,this.layer.buildLayerModel({moduleName:nt,vertexShader:j,fragmentShader:V,triangulation:FS,primitive:Kt.LINES,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F),pick:!1});case 4:return at=Bt.sent,Bt.abrupt("return",[at]);case 6:case"end":return Bt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:Vi.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(h,v,m){return[m[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Vi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(h,v,m){return[m[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0],m[1]]:[m,0]}}})}}]),a}(ws);function jS(n){var l=Ix();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Ix(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var WS=`uniform float u_opacity : 1.0;
varying vec4 v_color;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,aI=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;


#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

void main() {
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // if(u_coord > 0.0) { // \u4F7F\u7528\u7ECF\u7EAC\u5EA6\u5750\u6807
      if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
  // } else { // \u4F7F\u7528\u504F\u79FB\u5750\u6807
  //   vec2 pointPos = a_Position.xy;
  //   vec4 tileWorld = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  //   vec2 pointOffset =  pointPos *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
    
  //   tileWorld.xy += pointOffset;

  //   tileWorld.xy += offset;

  //   if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //     // Needs to be divided with project_uCommonUnitsPerMeter
  //     tileWorld.w *= u_PixelsPerMeter.z;
  //   }
  //   gl_Position = u_ViewProjectionMatrix * tileWorld + u_ViewportCenterProjection;
  // }

  setPickingColor(a_PickingColor);
}
`,oI=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,sI=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec3 a_Normal;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_size;

#pragma include "projection"

void main() {

  vec3 size = a_Miter * u_size * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
  }
}
`,uI=function(n){(0,Ut.Z)(a,n);var l=jS(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.usage,E=o.color,A=E===void 0?"#fff":E,F=o.size,B=F===void 0?1:F;return{u_opacity:Number(v),u_color:m==="basemap"?ke(A):[0,0,0,0],u_size:m==="basemap"?B:1}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt;return it().wrap(function(mt){for(;;)switch(mt.prev=mt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.depth,V=B===void 0?!1:B,j=v.usage,this.layer.triangulation=Ha,mt.next=4,this.layer.buildLayerModel({moduleName:"lineTile_"+j,vertexShader:j==="basemap"?sI:aI,fragmentShader:j==="basemap"?oI:WS,triangulation:Ha,blend:this.getBlend(),depth:{enable:V},stencil:Rr(E,F),pick:j!=="basemap"});case 4:return nt=mt.sent,mt.abrupt("return",[nt]);case 6:case"end":return mt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getLayerConfig(),h=o.usage;h!=="basemap"&&this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(m){var E=m.size,A=E===void 0?1:E;return Array.isArray(A)?[A[0],A[1]]:[A,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(m,E,A,F,B){return B}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Vi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(m,E,A){return[A[4]]}}})}}]),a}(ws);function lI(n){var l=cI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function cI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var XS=`#define Animate 0.0
#define LineTexture 1.0

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying vec2 v_iconMapUV;
varying float v_blur;
varying float v_radio;
varying vec4 v_color;
varying vec4 v_dataset;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,fI=`#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;
uniform float u_linearColor: 0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;
varying vec4 v_color;
varying float v_blur;
varying float v_radio;
varying vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,Uy=function(n){(0,Ut.Z)(a,n);var l=lI(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Kt.NEAREST,min:Kt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.heightfixed,V=B===void 0?!1:B,j=o.lineTexture,nt=j===void 0?!1:j,at=o.iconStep,mt=at===void 0?100:at,Bt=o.iconStepCount,de=Bt===void 0?1:Bt;this.rendererService.getDirty()&&this.texture.bind();var ce=0,Be=[0,0,0,0],Xe=[0,0,0,0];return m&&E&&(Be=ke(m),Xe=ke(E),ce=1),{u_heightfixed:Number(V),u_opacity:(0,te.isNumber)(v)?v:1,u_textureBlend:F==="normal"?0:1,u_texture:this.texture,u_line_texture:nt?1:0,u_iconStepCount:de,u_icon_step:mt,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:ce,u_sourceColor:Be,u_targetColor:Xe}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:fI,fragmentShader:XS,triangulation:Ha,depth:{enable:!1},blend:this.getBlend()});case 2:return v=E.sent,E.abrupt("return",[v]);case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:Vi.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v,m,E){return[E[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Vi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v,m,E){return[E[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0],E[1]]:[E,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(v,m,E,A,F){return F}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Vi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v,m,E){return[E[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(ws),kx={arc:T5,arc3d:F5,greatcircle:Sx,wall:Uy,line:Mx,halfLine:cm,simple:iI,linearline:J5,tileLine:uI,earthArc3d:Z5},YS=kx;function Qd(n){var l=hI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function hI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Sg=function(n){(0,Ut.Z)(a,n);var l=Qd(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"type","LineLayer"),(0,W.Z)((0,st.Z)(s),"arrowInsertCount",0),(0,W.Z)((0,st.Z)(s),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),s}return(0,tt.Z)(a,[{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel=new YS[v](this),E.next=4,this.initLayerModels();case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getDefaultConfig",value:function(){var o=this.getModelType(),h={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},halfLine:{},earthArc3d:{}};return h[o]}},{key:"getModelType",value:function(){var o;if(this.layerType)return this.layerType;var h=this.styleAttributeService.getLayerStyleAttribute("shape"),v=h==null||(o=h.scale)===null||o===void 0?void 0:o.field;return v||"line"}},{key:"processData",value:function(o){if(this.getModelType()!=="simple")return o;var h=[];return o.map(function(v){if(Array.isArray(v.coordinates)&&Array.isArray(v.coordinates[0])&&Array.isArray(v.coordinates[0][0])){var m=(0,K.Z)({},v);v.coordinates.map(function(E){h.push((0,K.Z)((0,K.Z)({},m),{},{coordinates:E}))})}else h.push(v)}),h}}]),a}(dg);function $S(n){var l=pI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function pI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dI=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,qS=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,KS=function(n){(0,Ut.Z)(a,n);var l=$S(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"raiseCount",0),(0,W.Z)((0,st.Z)(s),"raiseRepeat",0),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption,v=h===void 0?{enable:!1,speed:.01,repeat:!1}:h,m=o.opacity,E=m===void 0?1:m,A=o.sourceColor,F=o.targetColor,B=o.pickLight,V=B===void 0?!1:B,j=o.heightfixed,nt=j===void 0?!1:j,at=o.opacityLinear,mt=at===void 0?{enable:!1,dir:"up"}:at,Bt=o.lightEnable,de=Bt===void 0?!0:Bt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:E})){this.judgeStyleAttributes({opacity:E});var ce=this.layer.getEncodedData(),Be=this.calDataFrame(this.cellLength,ce,this.cellProperties),Xe=Be.data,_r=Be.width,Ir=Be.height;this.rowCount=Ir,this.dataTexture=this.cellLength>0&&Xe.length>0?this.createTexture2D({flipY:!0,data:Xe,format:Kt.LUMINANCE,type:Kt.FLOAT,width:_r,height:Ir}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}var Nr=0,Yr=[0,0,0,0],yn=[0,0,0,0];if(A&&F&&(Yr=ke(A),yn=ke(F),Nr=1),this.raiseCount<1&&this.raiseRepeat>0&&v.enable){var fn=v.speed,$n=fn===void 0?.01:fn;this.raiseCount+=$n,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(V),u_heightfixed:Number(nt),u_r:v.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(E)?E:1,u_linearColor:Nr,u_sourceColor:Yr,u_targetColor:yn,u_opacitylinear:Number(mt.enable),u_opacitylinear_dir:mt.dir==="up"?1:0,u_lightEnable:Number(de)}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.layer.getLayerConfig(),m=v.animateOption.repeat,E=m===void 0?1:m,this.raiseRepeat=E,B.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:qS,fragmentShader:dI,triangulation:xx,depth:{enable:!0},cull:{enable:!0,face:ec(this.mapService.version)},blend:this.getBlend()});case 4:return A=B.sent,B.abrupt("return",[A]);case 6:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(h){var v=h.size;if(v){var m=[];return Array.isArray(v)&&(m=v.length===2?[v[0],v[0],v[1]]:v),Array.isArray(v)||(m=[v,v,v]),m}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(h,v,m,E,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Vi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(h){var v=bs(h.coordinates);return Xs([v[0],v[1]])}}})}}]),a}(ws);function vI(n){var l=gI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function gI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var QS=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,mI=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);

  setPickingColor(a_PickingColor);
}
`,yI=function(n){(0,Ut.Z)(a,n);var l=vI(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.strokeOpacity,E=m===void 0?1:m,A=o.strokeWidth,F=A===void 0?0:A,B=o.stroke,V=B===void 0?"rgba(0,0,0,0)":B,j=o.offsets,nt=j===void 0?[0,0]:j,at=o.blend,mt=o.blur,Bt=mt===void 0?0:mt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,strokeOpacity:E,strokeWidth:F,stroke:V,offsets:nt})){this.judgeStyleAttributes({opacity:v,strokeOpacity:E,strokeWidth:F,stroke:V,offsets:nt});var de=this.layer.getEncodedData(),ce=this.calDataFrame(this.cellLength,de,this.cellProperties),Be=ce.data,Xe=ce.width,_r=ce.height;this.rowCount=_r,this.dataTexture=this.cellLength>0&&Be.length>0?this.createTexture2D({flipY:!0,data:Be,format:Kt.LUMINANCE,type:Kt.FLOAT,width:Xe,height:_r}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_blur:Bt,u_additive:at==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(v)?v:1,u_stroke_opacity:(0,te.isNumber)(E)?E:1,u_stroke_width:(0,te.isNumber)(F)?F:1,u_stroke_color:this.getStrokeColor(V),u_offsets:this.isOffsetStatic(nt)?nt:[0,0]}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption,v=h===void 0?{enable:!1}:h;return{u_animate:this.animateOption2Array(v),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return this.layer.triangulation=PS,E.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:mI,fragmentShader:QS,triangulation:PS,depth:{enable:!0},blend:this.getBlend()});case 3:return v=E.sent,E.abrupt("return",[v]);case 5:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"animateOption2Array",value:function(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Vi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(v,m,E,A){var F=(0,ht.Z)(E,3),B=F[0],V=F[1],j=F[2],nt=wo.fromValues(0,0,1),at=wo.fromValues(B,0,j),mt=B>=0?wo.angle(nt,at):Math.PI*2-wo.angle(nt,at),Bt=Math.PI*2-Math.asin(V/100),de=Ke();Qe(de,de,mt),vr(de,de,Bt);var ce=wo.fromValues(1,1,0);wo.transformMat4(ce,ce,de),wo.normalize(ce,ce);var Be=wo.fromValues(-1,1,0);wo.transformMat4(Be,Be,de),wo.normalize(Be,Be);var Xe=wo.fromValues(-1,-1,0);wo.transformMat4(Xe,Xe,de),wo.normalize(Xe,Xe);var _r=wo.fromValues(1,-1,0);wo.transformMat4(_r,_r,de),wo.normalize(_r,_r);var Ir=[].concat((0,ge.Z)(ce),(0,ge.Z)(Be),(0,ge.Z)(Xe),(0,ge.Z)(_r)),Nr=A%4*3;return[Ir[Nr],Ir[Nr+1],Ir[Nr+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Vi.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.shape,E=m===void 0?2:m,A=o.layer.getLayerConfig().shape2d,F=A.indexOf(E);return[F]}}})}}]),a}(ws);function JS(n){var l=_I();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function _I(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var tw=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,xI=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }

  setPickingColor(a_PickingColor);
}
`,Lx=function(n){(0,Ut.Z)(a,n);var l=JS(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"raiseCount",0),(0,W.Z)((0,st.Z)(s),"raiseRepeat",0),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption,v=h===void 0?{enable:!1,speed:.01,repeat:!1}:h,m=o.opacity,E=m===void 0?1:m,A=o.sourceColor,F=o.targetColor,B=o.pickLight,V=B===void 0?!1:B,j=o.heightfixed,nt=j===void 0?!1:j,at=o.opacityLinear,mt=at===void 0?{enable:!1,dir:"up"}:at,Bt=o.lightEnable,de=Bt===void 0?!0:Bt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:E})){this.judgeStyleAttributes({opacity:E});var ce=this.layer.getEncodedData(),Be=this.calDataFrame(this.cellLength,ce,this.cellProperties),Xe=Be.data,_r=Be.width,Ir=Be.height;this.rowCount=Ir,this.dataTexture=this.cellLength>0&&Xe.length>0?this.createTexture2D({flipY:!0,data:Xe,format:Kt.LUMINANCE,type:Kt.FLOAT,width:_r,height:Ir}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}var Nr=0,Yr=[0,0,0,0],yn=[0,0,0,0];if(A&&F&&(Yr=ke(A),yn=ke(F),Nr=1),this.raiseCount<1&&this.raiseRepeat>0&&v.enable){var fn=v.speed,$n=fn===void 0?.01:fn;this.raiseCount+=$n,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(V),u_heightfixed:Number(nt),u_r:v.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(E)?E:1,u_linearColor:Nr,u_sourceColor:Yr,u_targetColor:yn,u_opacitylinear:Number(mt.enable),u_opacitylinear_dir:mt.dir==="up"?1:0,u_lightEnable:Number(de)}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.depth,E=m===void 0?!0:m,A=v.animateOption.repeat,F=A===void 0?1:A,this.raiseRepeat=F,j.next=4,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:xI,fragmentShader:tw,triangulation:xx,blend:this.getBlend(),cull:{enable:!0,face:ec(this.mapService.version)},depth:{enable:E}});case 4:return B=j.sent,j.abrupt("return",[B]);case 6:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(h){var v=h.size;if(v){var m=[];return Array.isArray(v)&&(m=v.length===2?[v[0],v[0],v[1]]:v),Array.isArray(v)||(m=[v,v,v]),m}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(h,v,m,E,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Vi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(h){var v=bs(h.coordinates);return[v[0],v[1],0]}}})}}]),a}(ws);function Zy(n){var l=fm();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function fm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ew=`
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

 gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  
  // \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,bI=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Px=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_meter2coord;
uniform float u_meteryScale;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size) * u_meter2coord;
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    if(newSize * pow(2.0, u_Zoom) < 48.0) {
      antialiasblur = max(antialiasblur, -0.05);
    } else if(newSize * pow(2.0, u_Zoom) < 128.0) {
      antialiasblur = max(antialiasblur, -0.6/pow(u_Zoom, 2.0));
    } else {
      antialiasblur = max(antialiasblur, -0.8/pow(u_Zoom, 2.0));
    }
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.x += offset.x / u_meteryScale;
      aPosition.y += offset.y;
      offset = vec2(0.0);
    }
  }

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_raisingHeight;

  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }
 

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,rw=function(n){(0,Ut.Z)(a,n);var l=Zy(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"meter2coord",1),(0,W.Z)((0,st.Z)(s),"meterYScale",1),(0,W.Z)((0,st.Z)(s),"isMeter",!1),(0,W.Z)((0,st.Z)(s),"unit","l7size"),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.strokeOpacity,E=m===void 0?1:m,A=o.strokeWidth,F=A===void 0?0:A,B=o.stroke,V=B===void 0?"rgba(0,0,0,0)":B,j=o.offsets,nt=j===void 0?[0,0]:j,at=o.blend,mt=o.blur,Bt=mt===void 0?0:mt,de=o.raisingHeight,ce=de===void 0?0:de,Be=o.heightfixed,Xe=Be===void 0?!1:Be,_r=o.unit,Ir=_r===void 0?"l7size":_r;if(this.updateUnit(Ir),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,strokeOpacity:E,strokeWidth:F,stroke:V,offsets:nt})){this.judgeStyleAttributes({opacity:v,strokeOpacity:E,strokeWidth:F,stroke:V,offsets:nt});var Nr=this.layer.getEncodedData(),Yr=this.calDataFrame(this.cellLength,Nr,this.cellProperties),yn=Yr.data,fn=Yr.width,$n=Yr.height;this.rowCount=$n,this.dataTexture=this.cellLength>0&&yn.length>0?this.createTexture2D({flipY:!0,data:yn,format:Kt.LUMINANCE,type:Kt.FLOAT,width:fn,height:$n}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(ce),u_heightfixed:Number(Xe),u_meter2coord:this.meter2coord,u_meteryScale:this.meterYScale,u_isMeter:Number(this.isMeter),u_blur:Bt,u_additive:at==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(v)?v:1,u_stroke_opacity:(0,te.isNumber)(E)?E:1,u_stroke_width:(0,te.isNumber)(F)?F:1,u_stroke_color:this.getStrokeColor(V),u_offsets:this.isOffsetStatic(nt)?nt:[0,0]}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption,v=h===void 0?{enable:!1}:h;return{u_animate:this.animateOption2Array(v),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),qf)}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateUnit("l7size"),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"calMeter2Coord",value:function(){var o=(0,ht.Z)(this.layer.getSource().extent,4),h=o[0],v=o[1],m=o[2],E=o[3],A=[(h+m)/2,(v+E)/2],F=this.mapService.version,B=Co==null?void 0:Co.mapboxgl;if(F===yu.MAPBOX&&B!==null&&B!==void 0&&B.MercatorCoordinate){var V=B.MercatorCoordinate.fromLngLat({lng:A[0],lat:A[1]},0),j=V.meterInMercatorCoordinateUnits(),nt=new B.MercatorCoordinate(V.x-j,V.y,V.z),at=nt.toLngLat(),mt=new B.MercatorCoordinate(V.x,V.y-j,V.z),Bt=mt.toLngLat();this.meter2coord=A[0]-at.lng,this.meterYScale=(Bt.lat-A[1])/this.meter2coord;return}var de=this.mapService.meterToCoord(A,[h,v]),ce=this.mapService.meterToCoord(A,[m===h?m+.1:m,E===v?v+.1:E]);this.meter2coord=(de+ce)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at,mt,Bt,de,ce,Be,Xe;return it().wrap(function(Ir){for(;;)switch(Ir.prev=Ir.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.animateOption,V=B===void 0?{enable:!1}:B,j=v.workerEnabled,nt=j===void 0?!1:j,at=v.enablePicking,mt=v.shape2d,Bt=this.getShaders(V),de=Bt.frag,ce=Bt.vert,Be=Bt.type,this.layer.triangulation=qf,Ir.next=5,this.layer.buildLayerModel({moduleName:Be,vertexShader:ce,fragmentShader:de,triangulation:qf,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F),workerEnabled:nt,workerOptions:{modelType:Be,enablePicking:at,shape2d:mt}});case 5:return Xe=Ir.sent,Ir.abrupt("return",[Xe]);case 7:case"end":return Ir.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getShaders",value:function(o){if(o.enable)switch(o.type){case"wave":return{frag:ew,vert:Px,type:"pointWave"};default:return{frag:ew,vert:Px,type:"pointWave"}}else return{frag:bI,vert:Px,type:"pointFill"}}},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"animateOption2Array",value:function(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Vi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(v,m,E,A){var F=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],B=A%4*3;return[F[B],F[B+1],F[B+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Vi.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.shape,E=m===void 0?2:m,A=o.indexOf(E);return[A]}}})}},{key:"updateUnit",value:function(o){var h=this.mapService.version;this.unit!==o&&(this.unit!=="meter"&&o==="meter"&&h!==yu.DEFUALT&&h!==yu.GLOBEL?(this.isMeter=!0,this.calMeter2Coord()):this.unit==="meter"&&o!=="meter"&&(this.isMeter=!1,this.meter2coord=1),this.unit=o)}}]),a}(ws);function EI(n){var l=nw();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function nw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var SI=`uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;

void main() {

  float opacity = styleMappingMat[0][0];

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,wI=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;
attribute float a_Rotate;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform mat2 u_RotateMatrix;
uniform float u_isMeter;

varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;
uniform float u_opacity : 1;
uniform vec2 u_offsets;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;

  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // empty - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (rotation_matrix * u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,CI=function(n){(0,Ut.Z)(a,n);var l=EI(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"meter2coord",1),(0,W.Z)((0,st.Z)(s),"isMeter",!1),(0,W.Z)((0,st.Z)(s),"radian",0),(0,W.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),s.layerService.throttleRenderLayers();return}s.texture=m({data:s.iconService.getCanvas(),mag:Kt.LINEAR,min:Kt.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128,mipmap:!0})}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.offsets,E=m===void 0?[0,0]:m,A=o.rotation,F=o.raisingHeight,B=F===void 0?0:F,V=o.heightfixed,j=V===void 0?!1:V;this.rendererService.getDirty()&&this.texture.bind();var nt=1;if((this.mapService.version==="GAODE2.x"||this.mapService.version==="GAODE1.x")&&(nt=-1),this.radian=A!==void 0?nt*Math.PI*A/180:nt*Math.PI*(this.mapService.getRotation()%360)/180,this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:E})){this.judgeStyleAttributes({opacity:v,offsets:E});var at=this.layer.getEncodedData(),mt=this.calDataFrame(this.cellLength,at,this.cellProperties),Bt=mt.data,de=mt.width,ce=mt.height;this.rowCount=ce,this.dataTexture=this.cellLength>0&&Bt.length>0?this.createTexture2D({flipY:!0,data:Bt,format:Kt.LUMINANCE,type:Kt.FLOAT,width:de,height:ce}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(B),u_heightfixed:Number(j),u_isMeter:Number(this.isMeter),u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:(0,te.isNumber)(v)?v:1,u_offsets:this.isOffsetStatic(E)?E:[0,0]}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),A0)}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),v=this.layer.getLayerConfig(),m=v.unit,E=m===void 0?"l7size":m,A=this.mapService.version,E==="meter"&&A!==yu.DEFUALT&&A!==yu.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),B.next=7,this.buildModels();case 7:return B.abrupt("return",B.sent);case 8:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"calMeter2Coord",value:function(){var o=(0,ht.Z)(this.layer.getSource().extent,4),h=o[0],v=o[1],m=o[2],E=o[3],A=[(h+m)/2,(v+E)/2],F=this.mapService.version;if(F===yu.MAPBOX&&window.mapboxgl.MercatorCoordinate){var B=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:A[0],lat:A[1]},0),V=1,j=V*B.meterInMercatorCoordinateUnits(),nt=new window.mapboxgl.MercatorCoordinate(B.x-j,B.y,B.z),at=nt.toLngLat();this.meter2coord=A[0]-at.lng;return}var mt=this.mapService.meterToCoord(A,[h,v]),Bt=this.mapService.meterToCoord(A,[m===h?m+.1:m,E===v?v+.1:E]);this.meter2coord=(mt+Bt)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:wI,fragmentShader:SI,triangulation:A0,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F),cull:{enable:!0,face:ec(this.mapService.version)}});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;this.iconService.off("imageUpdate",this.updateTexture),(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Vi.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.rotate,E=m===void 0?0:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.shape,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Vi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(v,m,E,A){var F=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],B=A%4*3;return[F[B],F[B+1],F[B+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]*o.meter2coord]:[E*o.meter2coord]}}})}}]),a}(ws);function AI(n){var l=iw();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function iw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var TI=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,Ox=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec2 u_offsets;

uniform float u_opacity : 1;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(textrueOffsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,aw=function(n){(0,Ut.Z)(a,n);var l=AI(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){s.layerService.throttleRenderLayers()});return}s.texture=m({data:s.iconService.getCanvas(),mag:Kt.LINEAR,min:Kt.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128,mipmap:!0})}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.offsets,E=m===void 0?[0,0]:m,A=o.raisingHeight,F=A===void 0?0:A,B=o.heightfixed,V=B===void 0?!1:B;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:E})){this.judgeStyleAttributes({opacity:v,offsets:E});var j=this.layer.getEncodedData(),nt=this.calDataFrame(this.cellLength,j,this.cellProperties),at=nt.data,mt=nt.width,Bt=nt.height;this.rowCount=Bt,this.dataTexture=this.cellLength>0&&at.length>0?this.createTexture2D({flipY:!0,data:at,format:Kt.LUMINANCE,type:Kt.FLOAT,width:mt,height:Bt}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(F),u_heightfixed:Number(V),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:(0,te.isNumber)(v)?v:1,u_offsets:this.isOffsetStatic(E)?E:[0,0]}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:Ox,fragmentShader:TI,triangulation:OS,depth:{enable:!1},primitive:Kt.POINTS,blend:this.getBlend(),stencil:Rr(E,F)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.shape,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(ws);function MI(n){var l=II();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function II(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ow=`uniform float u_opacity : 1;
varying vec4 v_color;
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
}
`,kI=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;

varying vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = a_Color;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy, a_Position.z, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
}
`;function sw(n){var l=n.coordinates;return{vertices:(0,ge.Z)(l),indices:[0],size:l.length}}var hm=function(n){(0,Ut.Z)(a,n);var l=MI(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h;return{u_opacity:(0,te.isNumber)(v)?v:1}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,this.layer.triangulation=sw,j.next=4,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:kI,fragmentShader:ow,triangulation:sw,depth:{enable:!1},primitive:Kt.POINTS,blend:this.getBlend(),stencil:Rr(E,F),pick:!1});case 4:return B=j.sent,j.abrupt("return",[B]);case 6:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0]]:[m]}}})}}]),a}(ws);function LI(n){var l=PI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function PI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var OI=`
uniform float u_additive;
uniform float u_opacity: 1.0;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;
#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  v_exteude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  // full circle
  // float rades = dot(dir, baseDir);
  // float flag = sign(dir.y);
  // float radar_v = (flag - 1.0) * -0.5 + flag * acos(rades)/pi/2.0;
  
  // half circle
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  gl_FragColor.a *= radar_v;
}
`,FI=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
uniform float u_speed: 1.0;
uniform float u_time;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_exteude = rotateMatrix * a_Extrude.xy;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  vec2 offset = (extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    antialiasblur *= pow(19.0 - u_Zoom, 2.0);
    antialiasblur = max(antialiasblur, -0.01);
    // offset *= 0.5;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,uw=function(n){(0,Ut.Z)(a,n);var l=LI(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"meter2coord",1),(0,W.Z)((0,st.Z)(s),"isMeter",!1),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.blend,E=o.speed,A=E===void 0?1:E;return{u_isMeter:Number(this.isMeter),u_speed:A,u_additive:m==="additive"?1:0,u_opacity:(0,te.isNumber)(v)?v:1}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption,v=h===void 0?{enable:!1}:h;return{u_animate:this.animateOption2Array(v),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),A0)}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.layer.getLayerConfig(),m=v.unit,E=m===void 0?"l7size":m,A=this.mapService.version,E==="meter"&&A!==yu.DEFUALT&&A!==yu.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),B.next=5,this.buildModels();case 5:return B.abrupt("return",B.sent);case 6:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"calMeter2Coord",value:function(){var o=(0,ht.Z)(this.layer.getSource().extent,4),h=o[0],v=o[1],m=o[2],E=o[3],A=[(h+m)/2,(v+E)/2],F=this.mapService.version;if(F===yu.MAPBOX&&window.mapboxgl.MercatorCoordinate){var B=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:A[0],lat:A[1]},0),V=1,j=V*B.meterInMercatorCoordinateUnits(),nt=new window.mapboxgl.MercatorCoordinate(B.x-j,B.y,B.z),at=nt.toLngLat();this.meter2coord=A[0]-at.lng;return}var mt=this.mapService.meterToCoord(A,[h,v]),Bt=this.mapService.meterToCoord(A,[m===h?m+.1:m,E===v?v+.1:E]);this.meter2coord=(mt+Bt)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:FI,fragmentShader:OI,triangulation:A0,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"animateOption2Array",value:function(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Vi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(v,m,E,A){var F=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],B=A%4*3;return[F[B],F[B+1],F[B+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]*o.meter2coord]:[E*o.meter2coord]}}})}}]),a}(ws);function lw(n){var l=RI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function RI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var DI=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_additive;

uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  float opacity = styleMappingMat[0][0];
  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,cw=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143
varying float v_blur;
varying float v_innerRadius;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  vec2 offset = project_pixel(textrueOffsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function Fx(n){var l=n.coordinates;return{vertices:(0,ge.Z)(l),indices:[0],size:l.length}}var fw=function(n){(0,Ut.Z)(a,n);var l=lw(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.offsets,E=m===void 0?[0,0]:m,A=o.blend,F=o.strokeOpacity,B=F===void 0?1:F,V=o.strokeWidth,j=V===void 0?0:V,nt=o.stroke,at=nt===void 0?"#fff":nt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:E})){this.judgeStyleAttributes({opacity:v,offsets:E});var mt=this.layer.getEncodedData(),Bt=this.calDataFrame(this.cellLength,mt,this.cellProperties),de=Bt.data,ce=Bt.width,Be=Bt.height;this.rowCount=Be,this.dataTexture=this.cellLength>0&&de.length>0?this.createTexture2D({flipY:!0,data:de,format:Kt.LUMINANCE,type:Kt.FLOAT,width:ce,height:Be}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_additive:A==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,te.isNumber)(v)?v:1,u_offsets:this.isOffsetStatic(E)?E:[0,0],u_stroke_opacity:(0,te.isNumber)(B)?B:1,u_stroke_width:(0,te.isNumber)(j)?j:1,u_stroke_color:this.getStrokeColor(at)}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,this.layer.triangulation=Fx,j.next=4,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:cw,fragmentShader:DI,triangulation:Fx,depth:{enable:!1},primitive:Kt.POINTS,blend:this.getBlend(),stencil:Rr(E,F)});case 4:return B=j.sent,j.abrupt("return",[B]);case 6:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0]]:[m]}}})}}]),a}(ws);function BI(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=Rx(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function Rx(n,l){if(!!n){if(typeof n=="string")return Dx(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Dx(n,l)}}function Dx(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var NI=function(){function n(l,a,s){(0,lt.Z)(this,n),(0,W.Z)(this,"boxCells",[]);var o=this.boxCells;this.xCellCount=Math.ceil(l/s),this.yCellCount=Math.ceil(a/s);for(var h=0;h<this.xCellCount*this.yCellCount;h++)o.push([]);this.boxKeys=[],this.bboxes=[],this.width=l,this.height=a,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/a,this.boxUid=0}return(0,tt.Z)(n,[{key:"insert",value:function(a,s,o,h,v){this.forEachCell(s,o,h,v,this.insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(v)}},{key:"query",value:function(a,s,o,h,v){return this.queryHitTest(a,s,o,h,!1,v)}},{key:"hitTest",value:function(a,s,o,h,v){return this.queryHitTest(a,s,o,h,!0,v)}},{key:"insertBoxCell",value:function(a,s,o,h,v,m){this.boxCells[v].push(m)}},{key:"queryHitTest",value:function(a,s,o,h,v,m){if(o<0||a>this.width||h<0||s>this.height)return v?!1:[];var E=[];if(a<=0&&s<=0&&this.width<=o&&this.height<=h){if(v)return!0;for(var A=0;A<this.boxKeys.length;A++)E.push({key:this.boxKeys[A],x1:this.bboxes[A*4],y1:this.bboxes[A*4+1],x2:this.bboxes[A*4+2],y2:this.bboxes[A*4+3]});return m?E.filter(m):E}var F={hitTest:v,seenUids:{box:{},circle:{}}};return this.forEachCell(a,s,o,h,this.queryCell,E,F,m),v?E.length>0:E}},{key:"queryCell",value:function(a,s,o,h,v,m,E,A){var F=E.seenUids,B=this.boxCells[v];if(B!==null){var V=this.bboxes,j=BI(B),nt;try{for(j.s();!(nt=j.n()).done;){var at=nt.value;if(!F.box[at]){F.box[at]=!0;var mt=at*4;if(a<=V[mt+2]&&s<=V[mt+3]&&o>=V[mt+0]&&h>=V[mt+1]&&(!A||A(this.boxKeys[at]))){if(E.hitTest)return m.push(!0),!0;m.push({key:this.boxKeys[at],x1:V[mt],y1:V[mt+1],x2:V[mt+2],y2:V[mt+3]})}}}}catch(Bt){j.e(Bt)}finally{j.f()}}return!1}},{key:"forEachCell",value:function(a,s,o,h,v,m,E,A){for(var F=this.convertToXCellCoord(a),B=this.convertToYCellCoord(s),V=this.convertToXCellCoord(o),j=this.convertToYCellCoord(h),nt=F;nt<=V;nt++)for(var at=B;at<=j;at++){var mt=this.xCellCount*at+nt;if(v.call(this,a,s,o,h,mt,m,E,A))return}}},{key:"convertToXCellCoord",value:function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}},{key:"convertToYCellCoord",value:function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}}]),n}(),hw=NI,pw=function(){function n(l,a){(0,lt.Z)(this,n),(0,W.Z)(this,"viewportPadding",100),this.width=l,this.height=a,this.viewportPadding=Math.max(l,a),this.grid=new hw(l+this.viewportPadding,a+this.viewportPadding,25),this.screenRightBoundary=l+this.viewportPadding,this.screenBottomBoundary=a+this.viewportPadding,this.gridRightBoundary=l+2*this.viewportPadding,this.gridBottomBoundary=a+2*this.viewportPadding}return(0,tt.Z)(n,[{key:"placeCollisionBox",value:function(a){var s=a.x1+a.anchorPointX+this.viewportPadding,o=a.y1+a.anchorPointY+this.viewportPadding,h=a.x2+a.anchorPointX+this.viewportPadding,v=a.y2+a.anchorPointY+this.viewportPadding;return!this.isInsideGrid(s,o,h,v)||this.grid.hitTest(s,o,h,v)?{box:[]}:{box:[s,o,h,v]}}},{key:"insertCollisionBox",value:function(a,s){var o={featureIndex:s};this.grid.insert(o,a[0],a[1],a[2],a[3])}},{key:"project",value:function(a,s,o){var h=ni(s,o,0,1),v=mn(),m=Ri.apply(kt,(0,ge.Z)(a));return cu(v,h,m),{x:(v[0]/v[3]+1)/2*this.width+this.viewportPadding,y:(-v[1]/v[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(a,s,o,h){return o>=0&&a<this.gridRightBoundary&&h>=0&&s<this.gridBottomBoundary}}]),n}();function dw(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=vw(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function vw(n,l){if(!!n){if(typeof n=="string")return Bx(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Bx(n,l)}}function Bx(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function gw(n){var l=.5,a=.5;switch(n){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0;break;default:l=.5}switch(n){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0;break;default:a=.5}return{horizontalAlign:l,verticalAlign:a}}function mw(n,l,a,s,o){if(!!o){var h=n[s],v=h.glyph;if(v)for(var m=l[v].advance*h.scale,E=(n[s].x+m)*o,A=a;A<=s;A++)n[A].x-=E}}function Xv(n,l,a,s,o,h,v){var m=(l-a)*o,E=(-s*v+.5)*h,A=dw(n),F;try{for(A.s();!(F=A.n()).done;){var B=F.value;B.x+=m,B.y+=E}}catch(V){A.e(V)}finally{A.f()}}function zI(n,l,a,s,o,h,v){var m=-8,E=0,A=m,F=0,B=n.positionedGlyphs,V=h==="right"?1:h==="left"?0:.5,j=B.length;a.forEach(function(de){if(de.split("").forEach(function(Be){var Xe=l[Be],_r=0;Xe&&(B.push({glyph:Be,x:E,y:A+_r,vertical:!1,scale:1,metrics:Xe}),E+=Xe.advance+v)}),B.length!==j){var ce=E-v;F=Math.max(ce,F),mw(B,l,j,B.length-1,V)}E=0,A-=s+5});var nt=gw(o),at=nt.horizontalAlign,mt=nt.verticalAlign;Xv(B,V,at,mt,F,s,a.length);var Bt=A-m;n.top+=-mt*Bt,n.bottom=n.top-Bt,n.left+=-at*F,n.right=n.left+F}function UI(n,l,a,s,o,h,v){var m=-8,E=0,A=m,F=0,B=n.positionedGlyphs,V=h==="right"?1:h==="left"?0:.5,j=B.length;a.forEach(function(de){var ce=l[de],Be=0;if(ce&&(B.push({glyph:de,x:ce.advance/2,y:A+Be,vertical:!1,scale:1,metrics:ce}),E+=ce.advance+v),B.length!==j){var Xe=E-v;F=Math.max(Xe,F),mw(B,l,j,B.length-1,V)}E=0,A-=s+5});var nt=gw(o),at=nt.horizontalAlign,mt=nt.verticalAlign;Xv(B,V,at,mt,F,s,a.length);var Bt=A-m;n.top+=-mt*Bt,n.bottom=n.top-Bt,n.left+=-at*F,n.right=n.left+F}function yw(n,l,a,s,o,h){var v=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],m=arguments.length>7?arguments[7]:void 0,E=n.split(`
`),A=[],F={positionedGlyphs:A,top:v[1],bottom:v[1],left:v[0],right:v[0],lineCount:E.length,text:n};return m?UI(F,l,E,a,s,o,h):zI(F,l,E,a,s,o,h),A.length?F:!1}function _w(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],a=arguments.length>2?arguments[2]:void 0,s=n.positionedGlyphs,o=s===void 0?[]:s,h=[],v=dw(o),m;try{for(v.s();!(m=v.n()).done;){var E=m.value,A=E.metrics,F=4,B=A.advance*E.scale/2,V=a?[E.x+B,E.y]:[0,0],j=a?[0,0]:[E.x+B+l[0],E.y+l[1]],nt=(0-F)*E.scale-B+j[0],at=(0-F)*E.scale+j[1],mt=nt+A.width*E.scale,Bt=at+A.height*E.scale,de={x:nt,y:at},ce={x:mt,y:at},Be={x:nt,y:Bt},Xe={x:mt,y:Bt};h.push({tl:de,tr:ce,bl:Be,br:Xe,tex:A,glyphOffset:V})}}catch(_r){v.e(_r)}finally{v.f()}return h}function ZI(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=xw(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function xw(n,l){if(!!n){if(typeof n=="string")return bw(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return bw(n,l)}}function bw(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function Vy(n){var l=VI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function VI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ew=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  // get style data mapping
  float opacity = styleMappingMat[0][0];
  float strokeWidth = styleMappingMat[0][2];
  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Sw=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function ww(n){var l=this,a=n.id,s=[],o=[];if(!l.glyphInfoMap||!l.glyphInfoMap[a])return{vertices:[],indices:[],size:7};var h=l.glyphInfoMap[a].centroid,v=h.length===2?[h[0],h[1],0]:h;return l.glyphInfoMap[a].glyphQuads.forEach(function(m,E){s.push.apply(s,(0,ge.Z)(v).concat([m.tex.x,m.tex.y+m.tex.height,m.tl.x,m.tl.y],(0,ge.Z)(v),[m.tex.x+m.tex.width,m.tex.y+m.tex.height,m.tr.x,m.tr.y],(0,ge.Z)(v),[m.tex.x+m.tex.width,m.tex.y,m.br.x,m.br.y],(0,ge.Z)(v),[m.tex.x,m.tex.y,m.bl.x,m.bl.y])),o.push(0+E*4,1+E*4,2+E*4,2+E*4,3+E*4,0+E*4)}),{vertices:s,indices:o,size:7}}var Cw=function(n){(0,Ut.Z)(a,n);var l=Vy(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"glyphInfoMap",{}),(0,W.Z)((0,st.Z)(s),"currentZoom",-1),(0,W.Z)((0,st.Z)(s),"textureHeight",0),(0,W.Z)((0,st.Z)(s),"textCount",0),(0,W.Z)((0,st.Z)(s),"preTextStyle",{}),(0,W.Z)((0,st.Z)(s),"mapping",(0,ut.Z)(it().mark(function m(){return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return s.initGlyph(),s.updateTexture(),A.next=4,s.reBuildModel();case 4:case"end":return A.stop()}},m)}))),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.stroke,E=m===void 0?"#fff":m,A=o.strokeWidth,F=A===void 0?0:A,B=o.textAnchor,V=B===void 0?"center":B,j=o.textOffset,nt=o.textAllowOverlap,at=nt===void 0?!1:nt,mt=o.halo,Bt=mt===void 0?.5:mt,de=o.gamma,ce=de===void 0?2:de,Be=o.raisingHeight,Xe=Be===void 0?0:Be,_r=this.fontService,Ir=_r.canvas,Nr=_r.mapping;if(Nr&&Object.keys(Nr).length!==this.textCount&&Ir&&(this.updateTexture(),this.textCount=Object.keys(Nr).length),this.preTextStyle={textAnchor:V,textAllowOverlap:at,textOffset:j},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,strokeWidth:F,stroke:E})){this.judgeStyleAttributes({opacity:v,strokeWidth:F,stroke:E});var Yr=this.layer.getEncodedData(),yn=this.calDataFrame(this.cellLength,Yr,this.cellProperties),fn=yn.data,$n=yn.width,di=yn.height;this.rowCount=di,this.dataTexture=this.cellLength>0&&fn.length>0?this.createTexture2D({flipY:!0,data:fn,format:Kt.LUMINANCE,type:Kt.FLOAT,width:$n,height:di}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(Xe),u_opacity:(0,te.isNumber)(v)?v:1,u_stroke_width:(0,te.isNumber)(F)?F:1,u_stroke_color:this.getStrokeColor(E),u_sdf_map:this.texture,u_halo_blur:Bt,u_gamma_scale:ce,u_sdf_map_size:[(Ir==null?void 0:Ir.width)||1,(Ir==null?void 0:Ir.height)||1]}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),v=this.layer.getLayerConfig(),m=v.textAnchor,E=m===void 0?"center":m,A=v.textAllowOverlap,F=A===void 0?!0:A,B=v.textOffset,this.preTextStyle={textAnchor:E,textAllowOverlap:F,textOffset:B},j.next=6,this.buildModels();case 6:return j.abrupt("return",j.sent);case 7:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j;return it().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.textAllowOverlap,V=B===void 0?!1:B,this.initGlyph(),this.updateTexture(),V||this.filterGlyphs(),at.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Sw,fragmentShader:Ew,triangulation:ww.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F)});case 6:return j=at.sent,at.abrupt("return",[j]);case 8:case"end":return at.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"needUpdate",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at;return it().wrap(function(Bt){for(;;)switch(Bt.prev=Bt.next){case 0:if(v=this.layer.getLayerConfig(),m=v.textAllowOverlap,E=m===void 0?!1:m,A=v.textAnchor,F=A===void 0?"center":A,B=v.textOffset,V=this.layer.getEncodedData(),!(JSON.stringify(B)!==JSON.stringify(this.preTextStyle.textOffset)||F!==this.preTextStyle.textAnchor)){Bt.next=6;break}return Bt.next=5,this.mapping();case 5:return Bt.abrupt("return",!0);case 6:if(!(V.length<5||E)){Bt.next=8;break}return Bt.abrupt("return",!1);case 8:if(j=this.mapService.getZoom(),nt=this.mapService.getBounds(),at=Su(this.extent,nt),!(Math.abs(this.currentZoom-j)>1||!at||E!==this.preTextStyle.textAllowOverlap)){Bt.next=15;break}return Bt.next=14,this.reBuildModel();case 14:return Bt.abrupt("return",!0);case 15:return Bt.abrupt("return",!1);case 16:case"end":return Bt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Vi.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(h){var v=h.rotate,m=v===void 0?0:v;return Array.isArray(m)?[m[0]]:[m]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Vi.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(h,v,m){return[m[5],m[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(h){var v=h.size,m=v===void 0?12:v;return Array.isArray(m)?[m[0]]:[m]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Vi.Attribute,descriptor:{name:"a_tex",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var o=this.mapService.getBounds();return Nl(o,.5)}},{key:"initTextFont",value:function(){var o=this.layer.getLayerConfig(),h=o.fontWeight,v=h===void 0?"400":h,m=o.fontFamily,E=m===void 0?"sans-serif":m,A=this.layer.getEncodedData(),F=[];A.forEach(function(B){var V=B.shape,j=V===void 0?"":V;j=j.toString();var nt=ZI(j),at;try{for(nt.s();!(at=nt.n()).done;){var mt=at.value;F.indexOf(mt)===-1&&F.push(mt)}}catch(Bt){nt.e(Bt)}finally{nt.f()}}),this.fontService.setFontOptions({characterSet:F,fontWeight:v,fontFamily:E,iconfont:!1})}},{key:"initIconFontTex",value:function(){var o=this.layer.getLayerConfig(),h=o.fontWeight,v=h===void 0?"400":h,m=o.fontFamily,E=m===void 0?"sans-serif":m,A=this.layer.getEncodedData(),F=[];A.forEach(function(B){var V=B.shape,j=V===void 0?"":V;j="".concat(j),F.indexOf(j)===-1&&F.push(j)}),this.fontService.setFontOptions({characterSet:F,fontWeight:v,fontFamily:E,iconfont:!0})}},{key:"generateGlyphLayout",value:function(o){var h=this,v=this.fontService.mapping,m=this.layer.getLayerConfig(),E=m.spacing,A=E===void 0?2:E,F=m.textAnchor,B=F===void 0?"center":F,V=m.textOffset,j=this.layer.getEncodedData();this.glyphInfo=j.map(function(nt){var at=nt.shape,mt=at===void 0?"":at,Bt=nt.id,de=nt.size,ce=de===void 0?1:de,Be=yw(mt.toString(),v,ce,B,"left",A,V||nt.textOffset||[0,0],o),Xe=_w(Be,V,!1);return nt.shaping=Be,nt.glyphQuads=Xe,nt.centroid=bs(nt.coordinates),nt.originCentroid=nt.version==="GAODE2.x"?bs(nt.originCoordinates):nt.originCentroid=nt.centroid,h.glyphInfoMap[Bt]={shaping:Be,glyphQuads:Xe,centroid:bs(nt.coordinates)},nt})}},{key:"filterGlyphs",value:function(){var o=this,h=this.layer.getLayerConfig(),v=h.padding,m=v===void 0?[0,0]:v,E=h.textAllowOverlap,A=E===void 0?!1:E;if(!A){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var F=this.rendererService.getViewportSize(),B=F.width,V=F.height,j=new pw(B,V),nt=this.glyphInfo.filter(function(at){var mt=at.shaping,Bt=at.id,de=Bt===void 0?0:Bt,ce=at.version==="GAODE2.x"?at.originCentroid:at.centroid,Be=at.size,Xe=Be/16,_r=o.mapService.lngLatToContainer(ce),Ir=j.placeCollisionBox({x1:mt.left*Xe-m[0],x2:mt.right*Xe+m[0],y1:mt.top*Xe-m[1],y2:mt.bottom*Xe+m[1],anchorPointX:_r.x,anchorPointY:_r.y}),Nr=Ir.box;return Nr&&Nr.length?(j.insertCollisionBox(Nr,de),!0):!1});nt.forEach(function(at){o.glyphInfoMap[at.id]=at})}}},{key:"initGlyph",value:function(){var o=this.layer.getLayerConfig(),h=o.iconfont,v=h===void 0?!1:h;v?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(v)}},{key:"updateTexture",value:function(){var o=this.rendererService.createTexture2D,h=this.fontService.canvas;this.textureHeight=h.height,this.texture&&this.texture.destroy(),this.texture=o({data:h,mag:Kt.LINEAR,min:Kt.LINEAR,width:h.width,height:h.height})}},{key:"reBuildModel",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,this.filterGlyphs(),j.next=4,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Sw,fragmentShader:Ew,triangulation:ww.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F)});case 4:B=j.sent,this.layer.models=[B];case 6:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()}]),a}(ws);function GI(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=Aw(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function Aw(n,l){if(!!n){if(typeof n=="string")return Tw(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Tw(n,l)}}function Tw(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function HI(n){var l=pm();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function pm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dm=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Nx=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,zx=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;

uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;
uniform vec4 u_color;

void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  
  gl_FragColor = mix(vec4(u_color.rgb, u_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
}
`,Mw=`#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_size;

varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "projection"

void main() {
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = u_size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;

}
`;function Iw(n){var l=this,a=n.id,s=[],o=[];if(!l.glyphInfoMap||!l.glyphInfoMap[a])return{vertices:[],indices:[],size:7};var h=l.glyphInfoMap[a].centroid,v=h.length===2?[h[0],h[1],0]:h;return l.glyphInfoMap[a].glyphQuads.forEach(function(m,E){s.push.apply(s,(0,ge.Z)(v).concat([m.tex.x,m.tex.y+m.tex.height,m.tl.x,m.tl.y],(0,ge.Z)(v),[m.tex.x+m.tex.width,m.tex.y+m.tex.height,m.tr.x,m.tr.y],(0,ge.Z)(v),[m.tex.x+m.tex.width,m.tex.y,m.br.x,m.br.y],(0,ge.Z)(v),[m.tex.x,m.tex.y,m.bl.x,m.bl.y])),o.push(0+E*4,1+E*4,2+E*4,2+E*4,3+E*4,0+E*4)}),{vertices:s,indices:o,size:7}}var kw=function(n){(0,Ut.Z)(a,n);var l=HI(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"glyphInfoMap",{}),(0,W.Z)((0,st.Z)(s),"currentZoom",-1),(0,W.Z)((0,st.Z)(s),"textureHeight",0),(0,W.Z)((0,st.Z)(s),"textCount",0),(0,W.Z)((0,st.Z)(s),"preTextStyle",{}),(0,W.Z)((0,st.Z)(s),"mapping",function(){s.initGlyph(),s.updateTexture(),s.filterGlyphs(),s.reBuildModel()}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.stroke,E=m===void 0?"#fff":m,A=o.strokeWidth,F=A===void 0?0:A,B=o.textAnchor,V=B===void 0?"center":B,j=o.textAllowOverlap,nt=j===void 0?!1:j,at=o.halo,mt=at===void 0?.5:at,Bt=o.gamma,de=Bt===void 0?2:Bt,ce=o.usage,Be=o.color,Xe=Be===void 0?"#fff":Be,_r=o.size,Ir=_r===void 0?1:_r,Nr=this.fontService,Yr=Nr.canvas,yn=Nr.mapping;return Object.keys(yn).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(yn).length),this.preTextStyle={textAnchor:V,textAllowOverlap:nt},{u_opacity:(0,te.isNumber)(v)?v:1,u_stroke_width:(0,te.isNumber)(F)?F:1,u_stroke_color:this.getStrokeColor(E),u_sdf_map:this.texture,u_halo_blur:mt,u_gamma_scale:de,u_sdf_map_size:[Yr.width,Yr.height],u_color:ce==="basemap"?ke(Xe):[0,0,0,0],u_size:ce==="basemap"?Ir:1}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return this.extent=this.textExtent(),v=this.layer.getLayerConfig(),m=v.textAnchor,E=m===void 0?"center":m,A=v.textAllowOverlap,F=A===void 0?!0:A,this.preTextStyle={textAnchor:E,textAllowOverlap:F},V.next=5,this.buildModels();case 5:return V.abrupt("return",V.sent);case 6:case"end":return V.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return this.mapping(),v=this.layer.getLayerConfig(),m=v.usage,F.next=4,this.layer.buildLayerModel({moduleName:"pointTileText_"+m,vertexShader:m==="basemap"?Mw:Nx,fragmentShader:m==="basemap"?zx:dm,triangulation:Iw.bind(this),depth:{enable:!1},blend:this.getBlend(),pick:m!=="basemap"});case 4:return E=F.sent,F.abrupt("return",[E]);case 6:case"end":return F.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getLayerConfig(),h=o.usage;this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Vi.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(m,E,A){return[A[5],A[6]]}}}),h!=="basemap"&&this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(m){var E=m.size,A=E===void 0?12:E;return Array.isArray(A)?[A[0]]:[A]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Vi.Attribute,descriptor:{name:"a_tex",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(m,E,A){return[A[3],A[4]]}}})}},{key:"textExtent",value:function(){var o=this.mapService.getBounds();return Nl(o,.5)}},{key:"initTextFont",value:function(){var o=this.layer.getLayerConfig(),h=o.fontWeight,v=h===void 0?"400":h,m=o.fontFamily,E=m===void 0?"sans-serif":m,A=this.layer.getEncodedData(),F=[];A.forEach(function(B){var V=B.shape,j=V===void 0?"":V;j=j.toString();var nt=GI(j),at;try{for(nt.s();!(at=nt.n()).done;){var mt=at.value;F.indexOf(mt)===-1&&F.push(mt)}}catch(Bt){nt.e(Bt)}finally{nt.f()}}),this.fontService.setFontOptions({characterSet:F,fontWeight:v,fontFamily:E,iconfont:!1})}},{key:"generateGlyphLayout",value:function(){var o=this,h=this.fontService.mapping,v=this.layer.getLayerConfig(),m=v.spacing,E=m===void 0?2:m,A=v.textAnchor,F=A===void 0?"center":A,B=this.layer.getEncodedData();this.glyphInfo=B.map(function(V){var j=V.shape,nt=j===void 0?"":j,at=V.id,mt=V.size,Bt=mt===void 0?1:mt,de=V.textOffset,ce=de===void 0?[0,0]:de,Be=yw(nt.toString(),h,Bt,F,"left",E,ce,!1),Xe=_w(Be,ce,!1);return V.shaping=Be,V.glyphQuads=Xe,V.centroid=bs(V.coordinates),V.originCentroid=V.version==="GAODE2.x"?bs(V.originCoordinates):V.originCentroid=V.centroid,o.glyphInfoMap[at]={shaping:Be,glyphQuads:Xe,centroid:bs(V.coordinates)},V})}},{key:"filterGlyphs",value:function(){var o=this,h=this.layer.getLayerConfig(),v=h.padding,m=v===void 0?[4,4]:v,E=h.textAllowOverlap,A=E===void 0?!1:E;if(!A){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var F=this.rendererService.getViewportSize(),B=F.width,V=F.height,j=new pw(B,V),nt=this.glyphInfo.filter(function(at){var mt=at.shaping,Bt=at.id,de=Bt===void 0?0:Bt,ce=at.version==="GAODE2.x"?at.originCentroid:at.centroid,Be=at.size,Xe=Be/24,_r=o.mapService.lngLatToContainer(ce),Ir=j.placeCollisionBox({x1:mt.left*Xe-m[0],x2:mt.right*Xe+m[0],y1:mt.top*Xe-m[1],y2:mt.bottom*Xe+m[1],anchorPointX:_r.x,anchorPointY:_r.y}),Nr=Ir.box;return Nr&&Nr.length?(j.insertCollisionBox(Nr,de),!0):!1});nt.forEach(function(at){o.glyphInfoMap[at.id]=at})}}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var o=this.rendererService.createTexture2D,h=this.fontService.canvas;this.textureHeight=h.height,this.texture&&this.texture.destroy(),this.texture=o({data:h,mag:Kt.LINEAR,min:Kt.LINEAR,width:h.width,height:h.height})}},{key:"reBuildModel",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return v=this.layer.getLayerConfig(),m=v.usage,this.filterGlyphs(),F.next=4,this.layer.buildLayerModel({moduleName:"pointTileText_"+m,vertexShader:m==="basemap"?Mw:Nx,fragmentShader:m==="basemap"?zx:dm,triangulation:Iw.bind(this),depth:{enable:!1},blend:this.getBlend(),pick:m!=="basemap"});case 4:return E=F.sent,F.abrupt("return",[E]);case 6:case"end":return F.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()}]),a}(ws);function jI(n){var l=WI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function WI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var XI=`uniform float u_additive;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));


  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), u_stroke_color * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,YI=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  float newSize = setPickingSize(a_Size);

  // cal style mapping

  v_color = a_Color;
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, 0.0);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width));
  offset = project_pixel(offset);

  v_data = vec4(extrude.x, extrude.y, antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
  }

// if(u_coord > 0.0) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
  }
// } else {

  // vec2 pointPos = a_Position.xy;
  // vec4 world = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  // vec2 pointOffset =  pointPos *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
  
  // world.xy += offset;
  // world.xy += pointOffset;

  // if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //   // Needs to be divided with project_uCommonUnitsPerMeter
  //   world.w *= u_PixelsPerMeter.z;
  // }

  // gl_Position = u_ViewProjectionMatrix * world + u_ViewportCenterProjection;
// }

 
  setPickingColor(a_PickingColor);


}
`,$I=function(n){(0,Ut.Z)(a,n);var l=jI(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.strokeOpacity,E=m===void 0?1:m,A=o.strokeWidth,F=A===void 0?0:A,B=o.stroke,V=B===void 0?"rgba(0,0,0,0)":B,j=o.blend;return{u_additive:j==="additive"?1:0,u_opacity:Number(v),u_stroke_opacity:Number(E),u_stroke_width:Number(F),u_stroke_color:this.getStrokeColor(V)}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),A0)}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return v=this.layer.getLayerConfig(),m=v.workerEnabled,E=m===void 0?!1:m,A=v.usage,this.layer.triangulation=A0,V.next=4,this.layer.buildLayerModel({moduleName:"pointTile_"+A,vertexShader:YI,fragmentShader:XI,triangulation:A0,depth:{enable:!1},cull:{enable:!0,face:ec(this.mapService.version)},blend:this.getBlend(),workerEnabled:E,workerOptions:{modelType:"pointTile"},pick:A!=="basemap"});case 4:return F=V.sent,V.abrupt("return",[F]);case 6:case"end":return V.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Vi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(v,m,E,A){var F=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],B=A%4*3;return[F[B],F[B+1],F[B+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Vi.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(v){var m=v.shape,E=m===void 0?2:m,A=o.layer.getLayerConfig().shape2d,F=A.indexOf(E);return[F]}}})}}]),a}(ws),Lw={fillImage:CI,fill:rw,radar:uw,image:aw,normal:hm,simplePoint:fw,extrude:Lx,text:Cw,tile:$I,tileText:kw,earthFill:yI,earthExtrude:KS},qI=Lw;function I0(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=vm(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function vm(n,l){if(!!n){if(typeof n=="string")return k0(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return k0(n,l)}}function k0(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function Pw(n){var l=KI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function KI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Gy=function(n){(0,Ut.Z)(a,n);var l=Pw(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"type","PointLayer"),(0,W.Z)((0,st.Z)(s),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),s}return(0,tt.Z)(a,[{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new qI[v](this),E.next=5,this.initLayerModels();case 5:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"rebuildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var o=this.shapeOption,h=o.field,v=o.values,m=this.getLayerConfig(),E=m.shape2d,A=this.iconService.getIconMap();if(h&&(E==null?void 0:E.indexOf(h))!==-1)return"fill";if(v==="text")return"text";if(v&&v instanceof Array){var F=I0(v),B;try{for(F.s();!(B=F.n()).done;){var V=B.value;if(typeof V=="string"&&A.hasOwnProperty(V))return"image"}}catch(j){F.e(j)}finally{F.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var o=this.getModelType(),h={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return h[o]}},{key:"getModelType",value:function(){var o=this.getEncodedData(),h=this.getLayerConfig(),v=h.shape2d,m=h.shape3d,E=this.iconService.getIconMap(),A=o.find(function(B){return B.hasOwnProperty("shape")});if(A){var F=A.shape;return F==="dot"?"normal":F==="simple"?"simplePoint":F==="radar"?"radar":this.layerType==="fillImage"?"fillImage":(v==null?void 0:v.indexOf(F))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(m==null?void 0:m.indexOf(F))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":E.hasOwnProperty(F)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),a}(dg);function wg(n){var l=Ow();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Ow(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var QI=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];  
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }

  } else {
     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,JI=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,tk=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float lightWeight = styleMappingMat[3][1];
  float topU = styleMappingMat[2][2];
  float topV = styleMappingMat[2][3];

  float sidey = styleMappingMat[3][0];
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }
  } else {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Fw=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_Color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - a_Position.z(judge side by a_Position.z)
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - u - v
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[2][2] = a_uvs[0];
  styleMappingMat[2][3] = 1.0 - a_uvs[1];
  styleMappingMat[3][0] = a_uvs[2];


  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,ek=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      // side notuse linear
       gl_FragColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,rk=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,nk=function(n){(0,Ut.Z)(a,n);var l=wg(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.heightfixed,E=m===void 0?!1:m,A=o.raisingHeight,F=A===void 0?0:A,B=o.topsurface,V=B===void 0?!0:B,j=o.sidesurface,nt=j===void 0?!0:j,at=o.sourceColor,mt=o.targetColor;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var Bt=this.layer.getEncodedData(),de=this.calDataFrame(this.cellLength,Bt,this.cellProperties),ce=de.data,Be=de.width,Xe=de.height;this.rowCount=Xe,this.dataTexture=this.cellLength>0&&ce.length>0?this.createTexture2D({flipY:!0,data:ce,format:Kt.LUMINANCE,type:Kt.FLOAT,width:Be,height:Xe}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}var _r=0,Ir=[1,1,1,1],Nr=[1,1,1,1];return at&&mt&&(Ir=ke(at),Nr=ke(mt),_r=1),{u_topsurface:Number(V),u_sidesurface:Number(nt),u_heightfixed:Number(E),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(F),u_opacity:(0,te.isNumber)(v)?v:1,u_linearColor:_r,u_sourceColor:Ir,u_targetColor:Nr,u_texture:this.texture}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.loadTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at;return it().wrap(function(Bt){for(;;)switch(Bt.prev=Bt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=this.getShaders(),V=B.frag,j=B.vert,nt=B.type,Bt.next=4,this.layer.buildLayerModel({moduleName:nt,vertexShader:j,fragmentShader:V,triangulation:b5,stencil:Rr(E,F)});case 4:return at=Bt.sent,Bt.abrupt("return",[at]);case 6:case"end":return Bt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.pickLight,v=o.mapTexture;return v?{frag:tk,vert:Fw,type:"polygonExtrudeTexture"}:h?{frag:ek,vert:rk,type:"polygonExtrudePickLight"}:{frag:QI,vert:JI,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var o,h;(o=this.dataTexture)===null||o===void 0||o.destroy(),(h=this.texture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getSource().extent,h=(0,ht.Z)(o,4),v=h[0],m=h[1],E=h[2],A=h[3],F=E-v,B=A-m;this.styleAttributeService.registerStyleAttribute({name:"uvs",type:Vi.Attribute,descriptor:{name:"a_uvs",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(j,nt,at){var mt=at[0],Bt=at[1];return[(mt-v)/F,(Bt-m)/B,at[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(j,nt,at,mt,Bt){return Bt}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(j){var nt=j.size,at=nt===void 0?10:nt;return Array.isArray(at)?[at[0]]:[at]}}})}},{key:"loadTexture",value:function(){var o=this,h=this.layer.getLayerConfig(),v=h.mapTexture,m=this.rendererService.createTexture2D;if(this.texture=m({height:0,width:0}),v){var E=new Image;E.crossOrigin="",E.src=v,E.onload=function(){o.texture=m({data:E,width:E.width,height:E.height,wrapS:Kt.CLAMP_TO_EDGE,wrapT:Kt.CLAMP_TO_EDGE,min:Kt.LINEAR,mag:Kt.LINEAR}),o.layerService.reRender()}}}}]),a}(ws);function ik(n){var l=Rw();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Rw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ak=`uniform float u_opacity: 1.0;
varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,ok=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;


void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,sk=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}`,uk=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,Ux=function(n){(0,Ut.Z)(a,n);var l=ik(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.raisingHeight,v=h===void 0?0:h,m=o.opacity,E=m===void 0?1:m,A=o.opacityLinear,F=A===void 0?{enable:!1,dir:"in"}:A;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:E})){this.judgeStyleAttributes({opacity:E});var B=this.layer.getEncodedData(),V=this.calDataFrame(this.cellLength,B,this.cellProperties),j=V.data,nt=V.width,at=V.height;this.rowCount=at,this.dataTexture=this.cellLength>0&&j.length>0?this.createTexture2D({flipY:!0,data:j,format:Kt.LUMINANCE,type:Kt.FLOAT,width:nt,height:at}):this.createTexture2D({flipY:!0,data:[1],format:Kt.LUMINANCE,type:Kt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(v),u_opacity:(0,te.isNumber)(E)?E:1,u_opacitylinear:Number(F.enable),u_dir:F.dir==="in"?1:0}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at,mt,Bt,de,ce;return it().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:return v=this.getModelParams(),m=v.frag,E=v.vert,A=v.triangulation,F=v.type,B=this.layer.getLayerConfig(),V=B.mask,j=V===void 0?!1:V,nt=B.maskInside,at=nt===void 0?!0:nt,mt=B.workerEnabled,Bt=mt===void 0?!1:mt,de=B.enablePicking,this.layer.triangulation=A,Xe.next=5,this.layer.buildLayerModel({moduleName:F,vertexShader:E,fragmentShader:m,triangulation:A,primitive:Kt.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(j,at),workerEnabled:Bt,workerOptions:{modelType:F,enablePicking:de}});case 5:return ce=Xe.sent,Xe.abrupt("return",[ce]);case 7:case"end":return Xe.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getLayerConfig(),h=o.opacityLinear,v=h===void 0?{enable:!1,dir:"in"}:h;v.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Vi.Attribute,descriptor:{name:"a_linear",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:3,update:function(E,A,F){return[F[3],F[4],F[5]]}}})}},{key:"getModelParams",value:function(){var o=this.layer.getLayerConfig(),h=o.opacityLinear,v=h===void 0?{enable:!1}:h;return v.enable?{frag:ok,vert:sk,type:"polygonLinear",triangulation:RS}:{frag:ak,vert:uk,type:"polygonFill",triangulation:Ad}}}]),a}(ws);function lk(n){var l=ck();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ck(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var fk=`
uniform float u_time: 0.0;
uniform float u_opacity: 1.0;

varying vec2 v_uv;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = u_opacity;
  gl_FragColor = vec4(col, opacity);  
}
`,hk=`attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,pk=function(n){(0,Ut.Z)(a,n);var l=lk(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.watercolor,E=m===void 0?"#6D99A8":m,A=o.watercolor2,F=A===void 0?"#0F121C":A;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:ke(E),u_watercolor2:ke(F),u_opacity:(0,te.isNumber)(v)?v:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.loadTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:hk,fragmentShader:fk,triangulation:xg,primitive:Kt.TRIANGLES,depth:{enable:!1},stencil:Rr(E,F)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h,v;(o=this.texture1)===null||o===void 0||o.destroy(),(h=this.texture2)===null||h===void 0||h.destroy(),(v=this.texture3)===null||v===void 0||v.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getSource().extent,h=(0,ht.Z)(o,4),v=h[0],m=h[1],E=h[2],A=h[3],F=E-v,B=A-m;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:Vi.Attribute,descriptor:{name:"a_uv",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(j,nt,at,mt){var Bt=j.version===yu["GAODE2.x"]?j.originCoordinates[0][mt]:at,de=(0,ht.Z)(Bt,2),ce=de[0],Be=de[1];return[(ce-v)/F,(Be-m)/B]}}})}},{key:"loadTexture",value:function(){var o=this,h=this.rendererService.createTexture2D,v={height:0,width:0};this.texture1=h(v),this.texture2=h(v),this.texture3=h(v),m(function(A){o.texture1=E(A[0]),o.texture2=E(A[1]),o.texture3=E(A[2]),o.layerService.reRender()});function m(A){var F=0,B=[],V=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];V.map(function(j){var nt=new Image;nt.crossOrigin="",nt.src=j,B.push(nt),nt.onload=function(){F++,F===3&&A(B)}})}function E(A){return h({data:A,width:A.width,height:A.height,wrapS:Kt.MIRRORED_REPEAT,wrapT:Kt.MIRRORED_REPEAT,min:Kt.LINEAR,mag:Kt.LINEAR})}}}]),a}(ws);function dk(n){var l=vk();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function vk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var gk=`uniform float u_opacity : 1.0;
varying vec4 v_color;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Cg=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

varying vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  // if(u_coord > 0.0) {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
    }
  // } else {
  //   vec4 world = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  //   vec2 pointOffset = a_Position.xy *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
    
  //   world.xy += pointOffset;

  //   if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //     // Needs to be divided with project_uCommonUnitsPerMeter
  //     world.w *= u_PixelsPerMeter.z;
  //   }

  //   gl_Position = u_ViewProjectionMatrix * world + u_ViewportCenterProjection;
  // }

  setPickingColor(a_PickingColor);
}

`,mk=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,$O=`attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}`,od=function(n){(0,Ut.Z)(a,n);var l=dk(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.usage,E=o.color,A=E===void 0?"#fff":E;return{u_opacity:v,u_color:m==="basemap"?ke(A):[0,0,0,0]}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V;return it().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.usage,this.layer.triangulation=xg,nt.next=4,this.layer.buildLayerModel({moduleName:"polygonTile_"+B,vertexShader:B==="basemap"?$O:Cg,fragmentShader:B==="basemap"?mk:gk,triangulation:xg,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F),pick:B!=="basemap"});case 4:return V=nt.sent,nt.abrupt("return",[V]);case 6:case"end":return nt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){}}]),a}(ws);function sd(n){var l=L0();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function L0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Dw=`uniform sampler2D u_texture;
uniform float u_time: 0.0;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  float opacity = u_opacity;
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,Jd=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;


#pragma include "projection"

void main() {
  v_uv = a_uv;

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,yk=function(n){(0,Ut.Z)(a,n);var l=sd(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.speed,E=m===void 0?.5:m;return{u_texture:this.texture,u_speed:E,u_opacity:(0,te.isNumber)(v)?v:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.loadTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:Jd,fragmentShader:Dw,triangulation:xg,primitive:Kt.TRIANGLES,depth:{enable:!1},stencil:Rr(E,F)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getSource().extent,h=(0,ht.Z)(o,4),v=h[0],m=h[1],E=h[2],A=h[3],F=E-v,B=A-m;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:Vi.Attribute,descriptor:{name:"a_uv",buffer:{usage:Kt.STATIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(j,nt,at,mt){var Bt=j.version===yu["GAODE2.x"]?j.originCoordinates[0][mt]:at,de=(0,ht.Z)(Bt,2),ce=de[0],Be=de[1];return[(ce-v)/F,(Be-m)/B]}}})}},{key:"loadTexture",value:function(){var o=this,h=this.layer.getLayerConfig(),v=h.waterTexture,m=this.rendererService.createTexture2D;this.texture=m({height:0,width:0});var E=new Image;E.crossOrigin="",v?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),E.src=v):E.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",E.onload=function(){o.texture=m({data:E,width:E.width,height:E.height,wrapS:Kt.MIRRORED_REPEAT,wrapT:Kt.MIRRORED_REPEAT,min:Kt.LINEAR,mag:Kt.LINEAR}),o.layerService.reRender()}}}]),a}(ws),_k={fill:Ux,line:Mx,extrude:nk,text:Cw,point_fill:rw,point_image:aw,point_normal:hm,point_extrude:Lx,water:yk,ocean:pk,tile:od},xk=_k;function bk(n){var l=Ek();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Ek(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Zx=function(n){(0,Ut.Z)(a,n);var l=bk(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"type","PolygonLayer"),s}return(0,tt.Z)(a,[{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel=new xk[v](this),E.next=4,this.initLayerModels();case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getModelType",value:function(){var o,h=this.styleAttributeService.getLayerStyleAttribute("shape"),v=h==null||(o=h.scale)===null||o===void 0?void 0:o.field;return v==="fill"?"fill":v==="extrude"?"extrude":v==="water"?"water":v==="ocean"?"ocean":v==="line"?"line":v==="tile"?"tile":this.getPointModelType()}},{key:"getPointModelType",value:function(){var o=this.getEncodedData(),h=this.getLayerConfig(),v=h.shape2d,m=h.shape3d,E=this.iconService.getIconMap(),A=o.find(function(B){return B.hasOwnProperty("shape")});if(A){var F=A.shape;return F==="dot"?"point_normal":(v==null?void 0:v.indexOf(F))!==-1?"point_fill":(m==null?void 0:m.indexOf(F))!==-1?"point_extrude":E.hasOwnProperty(F)?"point_image":"text"}else return"fill"}}]),a}(dg);function Sk(n){var l=wk();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function wk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ck=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,Ak=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,qO=function(n){(0,Ut.Z)(a,n);var l=Sk(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?0:h,m=o.color,E=m===void 0?"#000":m;return{u_opacity:(0,te.isNumber)(v)?v:0,u_color:ke(E)}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this.layer.buildLayerModel({moduleName:"mask",vertexShader:Ak,fragmentShader:Ck,triangulation:xg,depth:{enable:!1},blend:this.getBlend(),stencil:{enable:!0,mask:255,func:{cmp:Kt.ALWAYS,ref:1,mask:255},opFront:{fail:Kt.REPLACE,zfail:Kt.REPLACE,zpass:Kt.REPLACE}},pick:!1});case 2:return v=E.sent,E.abrupt("return",[v]);case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;o&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),a}(ws),Vx={fill:qO},Ag=Vx;function Tk(n){var l=Mk();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Mk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Hy=function(n){(0,Ut.Z)(a,n);var l=Tk(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"type","MaskLayer"),s}return(0,tt.Z)(a,[{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel=new Ag[v](this),E.next=4,this.initLayerModels();case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getModelType",value:function(){return"fill"}}]),a}(dg),Bw,Gx,Nw,zw,jy,Uw,Zw,Ik=(Bw=(0,Mt.b2)(),Gx=(0,Mt.f3)(Dt.IMapService),Nw=(0,Mt.f3)(Dt.IFontService),Bw(zw=(jy=function(){function n(){(0,lt.Z)(this,n),Ar(this,"mapService",Uw,this),Ar(this,"fontService",Zw,this)}return(0,tt.Z)(n,[{key:"apply",value:function(a,s){var o=this,h=s.styleAttributeService;a.hooks.init.tapPromise("DataMappingPlugin",(0,ut.Z)(it().mark(function v(){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:o.generateMaping(a,{styleAttributeService:h});case 1:case"end":return E.stop()}},v)}))),a.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var v=(0,ut.Z)(it().mark(function m(E){return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(E){F.next=2;break}return F.abrupt("return",E);case 2:return a.dataState.dataMappingNeedUpdate=!1,o.generateMaping(a,{styleAttributeService:h}),F.abrupt("return",!0);case 5:case"end":return F.stop()}},m)}));return function(m){return v.apply(this,arguments)}}()),a.hooks.beforeRender.tap("DataMappingPlugin",function(){var v=a.getSource();if(!(a.layerModelNeedUpdate||!v||!v.inited)){var m=h.getLayerStyleAttributes()||[],E=h.getLayerStyleAttribute("filter"),A=v.data.dataArray;if(!(Array.isArray(A)&&A.length===0)){var F=m.filter(function(nt){return nt.needRemapping}),B=A;if(E!=null&&E.needRemapping&&E!==null&&E!==void 0&&E.scale&&(B=A.filter(function(nt){return o.applyAttributeMapping(E,nt)[0]})),F.length)if(E!=null&&E.needRemapping){var V=o.mapping(a,m,B,void 0);a.setEncodedData(V),E.needRemapping=!1}else{var j=o.mapping(a,F,B,a.getEncodedData());a.setEncodedData(j)}}}})}},{key:"generateMaping",value:function(a,s){var o=this,h=s.styleAttributeService,v=h.getLayerStyleAttributes()||[],m=h.getLayerStyleAttribute("filter"),E=a.getSource().data.dataArray,A=E;m!=null&&m.scale&&(A=E.filter(function(B){return o.applyAttributeMapping(m,B)[0]})),A=a.processData(A);var F=this.mapping(a,v,A,void 0);a.setEncodedData(F),a.emit("dataUpdate",null)}},{key:"mapping",value:function(a,s,o,h){var v=this,m=a.getLayerConfig(),E=m.arrow,A=E===void 0?{enable:!1}:E,F=s.filter(function(V){return V.scale!==void 0}),B=o.map(function(V,j){var nt=h?h[j]:{},at=(0,K.Z)({id:V._id,coordinates:V.coordinates},nt);if(F.forEach(function(de){var ce=v.applyAttributeMapping(de,V);de.needRemapping=!1,de.name==="color"&&(ce=ce.map(function(Be){return ke(Be)})),at[de.name]=Array.isArray(ce)&&ce.length===1?ce[0]:ce,de.name==="shape"&&(at.shape=v.fontService.getIconFontKey(at[de.name]))}),A.enable&&(at.shape==="line"||at.shape==="halfLine")){var mt=at.coordinates;if(a.arrowInsertCount<a.encodeDataLength){var Bt=v.getArrowPoints(mt[0],mt[1]);at.coordinates.splice(1,0,Bt,Bt),a.arrowInsertCount++}}return at});return this.adjustData2Amap2Coordinates(B,a),this.adjustData2SimpleCoordinates(B),B}},{key:"adjustData2Amap2Coordinates",value:function(a,s){var o=this;if(a.length>0&&this.mapService.version===yu["GAODE2.x"]){var h=s.coordCenter||s.getSource().center;typeof a[0].coordinates[0]=="number"?a.filter(function(v){return!v.originCoordinates}).map(function(v){v.version=yu["GAODE2.x"],v.originCoordinates=(0,te.cloneDeep)(v.coordinates),v.coordinates=o.mapService.lngLatToCoordByLayer(v.coordinates,h)}):a.filter(function(v){return!v.originCoordinates}).map(function(v){v.version=yu["GAODE2.x"],v.originCoordinates=(0,te.cloneDeep)(v.coordinates),v.coordinates=o.mapService.lngLatToCoordsByLayer(v.coordinates,h)})}}},{key:"adjustData2SimpleCoordinates",value:function(a){var s=this;a.length>0&&this.mapService.version===yu.SIMPLE&&a.map(function(o){o.simpleCoordinate||(o.coordinates=s.unProjectCoordinates(o.coordinates),o.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(a){var s=this;if(typeof a[0]=="number")return this.mapService.simpleMapCoord.unproject(a);if(a[0]&&a[0][0]instanceof Array){var o=[];return a.map(function(v){var m=[];v.map(function(E){m.push(s.mapService.simpleMapCoord.unproject(E))}),o.push(m)}),o}else{var h=[];return a.map(function(v){h.push(s.mapService.simpleMapCoord.unproject(v))}),h}}},{key:"applyAttributeMapping",value:function(a,s){var o;if(!a.scale)return[];var h=(a==null||(o=a.scale)===null||o===void 0?void 0:o.scalers)||[],v=[];h.forEach(function(E){var A,F=E.field;(s.hasOwnProperty(F)||((A=a.scale)===null||A===void 0?void 0:A.type)==="variable")&&v.push(s[F])});var m=a.mapping?a.mapping(v):[];return m}},{key:"getArrowPoints",value:function(a,s){var o=[s[0]-a[0],s[1]-a[1]],h=Il(o),v=[a[0]+h[0]*1e-4,a[1]+h[1]*1e-4];return v}}]),n}(),Uw=Dr(jy.prototype,"mapService",[Gx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zw=Dr(jy.prototype,"fontService",[Nw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jy))||zw),kk,Hx,Vw=(kk=(0,Mt.b2)(),kk(Hx=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"apply",value:function(a){var s=this;this.mapService=a.getContainer().get(Dt.IMapService),a.hooks.init.tapPromise("DataSourcePlugin",(0,ut.Z)(it().mark(function o(){var h,v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(h=a.getSource(),h||(v=a.sourceOption||a.defaultSourceConfig,m=v.data,E=v.options,h=new Zv(m,E),a.setSource(h)),!h.inited){F.next=6;break}s.updateClusterData(a),F.next=8;break;case 6:return F.next=8,new Promise(function(B){h.on("update",function(V){V.type==="inited"&&s.updateClusterData(a),B(null)})});case 8:case"end":return F.stop()}},o)}))),a.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,ut.Z)(it().mark(function o(){var h,v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return h=s.updateClusterData(a),v=a.dataState.dataSourceNeedUpdate,a.dataState.dataSourceNeedUpdate=!1,E.abrupt("return",h||v);case 4:case"end":return E.stop()}},o)})))}},{key:"updateClusterData",value:function(a){if(a.isTileLayer||a.tileLayer||!a.getSource())return!1;var s=a.getSource(),o=s.cluster,h=s.clusterOptions.zoom,v=h===void 0?0:h,m=this.mapService.getZoom()-1,E=a.dataState.dataSourceNeedUpdate;return o&&E&&s.updateClusterData(Math.floor(m)),o&&Math.abs(a.clusterZoom-m)>=1?(v!==Math.floor(m)&&s.updateClusterData(Math.floor(m)),a.clusterZoom=m,!0):!1}}]),n}())||Hx);function jx(n,l){return n<l?-1:n>l?1:n>=l?0:NaN}function Wx(n){return n.length===1&&(n=Lk(n)),{left:function(l,a,s,o){for(s==null&&(s=0),o==null&&(o=l.length);s<o;){var h=s+o>>>1;n(l[h],a)<0?s=h+1:o=h}return s},right:function(l,a,s,o){for(s==null&&(s=0),o==null&&(o=l.length);s<o;){var h=s+o>>>1;n(l[h],a)>0?o=h:s=h+1}return s}}}function Lk(n){return function(l,a){return jx(n(l),a)}}var Gw=Wx(jx),Pk=Gw.right,KO=Gw.left,Wy=Pk;function Ok(n,l){var a=n.length,s=-1,o,h,v;if(l==null){for(;++s<a;)if((o=n[s])!=null&&o>=o)for(h=v=o;++s<a;)(o=n[s])!=null&&(h>o&&(h=o),v<o&&(v=o))}else for(;++s<a;)if((o=l(n[s],s,n))!=null&&o>=o)for(h=v=o;++s<a;)(o=l(n[s],s,n))!=null&&(h>o&&(h=o),v<o&&(v=o));return[h,v]}var Hw=Array.prototype,QO=Hw.slice,JO=Hw.map,Xx=Math.sqrt(50),Yx=Math.sqrt(10),$x=Math.sqrt(2);function jw(n,l,a){var s,o=-1,h,v,m;if(l=+l,n=+n,a=+a,n===l&&a>0)return[n];if((s=l<n)&&(h=n,n=l,l=h),(m=gm(n,l,a))===0||!isFinite(m))return[];if(m>0)for(n=Math.ceil(n/m),l=Math.floor(l/m),v=new Array(h=Math.ceil(l-n+1));++o<h;)v[o]=(n+o)*m;else for(n=Math.floor(n*m),l=Math.ceil(l*m),v=new Array(h=Math.ceil(n-l+1));++o<h;)v[o]=(n-o)/m;return s&&v.reverse(),v}function gm(n,l,a){var s=(l-n)/Math.max(0,a),o=Math.floor(Math.log(s)/Math.LN10),h=s/Math.pow(10,o);return o>=0?(h>=Xx?10:h>=Yx?5:h>=$x?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(h>=Xx?10:h>=Yx?5:h>=$x?2:1)}function Xy(n,l,a){var s=Math.abs(l-n)/Math.max(0,a),o=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),h=s/o;return h>=Xx?o*=10:h>=Yx?o*=5:h>=$x&&(o*=2),l<n?-o:o}function Fk(){var n=identity,l=extent,a=sturges;function s(o){var h,v=o.length,m,E=new Array(v);for(h=0;h<v;++h)E[h]=n(o[h],h,o);var A=l(E),F=A[0],B=A[1],V=a(E,F,B);Array.isArray(V)||(V=tickStep(F,B,V),V=range(Math.ceil(F/V)*V,B,V));for(var j=V.length;V[0]<=F;)V.shift(),--j;for(;V[j-1]>B;)V.pop(),--j;var nt=new Array(j+1),at;for(h=0;h<=j;++h)at=nt[h]=[],at.x0=h>0?V[h-1]:F,at.x1=h<j?V[h]:B;for(h=0;h<v;++h)m=E[h],F<=m&&m<=B&&nt[bisect(V,m,0,j)].push(o[h]);return nt}return s.value=function(o){return arguments.length?(n=typeof o=="function"?o:constant(o),s):n},s.domain=function(o){return arguments.length?(l=typeof o=="function"?o:constant([o[0],o[1]]),s):l},s.thresholds=function(o){return arguments.length?(a=typeof o=="function"?o:Array.isArray(o)?constant(slice.call(o)):constant(o),s):a},s}function Rk(n,l,a){return n=map.call(n,number).sort(ascending),Math.ceil((a-l)/(2*(quantile(n,.75)-quantile(n,.25))*Math.pow(n.length,-1/3)))}function Dk(n){return n===null?NaN:+n}function Bk(n,l,a){if(a==null&&(a=Dk),!!(s=n.length)){if((l=+l)<=0||s<2)return+a(n[0],0,n);if(l>=1)return+a(n[s-1],s-1,n);var s,o=(s-1)*l,h=Math.floor(o),v=+a(n[h],h,n),m=+a(n[h+1],h+1,n);return v+(m-v)*(o-h)}}function Ww(n,l,a,s,o){var h=n*n,v=h*n;return((1-3*n+3*h-v)*l+(4-6*h+3*v)*a+(1+3*n+3*h-3*v)*s+v*o)/6}function Nk(n){var l=n.length-1;return function(a){var s=a<=0?a=0:a>=1?(a=1,l-1):Math.floor(a*l),o=n[s],h=n[s+1],v=s>0?n[s-1]:2*o-h,m=s<l-1?n[s+2]:2*h-o;return Ww((a-s/l)*l,v,o,h,m)}}function zk(n){var l=n.length;return function(a){var s=Math.floor(((a%=1)<0?++a:a)*l),o=n[(s+l-1)%l],h=n[s%l],v=n[(s+1)%l],m=n[(s+2)%l];return Ww((a-s/l)*l,o,h,v,m)}}function qx(n){return function(){return n}}function Xw(n,l){return function(a){return n+a*l}}function Uk(n,l,a){return n=Math.pow(n,a),l=Math.pow(l,a)-n,a=1/a,function(s){return Math.pow(n+s*l,a)}}function tF(n,l){var a=l-n;return a?Xw(n,a>180||a<-180?a-360*Math.round(a/360):a):constant(isNaN(n)?l:n)}function Zk(n){return(n=+n)==1?Yw:function(l,a){return a-l?Uk(l,a,n):qx(isNaN(l)?a:l)}}function Yw(n,l){var a=l-n;return a?Xw(n,a):qx(isNaN(n)?l:n)}var Vk=function n(l){var a=Zk(l);function s(o,h){var v=a((o=C(o)).r,(h=C(h)).r),m=a(o.g,h.g),E=a(o.b,h.b),A=Yw(o.opacity,h.opacity);return function(F){return o.r=v(F),o.g=m(F),o.b=E(F),o.opacity=A(F),o+""}}return s.gamma=n,s}(1);function $w(n){return function(l){var a=l.length,s=new Array(a),o=new Array(a),h=new Array(a),v,m;for(v=0;v<a;++v)m=C(l[v]),s[v]=m.r||0,o[v]=m.g||0,h[v]=m.b||0;return s=n(s),o=n(o),h=n(h),m.opacity=1,function(E){return m.r=s(E),m.g=o(E),m.b=h(E),m+""}}}var Gk=$w(Nk),Hk=$w(zk),Zh="$";function mm(){}mm.prototype=Kx.prototype={constructor:mm,has:function(n){return Zh+n in this},get:function(n){return this[Zh+n]},set:function(n,l){return this[Zh+n]=l,this},remove:function(n){var l=Zh+n;return l in this&&delete this[l]},clear:function(){for(var n in this)n[0]===Zh&&delete this[n]},keys:function(){var n=[];for(var l in this)l[0]===Zh&&n.push(l.slice(1));return n},values:function(){var n=[];for(var l in this)l[0]===Zh&&n.push(this[l]);return n},entries:function(){var n=[];for(var l in this)l[0]===Zh&&n.push({key:l.slice(1),value:this[l]});return n},size:function(){var n=0;for(var l in this)l[0]===Zh&&++n;return n},empty:function(){for(var n in this)if(n[0]===Zh)return!1;return!0},each:function(n){for(var l in this)l[0]===Zh&&n(this[l],l.slice(1),this)}};function Kx(n,l){var a=new mm;if(n instanceof mm)n.each(function(m,E){a.set(E,m)});else if(Array.isArray(n)){var s=-1,o=n.length,h;if(l==null)for(;++s<o;)a.set(s,n[s]);else for(;++s<o;)a.set(l(h=n[s],s,n),h)}else if(n)for(var v in n)a.set(v,n[v]);return a}var Qx=Kx;function Yy(){var n=[],l=[],a,s,o;function h(m,E,A,F){if(E>=n.length)return a!=null&&m.sort(a),s!=null?s(m):m;for(var B=-1,V=m.length,j=n[E++],nt,at,mt=map(),Bt,de=A();++B<V;)(Bt=mt.get(nt=j(at=m[B])+""))?Bt.push(at):mt.set(nt,[at]);return mt.each(function(ce,Be){F(de,Be,h(ce,E,A,F))}),de}function v(m,E){if(++E>n.length)return m;var A,F=l[E-1];return s!=null&&E>=n.length?A=m.entries():(A=[],m.each(function(B,V){A.push({key:V,values:v(B,E)})})),F!=null?A.sort(function(B,V){return F(B.key,V.key)}):A}return o={object:function(m){return h(m,0,jk,Wk)},map:function(m){return h(m,0,qw,Jx)},entries:function(m){return v(h(m,0,qw,Jx),0)},key:function(m){return n.push(m),o},sortKeys:function(m){return l[n.length-1]=m,o},sortValues:function(m){return a=m,o},rollup:function(m){return s=m,o}}}function jk(){return{}}function Wk(n,l,a){n[l]=a}function qw(){return map()}function Jx(n,l,a){n.set(l,a)}function $y(){}var ud=Qx.prototype;$y.prototype=Kw.prototype={constructor:$y,has:ud.has,add:function(n){return n+="",this[Zh+n]=n,this},remove:ud.remove,clear:ud.clear,values:ud.keys,size:ud.size,empty:ud.empty,each:ud.each};function Kw(n,l){var a=new $y;if(n instanceof $y)n.each(function(h){a.add(h)});else if(n){var s=-1,o=n.length;if(l==null)for(;++s<o;)a.add(n[s]);else for(;++s<o;)a.add(l(n[s],s,n))}return a}var Qw=null,Jw=Array.prototype,tC=Jw.map,Tp=Jw.slice;function tv(n,l){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(l).domain(n);break}return this}function tb(n,l){switch(arguments.length){case 0:break;case 1:this.interpolator(n);break;default:this.interpolator(l).domain(n);break}return this}var eb={name:"implicit"};function ym(){var n=Qx(),l=[],a=[],s=eb;function o(h){var v=h+"",m=n.get(v);if(!m){if(s!==eb)return s;n.set(v,m=l.push(h))}return a[(m-1)%a.length]}return o.domain=function(h){if(!arguments.length)return l.slice();l=[],n=Qx();for(var v=-1,m=h.length,E,A;++v<m;)n.has(A=(E=h[v])+"")||n.set(A,l.push(E));return o},o.range=function(h){return arguments.length?(a=Tp.call(h),o):a.slice()},o.unknown=function(h){return arguments.length?(s=h,o):s},o.copy=function(){return ym(l,a).unknown(s)},tv.apply(o,arguments),o}function _m(){var n=ordinal().unknown(void 0),l=n.domain,a=n.range,s=[0,1],o,h,v=!1,m=0,E=0,A=.5;delete n.unknown;function F(){var B=l().length,V=s[1]<s[0],j=s[V-0],nt=s[1-V];o=(nt-j)/Math.max(1,B-m+E*2),v&&(o=Math.floor(o)),j+=(nt-j-o*(B-m))*A,h=o*(1-m),v&&(j=Math.round(j),h=Math.round(h));var at=sequence(B).map(function(mt){return j+o*mt});return a(V?at.reverse():at)}return n.domain=function(B){return arguments.length?(l(B),F()):l()},n.range=function(B){return arguments.length?(s=[+B[0],+B[1]],F()):s.slice()},n.rangeRound=function(B){return s=[+B[0],+B[1]],v=!0,F()},n.bandwidth=function(){return h},n.step=function(){return o},n.round=function(B){return arguments.length?(v=!!B,F()):v},n.padding=function(B){return arguments.length?(m=Math.min(1,E=+B),F()):m},n.paddingInner=function(B){return arguments.length?(m=Math.min(1,B),F()):m},n.paddingOuter=function(B){return arguments.length?(E=+B,F()):E},n.align=function(B){return arguments.length?(A=Math.max(0,Math.min(1,B)),F()):A},n.copy=function(){return _m(l(),s).round(v).paddingInner(m).paddingOuter(E).align(A)},initRange.apply(F(),arguments)}function rb(n){var l=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,delete n.paddingOuter,n.copy=function(){return rb(l())},n}function eF(){return rb(_m.apply(null,arguments).paddingInner(1))}function rF(n,l){return(isNumberArray(l)?numberArray:xm)(n,l)}function xm(n,l){var a=l?l.length:0,s=n?Math.min(a,n.length):0,o=new Array(s),h=new Array(a),v;for(v=0;v<s;++v)o[v]=ib(n[v],l[v]);for(;v<a;++v)h[v]=l[v];return function(m){for(v=0;v<s;++v)h[v]=o[v](m);return h}}function P0(n,l){var a=new Date;return n=+n,l=+l,function(s){return a.setTime(n*(1-s)+l*s),a}}function ev(n,l){return n=+n,l=+l,function(a){return n*(1-a)+l*a}}function Xk(n,l){var a={},s={},o;(n===null||typeof n!="object")&&(n={}),(l===null||typeof l!="object")&&(l={});for(o in l)o in n?a[o]=ib(n[o],l[o]):s[o]=l[o];return function(h){for(o in a)s[o]=a[o](h);return s}}var qy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ky=new RegExp(qy.source,"g");function nb(n){return function(){return n}}function eC(n){return function(l){return n(l)+""}}function Yk(n,l){var a=qy.lastIndex=Ky.lastIndex=0,s,o,h,v=-1,m=[],E=[];for(n=n+"",l=l+"";(s=qy.exec(n))&&(o=Ky.exec(l));)(h=o.index)>a&&(h=l.slice(a,h),m[v]?m[v]+=h:m[++v]=h),(s=s[0])===(o=o[0])?m[v]?m[v]+=o:m[++v]=o:(m[++v]=null,E.push({i:v,x:ev(s,o)})),a=Ky.lastIndex;return a<l.length&&(h=l.slice(a),m[v]?m[v]+=h:m[++v]=h),m.length<2?E[0]?eC(E[0].x):nb(l):(l=E.length,function(A){for(var F=0,B;F<l;++F)m[(B=E[F]).i]=B.x(A);return m.join("")})}function $k(n,l){l||(l=[]);var a=n?Math.min(l.length,n.length):0,s=l.slice(),o;return function(h){for(o=0;o<a;++o)s[o]=n[o]*(1-h)+l[o]*h;return s}}function qk(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function ib(n,l){var a=typeof l,s;return l==null||a==="boolean"?qx(l):(a==="number"?ev:a==="string"?(s=pc(l))?(l=s,Vk):Yk:l instanceof pc?Vk:l instanceof Date?P0:qk(l)?$k:Array.isArray(l)?xm:typeof l.valueOf!="function"&&typeof l.toString!="function"||isNaN(l)?Xk:ev)(n,l)}function Kk(n,l){return n=+n,l=+l,function(a){return Math.round(n*(1-a)+l*a)}}function rC(n){return function(){return n}}function Qk(n){return+n}var nC=[0,1];function Nc(n){return n}function ab(n,l){return(l-=n=+n)?function(a){return(a-n)/l}:rC(isNaN(l)?NaN:.5)}function iC(n){var l=n[0],a=n[n.length-1],s;return l>a&&(s=l,l=a,a=s),function(o){return Math.max(l,Math.min(a,o))}}function Jk(n,l,a){var s=n[0],o=n[1],h=l[0],v=l[1];return o<s?(s=ab(o,s),h=a(v,h)):(s=ab(s,o),h=a(h,v)),function(m){return h(s(m))}}function t4(n,l,a){var s=Math.min(n.length,l.length)-1,o=new Array(s),h=new Array(s),v=-1;for(n[s]<n[0]&&(n=n.slice().reverse(),l=l.slice().reverse());++v<s;)o[v]=ab(n[v],n[v+1]),h[v]=a(l[v],l[v+1]);return function(m){var E=Wy(n,m,1,s)-1;return h[E](o[E](m))}}function Qy(n,l){return l.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function ob(){var n=nC,l=nC,a=ib,s,o,h,v=Nc,m,E,A;function F(){return m=Math.min(n.length,l.length)>2?t4:Jk,E=A=null,B}function B(V){return isNaN(V=+V)?h:(E||(E=m(n.map(s),l,a)))(s(v(V)))}return B.invert=function(V){return v(o((A||(A=m(l,n.map(s),ev)))(V)))},B.domain=function(V){return arguments.length?(n=tC.call(V,Qk),v===Nc||(v=iC(n)),F()):n.slice()},B.range=function(V){return arguments.length?(l=Tp.call(V),F()):l.slice()},B.rangeRound=function(V){return l=Tp.call(V),a=Kk,F()},B.clamp=function(V){return arguments.length?(v=V?iC(n):Nc,B):v!==Nc},B.interpolate=function(V){return arguments.length?(a=V,F()):a},B.unknown=function(V){return arguments.length?(h=V,B):h},function(V,j){return s=V,o=j,F()}}function aC(n,l){return ob()(n,l)}var e4=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Jy(n){if(!(l=e4.exec(n)))throw new Error("invalid format: "+n);var l;return new sb({fill:l[1],align:l[2],sign:l[3],symbol:l[4],zero:l[5],width:l[6],comma:l[7],precision:l[8]&&l[8].slice(1),trim:l[9],type:l[10]})}Jy.prototype=sb.prototype;function sb(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}sb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function oC(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function t_(n,l){if((a=(n=l?n.toExponential(l-1):n.toExponential()).indexOf("e"))<0)return null;var a,s=n.slice(0,a);return[s.length>1?s[0]+s.slice(2):s,+n.slice(a+1)]}function O0(n){return n=t_(Math.abs(n)),n?n[1]:NaN}function Tg(n,l){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(O0(l)/3)))*3-O0(Math.abs(n)))}function r4(n,l){return function(a,s){for(var o=a.length,h=[],v=0,m=n[0],E=0;o>0&&m>0&&(E+m+1>s&&(m=Math.max(1,s-E)),h.push(a.substring(o-=m,o+m)),!((E+=m+1)>s));)m=n[v=(v+1)%n.length];return h.reverse().join(l)}}function n4(n){return function(l){return l.replace(/[0-9]/g,function(a){return n[+a]})}}function i4(n){t:for(var l=n.length,a=1,s=-1,o;a<l;++a)switch(n[a]){case".":s=o=a;break;case"0":s===0&&(s=a),o=a;break;default:if(!+n[a])break t;s>0&&(s=0);break}return s>0?n.slice(0,s)+n.slice(o+1):n}var sC;function uC(n,l){var a=t_(n,l);if(!a)return n+"";var s=a[0],o=a[1],h=o-(sC=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,v=s.length;return h===v?s:h>v?s+new Array(h-v+1).join("0"):h>0?s.slice(0,h)+"."+s.slice(h):"0."+new Array(1-h).join("0")+t_(n,Math.max(0,l+h-1))[0]}function F0(n,l){var a=t_(n,l);if(!a)return n+"";var s=a[0],o=a[1];return o<0?"0."+new Array(-o).join("0")+s:s.length>o+1?s.slice(0,o+1)+"."+s.slice(o+1):s+new Array(o-s.length+2).join("0")}var ub={"%":function(n,l){return(n*100).toFixed(l)},b:function(n){return Math.round(n).toString(2)},c:function(n){return n+""},d:oC,e:function(n,l){return n.toExponential(l)},f:function(n,l){return n.toFixed(l)},g:function(n,l){return n.toPrecision(l)},o:function(n){return Math.round(n).toString(8)},p:function(n,l){return F0(n*100,l)},r:F0,s:uC,X:function(n){return Math.round(n).toString(16).toUpperCase()},x:function(n){return Math.round(n).toString(16)}};function lb(n){return n}var e_=Array.prototype.map,r_=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function cb(n){var l=n.grouping===void 0||n.thousands===void 0?lb:r4(e_.call(n.grouping,Number),n.thousands+""),a=n.currency===void 0?"":n.currency[0]+"",s=n.currency===void 0?"":n.currency[1]+"",o=n.decimal===void 0?".":n.decimal+"",h=n.numerals===void 0?lb:n4(e_.call(n.numerals,String)),v=n.percent===void 0?"%":n.percent+"",m=n.minus===void 0?"-":n.minus+"",E=n.nan===void 0?"NaN":n.nan+"";function A(B){B=Jy(B);var V=B.fill,j=B.align,nt=B.sign,at=B.symbol,mt=B.zero,Bt=B.width,de=B.comma,ce=B.precision,Be=B.trim,Xe=B.type;Xe==="n"?(de=!0,Xe="g"):ub[Xe]||(ce===void 0&&(ce=12),Be=!0,Xe="g"),(mt||V==="0"&&j==="=")&&(mt=!0,V="0",j="=");var _r=at==="$"?a:at==="#"&&/[boxX]/.test(Xe)?"0"+Xe.toLowerCase():"",Ir=at==="$"?s:/[%p]/.test(Xe)?v:"",Nr=ub[Xe],Yr=/[defgprs%]/.test(Xe);ce=ce===void 0?6:/[gprs]/.test(Xe)?Math.max(1,Math.min(21,ce)):Math.max(0,Math.min(20,ce));function yn(fn){var $n=_r,di=Ir,Yi,ho,zo;if(Xe==="c")di=Nr(fn)+di,fn="";else{fn=+fn;var Vs=fn<0||1/fn<0;if(fn=isNaN(fn)?E:Nr(Math.abs(fn),ce),Be&&(fn=i4(fn)),Vs&&+fn==0&&nt!=="+"&&(Vs=!1),$n=(Vs?nt==="("?nt:m:nt==="-"||nt==="("?"":nt)+$n,di=(Xe==="s"?r_[8+sC/3]:"")+di+(Vs&&nt==="("?")":""),Yr){for(Yi=-1,ho=fn.length;++Yi<ho;)if(zo=fn.charCodeAt(Yi),48>zo||zo>57){di=(zo===46?o+fn.slice(Yi+1):fn.slice(Yi))+di,fn=fn.slice(0,Yi);break}}}de&&!mt&&(fn=l(fn,1/0));var hu=$n.length+fn.length+di.length,Gu=hu<Bt?new Array(Bt-hu+1).join(V):"";switch(de&&mt&&(fn=l(Gu+fn,Gu.length?Bt-di.length:1/0),Gu=""),j){case"<":fn=$n+fn+di+Gu;break;case"=":fn=$n+Gu+fn+di;break;case"^":fn=Gu.slice(0,hu=Gu.length>>1)+$n+fn+di+Gu.slice(hu);break;default:fn=Gu+$n+fn+di;break}return h(fn)}return yn.toString=function(){return B+""},yn}function F(B,V){var j=A((B=Jy(B),B.type="f",B)),nt=Math.max(-8,Math.min(8,Math.floor(O0(V)/3)))*3,at=Math.pow(10,-nt),mt=r_[8+nt/3];return function(Bt){return j(at*Bt)+mt}}return{format:A,formatPrefix:F}}var Mg,fb,lC;cC({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function cC(n){return Mg=cb(n),fb=Mg.format,lC=Mg.formatPrefix,Mg}function fC(n,l){return n=Math.abs(n),l=Math.abs(l)-n,Math.max(0,O0(l)-O0(n))+1}function a4(n){return Math.max(0,-O0(Math.abs(n)))}function o4(n,l,a,s){var o=Xy(n,l,a),h;switch(s=Jy(s==null?",f":s),s.type){case"s":{var v=Math.max(Math.abs(n),Math.abs(l));return s.precision==null&&!isNaN(h=Tg(o,v))&&(s.precision=h),lC(s,v)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(h=fC(o,Math.max(Math.abs(n),Math.abs(l))))&&(s.precision=h-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(h=a4(o))&&(s.precision=h-(s.type==="%")*2);break}}return fb(s)}function bm(n){var l=n.domain;return n.ticks=function(a){var s=l();return jw(s[0],s[s.length-1],a==null?10:a)},n.tickFormat=function(a,s){var o=l();return o4(o[0],o[o.length-1],a==null?10:a,s)},n.nice=function(a){a==null&&(a=10);var s=l(),o=0,h=s.length-1,v=s[o],m=s[h],E;return m<v&&(E=v,v=m,m=E,E=o,o=h,h=E),E=gm(v,m,a),E>0?(v=Math.floor(v/E)*E,m=Math.ceil(m/E)*E,E=gm(v,m,a)):E<0&&(v=Math.ceil(v*E)/E,m=Math.floor(m*E)/E,E=gm(v,m,a)),E>0?(s[o]=Math.floor(v/E)*E,s[h]=Math.ceil(m/E)*E,l(s)):E<0&&(s[o]=Math.ceil(v*E)/E,s[h]=Math.floor(m*E)/E,l(s)),n},n}function hC(){var n=aC(Nc,Nc);return n.copy=function(){return Qy(n,hC())},tv.apply(n,arguments),bm(n)}function s4(n){var l;function a(s){return isNaN(s=+s)?l:s}return a.invert=a,a.domain=a.range=function(s){return arguments.length?(n=map.call(s,number),a):n.slice()},a.unknown=function(s){return arguments.length?(l=s,a):l},a.copy=function(){return s4(n).unknown(l)},n=arguments.length?map.call(n,number):[0,1],linearish(a)}function pC(n,l){n=n.slice();var a=0,s=n.length-1,o=n[a],h=n[s],v;return h<o&&(v=a,a=s,s=v,v=o,o=h,h=v),n[a]=l.floor(o),n[s]=l.ceil(h),n}function dC(n){return Math.log(n)}function vC(n){return Math.exp(n)}function u4(n){return-Math.log(-n)}function gC(n){return-Math.exp(-n)}function mC(n){return isFinite(n)?+("1e"+n):n<0?0:n}function nF(n){return n===10?mC:n===Math.E?Math.exp:function(l){return Math.pow(n,l)}}function lh(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),function(l){return Math.log(l)/n})}function Nf(n){return function(l){return-n(-l)}}function yC(n){var l=n(dC,vC),a=l.domain,s=10,o,h;function v(){return o=lh(s),h=nF(s),a()[0]<0?(o=Nf(o),h=Nf(h),n(u4,gC)):n(dC,vC),l}return l.base=function(m){return arguments.length?(s=+m,v()):s},l.domain=function(m){return arguments.length?(a(m),v()):a()},l.ticks=function(m){var E=a(),A=E[0],F=E[E.length-1],B;(B=F<A)&&(V=A,A=F,F=V);var V=o(A),j=o(F),nt,at,mt,Bt=m==null?10:+m,de=[];if(!(s%1)&&j-V<Bt){if(V=Math.round(V)-1,j=Math.round(j)+1,A>0){for(;V<j;++V)for(at=1,nt=h(V);at<s;++at)if(mt=nt*at,!(mt<A)){if(mt>F)break;de.push(mt)}}else for(;V<j;++V)for(at=s-1,nt=h(V);at>=1;--at)if(mt=nt*at,!(mt<A)){if(mt>F)break;de.push(mt)}}else de=jw(V,j,Math.min(j-V,Bt)).map(h);return B?de.reverse():de},l.tickFormat=function(m,E){if(E==null&&(E=s===10?".0e":","),typeof E!="function"&&(E=fb(E)),m===1/0)return E;m==null&&(m=10);var A=Math.max(1,s*m/l.ticks().length);return function(F){var B=F/h(Math.round(o(F)));return B*s<s-.5&&(B*=s),B<=A?E(F):""}},l.nice=function(){return a(pC(a(),{floor:function(m){return h(Math.floor(o(m)))},ceil:function(m){return h(Math.ceil(o(m)))}}))},l}function _C(){var n=yC(ob()).domain([1,10]);return n.copy=function(){return Qy(n,_C()).base(n.base())},tv.apply(n,arguments),n}function xC(n){return function(l){return Math.sign(l)*Math.log1p(Math.abs(l/n))}}function R0(n){return function(l){return Math.sign(l)*Math.expm1(Math.abs(l))*n}}function D0(n){var l=1,a=n(xC(l),R0(l));return a.constant=function(s){return arguments.length?n(xC(l=+s),R0(l)):l},linearish(a)}function hb(){var n=D0(transformer());return n.copy=function(){return copy(n,hb()).constant(n.constant())},initRange.apply(n,arguments)}function n_(n){return function(l){return l<0?-Math.pow(-l,n):Math.pow(l,n)}}function bC(n){return n<0?-Math.sqrt(-n):Math.sqrt(n)}function EC(n){return n<0?-n*n:n*n}function SC(n){var l=n(Nc,Nc),a=1;function s(){return a===1?n(Nc,Nc):a===.5?n(bC,EC):n(n_(a),n_(1/a))}return l.exponent=function(o){return arguments.length?(a=+o,s()):a},bm(l)}function pb(){var n=SC(ob());return n.copy=function(){return Qy(n,pb()).exponent(n.exponent())},tv.apply(n,arguments),n}function l4(){return pb.apply(null,arguments).exponent(.5)}function db(){var n=[],l=[],a=[],s;function o(){var v=0,m=Math.max(1,l.length);for(a=new Array(m-1);++v<m;)a[v-1]=Bk(n,v/m);return h}function h(v){return isNaN(v=+v)?s:l[Wy(a,v)]}return h.invertExtent=function(v){var m=l.indexOf(v);return m<0?[NaN,NaN]:[m>0?a[m-1]:n[0],m<a.length?a[m]:n[n.length-1]]},h.domain=function(v){if(!arguments.length)return n.slice();n=[];for(var m=0,E=v.length,A;m<E;++m)A=v[m],A!=null&&!isNaN(A=+A)&&n.push(A);return n.sort(jx),o()},h.range=function(v){return arguments.length?(l=Tp.call(v),o()):l.slice()},h.unknown=function(v){return arguments.length?(s=v,h):s},h.quantiles=function(){return a.slice()},h.copy=function(){return db().domain(n).range(l).unknown(s)},tv.apply(h,arguments)}function wC(){var n=0,l=1,a=1,s=[.5],o=[0,1],h;function v(E){return E<=E?o[Wy(s,E,0,a)]:h}function m(){var E=-1;for(s=new Array(a);++E<a;)s[E]=((E+1)*l-(E-a)*n)/(a+1);return v}return v.domain=function(E){return arguments.length?(n=+E[0],l=+E[1],m()):[n,l]},v.range=function(E){return arguments.length?(a=(o=Tp.call(E)).length-1,m()):o.slice()},v.invertExtent=function(E){var A=o.indexOf(E);return A<0?[NaN,NaN]:A<1?[n,s[0]]:A>=a?[s[a-1],l]:[s[A-1],s[A]]},v.unknown=function(E){return arguments.length&&(h=E),v},v.thresholds=function(){return s.slice()},v.copy=function(){return wC().domain([n,l]).range(o).unknown(h)},tv.apply(bm(v),arguments)}function CC(){var n=[.5],l=[0,1],a,s=1;function o(h){return h<=h?l[Wy(n,h,0,s)]:a}return o.domain=function(h){return arguments.length?(n=Tp.call(h),s=Math.min(n.length,l.length-1),o):n.slice()},o.range=function(h){return arguments.length?(l=Tp.call(h),s=Math.min(n.length,l.length-1),o):l.slice()},o.invertExtent=function(h){var v=l.indexOf(h);return[n[v-1],n[v]]},o.unknown=function(h){return arguments.length?(a=h,o):a},o.copy=function(){return CC().domain(n).range(l).unknown(a)},tv.apply(o,arguments)}var vb=new Date,gb=new Date;function gf(n,l,a,s){function o(h){return n(h=arguments.length===0?new Date:new Date(+h)),h}return o.floor=function(h){return n(h=new Date(+h)),h},o.ceil=function(h){return n(h=new Date(h-1)),l(h,1),n(h),h},o.round=function(h){var v=o(h),m=o.ceil(h);return h-v<m-h?v:m},o.offset=function(h,v){return l(h=new Date(+h),v==null?1:Math.floor(v)),h},o.range=function(h,v,m){var E=[],A;if(h=o.ceil(h),m=m==null?1:Math.floor(m),!(h<v)||!(m>0))return E;do E.push(A=new Date(+h)),l(h,m),n(h);while(A<h&&h<v);return E},o.filter=function(h){return gf(function(v){if(v>=v)for(;n(v),!h(v);)v.setTime(v-1)},function(v,m){if(v>=v)if(m<0)for(;++m<=0;)for(;l(v,-1),!h(v););else for(;--m>=0;)for(;l(v,1),!h(v););})},a&&(o.count=function(h,v){return vb.setTime(+h),gb.setTime(+v),n(vb),n(gb),Math.floor(a(vb,gb))},o.every=function(h){return h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?o.filter(s?function(v){return s(v)%h===0}:function(v){return o.count(0,v)%h===0}):o}),o}var mb=gf(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,l){n.setFullYear(n.getFullYear()+l)},function(n,l){return l.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});mb.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:gf(function(l){l.setFullYear(Math.floor(l.getFullYear()/n)*n),l.setMonth(0,1),l.setHours(0,0,0,0)},function(l,a){l.setFullYear(l.getFullYear()+a*n)})};var Ig=mb,iF=mb.range,AC=gf(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,l){n.setMonth(n.getMonth()+l)},function(n,l){return l.getMonth()-n.getMonth()+(l.getFullYear()-n.getFullYear())*12},function(n){return n.getMonth()}),c4=AC,aF=AC.range,i_=1e3,Em=6e4,TC=36e5,MC=864e5,f4=6048e5;function B0(n){return gf(function(l){l.setDate(l.getDate()-(l.getDay()+7-n)%7),l.setHours(0,0,0,0)},function(l,a){l.setDate(l.getDate()+a*7)},function(l,a){return(a-l-(a.getTimezoneOffset()-l.getTimezoneOffset())*Em)/f4})}var yb=B0(0),a_=B0(1),h4=B0(2),p4=B0(3),Sm=B0(4),d4=B0(5),v4=B0(6),oF=yb.range,sF=a_.range,uF=h4.range,lF=p4.range,cF=Sm.range,fF=d4.range,RR=v4.range,IC=gf(function(n){n.setHours(0,0,0,0)},function(n,l){n.setDate(n.getDate()+l)},function(n,l){return(l-n-(l.getTimezoneOffset()-n.getTimezoneOffset())*Em)/MC},function(n){return n.getDate()-1}),o_=IC,hF=IC.range,_b=gf(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*i_-n.getMinutes()*Em)},function(n,l){n.setTime(+n+l*TC)},function(n,l){return(l-n)/TC},function(n){return n.getHours()}),g4=_b,pF=_b.range,xb=gf(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*i_)},function(n,l){n.setTime(+n+l*Em)},function(n,l){return(l-n)/Em},function(n){return n.getMinutes()}),kC=xb,dF=xb.range,LC=gf(function(n){n.setTime(n-n.getMilliseconds())},function(n,l){n.setTime(+n+l*i_)},function(n,l){return(l-n)/i_},function(n){return n.getUTCSeconds()}),m4=LC,vF=LC.range,s_=gf(function(){},function(n,l){n.setTime(+n+l)},function(n,l){return l-n});s_.every=function(n){return n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?gf(function(l){l.setTime(Math.floor(l/n)*n)},function(l,a){l.setTime(+l+a*n)},function(l,a){return(a-l)/n}):s_};var y4=s_,gF=s_.range;function N0(n){return gf(function(l){l.setUTCDate(l.getUTCDate()-(l.getUTCDay()+7-n)%7),l.setUTCHours(0,0,0,0)},function(l,a){l.setUTCDate(l.getUTCDate()+a*7)},function(l,a){return(a-l)/f4})}var PC=N0(0),u_=N0(1),OC=N0(2),mF=N0(3),kg=N0(4),_4=N0(5),x4=N0(6),yF=PC.range,_F=u_.range,xF=OC.range,bF=mF.range,EF=kg.range,DR=_4.range,SF=x4.range,FC=gf(function(n){n.setUTCHours(0,0,0,0)},function(n,l){n.setUTCDate(n.getUTCDate()+l)},function(n,l){return(l-n)/MC},function(n){return n.getUTCDate()-1}),RC=FC,b4=FC.range,bb=gf(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,l){n.setUTCFullYear(n.getUTCFullYear()+l)},function(n,l){return l.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});bb.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:gf(function(l){l.setUTCFullYear(Math.floor(l.getUTCFullYear()/n)*n),l.setUTCMonth(0,1),l.setUTCHours(0,0,0,0)},function(l,a){l.setUTCFullYear(l.getUTCFullYear()+a*n)})};var wm=bb,wF=bb.range;function Eb(n){if(0<=n.y&&n.y<100){var l=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return l.setFullYear(n.y),l}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function Sb(n){if(0<=n.y&&n.y<100){var l=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return l.setUTCFullYear(n.y),l}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function l_(n,l,a){return{y:n,m:l,d:a,H:0,M:0,S:0,L:0}}function E4(n){var l=n.dateTime,a=n.date,s=n.time,o=n.periods,h=n.days,v=n.shortDays,m=n.months,E=n.shortMonths,A=Cm(o),F=c_(o),B=Cm(h),V=c_(h),j=Cm(v),nt=c_(v),at=Cm(m),mt=c_(m),Bt=Cm(E),de=c_(E),ce={a:Vs,A:hu,b:Gu,B:Wh,c:null,d:v_,e:v_,f:WC,g:Z4,G:G4,H:k4,I:L4,j:P4,L:Tb,m:O4,M:F4,p:s2,q:X_,Q:JC,s:tA,S:R4,u:D4,U:B4,V:N4,w:z4,W:U4,x:null,X:null,y:YC,Y:V4,Z:H4,"%":QC},Be={a:u2,A:cT,b:uO,B:fT,c:null,d:$C,e:$C,f:qC,g:J4,G:eL,H:j4,I:W4,j:CF,L:g_,m:Am,M:X4,p:k8,q:L8,Q:JC,s:tA,S:Y4,u:KC,U:Tm,V:$4,w:q4,W:K4,x:null,X:null,y:Q4,Y:tL,Z:rL,"%":QC},Xe={a:yn,A:fn,b:$n,B:di,c:Yi,d:VC,e:VC,f:I4,g:ZC,G:UC,H:GC,I:GC,j:wb,L:Ab,m:M4,M:p_,p:Yr,q:T4,Q:jC,s:d_,S:Cb,u:NC,U:zC,V:f_,w:BC,W:h_,x:ho,X:zo,y:ZC,Y:UC,Z:A4,"%":HC};ce.x=_r(a,ce),ce.X=_r(s,ce),ce.c=_r(l,ce),Be.x=_r(a,Be),Be.X=_r(s,Be),Be.c=_r(l,Be);function _r(Za,ps){return function(Gs){var Hi=[],Xh=-1,Hu=0,kp=Za.length,Lp,Vm,OR;for(Gs instanceof Date||(Gs=new Date(+Gs));++Xh<kp;)Za.charCodeAt(Xh)===37&&(Hi.push(Za.slice(Hu,Xh)),(Vm=DC[Lp=Za.charAt(++Xh)])!=null?Lp=Za.charAt(++Xh):Vm=Lp==="e"?" ":"0",(OR=ps[Lp])&&(Lp=OR(Gs,Vm)),Hi.push(Lp),Hu=Xh+1);return Hi.push(Za.slice(Hu,Xh)),Hi.join("")}}function Ir(Za,ps){return function(Gs){var Hi=l_(1900,void 0,1),Xh=Nr(Hi,Za,Gs+="",0),Hu,kp;if(Xh!=Gs.length)return null;if("Q"in Hi)return new Date(Hi.Q);if("s"in Hi)return new Date(Hi.s*1e3+("L"in Hi?Hi.L:0));if(ps&&!("Z"in Hi)&&(Hi.Z=0),"p"in Hi&&(Hi.H=Hi.H%12+Hi.p*12),Hi.m===void 0&&(Hi.m="q"in Hi?Hi.q:0),"V"in Hi){if(Hi.V<1||Hi.V>53)return null;"w"in Hi||(Hi.w=1),"Z"in Hi?(Hu=Sb(l_(Hi.y,0,1)),kp=Hu.getUTCDay(),Hu=kp>4||kp===0?u_.ceil(Hu):u_(Hu),Hu=RC.offset(Hu,(Hi.V-1)*7),Hi.y=Hu.getUTCFullYear(),Hi.m=Hu.getUTCMonth(),Hi.d=Hu.getUTCDate()+(Hi.w+6)%7):(Hu=Eb(l_(Hi.y,0,1)),kp=Hu.getDay(),Hu=kp>4||kp===0?a_.ceil(Hu):a_(Hu),Hu=o_.offset(Hu,(Hi.V-1)*7),Hi.y=Hu.getFullYear(),Hi.m=Hu.getMonth(),Hi.d=Hu.getDate()+(Hi.w+6)%7)}else("W"in Hi||"U"in Hi)&&("w"in Hi||(Hi.w="u"in Hi?Hi.u%7:"W"in Hi?1:0),kp="Z"in Hi?Sb(l_(Hi.y,0,1)).getUTCDay():Eb(l_(Hi.y,0,1)).getDay(),Hi.m=0,Hi.d="W"in Hi?(Hi.w+6)%7+Hi.W*7-(kp+5)%7:Hi.w+Hi.U*7-(kp+6)%7);return"Z"in Hi?(Hi.H+=Hi.Z/100|0,Hi.M+=Hi.Z%100,Sb(Hi)):Eb(Hi)}}function Nr(Za,ps,Gs,Hi){for(var Xh=0,Hu=ps.length,kp=Gs.length,Lp,Vm;Xh<Hu;){if(Hi>=kp)return-1;if(Lp=ps.charCodeAt(Xh++),Lp===37){if(Lp=ps.charAt(Xh++),Vm=Xe[Lp in DC?ps.charAt(Xh++):Lp],!Vm||(Hi=Vm(Za,Gs,Hi))<0)return-1}else if(Lp!=Gs.charCodeAt(Hi++))return-1}return Hi}function Yr(Za,ps,Gs){var Hi=A.exec(ps.slice(Gs));return Hi?(Za.p=F[Hi[0].toLowerCase()],Gs+Hi[0].length):-1}function yn(Za,ps,Gs){var Hi=j.exec(ps.slice(Gs));return Hi?(Za.w=nt[Hi[0].toLowerCase()],Gs+Hi[0].length):-1}function fn(Za,ps,Gs){var Hi=B.exec(ps.slice(Gs));return Hi?(Za.w=V[Hi[0].toLowerCase()],Gs+Hi[0].length):-1}function $n(Za,ps,Gs){var Hi=Bt.exec(ps.slice(Gs));return Hi?(Za.m=de[Hi[0].toLowerCase()],Gs+Hi[0].length):-1}function di(Za,ps,Gs){var Hi=at.exec(ps.slice(Gs));return Hi?(Za.m=mt[Hi[0].toLowerCase()],Gs+Hi[0].length):-1}function Yi(Za,ps,Gs){return Nr(Za,l,ps,Gs)}function ho(Za,ps,Gs){return Nr(Za,a,ps,Gs)}function zo(Za,ps,Gs){return Nr(Za,s,ps,Gs)}function Vs(Za){return v[Za.getDay()]}function hu(Za){return h[Za.getDay()]}function Gu(Za){return E[Za.getMonth()]}function Wh(Za){return m[Za.getMonth()]}function s2(Za){return o[+(Za.getHours()>=12)]}function X_(Za){return 1+~~(Za.getMonth()/3)}function u2(Za){return v[Za.getUTCDay()]}function cT(Za){return h[Za.getUTCDay()]}function uO(Za){return E[Za.getUTCMonth()]}function fT(Za){return m[Za.getUTCMonth()]}function k8(Za){return o[+(Za.getUTCHours()>=12)]}function L8(Za){return 1+~~(Za.getUTCMonth()/3)}return{format:function(Za){var ps=_r(Za+="",ce);return ps.toString=function(){return Za},ps},parse:function(Za){var ps=Ir(Za+="",!1);return ps.toString=function(){return Za},ps},utcFormat:function(Za){var ps=_r(Za+="",Be);return ps.toString=function(){return Za},ps},utcParse:function(Za){var ps=Ir(Za+="",!0);return ps.toString=function(){return Za},ps}}}var DC={"-":"",_:" ",0:"0"},oc=/^\s*\d+/,S4=/^%/,w4=/[\\^$*+?|[\]().{}]/g;function Cs(n,l,a){var s=n<0?"-":"",o=(s?-n:n)+"",h=o.length;return s+(h<a?new Array(a-h+1).join(l)+o:o)}function C4(n){return n.replace(w4,"\\$&")}function Cm(n){return new RegExp("^(?:"+n.map(C4).join("|")+")","i")}function c_(n){for(var l={},a=-1,s=n.length;++a<s;)l[n[a].toLowerCase()]=a;return l}function BC(n,l,a){var s=oc.exec(l.slice(a,a+1));return s?(n.w=+s[0],a+s[0].length):-1}function NC(n,l,a){var s=oc.exec(l.slice(a,a+1));return s?(n.u=+s[0],a+s[0].length):-1}function zC(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.U=+s[0],a+s[0].length):-1}function f_(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.V=+s[0],a+s[0].length):-1}function h_(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.W=+s[0],a+s[0].length):-1}function UC(n,l,a){var s=oc.exec(l.slice(a,a+4));return s?(n.y=+s[0],a+s[0].length):-1}function ZC(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.y=+s[0]+(+s[0]>68?1900:2e3),a+s[0].length):-1}function A4(n,l,a){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(l.slice(a,a+6));return s?(n.Z=s[1]?0:-(s[2]+(s[3]||"00")),a+s[0].length):-1}function T4(n,l,a){var s=oc.exec(l.slice(a,a+1));return s?(n.q=s[0]*3-3,a+s[0].length):-1}function M4(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.m=s[0]-1,a+s[0].length):-1}function VC(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.d=+s[0],a+s[0].length):-1}function wb(n,l,a){var s=oc.exec(l.slice(a,a+3));return s?(n.m=0,n.d=+s[0],a+s[0].length):-1}function GC(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.H=+s[0],a+s[0].length):-1}function p_(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.M=+s[0],a+s[0].length):-1}function Cb(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.S=+s[0],a+s[0].length):-1}function Ab(n,l,a){var s=oc.exec(l.slice(a,a+3));return s?(n.L=+s[0],a+s[0].length):-1}function I4(n,l,a){var s=oc.exec(l.slice(a,a+6));return s?(n.L=Math.floor(s[0]/1e3),a+s[0].length):-1}function HC(n,l,a){var s=S4.exec(l.slice(a,a+1));return s?a+s[0].length:-1}function jC(n,l,a){var s=oc.exec(l.slice(a));return s?(n.Q=+s[0],a+s[0].length):-1}function d_(n,l,a){var s=oc.exec(l.slice(a));return s?(n.s=+s[0],a+s[0].length):-1}function v_(n,l){return Cs(n.getDate(),l,2)}function k4(n,l){return Cs(n.getHours(),l,2)}function L4(n,l){return Cs(n.getHours()%12||12,l,2)}function P4(n,l){return Cs(1+o_.count(Ig(n),n),l,3)}function Tb(n,l){return Cs(n.getMilliseconds(),l,3)}function WC(n,l){return Tb(n,l)+"000"}function O4(n,l){return Cs(n.getMonth()+1,l,2)}function F4(n,l){return Cs(n.getMinutes(),l,2)}function R4(n,l){return Cs(n.getSeconds(),l,2)}function D4(n){var l=n.getDay();return l===0?7:l}function B4(n,l){return Cs(yb.count(Ig(n)-1,n),l,2)}function XC(n){var l=n.getDay();return l>=4||l===0?Sm(n):Sm.ceil(n)}function N4(n,l){return n=XC(n),Cs(Sm.count(Ig(n),n)+(Ig(n).getDay()===4),l,2)}function z4(n){return n.getDay()}function U4(n,l){return Cs(a_.count(Ig(n)-1,n),l,2)}function YC(n,l){return Cs(n.getFullYear()%100,l,2)}function Z4(n,l){return n=XC(n),Cs(n.getFullYear()%100,l,2)}function V4(n,l){return Cs(n.getFullYear()%1e4,l,4)}function G4(n,l){var a=n.getDay();return n=a>=4||a===0?Sm(n):Sm.ceil(n),Cs(n.getFullYear()%1e4,l,4)}function H4(n){var l=n.getTimezoneOffset();return(l>0?"-":(l*=-1,"+"))+Cs(l/60|0,"0",2)+Cs(l%60,"0",2)}function $C(n,l){return Cs(n.getUTCDate(),l,2)}function j4(n,l){return Cs(n.getUTCHours(),l,2)}function W4(n,l){return Cs(n.getUTCHours()%12||12,l,2)}function CF(n,l){return Cs(1+RC.count(wm(n),n),l,3)}function g_(n,l){return Cs(n.getUTCMilliseconds(),l,3)}function qC(n,l){return g_(n,l)+"000"}function Am(n,l){return Cs(n.getUTCMonth()+1,l,2)}function X4(n,l){return Cs(n.getUTCMinutes(),l,2)}function Y4(n,l){return Cs(n.getUTCSeconds(),l,2)}function KC(n){var l=n.getUTCDay();return l===0?7:l}function Tm(n,l){return Cs(PC.count(wm(n)-1,n),l,2)}function Mb(n){var l=n.getUTCDay();return l>=4||l===0?kg(n):kg.ceil(n)}function $4(n,l){return n=Mb(n),Cs(kg.count(wm(n),n)+(wm(n).getUTCDay()===4),l,2)}function q4(n){return n.getUTCDay()}function K4(n,l){return Cs(u_.count(wm(n)-1,n),l,2)}function Q4(n,l){return Cs(n.getUTCFullYear()%100,l,2)}function J4(n,l){return n=Mb(n),Cs(n.getUTCFullYear()%100,l,2)}function tL(n,l){return Cs(n.getUTCFullYear()%1e4,l,4)}function eL(n,l){var a=n.getUTCDay();return n=a>=4||a===0?kg(n):kg.ceil(n),Cs(n.getUTCFullYear()%1e4,l,4)}function rL(){return"+0000"}function QC(){return"%"}function JC(n){return+n}function tA(n){return Math.floor(+n/1e3)}var z0,eA,nL,iL,aL;Ib({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ib(n){return z0=E4(n),eA=z0.format,nL=z0.parse,iL=z0.utcFormat,aL=z0.utcParse,z0}var U0=1e3,Mm=U0*60,Im=Mm*60,km=Im*24,m_=km*7,rA=km*30,kb=km*365;function y_(n){return new Date(n)}function nA(n){return n instanceof Date?+n:+new Date(+n)}function Lb(n,l,a,s,o,h,v,m,E){var A=aC(Nc,Nc),F=A.invert,B=A.domain,V=E(".%L"),j=E(":%S"),nt=E("%I:%M"),at=E("%I %p"),mt=E("%a %d"),Bt=E("%b %d"),de=E("%B"),ce=E("%Y"),Be=[[v,1,U0],[v,5,5*U0],[v,15,15*U0],[v,30,30*U0],[h,1,Mm],[h,5,5*Mm],[h,15,15*Mm],[h,30,30*Mm],[o,1,Im],[o,3,3*Im],[o,6,6*Im],[o,12,12*Im],[s,1,km],[s,2,2*km],[a,1,m_],[l,1,rA],[l,3,3*rA],[n,1,kb]];function Xe(Ir){return(v(Ir)<Ir?V:h(Ir)<Ir?j:o(Ir)<Ir?nt:s(Ir)<Ir?at:l(Ir)<Ir?a(Ir)<Ir?mt:Bt:n(Ir)<Ir?de:ce)(Ir)}function _r(Ir,Nr,Yr,yn){if(Ir==null&&(Ir=10),typeof Ir=="number"){var fn=Math.abs(Yr-Nr)/Ir,$n=Wx(function(di){return di[2]}).right(Be,fn);$n===Be.length?(yn=Xy(Nr/kb,Yr/kb,Ir),Ir=n):$n?($n=Be[fn/Be[$n-1][2]<Be[$n][2]/fn?$n-1:$n],yn=$n[1],Ir=$n[0]):(yn=Math.max(Xy(Nr,Yr,Ir),1),Ir=m)}return yn==null?Ir:Ir.every(yn)}return A.invert=function(Ir){return new Date(F(Ir))},A.domain=function(Ir){return arguments.length?B(tC.call(Ir,nA)):B().map(y_)},A.ticks=function(Ir,Nr){var Yr=B(),yn=Yr[0],fn=Yr[Yr.length-1],$n=fn<yn,di;return $n&&(di=yn,yn=fn,fn=di),di=_r(Ir,yn,fn,Nr),di=di?di.range(yn,fn+1):[],$n?di.reverse():di},A.tickFormat=function(Ir,Nr){return Nr==null?Xe:E(Nr)},A.nice=function(Ir,Nr){var Yr=B();return(Ir=_r(Ir,Yr[0],Yr[Yr.length-1],Nr))?B(pC(Yr,Ir)):A},A.copy=function(){return Qy(A,Lb(n,l,a,s,o,h,v,m,E))},A}function iA(){return tv.apply(Lb(Ig,c4,yb,o_,g4,kC,m4,y4,eA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function oL(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function __(){var n=0,l=1,a,s,o,h,v=Nc,m=!1,E;function A(F){return isNaN(F=+F)?E:v(o===0?.5:(F=(h(F)-a)*o,m?Math.max(0,Math.min(1,F)):F))}return A.domain=function(F){return arguments.length?(a=h(n=+F[0]),s=h(l=+F[1]),o=a===s?0:1/(s-a),A):[n,l]},A.clamp=function(F){return arguments.length?(m=!!F,A):m},A.interpolator=function(F){return arguments.length?(v=F,A):v},A.unknown=function(F){return arguments.length?(E=F,A):E},function(F){return h=F,a=F(n),s=F(l),o=a===s?0:1/(s-a),A}}function Lm(n,l){return l.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function aA(){var n=bm(__()(Nc));return n.copy=function(){return Lm(n,aA())},tb.apply(n,arguments)}function sL(){var n=loggish(__()).domain([1,10]);return n.copy=function(){return Lm(n,sL()).base(n.base())},initInterpolator.apply(n,arguments)}function uL(){var n=symlogish(__());return n.copy=function(){return Lm(n,uL()).constant(n.constant())},initInterpolator.apply(n,arguments)}function Pb(){var n=powish(__());return n.copy=function(){return Lm(n,Pb()).exponent(n.exponent())},initInterpolator.apply(n,arguments)}function lL(){return Pb.apply(null,arguments).exponent(.5)}function cL(){var n=[],l=identity;function a(s){if(!isNaN(s=+s))return l((bisect(n,s)-1)/(n.length-1))}return a.domain=function(s){if(!arguments.length)return n.slice();n=[];for(var o=0,h=s.length,v;o<h;++o)v=s[o],v!=null&&!isNaN(v=+v)&&n.push(v);return n.sort(ascending),a},a.interpolator=function(s){return arguments.length?(l=s,a):l},a.copy=function(){return cL(l).domain(n)},initInterpolator.apply(a,arguments)}function x_(){var n=0,l=.5,a=1,s,o,h,v,m,E=Nc,A,F=!1,B;function V(j){return isNaN(j=+j)?B:(j=.5+((j=+A(j))-o)*(j<o?v:m),E(F?Math.max(0,Math.min(1,j)):j))}return V.domain=function(j){return arguments.length?(s=A(n=+j[0]),o=A(l=+j[1]),h=A(a=+j[2]),v=s===o?0:.5/(o-s),m=o===h?0:.5/(h-o),V):[n,l,a]},V.clamp=function(j){return arguments.length?(F=!!j,V):F},V.interpolator=function(j){return arguments.length?(E=j,V):E},V.unknown=function(j){return arguments.length?(B=j,V):B},function(j){return A=j,s=j(n),o=j(l),h=j(a),v=s===o?0:.5/(o-s),m=o===h?0:.5/(h-o),V}}function oA(){var n=bm(x_()(Nc));return n.copy=function(){return Lm(n,oA())},tb.apply(n,arguments)}function fL(){var n=loggish(x_()).domain([.1,1,10]);return n.copy=function(){return copy(n,fL()).base(n.base())},initInterpolator.apply(n,arguments)}function hL(){var n=symlogish(x_());return n.copy=function(){return copy(n,hL()).constant(n.constant())},initInterpolator.apply(n,arguments)}function sA(){var n=powish(x_());return n.copy=function(){return copy(n,sA()).exponent(n.exponent())},initInterpolator.apply(n,arguments)}function AF(){return sA.apply(null,arguments).exponent(.5)}function uA(n){var l,a=[];function s(o){return o==null?l:o}return s.invert=s,s.domain=s.range=function(o){return o?(a=o,o):a},s.unknown=function(o){return o?(l=o,o):l},s.copy=function(){return uA(n).unknown(l)},s}var ch,pL,Ob,lA=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Fb=(ch={},(0,W.Z)(ch,Ps.LINEAR,hC),(0,W.Z)(ch,Ps.POWER,pb),(0,W.Z)(ch,Ps.LOG,_C),(0,W.Z)(ch,Ps.IDENTITY,uA),(0,W.Z)(ch,Ps.SEQUENTIAL,aA),(0,W.Z)(ch,Ps.TIME,iA),(0,W.Z)(ch,Ps.QUANTILE,db),(0,W.Z)(ch,Ps.QUANTIZE,wC),(0,W.Z)(ch,Ps.THRESHOLD,CC),(0,W.Z)(ch,Ps.CAT,ym),(0,W.Z)(ch,Ps.DIVERGING,oA),ch),dL=(pL=(0,Mt.b2)(),pL(Ob=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"scaleOptions",{})}return(0,tt.Z)(n,[{key:"apply",value:function(a,s){var o=this,h=s.styleAttributeService;a.hooks.init.tapPromise("FeatureScalePlugin",(0,ut.Z)(it().mark(function v(){var m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(o.scaleOptions=a.getScaleOptions(),E=h.getLayerStyleAttributes(),A=(m=a.getSource())===null||m===void 0?void 0:m.data.dataArray,!(Array.isArray(A)&&A.length===0)){B.next=7;break}return B.abrupt("return");case 7:o.caculateScalesForAttributes(E||[],A);case 8:case"end":return B.stop()}},v)}))),a.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var v=(0,ut.Z)(it().mark(function m(E){var A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(E){V.next=2;break}return V.abrupt("return",E);case 2:if(o.scaleOptions=a.getScaleOptions(),A=h.getLayerStyleAttributes(),F=a.getSource().data.dataArray,!(Array.isArray(F)&&F.length===0)){V.next=7;break}return V.abrupt("return",!0);case 7:return o.caculateScalesForAttributes(A||[],F),a.layerModelNeedUpdate=!0,V.abrupt("return",!0);case 10:case"end":return V.stop()}},m)}));return function(m){return v.apply(this,arguments)}}()),a.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!a.layerModelNeedUpdate){o.scaleOptions=a.getScaleOptions();var v=h.getLayerStyleAttributes(),m=a.getSource().data.dataArray;if(!(Array.isArray(m)&&m.length===0)&&v){var E=v.filter(function(A){return A.needRescale});E.length&&o.caculateScalesForAttributes(E,m)}}})}},{key:"isNumber",value:function(a){return!isNaN(parseFloat(a))&&isFinite(a)}},{key:"caculateScalesForAttributes",value:function(a,s){var o=this;a.forEach(function(h){if(h.scale){var v=h.scale;v.names=o.parseFields(h.scale.field||[]);var m=[];v.names.forEach(function(E){var A;m.push(o.createScale(E,h.name,(A=h.scale)===null||A===void 0?void 0:A.values,s))}),m.some(function(E){return E.type===Rv.VARIABLE})?(v.type=Rv.VARIABLE,m.forEach(function(E){var A;if(!v.callback&&v.values!=="text")switch((A=E.option)===null||A===void 0?void 0:A.type){case Ps.LOG:case Ps.LINEAR:case Ps.POWER:if(v.values&&v.values.length>2){var F=E.scale.ticks(v.values.length);E.scale.domain(F)}v.values?E.scale.range(v.values):E.scale.range(E.option.domain);break;case Ps.QUANTILE:case Ps.QUANTIZE:case Ps.THRESHOLD:E.scale.range(v.values);break;case Ps.IDENTITY:break;case Ps.CAT:v.values?E.scale.range(v.values):E.scale.range(E.option.domain);break;case Ps.DIVERGING:case Ps.SEQUENTIAL:E.scale.interpolator(Gk(v.values));break}if(v.values==="text"){var B;E.scale.range((B=E.option)===null||B===void 0?void 0:B.domain)}})):(v.type=Rv.CONSTANT,v.defaultValues=m.map(function(E,A){return E.scale(v.names[A])})),v.scalers=m.map(function(E){return{field:E.field,func:E.scale,option:E.option}}),h.needRescale=!1}})}},{key:"parseFields",value:function(a){return Array.isArray(a)?a:(0,te.isString)(a)?a.split("*"):[a]}},{key:"createScale",value:function(a,s,o,h){var v,m,E=this.scaleOptions[s]&&((v=this.scaleOptions[s])===null||v===void 0?void 0:v.field)===a?this.scaleOptions[s]:this.scaleOptions[a],A={field:a,scale:void 0,type:Rv.VARIABLE,option:E};if(!h||!h.length)return E&&E.type?A.scale=this.createDefaultScale(E):(A.scale=ym([a]),A.type=Rv.CONSTANT),A;var F=(m=h.find(function(j){return!(0,te.isNil)(j[a])}))===null||m===void 0?void 0:m[a];if(this.isNumber(a)||(0,te.isNil)(F)&&!E)A.scale=ym([a]),A.type=Rv.CONSTANT;else{var B=E&&E.type||this.getDefaultType(F);o==="text"&&(B=Ps.CAT);var V=this.createScaleConfig(B,a,E,h);A.scale=this.createDefaultScale(V),A.option=V}return A}},{key:"getDefaultType",value:function(a){var s=Ps.LINEAR;return typeof a=="string"&&(s=lA.test(a)?Ps.TIME:Ps.CAT),s}},{key:"createScaleConfig",value:function(a,s,o,h){var v={type:a},m=(h==null?void 0:h.map(function(F){return F[s]}))||[];if(o!=null&&o.domain)v.domain=o==null?void 0:o.domain;else if(a===Ps.CAT||a===Ps.IDENTITY)v.domain=(0,te.uniq)(m);else if(a===Ps.QUANTILE)v.domain=m;else if(a===Ps.DIVERGING){var E=Ok(m),A=(o==null?void 0:o.neutral)!==void 0?o==null?void 0:o.neutral:(E[0]+E[1])/2;v.domain=[E[0],A,E[1]]}else v.domain=Ok(m);return(0,K.Z)((0,K.Z)({},v),o)}},{key:"createDefaultScale",value:function(a){var s=a.type,o=a.domain,h=a.unknown,v=a.clamp,m=a.nice,E=Fb[s]();return o&&E.domain&&E.domain(o),h&&E.unknown(h),v!==void 0&&E.clamp&&E.clamp(v),m!==void 0&&E.nice&&E.nice(m),E}}]),n}())||Ob),b_,cA,vL=(b_=(0,Mt.b2)(),b_(cA=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var s=a.animateStatus;s&&a.models.forEach(function(o){o.addUniforms((0,K.Z)({},a.layerModel.getAnimateUniforms()))})})}}]),n}())||cA),gL=function(){function n(l){var a=l.rendererService,s=l.layerService,o=l.parent;(0,lt.Z)(this,n),(0,W.Z)(this,"tileResource",new Map),(0,W.Z)(this,"_tiles",[]),this.rendererService=a,this.layerService=s,this.parent=o}return(0,tt.Z)(n,[{key:"tiles",get:function(){return this._tiles}},{key:"hasTile",value:function(a){return this._tiles.some(function(s){return s.key===a})}},{key:"addTile",value:function(a){this._tiles.push(a)}},{key:"getTile",value:function(a){return this._tiles.find(function(s){return s.key===a})}},{key:"getVisibleTileBylngLat",value:function(a){return this._tiles.find(function(s){return s.isLoaded&&s.visible&&s.lnglatInBounds(a)})}},{key:"removeTile",value:function(a){var s=this._tiles.findIndex(function(h){return h.key===a}),o=this._tiles.splice(s,1);o[0]&&o[0].destroy()}},{key:"updateTileVisible",value:function(a){var s=this.getTile(a.key);s==null||s.updateVisible(a.isVisible)}},{key:"isParentLoaded",value:function(a){var s=a.parent;if(!s)return!0;var o=this.getTile(s==null?void 0:s.key);return!!(o!=null&&o.isLoaded)}},{key:"isChildrenLoaded",value:function(a){var s=this,o=a==null?void 0:a.children;return o.length===0?!0:o.some(function(h){var v=s.getTile(h==null?void 0:h.key);return(v==null?void 0:v.isLoaded)===!1})}},{key:"render",value:function(){var l=(0,ut.Z)(it().mark(function s(){var o=this,h;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:h=this.getRenderLayers(),h.map(function(){var E=(0,ut.Z)(it().mark(function A(F){return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,o.layerService.renderLayer(F);case 2:case"end":return V.stop()}},A)}));return function(A){return E.apply(this,arguments)}}());case 2:case"end":return m.stop()}},s,this)}));function a(){return l.apply(this,arguments)}return a}()},{key:"getRenderLayers",value:function(){var a=this._tiles.filter(function(o){return o.visible&&o.isLoaded}),s=[];return a.map(function(o){return s.push.apply(s,(0,ge.Z)(o.getLayers()))}),s}},{key:"getLayers",value:function(){var a=this._tiles.filter(function(o){return o.isLoaded}),s=[];return a.map(function(o){return s.push.apply(s,(0,ge.Z)(o.getLayers()))}),s}},{key:"getTiles",value:function(){return this._tiles}},{key:"destroy",value:function(){this._tiles.forEach(function(a){return a.destroy()}),this.tileResource.clear()}}]),n}(),mL=ot(32676);function yL(n,l,a){a===void 0&&(a={});var s=by(n),o=by(l),h=mL.union(s.coordinates,o.coordinates);return h.length===0?null:h.length===1?Hc(h[0],a.properties):md(h,a.properties)}var _L=yL,xL=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"getCombineFeature",value:function(a){var s=null,o=a[0];return a.map(function(h){var v=Hc(h.coordinates);s===null?s=v:s=_L(s,v)}),o&&(s.properties=(0,K.Z)({},o)),s}}]),n}(),E_="select",fh="active",Rb=function(){function n(l){var a=l.layerService,s=l.tileLayerService,o=l.parent;(0,lt.Z)(this,n),(0,W.Z)(this,"tilePickID",new Map),this.layerService=a,this.tileLayerService=s,this.parent=o,this.tileSourceService=new xL}return(0,tt.Z)(n,[{key:"pickRender",value:function(a){var s=this.tileLayerService.getVisibleTileBylngLat(a.lngLat);if(s){var o=s.getMainLayer();o==null||o.layerPickService.pickRender(a)}}},{key:"pick",value:function(a,s){var o=this.parent.getContainer(),h=o.get(Dt.IPickingService);if(a.type==="RasterLayer"){var v=this.tileLayerService.getVisibleTileBylngLat(s.lngLat);if(v&&v.getMainLayer()!==void 0){var m=v.getMainLayer();return m.layerPickService.pickRasterLayer(m,s,this.parent)}return!1}return this.pickRender(s),h.pickFromPickingFBO(a,s)}},{key:"selectFeature",value:function(a){var s=(0,ht.Z)(a,3),o=s[0],h=s[1],v=s[2],m=this.color2PickId(o,h,v);this.tilePickID.set(E_,m),this.updateHighLight(o,h,v,E_)}},{key:"highlightPickedFeature",value:function(a){var s=(0,ht.Z)(a,3),o=s[0],h=s[1],v=s[2],m=this.color2PickId(o,h,v);this.tilePickID.set(fh,m),this.updateHighLight(o,h,v,fh)}},{key:"updateHighLight",value:function(a,s,o,h){this.tileLayerService.tiles.map(function(v){var m=v.getMainLayer();switch(h){case E_:m==null||m.hooks.beforeSelect.call([a,s,o]);break;case fh:m==null||m.hooks.beforeHighlight.call([a,s,o]);break}})}},{key:"setPickState",value:function(){var a=this.tilePickID.get(E_),s=this.tilePickID.get(fh);if(a){var o=this.pickId2Color(a),h=(0,ht.Z)(o,3),v=h[0],m=h[1],E=h[2];this.updateHighLight(v,m,E,E_);return}if(s){var A=this.pickId2Color(s),F=(0,ht.Z)(A,3),B=F[0],V=F[1],j=F[2];this.updateHighLight(B,V,j,fh);return}}},{key:"color2PickId",value:function(a,s,o){return cr(new Uint8Array([a,s,o]))}},{key:"pickId2Color",value:function(a){return ar(a)}},{key:"getFeatureById",value:function(a){var s=this.tileLayerService.getTiles().filter(function(h){return h.visible}),o=[];return s.map(function(h){o.push.apply(o,(0,ge.Z)(h.getFeatureById(a)))}),o.length<=0?null:[]}},{key:"pickRasterLayer",value:function(a,s,o){return!1}}]),n}();function bL(n){return n==="PolygonLayer"?Zx:n==="LineLayer"?Sg:Gy}function S_(n){return["PolygonLayer","LineLayer"].indexOf(n)!==-1}var Z0=function(){function n(l,a){(0,lt.Z)(this,n),(0,W.Z)(this,"visible",!0),(0,W.Z)(this,"layers",[]),(0,W.Z)(this,"isLoaded",!1),this.parent=a,this.sourceTile=l,this.x=l.x,this.y=l.y,this.z=l.z,this.key="".concat(this.x,"_").concat(this.y,"_").concat(this.z)}return(0,tt.Z)(n,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(a){var s=(0,ht.Z)(this.sourceTile.bounds,4),o=s[0],h=s[1],v=s[2],m=s[3],E=a.lng,A=a.lat;return E>=o&&E<=v&&A>=h&&A<=m}},{key:"getLayerOptions",value:function(){var a=this.parent.getLayerConfig();return(0,K.Z)((0,K.Z)({},a),{},{autoFit:!1,mask:S_(this.parent.type)||a.mask})}},{key:"addMask",value:function(){var l=(0,ut.Z)(it().mark(function s(o,h){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=cy(this.parent.sceneContainer),h.setContainer(v,this.parent.sceneContainer),E.next=4,h.init();case 4:o.addMaskLayer(h);case 5:case"end":return E.stop()}},s,this)}));function a(s,o){return l.apply(this,arguments)}return a}()},{key:"addLayer",value:function(){var l=(0,ut.Z)(it().mark(function s(o){var h;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return o.isTileLayer=!0,h=cy(this.parent.sceneContainer),o.setContainer(h,this.parent.sceneContainer),this.layers.push(o),m.next=6,o.init();case 6:case"end":return m.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"updateVisible",value:function(a){this.visible=a,this.updateOptions("visible",a)}},{key:"updateOptions",value:function(a,s){this.layers.forEach(function(o){o.updateLayerConfig((0,W.Z)({},a,s))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(a){return[]}},{key:"getFeatureById",value:function(a){return[]}},{key:"destroy",value:function(){this.layers.forEach(function(a){return a.destroy()})}}]),n}();function EL(n){var l=SL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function SL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var w_=function(n){(0,Ut.Z)(a,n);var l=EL(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=bL(this.parent.type),A=this.getSourceOption(),A){V.next=7;break}return this.isLoaded=!0,V.abrupt("return");case 7:if(F=new E((0,K.Z)({},m)).source(A.data,A.options),Object.keys(v).forEach(function(j){var nt,at,mt=j;F[mt]((nt=v[mt])===null||nt===void 0?void 0:nt.field,(at=v[mt])===null||at===void 0?void 0:at.values)}),!m.mask){V.next=12;break}return V.next=12,this.addTileMask(F);case 12:return V.next=14,this.addLayer(F);case 14:this.setLayerMinMaxZoom(F),this.isLoaded=!0;case 16:case"end":return V.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"addTileMask",value:function(){var s=(0,ut.Z)(it().mark(function h(v){var m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return m=new Hy({layerType:"MaskLayer"}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}),A.next=3,this.addMask(v,m);case 3:case"end":return A.stop()}},h,this)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource(),h=this.parent.getLayerConfig(),v=h.sourceLayer,m=v===void 0?"defaultLayer":v,E=h.featureId,A=E===void 0?"id":E,F=this.getFeatures(m);return{data:{type:"FeatureCollection",features:F},options:{parser:{type:"geojson",featureId:A},transforms:o.transforms}}}},{key:"setLayerMinMaxZoom",value:function(o){o.getModelType()==="text"&&o.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(o){var h=this.sourceTile.data;return h.getTileData(o)}},{key:"getFeatureById",value:function(o){var h=this.getMainLayer();return h?h.getSource().data.dataArray.filter(function(v){return v._id===o}):[]}}]),a}(Z0);function wL(n){var l=CL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function CL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var AL=function(n){(0,Ut.Z)(a,n);var l=wL(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.getSourceOption(),m=v.data.features[0].properties,E=new Sg().source(v.data,v.options).size(1).shape("line").color("red"),A=new Gy({minZoom:this.z-1,maxZoom:this.z+1}).source([m],{parser:{type:"json",x:"textLng",y:"textLat"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),B.next=6,this.addLayer(E);case 6:return B.next=8,this.addLayer(A);case 8:this.isLoaded=!0;case 9:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource(),h=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:h},options:{parser:{type:"geojson"},transforms:o.transforms}}}}]),a}(Z0);function TL(n){var l=ML();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ML(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var IL=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,kL=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,fA=function(n){(0,Ut.Z)(a,n);var l=TL(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity;return{u_opacity:h||1,u_texture:this.texture}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v=this,m,E,A,F,B,V,j,nt,at,mt,Bt;return it().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(m=this.layer.getLayerConfig(),E=m.mask,A=E===void 0?!1:E,F=m.maskInside,B=F===void 0?!0:F,V=this.layer.getSource(),j=this.rendererService.createTexture2D,this.texture=j({height:0,width:0}),!_u){ce.next=12;break}nt=this.layerService.sceneService.getSceneConfig().canvas,at=nt.createImage(),at.crossOrigin="anonymous",at.src=V.data.originData,at.onload=function(){v.texture=j({data:at,width:at.width,height:at.height}),v.layerService.reRender()},ce.next=16;break;case 12:return ce.next=14,V.data.images;case 14:mt=ce.sent,this.texture=j({data:mt[0],width:mt[0].width,height:mt[0].height,mag:Kt.LINEAR,min:Kt.LINEAR});case 16:return ce.next=18,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:kL,fragmentShader:IL,triangulation:Oy,primitive:Kt.TRIANGLES,blend:{enable:!0},depth:{enable:!1},stencil:Rr(A,B)});case 18:return Bt=ce.sent,ce.abrupt("return",[Bt]);case 20:case"end":return ce.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy()}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}}]),a}(ws),LL={image:fA},PL=LL;function C_(n){var l=ld();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ld(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var hA=function(n){(0,Ut.Z)(a,n);var l=C_(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"type","ImageLayer"),s}return(0,tt.Z)(a,[{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel=new PL[v](this),E.next=4,this.initLayerModels();case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getDefaultConfig",value:function(){var o=this.getModelType(),h={image:{}};return h[o]}},{key:"getModelType",value:function(){return"image"}}]),a}(dg);function Db(n){var l=OL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function OL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var FL=function(n){(0,Ut.Z)(a,n);var l=Db(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=this.getSourceOption(),A=new hA((0,K.Z)({},m)).source(E.data,E.options),v&&Object.keys(v).forEach(function(V){var j,nt,at=V;A[at]((j=v[at])===null||j===void 0?void 0:j.field,(nt=v[at])===null||nt===void 0?void 0:nt.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:o.transforms}}}}]),a}(Z0);function Bb(n){var l=Mp();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Mp(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var pA=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;
bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }


void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value))
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,dA=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,Nb=function(n){(0,Ut.Z)(a,n);var l=Bb(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.clampLow,E=m===void 0?!0:m,A=o.clampHigh,F=A===void 0?!0:A,B=o.noDataValue,V=B===void 0?-9999999:B,j=o.domain,nt=j===void 0?[0,1]:j,at=o.rampColors;return this.colorTexture=this.layer.textureService.getColorTexture(at),{u_opacity:v||1,u_texture:this.texture,u_domain:nt,u_clampLow:E,u_clampHigh:typeof F!="undefined"?F:E,u_noDataValue:V,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:function(){var s=(0,ut.Z)(it().mark(function h(v){var m,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(!Array.isArray(v.data)){V.next=4;break}return V.abrupt("return",{data:v.data,width:v.width,height:v.height});case 4:return V.next=6,v.data;case 6:return m=V.sent,E=m.rasterData,A=m.width,F=m.height,V.abrupt("return",{data:Array.from(E),width:A,height:F});case 11:case"end":return V.stop()}},h)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at,mt,Bt,de;return it().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=this.layer.getSource(),V=this.rendererService.createTexture2D,j=B.data.dataArray[0],Be.next=6,this.getRasterData(j);case 6:return nt=Be.sent,at=nt.data,mt=nt.width,Bt=nt.height,this.texture=V({data:at,width:mt,height:Bt,format:Kt.LUMINANCE,type:Kt.FLOAT}),Be.next=13,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:dA,fragmentShader:pA,triangulation:Oy,primitive:Kt.TRIANGLES,depth:{enable:!1},stencil:Rr(E,F)});case 13:return de=Be.sent,Be.abrupt("return",[de]);case 15:case"end":return Be.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.colorTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}},{key:"updateColorTexture",value:function(){var o=this.rendererService.createTexture2D,h=this.layer.getLayerConfig(),v=h.rampColors,m=br(v);this.colorTexture=o({data:m.data,width:m.width,height:m.height,flipY:!1})}}]),a}(ws),zb=["data"],vA=["rasterData"];function RL(n){var l=DL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function DL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var BL=`precision mediump float;
uniform vec2 u_rminmax: vec2(0,255); 
uniform vec2 u_gminmax: vec2(0,255);
uniform vec2 u_bminmax: vec2(0,255);
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform float u_noDataValue : 0.0;
varying vec2 v_texCoord;

void main() {
  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;
  if(rgb == vec3(u_noDataValue)) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    gl_FragColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }
 
}`,TF=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,NL=function(n){(0,Ut.Z)(a,n);var l=RL(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"dataOption",{}),s}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.noDataValue,E=m===void 0?0:m,A=this.dataOption,F=A.rMinMax,B=A.gMinMax,V=A.bMinMax;return{u_opacity:v||1,u_texture:this.texture,u_noDataValue:E,u_rminmax:F,u_gminmax:B,u_bminmax:V}}},{key:"getRasterData",value:function(){var s=(0,ut.Z)(it().mark(function h(v){var m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!Array.isArray(v.data)){j.next=4;break}return m=v.data,E=(0,Wl.Z)(v,zb),this.dataOption=E,j.abrupt("return",(0,K.Z)({data:m},E));case 4:return j.next=6,v.data;case 6:if(A=j.sent,F=A.rasterData,B=(0,Wl.Z)(A,vA),this.dataOption=B,!Array.isArray(F)){j.next=14;break}return j.abrupt("return",(0,K.Z)({data:F},B));case 14:return j.abrupt("return",(0,K.Z)({data:Array.from(F)},B));case 15:case"end":return j.stop()}},h,this)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at,mt,Bt,de;return it().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=this.layer.getSource(),V=this.rendererService.createTexture2D,j=B.data.dataArray[0],Be.next=6,this.getRasterData(j);case 6:return nt=Be.sent,at=nt.data,mt=nt.width,Bt=nt.height,this.texture=V({data:at,width:mt,height:Bt,format:Kt.RGB,type:Kt.FLOAT}),Be.next=13,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:TF,fragmentShader:BL,triangulation:Oy,primitive:Kt.TRIANGLES,depth:{enable:!1},stencil:Rr(E,F)});case 13:return de=Be.sent,Be.abrupt("return",[de]);case 15:case"end":return Be.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}}]),a}(ws);function zL(n){var l=gA();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function gA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ub=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;

void main() {
  vec4 baseColor = texture2D(u_texture, vec2(v_texCoord.x, v_texCoord.y)) * 256.0;
  float r = baseColor.r * 256.0 * 256.0;
  float g = baseColor.g * 256.0;
  float b = baseColor.b;
  float value =  (r + g + b) * 0.1 - 10000.0;
  
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
     gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture2D(u_colorTexture, vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,UL=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,ZL=function(n){(0,Ut.Z)(a,n);var l=zL(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=o.clampLow,m=v===void 0?!0:v,E=o.clampHigh,A=E===void 0?!0:E,F=o.noDataValue,B=F===void 0?-9999999:F,V=o.domain,j=V===void 0?[0,1]:V,nt=o.rampColors,at=o.colorTexture,mt=at;return at?this.layer.textureService.setColorTexture(at,nt):mt=this.layer.textureService.getColorTexture(nt),{u_opacity:h||1,u_texture:this.texture,u_domain:j,u_clampLow:m,u_clampHigh:typeof A!="undefined"?A:m,u_noDataValue:B,u_colorTexture:mt}}},{key:"initModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt;return it().wrap(function(mt){for(;;)switch(mt.prev=mt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=this.layer.getSource(),V=this.rendererService.createTexture2D,mt.next=5,B.data.images;case 5:return j=mt.sent,this.texture=V({data:j[0],width:j[0].width,height:j[0].height}),mt.next=9,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:UL,fragmentShader:Ub,triangulation:Oy,primitive:Kt.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F)});case 9:return nt=mt.sent,mt.abrupt("return",[nt]);case 11:case"end":return mt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy()}},{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}}]),a}(ws),VL={raster:Nb,rasterRgb:NL,raster3d:Nb,rasterTerrainRgb:ZL},GL=VL;function HL(n){var l=jL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function jL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Pm=function(n){(0,Ut.Z)(a,n);var l=HL(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"type","RasterLayer"),s}return(0,tt.Z)(a,[{key:"buildModels",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel=new GL[v](this),E.next=4,this.initLayerModels();case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getDefaultConfig",value:function(){var o=this.getModelType(),h={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return h[o]}},{key:"getModelType",value:function(){var o=this.layerSource.getParserType();switch(o){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}}]),a}(dg),WL=["rasterData"];function XL(n){var l=Zb();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Zb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var MF={positions:[0,1],colors:["#000","#fff"]},YL=function(n){(0,Ut.Z)(a,n);var l=XL(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=this.getSourceOption(),this.colorTexture=this.parent.textureService.getColorTexture(m.rampColors),A=new Pm((0,K.Z)((0,K.Z)({},m),{},{colorTexture:this.colorTexture})).source(E.data,E.options),v&&Object.keys(v).forEach(function(V){var j,nt,at=V;A[at]((j=v[at])===null||j===void 0?void 0:j.field,(nt=v[at])===null||nt===void 0?void 0:nt.values)}),B.next=8,this.addLayer(A);case 8:this.isLoaded=!0;case 9:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource(),h=this.sourceTile.data.data,v=h.rasterData,m=(0,Wl.Z)(h,WL);return{data:v,options:{parser:(0,K.Z)({type:"raster",extent:this.sourceTile.bounds},m),transforms:o.transforms}}}},{key:"styleUpdate",value:function(){for(var o=this,h=arguments.length,v=new Array(h),m=0;m<h;m++)v[m]=arguments[m];var E=v.rampColors,A=E===void 0?MF:E;this.colorTexture=this.parent.textureService.getColorTexture(A),this.layers.forEach(function(F){return F.style({colorTexture:o.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(o){return o.destroy()})}}]),a}(Z0),$L=["rasterData"];function qL(n){var l=KL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function KL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var QL=function(n){(0,Ut.Z)(a,n);var l=qL(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=this.getSourceOption(),A=new Pm((0,K.Z)({},m)).source(E.data,E.options),v&&Object.keys(v).forEach(function(V){var j,nt,at=V;A[at]((j=v[at])===null||j===void 0?void 0:j.field,(nt=v[at])===null||nt===void 0?void 0:nt.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource(),h=this.sourceTile.data.data,v=h.rasterData,m=(0,Wl.Z)(h,$L);return{data:v,options:{parser:(0,K.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},m),transforms:o.transforms}}}}]),a}(Z0);function mA(n){var l=JL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function JL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var tP=function(n){(0,Ut.Z)(a,n);var l=mA(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=this.getSourceOption(),A=new Pm((0,K.Z)({},m)).source(E.data,E.options),v&&Object.keys(v).forEach(function(V){var j,nt,at=V;A[at]((j=v[at])===null||j===void 0?void 0:j.field,(nt=v[at])===null||nt===void 0?void 0:nt.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:o.transforms}}}}]),a}(Z0);function eP(n){var l=rP();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function rP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var nP=function(n){(0,Ut.Z)(a,n);var l=eP(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=this.getSourceOption(),A=new Hy((0,K.Z)({},m)).source(E.data,E.options),v&&Object.keys(v).forEach(function(V){var j,nt,at=V;A[at]((j=v[at])===null||j===void 0?void 0:j.field,(nt=v[at])===null||nt===void 0?void 0:nt.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getFeatures",value:function(o){if(!o)return[];var h=this.sourceTile.data;return h.getTileData(o)}},{key:"getSourceOption",value:function(){var o=this.parent.getSource(),h=this.parent.getLayerConfig(),v=h.sourceLayer,m=h.featureId,E=this.getFeatures(v);return{data:{type:"FeatureCollection",features:E},options:{parser:{type:"geojson",featureId:m},transforms:o.transforms}}}}]),a}(Z0);function iP(n){var l=n.type;switch(l){case"PolygonLayer":return w_;case"LineLayer":return w_;case"PointLayer":return w_;case"TileDebugLayer":return AL;case"MaskLayer":return nP;case"RasterLayer":var a=n.getSource().parser.dataType;switch(a){case"rgb":case"customRGB":return QL;case"arraybuffer":case"customArrayBuffer":return YL;case"terrainRGB":return tP;default:return FL}default:return w_}}var aP=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive"],yA=function(){function n(l){(0,lt.Z)(this,n),(0,W.Z)(this,"initedTileset",!1),(0,W.Z)(this,"viewchange",(0,te.debounce)(this.mapchange,24)),this.parent=l;var a=this.parent.getContainer();this.rendererService=a.get(Dt.IRendererService),this.layerService=a.get(Dt.ILayerService),this.mapService=a.get(Dt.IMapService),this.pickingService=a.get(Dt.IPickingService),this.tileLayerService=new gL({rendererService:this.rendererService,layerService:this.layerService,parent:l}),this.tilePickService=new Rb({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:l}),this.parent.setLayerPickService(this.tilePickService),this.proxy(l),this.initTileSetManager()}return(0,tt.Z)(n,[{key:"initTileSetManager",value:function(){var a,s=this.parent.getSource();this.tilesetManager=s.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0);var o=this.getCurrentView(),h=o.latLonBounds,v=o.zoom;(a=this.tilesetManager)===null||a===void 0||a.update(v,h)}},{key:"mapchange",value:function(){var a,s=this.getCurrentView(),o=s.latLonBounds,h=s.zoom;if(this.mapService.version==="GAODE1.x"){var v=this.parent.getLayerConfig(),m=v.visible;h<2&&m?(this.parent.updateLayerConfig({visible:!1}),this.layerService.reRender()):h>=2&&!m&&(this.parent.updateLayerConfig({visible:!0}),this.layerService.reRender())}this.lastViewStates&&this.lastViewStates.zoom===h&&this.lastViewStates.latLonBounds.toString()===o.toString()||(this.lastViewStates={zoom:h,latLonBounds:o},(a=this.tilesetManager)===null||a===void 0||a.throttleUpdate(h,o))}},{key:"getCurrentView",value:function(){var a=this.mapService.getBounds(),s=[a[0][0],a[0][1],a[1][0],a[1][1]],o=this.mapService.getZoom();return{latLonBounds:s,zoom:o}}},{key:"bindTilesetEvent",value:function(){var a=this;this.tilesetManager.on("tile-loaded",function(s){}),this.tilesetManager.on("tile-unload",function(s){a.tileUnLoad(s)}),this.tilesetManager.on("tile-error",function(s,o){a.tileError(s)}),this.tilesetManager.on("tile-update",function(){a.tileUpdate()}),this.mapService.on("zoomend",function(){return a.mapchange()}),this.mapService.on("moveend",function(){return a.viewchange()})}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"tileLoaded",value:function(a){}},{key:"tileError",value:function(a){console.warn("error:",a)}},{key:"destroy",value:function(){var a;(a=this.tilesetManager)===null||a===void 0||a.destroy(),this.tileLayerService.destroy()}},{key:"tileUnLoad",value:function(a){this.tileLayerService.removeTile(a.key)}},{key:"tileUpdate",value:function(){var l=(0,ut.Z)(it().mark(function s(){var o=this,h,v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(this.tilesetManager){E.next=2;break}return E.abrupt("return");case 2:return h=this.parent.getMinZoom(),v=this.parent.getMaxZoom(),E.next=6,Promise.all(this.tilesetManager.tiles.filter(function(A){return A.isLoaded}).filter(function(A){return A.isVisibleChange}).filter(function(A){return A.data}).filter(function(A){return A.z>=h&&A.z<v}).map(function(){var A=(0,ut.Z)(it().mark(function F(B){var V,j;return it().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:if(o.tileLayerService.hasTile(B.key)){at.next=9;break}return V=iP(o.parent),j=new V(B,o.parent),at.next=5,j.initTileLayer();case 5:o.tilePickService.setPickState(),j.getLayers().length!==0&&(o.tileLayerService.addTile(j),o.tileLayerService.updateTileVisible(B),o.layerService.reRender()),at.next=12;break;case 9:o.tileLayerService.updateTileVisible(B),o.tilePickService.setPickState(),o.layerService.reRender();case 12:case"end":return at.stop()}},F)}));return function(F){return A.apply(this,arguments)}}()));case 6:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 7:case"end":return E.stop()}},s,this)}));function a(){return l.apply(this,arguments)}return a}()},{key:"setPickState",value:function(a){}},{key:"pickRender",value:function(a){this.tilePickService.pickRender(a)}},{key:"selectFeature",value:function(a){this.tilePickService.selectFeature(a)}},{key:"highlightPickedFeature",value:function(a){this.tilePickService.highlightPickedFeature(a)}},{key:"proxy",value:function(a){var s=this;aP.forEach(function(o){var h=a[o].bind(a);a[o]=function(){for(var v=arguments.length,m=new Array(v),E=0;E<v;E++)m[E]=arguments[E];return h.apply(void 0,m),s.getLayers().map(function(A){A[o].apply(A,m)}),o==="style"&&s.getTiles().forEach(function(A){return A.styleUpdate.apply(A,m)}),a}})}}]),n}(),_A,oP,Vh=(_A=(0,Mt.b2)(),_A(oP=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"initLayerModel",value:function(){var l=(0,ut.Z)(it().mark(function s(o){return it().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o.prepareBuildModel(),v.next=3,o.buildModels();case 3:o.styleNeedUpdate=!1;case 4:case"end":return v.stop()}},s)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"prepareLayerModel",value:function(){var l=(0,ut.Z)(it().mark(function s(o){return it().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o.prepareBuildModel(),v.next=3,o.buildModels();case 3:case"end":return v.stop()}},s)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"apply",value:function(a){var s=this;a.hooks.init.tapPromise("LayerModelPlugin",(0,ut.Z)(it().mark(function o(){return it().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!a.getSource().isTile){v.next=4;break}return a.prepareBuildModel(),a.tileLayer=new yA(a),v.abrupt("return");case 4:return v.next=6,s.initLayerModel(a);case 6:case"end":return v.stop()}},o)}))),a.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var o=(0,ut.Z)(it().mark(function h(v){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(v){E.next=2;break}return E.abrupt("return",!1);case 2:if(!a.getSource().isTile){E.next=5;break}return a.tileLayer=new yA(a),E.abrupt("return",!1);case 5:return E.next=7,s.prepareLayerModel(a);case 7:return E.abrupt("return",!0);case 8:case"end":return E.stop()}},h)}));return function(h){return o.apply(this,arguments)}}())}}]),n}())||oP),Yv,xA,bA=(Yv=(0,Mt.b2)(),Yv(xA=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"apply",value:function(a){a.hooks.afterInit.tap("LayerStylePlugin",function(){var s=a.getLayerConfig(),o=s.autoFit,h=s.fitBoundsOptions;o&&a.fitBounds(h)})}}]),n}())||xA),Vb,Gb,Hb=["type"],EA={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},sP={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},uP={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},lP={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function cP(n){var l={u_DirectionalLights:new Array(3).fill((0,K.Z)({},uP)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,K.Z)({},lP)),u_NumOfSpotLights:0};return(!n||!n.length)&&(n=[sP]),n.forEach(function(a){var s=a.type,o=s===void 0?"directional":s,h=(0,Wl.Z)(a,Hb),v=EA[o].lights,m=EA[o].num,E=l[m];l[v][E]=(0,K.Z)((0,K.Z)({},l[v][E]),h),l[m]++}),l}var fP=(Vb=(0,Mt.b2)(),Vb(Gb=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("LightingPlugin",function(){var s=a.getLayerConfig(),o=s.enableLighting;o&&a.models.forEach(function(h){return h.addUniforms((0,K.Z)({},cP()))})})}}]),n}())||Gb),jb,Lg,A_=(jb=(0,Mt.b2)(),jb(Lg=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"apply",value:function(a,s){var o=this,h=s.rendererService,v=s.postProcessingPassFactory,m=s.normalPassFactory;a.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var E=a.getLayerConfig(),A=E.enableMultiPassRenderer,F=E.passes,B=F===void 0?[]:F;o.enabled=!!A&&a.getLayerConfig().enableMultiPassRenderer!==!1,o.enabled&&(a.multiPassRenderer=cx(a,B,v,m),a.multiPassRenderer.setRenderFlag(!0))}),a.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(o.enabled){var E=h.getViewportSize(),A=E.width,F=E.height;a.multiPassRenderer.resize(A,F)}})}}]),n}())||Lg),Pg,Wb,T_={NONE:0,ENCODE:1,HIGHLIGHT:2},hP=(Pg=(0,Mt.b2)(),Pg(Wb=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"apply",value:function(a,s){var o=s.styleAttributeService;a.hooks.init.tapPromise("PixelPickingPlugin",function(){var h=a.getLayerConfig(),v=h.enablePicking;o.registerStyleAttribute({name:"pickingColor",type:Vi.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:Kt.FLOAT},size:3,update:function(E){var A=E.id;return v?ar(A):[0,0,0]}}})}),a.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var h=a.getLayerConfig(),v=h.enablePicking;v&&a.isVisible()&&a.models.forEach(function(m){return m.addUniforms({u_PickingStage:T_.ENCODE})})}),a.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var h=a.getLayerConfig(),v=h.enablePicking;v&&a.isVisible()&&a.models.forEach(function(m){return m.addUniforms({u_PickingStage:T_.HIGHLIGHT})})}),a.hooks.beforeHighlight.tap("PixelPickingPlugin",function(h){var v=a.getLayerConfig(),m=v.highlightColor,E=v.activeMix,A=E===void 0?0:E,F=typeof m=="string"?ke(m):m||[1,0,0,1];a.updateLayerConfig({pickedFeatureID:cr(new Uint8Array(h))}),a.models.forEach(function(B){return B.addUniforms({u_PickingStage:T_.HIGHLIGHT,u_PickingColor:h,u_HighlightColor:F.map(function(V){return V*255}),u_activeMix:A})})}),a.hooks.beforeSelect.tap("PixelPickingPlugin",function(h){var v=a.getLayerConfig(),m=v.selectColor,E=v.selectMix,A=E===void 0?0:E,F=typeof m=="string"?ke(m):m||[1,0,0,1];a.updateLayerConfig({pickedFeatureID:cr(new Uint8Array(h))}),a.models.forEach(function(B){return B.addUniforms({u_PickingStage:T_.HIGHLIGHT,u_PickingColor:h,u_HighlightColor:F.map(function(V){return V*255}),u_activeMix:A,u_CurrentSelectedId:h,u_SelectColor:F.map(function(V){return V*255}),u_EnableSelect:1})})})}}]),n}())||Wb),SA=["mvt","geojsonvt","testTile"];function wA(n){var l=n.getSource();return SA.includes(l.parser.type)}function pP(n){return n.getContext?{width:n.width/DOM.DPR,height:n.height/DOM.DPR}:n.getBoundingClientRect()}var Xb,Om,M_=(Xb=(0,Mt.b2)(),Xb(Om=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"apply",value:function(a,s){var o=this,h=s.styleAttributeService;a.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){wA(a)||o.registerBuiltinAttributes(h,a)})}},{key:"registerBuiltinAttributes",value:function(a,s){if(s.type==="MaskLayer"){this.registerPositionAttribute(a);return}this.registerPositionAttribute(a),this.registerFilterAttribute(a),this.registerColorAttribute(a),this.registerVertexIdAttribute(a)}},{key:"registerPositionAttribute",value:function(a){a.registerStyleAttribute({name:"position",type:Vi.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:Kt.FLOAT},size:3,update:function(o,h,v){return v.length===2?[v[0],v[1],0]:[v[0],v[1],v[2]]}}})}},{key:"registerFilterAttribute",value:function(a){a.registerStyleAttribute({name:"filter",type:Vi.Attribute,descriptor:{name:"filter",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(o){var h=o.filter;return h?[1]:[0]}}})}},{key:"registerColorAttribute",value:function(a){a.registerStyleAttribute({name:"color",type:Vi.Attribute,descriptor:{name:"a_Color",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:4,update:function(o){var h=o.color;return!h||!h.length?[1,1,1,1]:h}}})}},{key:"registerVertexIdAttribute",value:function(a){a.registerStyleAttribute({name:"vertexId",type:Vi.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:Kt.DYNAMIC_DRAW,data:[],type:Kt.FLOAT},size:1,update:function(o,h){return[h]}}})}}]),n}())||Om),CA,AA,TA,MA,IA,kA,Og,LA,PA,dP,hh,I_=(CA=(0,Mt.b2)(),AA=(0,Mt.f3)(Dt.ICameraService),TA=(0,Mt.f3)(Dt.ICoordinateSystemService),MA=(0,Mt.f3)(Dt.IRendererService),IA=(0,Mt.f3)(Dt.IMapService),CA(kA=(Og=function(){function n(){(0,lt.Z)(this,n),Ar(this,"cameraService",LA,this),Ar(this,"coordinateSystemService",PA,this),Ar(this,"rendererService",dP,this),Ar(this,"mapService",hh,this)}return(0,tt.Z)(n,[{key:"apply",value:function(a){var s=this,o=this.mapService.version,h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],v=[0,0];a.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var m=a.getLayerConfig().tileOrigin;s.coordinateSystemService.refresh(m),o==="GAODE2.x"&&(s.setLayerCenter(a),h=s.mapService.map.customCoords.getMVPMatrix(),v=s.mapService.getCustomCoordCenter());var E=s.rendererService.getViewportSize(),A=E.width,F=E.height;a.models.forEach(function(B){var V;B.addUniforms((V={},(0,W.Z)(V,d0.ProjectionMatrix,s.cameraService.getProjectionMatrix()),(0,W.Z)(V,d0.ViewMatrix,s.cameraService.getViewMatrix()),(0,W.Z)(V,d0.ViewProjectionMatrix,s.cameraService.getViewProjectionMatrix()),(0,W.Z)(V,d0.Zoom,s.cameraService.getZoom()),(0,W.Z)(V,d0.ZoomScale,s.cameraService.getZoomScale()),(0,W.Z)(V,d0.FocalDistance,s.cameraService.getFocalDistance()),(0,W.Z)(V,d0.CameraPosition,s.cameraService.getCameraPosition()),(0,W.Z)(V,Lf.CoordinateSystem,s.coordinateSystemService.getCoordinateSystem()),(0,W.Z)(V,Lf.ViewportCenter,s.coordinateSystemService.getViewportCenter()),(0,W.Z)(V,Lf.ViewportCenterProjection,s.coordinateSystemService.getViewportCenterProjection()),(0,W.Z)(V,Lf.PixelsPerDegree,s.coordinateSystemService.getPixelsPerDegree()),(0,W.Z)(V,Lf.PixelsPerDegree2,s.coordinateSystemService.getPixelsPerDegree2()),(0,W.Z)(V,Lf.PixelsPerMeter,s.coordinateSystemService.getPixelsPerMeter()),(0,W.Z)(V,Lf.Mvp,h),(0,W.Z)(V,"u_SceneCenterMKT",v),(0,W.Z)(V,"u_ViewportSize",[A,F]),(0,W.Z)(V,"u_ModelMatrix",s.cameraService.getModelMatrix()),(0,W.Z)(V,"u_DevicePixelRatio",Co.devicePixelRatio),(0,W.Z)(V,"u_PickingBuffer",a.getLayerConfig().pickingBuffer||0),(0,W.Z)(V,"u_shaderPick",Number(a.getShaderPickStat())),V))})})}},{key:"setLayerCenter",value:function(a){a.coordCenter===void 0&&(a.coordCenter=a.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(a.coordCenter)}}]),n}(),LA=Dr(Og.prototype,"cameraService",[AA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PA=Dr(Og.prototype,"coordinateSystemService",[TA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dP=Dr(Og.prototype,"rendererService",[MA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hh=Dr(Og.prototype,"mapService",[IA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Og))||kA),k_,L_,vP=(k_=(0,Mt.b2)(),k_(L_=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("UpdateModelPlugin",function(){a.layerModel&&a.layerModel.needUpdate().then(function(s){s&&a.renderLayers()})}),a.hooks.afterRender.tap("UpdateModelPlugin",function(){a.layerModelNeedUpdate=!1})}}]),n}())||L_),OA,FA,gP=(OA=(0,Mt.b2)(),OA(FA=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"apply",value:function(a,s){var o=this,h=s.styleAttributeService;a.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){o.initStyleAttribute(a,{styleAttributeService:h})}),a.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){a.layerModelNeedUpdate||a.inited&&o.updateStyleAttribute(a,{styleAttributeService:h})})}},{key:"updateStyleAttribute",value:function(a,s){var o=s.styleAttributeService,h=o.getLayerStyleAttributes()||[],v=o.getLayerStyleAttribute("filter");if(v&&v.needRegenerateVertices){a.layerModelNeedUpdate=!0,h.forEach(function(m){return m.needRegenerateVertices=!1});return}h.filter(function(m){return m.needRegenerateVertices}).forEach(function(m){o.updateAttributeByFeatureRange(m.name,a.getEncodedData(),m.featureRange.startIndex,m.featureRange.endIndex,a),m.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(a,s){var o=s.styleAttributeService,h=o.getLayerStyleAttributes()||[];h.filter(function(v){return v.needRegenerateVertices}).forEach(function(v){o.updateAttributeByFeatureRange(v.name,a.getEncodedData(),v.featureRange.startIndex,v.featureRange.endIndex),v.needRegenerateVertices=!1})}}]),n}())||FA);sh.bind(Dt.ILayerPlugin).to(Vw).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(M_).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(dL).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(Ik).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(bA).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(gP).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(vP).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(A_).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(I_).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(vL).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(fP).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(hP).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(Vh).inRequestScope();var RA=ot(88307),mP=ot.n(RA),yP=function(){function n(l,a){(0,lt.Z)(this,n);var s=a.buffer,o=a.offset,h=a.stride,v=a.normalized,m=a.size,E=a.divisor;this.buffer=s,this.attribute={buffer:s.get(),offset:o||0,stride:h||0,normalized:v||!1,divisor:E||0},m&&(this.attribute.size=m)}return(0,tt.Z)(n,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(a){this.buffer.subData(a)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),n}(),rv,Fm,nv,Gh,Rm,$v,P_,Fg,cd,V0,Sc,fd,Hh,qv,O_=(rv={},(0,W.Z)(rv,Kt.POINTS,"points"),(0,W.Z)(rv,Kt.LINES,"lines"),(0,W.Z)(rv,Kt.LINE_LOOP,"line loop"),(0,W.Z)(rv,Kt.LINE_STRIP,"line strip"),(0,W.Z)(rv,Kt.TRIANGLES,"triangles"),(0,W.Z)(rv,Kt.TRIANGLE_FAN,"triangle fan"),(0,W.Z)(rv,Kt.TRIANGLE_STRIP,"triangle strip"),rv),DA=(Fm={},(0,W.Z)(Fm,Kt.STATIC_DRAW,"static"),(0,W.Z)(Fm,Kt.DYNAMIC_DRAW,"dynamic"),(0,W.Z)(Fm,Kt.STREAM_DRAW,"stream"),Fm),Yb=(nv={},(0,W.Z)(nv,Kt.BYTE,"int8"),(0,W.Z)(nv,Kt.UNSIGNED_INT,"int16"),(0,W.Z)(nv,Kt.INT,"int32"),(0,W.Z)(nv,Kt.UNSIGNED_BYTE,"uint8"),(0,W.Z)(nv,Kt.UNSIGNED_SHORT,"uint16"),(0,W.Z)(nv,Kt.UNSIGNED_INT,"uint32"),(0,W.Z)(nv,Kt.FLOAT,"float"),nv),BA=(Gh={},(0,W.Z)(Gh,Kt.ALPHA,"alpha"),(0,W.Z)(Gh,Kt.LUMINANCE,"luminance"),(0,W.Z)(Gh,Kt.LUMINANCE_ALPHA,"luminance alpha"),(0,W.Z)(Gh,Kt.RGB,"rgb"),(0,W.Z)(Gh,Kt.RGBA,"rgba"),(0,W.Z)(Gh,Kt.RGBA4,"rgba4"),(0,W.Z)(Gh,Kt.RGB5_A1,"rgb5 a1"),(0,W.Z)(Gh,Kt.RGB565,"rgb565"),(0,W.Z)(Gh,Kt.DEPTH_COMPONENT,"depth"),(0,W.Z)(Gh,Kt.DEPTH_STENCIL,"depth stencil"),Gh),_P=(Rm={},(0,W.Z)(Rm,Kt.DONT_CARE,"dont care"),(0,W.Z)(Rm,Kt.NICEST,"nice"),(0,W.Z)(Rm,Kt.FASTEST,"fast"),Rm),NA=($v={},(0,W.Z)($v,Kt.NEAREST,"nearest"),(0,W.Z)($v,Kt.LINEAR,"linear"),(0,W.Z)($v,Kt.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,W.Z)($v,Kt.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,W.Z)($v,Kt.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,W.Z)($v,Kt.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),$v),zA=(P_={},(0,W.Z)(P_,Kt.REPEAT,"repeat"),(0,W.Z)(P_,Kt.CLAMP_TO_EDGE,"clamp"),(0,W.Z)(P_,Kt.MIRRORED_REPEAT,"mirror"),P_),xP=(Fg={},(0,W.Z)(Fg,Kt.NONE,"none"),(0,W.Z)(Fg,Kt.BROWSER_DEFAULT_WEBGL,"browser"),Fg),bP=(cd={},(0,W.Z)(cd,Kt.NEVER,"never"),(0,W.Z)(cd,Kt.ALWAYS,"always"),(0,W.Z)(cd,Kt.LESS,"less"),(0,W.Z)(cd,Kt.LEQUAL,"lequal"),(0,W.Z)(cd,Kt.GREATER,"greater"),(0,W.Z)(cd,Kt.GEQUAL,"gequal"),(0,W.Z)(cd,Kt.EQUAL,"equal"),(0,W.Z)(cd,Kt.NOTEQUAL,"notequal"),cd),UA=(V0={},(0,W.Z)(V0,Kt.FUNC_ADD,"add"),(0,W.Z)(V0,Kt.MIN_EXT,"min"),(0,W.Z)(V0,Kt.MAX_EXT,"max"),(0,W.Z)(V0,Kt.FUNC_SUBTRACT,"subtract"),(0,W.Z)(V0,Kt.FUNC_REVERSE_SUBTRACT,"reverse subtract"),V0),F_=(Sc={},(0,W.Z)(Sc,Kt.ZERO,"zero"),(0,W.Z)(Sc,Kt.ONE,"one"),(0,W.Z)(Sc,Kt.SRC_COLOR,"src color"),(0,W.Z)(Sc,Kt.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,W.Z)(Sc,Kt.SRC_ALPHA,"src alpha"),(0,W.Z)(Sc,Kt.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,W.Z)(Sc,Kt.DST_COLOR,"dst color"),(0,W.Z)(Sc,Kt.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,W.Z)(Sc,Kt.DST_ALPHA,"dst alpha"),(0,W.Z)(Sc,Kt.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,W.Z)(Sc,Kt.CONSTANT_COLOR,"constant color"),(0,W.Z)(Sc,Kt.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,W.Z)(Sc,Kt.CONSTANT_ALPHA,"constant alpha"),(0,W.Z)(Sc,Kt.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,W.Z)(Sc,Kt.SRC_ALPHA_SATURATE,"src alpha saturate"),Sc),ZA=(fd={},(0,W.Z)(fd,Kt.NEVER,"never"),(0,W.Z)(fd,Kt.ALWAYS,"always"),(0,W.Z)(fd,Kt.LESS,"less"),(0,W.Z)(fd,Kt.LEQUAL,"lequal"),(0,W.Z)(fd,Kt.GREATER,"greater"),(0,W.Z)(fd,Kt.GEQUAL,"gequal"),(0,W.Z)(fd,Kt.EQUAL,"equal"),(0,W.Z)(fd,Kt.NOTEQUAL,"notequal"),fd),Rg=(Hh={},(0,W.Z)(Hh,Kt.ZERO,"zero"),(0,W.Z)(Hh,Kt.KEEP,"keep"),(0,W.Z)(Hh,Kt.REPLACE,"replace"),(0,W.Z)(Hh,Kt.INVERT,"invert"),(0,W.Z)(Hh,Kt.INCR,"increment"),(0,W.Z)(Hh,Kt.DECR,"decrement"),(0,W.Z)(Hh,Kt.INCR_WRAP,"increment wrap"),(0,W.Z)(Hh,Kt.DECR_WRAP,"decrement wrap"),Hh),VA=(qv={},(0,W.Z)(qv,Kt.FRONT,"front"),(0,W.Z)(qv,Kt.BACK,"back"),qv),EP=function(){function n(l,a){(0,lt.Z)(this,n);var s=a.data,o=a.usage,h=a.type;this.buffer=l.buffer({data:s,usage:DA[o||Kt.STATIC_DRAW],type:Yb[h||Kt.UNSIGNED_BYTE]})}return(0,tt.Z)(n,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(a){var s=a.data,o=a.offset;this.buffer.subdata(s,o)}}]),n}(),hd=function(){function n(l,a){(0,lt.Z)(this,n);var s=a.data,o=a.usage,h=a.type,v=a.count;this.elements=l.elements({data:s,usage:DA[o||Kt.STATIC_DRAW],type:Yb[h||Kt.UNSIGNED_BYTE],count:v})}return(0,tt.Z)(n,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(a){var s=a.data;this.elements.subdata(s)}},{key:"destroy",value:function(){}}]),n}(),SP=function(){function n(l,a){(0,lt.Z)(this,n);var s=a.width,o=a.height,h=a.color,v=a.colors,m={width:s,height:o};Array.isArray(v)&&(m.colors=v.map(function(E){return E.get()})),h&&typeof h!="boolean"&&(m.color=h.get()),this.framebuffer=l.framebuffer(m)}return(0,tt.Z)(n,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(a){var s=a.width,o=a.height;this.framebuffer.resize(s,o)}}]),n}(),wP=function(){function n(l,a){(0,lt.Z)(this,n),(0,W.Z)(this,"destroyed",!1),(0,W.Z)(this,"uniforms",{}),this.reGl=l;var s=a.pick,o=s===void 0?!0:s,h=a.vs,v=a.fs,m=a.attributes,E=a.uniforms,A=a.primitive,F=a.count,B=a.elements,V=a.depth,j=a.blend,nt=a.stencil,at=a.cull,mt=a.instances,Bt={};this.options=a,E&&(this.uniforms=this.extractUniforms(E),Object.keys(E).forEach(function(Xe){Bt[Xe]=l.prop(Xe)}));var de={};Object.keys(m).forEach(function(Xe){de[Xe]=m[Xe].get()});var ce={attributes:de,frag:v,uniforms:Bt,vert:h,blend:{},primitive:O_[A===void 0?Kt.TRIANGLES:A]};if(mt&&(ce.instances=mt),F?ce.count=F:B&&(ce.elements=B.get()),this.initDepthDrawParams({depth:V},ce),this.initBlendDrawParams({blend:j},ce),this.initStencilDrawParams({stencil:nt},ce),this.initCullDrawParams({cull:at},ce),this.drawCommand=l(ce),o){var Be=(0,te.cloneDeep)(ce);Be.blend=(0,K.Z)((0,K.Z)({},Be.blend),{},{enable:!1}),this.drawPickCommand=l(Be)}this.drawParams=ce}return(0,tt.Z)(n,[{key:"updateAttributesAndElements",value:function(a,s){var o={};if(Object.keys(a).forEach(function(v){o[v]=a[v].get()}),this.drawParams.attributes=o,this.drawParams.elements=s.get(),this.drawCommand=this.reGl(this.drawParams),this.options.pick){var h=(0,te.cloneDeep)(this.drawParams);h.blend=(0,K.Z)((0,K.Z)({},h.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(h)}}},{key:"updateAttributes",value:function(a){var s={};if(Object.keys(a).forEach(function(h){s[h]=a[h].get()}),this.drawParams.attributes=s,this.drawCommand=this.reGl(this.drawParams),this.options.pick){var o=(0,te.cloneDeep)(this.drawParams);o.blend=(0,K.Z)((0,K.Z)({},o.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(o)}}},{key:"addUniforms",value:function(a){this.uniforms=(0,K.Z)((0,K.Z)({},this.uniforms),this.extractUniforms(a))}},{key:"draw",value:function(a,s){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var o=(0,K.Z)((0,K.Z)({},this.uniforms),this.extractUniforms(a.uniforms||{})),h={};Object.keys(o).forEach(function(v){var m=(0,Mn.Z)(o[v]);m==="boolean"||m==="number"||Array.isArray(o[v])||o[v].BYTES_PER_ELEMENT?h[v]=o[v]:h[v]=o[v].get()}),s?this.drawPickCommand&&this.drawPickCommand(h):this.drawCommand(h)}}},{key:"destroy",value:function(){var a,s;(a=this.drawParams)===null||a===void 0||(s=a.elements)===null||s===void 0||s.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(o){o==null||o.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(a,s){var o=a.depth;o&&(s.depth={enable:o.enable===void 0?!0:!!o.enable,mask:o.mask===void 0?!0:!!o.mask,func:bP[o.func||Kt.LESS],range:o.range||[0,1]})}},{key:"initBlendDrawParams",value:function(a,s){var o=a.blend;if(o){var h=o.enable,v=o.func,m=o.equation,E=o.color,A=E===void 0?[0,0,0,0]:E;s.blend={enable:!!h,func:{srcRGB:F_[v&&v.srcRGB||Kt.SRC_ALPHA],srcAlpha:F_[v&&v.srcAlpha||Kt.SRC_ALPHA],dstRGB:F_[v&&v.dstRGB||Kt.ONE_MINUS_SRC_ALPHA],dstAlpha:F_[v&&v.dstAlpha||Kt.ONE_MINUS_SRC_ALPHA]},equation:{rgb:UA[m&&m.rgb||Kt.FUNC_ADD],alpha:UA[m&&m.alpha||Kt.FUNC_ADD]},color:A}}}},{key:"initStencilDrawParams",value:function(a,s){var o=a.stencil;if(o){var h=o.enable,v=o.mask,m=v===void 0?-1:v,E=o.func,A=E===void 0?{cmp:Kt.ALWAYS,ref:0,mask:-1}:E,F=o.opFront,B=F===void 0?{fail:Kt.KEEP,zfail:Kt.KEEP,zpass:Kt.KEEP}:F,V=o.opBack,j=V===void 0?{fail:Kt.KEEP,zfail:Kt.KEEP,zpass:Kt.KEEP}:V;s.stencil={enable:!!h,mask:m,func:(0,K.Z)((0,K.Z)({},A),{},{cmp:ZA[A.cmp]}),opFront:{fail:Rg[B.fail],zfail:Rg[B.zfail],zpass:Rg[B.zpass]},opBack:{fail:Rg[j.fail],zfail:Rg[j.zfail],zpass:Rg[j.zpass]}}}}},{key:"initCullDrawParams",value:function(a,s){var o=a.cull;if(o){var h=o.enable,v=o.face,m=v===void 0?Kt.BACK:v;s.cull={enable:!!h,face:VA[m]}}}},{key:"extractUniforms",value:function(a){var s=this,o={};return Object.keys(a).forEach(function(h){s.extractUniformsRecursively(h,a[h],o,"")}),o}},{key:"extractUniformsRecursively",value:function(a,s,o,h){var v=this;if(s===null||typeof s=="number"||typeof s=="boolean"||Array.isArray(s)&&typeof s[0]=="number"||(0,te.isTypedArray)(s)||s===""||"resize"in s){o["".concat(h&&h+".").concat(a)]=s;return}(0,te.isPlainObject)(s)&&Object.keys(s).forEach(function(m){v.extractUniformsRecursively(m,s[m],o,"".concat(h&&h+".").concat(a))}),Array.isArray(s)&&s.forEach(function(m,E){Object.keys(m).forEach(function(A){v.extractUniformsRecursively(A,m[A],o,"".concat(h&&h+".").concat(a,"[").concat(E,"]"))})})}}]),n}(),GA=function(){function n(l,a){(0,lt.Z)(this,n),(0,W.Z)(this,"isDestroy",!1);var s=a.data,o=a.type,h=o===void 0?Kt.UNSIGNED_BYTE:o,v=a.width,m=a.height,E=a.flipY,A=E===void 0?!1:E,F=a.format,B=F===void 0?Kt.RGBA:F,V=a.mipmap,j=V===void 0?!1:V,nt=a.wrapS,at=nt===void 0?Kt.CLAMP_TO_EDGE:nt,mt=a.wrapT,Bt=mt===void 0?Kt.CLAMP_TO_EDGE:mt,de=a.aniso,ce=de===void 0?0:de,Be=a.alignment,Xe=Be===void 0?1:Be,_r=a.premultiplyAlpha,Ir=_r===void 0?!1:_r,Nr=a.mag,Yr=Nr===void 0?Kt.NEAREST:Nr,yn=a.min,fn=yn===void 0?Kt.NEAREST:yn,$n=a.colorSpace,di=$n===void 0?Kt.BROWSER_DEFAULT_WEBGL:$n,Yi=a.x,ho=Yi===void 0?0:Yi,zo=a.y,Vs=zo===void 0?0:zo,hu=a.copy,Gu=hu===void 0?!1:hu;this.width=v,this.height=m;var Wh={width:v,height:m,type:Yb[h],format:BA[B],wrapS:zA[at],wrapT:zA[Bt],mag:NA[Yr],min:NA[fn],alignment:Xe,flipY:A,colorSpace:xP[di],premultiplyAlpha:Ir,aniso:ce,x:ho,y:Vs,copy:Gu};s&&(Wh.data=s),typeof j=="number"?Wh.mipmap=_P[j]:typeof j=="boolean"&&(Wh.mipmap=j),this.texture=l.texture(Wh)}return(0,tt.Z)(n,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(a)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(a){var s=a.width,o=a.height;this.texture.resize(s,o),this.width=s,this.height=o}},{key:"destroy",value:function(){if(!this.isDestroy){var a;(a=this.texture)===null||a===void 0||a.destroy()}this.isDestroy=!0}}]),n}(),HA,jA,CP=(HA=(0,Mt.b2)(),HA(jA=function(){function n(){var l=this;(0,lt.Z)(this,n),(0,W.Z)(this,"createModel",function(a){return new wP(l.gl,a)}),(0,W.Z)(this,"createAttribute",function(a){return new yP(l.gl,a)}),(0,W.Z)(this,"createBuffer",function(a){return new EP(l.gl,a)}),(0,W.Z)(this,"createElements",function(a){return new hd(l.gl,a)}),(0,W.Z)(this,"createTexture2D",function(a){return new GA(l.gl,a)}),(0,W.Z)(this,"createFramebuffer",function(a){return new SP(l.gl,a)}),(0,W.Z)(this,"useFramebuffer",function(a,s){l.gl({framebuffer:a?a.get():null})(s)}),(0,W.Z)(this,"clear",function(a){var s,o=a.color,h=a.depth,v=a.stencil,m=a.framebuffer,E=m===void 0?null:m,A={color:o,depth:h,stencil:v};A.framebuffer=E===null?E:E.get(),(s=l.gl)===null||s===void 0||s.clear(A)}),(0,W.Z)(this,"viewport",function(a){var s=a.x,o=a.y,h=a.width,v=a.height;l.gl._gl.viewport(s,o,h,v),l.width=h,l.height=v,l.gl._refresh()}),(0,W.Z)(this,"readPixels",function(a){var s=a.framebuffer,o=a.x,h=a.y,v=a.width,m=a.height,E={x:o,y:h,width:v,height:m};return s&&(E.framebuffer=s.get()),l.gl.read(E)}),(0,W.Z)(this,"getViewportSize",function(){return{width:l.gl._gl.drawingBufferWidth,height:l.gl._gl.drawingBufferHeight}}),(0,W.Z)(this,"getContainer",function(){if(_u)return l.canvas;var a;return(a=l.canvas)===null||a===void 0?void 0:a.parentElement}),(0,W.Z)(this,"getCanvas",function(){return l.canvas}),(0,W.Z)(this,"getGLContext",function(){return l.gl._gl}),(0,W.Z)(this,"destroy",function(){var a,s,o;l.canvas=null,(a=l.gl)===null||a===void 0||(s=a._gl)===null||s===void 0||(o=s.getExtension("WEBGL_lose_context"))===null||o===void 0||o.loseContext(),l.gl.destroy(),l.gl=null})}return(0,tt.Z)(n,[{key:"init",value:function(){var l=(0,ut.Z)(it().mark(function s(o,h,v){var m=this;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(this.canvas=o,!v){A.next=5;break}this.gl=v,A.next=8;break;case 5:return A.next=7,new Promise(function(F,B){mP()({canvas:m.canvas,attributes:{alpha:!0,antialias:h.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:h.preserveDrawingBuffer,stencil:h.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(j,nt){(j||!nt)&&B(j),F(nt)}})});case 7:this.gl=A.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return A.stop()}},s,this)}));function a(s,o,h){return l.apply(this,arguments)}return a}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(a){return!!this.getGLContext().getExtension(a)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var a=this.getGLContext();a.disable(a.CULL_FACE)}},{key:"setDirty",value:function(a){this.isDirty=a}},{key:"getDirty",value:function(){return this.isDirty}}]),n}())||jA);function AP(n){var l=TP();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function TP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var $b=["selectstart","selecting","selectend"],MP=function(n){(0,Ut.Z)(a,n);var l=AP(a);function a(s){var o,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,lt.Z)(this,a),o=l.call(this),(0,W.Z)((0,st.Z)(o),"isEnable",!1),(0,W.Z)((0,st.Z)(o),"onDragStart",function(v){o.box.style.display="block",o.startEvent=o.endEvent=v,o.syncBoxBound(),o.emit("selectstart",o.getLngLatBox(),o.startEvent,o.endEvent)}),(0,W.Z)((0,st.Z)(o),"onDragging",function(v){o.endEvent=v,o.syncBoxBound(),o.emit("selecting",o.getLngLatBox(),o.startEvent,o.endEvent)}),(0,W.Z)((0,st.Z)(o),"onDragEnd",function(v){o.endEvent=v,o.box.style.display="none",o.emit("selectend",o.getLngLatBox(),o.startEvent,o.endEvent)}),o.scene=s,o.options=h,o}return(0,tt.Z)(a,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var o=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var h=_t("div",void 0,this.container);h.classList.add("l7-select-box"),o&&h.classList.add(o),h.style.display="none",this.box=h}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){!this.isEnable||(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var o=this.startEvent,h=o.x,v=o.y,m=this.endEvent,E=m.x,A=m.y,F=Math.min(h,E),B=Math.min(v,A),V=Math.abs(h-E),j=Math.abs(v-A);this.box.style.top="".concat(B,"px"),this.box.style.left="".concat(F,"px"),this.box.style.width="".concat(V,"px"),this.box.style.height="".concat(j,"px")}},{key:"getLngLatBox",value:function(){var o=this.startEvent.lngLat,h=o.lng,v=o.lat,m=this.endEvent.lngLat,E=m.lng,A=m.lat;return Tc([[h,v],[E,A]])}}]),a}(Ee.EventEmitter),IP=function(){function n(l){(0,lt.Z)(this,n);var a=l.id,s=l.map,o=l.canvas,h=l.hasBaseMap,v=TM();this.container=v,s.setContainer(v,a,o,h),v.bind(Dt.IRendererService).to(CP).inSingletonScope(),this.sceneService=v.get(Dt.ISceneService),this.mapService=v.get(Dt.IMapService),this.iconService=v.get(Dt.IIconService),this.fontService=v.get(Dt.IFontService),this.controlService=v.get(Dt.IControlService),this.layerService=v.get(Dt.ILayerService),this.markerService=v.get(Dt.IMarkerService),this.interactionService=v.get(Dt.IInteractionService),this.popupService=v.get(Dt.IPopupService),this.boxSelect=new MP(this,{}),_u?this.sceneService.initMiniScene(l):(this.initComponent(a),this.sceneService.init(l),this.initControl())}return(0,tt.Z)(n,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(a){return this.sceneService.exportPng(a)}},{key:"exportMap",value:function(a){return this.sceneService.exportPng(a)}},{key:"registerRenderService",value:function(a){var s=this;if(this.sceneService.loaded){var o=new a(this);o.init()}else this.on("loaded",function(){var h=new a(s);h.init()})}},{key:"setBgColor",value:function(a){this.mapService.setBgColor(a)}},{key:"addLayer",value:function(a){var s=this,o=cy(this.container);if(a.setContainer(o,this.container),this.sceneService.addLayer(a),a.inited){var h=this.initMask(a);this.addMask(h,a.id)}else a.on("inited",function(){var v=s.initMask(a);s.addMask(v,a.id)})}},{key:"initMask",value:function(a){var s=a.getLayerConfig(),o=s.mask,h=s.maskfence,v=s.maskColor,m=v===void 0?"#000":v,E=s.maskOpacity,A=E===void 0?0:E;if(!(!o||!h)){var F=new Hy().source(h).shape("fill").style({color:m,opacity:A});return F}}},{key:"addMask",value:function(a,s){if(!!a){var o=this.getLayer(s);if(o){var h=cy(this.container);a.setContainer(h,this.container),o.addMaskLayer(a),this.sceneService.addMask(a)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(a){return this.layerService.getLayer(a)}},{key:"getLayerByName",value:function(a){return this.layerService.getLayerByName(a)}},{key:"removeLayer",value:function(a,s){this.layerService.remove(a,s)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(a){this.layerService.setEnableRender(a)}},{key:"addIconFont",value:function(a,s){this.fontService.addIconFont(a,s)}},{key:"addIconFonts",value:function(a){var s=this;a.forEach(function(o){var h=(0,ht.Z)(o,2),v=h[0],m=h[1];s.fontService.addIconFont(v,m)})}},{key:"addFontFace",value:function(a,s){var o=this;this.fontService.once("fontloaded",function(h){o.emit("fontloaded",h)}),this.fontService.addFontFace(a,s)}},{key:"addImage",value:function(){var l=(0,ut.Z)(it().mark(function s(o,h){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(_u){m.next=5;break}return m.next=3,this.iconService.addImage(o,h);case 3:m.next=6;break;case 5:this.iconService.addImageMini(o,h,this.sceneService);case 6:case"end":return m.stop()}},s,this)}));function a(s,o){return l.apply(this,arguments)}return a}()},{key:"hasImage",value:function(a){return this.iconService.hasImage(a)}},{key:"removeImage",value:function(a){this.iconService.removeImage(a)}},{key:"addIconFontGlyphs",value:function(a,s){this.fontService.addIconGlyphs(s)}},{key:"addControl",value:function(a){this.controlService.addControl(a,this.container)}},{key:"removeControl",value:function(a){this.controlService.removeControl(a)}},{key:"getControlByName",value:function(a){return this.controlService.getControlByName(a)}},{key:"addMarker",value:function(a){this.markerService.addMarker(a)}},{key:"addMarkerLayer",value:function(a){this.markerService.addMarkerLayer(a)}},{key:"removeMarkerLayer",value:function(a){this.markerService.removeMarkerLayer(a)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(a){this.popupService.addPopup(a)}},{key:"removePopup",value:function(a){this.popupService.removePopup(a)}},{key:"on",value:function(a,s){if($b.includes(a)){var o;(o=this.boxSelect)===null||o===void 0||o.on(a,s)}else hy.includes(a)?this.sceneService.on(a,s):this.mapService.on(a,s)}},{key:"once",value:function(a,s){if($b.includes(a)){var o;(o=this.boxSelect)===null||o===void 0||o.once(a,s)}else hy.includes(a)?this.sceneService.once(a,s):this.mapService.once(a,s)}},{key:"emit",value:function(a,s){hy.indexOf(a)===-1?this.mapService.on(a,s):this.sceneService.emit(a,s)}},{key:"off",value:function(a,s){if($b.includes(a)){var o;(o=this.boxSelect)===null||o===void 0||o.off(a,s)}else hy.includes(a)?this.sceneService.off(a,s):this.mapService.off(a,s)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(a){return this.mapService.getCenter(a)}},{key:"setCenter",value:function(a,s){return this.mapService.setCenter(a,s)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(a){return this.mapService.setPitch(a)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(a){this.mapService.setRotation(a)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(a){this.mapService.panTo(a)}},{key:"panBy",value:function(a,s){this.mapService.panBy(a,s)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(a){this.mapService.setZoom(a)}},{key:"fitBounds",value:function(a,s){var o=this.sceneService.getSceneConfig(),h=o.fitBoundsOptions,v=o.animate;this.mapService.fitBounds(a,s||(0,K.Z)((0,K.Z)({},h),{},{animate:v}))}},{key:"setZoomAndCenter",value:function(a,s){this.mapService.setZoomAndCenter(a,s)}},{key:"setMapStyle",value:function(a){this.mapService.setMapStyle(a)}},{key:"setMapStatus",value:function(a){this.mapService.setMapStatus(a)}},{key:"pixelToLngLat",value:function(a){return this.mapService.pixelToLngLat(a)}},{key:"lngLatToPixel",value:function(a){return this.mapService.lngLatToPixel(a)}},{key:"containerToLngLat",value:function(a){return this.mapService.containerToLngLat(a)}},{key:"lngLatToContainer",value:function(a){return this.mapService.lngLatToContainer(a)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(a,s){this.container.bind(Dt.IPostProcessingPass).to(a).whenTargetNamed(s)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var a=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),s&&this.boxSelect.once("selectend",function(){a.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(a){this.controlService.init({container:nl(a)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var a=this.sceneService.getSceneConfig(),s=a.logoVisible,o=a.logoPosition;s&&this.addControl(new PE({position:o}))}}]),n}(),WA,qb,XA,YA=(WA=ly(Dt.IGlobalConfigService),qb=function(){function n(l){(0,lt.Z)(this,n),Ar(this,"configService",XA,this),this.config=l}return(0,tt.Z)(n,[{key:"setContainer",value:function(a,s,o,h){a.bind(Dt.MapConfig).toConstantValue((0,K.Z)((0,K.Z)({},this.config),{},{id:s,canvas:o,hasBaseMap:h})),a.bind(Dt.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),n}(),XA=Dr(qb.prototype,"configService",[WA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qb),kP=ot(81618),$A=ot.n(kP),LP=function(){function n(l){(0,lt.Z)(this,n),(0,W.Z)(this,"size",1e4),this.size=l||1e4}return(0,tt.Z)(n,[{key:"setSize",value:function(a){this.size=a}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(a){return(180+a)/360*this.size}},{key:"mercatorYfromLat",value:function(a){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(a){return a/this.size*360-180}},{key:"latFromMercatorY",value:function(a){var s=180-(1-a/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(s*Math.PI/180))-90}},{key:"project",value:function(a){var s=this.mercatorXfromLng(a[0]),o=this.mercatorYfromLat(a[1]);return[s,o]}},{key:"unproject",value:function(a){var s=this.lngFromMercatorX(a[0]),o=this.latFromMercatorY(a[1]);return[s,o]}}]),n}();function PP(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l={top:0,right:0,bottom:0,left:0};if(typeof n=="number")return{top:n,right:n,bottom:n,left:n};if(Array.isArray(n)){if(n.length===4)return{top:n[0],right:n[1],bottom:n[2],left:n[3]};if(n.length===2)return{top:n[0],right:n[1],bottom:n[0],left:n[1]}}return(0,K.Z)((0,K.Z)({},l),n)}function R_(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Kb(n,l){var a=cu([],l,n);return ea(a,a,1/a[3]),a}function r(n,l){var a=n%l;return a<0?l+a:a}function e(n,l,a){return a*l+(1-a)*n}function t(n,l){if(!n)throw new Error(l||"viewport-mercator-project: assertion failed.")}var i=Math.PI,u=i/4,c=i/180,p=180/i,g=512,_=4003e4,w=1.5;function k(n){return Math.pow(2,n)}function L(n){return Math.log2(n)}function R(n,l){var a=(0,ht.Z)(n,2),s=a[0],o=a[1];t(Number.isFinite(s)&&Number.isFinite(l)),t(Number.isFinite(o)&&o>=-90&&o<=90,"invalid latitude"),l*=g;var h=s*c,v=o*c,m=l*(h+i)/(2*i),E=l*(i-Math.log(Math.tan(u+v*.5)))/(2*i);return[m,E]}function U(n,l){var a=(0,ht.Z)(n,2),s=a[0],o=a[1];l*=g;var h=s/l*(2*i)-i,v=2*(Math.atan(Math.exp(i-o/l*(2*i)))-u);return[h*p,v*p]}function G(n){var l=n.latitude;assert(Number.isFinite(l));var a=Math.cos(l*c);return L(_*a)-9}function Q(n){var l=n.latitude,a=n.longitude,s=n.zoom,o=n.scale,h=n.highPrecision,v=h===void 0?!1:h;o=o!==void 0?o:k(s),t(Number.isFinite(l)&&Number.isFinite(a)&&Number.isFinite(o));var m={},E=g*o,A=Math.cos(l*c),F=E/360,B=F/A,V=E/_/A;if(m.pixelsPerMeter=[V,-V,V],m.metersPerPixel=[1/V,-1/V,1/V],m.pixelsPerDegree=[F,-B,V],m.degreesPerPixel=[1/F,-1/B,1/V],v){var j=c*Math.tan(l*c)/A,nt=F*j/2,at=E/_*j,mt=at/B*V;m.pixelsPerDegree2=[0,-nt,at],m.pixelsPerMeter2=[mt,0,mt]}return m}function pt(n,l){var a=_slicedToArray(n,3),s=a[0],o=a[1],h=a[2],v=_slicedToArray(l,3),m=v[0],E=v[1],A=v[2],F=1,B=Q({longitude:s,latitude:o,scale:F,highPrecision:!0}),V=B.pixelsPerMeter,j=B.pixelsPerMeter2,nt=R(n,F);nt[0]+=m*(V[0]+j[0]*E),nt[1]+=E*(V[1]+j[1]*E);var at=U(nt,F),mt=(h||0)+(A||0);return Number.isFinite(h)||Number.isFinite(A)?[at[0],at[1],mt]:at}function vt(n){var l=n.height,a=n.pitch,s=n.bearing,o=n.altitude,h=n.center,v=h===void 0?null:h,m=n.flipY,E=m===void 0?!1:m,A=R_();return pr(A,A,[0,0,-o]),kr(A,A,[1,1,1/l]),vr(A,A,-a*c),Hr(A,A,s*c),E&&kr(A,A,[1,-1,1]),v&&pr(A,A,wo.negate([],v)),A}function Vt(n){var l=n.width,a=n.height,s=n.altitude,o=s===void 0?w:s,h=n.pitch,v=h===void 0?0:h,m=n.nearZMultiplier,E=m===void 0?1:m,A=n.farZMultiplier,F=A===void 0?1:A,B=v*c,V=Math.atan(.5/o),j=Math.sin(V)*o/Math.sin(Math.PI/2-B-V),nt=Math.cos(Math.PI/2-B)*j+o;return{fov:2*Math.atan(a/2/o),aspect:l/a,focalDistance:o,near:E,far:nt*F}}function le(n){var l=n.width,a=n.height,s=n.pitch,o=n.altitude,h=n.nearZMultiplier,v=n.farZMultiplier,m=Vt({width:l,height:a,altitude:o,pitch:s,nearZMultiplier:h,farZMultiplier:v}),E=m.fov,A=m.aspect,F=m.near,B=m.far,V=Oc([],E,A,F,B);return V}function he(n,l){var a=(0,ht.Z)(n,3),s=a[0],o=a[1],h=a[2],v=h===void 0?0:h;return t(Number.isFinite(s)&&Number.isFinite(o)&&Number.isFinite(v)),Kb(l,[s,o,v,1])}function Ne(n,l){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=(0,ht.Z)(n,3),o=s[0],h=s[1],v=s[2];if(t(Number.isFinite(o)&&Number.isFinite(h),"invalid pixel coordinate"),Number.isFinite(v)){var m=Kb(l,[o,h,v,1]);return m}var E=Kb(l,[o,h,0,1]),A=Kb(l,[o,h,1,1]),F=E[2],B=A[2],V=F===B?0:((a||0)-F)/(B-F);return ei.t7([],E,A,V)}var Er=R_(),Fr=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=l.width,s=l.height,o=l.viewMatrix,h=o===void 0?Er:o,v=l.projectionMatrix,m=v===void 0?Er:v;(0,lt.Z)(this,n),this.width=a||1,this.height=s||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=h,this.projectionMatrix=m;var E=R_();mr(E,E,this.projectionMatrix),mr(E,E,this.viewMatrix),this.viewProjectionMatrix=E;var A=R_();kr(A,A,[this.width/2,-this.height/2,1]),pr(A,A,[1,-1,0]),mr(A,A,this.viewProjectionMatrix);var F=yr(R_(),A);if(!F)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=A,this.pixelUnprojectionMatrix=F,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,tt.Z)(n,[{key:"equals",value:function(a){return a instanceof n?a.width===this.width&&a.height===this.height&&Kp(a.projectionMatrix,this.projectionMatrix)&&Kp(a.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=s.topLeft,h=o===void 0?!0:o,v=this.projectPosition(a),m=he(v,this.pixelProjectionMatrix),E=(0,ht.Z)(m,2),A=E[0],F=E[1],B=h?F:this.height-F;return a.length===2?[A,B]:[A,B,m[2]]}},{key:"unproject",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=s.topLeft,h=o===void 0?!0:o,v=s.targetZ,m=(0,ht.Z)(a,3),E=m[0],A=m[1],F=m[2],B=h?A:this.height-A,V=v&&v*this.pixelsPerMeter,j=Ne([E,B,F],this.pixelUnprojectionMatrix,V),nt=this.unprojectPosition(j),at=(0,ht.Z)(nt,3),mt=at[0],Bt=at[1],de=at[2];return Number.isFinite(F)?[mt,Bt,de]:Number.isFinite(v)?[mt,Bt,v]:[mt,Bt]}},{key:"projectPosition",value:function(a){var s=this.projectFlat(a),o=(0,ht.Z)(s,2),h=o[0],v=o[1],m=(a[2]||0)*this.pixelsPerMeter;return[h,v,m]}},{key:"unprojectPosition",value:function(a){var s=this.unprojectFlat(a),o=(0,ht.Z)(s,2),h=o[0],v=o[1],m=(a[2]||0)/this.pixelsPerMeter;return[h,v,m]}},{key:"projectFlat",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return a}},{key:"unprojectFlat",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return a}}]),n}();function zr(n){var l=n.width,a=n.height,s=n.bounds,o=n.minExtent,h=o===void 0?0:o,v=n.maxZoom,m=v===void 0?24:v,E=n.padding,A=E===void 0?0:E,F=n.offset,B=F===void 0?[0,0]:F,V=(0,ht.Z)(s,2),j=(0,ht.Z)(V[0],2),nt=j[0],at=j[1],mt=(0,ht.Z)(V[1],2),Bt=mt[0],de=mt[1];if(Number.isFinite(A)){var ce=A;A={top:ce,bottom:ce,left:ce,right:ce}}else t(Number.isFinite(A.top)&&Number.isFinite(A.bottom)&&Number.isFinite(A.left)&&Number.isFinite(A.right));var Be=new pn({width:l,height:a,longitude:0,latitude:0,zoom:0}),Xe=Be.project([nt,de]),_r=Be.project([Bt,at]),Ir=[Math.max(Math.abs(_r[0]-Xe[0]),h),Math.max(Math.abs(_r[1]-Xe[1]),h)],Nr=[l-A.left-A.right-Math.abs(B[0])*2,a-A.top-A.bottom-Math.abs(B[1])*2];t(Nr[0]>0&&Nr[1]>0);var Yr=Nr[0]/Ir[0],yn=Nr[1]/Ir[1],fn=(A.right-A.left)/2/Yr,$n=(A.bottom-A.top)/2/yn,di=[(_r[0]+Xe[0])/2+fn,(_r[1]+Xe[1])/2+$n],Yi=Be.unproject(di),ho=Be.zoom+Math.log2(Math.abs(Math.min(Yr,yn)));return{longitude:Yi[0],latitude:Yi[1],zoom:Math.min(ho,m)}}var pn=function(n){(0,Ut.Z)(l,n);function l(){var a,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=s.width,h=s.height,v=s.latitude,m=v===void 0?0:v,E=s.longitude,A=E===void 0?0:E,F=s.zoom,B=F===void 0?0:F,V=s.pitch,j=V===void 0?0:V,nt=s.bearing,at=nt===void 0?0:nt,mt=s.altitude,Bt=mt===void 0?1.5:mt,de=s.nearZMultiplier,ce=s.farZMultiplier;(0,lt.Z)(this,l),o=o||1,h=h||1;var Be=k(B);Bt=Math.max(.75,Bt);var Xe=R([A,m],Be);Xe[2]=0;var _r=le({width:o,height:h,pitch:j,bearing:at,altitude:Bt,nearZMultiplier:de||1/h,farZMultiplier:ce||1.01}),Ir=vt({height:h,center:Xe,pitch:j,bearing:at,altitude:Bt,flipY:!0});return a=(0,P.Z)(this,(0,b.Z)(l).call(this,{width:o,height:h,viewMatrix:Ir,projectionMatrix:_r})),a.latitude=m,a.longitude=A,a.zoom=B,a.pitch=j,a.bearing=at,a.altitude=Bt,a.scale=Be,a.center=Xe,a.pixelsPerMeter=Q((0,st.Z)((0,st.Z)(a))).pixelsPerMeter[2],Object.freeze((0,st.Z)((0,st.Z)(a))),a}return(0,tt.Z)(l,[{key:"projectFlat",value:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return R(s,o)}},{key:"unprojectFlat",value:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return U(s,o)}},{key:"getMapCenterByLngLatPosition",value:function(s){var o=s.lngLat,h=s.pos,v=Ne(h,this.pixelUnprojectionMatrix),m=R(o,this.scale),E=ei.IH([],m,ei.tk([],v)),A=ei.IH([],this.center,E);return U(A,this.scale)}},{key:"getLocationAtPoint",value:function(s){var o=s.lngLat,h=s.pos;return this.getMapCenterByLngLatPosition({lngLat:o,pos:h})}},{key:"fitBounds",value:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=this.width,v=this.height,m=zr(Object.assign({width:h,height:v,bounds:s},o)),E=m.longitude,A=m.latitude,F=m.zoom;return new l({width:h,height:v,longitude:E,latitude:A,zoom:F})}}]),l}(Fr),nn=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"syncWithMapCamera",value:function(a){var s=a.center,o=a.zoom,h=a.pitch,v=a.bearing,m=a.viewportHeight,E=a.viewportWidth,A=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new pn((0,K.Z)((0,K.Z)({},A),{},{width:E,height:m,longitude:s&&s[0],latitude:s&&s[1],zoom:o,pitch:h,bearing:v}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(a,s){return this.viewport.projectFlat(a,s)}}]),n}(),Pn={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},Si=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],ha,wa,_o,Vn,Bi,fa,Ui,Ji,Fa,xo,Mo;function ao(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var o=l.head||l.getElementsByTagName("head")[0];if(!o){o=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(o,h):l.documentElement.appendChild(o)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),o.appendChild(v),v}}ao(`.amap-logo{
 display: none !important;
}
`);var Io={contextmenu:"rightclick"},hs=0;window.forceWebGL=!0;var tl="15cd8a57710d40c9b7c0e3cc120f1200",pl="1.4.15",pd="amap-script",iv=!1,jh=[],Dg=12,Bg=(ha=(0,Mt.b2)(),wa=(0,Mt.f3)(Dt.IGlobalConfigService),_o=(0,Mt.f3)(Dt.MapConfig),Vn=(0,Mt.f3)(Dt.ICoordinateSystemService),Bi=(0,Mt.f3)(Dt.IEventEmitter),ha(fa=(Ui=function(){function n(){var l=this;(0,lt.Z)(this,n),(0,W.Z)(this,"version",yu["GAODE1.x"]),(0,W.Z)(this,"simpleMapCoord",new LP),(0,W.Z)(this,"bgColor","rgba(0, 0, 0, 0)"),Ar(this,"configService",Ji,this),Ar(this,"config",Fa,this),Ar(this,"coordinateSystemService",xo,this),Ar(this,"eventEmitter",Mo,this),(0,W.Z)(this,"handleCameraChanged",function(a){var s=a.camera,o=s.fov,h=s.near,v=s.far,m=s.height,E=s.pitch,A=s.rotation,F=s.aspect,B=s.position,V=l.getCenter(),j=V.lng,nt=V.lat;if(l.emit("mapchange"),l.cameraChangedCallback){l.viewport.syncWithMapCamera({aspect:F,bearing:360-A,far:v,fov:o,cameraHeight:m,near:h,pitch:E,zoom:l.map.getZoom()-1,center:[j,nt],offsetOrigin:[B.x,B.y]});var at=l.config.offsetZoom,mt=at===void 0?Dg:at;l.viewport.getZoom()>mt?l.coordinateSystemService.setCoordinateSystem(Pl.P20_OFFSET):l.coordinateSystemService.setCoordinateSystem(Pl.P20),l.cameraChangedCallback(l.viewport)}})}return(0,tt.Z)(n,[{key:"setBgColor",value:function(a){this.bgColor=a}},{key:"addMarkerContainer",value:function(){var a=this.map.getContainer();if(a!==null){var s=a.getElementsByClassName("amap-maps")[0];this.markerContainer=_t("div","l7-marker-container",s)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(a,s){S1.indexOf(a)!==-1?this.eventEmitter.on(a,s):this.map.on(Io[a]||a,s)}},{key:"off",value:function(a,s){S1.indexOf(a)!==-1?this.eventEmitter.off(a,s):this.map.off(Io[a]||a,s)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var a;return(a=this.map.getContainer())===null||a===void 0?void 0:a.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var a=this.map.getSize();return[a.getWidth(),a.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(a){return this.map.setZoom(a+1)}},{key:"getCenter",value:function(a){if(a!=null&&a.padding){var s=this.getCenter(),o=PP(a.padding),h=this.lngLatToPixel([s.lng,s.lat]),v=[(o.right-o.left)/2,(o.bottom-o.top)/2],m=this.pixelToLngLat([h.x-v[0],h.y-v[1]]);return m}var E=this.map.getCenter();return{lng:E.getLng(),lat:E.getLat()}}},{key:"setCenter",value:function(a,s){if(s!=null&&s.padding){var o=PP(s.padding),h=this.lngLatToPixel(a),v=[(o.right-o.left)/2,(o.bottom-o.top)/2],m=this.pixelToLngLat([h.x+v[0],h.y+v[1]]);this.map.setCenter([m.lng,m.lat])}else this.map.setCenter(a)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var a=this.map.getBounds().toBounds(),s=a.getNorthEast(),o=a.getSouthWest(),h=this.getCenter(),v=h.lng>s.getLng()||h.lng<o.getLng()?180-s.getLng():s.getLng(),m=h.lng<o.getLng()?o.getLng()-180:o.getLng();return[[m,o.getLat()],[v,s.getLat()]]}},{key:"getMinZoom",value:function(){var a=this.map.get("zooms");return a[0]-1}},{key:"getMaxZoom",value:function(){var a=this.map.get("zooms");return a[1]-1}},{key:"setRotation",value:function(a){return this.map.setRotation(a)}},{key:"setPitch",value:function(a){return this.map.setPitch(a)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(a){this.map.panTo(a)}},{key:"panBy",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(a,s)}},{key:"fitBounds",value:function(a){this.map.setBounds(new AMap.Bounds([a[0][0],a[0][1],a[1][0],a[1][1]]))}},{key:"setZoomAndCenter",value:function(a,s){this.map.setZoomAndCenter(a+1,s)}},{key:"setMapStyle",value:function(a){this.map.setMapStyle(this.getMapStyleValue(a))}},{key:"setMapStatus",value:function(a){this.map.setStatus(a)}},{key:"getMapStyleConfig",value:function(){return Pn}},{key:"getMapStyleValue",value:function(a){return this.getMapStyleConfig()[a]||a}},{key:"getMapStyle",value:function(){return this.map.getMapStyle()}},{key:"pixelToLngLat",value:function(a){var s=this.map.pixelToLngLat(new AMap.Pixel(a[0],a[1]));return{lng:s.getLng(),lat:s.getLat()}}},{key:"lngLatToPixel",value:function(a){var s=this.map.lnglatToPixel(new AMap.LngLat(a[0],a[1]));return{x:s.getX(),y:s.getY()}}},{key:"containerToLngLat",value:function(a){var s=new AMap.Pixel(a[0],a[1]),o=this.map.containerToLngLat(s);return{lng:o==null?void 0:o.getLng(),lat:o==null?void 0:o.getLat()}}},{key:"lngLatToContainer",value:function(a){var s=new AMap.LngLat(a[0],a[1]),o=this.map.lngLatToContainer(s);return{x:o.getX(),y:o.getY()}}},{key:"lngLatToCoord",value:function(a){var s=this.map.lngLatToGeodeticCoord(a),o=s.x,h=s.y;return[o,-h]}},{key:"lngLatToMercator",value:function(a,s){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(a,s,o){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],v=this.viewport.projectFlat(a),m=Ke();return pr(m,m,wo.fromValues(v[0],v[1],s)),kr(m,m,wo.fromValues(h[0],h[1],h[2])),vr(m,m,o[0]),Qe(m,m,o[1]),Hr(m,m,o[2]),m}},{key:"init",value:function(){var l=(0,ut.Z)(it().mark(function s(){var o=this,h,v,m,E,A,F,B,V,j,nt,at,mt,Bt,de;return it().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return h=this.config,v=h.id,m=h.style,E=m===void 0?"light":m,A=h.minZoom,F=A===void 0?0:A,B=h.maxZoom,V=B===void 0?18:B,j=h.token,nt=j===void 0?tl:j,at=h.mapInstance,mt=h.plugin,Bt=mt===void 0?[]:mt,de=(0,Wl.Z)(h,Si),Be.next=3,new Promise(function(Xe){var _r=function(){if(at)o.map=at,o.$mapContainer=o.map.getContainer(),setTimeout(function(){o.map.on("camerachange",o.handleCameraChanged),Xe()},30);else{o.$mapContainer=o.creatMapContainer(v);var Nr=(0,K.Z)({mapStyle:o.getMapStyleValue(E),zooms:[F,V],viewMode:"3D"},de);Nr.zoom&&(Nr.zoom+=1);var Yr=new AMap.Map(o.$mapContainer,Nr);Yr.on("camerachange",o.handleCameraChanged),Yr.on("camerachange",function(){setTimeout(function(){return o.handleAfterMapChange()})}),o.map=Yr,setTimeout(function(){Xe()},10)}};!iv&&!at?(nt===tl&&console.warn("%c".concat(o.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),iv=!0,Bt.push("Map3D"),$A().load({key:nt,version:pl,plugins:Bt}).then(function(){_r(),jh.length&&(jh.forEach(function(Ir){return Ir()}),jh=[])}).catch(function(Ir){throw new Error(Ir)})):iv&&window.AMap||at?_r():jh.push(_r)});case 3:this.viewport=new nn;case 4:case"end":return Be.stop()}},s,this)}));function a(){return l.apply(this,arguments)}return a}()},{key:"meterToCoord",value:function(a,s){var o=AMap.GeometryUtil.distance($a(AMap.LngLat,(0,ge.Z)(a)),$a(AMap.LngLat,(0,ge.Z)(s))),h=this.lngLatToCoord(a),v=(0,ht.Z)(h,2),m=v[0],E=v[1],A=this.lngLatToCoord(s),F=(0,ht.Z)(A,2),B=F[0],V=F[1],j=Math.sqrt(Math.pow(m-B,2)+Math.pow(E-V,2));return j/o}},{key:"updateView",value:function(a){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(a){var s,o=(s=this.getContainer())===null||s===void 0?void 0:s.getElementsByClassName("amap-layer")[0],h=a==="jpg"?o==null?void 0:o.toDataURL("image/jpeg"):o==null?void 0:o.toDataURL("image/png");return h}},{key:"emit",value:function(a){for(var s,o=arguments.length,h=new Array(o>1?o-1:0),v=1;v<o;v++)h[v-1]=arguments[v];(s=this.eventEmitter).emit.apply(s,[a].concat(h))}},{key:"once",value:function(a){for(var s,o=arguments.length,h=new Array(o>1?o-1:0),v=1;v<o;v++)h[v-1]=arguments[v];(s=this.eventEmitter).once.apply(s,[a].concat(h))}},{key:"destroy",value:function(){var a,s;(a=this.$mapContainer)===null||a===void 0||(s=a.parentNode)===null||s===void 0||s.removeChild(this.$mapContainer),delete window.initAMap;var o=document.getElementById(pd);o&&document.head.removeChild(o),this.map.destroy()}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(a){this.cameraChangedCallback=a}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"creatMapContainer",value:function(a){var s=a;typeof a=="string"&&(s=document.getElementById(a));var o=document.createElement("div");return o.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,o.id="l7_amap_div"+hs++,s.appendChild(o),o}}]),n}(),Ji=Dr(Ui.prototype,"configService",[wa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fa=Dr(Ui.prototype,"config",[_o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xo=Dr(Ui.prototype,"coordinateSystemService",[Vn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mo=Dr(Ui.prototype,"eventEmitter",[Bi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ui))||fa),qA=function(){function n(){(0,lt.Z)(this,n),(0,W.Z)(this,"projectionMatrix",Ke()),(0,W.Z)(this,"viewMatrix",Ke()),(0,W.Z)(this,"viewProjectionMatrix",Ke()),(0,W.Z)(this,"ViewProjectionMatrixUncentered",Ke()),(0,W.Z)(this,"viewUncenteredMatrix",Ke())}return(0,tt.Z)(n,[{key:"syncWithMapCamera",value:function(a){var s=a.zoom,o=s===void 0?1:s,h=a.center,v=h===void 0?[0,0]:h,m=a.offsetOrigin,E=m===void 0?[0,0]:m,A=a.cameraPosition,F=A===void 0?[0,0,0]:A,B=a.up,V=B===void 0?[0,1,0]:B,j=a.lookAt,nt=j===void 0?[0,0,0]:j,at=a.aspect,mt=at===void 0?1:at,Bt=a.near,de=Bt===void 0?.1:Bt,ce=a.far,Be=ce===void 0?1e3:ce,Xe=a.fov,_r=Xe===void 0?45:Xe;this.zoom=o,this.center=v,Oc(this.projectionMatrix,_r/180*Math.PI,mt,de,Be);var Ir=wo.fromValues.apply(wo,(0,ge.Z)(F)),Nr=wo.fromValues.apply(wo,(0,ge.Z)(nt)),Yr=wo.fromValues.apply(wo,(0,ge.Z)(V));rh(this.viewMatrix,Ir,Nr,Yr),this.viewUncenteredMatrix=an(this.viewMatrix),pr(this.viewMatrix,this.viewMatrix,wo.fromValues(-E[0],E[1],0)),mr(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),mr(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var a=(0,ht.Z)(this.center,2),s=a[0],o=a[1];return[s,o]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(a){var s=85.0511287798,o=Math.max(Math.min(s,a[1]),-s),h=256<<20,v=Math.PI/180,m=a[0]*v,E=o*v;E=Math.log(Math.tan(Math.PI/4+E/2));var A=.5/Math.PI,F=.5,B=-.5/Math.PI;return v=.5,m=h*(A*m+F)-215440491,E=-(h*(B*E+v)-106744817),[m,E]}}]),n}(),OP=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],KA,Qb;function Jb(n){var l=QA();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function QA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function FP(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var o=l.head||l.getElementsByTagName("head")[0];if(!o){o=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(o,h):l.documentElement.appendChild(o)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),o.appendChild(v),v}}FP(`.amap-logo{
 display: none !important;
}
`);var D_=[108.92361,34.54083];window.forceWebGL=!0;var JA="ff533602d57df6f8ab3b0fea226ae52f",B_="2.0",tT=!1,BR=null,RP=(KA=(0,Mt.b2)(),KA(Qb=function(n){(0,Ut.Z)(a,n);var l=Jb(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"version",yu["GAODE2.x"]),(0,W.Z)((0,st.Z)(s),"handleViewChanged",function(m){var E=s.map.customCoords.getCameraParams(),A=E.fov,F=E.near,B=E.far,V=E.aspect,j=E.position,nt=E.lookAt,at=E.up;s.emit("mapchange");var mt=s.map.customCoords.getCenter();s.cameraChangedCallback&&(s.viewport.syncWithMapCamera({aspect:V,far:B,fov:A,cameraPosition:j,lookAt:nt,up:at,near:F,zoom:s.map.getZoom()-1,center:mt,offsetOrigin:[j[0],j[1]]}),s.coordinateSystemService.setCoordinateSystem(Pl.P20_2),s.cameraChangedCallback(s.viewport))}),s}return(0,tt.Z)(a,[{key:"setCustomCoordCenter",value:function(o){this.sceneCenter=o,this.sceneCenterMKT=xl.apply(void 0,(0,ge.Z)(o))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoordByLayer",value:function(o,h){var v=h||this.sceneCenter,m=xl.apply(void 0,(0,ge.Z)(v)),E=this._sub(xl(o[0],o[1]),m);return o[2]&&E.push(o[2]),E}},{key:"lngLatToCoordsByLayer",value:function(o,h){var v=this;return o.map(function(m){return typeof m[0]=="number"?v.lngLatToCoordByLayer(m,h):m.map(function(E){return v.lngLatToCoordByLayer(E,h)})})}},{key:"setCoordCenter",value:function(o){this.map.customCoords.setCenter(o||D_),this.setCustomCoordCenter(o||D_)}},{key:"lngLatToCoord",value:function(o){return this.sceneCenter||(this.map.customCoords.setCenter(o),this.setCustomCoordCenter(o)),this._sub(xl(o[0],o[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(o){var h=this;return o.map(function(v){return typeof v[0]=="number"?h.lngLatToCoord(v):v.map(function(m){return h.lngLatToCoord(m)})})}},{key:"addMarkerContainer",value:function(){if(!!this.map){var o=this.map.getContainer();if(o!==null){var h=o.getElementsByClassName("amap-maps")[0];h.style.zIndex="auto",this.markerContainer=_t("div","l7-marker-container2",h)}}}},{key:"updateView",value:function(o){}},{key:"getOverlayContainer",value:function(){}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var o=this.map.getBounds(),h=o.getNorthEast(),v=o.getSouthWest(),m=this.getCenter(),E=m.lng>h.getLng()||m.lng<v.getLng()?180-h.getLng():h.getLng(),A=m.lng<v.getLng()?v.getLng()-180:v.getLng();return[[A,v.getLat()],[E,h.getLat()]]}},{key:"getMinZoom",value:function(){var o=this.map.getZooms();return o[0]-1}},{key:"getMaxZoom",value:function(){var o=this.map.getZooms();return o[1]-1}},{key:"lngLatToContainer",value:function(o){var h=this.map.lngLatToContainer(o);return{x:h.getX(),y:h.getY()}}},{key:"getModelMatrix",value:function(o,h,v){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],E=this.map.customCoords.lngLatToCoord(o),A=Ke();return pr(A,A,wo.fromValues(E[0],E[1],h)),kr(A,A,wo.fromValues(m[0],m[1],m[2])),vr(A,A,v[0]),Qe(A,A,v[1]),Hr(A,A,v[2]),A}},{key:"init",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,nt,at,mt,Bt,de,ce,Be,Xe,_r,Ir,Nr,Yr,yn,fn;return it().wrap(function(di){for(;;)switch(di.prev=di.next){case 0:if(v=this.config,m=v.id,E=v.style,A=E===void 0?"light":E,F=v.minZoom,B=F===void 0?0:F,V=v.maxZoom,j=V===void 0?18:V,nt=v.token,at=nt===void 0?JA:nt,mt=v.mapInstance,Bt=v.plugin,de=Bt===void 0?[]:Bt,ce=v.version,Be=ce===void 0?B_:ce,Xe=(0,Wl.Z)(v,OP),this.viewport=new qA,window.AMap||mt){di.next=6;break}return de.push("Map3D"),di.next=6,$A().load({key:at,version:B_,plugins:de});case 6:mt?(this.map=mt,this.$mapContainer=this.map.getContainer(),Ir=this.map.getCenter(),(_r=this.map.customCoords)===null||_r===void 0||_r.setCenter([Ir.lng,Ir.lat]),this.setCustomCoordCenter([Ir.lng,Ir.lat]),this.map.on("viewchange",this.handleViewChanged)):(this.$mapContainer=this.creatMapContainer(m),Yr=(0,K.Z)({mapStyle:this.getMapStyleValue(A),zooms:[B,j],viewMode:"3D"},Xe),Yr.zoom&&(Yr.zoom+=1),at===JA&&console.warn("%c".concat(this.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),yn=new AMap.Map(this.$mapContainer,Yr),this.map=yn,fn=yn.getCenter(),(Nr=this.map.customCoords)===null||Nr===void 0||Nr.setCenter([fn.lng,fn.lat]),this.setCustomCoordCenter([fn.lng,fn.lat]),yn.on("viewchange",this.handleViewChanged)),this.initViewPort();case 8:case"end":return di.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(o){this.cameraChangedCallback=o}},{key:"initViewPort",value:function(){var o,h=(o=this.map.customCoords)===null||o===void 0?void 0:o.getCameraParams(),v=h.fov,m=h.near,E=h.far,A=h.aspect,F=h.position,B=h.lookAt,V=h.up;this.emit("mapchange");var j=this.map.customCoords.getCenter(),nt=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:A,far:E,fov:v,cameraPosition:F,lookAt:B,near:m,up:V,zoom:nt-1,center:j,offsetOrigin:[F[0],F[1]]}),this.coordinateSystemService.setCoordinateSystem(Pl.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(o,h){var v=[0,0];return v[0]=o[0]-h[0],v[1]=o[1]-h[1],v}}]),a}(Bg))||Qb);function Kv(n){var l=DP();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function DP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dd=function(n){(0,Ut.Z)(a,n);var l=Kv(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getServiceConstructor",value:function(){return RP}}]),a}(YA),Dm=ot(6158),t2=ot.n(Dm),NR={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},IF,kF,LF,PF,OF,FF,N_,RF,DF,BF,NF,zF={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},zR=12,UR=(IF=(0,Mt.b2)(),kF=(0,Mt.f3)(Dt.MapConfig),LF=(0,Mt.f3)(Dt.IGlobalConfigService),PF=(0,Mt.f3)(Dt.ICoordinateSystemService),OF=(0,Mt.f3)(Dt.IEventEmitter),IF(FF=(N_=function(){function n(){var l=this;(0,lt.Z)(this,n),(0,W.Z)(this,"version",yu.DEFUALT),(0,W.Z)(this,"simpleMapCoord",new LP),(0,W.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),Ar(this,"config",RF,this),Ar(this,"configService",DF,this),Ar(this,"coordinateSystemService",BF,this),Ar(this,"eventEmitter",NF,this),(0,W.Z)(this,"handleCameraChanged",function(a){var s=l.map.getCenter(),o=s.lat,h=s.lng;l.emit("mapchange"),l.viewport.syncWithMapCamera({bearing:l.map.getBearing(),center:[h,o],viewportHeight:l.map.transform.height,pitch:l.map.getPitch(),viewportWidth:l.map.transform.width,zoom:l.map.getZoom(),cameraHeight:0}),l.updateCoordinateSystemService(),l.cameraChangedCallback(l.viewport)})}return(0,tt.Z)(n,[{key:"setBgColor",value:function(a){this.bgColor=a}},{key:"addMarkerContainer",value:function(){var a=this.map.getCanvasContainer();this.markerContainer=_t("div","l7-marker-container",a),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"getOverlayContainer",value:function(){}},{key:"on",value:function(a,s){S1.indexOf(a)!==-1?this.eventEmitter.on(a,s):this.map.on(zF[a]||a,s)}},{key:"off",value:function(a,s){this.map.off(zF[a]||a,s),this.eventEmitter.off(a,s)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){if(this.version===yu.SIMPLE)return this.simpleMapCoord.getSize();var a=this.map.transform;return[a.width,a.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(a){return this.map.setZoom(a)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(a){this.map.setCenter(a)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(a){this.map.setBearing(a)}},{key:"zoomIn",value:function(a,s){this.map.zoomIn(a,s)}},{key:"zoomOut",value:function(a,s){this.map.zoomOut(a,s)}},{key:"setPitch",value:function(a){return this.map.setPitch(a)}},{key:"panTo",value:function(a){this.map.panTo(a)}},{key:"panBy",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.panTo([a,s])}},{key:"fitBounds",value:function(a,s){this.map.fitBounds(a,s)}},{key:"setMaxZoom",value:function(a){this.map.setMaxZoom(a)}},{key:"setMinZoom",value:function(a){this.map.setMinZoom(a)}},{key:"setMapStatus",value:function(a){a.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),a.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),a.dragEnable===!1&&this.map.dragPan.disable(),a.dragEnable===!0&&this.map.dragPan.enable(),a.rotateEnable===!1&&this.map.dragRotate.disable(),a.dragEnable===!0&&this.map.dragRotate.enable(),a.keyboardEnable===!1&&this.map.keyboard.disable(),a.keyboardEnable===!0&&this.map.keyboard.enable(),a.zoomEnable===!1&&this.map.scrollZoom.disable(),a.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(a,s){this.map.flyTo({zoom:a,center:s})}},{key:"setMapStyle",value:function(a){this.map.setStyle(this.getMapStyleValue(a))}},{key:"meterToCoord",value:function(a,s){return 1}},{key:"pixelToLngLat",value:function(a){return this.map.unproject(a)}},{key:"lngLatToPixel",value:function(a){return this.map.project(a)}},{key:"containerToLngLat",value:function(a){return this.map.unproject(a)}},{key:"lngLatToContainer",value:function(a){return this.map.project(a)}},{key:"getMapStyle",value:function(){try{var a,s=(a=this.map.getStyle().sprite)!==null&&a!==void 0?a:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(s)?s==null?void 0:s.replace(/\/\w+$/,"").replace(/sprites/,"styles"):s}catch(o){return""}}},{key:"getMapStyleConfig",value:function(){return NR}},{key:"getMapStyleValue",value:function(a){var s;return(s=this.getMapStyleConfig()[a])!==null&&s!==void 0?s:a}},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(a){for(var s,o=arguments.length,h=new Array(o>1?o-1:0),v=1;v<o;v++)h[v-1]=arguments[v];(s=this.eventEmitter).emit.apply(s,[a].concat(h))}},{key:"once",value:function(a){for(var s,o=arguments.length,h=new Array(o>1?o-1:0),v=1;v<o;v++)h[v-1]=arguments[v];(s=this.eventEmitter).once.apply(s,[a].concat(h))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(a){var s=this.map.getCanvas(),o=a==="jpg"?s==null?void 0:s.toDataURL("image/jpeg"):s==null?void 0:s.toDataURL("image/png");return o}},{key:"onCameraChanged",value:function(a){this.cameraChangedCallback=a}},{key:"creatMapContainer",value:function(a){var s=a;return typeof a=="string"&&(s=document.getElementById(a)),s}},{key:"updateView",value:function(a){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:a.bearing,center:a.center,viewportHeight:a.viewportHeight,pitch:a.pitch,viewportWidth:a.viewportWidth,zoom:a.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}},{key:"updateCoordinateSystemService",value:function(){var a=this.config.offsetCoordinate,s=a===void 0?!0:a;this.viewport.getZoom()>zR&&s?this.coordinateSystemService.setCoordinateSystem(Pl.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(Pl.LNGLAT)}}]),n}(),RF=Dr(N_.prototype,"config",[kF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DF=Dr(N_.prototype,"configService",[LF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BF=Dr(N_.prototype,"coordinateSystemService",[PF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NF=Dr(N_.prototype,"eventEmitter",[OF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N_))||FF),ZR=function(){function n(){(0,lt.Z)(this,n)}return(0,tt.Z)(n,[{key:"syncWithMapCamera",value:function(a){var s=a.center,o=a.zoom,h=a.pitch,v=a.bearing,m=a.viewportHeight,E=a.viewportWidth;this.viewport=new pn({width:E,height:m,longitude:s&&s[0],latitude:s&&s[1],zoom:o,pitch:h,bearing:v})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(a,s){return this.viewport.projectFlat(a,s)}}]),n}(),VR=["id","attributionControl","style","token","rotation","mapInstance"],UF,ZF;function GR(n){var l=HR();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function HR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function jR(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var o=l.head||l.getElementsByTagName("head")[0];if(!o){o=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(o,h):l.documentElement.appendChild(o)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),o.appendChild(v),v}}jR(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=t2();var WR=0,VF="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg",XR=(UF=(0,Mt.b2)(),UF(ZF=function(n){(0,Ut.Z)(a,n);var l=GR(a);function a(){var s;(0,lt.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,st.Z)(s),"version",yu.MAPBOX),s}return(0,tt.Z)(a,[{key:"getType",value:function(){return"mapbox"}},{key:"lngLatToCoord",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},v=this.lngLatToMercator(o,0),m=v.x,E=v.y;return[m-h.x,E-h.y]}},{key:"lngLatToMercator",value:function(o,h){var v=window.mapboxgl.MercatorCoordinate.fromLngLat(o,h),m=v.x,E=m===void 0?0:m,A=v.y,F=A===void 0?0:A,B=v.z,V=B===void 0?0:B;return{x:E,y:F,z:V}}},{key:"getModelMatrix",value:function(o,h,v){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},A=window.mapboxgl.MercatorCoordinate.fromLngLat(o,h),F=A.meterInMercatorCoordinateUnits(),B=Ke();return pr(B,B,wo.fromValues(A.x-E.x,A.y-E.y,A.z||0-E.z)),kr(B,B,wo.fromValues(F*m[0],-F*m[1],F*m[2])),vr(B,B,v[0]),Qe(B,B,v[1]),Hr(B,B,v[2]),B}},{key:"init",value:function(){var s=(0,ut.Z)(it().mark(function h(){var v=this,m,E,A,F,B,V,j,nt,at,mt,Bt,de,ce;return it().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:m=this.config,E=m.id,A=E===void 0?"map":E,F=m.attributionControl,B=F===void 0?!1:F,V=m.style,j=V===void 0?"light":V,nt=m.token,at=nt===void 0?VF:nt,mt=m.rotation,Bt=mt===void 0?0:mt,de=m.mapInstance,ce=(0,Wl.Z)(m,VR),this.viewport=new ZR,!de&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),at===VF&&j!=="blank"&&!window.mapboxgl.accessToken&&!de&&console.warn(this.configService.getSceneWarninfo("MapToken")),!de&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=at),de?(this.map=de,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatMapContainer(A),this.map=new window.mapboxgl.Map((0,K.Z)({container:this.$mapContainer,style:this.getMapStyleValue(j),attributionControl:B,bearing:Bt},ce))),this.map.on("load",function(){v.handleCameraChanged()}),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return Xe.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"destroy",value:function(){var o,h;(o=this.$mapContainer)===null||o===void 0||(h=o.parentNode)===null||h===void 0||h.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(o){for(var h,v=arguments.length,m=new Array(v>1?v-1:0),E=1;E<v;E++)m[E-1]=arguments[E];(h=this.eventEmitter).emit.apply(h,[o].concat(m))}},{key:"once",value:function(o){for(var h,v=arguments.length,m=new Array(v>1?v-1:0),E=1;E<v;E++)m[E-1]=arguments[E];(h=this.eventEmitter).once.apply(h,[o].concat(m))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"meterToCoord",value:function(o,h){var v=new(t2()).LngLat(o[0],o[1]),m=new(t2()).LngLat(h[0],h[1]),E=v.distanceTo(m),A=t2().MercatorCoordinate.fromLngLat({lng:o[0],lat:o[1]}),F=t2().MercatorCoordinate.fromLngLat({lng:h[0],lat:h[1]}),B=A.x,V=A.y,j=F.x,nt=F.y,at=Math.sqrt(Math.pow(B-j,2)+Math.pow(V-nt,2))*4194304*2;return at/E}},{key:"exportMap",value:function(o){var h=this.map.getCanvas(),v=o==="jpg"?h==null?void 0:h.toDataURL("image/jpeg"):h==null?void 0:h.toDataURL("image/png");return v}},{key:"creatMapContainer",value:function(o){var h=o;typeof o=="string"&&(h=document.getElementById(o));var v=document.createElement("div");return v.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,v.id="l7_mapbox_div"+WR++,h.appendChild(v),v}}]),a}(UR))||ZF);function YR(n){var l=$R();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function $R(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function qR(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var o=l.head||l.getElementsByTagName("head")[0];if(!o){o=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(o,h):l.documentElement.appendChild(o)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),o.appendChild(v),v}}qR(`.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var KR=function(n){(0,Ut.Z)(a,n);var l=YR(a);function a(){return(0,lt.Z)(this,a),l.apply(this,arguments)}return(0,tt.Z)(a,[{key:"getServiceConstructor",value:function(){return XR}}]),a}(YA),eT=ot(90494),ph=ot(45442),BP={fontFamily:`
  "-apple-system", BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`},NP="l7plot-tooltip",zP="l7plot-tooltip__title",UP="l7plot-tooltip__list",GF="l7plot-tooltip__list-item",HF="l7plot-tooltip__name",jF="l7plot-tooltip__value",QR='<div class="'.concat(NP,`">
  <div class="`).concat(zP,`"></div>
  <ul class="`).concat(UP,`"></ul>
</div>`),WF='<li class="'.concat(GF,`" data-index={index}>
  <span class="`).concat(HF,`">{name}</span>
  <span class="`).concat(jF,`">{value}</span>
</li>`),Ng,JR=(Ng={},Ng[NP]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:BP.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},Ng[zP]={marginBottom:"4px"},Ng[UP]={margin:"0px",listStyleType:"none",padding:"0px"},Ng[GF]={listStyleType:"none",marginBottom:"4px",whiteSpace:"nowrap",display:"flex",justifyContent:"space-between"},Ng[HF]={},Ng[jF]={marginLeft:"30px"},Ng),t6=ot(6056);function e6(n,l){return!!n.className.match(new RegExp("(\\s|^)".concat(l,"(\\s|$)")))}function ZP(n){for(var l=n.childNodes,a=l.length,s=a-1;s>=0;s--)n.removeChild(l[s])}var VP=function(){function n(l){this.destroyed=!1,this.options=(0,xt.b$)({},this.getDefaultOptions(),l),this.container=this.initContainer(),this.initDom(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible(),this.render()}return n.prototype.getDefaultOptions=function(){return{name:"",containerTpl:"<div></div>",visible:!0,capture:!0,domStyles:{}}},n.prototype.getContainer=function(){return this.container},n.prototype.getParentContainer=function(){var l=this.options.parent,a;if(!l)return a;if((0,xt.HD)(l)){var s=document.getElementById(l);if(s)a=s;else throw new Error("No parent id ".concat(l))}else a=l;return a},n.prototype.initContainer=function(){var l=this.createDom(this.options.containerTpl),a=this.getParentContainer();return a&&a.appendChild(l),l},n.prototype.initVisible=function(){this.options.visible?this.show():this.hide()},n.prototype.initCapture=function(){this.setCapture(this.options.capture)},n.prototype.update=function(l){this.options=(0,xt.b$)({},this.options,l),this.updateInner(l),this.afterUpdate(l)},n.prototype.updateInner=function(l){l.domStyles&&this.applyStyles()},n.prototype.afterUpdate=function(l){l.capture&&this.setCapture(l.capture)},n.prototype.setCapture=function(l){var a=this.container,s=l?"auto":"none";a.style.pointerEvents=s},n.prototype.applyStyles=function(){var l=this.options.domStyles;if(!!l){var a=this.container;this.applyChildrenStyles(a,l);var s=this.options.className;if(s&&e6(a,s)){var o=l[s];(0,ph.Z)(a,o)}}},n.prototype.applyChildrenStyles=function(l,a){(0,xt.S6)(a,function(s,o){var h=l.getElementsByClassName(o);(0,xt.S6)(h,function(v){(0,ph.Z)(v,s)})})},n.prototype.applyStyle=function(l,a){var s=this.options.domStyles;s&&(0,ph.Z)(a,s[l])},n.prototype.createDom=function(l){return l===void 0&&(l="<div></div>"),(0,t6.Z)(l)},n.prototype.removeDom=function(){var l=this.container;l&&l.parentNode&&l.parentNode.removeChild(l)},n.prototype.destroy=function(){this.removeEvent(),this.removeDom(),this.destroyed=!0},n}(),r6=function(n){(0,I.ZT)(l,n);function l(){return n!==null&&n.apply(this,arguments)||this}return l.prototype.getDefaultOptions=function(){return(0,xt.b$)({},n.prototype.getDefaultOptions.call(this),{id:"l7plot-tooltip",name:"l7plot-tooltip",title:"",showTitle:!0,items:[],containerTpl:QR,itemTpl:WF,domStyles:JR,className:NP})},l.prototype.initContainer=function(){var a=this.options.customContent;if(a){var s=this.getHtmlContentNode(a),o=this.getParentContainer();return o&&o.appendChild(s),s}else return n.prototype.initContainer.call(this)},l.prototype.initDom=function(){this.cacheDoms()},l.prototype.initEvent=function(){},l.prototype.removeEvent=function(){},l.prototype.cacheDoms=function(){var a=this.container,s=a.getElementsByClassName(zP)[0],o=a.getElementsByClassName(UP)[0];this.titleDom=s,this.listDom=o},l.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},l.prototype.show=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"visible"})},l.prototype.hide=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"hidden"})},l.prototype.updateInner=function(a){this.options.customContent?this.renderCustomContent(this.options.customContent):(a.title&&this.resetTitle(),a.items&&this.renderItems()),n.prototype.updateInner.call(this,a)},l.prototype.renderCustomContent=function(a){var s=this.container.parentNode,o=this.getHtmlContentNode(a),h=this.container;s&&s.replaceChild(o,h),this.container=o,this.applyStyles()},l.prototype.getHtmlContentNode=function(a){var s,o=a(this.options.title||"",this.options.items);return(0,xt.HD)(o)?s=this.createDom(o):s=o,s},l.prototype.resetTitle=function(){var a=this.options.title,s=this.options.showTitle;s&&a?(this.showTitle(),this.setTitle(a)):this.hideTitle()},l.prototype.showTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"block"})},l.prototype.hideTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"none"})},l.prototype.setTitle=function(a){var s=this.titleDom;s&&(s.innerHTML=a)},l.prototype.renderItems=function(){var a=this;this.clearItemDoms();var s=this.options.items,o=this.options.itemTpl||WF,h=this.listDom;h&&(s.forEach(function(v){var m=(0,I.pi)({},v),E=(0,xt.ng)(o,m),A=a.createDom(E);h.appendChild(A)}),this.applyChildrenStyles(h,this.options.domStyles))},l.prototype.clearItemDoms=function(){this.listDom&&ZP(this.listDom)},l.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},l}(VP),n6=Array.isArray,GP=n6,i6=typeof global=="object"&&global&&global.Object===Object&&global,a6=i6,o6=typeof self=="object"&&self&&self.Object===Object&&self,s6=a6||o6||Function("return this")(),rT=s6,u6=rT.Symbol,z_=u6,XF=Object.prototype,l6=XF.hasOwnProperty,c6=XF.toString,e2=z_?z_.toStringTag:void 0;function f6(n){var l=l6.call(n,e2),a=n[e2];try{n[e2]=void 0;var s=!0}catch(h){}var o=c6.call(n);return s&&(l?n[e2]=a:delete n[e2]),o}var h6=f6,p6=Object.prototype,d6=p6.toString;function v6(n){return d6.call(n)}var g6=v6,m6="[object Null]",y6="[object Undefined]",YF=z_?z_.toStringTag:void 0;function _6(n){return n==null?n===void 0?y6:m6:YF&&YF in Object(n)?h6(n):g6(n)}var $F=_6;function x6(n){return n!=null&&typeof n=="object"}var b6=x6,E6="[object Symbol]";function S6(n){return typeof n=="symbol"||b6(n)&&$F(n)==E6}var nT=S6,w6=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,C6=/^\w*$/;function A6(n,l){if(GP(n))return!1;var a=typeof n;return a=="number"||a=="symbol"||a=="boolean"||n==null||nT(n)?!0:C6.test(n)||!w6.test(n)||l!=null&&n in Object(l)}var T6=A6;function M6(n){var l=typeof n;return n!=null&&(l=="object"||l=="function")}var iT=M6,I6="[object AsyncFunction]",k6="[object Function]",L6="[object GeneratorFunction]",P6="[object Proxy]";function O6(n){if(!iT(n))return!1;var l=$F(n);return l==k6||l==L6||l==I6||l==P6}var F6=O6,R6=rT["__core-js_shared__"],HP=R6,qF=function(){var n=/[^.]+$/.exec(HP&&HP.keys&&HP.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function D6(n){return!!qF&&qF in n}var B6=D6,N6=Function.prototype,z6=N6.toString;function U6(n){if(n!=null){try{return z6.call(n)}catch(l){}try{return n+""}catch(l){}}return""}var Z6=U6,V6=/[\\^$.*+?()[\]{}|]/g,G6=/^\[object .+?Constructor\]$/,H6=Function.prototype,j6=Object.prototype,W6=H6.toString,X6=j6.hasOwnProperty,Y6=RegExp("^"+W6.call(X6).replace(V6,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $6(n){if(!iT(n)||B6(n))return!1;var l=F6(n)?Y6:G6;return l.test(Z6(n))}var q6=$6;function K6(n,l){return n==null?void 0:n[l]}var Q6=K6;function J6(n,l){var a=Q6(n,l);return q6(a)?a:void 0}var KF=J6,tD=KF(Object,"create"),r2=tD;function eD(){this.__data__=r2?r2(null):{},this.size=0}var rD=eD;function nD(n){var l=this.has(n)&&delete this.__data__[n];return this.size-=l?1:0,l}var iD=nD,aD="__lodash_hash_undefined__",oD=Object.prototype,sD=oD.hasOwnProperty;function uD(n){var l=this.__data__;if(r2){var a=l[n];return a===aD?void 0:a}return sD.call(l,n)?l[n]:void 0}var lD=uD,cD=Object.prototype,fD=cD.hasOwnProperty;function hD(n){var l=this.__data__;return r2?l[n]!==void 0:fD.call(l,n)}var pD=hD,dD="__lodash_hash_undefined__";function vD(n,l){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=r2&&l===void 0?dD:l,this}var gD=vD;function U_(n){var l=-1,a=n==null?0:n.length;for(this.clear();++l<a;){var s=n[l];this.set(s[0],s[1])}}U_.prototype.clear=rD,U_.prototype.delete=iD,U_.prototype.get=lD,U_.prototype.has=pD,U_.prototype.set=gD;var QF=U_;function mD(){this.__data__=[],this.size=0}var yD=mD;function _D(n,l){return n===l||n!==n&&l!==l}var xD=_D;function bD(n,l){for(var a=n.length;a--;)if(xD(n[a][0],l))return a;return-1}var aT=bD,ED=Array.prototype,SD=ED.splice;function wD(n){var l=this.__data__,a=aT(l,n);if(a<0)return!1;var s=l.length-1;return a==s?l.pop():SD.call(l,a,1),--this.size,!0}var CD=wD;function AD(n){var l=this.__data__,a=aT(l,n);return a<0?void 0:l[a][1]}var TD=AD;function MD(n){return aT(this.__data__,n)>-1}var ID=MD;function kD(n,l){var a=this.__data__,s=aT(a,n);return s<0?(++this.size,a.push([n,l])):a[s][1]=l,this}var LD=kD;function Z_(n){var l=-1,a=n==null?0:n.length;for(this.clear();++l<a;){var s=n[l];this.set(s[0],s[1])}}Z_.prototype.clear=yD,Z_.prototype.delete=CD,Z_.prototype.get=TD,Z_.prototype.has=ID,Z_.prototype.set=LD;var PD=Z_,OD=KF(rT,"Map"),FD=OD;function RD(){this.size=0,this.__data__={hash:new QF,map:new(FD||PD),string:new QF}}var DD=RD;function BD(n){var l=typeof n;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?n!=="__proto__":n===null}var ND=BD;function zD(n,l){var a=n.__data__;return ND(l)?a[typeof l=="string"?"string":"hash"]:a.map}var oT=zD;function UD(n){var l=oT(this,n).delete(n);return this.size-=l?1:0,l}var ZD=UD;function VD(n){return oT(this,n).get(n)}var GD=VD;function HD(n){return oT(this,n).has(n)}var jD=HD;function WD(n,l){var a=oT(this,n),s=a.size;return a.set(n,l),this.size+=a.size==s?0:1,this}var XD=WD;function V_(n){var l=-1,a=n==null?0:n.length;for(this.clear();++l<a;){var s=n[l];this.set(s[0],s[1])}}V_.prototype.clear=DD,V_.prototype.delete=ZD,V_.prototype.get=GD,V_.prototype.has=jD,V_.prototype.set=XD;var JF=V_,YD="Expected a function";function jP(n,l){if(typeof n!="function"||l!=null&&typeof l!="function")throw new TypeError(YD);var a=function(){var s=arguments,o=l?l.apply(this,s):s[0],h=a.cache;if(h.has(o))return h.get(o);var v=n.apply(this,s);return a.cache=h.set(o,v)||h,v};return a.cache=new(jP.Cache||JF),a}jP.Cache=JF;var $D=jP,qD=500;function KD(n){var l=$D(n,function(s){return a.size===qD&&a.clear(),s}),a=l.cache;return l}var QD=KD,JD=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t7=/\\(\\)?/g,e7=QD(function(n){var l=[];return n.charCodeAt(0)===46&&l.push(""),n.replace(JD,function(a,s,o,h){l.push(o?h.replace(t7,"$1"):s||a)}),l}),r7=e7;function n7(n,l){for(var a=-1,s=n==null?0:n.length,o=Array(s);++a<s;)o[a]=l(n[a],a,n);return o}var i7=n7,a7=1/0,tR=z_?z_.prototype:void 0,eR=tR?tR.toString:void 0;function rR(n){if(typeof n=="string")return n;if(GP(n))return i7(n,rR)+"";if(nT(n))return eR?eR.call(n):"";var l=n+"";return l=="0"&&1/n==-a7?"-0":l}var o7=rR;function s7(n){return n==null?"":o7(n)}var WP=s7;function u7(n,l){return GP(n)?n:T6(n,l)?[n]:r7(WP(n))}var l7=u7,c7=1/0;function f7(n){if(typeof n=="string"||nT(n))return n;var l=n+"";return l=="0"&&1/n==-c7?"-0":l}var h7=f7;function p7(n,l){l=l7(l,n);for(var a=0,s=l.length;n!=null&&a<s;)n=n[h7(l[a++])];return a&&a==s?n:void 0}var d7=p7;function v7(n,l,a){var s=n==null?void 0:d7(n,l);return s===void 0?a:s}var nR=v7,g7=5,m7=new Object().toString,iR=function(n,l){return m7.call(n)==="[object "+l+"]"},y7=function(n){return iR(n,"Array")},_7=function(n){return typeof n=="object"&&n!==null},aR=function(n){if(!_7(n)||!iR(n,"Object"))return!1;for(var l=n;Object.getPrototypeOf(l)!==null;)l=Object.getPrototypeOf(l);return Object.getPrototypeOf(n)===l},oR=function(n,l,a,s){a=a||0,s=s||g7;for(var o in l)if(Object.prototype.hasOwnProperty.call(l,o)){var h=l[o];h?aR(h)?(aR(n[o])||(n[o]={}),a<s?oR(n[o],h,a+1,s):n[o]=l[o]):y7(h)?(n[o]=[],n[o]=n[o].concat(h)):n[o]=h:n[o]=h}},Ip=function(n){for(var l=[],a=1;a<arguments.length;a++)l[a-1]=arguments[a];for(var s=0;s<l.length;s+=1)oR(n,l[s]);return n},x7=["mousemove","click"],b7=function(n){(0,I.ZT)(l,n);function l(a,s,o){var h=n.call(this)||this;h.currentVisible=!1,h.interactionTriggerHander=function(nt){var at=nt.feature,mt=nt.featureId,Bt=h.options,de=Bt.title,ce=Bt.customTitle,Be=Bt.items,Xe=Bt.customItems,_r=at.type==="Feature"&&at.geometry&&at.properties,Ir=_r?at.properties:at,Nr=[];if(Xe){var Yr=Xe(at);if(Array.isArray(Yr))Nr=Yr;else throw new Error("customItems return array")}else Be&&Be.forEach(function(fn){if((0,xt.HD)(fn)){var $n=fn.split(".").pop()||fn,di=nR(Ir,fn);di!==void 0&&Nr.push({name:$n,value:di})}else{var Yi=fn.field,ho=fn.alias,zo=fn.customValue,Vs=ho||Yi.split(".").pop()||Yi,di=nR(Ir,Yi);di!==void 0&&Nr.push({name:Vs,value:zo?zo(di,Ir,mt):di})}});var yn={title:ce?ce(Ir):de,items:Nr};h.updateTooltip(nt,yn)},h.interactionUntriggerHander=function(){h.hideTooltip()},h.scene=a,h.interactionLayers=s,h.options=Ip({},h.getDefaultOptions(),o);var v=h.options,m=v.offsets,E=v.title,A=v.showTitle,F=v.customContent,B=v.domStyles,V=v.anchor,j=v.className;return h.marker=new w1({offsets:m,anchor:V,draggable:!1}),h.tooltipComponent=new r6({title:E,showTitle:A,items:[],customContent:F,domStyles:B,className:j}),h.setComponent(),h.initInteractionEvent(),h}return l.prototype.getDefaultOptions=function(){return{showTitle:!0,showComponent:!0,items:[],offsets:[15,0],trigger:"mousemove",anchor:rr["TOP-LEFT"]}},l.prototype.update=function(a){this.marker.remove(),this.currentVisible=!1,this.options=Ip({},this.options,a);var s=this.options,o=s.offsets,h=s.showTitle,v=s.customContent,m=s.domStyles,E=s.anchor,A=s.className;this.marker=new w1({offsets:o,anchor:E,draggable:!1}),this.tooltipComponent.update({showTitle:h,customContent:v,domStyles:m,className:A}),this.setComponent()},l.prototype.initInteractionEvent=function(){var a=this,s=this.options.trigger||"mousemove";if(!x7.includes(s))throw new Error("trigger is mousemove or click");this.interactionLayers.forEach(function(o){var h=o.layer;h.on(s,a.interactionTriggerHander),h.on("un".concat(s),a.interactionUntriggerHander)})},l.prototype.unBindInteractionEvent=function(){var a=this,s=this.options.trigger||"mousemove";this.interactionLayers.forEach(function(o){var h=o.layer;h.off(s,a.interactionTriggerHander),h.off("un".concat(s),a.interactionUntriggerHander)})},l.prototype.updateTooltip=function(a,s){var o=a.lngLat,h=a.x,v=a.y;if(this.options.showComponent&&(this.updateComponent(s),this.setPostion(o)),this.currentVisible){var m={type:"tooltip:change",data:s,lngLat:o,x:h,y:v};this.emit("tooltip:change",m)}else{this.showTooltip();var E={type:"tooltip:show",data:s,lngLat:o,x:h,y:v};this.emit("tooltip:show",E)}},l.prototype.showTooltip=function(){this.currentVisible||(this.options.showComponent&&this.scene.addMarker(this.marker),this.currentVisible=!0)},l.prototype.hideTooltip=function(){if(!!this.currentVisible){this.options.showComponent&&this.marker.remove(),this.currentVisible=!1;var a={type:"tooltip:hide"};this.emit("tooltip:hide",a)}},l.prototype.updateComponent=function(a){(0,xt.Xy)(this.lastComponentOptions,a)||(this.tooltipComponent.update(a),this.lastComponentOptions=a)},l.prototype.setComponent=function(){var a=this.tooltipComponent.getContainer(),s=window.document.createElement("div");s.style.cursor="auto",s.style.userSelect="text",s.className="l7plot-tooltip-container",["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(o){s.addEventListener(o,function(h){return h.stopPropagation()})}),s.appendChild(a),this.marker.setElement(s)},l.prototype.setPostion=function(a){this.marker.setLnglat(a)},l.prototype.destroy=function(){this.unBindInteractionEvent(),this.off(),this.marker.remove(),this.tooltipComponent.destroy()},l}(eT.Z),XP="l7plot-legend l7plot-legend__category",YP="l7plot-legend__title",$P="l7plot-legend__category-list",sR="l7plot-legend__list-item",uR="l7plot-legend__category-marker",lR="l7plot-legend__category-value",E7='<div class="'.concat(XP,`">
  <div class="`).concat(YP,`"></div>
  <ul class="`).concat($P,`"></ul>
</div>`),cR='<li class="'.concat(sR,`" data-index={index}>
  <span class="`).concat(uR,`" style="background:{color}"></span>
  <span class="`).concat(lR,`">{value}</span>
</li>`),zg,S7=(zg={},zg[XP]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:BP.fontFamily,padding:"10px 10px 6px 10px",lineHeight:1,fontSize:"12px"},zg[YP]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},zg[$P]={margin:"0px",listStyleType:"none",padding:"0px"},zg[sR]={listStyleType:"none",display:"flex",alignItems:"center",marginBottom:"2px"},zg[uR]={width:"10px",height:"10px"},zg[lR]={paddingLeft:"8px"},zg),w7=function(n){(0,I.ZT)(l,n);function l(){return n!==null&&n.apply(this,arguments)||this}return l.prototype.getDefaultOptions=function(){return(0,xt.b$)({},n.prototype.getDefaultOptions.call(this),{id:"l7plot-category-legend",name:"l7plot-category-legend",title:"",items:[],containerTpl:E7,itemTpl:cR,domStyles:S7,className:XP})},l.prototype.initContainer=function(){var a=this.options.customContent;if(a){var s=this.getHtmlContentNode(a),o=this.getParentContainer();return o&&o.appendChild(s),s}else return n.prototype.initContainer.call(this)},l.prototype.initDom=function(){this.cacheDoms()},l.prototype.initEvent=function(){},l.prototype.removeEvent=function(){},l.prototype.cacheDoms=function(){var a=this.container,s=a.getElementsByClassName(YP)[0],o=a.getElementsByClassName($P)[0];this.titleDom=s,this.listDom=o},l.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},l.prototype.show=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"visible"})},l.prototype.hide=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"hidden"})},l.prototype.updateInner=function(a){this.options.customContent?this.renderCustomContent(this.options.customContent):(a.title&&this.resetTitle(),a.items&&this.renderItems()),n.prototype.updateInner.call(this,a)},l.prototype.renderCustomContent=function(a){var s=this.container.parentNode,o=this.getHtmlContentNode(a),h=this.container;s&&s.replaceChild(o,h),this.container=o,this.applyStyles()},l.prototype.getHtmlContentNode=function(a){var s,o=a(this.options.title||"",this.options.items);return(0,xt.HD)(o)?s=this.createDom(o):s=o,s},l.prototype.resetTitle=function(){var a=this.options.title;a?(this.showTitle(),this.setTitle(a)):this.hideTitle()},l.prototype.showTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"block"})},l.prototype.hideTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"none"})},l.prototype.setTitle=function(a){var s=this.titleDom;s&&(s.innerHTML=a)},l.prototype.renderItems=function(){var a=this;this.clearItemDoms();var s=this.options.items.length>30?this.options.items.slice(0,30):this.options.items,o=this.options.itemTpl||cR,h=this.listDom;h&&(s.forEach(function(v){var m=v.value==="",E=m?"\u2014":Array.isArray(v.value)?v.value.join(" - "):v.value,A=(0,I.pi)((0,I.pi)({},v),{value:E}),F=(0,xt.ng)(o,A),B=a.createDom(F);h.appendChild(B)}),this.applyChildrenStyles(h,this.options.domStyles))},l.prototype.clearItemDoms=function(){this.listDom&&ZP(this.listDom)},l.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},l}(VP),qP="l7plot-legend l7plot-legend__continue",KP="l7plot-legend__title",fR="l7plot-legend__ribbon-container",hR="l7plot-legend__ribbon",pR="l7plot-legend__gradient-bar",QP="l7plot-legend__value-range",C7='<div class="'.concat(qP,`">
  <div class="`).concat(KP,`"></div>
  <div class="`).concat(fR,`"></div>
</div>`),dR='<div class="'.concat(hR,`">
  <span class="`).concat(QP,`">{min}</span>
  <div class="`).concat(pR,`" style="background-image: {backgroundImage}"></div>
  <span class="`).concat(QP,`">{max}</span>
</div>`),Bm,A7=(Bm={},Bm[qP]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:BP.fontFamily,padding:"10px",lineHeight:1,fontSize:"12px"},Bm[KP]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},Bm[hR]={display:"flex",alignItems:"center"},Bm[pR]={width:"140px",height:"14px",margin:"0px 5px"},Bm[QP]={padding:"0px"},Bm),T7=function(n){(0,I.ZT)(l,n);function l(){return n!==null&&n.apply(this,arguments)||this}return l.prototype.getDefaultOptions=function(){return(0,xt.b$)({},n.prototype.getDefaultOptions.call(this),{id:"l7plot-continue-legend",name:"l7plot-continue-legend",title:"",containerTpl:C7,ribbonTpl:dR,domStyles:A7,className:qP})},l.prototype.initContainer=function(){var a=this.options.customContent;if(a){var s=this.getHtmlContentNode(a),o=this.getParentContainer();return o&&o.appendChild(s),s}else return n.prototype.initContainer.call(this)},l.prototype.initDom=function(){this.cacheDoms()},l.prototype.initEvent=function(){},l.prototype.removeEvent=function(){},l.prototype.cacheDoms=function(){var a=this.container,s=a.getElementsByClassName(KP)[0],o=a.getElementsByClassName(fR)[0];this.titleDom=s,this.ribbonContainerDom=o},l.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderRibbon())},l.prototype.show=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"visible"})},l.prototype.hide=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"hidden"})},l.prototype.updateInner=function(a){this.options.customContent?this.renderCustomContent(this.options.customContent):(a.title&&this.resetTitle(),a.colors&&this.renderRibbon()),n.prototype.updateInner.call(this,a)},l.prototype.renderCustomContent=function(a){var s=this.container.parentNode,o=this.getHtmlContentNode(a),h=this.container;s&&s.replaceChild(o,h),this.container=o,this.applyStyles()},l.prototype.getHtmlContentNode=function(a){var s,o=a(this.options.title||"",this.options.min,this.options.max,this.options.colors);return(0,xt.HD)(o)?s=this.createDom(o):s=o,s},l.prototype.resetTitle=function(){var a=this.options.title;a?(this.showTitle(),this.setTitle(a)):this.hideTitle()},l.prototype.showTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"block"})},l.prototype.hideTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"none"})},l.prototype.setTitle=function(a){var s=this.titleDom;s&&(s.innerHTML=a)},l.prototype.renderRibbon=function(){this.clearRibbonContainerDoms();var a=this.options,s=a.min,o=a.max,h=a.colors,v=a.ribbonTpl,m=v===void 0?dR:v,E=this.ribbonContainerDom;if(E){var A="linear-gradient(to right, ".concat(h.join(", "),")"),F={min:s,max:o,backgroundImage:A},B=(0,xt.ng)(m,F),V=this.createDom(B);E.appendChild(V),this.applyChildrenStyles(E,this.options.domStyles)}},l.prototype.clearRibbonContainerDoms=function(){this.ribbonContainerDom&&ZP(this.ribbonContainerDom)},l.prototype.clear=function(){this.setTitle(""),this.clearRibbonContainerDoms()},l}(VP),M7=function(n){(0,I.ZT)(l,n);function l(a){var s=n.call(this,a)||this;return s.legendComponents=[],s.options=a,s.legendComponents=s.initLegendComponents(a.items),s}return l.prototype.initLegendComponents=function(a){for(var s=[],o=0;o<a.length;o++){var h=a[o];if(h.type==="category"){var v=new w7({title:h.options.title,items:h.options.items,className:h.options.className,customContent:h.options.customContent,domStyles:h.options.domStyles});s.push(v)}else if(h.type==="continue"){var v=new T7({title:h.options.title,min:h.options.min,max:h.options.max,colors:h.options.colors,className:h.options.className,customContent:h.options.customContent,domStyles:h.options.domStyles});s.push(v)}}return s},l.prototype.getDefaultOptions=function(){return{position:"bottomleft"}},l.prototype.onAdd=function(){var a=window.document.createElement("div");return a.className="l7plot-legend-container",this.legendComponents.forEach(function(s){var o=s.getContainer();a.appendChild(o)}),a},l.prototype.onRemove=function(){this.legendComponents.forEach(function(a){a.destroy()})},l}(v0),G_;(function(n){n.Amap="amap",n.Mapbox="mapbox"})(G_||(G_={}));var vR=function(n){(0,I.ZT)(l,n);function l(a,s){a===void 0&&(a=[]),s===void 0&&(s={});var o=n.call(this)||this;return o.name=s.name?s.name:(0,xt.EL)("layerGroup"),o.layers=a,o}return l.prototype.addTo=function(a){var s=this;this.scene=a;var o=0,h=this.layers.length;this.layers.forEach(function(v){v.once("inited",function(m){o++,s.emit("inited",m),o===h&&s.emit("inited-all")}),v.addTo(a)})},l.prototype.hasLayer=function(a){return this.layers.some(function(s){return s===a})},l.prototype.addLayer=function(a){var s=this;this.layers.push(a),this.scene&&(a.once("inited",function(o){return s.emit("inited",o)}),a.addTo(this.scene))},l.prototype.removeLayer=function(a){var s=this.layers.findIndex(function(o){return o===a});return s===-1?!1:(this.layers.splice(s,1),this.scene&&a.remove(this.scene),!0)},l.prototype.getLayers=function(){return this.layers},l.prototype.getInteractionLayers=function(){return this.layers.filter(function(a){var s=a.interaction;return s})},l.prototype.getLayer=function(a){return this.layers.find(function(s){var o=s.layer;return o.id===a})},l.prototype.getLayerByName=function(a){return this.layers.find(function(s){return s.name===a})},l.prototype.removeAllLayer=function(){var a=this;this.layers.forEach(function(s){a.scene&&s.remove(a.scene)}),this.layers=[]},l.prototype.isEmpty=function(){return this.layers.length===0},l}(eT.Z),I7=[{original:"loaded",adaptation:"scene-loaded"},{original:"resize",adaptation:"resize"},{original:"destroy",adaptation:"destroy"},{original:"resize",adaptation:"resize"}],k7=["mapmove","movestart","moveend","zoomchange","zoomstart","zoomend","click","dblclick","contextmenu","mousemove","mousewheel","mouseover","mouseout","mouseup","mousedown","dragstart","dragging","dragend"],sT=["inited","add","remove","dataUpdate","click","unclick","contextmenu","uncontextmenu","mouseenter","mousemove","unmousemove","mouseout","mouseup","unmouseup","mousedown","uncontextmenu","unpick"],Nm=new Map;function P8(n,l){Nm.set(n,l)}function O8(n){n.forEach(function(l){Nm.set(l.id,l.image)})}function F8(n){return Nm.get(n)}function R8(n){return Nm.has(n)}function D8(n){return Nm.delete(n)}var uT=new Map;function B8(n,l){uT.set(n,l)}function N8(n){return uT.delete(n)}var n2=new Map;function z8(n,l){n2.set(n,l)}function U8(n){n.forEach(function(l){n2.set(l.name,l.fontUnicode)})}function Z8(n){return n2.delete(n)}var H_=ot(77972),j_=ot(3876),i2=ot(56992);function gR(n){var l,a,s,o={point:{default:{fill:n.pointFillColor,size:n.pointSize,stroke:n.pointBorderColor,lineWidth:n.pointBorder,fillOpacity:n.pointFillOpacity},active:{fill:n.pointActiveFillColor},selected:{fill:n.pointSelectedFillColor}}};return{mapStyle:n.mapStyle,defaultColor:n.brandColor,subColor:n.subColor,semanticRed:n.paletteSemanticRed,semanticGreen:n.paletteSemanticGreen,fontFamily:n.fontFamily,colors10:n.paletteQualitative10,colors20:n.paletteQualitative20,sequenceColors:n.paletteSequence,shapes:{point:["circle","square"],line:["line"]},sizes:[1,10],geometries:{point:{circle:{default:{style:o.point.default},active:{style:o.point.active},selected:{style:o.point.selected}}},line:{},polygon:{}},components:{legend:{category:{domStyles:(l={},l[j_.rC]={visibility:"visible",zIndex:1,backgroundColor:n.legendContainerFillColor,boxShadow:n.legendContainerShadow,borderRadius:"".concat(n.legendContainerBorderRadius,"px"),color:n.legendTextFillColor,fontFamily:n.fontFamily,padding:"10px",lineHeight:"1",fontSize:"".concat(n.legendTextFontSize,"px")},l[j_.O6]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},l[j_.fL]={margin:"0px",padding:"0px"},l[j_.jp]={marginBottom:"2px"},l[j_.Bc]={width:"10px",height:"10px"},l[j_.Tf]={paddingLeft:"8px"},l)},continue:{domStyles:(a={},a[i2.rC]={visibility:"visible",zIndex:1,backgroundColor:n.legendContainerFillColor,boxShadow:n.legendContainerShadow,borderRadius:"".concat(n.legendContainerBorderRadius,"px"),color:n.legendTextFillColor,fontFamily:n.fontFamily,padding:"10px",lineHeight:1,fontSize:"".concat(n.legendTextFontSize,"px")},a[i2.O6]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},a[i2.el]={display:"flex",alignItems:"center"},a[i2.bl]={width:"140px",height:"14px",margin:"0px 5px"},a[i2.VI]={padding:"0px"},a)}},tooltip:{domStyles:(s={},s[H_.rC]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:n.tooltipContainerFillColor,boxShadow:n.tooltipContainerShadow,borderRadius:"".concat(n.tooltipContainerBorderRadius,"px"),color:n.tooltipTextFillColor,fontSize:"".concat(n.tooltipTextFontSize,"px"),fontFamily:n.fontFamily,lineHeight:n.tooltipTextLineHeight},s[H_.O6]={marginBottom:"4px"},s[H_.fL]={margin:"0px",padding:"0px"},s[H_.jp]={marginBottom:"4px"},s[H_.bX]={color:n.tooltipItemNameFillColor},s[H_.Tf]={color:n.tooltipItemValueFillColor,marginLeft:"30px"},s)},label:{style:{textAnchor:"center",textOffset:[0,0],fill:n.labelFillColor,fontSize:n.labelFontSize,fontFamily:n.fontFamily,fillColorDark:n.labelFillColorDark,fillColorLight:n.labelFillColorLight}}}}}var zm={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},L7={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},P7=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],O7=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],F7=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],mR=function(n){n===void 0&&(n={});var l=n.mapStyle,a=l===void 0?"light":l,s=n.subColor,o=s===void 0?"rgba(0,0,0,0.05)":s,h=n.paletteQualitative10,v=h===void 0?P7:h,m=n.paletteQualitative20,E=m===void 0?O7:m,A=n.paletteSemanticRed,F=A===void 0?"#F4664A":A,B=n.paletteSemanticGreen,V=B===void 0?"#30BF78":B,j=n.paletteSemanticYellow,nt=j===void 0?"#FAAD14":j,at=n.paletteSequence,mt=at===void 0?F7:at,Bt=n.fontFamily,de=Bt===void 0?`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`:Bt,ce=n.brandColor,Be=ce===void 0?v[0]:ce;return{mapStyle:a,brandColor:Be,subColor:o,paletteQualitative10:v,paletteQualitative20:E,paletteSemanticRed:F,paletteSemanticGreen:V,paletteSemanticYellow:nt,paletteSequence:mt,fontFamily:de,legendContainerFillColor:"rgba(255, 255, 255, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:zm[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(255, 255, 255, 0.9)",tooltipContainerShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",tooltipContainerBorderRadius:2,tooltipTextFillColor:zm[65],tooltipItemNameFillColor:zm[65],tooltipItemValueFillColor:zm[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:zm[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:Be,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:L7[100],pointActiveBorderColor:zm[100],pointSelectedBorderColor:zm[100]}},V8=mR(),R7={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},Um={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},yR=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],D7=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],B7=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],_R=function(n){n===void 0&&(n={});var l=n.mapStyle,a=l===void 0?"dark":l,s=n.subColor,o=s===void 0?"rgba(255,255,255,0.05)":s,h=n.paletteQualitative10,v=h===void 0?yR:h,m=n.paletteQualitative20,E=m===void 0?D7:m,A=n.paletteSemanticRed,F=A===void 0?"#F4664A":A,B=n.paletteSemanticGreen,V=B===void 0?"#30BF78":B,j=n.paletteSemanticYellow,nt=j===void 0?"#FAAD14":j,at=n.paletteSequence,mt=at===void 0?B7:at,Bt=n.fontFamily,de=Bt===void 0?`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`:Bt,ce=n.brandColor,Be=ce===void 0?v[0]:ce;return{mapStyle:a,brandColor:Be,subColor:o,paletteQualitative10:v,paletteQualitative20:E,paletteSemanticRed:F,paletteSemanticGreen:V,paletteSemanticYellow:nt,paletteSequence:mt,fontFamily:de,legendContainerFillColor:"rgba(31, 31, 31, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:Um[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(31, 31, 31, 0.9)",tooltipContainerShadow:"0px 2px 4px rgba(0, 0, 0, 0.5)",tooltipContainerBorderRadius:2,tooltipTextFillColor:Um[65],tooltipItemNameFillColor:Um[65],tooltipItemValueFillColor:Um[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:Um[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:yR[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:R7[100],pointActiveBorderColor:Um[100],pointSelectedBorderColor:Um[100]}},G8=_R();function xR(n){var l=n.styleSheet,a=l===void 0?{}:l,s=(0,I._T)(n,["styleSheet"]),o=mR(a);return(0,xt.b$)({},gR(o),s)}function N7(n){var l=n.styleSheet,a=l===void 0?{}:l,s=(0,I._T)(n,["styleSheet"]),o=_R(a);return(0,xt.b$)({},gR(o),s)}var bR=xR({}),z7=N7({}),JP={default:bR,light:bR,dark:z7};function tO(n){return n===void 0&&(n="default"),(0,xt.U2)(JP,(0,xt.vl)(n),JP.default)}function H8(n,l,a){a===void 0&&(a="light"),JP[lowerCase(n)]=a==="light"?createTheme(l):createDarkTheme(l)}var ER={map:{type:G_.Amap},logo:!0},U7=function(n){(0,I.ZT)(l,n);function l(a){var s=n.call(this)||this;return s.inited=!1,s.sceneLoaded=!1,s.layersLoaded=!1,s.loaded=!1,s.layerGroup=new vR,s.options=Ip({},s.getDefaultOptions(),a),s.lastOptions=s.options,s}return l.prototype.getDefaultOptions=function(){return l.DefaultOptions},l.prototype.createContainer=function(a){var s=this.options,o=s.width,h=s.height,v=typeof a=="string"?document.getElementById(a):a;return v.style.position||(v.style.position="relative"),o&&(v.style.width||(v.style.width="".concat(o,"px"))),h&&(v.style.height||(v.style.height="".concat(h,"px"))),v},l.prototype.createTheme=function(){var a=(0,xt.Kn)(this.options.theme)?Ip({},tO("default"),xR(this.options.theme)):tO(this.options.theme);return a},l.prototype.createMap=function(){var a=this.options.map?this.options.map:ER.map,s=a.type,o=(0,I._T)(a,["type"]),h=Object.assign({style:this.theme.mapStyle},o);return s===G_.Amap?new dd(h):new KR(h)},l.prototype.createScene=function(){var a=this.options,s=a.logo,o=a.antialias,h=a.preserveDrawingBuffer,v=(0,xt.jn)(s)?{logoVisible:s}:{logoVisible:s==null?void 0:s.visible,logoPosition:s==null?void 0:s.position},m=Object.assign({antialias:o,preserveDrawingBuffer:h},v),E=this.createMap(),A=new IP((0,I.pi)({id:this.container,map:E},m));return A},l.prototype.registerResources=function(){var a=this;Nm.size&&Nm.forEach(function(s,o){!a.scene.hasImage(o)&&a.scene.addImage(o,s)}),uT.size&&uT.forEach(function(s,o){a.scene.addFontFace(o,s)}),n2.size&&n2.forEach(function(s,o){a.scene.addIconFont(o,s)})},l.prototype.update=function(a){this.updateOption(a),a.map&&!(0,xt.Xy)(this.lastOptions.map,this.options.map)&&this.updateMap(a.map),this.render(),this.emit("update")},l.prototype.updateOption=function(a){this.lastOptions=this.options,this.options=Ip({},this.options,a)},l.prototype.updateMap=function(a){var s;if(!!this.scene){var o=a.style,h=a.center,v=a.zoom,m=a.rotation,E=a.pitch;(0,xt.o8)(E)||this.scene.setPitch(E),(0,xt.o8)(m)||this.scene.setRotation(m),o&&o!==((s=this.lastOptions.map)===null||s===void 0?void 0:s.style)&&this.scene.setMapStyle(o),v&&h&&this.scene.setZoomAndCenter(v,h)}},l.prototype.changeSize=function(a,s){this.options.width===a&&this.options.height===s||(this.container.style.width="".concat(a,"px"),this.container.style.height="".concat(s,"px"),this.options=Object.assign(this.options,{width:a,height:s}))},l.prototype.on=function(a,s,o){return this.proxyEventHander("on",a,s,o),this},l.prototype.once=function(a,s){return this.proxyEventHander("once",a,s),this},l.prototype.off=function(a,s){return this.proxyEventHander("off",a,s),this},l.prototype.proxyEventHander=function(a,s,o,h){var v=I7.find(function(B){return B.adaptation===s});if(v)this.scene[a](v.original,o);else if(k7.indexOf(s)!==-1)this.scene[a](s,o);else if(s.includes("Layer:")){var m=(0,I.CR)(s.split(":"),2),E=m[0],A=m[1],F=this[E]&&this[E][a];if(F&&sT.indexOf(A)!==-1)this[E][a](A,o);else throw new Error('No event name "'.concat(s,'"'))}else n.prototype[a].call(this,s,o,h)},l.prototype.getScene=function(){return this.scene},l.prototype.getMap=function(){var a,s;return((a=this.options.map)===null||a===void 0?void 0:a.type)===G_.Amap?this.scene.map:((s=this.options.map)===null||s===void 0?void 0:s.type)===G_.Mapbox?this.scene.map:this.scene.map},l.prototype.addLayer=function(a){this.layerGroup.addLayer(a)},l.prototype.getLayes=function(){return console.warn("Replace to use getLayers()"),this.getLayers()},l.prototype.getLayers=function(){return this.layerGroup.getLayers()},l.prototype.getLayerByName=function(a){return this.layerGroup.getLayerByName(a)},l.prototype.removeLayer=function(a){return this.layerGroup.removeLayer(a)},l.prototype.removeAllLayer=function(){this.layerGroup.removeAllLayer()},l.prototype.zoomIn=function(){this.scene.zoomIn()},l.prototype.zoomOut=function(){this.scene.zoomOut()},l.prototype.setPitch=function(a){this.scene.setPitch(a)},l.prototype.fitBounds=function(a){this.scene.fitBounds(a)},l.prototype.setMapStatus=function(a){this.scene.setMapStatus(a)},l.prototype.setBgColor=function(a){this.scene.setBgColor(a)},l.prototype.initComponents=function(){this.initControls(),this.initTooltip()},l.prototype.updateComponents=function(){this.updateControls(),this.initTooltip()},l.prototype.initControls=function(){var a=this,s=this.options,o=s.zoom,h=s.scale,v=s.layerMenu,m=s.legend;h&&this.addScaleControl(h),o&&this.addZoomControl(o),v&&this.addLayerMenuControl(v),m&&setTimeout(function(){a.addLegendControl(m),a.emit("add-legend")},1e3)},l.prototype.updateControls=function(){var a=this.options,s=a.zoom,o=a.scale,h=a.layerMenu,v=a.legend;(0,xt.Xy)(this.lastOptions.zoom,s)||(s?this.updateZoomControl(s):this.removeZoomControl()),(0,xt.Xy)(this.lastOptions.scale,o)||(o?this.updateScaleControl(o):this.removeScaleControl()),(0,xt.Xy)(this.lastOptions.layerMenu,h)||(h?this.updateLayerMenuControl(h):this.removeLayerMenuControl()),(0,xt.Xy)(this.lastOptions.legend,v)||(v?this.updateLegendControl(v):this.removeLegendControl())},l.prototype.addZoomControl=function(a){this.zoomControl||(this.zoomControl=new s3(a),this.scene.addControl(this.zoomControl))},l.prototype.updateZoomControl=function(a){if(!this.zoomControl){this.addZoomControl(a);return}this.removeZoomControl(),this.addZoomControl(a)},l.prototype.removeZoomControl=function(){this.zoomControl&&(this.zoomControl.remove(),this.zoomControl=void 0)},l.prototype.addScaleControl=function(a){this.scaleControl||(this.scaleControl=new l3(a),this.scene.addControl(this.scaleControl))},l.prototype.updateScaleControl=function(a){if(!this.scaleControl){this.addScaleControl(a);return}this.removeScaleControl(),this.addScaleControl(a)},l.prototype.removeScaleControl=function(){this.scaleControl&&(this.scaleControl.remove(),this.scaleControl=void 0)},l.prototype.addLayerMenuControl=function(a){var s={},o={};this.layerGroup.getLayers().forEach(function(h){var v=h.name,m=h.layer;o[v]=m})},l.prototype.updateLayerMenuControl=function(a){this.removeLayerMenuControl(),this.addLayerMenuControl(a)},l.prototype.removeLayerMenuControl=function(){},l.prototype.getLegendOptions=function(){return{}},l.prototype.addLegendControl=function(a){if(!this.legendControl){var s=this.theme.components.legend,o=Ip({},this.getLegendOptions(),a),h=o.type,v=o.position,m=(0,I._T)(o,["type","position"]),E=[];if(h==="category"){var A=Ip({},{domStyles:s.category.domStyles},m);E.push({type:h,options:A})}else if(h==="continue"){var F=Ip({},{domStyles:s.continue.domStyles},m);E.push({type:h,options:F})}E.length&&(this.legendControl=new M7({position:v,items:E}),this.scene.addControl(this.legendControl))}},l.prototype.updateLegendControl=function(a){if(!this.legendControl){this.addLegendControl(a);return}this.removeLegendControl(),this.addLegendControl(a)},l.prototype.removeLegendControl=function(){this.legendControl&&(this.legendControl.remove(),this.legendControl=void 0)},l.prototype.initTooltip=function(){var a=this;this.tooltip&&this.tooltip.destroy();var s=this.options.tooltip;if(s){var o=Ip({},{domStyles:this.theme.components.tooltip.domStyles},s),h=this.layerGroup.getInteractionLayers();this.tooltip=new b7(this.scene,h,o),this.tooltip.on("*",function(v){return a.emit(v.type,v)})}},l.prototype.exportPng=function(a){return this.scene.exportPng(a)},l.prototype.destroy=function(){var a;n.prototype.off.call(this,"*"),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(a=this.tooltip)===null||a===void 0||a.destroy(),this.scene.destroy()},l.DefaultOptions=ER,l}(eT.Z),SR;(function(n){n[n.solid=0]="solid",n[n.dash=1]="dash"})(SR||(SR={}));var eO;(function(n){n.TextLayer="textLayer",n.DotLayer="dotLayer",n.IconLayer="iconLayer",n.DotDensity="dotDensityLayer",n.ColumnLayer="columnLayer",n.HeatmapLayer="heatmapLayer",n.GridLayer="gridLayer",n.HexbinLayer="hexbinLayer",n.LinesLayer="linesLayer",n.PathLayer="pathLayer",n.ArcLayer="arcLayer",n.AreaLayer="areaLayer",n.PrismLayer="prismLayer"})(eO||(eO={}));var rO=function(){function n(){}return n.aggregation=function(l,a){var s=a.type,o=s===void 0?"grid":s,h=a.radius,v=a.method,m=a.field,E={type:o,size:h,method:v,field:m};l.transforms?(l.transforms=l.transforms.filter(function(A){return A.type!==E.type}),l.transforms.push(E)):l.transforms=[E]},n}(),wR=["name","zIndex","visible","minZoom","maxZoom","pickingBuffer","autoFit","blend"],W_=function(n){(0,I.ZT)(l,n);function l(a){var s=n.call(this)||this;return s.options=Ip({},s.getDefaultOptions(),a),s.lastOptions=s.options,s}return l.prototype.getDefaultOptions=function(){return{}},l.prototype.pickLayerConfig=function(a){var s=(0,xt.ei)(a,wR);return s},l.prototype.addTo=function(a){a.addLayer(this.layer)},l.prototype.remove=function(a){a.removeLayer(this.layer)},l.prototype.update=function(a){this.updateOption(a),this.updateConfig(a)},l.prototype.updateOption=function(a){this.lastOptions=this.options,this.options=Ip({},this.options,a)},l.prototype.updateConfig=function(a){!(0,xt.o8)(a.zIndex)&&!(0,xt.Xy)(this.lastOptions.zIndex,this.options.zIndex)&&this.setIndex(a.zIndex),!(0,xt.o8)(a.blend)&&!(0,xt.Xy)(this.lastOptions.blend,this.options.blend)&&this.setBlend(a.blend),!(0,xt.o8)(a.minZoom)&&!(0,xt.Xy)(this.lastOptions.minZoom,this.options.minZoom)&&this.setMinZoom(a.minZoom),!(0,xt.o8)(a.maxZoom)&&!(0,xt.Xy)(this.lastOptions.maxZoom,this.options.maxZoom)&&this.setMinZoom(a.maxZoom),!(0,xt.o8)(a.visible)&&!(0,xt.Xy)(this.lastOptions.visible,this.options.visible)&&(a.visible?this.show():this.hide())},l.prototype.render=function(){this.layer.renderLayers()},l.prototype.setSource=function(a){if(a instanceof Zv)this.layer.setSource(a);else{var s=a.data,o=a.aggregation,h=(0,I._T)(a,["data","aggregation"]);o&&rO.aggregation(h,o);var v=this.layer.getSource();v?this.layer.setData(s,h):this.layer.source(s,h)}},l.prototype.changeData=function(a){this.setSource(a)},l.prototype.setIndex=function(a){this.layer.setIndex(a)},l.prototype.setBlend=function(a){this.layer.setBlend(a)},l.prototype.setMinZoom=function(a){this.layer.setMinZoom(a)},l.prototype.setMaxZoom=function(a){this.layer.setMaxZoom(a)},l.prototype.show=function(){this.layer.inited&&this.layer.show()},l.prototype.hide=function(){this.layer.inited&&this.layer.hide()},l.prototype.toggleVisible=function(){this.isVisible()?this.hide():this.show()},l.prototype.isVisible=function(){return this.layer.inited?this.layer.isVisible():this.options.visible},l.prototype.fitBounds=function(a){this.layer.fitBounds(a)},l.prototype.on=function(a,s){return sT.indexOf(a)!==-1?this.layer.on(a,s):n.prototype.on.call(this,a,s),this},l.prototype.once=function(a,s){return sT.indexOf(a)!==-1?this.layer.once(a,s):n.prototype.once.call(this,a,s),this},l.prototype.off=function(a,s){return sT.indexOf(a)!==-1?this.layer.off(a,s):n.prototype.off.call(this,a,s),this},l.LayerType=eO,l.LayerConfigkeys=wR,l}(eT.Z);function Zm(n,l){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var o={};return n.forEach(function(h,v){o[h]=a[v]}),delete o.undefined,l(o)}}var el=function(){function n(){}return n.shape=function(l,a){if((0,xt.HD)(a))l.shape(a);else if((0,xt.mf)(a)){var s=[];l.shape(s.join("*"),Zm(s,a))}else if((0,xt.Kn)(a)){var o=a.field?a.field:"";if((0,xt.mf)(a.value)){var s=(0,xt.kJ)(o)?o:o.split("*");l.shape(o,Zm(s,a.value))}else l.shape(o,a.value);(0,xt.HD)(o)&&a.scale&&n.scale(l,o,a.scale)}},n.size=function(l,a){if((0,xt.hj)(a))l.size(a);else if((0,xt.kJ)(a))l.size(a);else if((0,xt.mf)(a)){var s=[];l.size(s.join("*"),Zm(s,a))}else if((0,xt.Kn)(a)){var o=a.field?a.field:"";if((0,xt.mf)(a.value)){var s=(0,xt.kJ)(o)?o:o.split("*");l.size(o,Zm(s,a.value))}else l.size(o,a.value);(0,xt.HD)(o)&&a.scale&&n.scale(l,o,a.scale)}},n.color=function(l,a){if((0,xt.HD)(a))l.color(a);else if((0,xt.mf)(a)){var s=[];l.color(s.join("*"),Zm(s,a))}else if((0,xt.Kn)(a)){var o=a.field?a.field:"";if((0,xt.mf)(a.value)){var s=(0,xt.kJ)(o)?o:o.split("*");l.color(o,Zm(s,a.value))}else l.color(o,a.value);(0,xt.HD)(o)&&a.scale&&n.scale(l,o,a.scale)}},n.style=function(l,a){a&&l.style(a)},n.state=function(l,a){var s=a.active,o=a.select;s&&l.active(s),o&&l.select(o)},n.rotate=function(l,a){(0,xt.HD)(a)||(0,xt.mf)(a)||(0,xt.Kn)(a)},n.texture=function(l,a){(0,xt.HD)(a)&&l.texture(a)},n.animate=function(l,a){((0,xt.jn)(a)||(0,xt.Kn)(a))&&l.animate(a)},n.scale=function(l,a,s){l.scale(a,s)},n.filter=function(l,a){var s=a.field?a.field:"",o=(0,xt.kJ)(s)?s:s.split("*");l.filter(o.join("*"),Zm(o,a.value))},n}();function Z7(n,l){var a=l.field,s=l.content,o=l.style,h=o===void 0?{}:o,v=l.state,m=h.fontSize,E=h.fill,A=a||s||"",F={field:A,value:"text"};el.shape(n,F),m&&el.size(n,m),E&&el.color(n,E),h&&el.style(n,h),v&&el.state(n,v)}var CR={style:{fontSize:12}},V7=[],G7=function(n){(0,I.ZT)(l,n);function l(a){var s=n.call(this,a)||this;s.type=W_.LayerType.TextLayer,s.interaction=!1;var o=s.options,h=o.name,v=o.source,m=s.pickLayerConfig(s.options);return s.name=h||(0,xt.EL)(s.type),s.layer=new Gy((0,I.pi)((0,I.pi)({},m),{name:s.name})),s.mappingLayer(s.layer,s.options),s.setSource(v),s}return l.prototype.getDefaultOptions=function(){return CR},l.prototype.mappingLayer=function(a,s){Z7(a,s)},l.prototype.update=function(a){n.prototype.update.call(this,a),this.mappingLayer(this.layer,this.options)},l.DefaultOptions=CR,l.LayerOptionsKeys=W_.LayerConfigkeys.concat(V7),l}(W_),nO;(function(n){n.Dot="dot",n.DotDensity="dotDensity",n.Heatmap="heatmap",n.Grid="grid",n.Hexbin="hexbin",n.Path="path",n.Flow="flow",n.Area="area",n.Choropleth="choropleth"})(nO||(nO={}));var H7={autoFit:!1},iO=function(n){(0,I.ZT)(l,n);function l(a,s){var o=this;if(typeof a=="string"||a instanceof Element){if(s===void 0)throw new Error("options is undefined");o=n.call(this,s)||this,o.container=o.createContainer(a),o.theme=o.createTheme(),o.scene=o.createScene(),o.registerResources(),o.initSource()}else o=n.call(this,a)||this;return o}return l.prototype.initSource=function(){this.source=this.createSource(),this.render(),this.inited=!0},l.prototype.initLayersEvent=function(){},l.prototype.getDefaultOptions=function(){return l.DefaultOptions},l.prototype.createSource=function(){var a=this.options.source,s=a.data,o=a.aggregation,h=(0,I._T)(a,["data","aggregation"]);o&&rO.aggregation(h,o);var v=new Zv(s,h);return v},l.prototype.createLabelLayer=function(a,s,o){var h=o||{},v=h.visible,m=h.minZoom,E=h.maxZoom,A=h.zIndex,F=A===void 0?0:A,B=new G7((0,I.pi)({name:"labelLayer",visible:v,minZoom:m,maxZoom:E,zIndex:F+.1,source:a},s));return B},l.prototype.updateLabelLayer=function(a,s,o,h){s?h?h.update((0,I.pi)({},s)):(h=this.createLabelLayer(a,s,o),this.layerGroup.addLayer(h)):s===!1&&h&&this.layerGroup.removeLayer(h)},l.prototype.render=function(){var a=this,s=this.createLayers(this.source);this.inited?(this.layerGroup.removeAllLayer(),s.addTo(this.scene),this.layerGroup=s):(this.layerGroup=s,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",function(){a.onSceneLoaded()})),this.initLayersEvent()},l.prototype.onSceneLoaded=function(){var a=this;this.sceneLoaded=!0,this.layerGroup.isEmpty()?this.onLayersLoaded():this.layerGroup.once("inited-all",function(){a.onLayersLoaded()}),this.layerGroup.addTo(this.scene)},l.prototype.onLayersLoaded=function(){this.layersLoaded=!0,this.initComponents(),this.loaded=!0,this.emit("loaded")},l.prototype.attachToScene=function(a,s){this.scene=a,this.theme=s||tO("default"),this.registerResources(),this.initSource()},l.prototype.unattachFromScene=function(){var a;this.removeAllLayer(),(a=this.tooltip)===null||a===void 0||a.destroy()},l.prototype.addToScene=function(a){this.attachToScene(a)},l.prototype.removeFromScene=function(){var a;this.removeAllLayer(),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(a=this.tooltip)===null||a===void 0||a.destroy()},l.prototype.update=function(a){if(this.updateOption(a),a.map&&!(0,xt.Xy)(this.lastOptions.map,this.options.map)&&this.updateMap(a.map),this.scene.setEnableRender(!1),a.source&&!(0,xt.Xy)(this.lastOptions.source,this.options.source)){var s=a.source,o=s.data,h=(0,I._T)(s,["data"]);this.changeData(o,h)}this.scene.setEnableRender(!0),this.render(),this.updateComponents(),this.emit("update")},l.prototype.changeData=function(a,s){var o=this;this.options.source=Ip({},this.options.source,(0,I.pi)({data:a},s));var h=this.options.source,v=h.aggregation,m=(0,I._T)(h,["aggregation"]);v&&rO.aggregation(m,v),this.source.setData(this.options.source.data,m);var E=this.options.legend;E&&setTimeout(function(){o.updateLegendControl(E)}),this.emit("change-data")},l.DefaultOptions=H7,l.PlotType=nO,l}(U7),j7=Ip({},iO.DefaultOptions,{source:{data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}}}),AR="#2f54eb",zc={active:{fill:!1,stroke:AR,lineWidth:1.5,lineOpacity:.8},select:{fill:!1,stroke:AR,lineWidth:1.5,lineOpacity:.8}},a2=function(n){return(0,xt.o8)(n)||(n.active===!1?zc.active=Object.assign(zc.active,{fill:!1,stroke:!1}):typeof n.active=="object"&&(n.active.fill===!1?zc.active.fill=!1:typeof n.active.fill=="string"&&(zc.active.fill=n.active.fill),n.active.stroke===!1?zc.active.stroke=!1:typeof n.active.stroke=="string"&&(zc.active.stroke=n.active.stroke),typeof n.active.lineWidth=="number"&&(zc.active.lineWidth=n.active.lineWidth),typeof n.active.lineOpacity=="number"&&(zc.active.lineOpacity=n.active.lineOpacity)),n.select===!1?zc.select=Object.assign(zc.select,{fill:!1,stroke:!1}):typeof n.select=="object"&&(n.select.fill===!1?zc.select.fill=!1:typeof n.select.fill=="string"&&(zc.select.fill=n.select.fill),n.select.stroke===!1?zc.select.stroke=!1:typeof n.select.stroke=="string"&&(zc.select.stroke=n.select.stroke),typeof n.select.lineWidth=="number"&&(zc.select.lineWidth=n.select.lineWidth),typeof n.select.lineOpacity=="number"&&(zc.select.lineOpacity=n.select.lineOpacity))),zc};function W7(n,l,a,s,o,h){var v=h.color,m=h.style,E=h.state,A=a2(E),F={active:A.active.fill===!1?!1:{color:A.active.fill},select:!1},B={opacity:m==null?void 0:m.opacity},V=m==null?void 0:m.fillBottomColor,j=m==null?void 0:m.lineWidth,nt=m==null?void 0:m.stroke,at={opacity:m==null?void 0:m.lineOpacity,dashArray:m==null?void 0:m.lineDash,lineType:m==null?void 0:m.lineType};if(el.shape(n,"fill"),v&&el.color(n,v),B&&el.style(n,B),F&&el.state(n,F),V&&n.setBottomColor(V),el.shape(l,"line"),j&&el.size(l,j),nt&&el.color(l,nt),at&&el.style(l,at),A.active.stroke){var mt=A.active.stroke,Bt=A.active.lineWidth||j,de={opacity:A.active.lineOpacity};el.shape(a,"line"),Bt&&el.size(a,Bt),mt&&el.color(a,mt),de&&el.style(a,de)}if(A.select.fill){var ce=A.select.fill;el.shape(s,"fill"),ce&&el.color(s,ce),B&&el.style(s,B),el.state(s,{select:!1,active:!1})}if(A.select.stroke){var Be=A.select.stroke,Bt=A.select.lineWidth||j,Xe={opacity:A.select.lineOpacity};el.shape(o,"line"),Bt&&el.size(o,Bt),Be&&el.color(o,Be),Xe&&el.style(o,Xe)}}var X7=/\s/;function Y7(n){for(var l=n.length;l--&&X7.test(n.charAt(l)););return l}var $7=Y7,q7=/^\s+/;function K7(n){return n&&n.slice(0,$7(n)+1).replace(q7,"")}var Q7=K7,TR=0/0,J7=/^[-+]0x[0-9a-f]+$/i,t8=/^0b[01]+$/i,e8=/^0o[0-7]+$/i,r8=parseInt;function n8(n){if(typeof n=="number")return n;if(nT(n))return TR;if(iT(n)){var l=typeof n.valueOf=="function"?n.valueOf():n;n=iT(l)?l+"":l}if(typeof n!="string")return n===0?n:+n;n=Q7(n);var a=t8.test(n);return a||e8.test(n)?r8(n.slice(2),a?2:8):J7.test(n)?TR:+n}var MR=n8,IR=1/0,i8=17976931348623157e292;function a8(n){if(!n)return n===0?n:0;if(n=MR(n),n===IR||n===-IR){var l=n<0?-1:1;return l*i8}return n===n?n:0}var o8=a8;function s8(n){var l=o8(n),a=l%1;return l===l?a?l-a:l:0}var u8=s8,l8=rT.isFinite,c8=Math.min;function f8(n){var l=Math[n];return function(a,s){if(a=MR(a),s=s==null?0:c8(u8(s),292),s&&l8(a)){var o=(WP(a)+"e").split("e"),h=l(o[0]+"e"+(+o[1]+s));return o=(WP(h)+"e").split("e"),+(o[0]+"e"+(+o[1]-s))}return l(a)}}var h8=f8,p8=h8("round"),kR=p8,d8=function(n){return!Array.isArray(n[0].value)},v8=function(n){if(d8(n))return n;var l=n.map(function(a){return(0,I.pi)((0,I.pi)({},a),{value:[kR(a.value[0],2),kR(a.value[1],2)]})});return l},LR={visible:!0,state:{active:!1,select:!1},enabledMultiSelect:!1},g8=["color","style","state","enabledMultiSelect"],aO=function(n){(0,I.ZT)(l,n);function l(a){var s=n.call(this,a)||this;s.selectData=[],s.type=W_.LayerType.AreaLayer,s.interaction=!0,s.onHighlighHandle=function(nt){var at=nt.feature,mt=nt.featureId;s.setHighlightLayerSource(at,mt)},s.onUnhighlighHandle=function(){s.setHighlightLayerSource()},s.onSelectHandle=function(nt){var at=s.options.enabledMultiSelect,mt=nt.feature,Bt=nt.featureId,de=(0,xt.d9)(s.selectData),ce=de.findIndex(function(Xe){return Xe.featureId===Bt});if(ce===-1)at?de.push({feature:mt,featureId:Bt}):de=[{feature:mt,featureId:Bt}],s.emit("select",mt,(0,xt.d9)(de));else{var Be=de[ce];at?de.splice(ce,1):de=[],s.emit("unselect",Be,(0,xt.d9)(de))}s.setSelectLayerSource(de)};var o=s.options,h=o.name,v=o.source,m=o.visible,E=o.minZoom,A=o.maxZoom,F=o.zIndex,B=F===void 0?0:F,V=s.pickLayerConfig(s.options),j=a2(s.options.state);return s.name=h||(0,xt.EL)(s.type),s.layer=new Zx((0,I.pi)((0,I.pi)({},V),{name:s.name})),s.strokeLayer=new Sg({name:"strokeLayer",visible:m,zIndex:B,minZoom:E,maxZoom:A}),s.highlightLayer=new Sg({name:"highlightLayer",visible:m&&Boolean(j.active.stroke),zIndex:B+.1,minZoom:E,maxZoom:A}),s.selectFillLayer=new Zx({name:"selectFillLayer",visible:m&&Boolean(j.select.fill),zIndex:B+.1,minZoom:E,maxZoom:A}),s.selectStrokeLayer=new Sg({name:"selectStrokeLayer",visible:m&&Boolean(j.select.stroke),zIndex:B+.1,minZoom:E,maxZoom:A}),s.mappingLayer(s.options),s.setSource(v),s.initEvent(),s}return l.prototype.getDefaultOptions=function(){return LR},l.prototype.mappingLayer=function(a){W7(this.layer,this.strokeLayer,this.highlightLayer,this.selectFillLayer,this.selectStrokeLayer,a)},l.prototype.setSource=function(a){n.prototype.setSource.call(this,a),this.setStrokeLayerSource(),this.setHighlightLayerSource(),this.selectFillLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}}),this.selectStrokeLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}})},l.prototype.setStrokeLayerSource=function(){var a=this.layer.getSource();if(a)this.strokeLayer.setSource(a);else{var s=this.layer.sourceOption,o=s.data,h=s.options;this.strokeLayer.source(o,h)}},l.prototype.setHighlightLayerSource=function(a,s){if(s===void 0&&(s=-999),this.highlightLayerData!==s){var o=a?[a]:[];this.highlightLayer.setData({type:"FeatureCollection",features:o},{parser:{type:"geojson"}}),this.highlightLayerData=s}},l.prototype.setSelectLayerSource=function(a){if(a===void 0&&(a=[]),!(this.selectData.length===a.length&&(0,xt.Xy)(this.selectData.map(function(o){var h=o.featureId;return h}),a.map(function(o){var h=o.featureId;return h})))){var s=a.map(function(o){var h=o.feature;return h});this.selectFillLayer.setData({type:"FeatureCollection",features:s},{parser:{type:"geojson"}}),this.selectStrokeLayer.setData({type:"FeatureCollection",features:s},{parser:{type:"geojson"}}),this.selectData=a}},l.prototype.initEvent=function(){this.layer.off("mousemove",this.onHighlighHandle),this.layer.off("unmousemove",this.onHighlighHandle),this.layer.off("click",this.onSelectHandle),this.selectData=[],this.highlightLayerData=null,this.options.state&&(this.options.state.active&&(this.layer.on("mousemove",this.onHighlighHandle),this.layer.on("unmousemove",this.onUnhighlighHandle)),this.options.state.select&&this.layer.on("click",this.onSelectHandle))},l.prototype.addTo=function(a){a.addLayer(this.layer),a.addLayer(this.strokeLayer),a.addLayer(this.highlightLayer),a.addLayer(this.selectFillLayer),a.addLayer(this.selectStrokeLayer)},l.prototype.remove=function(a){a.removeLayer(this.layer),a.removeLayer(this.strokeLayer),a.removeLayer(this.highlightLayer),a.removeLayer(this.selectFillLayer),a.removeLayer(this.selectStrokeLayer)},l.prototype.update=function(a){if(n.prototype.update.call(this,a),this.mappingLayer(this.options),this.options.visible){!(0,xt.o8)(a.state)&&!(0,xt.Xy)(this.lastOptions.state,this.options.state)&&this.updateHighlightLayer();var s=a2(this.options.state);s.active.stroke&&this.setHighlightLayerSource(),(s.select.fill||s.select.stroke)&&this.setSelectLayerSource()}this.initEvent()},l.prototype.updateHighlightLayer=function(){var a=a2(this.options.state),s=a2(this.lastOptions.state);s.active.stroke!==a.active.stroke&&(a.active.stroke?this.highlightLayer.show():this.highlightLayer.hide()),s.select.fill!==a.select.fill&&(a.select.fill?this.selectFillLayer.show():this.selectFillLayer.hide()),s.select.stroke!==a.select.stroke&&(a.select.stroke?this.selectStrokeLayer.show():this.selectStrokeLayer.hide())},l.prototype.setIndex=function(a){this.layer.setIndex(a),this.strokeLayer.setIndex(a),this.highlightLayer.setIndex(a+.1),this.selectFillLayer.setIndex(a+.1),this.selectStrokeLayer.setIndex(a+.1)},l.prototype.setMinZoom=function(a){this.layer.setMinZoom(a),this.strokeLayer.setMinZoom(a),this.highlightLayer.setMinZoom(a),this.selectFillLayer.setMinZoom(a),this.selectStrokeLayer.setMinZoom(a)},l.prototype.setMaxZoom=function(a){this.layer.setMaxZoom(a),this.strokeLayer.setMaxZoom(a),this.highlightLayer.setMaxZoom(a),this.selectFillLayer.setMaxZoom(a),this.selectStrokeLayer.setMaxZoom(a)},l.prototype.show=function(){!this.layer.inited||(this.layer.show(),this.strokeLayer.show(),this.selectFillLayer.show(),this.selectStrokeLayer.show())},l.prototype.hide=function(){!this.layer.inited||(this.layer.hide(),this.strokeLayer.hide(),this.selectFillLayer.hide(),this.selectStrokeLayer.hide())},l.prototype.getColorLegendItems=function(){var a=this.layer.getLegendItems("color");if(Array.isArray(a)&&a.length!==0){var s=v8(a);return s}return[]},l.prototype.setActive=function(a){},l.prototype.setSelect=function(a){},l.DefaultOptions=LR,l.LayerOptionsKeys=W_.LayerConfigkeys.concat(g8),l}(W_),m8=function(n){(0,I.ZT)(l,n);function l(){var a=n!==null&&n.apply(this,arguments)||this;return a.type=iO.PlotType.Area,a}return l.prototype.getDefaultOptions=function(){return l.DefaultOptions},l.prototype.createLayers=function(a){this.areaLayer=new aO((0,I.pi)({source:a},(0,xt.ei)(this.options,aO.LayerOptionsKeys)));var s=new vR([this.areaLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(a,this.options.label,this.options),s.addLayer(this.labelLayer)),s},l.prototype.updateLayers=function(a){var s=(0,xt.ei)(a,aO.LayerOptionsKeys);this.areaLayer.update(s),this.updateLabelLayer(this.source,a.label,this.options,this.labelLayer)},l.prototype.initLayersEvent=function(){},l.prototype.getLegendOptions=function(){var a=this.areaLayer.getColorLegendItems();return a.length!==0?{type:"category",items:a}:{}},l.DefaultOptions=j7,l}(iO),j8=function(n,l){var a={}.toString;return a.call(n)==="[object ".concat(l,"]")},W8=function(n){return Object.prototype.toString.call(n).slice(8,-1)},oO=function(n){if(!n||typeof n!="object")return n;var l;return Array.isArray(n)?l=n.map(function(a){return oO(a)}):(l={},Object.keys(n).forEach(function(a){return l[a]=oO(n[a])})),l},X8=function(n){if(!n)return n;var l={};for(var a in n)l[a]=n[a];return l},o2=function(){return o2=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(n[o]=l[o])}return n},o2.apply(this,arguments)},y8=function(n,l){var a={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&l.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)l.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(a[s[o]]=n[s[o]]);return a},PR=function(n){var l=n.source,a=y8(n,["source"]),s=o2(o2({},oO(a)),{source:o2({},l)});return s},sO=function(){return sO=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(n[o]=l[o])}return n},sO.apply(this,arguments)},lT=function(n,l){var a={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&l.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)l.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(a[s[o]]=n[s[o]]);return a};function _8(n,l){var a=(0,bt.useRef)(),s=(0,bt.useRef)(),o=(0,bt.useRef)(null),h=l.onReady;return(0,bt.useEffect)(function(){if(!(!a.current||!s.current||(0,xt.Xy)(s.current,l))){var v=!1,m=!1,E=!1,A=s.current,F=A.onReady,B=A.map,V=A.source,j=V.data,nt=lT(V,["data"]),at=lT(A,["onReady","map","source"]),mt=l.onReady,Bt=l.map,de=l.source,ce=de.data,Be=lT(de,["data"]),Xe=lT(l,["onReady","map","source"]);if(m=!(0,xt.Xy)(B,Bt),v=!(0,xt.Xy)(nt,Be)||j!==ce,E=!(0,xt.Xy)(at,Xe),s.current=PR(l),m){var _r=(0,xt.ei)(Bt,["center","pitch","rotation","zoom","style"]);a.current.updateMap(_r)}v&&(a.current.loaded?a.current.changeData(ce,Be):a.current.once("loaded",function(){var Ir;(Ir=a.current)===null||Ir===void 0||Ir.changeData(ce,Be)})),E&&(a.current.loaded?a.current.update(Xe):a.current.once("loaded",function(){var Ir;(Ir=a.current)===null||Ir===void 0||Ir.update(Xe)}))}},[l]),(0,bt.useEffect)(function(){return o.current?(s.current||(s.current=PR(l)),a.current=new n(o.current,sO({},l)),h&&a.current.once("loaded",function(){h(a.current)}),function(){a.current&&(a.current.destroy(),a.current=void 0)}):function(){return null}},[]),{plotRef:a,containerRef:o}}var x8=function(n,l){!n||((0,xt.mf)(n)?n(l):n.current=l)},b8=function(){var n=function(l,a){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,o){s.__proto__=o}||function(s,o){for(var h in o)Object.prototype.hasOwnProperty.call(o,h)&&(s[h]=o[h])},n(l,a)};return function(l,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");n(l,a);function s(){this.constructor=l}l.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}}(),E8=function(n){b8(l,n);function l(){var a=n!==null&&n.apply(this,arguments)||this;return a.state={hasError:!1},a.renderError=function(s){var o=a.props.errorTemplate;switch(s){default:return typeof o=="function"?o(s):o||bt.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",s.message)}},a}return l.getDerivedStateFromError=function(a){return{hasError:!0,error:a}},l.getDerivedStateFromProps=function(a,s){return s.children!==a.children?{children:a.children,hasError:!1,error:void 0}:null},l.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):bt.createElement(bt.Fragment,null,this.props.children)},l}(bt.Component),S8=E8,w8=ot(24561),C8=function(n){var l=n.loadingTemplate,a=function(){return l||bt.createElement(w8.ZP,{viewBox:"0 0 400 180",width:200,height:90,speed:1},bt.createElement("rect",{x:"20",y:"5",rx:"0",ry:"0",width:"1",height:"170"}),bt.createElement("rect",{x:"20",y:"175",rx:"0",ry:"0",width:"360",height:"1"}),bt.createElement("rect",{x:"40",y:"75",rx:"0",ry:"0",width:"35",height:"100"}),bt.createElement("rect",{x:"80",y:"125",rx:"0",ry:"0",width:"35",height:"50"}),bt.createElement("rect",{x:"120",y:"105",rx:"0",ry:"0",width:"35",height:"70"}),bt.createElement("rect",{x:"160",y:"35",rx:"0",ry:"0",width:"35",height:"140"}),bt.createElement("rect",{x:"200",y:"55",rx:"0",ry:"0",width:"35",height:"120"}),bt.createElement("rect",{x:"240",y:"15",rx:"0",ry:"0",width:"35",height:"160"}),bt.createElement("rect",{x:"280",y:"135",rx:"0",ry:"0",width:"35",height:"40"}),bt.createElement("rect",{x:"320",y:"85",rx:"0",ry:"0",width:"35",height:"90"}))};return bt.createElement("div",{style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:"#fff"}},a())},A8=C8,T8=function(n,l){var a={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&l.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)l.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(a[s[o]]=n[s[o]]);return a},M8=(0,bt.forwardRef)(function(n,l){var a=n.chartRef,s=n.containerStyle,o=s===void 0?{height:"inherit"}:s,h=n.className,v=n.loading,m=n.loadingTemplate,E=n.errorTemplate,A=T8(n,["chartRef","containerStyle","className","loading","loadingTemplate","errorTemplate"]),F=_8(m8,A),B=F.plotRef,V=F.containerRef;return(0,bt.useEffect)(function(){x8(a,B.current)},[B.current]),(0,bt.useImperativeHandle)(l,function(){return{getChart:function(){return B.current}}}),bt.createElement(S8,{errorTemplate:E},v&&bt.createElement(A8,{loadingTemplate:m}),bt.createElement("div",{className:h,style:o,ref:V}))}),I8=M8},79611:function(gn,Ot,ot){"use strict";var kt=ot(67294),bt=ot(3083),I=ot(59658),xt=ot(4322),K=ot(24770),ut=ot(26119),ht=function(tt,be){var it={};for(var st in tt)Object.prototype.hasOwnProperty.call(tt,st)&&be.indexOf(st)<0&&(it[st]=tt[st]);if(tt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ut=0,st=Object.getOwnPropertySymbols(tt);Ut<st.length;Ut++)be.indexOf(st[Ut])<0&&Object.prototype.propertyIsEnumerable.call(tt,st[Ut])&&(it[st[Ut]]=tt[st[Ut]]);return it},lt=(0,kt.forwardRef)(function(tt,be){var it=tt.chartRef,st=tt.style,Ut=st===void 0?{height:"inherit"}:st,P=tt.className,b=tt.loading,W=tt.loadingTemplate,fe=tt.errorTemplate,Ee=ht(tt,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),Te=(0,I.Z)(bt.Bar,Ee),Mt=Te.chart,et=Te.container;return(0,kt.useEffect)(function(){(0,xt.J)(it,Mt.current)},[Mt.current]),(0,kt.useImperativeHandle)(be,function(){return{getChart:function(){return Mt.current}}}),kt.createElement(K.Z,{errorTemplate:fe},b&&kt.createElement(ut.Z,{loadingTemplate:W,theme:tt.theme}),kt.createElement("div",{className:P,style:Ut,ref:et}))});Ot.Z=lt},78677:function(gn,Ot,ot){"use strict";var kt=ot(67294),bt=ot(3083),I=ot(59658),xt=ot(4322),K=ot(24770),ut=ot(26119),ht=function(tt,be){var it={};for(var st in tt)Object.prototype.hasOwnProperty.call(tt,st)&&be.indexOf(st)<0&&(it[st]=tt[st]);if(tt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ut=0,st=Object.getOwnPropertySymbols(tt);Ut<st.length;Ut++)be.indexOf(st[Ut])<0&&Object.prototype.propertyIsEnumerable.call(tt,st[Ut])&&(it[st[Ut]]=tt[st[Ut]]);return it},lt=(0,kt.forwardRef)(function(tt,be){var it=tt.chartRef,st=tt.style,Ut=st===void 0?{height:"inherit"}:st,P=tt.className,b=tt.loading,W=tt.loadingTemplate,fe=tt.errorTemplate,Ee=ht(tt,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),Te=(0,I.Z)(bt.Column,Ee),Mt=Te.chart,et=Te.container;return(0,kt.useEffect)(function(){(0,xt.J)(it,Mt.current)},[Mt.current]),(0,kt.useImperativeHandle)(be,function(){return{getChart:function(){return Mt.current}}}),kt.createElement(K.Z,{errorTemplate:fe},b&&kt.createElement(ut.Z,{loadingTemplate:W,theme:tt.theme}),kt.createElement("div",{className:P,style:Ut,ref:et}))});Ot.Z=lt},63430:function(gn,Ot,ot){"use strict";var kt=ot(67294),bt=ot(3083),I=ot(59658),xt=ot(4322),K=ot(24770),ut=ot(26119),ht=function(tt,be){var it={};for(var st in tt)Object.prototype.hasOwnProperty.call(tt,st)&&be.indexOf(st)<0&&(it[st]=tt[st]);if(tt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ut=0,st=Object.getOwnPropertySymbols(tt);Ut<st.length;Ut++)be.indexOf(st[Ut])<0&&Object.prototype.propertyIsEnumerable.call(tt,st[Ut])&&(it[st[Ut]]=tt[st[Ut]]);return it},lt=(0,kt.forwardRef)(function(tt,be){var it=tt.chartRef,st=tt.style,Ut=st===void 0?{height:"inherit"}:st,P=tt.className,b=tt.loading,W=tt.loadingTemplate,fe=tt.errorTemplate,Ee=ht(tt,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),Te=(0,I.Z)(bt.Pie,Ee),Mt=Te.chart,et=Te.container;return(0,kt.useEffect)(function(){(0,xt.J)(it,Mt.current)},[Mt.current]),(0,kt.useImperativeHandle)(be,function(){return{getChart:function(){return Mt.current}}}),kt.createElement(K.Z,{errorTemplate:fe},b&&kt.createElement(ut.Z,{loadingTemplate:W,theme:tt.theme}),kt.createElement("div",{className:P,style:Ut,ref:et}))});Ot.Z=lt},24770:function(gn,Ot,ot){"use strict";var kt=ot(67294),bt=function(){var xt=function(K,ut){return xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ht,lt){ht.__proto__=lt}||function(ht,lt){for(var tt in lt)Object.prototype.hasOwnProperty.call(lt,tt)&&(ht[tt]=lt[tt])},xt(K,ut)};return function(K,ut){if(typeof ut!="function"&&ut!==null)throw new TypeError("Class extends value "+String(ut)+" is not a constructor or null");xt(K,ut);function ht(){this.constructor=K}K.prototype=ut===null?Object.create(ut):(ht.prototype=ut.prototype,new ht)}}(),I=function(xt){bt(K,xt);function K(){var ut=xt!==null&&xt.apply(this,arguments)||this;return ut.state={hasError:!1},ut.renderError=function(ht){var lt=ut.props.errorTemplate;switch(ht){default:return lt&&typeof lt=="function"?lt(ht):kt.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",ht.message)}},ut}return K.getDerivedStateFromError=function(ut){return{hasError:!0,error:ut}},K.getDerivedStateFromProps=function(ut,ht){return ht.children!==ut.children?{children:ut.children,hasError:!1,error:void 0}:null},K.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):kt.createElement(kt.Fragment,null,this.props.children)},K}(kt.Component);Ot.Z=I},59658:function(gn,Ot,ot){"use strict";ot.d(Ot,{Z:function(){return yt}});var kt=ot(67294),bt=ot(45098),I=ot(73935),xt=ot.t(I,2),K=function(){return K=Object.assign||function(Xt){for(var ie,Ce=1,er=arguments.length;Ce<er;Ce++){ie=arguments[Ce];for(var Ht in ie)Object.prototype.hasOwnProperty.call(ie,Ht)&&(Xt[Ht]=ie[Ht])}return Xt},K.apply(this,arguments)},ut=function(Xt,ie,Ce,er){function Ht(ne){return ne instanceof Ce?ne:new Ce(function(Me){Me(ne)})}return new(Ce||(Ce=Promise))(function(ne,Me){function ae(re){try{or(er.next(re))}catch(Jt){Me(Jt)}}function Je(re){try{or(er.throw(re))}catch(Jt){Me(Jt)}}function or(re){re.done?ne(re.value):Ht(re.value).then(ae,Je)}or((er=er.apply(Xt,ie||[])).next())})},ht=function(Xt,ie){var Ce={label:0,sent:function(){if(ne[0]&1)throw ne[1];return ne[1]},trys:[],ops:[]},er,Ht,ne,Me;return Me={next:ae(0),throw:ae(1),return:ae(2)},typeof Symbol=="function"&&(Me[Symbol.iterator]=function(){return this}),Me;function ae(or){return function(re){return Je([or,re])}}function Je(or){if(er)throw new TypeError("Generator is already executing.");for(;Ce;)try{if(er=1,Ht&&(ne=or[0]&2?Ht.return:or[0]?Ht.throw||((ne=Ht.return)&&ne.call(Ht),0):Ht.next)&&!(ne=ne.call(Ht,or[1])).done)return ne;switch(Ht=0,ne&&(or=[or[0]&2,ne.value]),or[0]){case 0:case 1:ne=or;break;case 4:return Ce.label++,{value:or[1],done:!1};case 5:Ce.label++,Ht=or[1],or=[0];continue;case 7:or=Ce.ops.pop(),Ce.trys.pop();continue;default:if(ne=Ce.trys,!(ne=ne.length>0&&ne[ne.length-1])&&(or[0]===6||or[0]===2)){Ce=0;continue}if(or[0]===3&&(!ne||or[1]>ne[0]&&or[1]<ne[3])){Ce.label=or[1];break}if(or[0]===6&&Ce.label<ne[1]){Ce.label=ne[1],ne=or;break}if(ne&&Ce.label<ne[2]){Ce.label=ne[2],Ce.ops.push(or);break}ne[2]&&Ce.ops.pop(),Ce.trys.pop();continue}or=ie.call(Xt,Ce)}catch(re){or=[6,re],Ht=0}finally{er=ne=0}if(or[0]&5)throw or[1];return{value:or[0]?or[1]:void 0,done:!0}}},lt=K({},xt),tt=lt.version,be=lt.render,it=lt.unmountComponentAtNode,st;try{var Ut=Number((tt||"").split(".")[0]);Ut>=18&&(st=lt.createRoot)}catch(Xt){}function P(Xt){var ie=lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;ie&&typeof ie=="object"&&(ie.usingClientEntryPoint=Xt)}var b="__rc_react_root__";function W(Xt,ie){P(!0);var Ce=ie[b]||st(ie);P(!1),Ce.render(Xt),ie[b]=Ce}function fe(Xt,ie){be(Xt,ie)}function Ee(Xt,ie){}function Te(Xt,ie){if(st){W(Xt,ie);return}fe(Xt,ie)}function Mt(Xt){return ut(this,void 0,void 0,function(){return ht(this,function(ie){return[2,Promise.resolve().then(function(){var Ce;(Ce=Xt[b])===null||Ce===void 0||Ce.unmount(),delete Xt[b]})]})})}function et(Xt){it(Xt)}function Dt(Xt){}function we(Xt){return ut(this,void 0,void 0,function(){return ht(this,function(ie){return st!==void 0?[2,Mt(Xt)]:(et(Xt),[2])})})}var _e=function(Xt,ie){var Ce=document.createElement("div");return ie==="tooltip"&&(Ce.className="g2-tooltip"),Te(Xt,Ce),Ce},ge=_e,te=function(Xt,ie){var Ce={}.toString;return Ce.call(Xt)==="[object ".concat(ie,"]")},xe=function(Xt){if(!Xt)return Xt;var ie={};for(var Ce in Xt)ie[Ce]=Xt[Ce];return ie},Ye=function(Xt){return Object.prototype.toString.call(Xt).slice(8,-1)},Lt=function(Xt){if(!Xt||typeof Xt!="object")return Xt;var ie;return Array.isArray(Xt)?ie=Xt.map(function(Ce){return Lt(Ce)}):(ie={},Object.keys(Xt).forEach(function(Ce){return ie[Ce]=Lt(Xt[Ce])})),ie},Qt=function(Xt,ie){for(var Ce=Xt,er=0;er<ie.length;er+=1)if(Ce!=null&&Ce[ie[er]])Ce=Ce[ie[er]];else{Ce=void 0;break}return Ce},ct=function(Xt,ie,Ce){if(!Xt)return Xt;var er=Xt;return ie.forEach(function(Ht,ne){ne<ie.length-1?er=er[Ht]:er[Ht]=Ce}),Xt},Ct=function(){return Ct=Object.assign||function(Xt){for(var ie,Ce=1,er=arguments.length;Ce<er;Ce++){ie=arguments[Ce];for(var Ht in ie)Object.prototype.hasOwnProperty.call(ie,Ht)&&(Xt[Ht]=ie[Ht])}return Xt},Ct.apply(this,arguments)},Y=function(Xt,ie){var Ce={};for(var er in Xt)Object.prototype.hasOwnProperty.call(Xt,er)&&ie.indexOf(er)<0&&(Ce[er]=Xt[er]);if(Xt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ht=0,er=Object.getOwnPropertySymbols(Xt);Ht<er.length;Ht++)ie.indexOf(er[Ht])<0&&Object.prototype.propertyIsEnumerable.call(Xt,er[Ht])&&(Ce[er[Ht]]=Xt[er[Ht]]);return Ce};function yt(Xt,ie){var Ce=(0,kt.useRef)(),er=(0,kt.useRef)(),Ht=(0,kt.useRef)(null),ne=ie.onReady,Me=ie.onEvent,ae=function(Jt,Et){var $t;return Jt===void 0&&(Jt="image/png"),($t=Ce.current)===null||$t===void 0?void 0:$t.chart.canvas.cfg.el.toDataURL(Jt,Et)},Je=function(Jt,Et,$t){var Yt;Jt===void 0&&(Jt="download"),Et===void 0&&(Et="image/png");var St=Jt;Jt.indexOf(".")===-1&&(St="".concat(Jt,".").concat(Et.split("/")[1]));var At=(Yt=Ce.current)===null||Yt===void 0?void 0:Yt.chart.canvas.cfg.el.toDataURL(Et,$t),ue=document.createElement("a");return ue.href=At,ue.download=St,document.body.appendChild(ue),ue.click(),document.body.removeChild(ue),ue=null,St},or=function(Jt,Et,$t){var Yt=Qt(Jt,Et);ct(Jt,Et,function(){for(var St=[],At=0;At<arguments.length;At++)St[At]=arguments[At];var ue=te(Yt,"Function")?Yt.apply(void 0,St):Yt;return te(ue,"String")||te(ue,"Number")||te(ue,"HTMLDivElement")?ue:ge(ue,$t)})},re=function(){Qt(ie,["statistic","content","customHtml"])&&or(ie,["statistic","content","customHtml"]),Qt(ie,["statistic","title","customHtml"])&&or(ie,["statistic","title","customHtml"]),typeof ie.tooltip=="object"&&(Qt(ie,["tooltip","container"])&&or(ie,["tooltip","container"],"tooltip"),Qt(ie,["tooltip","customContent"])&&or(ie,["tooltip","customContent"],"tooltip"))};return(0,kt.useEffect)(function(){if(Ce.current&&!(0,bt.Xy)(er.current,ie)){var Jt=!1;if(er.current){var Et=er.current,$t=Et.data,Yt=Et.value,St=Et.percent,At=Y(Et,["data","value","percent"]),ue=ie.data,Pe=ie.value,je=ie.percent,Nt=Y(ie,["data","value","percent"]);Jt=(0,bt.Xy)(At,Nt)}if(er.current=Lt(ie),Jt&&(0,bt.U2)(ie,"chartType")!=="Mix"){var wt="data",Tt=["percent"],Ft=Object.keys(ie);Tt.forEach(function(J){Ft.includes(J)&&(wt=J)}),Ce.current.changeData((ie==null?void 0:ie[wt])||[])}else re(),Ce.current.update(ie)}},[ie]),(0,kt.useEffect)(function(){if(!Ht.current)return function(){return null};er.current||(er.current=Lt(ie)),re();var Jt=new Xt(Ht.current,Ct({},ie));Jt.toDataURL=function($t,Yt){return ae($t,Yt)},Jt.downloadImage=function($t,Yt,St){return Je($t,Yt,St)},Jt.render(),Ce.current=xe(Jt),ne&&ne(Jt);var Et=function($t){Me&&Me(Jt,$t)};return Jt.on("*",Et),function(){Ce.current&&(Ce.current.destroy(),Ce.current.off("*",Et),Ce.current=void 0)}},[]),{chart:Ce,container:Ht}}},26119:function(gn,Ot,ot){"use strict";var kt=ot(67294),bt=ot(24561),I=function(xt){var K=xt.loadingTemplate,ut=xt.theme,ht=ut===void 0?"light":ut,lt=function(){return K||kt.createElement(bt.ZP,{viewBox:"0 0 400 180",width:200,height:90,speed:1,backgroundColor:ht==="dark"?"#262626":"#D9D9D9"},kt.createElement("rect",{x:"20",y:"5",rx:"0",ry:"0",width:"1",height:"170"}),kt.createElement("rect",{x:"20",y:"175",rx:"0",ry:"0",width:"360",height:"1"}),kt.createElement("rect",{x:"40",y:"75",rx:"0",ry:"0",width:"35",height:"100"}),kt.createElement("rect",{x:"80",y:"125",rx:"0",ry:"0",width:"35",height:"50"}),kt.createElement("rect",{x:"120",y:"105",rx:"0",ry:"0",width:"35",height:"70"}),kt.createElement("rect",{x:"160",y:"35",rx:"0",ry:"0",width:"35",height:"140"}),kt.createElement("rect",{x:"200",y:"55",rx:"0",ry:"0",width:"35",height:"120"}),kt.createElement("rect",{x:"240",y:"15",rx:"0",ry:"0",width:"35",height:"160"}),kt.createElement("rect",{x:"280",y:"135",rx:"0",ry:"0",width:"35",height:"40"}),kt.createElement("rect",{x:"320",y:"85",rx:"0",ry:"0",width:"35",height:"90"}))};return kt.createElement("div",{className:"charts-loading-container",style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:ht==="dark"?"rgb(20, 20, 20)":"rgb(255, 255, 255)"}},lt())};Ot.Z=I},4322:function(gn,Ot,ot){"use strict";ot.d(Ot,{J:function(){return bt}});var kt=ot(45098),bt=function(I,xt){!I||((0,kt.mf)(I)?I(xt):I.current=xt)}},74273:function(gn,Ot,ot){"use strict";ot.d(Ot,{Z:function(){return Pe}});var kt=ot(4942),bt=ot(1413),I=ot(91),xt=ot(85893),K=ot(46986),ut=ot(94184),ht=ot.n(ut),lt=ot(67294),tt=ot(4270),be=ot(44962),it=ot(14855),st=function(Nt){return(0,kt.Z)({},Nt.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:Nt.marginLG,marginInline:0,color:Nt.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};function Ut(je){return(0,it.Xj)("ProCardOperation",function(Nt){var wt=(0,bt.Z)((0,bt.Z)({},Nt),{},{componentCls:".".concat(je)});return[st(wt)]})}var P=function(Nt){var wt=Nt.className,Tt=Nt.style,Ft=Tt===void 0?{}:Tt,J=Nt.children,gt=(0,lt.useContext)(K.ZP.ConfigContext),jt=gt.getPrefixCls,ve=jt("pro-card-operation"),Gt=Ut(ve),Ae=Gt.wrapSSR,He=Gt.hashId,qe=ht()(ve,wt,He);return Ae((0,xt.jsx)("div",{className:qe,style:Ft,children:J}))},b=P,W=ot(25035),fe=ot(83062),Ee=ot(76521),Te=ot(87462),Mt=ot(57838),et=ot(96159),Dt=ot(97685),we=ot(53124),_e=ot(21687),ge=function(Nt){var wt=Nt.value,Tt=Nt.formatter,Ft=Nt.precision,J=Nt.decimalSeparator,gt=Nt.groupSeparator,jt=gt===void 0?"":gt,ve=Nt.prefixCls,Gt;if(typeof Tt=="function")Gt=Tt(wt);else{var Ae=String(wt),He=Ae.match(/^(-?)(\d*)(\.(\d+))?$/);if(!He||Ae==="-")Gt=Ae;else{var qe=He[1],hr=He[2]||"0",tr=He[4]||"";hr=hr.replace(/\B(?=(\d{3})+(?!\d))/g,jt),typeof Ft=="number"&&(tr=tr.padEnd(Ft,"0").slice(0,Ft>0?Ft:0)),tr&&(tr=""+J+tr),Gt=[lt.createElement("span",{key:"int",className:ve+"-content-value-int"},qe,hr),tr&&lt.createElement("span",{key:"decimal",className:ve+"-content-value-decimal"},tr)]}}return lt.createElement("span",{className:ve+"-content-value"},Gt)},te=ge,xe=ot(67968),Ye=ot(45503),Lt=ot(14747),Qt=function(Nt){var wt,Tt,Ft=Nt.componentCls,J=Nt.marginXXS,gt=Nt.padding,jt=Nt.colorTextDescription,ve=Nt.statisticTitleFontSize,Gt=Nt.colorTextHeading,Ae=Nt.statisticContentFontSize,He=Nt.statisticFontFamily;return(0,kt.Z)({},""+Ft,(0,Te.Z)((0,Te.Z)({},(0,Lt.Wf)(Nt)),(Tt={},(0,kt.Z)(Tt,Ft+"-title",{marginBottom:J,color:jt,fontSize:ve}),(0,kt.Z)(Tt,Ft+"-skeleton",{paddingTop:gt}),(0,kt.Z)(Tt,Ft+"-content",(wt={color:Gt,fontSize:Ae,fontFamily:He},(0,kt.Z)(wt,Ft+"-content-value",{display:"inline-block",direction:"ltr"}),(0,kt.Z)(wt,Ft+"-content-prefix, "+Ft+"-content-suffix",{display:"inline-block"}),(0,kt.Z)(wt,Ft+"-content-prefix",{marginInlineEnd:J}),(0,kt.Z)(wt,Ft+"-content-suffix",{marginInlineStart:J}),wt)),Tt)))},ct=(0,xe.Z)("Statistic",function(je){var Nt=je.fontSizeHeading3,wt=je.fontSize,Tt=je.fontFamily,Ft=(0,Ye.TS)(je,{statisticTitleFontSize:wt,statisticContentFontSize:Nt,statisticFontFamily:Tt});return[Qt(Ft)]}),Ct=function(Nt){var wt=Nt.prefixCls,Tt=Nt.className,Ft=Nt.style,J=Nt.valueStyle,gt=Nt.value,jt=gt===void 0?0:gt,ve=Nt.title,Gt=Nt.valueRender,Ae=Nt.prefix,He=Nt.suffix,qe=Nt.loading,hr=qe===void 0?!1:qe,tr=Nt.direction,Br=Nt.onMouseEnter,Lr=Nt.onMouseLeave,Zr=Nt.decimalSeparator,Tn=Zr===void 0?".":Zr,rn=Nt.groupSeparator,Nn=rn===void 0?",":rn,zn=lt.createElement(te,(0,Te.Z)({decimalSeparator:Tn,groupSeparator:Nn},Nt,{value:jt})),jn=ct(String(wt)),Sn=(0,Dt.Z)(jn,2),Wn=Sn[0],Rt=Sn[1],Wt=ht()(wt,(0,kt.Z)({},wt+"-rtl",tr==="rtl"),Tt,Rt);return Wn(lt.createElement("div",{className:Wt,style:Ft,onMouseEnter:Br,onMouseLeave:Lr},ve&&lt.createElement("div",{className:wt+"-title"},ve),lt.createElement(_e.Z,{paragraph:!1,loading:hr,className:wt+"-skeleton"},lt.createElement("div",{style:J,className:wt+"-content"},Ae&&lt.createElement("span",{className:wt+"-content-prefix"},Ae),Gt?Gt(zn):zn,He&&lt.createElement("span",{className:wt+"-content-suffix"},He)))))},Y=(0,we.PG)({prefixCls:"statistic"})(Ct),yt=Y,Xt=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function ie(je,Nt){var wt=je,Tt=/\[[^\]]*]/g,Ft=(Nt.match(Tt)||[]).map(function(ve){return ve.slice(1,-1)}),J=Nt.replace(Tt,"[]"),gt=Xt.reduce(function(ve,Gt){var Ae=(0,Dt.Z)(Gt,2),He=Ae[0],qe=Ae[1];if(ve.includes(He)){var hr=Math.floor(wt/qe);return wt-=hr*qe,ve.replace(new RegExp(He+"+","g"),function(tr){var Br=tr.length;return hr.toString().padStart(Br,"0")})}return ve},J),jt=0;return gt.replace(Tt,function(){var ve=Ft[jt];return jt+=1,ve})}function Ce(je,Nt){var wt=Nt.format,Tt=wt===void 0?"":wt,Ft=new Date(je).getTime(),J=Date.now(),gt=Math.max(Ft-J,0);return ie(gt,Tt)}var er=1e3/30;function Ht(je){return new Date(je).getTime()}var ne=function(Nt){var wt=Nt.value,Tt=Nt.format,Ft=Tt===void 0?"HH:mm:ss":Tt,J=Nt.onChange,gt=Nt.onFinish,jt=(0,Mt.Z)(),ve=lt.useRef(null),Gt=function(){gt==null||gt(),ve.current&&(clearInterval(ve.current),ve.current=null)},Ae=function(){var tr=Ht(wt);tr>=Date.now()&&(ve.current=setInterval(function(){jt(),J==null||J(tr-Date.now()),tr<Date.now()&&Gt()},er))};lt.useEffect(function(){return Ae(),function(){ve.current&&(clearInterval(ve.current),ve.current=null)}},[wt]);var He=function(tr,Br){return Ce(tr,(0,Te.Z)((0,Te.Z)({},Br),{format:Ft}))},qe=function(tr){return(0,et.Tm)(tr,{title:void 0})};return lt.createElement(yt,(0,Te.Z)({},Nt,{valueRender:qe,formatter:He}))},Me=lt.memo(ne);yt.Countdown=Me;var ae=yt,Je=function(Nt){var wt,Tt,Ft;return(0,kt.Z)({},Nt.componentCls,(Ft={display:"flex",fontSize:Nt.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,kt.Z)({display:"flex",width:"100%"},"".concat(Nt.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":{width:"100%"},"&-description":{width:"100%"}},(0,kt.Z)(Ft,"".concat(Nt.antCls,"-statistic-title"),{color:Nt.colorText}),(0,kt.Z)(Ft,"&-trend-up",(0,kt.Z)({},"".concat(Nt.antCls,"-statistic-content"),(0,kt.Z)({color:"#f5222d"},"".concat(Nt.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),(0,kt.Z)(Ft,"&-trend-down",(0,kt.Z)({},"".concat(Nt.antCls,"-statistic-content"),(0,kt.Z)({color:"#389e0d"},"".concat(Nt.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),(0,kt.Z)(Ft,"& &-layout-horizontal",(wt={display:"flex",justifyContent:"space-between"},(0,kt.Z)(wt,"".concat(Nt.antCls,"-statistic-title"),{marginBlockEnd:0}),(0,kt.Z)(wt,"".concat(Nt.antCls,"-statistic-content-value"),{fontWeight:500}),(0,kt.Z)(wt,"".concat(Nt.antCls,"-statistic-title,").concat(Nt.antCls,"-statistic-content,").concat(Nt.antCls,"-statistic-content-suffix,").concat(Nt.antCls,"-statistic-content-prefix,").concat(Nt.antCls,"-statistic-content-value-decimal"),{fontSize:Nt.fontSize}),wt)),(0,kt.Z)(Ft,"& &-layout-inline",(Tt={display:"inline-flex",color:Nt.colorTextSecondary},(0,kt.Z)(Tt,"".concat(Nt.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),(0,kt.Z)(Tt,"".concat(Nt.antCls,"-statistic-content"),{color:Nt.colorTextSecondary}),(0,kt.Z)(Tt,"".concat(Nt.antCls,"-statistic-title,").concat(Nt.antCls,"-statistic-content,").concat(Nt.antCls,"-statistic-content-suffix,").concat(Nt.antCls,"-statistic-content-prefix,").concat(Nt.antCls,"-statistic-content-value-decimal"),{fontSize:Nt.fontSizeSM}),Tt)),Ft))};function or(je){return(0,it.Xj)("Statistic",function(Nt){var wt=(0,bt.Z)((0,bt.Z)({},Nt),{},{componentCls:".".concat(je)});return[Je(wt)]})}var re=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],Jt=function(Nt){var wt,Tt=Nt.className,Ft=Nt.layout,J=Ft===void 0?"inline":Ft,gt=Nt.style,jt=gt===void 0?{}:gt,ve=Nt.description,Gt=Nt.children,Ae=Nt.title,He=Nt.tip,qe=Nt.status,hr=Nt.trend,tr=Nt.prefix,Br=Nt.icon,Lr=(0,I.Z)(Nt,re),Zr=(0,lt.useContext)(K.ZP.ConfigContext),Tn=Zr.getPrefixCls,rn=Tn("pro-card-statistic"),Nn=or(rn),zn=Nn.wrapSSR,jn=Nn.hashId,Sn=ht()(rn,Tt,jn),Wn=ht()("".concat(rn,"-status"),jn),Rt=ht()("".concat(rn,"-icon"),jn),Wt=ht()("".concat(rn,"-wrapper"),jn),oe=ht()("".concat(rn,"-content"),jn),Se=ht()(jn,(wt={},(0,kt.Z)(wt,"".concat(rn,"-layout-").concat(J),J),(0,kt.Z)(wt,"".concat(rn,"-trend-").concat(hr),hr),wt)),ze=He&&(0,xt.jsx)(fe.Z,{title:He,children:(0,xt.jsx)(W.Z,{className:"".concat(rn,"-tip ").concat(jn)})}),fr=ht()("".concat(rn,"-trend-icon"),jn,(0,kt.Z)({},"".concat(rn,"-trend-icon-").concat(hr),hr)),wr=hr&&(0,xt.jsx)("div",{className:fr}),Le=qe&&(0,xt.jsx)("div",{className:Wn,children:(0,xt.jsx)(Ee.Z,{status:qe,text:null})}),ur=Br&&(0,xt.jsx)("div",{className:Rt,children:Br});return zn((0,xt.jsxs)("div",{className:Sn,style:jt,children:[ur,(0,xt.jsxs)("div",{className:Wt,children:[Le,(0,xt.jsxs)("div",{className:oe,children:[(0,xt.jsx)(ae,(0,bt.Z)({title:(Ae||ze)&&(0,xt.jsxs)(xt.Fragment,{children:[Ae,ze]}),prefix:(wr||tr)&&(0,xt.jsxs)(xt.Fragment,{children:[wr,tr]}),className:Se},Lr)),ve&&(0,xt.jsx)("div",{className:"".concat(rn,"-description ").concat(jn),children:ve})]})]})]}))},Et=Jt,$t=function(Nt){return(0,kt.Z)({},Nt.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,kt.Z)({flexDirection:"row"},"".concat(Nt.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat(Nt.colorBorder)}})};function Yt(je){return(0,it.Xj)("StatisticCard",function(Nt){var wt=(0,bt.Z)((0,bt.Z)({},Nt),{},{componentCls:".".concat(je)});return[$t(wt)]})}var St=["children","statistic","className","chart","chartPlacement","footer"],At=function(Nt){var wt,Tt=Nt.children,Ft=Nt.statistic,J=Nt.className,gt=Nt.chart,jt=Nt.chartPlacement,ve=Nt.footer,Gt=(0,I.Z)(Nt,St),Ae=(0,lt.useContext)(K.ZP.ConfigContext),He=Ae.getPrefixCls,qe=He("pro-statistic-card"),hr=Yt(qe),tr=hr.wrapSSR,Br=hr.hashId,Lr=ht()(qe,J,Br),Zr=Ft&&(0,xt.jsx)(Et,(0,bt.Z)({layout:"vertical"},Ft)),Tn=ht()("".concat(qe,"-chart"),Br,(wt={},(0,kt.Z)(wt,"".concat(qe,"-chart-left"),jt==="left"&&gt&&Ft),(0,kt.Z)(wt,"".concat(qe,"-chart-right"),jt==="right"&&gt&&Ft),wt)),rn=gt&&(0,xt.jsx)("div",{className:Tn,children:gt}),Nn=ht()("".concat(qe,"-content "),Br,(0,kt.Z)({},"".concat(qe,"-content-horizontal"),jt==="left"||jt==="right")),zn=(rn||Zr)&&(jt==="left"?(0,xt.jsxs)("div",{className:Nn,children:[rn,Zr]}):(0,xt.jsxs)("div",{className:Nn,children:[Zr,rn]})),jn=ve&&(0,xt.jsx)("div",{className:"".concat(qe,"-footer ").concat(Br),children:ve});return tr((0,xt.jsxs)(tt.Z,(0,bt.Z)((0,bt.Z)({className:Lr},Gt),{},{children:[zn,Tt,jn]})))},ue=function(Nt){return(0,xt.jsx)(At,(0,bt.Z)({bodyStyle:{padding:0}},Nt))};At.Statistic=Et,At.Divider=be.Z,At.Operation=b,At.isProCard=!0,At.Group=ue;var Pe=At},6056:function(gn,Ot,ot){"use strict";ot.d(Ot,{Z:function(){return ut}});var kt,bt,I,xt;function K(){kt=document.createElement("table"),bt=document.createElement("tr"),I=/^\s*<(\w+|!)[^>]*>/,xt={tr:document.createElement("tbody"),tbody:kt,thead:kt,tfoot:kt,td:bt,th:bt,"*":document.createElement("div")}}function ut(ht){kt||K();var lt=I.test(ht)&&RegExp.$1;(!lt||!(lt in xt))&&(lt="*");var tt=xt[lt];ht=typeof ht=="string"?ht.replace(/(^\s*)|(\s*$)/g,""):ht,tt.innerHTML=""+ht;var be=tt.childNodes[0];return be&&tt.contains(be)&&tt.removeChild(be),be}},45442:function(gn,Ot,ot){"use strict";ot.d(Ot,{Z:function(){return kt}});function kt(bt,I){if(bt)for(var xt in I)I.hasOwnProperty(xt)&&(bt.style[xt]=I[xt]);return bt}},90494:function(gn,Ot){"use strict";var ot="*",kt=function(){function bt(){this._events={}}return bt.prototype.on=function(I,xt,K){return this._events[I]||(this._events[I]=[]),this._events[I].push({callback:xt,once:!!K}),this},bt.prototype.once=function(I,xt){return this.on(I,xt,!0)},bt.prototype.emit=function(I){for(var xt=this,K=[],ut=1;ut<arguments.length;ut++)K[ut-1]=arguments[ut];var ht=this._events[I]||[],lt=this._events[ot]||[],tt=function(be){for(var it=be.length,st=0;st<it;st++)if(!!be[st]){var Ut=be[st],P=Ut.callback,b=Ut.once;b&&(be.splice(st,1),be.length===0&&delete xt._events[I],it--,st--),P.apply(xt,K)}};tt(ht),tt(lt)},bt.prototype.off=function(I,xt){if(!I)this._events={};else if(!xt)delete this._events[I];else{for(var K=this._events[I]||[],ut=K.length,ht=0;ht<ut;ht++)K[ht].callback===xt&&(K.splice(ht,1),ut--,ht--);K.length===0&&delete this._events[I]}return this},bt.prototype.getEvents=function(){return this._events},bt}();Ot.Z=kt},2667:function(gn,Ot,ot){"use strict";var kt=ot(70655),bt=ot(90494),I=ot(77341),xt=function(K){(0,kt.ZT)(ut,K);function ut(ht){var lt=K.call(this)||this;lt.destroyed=!1;var tt=lt.getDefaultCfg();return lt.cfg=(0,I.CD)(tt,ht),lt}return ut.prototype.getDefaultCfg=function(){return{}},ut.prototype.get=function(ht){return this.cfg[ht]},ut.prototype.set=function(ht,lt){this.cfg[ht]=lt},ut.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},ut}(bt.Z);Ot.Z=xt},2840:function(gn,Ot,ot){"use strict";ot.d(Ot,{Z:function(){return bo}});var kt=ot(70655),bt=ot(43631),I=ot(37153),xt=ot(77341),K=ot(45098),ut=0,ht=0,lt=0,tt=1e3,be,it,st=0,Ut=0,P=0,b=typeof performance=="object"&&performance.now?performance:Date,W=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(nr){setTimeout(nr,17)};function fe(){return Ut||(W(Ee),Ut=b.now()+P)}function Ee(){Ut=0}function Te(){this._call=this._time=this._next=null}Te.prototype=Mt.prototype={constructor:Te,restart:function(nr,ye,Ge){if(typeof nr!="function")throw new TypeError("callback is not a function");Ge=(Ge==null?fe():+Ge)+(ye==null?0:+ye),!this._next&&it!==this&&(it?it._next=this:be=this,it=this),this._call=nr,this._time=Ge,ge()},stop:function(){this._call&&(this._call=null,this._time=1/0,ge())}};function Mt(nr,ye,Ge){var Mr=new Te;return Mr.restart(nr,ye,Ge),Mr}function et(){fe(),++ut;for(var nr=be,ye;nr;)(ye=Ut-nr._time)>=0&&nr._call.call(null,ye),nr=nr._next;--ut}function Dt(){Ut=(st=b.now())+P,ut=ht=0;try{et()}finally{ut=0,_e(),Ut=0}}function we(){var nr=b.now(),ye=nr-st;ye>tt&&(P-=ye,st=nr)}function _e(){for(var nr,ye=be,Ge,Mr=1/0;ye;)ye._call?(Mr>ye._time&&(Mr=ye._time),nr=ye,ye=ye._next):(Ge=ye._next,ye._next=null,ye=nr?nr._next=Ge:be=Ge);it=nr,ge(Mr)}function ge(nr){if(!ut){ht&&(ht=clearTimeout(ht));var ye=nr-Ut;ye>24?(nr<1/0&&(ht=setTimeout(Dt,nr-b.now()-P)),lt&&(lt=clearInterval(lt))):(lt||(st=b.now(),lt=setInterval(we,tt)),ut=1,W(Dt))}}var te=ot(77190);function xe(nr,ye,Ge){nr.prototype=ye.prototype=Ge,Ge.constructor=nr}function Ye(nr,ye){var Ge=Object.create(nr.prototype);for(var Mr in ye)Ge[Mr]=ye[Mr];return Ge}function Lt(){}var Qt=.7,ct=1/Qt,Ct="\\s*([+-]?\\d+)\\s*",Y="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",yt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xt=/^#([0-9a-f]{3,8})$/,ie=new RegExp("^rgb\\(".concat(Ct,",").concat(Ct,",").concat(Ct,"\\)$")),Ce=new RegExp("^rgb\\(".concat(yt,",").concat(yt,",").concat(yt,"\\)$")),er=new RegExp("^rgba\\(".concat(Ct,",").concat(Ct,",").concat(Ct,",").concat(Y,"\\)$")),Ht=new RegExp("^rgba\\(".concat(yt,",").concat(yt,",").concat(yt,",").concat(Y,"\\)$")),ne=new RegExp("^hsl\\(".concat(Y,",").concat(yt,",").concat(yt,"\\)$")),Me=new RegExp("^hsla\\(".concat(Y,",").concat(yt,",").concat(yt,",").concat(Y,"\\)$")),ae={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xe(Lt,Et,{copy:function(ye){return Object.assign(new this.constructor,this,ye)},displayable:function(){return this.rgb().displayable()},hex:Je,formatHex:Je,formatHex8:or,formatHsl:re,formatRgb:Jt,toString:Jt});function Je(){return this.rgb().formatHex()}function or(){return this.rgb().formatHex8()}function re(){return gt(this).formatHsl()}function Jt(){return this.rgb().formatRgb()}function Et(nr){var ye,Ge;return nr=(nr+"").trim().toLowerCase(),(ye=Xt.exec(nr))?(Ge=ye[1].length,ye=parseInt(ye[1],16),Ge===6?$t(ye):Ge===3?new ue(ye>>8&15|ye>>4&240,ye>>4&15|ye&240,(ye&15)<<4|ye&15,1):Ge===8?Yt(ye>>24&255,ye>>16&255,ye>>8&255,(ye&255)/255):Ge===4?Yt(ye>>12&15|ye>>8&240,ye>>8&15|ye>>4&240,ye>>4&15|ye&240,((ye&15)<<4|ye&15)/255):null):(ye=ie.exec(nr))?new ue(ye[1],ye[2],ye[3],1):(ye=Ce.exec(nr))?new ue(ye[1]*255/100,ye[2]*255/100,ye[3]*255/100,1):(ye=er.exec(nr))?Yt(ye[1],ye[2],ye[3],ye[4]):(ye=Ht.exec(nr))?Yt(ye[1]*255/100,ye[2]*255/100,ye[3]*255/100,ye[4]):(ye=ne.exec(nr))?J(ye[1],ye[2]/100,ye[3]/100,1):(ye=Me.exec(nr))?J(ye[1],ye[2]/100,ye[3]/100,ye[4]):ae.hasOwnProperty(nr)?$t(ae[nr]):nr==="transparent"?new ue(NaN,NaN,NaN,0):null}function $t(nr){return new ue(nr>>16&255,nr>>8&255,nr&255,1)}function Yt(nr,ye,Ge,Mr){return Mr<=0&&(nr=ye=Ge=NaN),new ue(nr,ye,Ge,Mr)}function St(nr){return nr instanceof Lt||(nr=Et(nr)),nr?(nr=nr.rgb(),new ue(nr.r,nr.g,nr.b,nr.opacity)):new ue}function At(nr,ye,Ge,Mr){return arguments.length===1?St(nr):new ue(nr,ye,Ge,Mr==null?1:Mr)}function ue(nr,ye,Ge,Mr){this.r=+nr,this.g=+ye,this.b=+Ge,this.opacity=+Mr}xe(ue,At,Ye(Lt,{brighter:function(ye){return ye=ye==null?ct:Math.pow(ct,ye),new ue(this.r*ye,this.g*ye,this.b*ye,this.opacity)},darker:function(ye){return ye=ye==null?Qt:Math.pow(Qt,ye),new ue(this.r*ye,this.g*ye,this.b*ye,this.opacity)},rgb:function(){return this},clamp:function(){return new ue(Tt(this.r),Tt(this.g),Tt(this.b),wt(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pe,formatHex:Pe,formatHex8:je,formatRgb:Nt,toString:Nt}));function Pe(){return"#".concat(Ft(this.r)).concat(Ft(this.g)).concat(Ft(this.b))}function je(){return"#".concat(Ft(this.r)).concat(Ft(this.g)).concat(Ft(this.b)).concat(Ft((isNaN(this.opacity)?1:this.opacity)*255))}function Nt(){var nr=wt(this.opacity);return"".concat(nr===1?"rgb(":"rgba(").concat(Tt(this.r),", ").concat(Tt(this.g),", ").concat(Tt(this.b)).concat(nr===1?")":", ".concat(nr,")"))}function wt(nr){return isNaN(nr)?1:Math.max(0,Math.min(1,nr))}function Tt(nr){return Math.max(0,Math.min(255,Math.round(nr)||0))}function Ft(nr){return nr=Tt(nr),(nr<16?"0":"")+nr.toString(16)}function J(nr,ye,Ge,Mr){return Mr<=0?nr=ye=Ge=NaN:Ge<=0||Ge>=1?nr=ye=NaN:ye<=0&&(nr=NaN),new ve(nr,ye,Ge,Mr)}function gt(nr){if(nr instanceof ve)return new ve(nr.h,nr.s,nr.l,nr.opacity);if(nr instanceof Lt||(nr=Et(nr)),!nr)return new ve;if(nr instanceof ve)return nr;nr=nr.rgb();var ye=nr.r/255,Ge=nr.g/255,Mr=nr.b/255,tn=Math.min(ye,Ge,Mr),In=Math.max(ye,Ge,Mr),Un=NaN,Cn=In-tn,ta=(In+tn)/2;return Cn?(ye===In?Un=(Ge-Mr)/Cn+(Ge<Mr)*6:Ge===In?Un=(Mr-ye)/Cn+2:Un=(ye-Ge)/Cn+4,Cn/=ta<.5?In+tn:2-In-tn,Un*=60):Cn=ta>0&&ta<1?0:Un,new ve(Un,Cn,ta,nr.opacity)}function jt(nr,ye,Ge,Mr){return arguments.length===1?gt(nr):new ve(nr,ye,Ge,Mr==null?1:Mr)}function ve(nr,ye,Ge,Mr){this.h=+nr,this.s=+ye,this.l=+Ge,this.opacity=+Mr}xe(ve,jt,Ye(Lt,{brighter:function(ye){return ye=ye==null?ct:Math.pow(ct,ye),new ve(this.h,this.s,this.l*ye,this.opacity)},darker:function(ye){return ye=ye==null?Qt:Math.pow(Qt,ye),new ve(this.h,this.s,this.l*ye,this.opacity)},rgb:function(){var ye=this.h%360+(this.h<0)*360,Ge=isNaN(ye)||isNaN(this.s)?0:this.s,Mr=this.l,tn=Mr+(Mr<.5?Mr:1-Mr)*Ge,In=2*Mr-tn;return new ue(He(ye>=240?ye-240:ye+120,In,tn),He(ye,In,tn),He(ye<120?ye+240:ye-120,In,tn),this.opacity)},clamp:function(){return new ve(Gt(this.h),Ae(this.s),Ae(this.l),wt(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var ye=wt(this.opacity);return"".concat(ye===1?"hsl(":"hsla(").concat(Gt(this.h),", ").concat(Ae(this.s)*100,"%, ").concat(Ae(this.l)*100,"%").concat(ye===1?")":", ".concat(ye,")"))}}));function Gt(nr){return nr=(nr||0)%360,nr<0?nr+360:nr}function Ae(nr){return Math.max(0,Math.min(1,nr||0))}function He(nr,ye,Ge){return(nr<60?ye+(Ge-ye)*nr/60:nr<180?Ge:nr<240?ye+(Ge-ye)*(240-nr)/60:ye)*255}function qe(nr,ye,Ge,Mr,tn){var In=nr*nr,Un=In*nr;return((1-3*nr+3*In-Un)*ye+(4-6*In+3*Un)*Ge+(1+3*nr+3*In-3*Un)*Mr+Un*tn)/6}function hr(nr){var ye=nr.length-1;return function(Ge){var Mr=Ge<=0?Ge=0:Ge>=1?(Ge=1,ye-1):Math.floor(Ge*ye),tn=nr[Mr],In=nr[Mr+1],Un=Mr>0?nr[Mr-1]:2*tn-In,Cn=Mr<ye-1?nr[Mr+2]:2*In-tn;return qe((Ge-Mr/ye)*ye,Un,tn,In,Cn)}}function tr(nr){var ye=nr.length;return function(Ge){var Mr=Math.floor(((Ge%=1)<0?++Ge:Ge)*ye),tn=nr[(Mr+ye-1)%ye],In=nr[Mr%ye],Un=nr[(Mr+1)%ye],Cn=nr[(Mr+2)%ye];return qe((Ge-Mr/ye)*ye,tn,In,Un,Cn)}}var Br=function(nr){return function(){return nr}};function Lr(nr,ye){return function(Ge){return nr+Ge*ye}}function Zr(nr,ye,Ge){return nr=Math.pow(nr,Ge),ye=Math.pow(ye,Ge)-nr,Ge=1/Ge,function(Mr){return Math.pow(nr+Mr*ye,Ge)}}function Tn(nr,ye){var Ge=ye-nr;return Ge?Lr(nr,Ge>180||Ge<-180?Ge-360*Math.round(Ge/360):Ge):constant(isNaN(nr)?ye:nr)}function rn(nr){return(nr=+nr)==1?Nn:function(ye,Ge){return Ge-ye?Zr(ye,Ge,nr):Br(isNaN(ye)?Ge:ye)}}function Nn(nr,ye){var Ge=ye-nr;return Ge?Lr(nr,Ge):Br(isNaN(nr)?ye:nr)}var zn=function nr(ye){var Ge=rn(ye);function Mr(tn,In){var Un=Ge((tn=At(tn)).r,(In=At(In)).r),Cn=Ge(tn.g,In.g),ta=Ge(tn.b,In.b),Wa=Nn(tn.opacity,In.opacity);return function(es){return tn.r=Un(es),tn.g=Cn(es),tn.b=ta(es),tn.opacity=Wa(es),tn+""}}return Mr.gamma=nr,Mr}(1);function jn(nr){return function(ye){var Ge=ye.length,Mr=new Array(Ge),tn=new Array(Ge),In=new Array(Ge),Un,Cn;for(Un=0;Un<Ge;++Un)Cn=At(ye[Un]),Mr[Un]=Cn.r||0,tn[Un]=Cn.g||0,In[Un]=Cn.b||0;return Mr=nr(Mr),tn=nr(tn),In=nr(In),Cn.opacity=1,function(ta){return Cn.r=Mr(ta),Cn.g=tn(ta),Cn.b=In(ta),Cn+""}}}var Sn=jn(hr),Wn=jn(tr);function Rt(nr,ye){ye||(ye=[]);var Ge=nr?Math.min(ye.length,nr.length):0,Mr=ye.slice(),tn;return function(In){for(tn=0;tn<Ge;++tn)Mr[tn]=nr[tn]*(1-In)+ye[tn]*In;return Mr}}function Wt(nr){return ArrayBuffer.isView(nr)&&!(nr instanceof DataView)}function oe(nr,ye){return(Wt(ye)?Rt:Se)(nr,ye)}function Se(nr,ye){var Ge=ye?ye.length:0,Mr=nr?Math.min(Ge,nr.length):0,tn=new Array(Mr),In=new Array(Ge),Un;for(Un=0;Un<Mr;++Un)tn[Un]=Qr(nr[Un],ye[Un]);for(;Un<Ge;++Un)In[Un]=ye[Un];return function(Cn){for(Un=0;Un<Mr;++Un)In[Un]=tn[Un](Cn);return In}}function ze(nr,ye){var Ge=new Date;return nr=+nr,ye=+ye,function(Mr){return Ge.setTime(nr*(1-Mr)+ye*Mr),Ge}}function fr(nr,ye){return nr=+nr,ye=+ye,function(Ge){return nr*(1-Ge)+ye*Ge}}function wr(nr,ye){var Ge={},Mr={},tn;(nr===null||te(nr)!=="object")&&(nr={}),(ye===null||te(ye)!=="object")&&(ye={});for(tn in ye)tn in nr?Ge[tn]=Qr(nr[tn],ye[tn]):Mr[tn]=ye[tn];return function(In){for(tn in Ge)Mr[tn]=Ge[tn](In);return Mr}}var Le=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ur=new RegExp(Le.source,"g");function Wr(nr){return function(){return nr}}function wn(nr){return function(ye){return nr(ye)+""}}function qr(nr,ye){var Ge=Le.lastIndex=ur.lastIndex=0,Mr,tn,In,Un=-1,Cn=[],ta=[];for(nr=nr+"",ye=ye+"";(Mr=Le.exec(nr))&&(tn=ur.exec(ye));)(In=tn.index)>Ge&&(In=ye.slice(Ge,In),Cn[Un]?Cn[Un]+=In:Cn[++Un]=In),(Mr=Mr[0])===(tn=tn[0])?Cn[Un]?Cn[Un]+=tn:Cn[++Un]=tn:(Cn[++Un]=null,ta.push({i:Un,x:fr(Mr,tn)})),Ge=ur.lastIndex;return Ge<ye.length&&(In=ye.slice(Ge),Cn[Un]?Cn[Un]+=In:Cn[++Un]=In),Cn.length<2?ta[0]?wn(ta[0].x):Wr(ye):(ye=ta.length,function(Wa){for(var es=0,ko;es<ye;++es)Cn[(ko=ta[es]).i]=ko.x(Wa);return Cn.join("")})}function Qr(nr,ye){var Ge=te(ye),Mr;return ye==null||Ge==="boolean"?Br(ye):(Ge==="number"?fr:Ge==="string"?(Mr=Et(ye))?(ye=Mr,zn):qr:ye instanceof Et?zn:ye instanceof Date?ze:Wt(ye)?Rt:Array.isArray(ye)?Se:typeof ye.valueOf!="function"&&typeof ye.toString!="function"||isNaN(ye)?wr:fr)(nr,ye)}var Mn=ot(93924),bi=ot(47575),wi=function(nr){return["fill","stroke","fillStyle","strokeStyle"].includes(nr)},Kr=function(nr){return/^[r,R,L,l]{1}[\s]*\(/.test(nr)},ai=[1,0,0,0,1,0,0,0,1];function li(nr,ye,Ge){var Mr={},tn=ye.fromAttrs,In=ye.toAttrs;if(!nr.destroyed){var Un;for(var Cn in In)if(!(0,K.Xy)(tn[Cn],In[Cn]))if(Cn==="path"){var ta=In[Cn],Wa=tn[Cn];ta.length>Wa.length?(ta=bi.parsePathString(In[Cn]),Wa=bi.parsePathString(tn[Cn]),Wa=bi.fillPathByDiff(Wa,ta),Wa=bi.formatPath(Wa,ta),ye.fromAttrs.path=Wa,ye.toAttrs.path=ta):ye.pathFormatted||(ta=bi.parsePathString(In[Cn]),Wa=bi.parsePathString(tn[Cn]),Wa=bi.formatPath(Wa,ta),ye.fromAttrs.path=Wa,ye.toAttrs.path=ta,ye.pathFormatted=!0),Mr[Cn]=[];for(var es=0;es<ta.length;es++){for(var ko=ta[es],ns=Wa[es],Ya=[],Go=0;Go<ko.length;Go++)(0,K.hj)(ko[Go])&&ns&&(0,K.hj)(ns[Go])?(Un=Qr(ns[Go],ko[Go]),Ya.push(Un(Ge))):Ya.push(ko[Go]);Mr[Cn].push(Ya)}}else if(Cn==="matrix"){var pu=oe(tn[Cn]||ai,In[Cn]||ai),ys=pu(Ge);Mr[Cn]=ys}else wi(Cn)&&Kr(In[Cn])?Mr[Cn]=In[Cn]:(0,K.mf)(In[Cn])||(Un=Qr(tn[Cn],In[Cn]),Mr[Cn]=Un(Ge));nr.attr(Mr)}}function hi(nr,ye,Ge){var Mr=ye.startTime,tn=ye.delay;if(Ge<Mr+tn||ye._paused)return!1;var In,Un=ye.duration,Cn=ye.easing,ta=(0,Mn._)(Cn);if(Ge=Ge-Mr-ye.delay,ye.repeat)In=Ge%Un/Un,In=ta(In);else if(In=Ge/Un,In<1)In=ta(In);else return ye.onFrame?nr.attr(ye.onFrame(1)):nr.attr(ye.toAttrs),!0;if(ye.onFrame){var Wa=ye.onFrame(In);nr.attr(Wa)}else li(nr,ye,In);return!1}var ra=function(){function nr(ye){this.animators=[],this.current=0,this.timer=null,this.canvas=ye}return nr.prototype.initTimer=function(){var ye=this,Ge=!1,Mr,tn,In;this.timer=Mt(function(Un){if(ye.current=Un,ye.animators.length>0){for(var Cn=ye.animators.length-1;Cn>=0;Cn--){if(Mr=ye.animators[Cn],Mr.destroyed){ye.removeAnimator(Cn);continue}if(!Mr.isAnimatePaused()){tn=Mr.get("animations");for(var ta=tn.length-1;ta>=0;ta--)In=tn[ta],Ge=hi(Mr,In,Un),Ge&&(tn.splice(ta,1),Ge=!1,In.callback&&In.callback())}tn.length===0&&ye.removeAnimator(Cn)}var Wa=ye.canvas.get("autoDraw");Wa||ye.canvas.draw()}})},nr.prototype.addAnimator=function(ye){this.animators.push(ye)},nr.prototype.removeAnimator=function(ye){this.animators.splice(ye,1)},nr.prototype.isAnimating=function(){return!!this.animators.length},nr.prototype.stop=function(){this.timer&&this.timer.stop()},nr.prototype.stopAllAnimations=function(ye){ye===void 0&&(ye=!0),this.animators.forEach(function(Ge){Ge.stopAnimate(ye)}),this.animators=[],this.canvas.draw()},nr.prototype.getTime=function(){return this.current},nr}(),Ci=ra,Ba=ot(89473),po=40,za=0,Xa=":",Ta=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function ga(nr,ye){for(var Ge in nr)if(nr.hasOwnProperty(Ge)&&Ge.indexOf(Xa+ye)>=0)return!0;return!1}function no(nr,ye,Ge){Ge.name=ye,Ge.target=nr,Ge.currentTarget=nr,Ge.delegateTarget=nr,nr.emit(ye,Ge)}function Vo(nr,ye,Ge){if(Ge.bubbles){var Mr=void 0,tn=!1;if(ye==="mouseenter"?(Mr=Ge.fromShape,tn=!0):ye==="mouseleave"&&(tn=!0,Mr=Ge.toShape),nr.isCanvas()&&tn)return;if(Mr&&(0,xt.UY)(nr,Mr)){Ge.bubbles=!1;return}Ge.name=ye,Ge.currentTarget=nr,Ge.delegateTarget=nr,nr.emit(ye,Ge)}}var vo=function(){function nr(ye){var Ge=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(Mr){var tn=Mr.type;Ge._triggerEvent(tn,Mr)},this._onDocumentMove=function(Mr){var tn=Ge.canvas,In=tn.get("el");if(In!==Mr.target&&(Ge.dragging||Ge.currentShape)){var Un=Ge._getPointInfo(Mr);Ge.dragging&&Ge._emitEvent("drag",Mr,Un,Ge.draggingShape)}},this._onDocumentMouseUp=function(Mr){var tn=Ge.canvas,In=tn.get("el");if(In!==Mr.target&&Ge.dragging){var Un=Ge._getPointInfo(Mr);Ge.draggingShape&&Ge._emitEvent("drop",Mr,Un,null),Ge._emitEvent("dragend",Mr,Un,Ge.draggingShape),Ge._afterDrag(Ge.draggingShape,Un,Mr)}},this.canvas=ye.canvas}return nr.prototype.init=function(){this._bindEvents()},nr.prototype._bindEvents=function(){var ye=this,Ge=this.canvas.get("el");(0,xt.S6)(Ta,function(Mr){Ge.addEventListener(Mr,ye._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},nr.prototype._clearEvents=function(){var ye=this,Ge=this.canvas.get("el");(0,xt.S6)(Ta,function(Mr){Ge.removeEventListener(Mr,ye._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},nr.prototype._getEventObj=function(ye,Ge,Mr,tn,In,Un){var Cn=new Ba.Z(ye,Ge);return Cn.fromShape=In,Cn.toShape=Un,Cn.x=Mr.x,Cn.y=Mr.y,Cn.clientX=Mr.clientX,Cn.clientY=Mr.clientY,Cn.propagationPath.push(tn),Cn},nr.prototype._getShape=function(ye,Ge){return this.canvas.getShape(ye.x,ye.y,Ge)},nr.prototype._getPointInfo=function(ye){var Ge=this.canvas,Mr=Ge.getClientByEvent(ye),tn=Ge.getPointByEvent(ye);return{x:tn.x,y:tn.y,clientX:Mr.x,clientY:Mr.y}},nr.prototype._triggerEvent=function(ye,Ge){var Mr=this._getPointInfo(Ge),tn=this._getShape(Mr,Ge),In=this["_on"+ye],Un=!1;if(In)In.call(this,Mr,tn,Ge);else{var Cn=this.currentShape;ye==="mouseenter"||ye==="dragenter"||ye==="mouseover"?(this._emitEvent(ye,Ge,Mr,null,null,tn),tn&&this._emitEvent(ye,Ge,Mr,tn,null,tn),ye==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",Ge,Mr,null)):ye==="mouseleave"||ye==="dragleave"||ye==="mouseout"?(Un=!0,Cn&&this._emitEvent(ye,Ge,Mr,Cn,Cn,null),this._emitEvent(ye,Ge,Mr,null,Cn,null),ye==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",Ge,Mr,null)):this._emitEvent(ye,Ge,Mr,tn,null,null)}if(Un||(this.currentShape=tn),tn&&!tn.get("destroyed")){var ta=this.canvas,Wa=ta.get("el");Wa.style.cursor=tn.attr("cursor")||ta.get("cursor")}},nr.prototype._onmousedown=function(ye,Ge,Mr){Mr.button===za&&(this.mousedownShape=Ge,this.mousedownPoint=ye,this.mousedownTimeStamp=Mr.timeStamp),this._emitEvent("mousedown",Mr,ye,Ge,null,null)},nr.prototype._emitMouseoverEvents=function(ye,Ge,Mr,tn){var In=this.canvas.get("el");Mr!==tn&&(Mr&&(this._emitEvent("mouseout",ye,Ge,Mr,Mr,tn),this._emitEvent("mouseleave",ye,Ge,Mr,Mr,tn),(!tn||tn.get("destroyed"))&&(In.style.cursor=this.canvas.get("cursor"))),tn&&(this._emitEvent("mouseover",ye,Ge,tn,Mr,tn),this._emitEvent("mouseenter",ye,Ge,tn,Mr,tn)))},nr.prototype._emitDragoverEvents=function(ye,Ge,Mr,tn,In){tn?(tn!==Mr&&(Mr&&this._emitEvent("dragleave",ye,Ge,Mr,Mr,tn),this._emitEvent("dragenter",ye,Ge,tn,Mr,tn)),In||this._emitEvent("dragover",ye,Ge,tn)):Mr&&this._emitEvent("dragleave",ye,Ge,Mr,Mr,tn),In&&this._emitEvent("dragover",ye,Ge,tn)},nr.prototype._afterDrag=function(ye,Ge,Mr){ye&&(ye.set("capture",!0),this.draggingShape=null),this.dragging=!1;var tn=this._getShape(Ge,Mr);tn!==ye&&this._emitMouseoverEvents(Mr,Ge,ye,tn),this.currentShape=tn},nr.prototype._onmouseup=function(ye,Ge,Mr){if(Mr.button===za){var tn=this.draggingShape;this.dragging?(tn&&this._emitEvent("drop",Mr,ye,Ge),this._emitEvent("dragend",Mr,ye,tn),this._afterDrag(tn,ye,Mr)):(this._emitEvent("mouseup",Mr,ye,Ge),Ge===this.mousedownShape&&this._emitEvent("click",Mr,ye,Ge),this.mousedownShape=null,this.mousedownPoint=null)}},nr.prototype._ondragover=function(ye,Ge,Mr){Mr.preventDefault();var tn=this.currentShape;this._emitDragoverEvents(Mr,ye,tn,Ge,!0)},nr.prototype._onmousemove=function(ye,Ge,Mr){var tn=this.canvas,In=this.currentShape,Un=this.draggingShape;if(this.dragging)Un&&this._emitDragoverEvents(Mr,ye,In,Ge,!1),this._emitEvent("drag",Mr,ye,Un);else{var Cn=this.mousedownPoint;if(Cn){var ta=this.mousedownShape,Wa=Mr.timeStamp,es=Wa-this.mousedownTimeStamp,ko=Cn.clientX-ye.clientX,ns=Cn.clientY-ye.clientY,Ya=ko*ko+ns*ns;es>120||Ya>po?ta&&ta.get("draggable")?(Un=this.mousedownShape,Un.set("capture",!1),this.draggingShape=Un,this.dragging=!0,this._emitEvent("dragstart",Mr,ye,Un),this.mousedownShape=null,this.mousedownPoint=null):!ta&&tn.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",Mr,ye,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(Mr,ye,In,Ge),this._emitEvent("mousemove",Mr,ye,Ge)):(this._emitMouseoverEvents(Mr,ye,In,Ge),this._emitEvent("mousemove",Mr,ye,Ge))}else this._emitMouseoverEvents(Mr,ye,In,Ge),this._emitEvent("mousemove",Mr,ye,Ge)}},nr.prototype._emitEvent=function(ye,Ge,Mr,tn,In,Un){var Cn=this._getEventObj(ye,Ge,Mr,tn,In,Un);if(tn){Cn.shape=tn,no(tn,ye,Cn);for(var ta=tn.getParent();ta;)ta.emitDelegation(ye,Cn),Cn.propagationStopped||Vo(ta,ye,Cn),Cn.propagationPath.push(ta),ta=ta.getParent()}else{var Wa=this.canvas;no(Wa,ye,Cn)}},nr.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},nr}(),ja=vo,to="px",Uo=(0,bt.qY)(),ju=Uo&&Uo.name==="firefox",Wo=function(nr){(0,kt.ZT)(ye,nr);function ye(Ge){var Mr=nr.call(this,Ge)||this;return Mr.initContainer(),Mr.initDom(),Mr.initEvents(),Mr.initTimeline(),Mr}return ye.prototype.getDefaultCfg=function(){var Ge=nr.prototype.getDefaultCfg.call(this);return Ge.cursor="default",Ge.supportCSSTransform=!1,Ge},ye.prototype.initContainer=function(){var Ge=this.get("container");(0,xt.HD)(Ge)&&(Ge=document.getElementById(Ge),this.set("container",Ge))},ye.prototype.initDom=function(){var Ge=this.createDom();this.set("el",Ge);var Mr=this.get("container");Mr.appendChild(Ge),this.setDOMSize(this.get("width"),this.get("height"))},ye.prototype.initEvents=function(){var Ge=new ja({canvas:this});Ge.init(),this.set("eventController",Ge)},ye.prototype.initTimeline=function(){var Ge=new Ci(this);this.set("timeline",Ge)},ye.prototype.setDOMSize=function(Ge,Mr){var tn=this.get("el");xt.jU&&(tn.style.width=Ge+to,tn.style.height=Mr+to)},ye.prototype.changeSize=function(Ge,Mr){this.setDOMSize(Ge,Mr),this.set("width",Ge),this.set("height",Mr),this.onCanvasChange("changeSize")},ye.prototype.getRenderer=function(){return this.get("renderer")},ye.prototype.getCursor=function(){return this.get("cursor")},ye.prototype.setCursor=function(Ge){this.set("cursor",Ge);var Mr=this.get("el");xt.jU&&Mr&&(Mr.style.cursor=Ge)},ye.prototype.getPointByEvent=function(Ge){var Mr=this.get("supportCSSTransform");if(Mr){if(ju&&!(0,xt.kK)(Ge.layerX)&&Ge.layerX!==Ge.offsetX)return{x:Ge.layerX,y:Ge.layerY};if(!(0,xt.kK)(Ge.offsetX))return{x:Ge.offsetX,y:Ge.offsetY}}var tn=this.getClientByEvent(Ge),In=tn.x,Un=tn.y;return this.getPointByClient(In,Un)},ye.prototype.getClientByEvent=function(Ge){var Mr=Ge;return Ge.touches&&(Ge.type==="touchend"?Mr=Ge.changedTouches[0]:Mr=Ge.touches[0]),{x:Mr.clientX,y:Mr.clientY}},ye.prototype.getPointByClient=function(Ge,Mr){var tn=this.get("el"),In=tn.getBoundingClientRect();return{x:Ge-In.left,y:Mr-In.top}},ye.prototype.getClientByPoint=function(Ge,Mr){var tn=this.get("el"),In=tn.getBoundingClientRect();return{x:Ge+In.left,y:Mr+In.top}},ye.prototype.draw=function(){},ye.prototype.removeDom=function(){var Ge=this.get("el");Ge.parentNode.removeChild(Ge)},ye.prototype.clearEvents=function(){var Ge=this.get("eventController");Ge.destroy()},ye.prototype.isCanvas=function(){return!0},ye.prototype.getParent=function(){return null},ye.prototype.destroy=function(){var Ge=this.get("timeline");this.get("destroyed")||(this.clear(),Ge&&Ge.stop(),this.clearEvents(),this.removeDom(),nr.prototype.destroy.call(this))},ye}(I.Z),bo=Wo},37153:function(gn,Ot,ot){"use strict";var kt=ot(70655),bt=ot(45098),I=ot(29881),xt=ot(77341),K={},ut="_INDEX";function ht(Ut,P){if(Ut.set("canvas",P),Ut.isGroup()){var b=Ut.get("children");b.length&&b.forEach(function(W){ht(W,P)})}}function lt(Ut,P){if(Ut.set("timeline",P),Ut.isGroup()){var b=Ut.get("children");b.length&&b.forEach(function(W){lt(W,P)})}}function tt(Ut,P){var b=Ut.getChildren();return b.indexOf(P)>=0}function be(Ut,P,b){b===void 0&&(b=!0),b?P.destroy():(P.set("parent",null),P.set("canvas",null)),(0,xt.As)(Ut.getChildren(),P)}function it(Ut){return function(P,b){var W=Ut(P,b);return W===0?P[ut]-b[ut]:W}}var st=function(Ut){(0,kt.ZT)(P,Ut);function P(){return Ut!==null&&Ut.apply(this,arguments)||this}return P.prototype.isCanvas=function(){return!1},P.prototype.getBBox=function(){var b=1/0,W=-1/0,fe=1/0,Ee=-1/0,Te=[],Mt=[],et=this.getChildren().filter(function(we){return we.get("visible")&&(!we.isGroup()||we.isGroup()&&we.getChildren().length>0)});et.length>0?((0,xt.S6)(et,function(we){var _e=we.getBBox();Te.push(_e.minX,_e.maxX),Mt.push(_e.minY,_e.maxY)}),b=(0,bt.VV)(Te),W=(0,bt.Fp)(Te),fe=(0,bt.VV)(Mt),Ee=(0,bt.Fp)(Mt)):(b=0,W=0,fe=0,Ee=0);var Dt={x:b,y:fe,minX:b,minY:fe,maxX:W,maxY:Ee,width:W-b,height:Ee-fe};return Dt},P.prototype.getCanvasBBox=function(){var b=1/0,W=-1/0,fe=1/0,Ee=-1/0,Te=[],Mt=[],et=this.getChildren().filter(function(we){return we.get("visible")&&(!we.isGroup()||we.isGroup()&&we.getChildren().length>0)});et.length>0?((0,xt.S6)(et,function(we){var _e=we.getCanvasBBox();Te.push(_e.minX,_e.maxX),Mt.push(_e.minY,_e.maxY)}),b=(0,bt.VV)(Te),W=(0,bt.Fp)(Te),fe=(0,bt.VV)(Mt),Ee=(0,bt.Fp)(Mt)):(b=0,W=0,fe=0,Ee=0);var Dt={x:b,y:fe,minX:b,minY:fe,maxX:W,maxY:Ee,width:W-b,height:Ee-fe};return Dt},P.prototype.getDefaultCfg=function(){var b=Ut.prototype.getDefaultCfg.call(this);return b.children=[],b},P.prototype.onAttrChange=function(b,W,fe){if(Ut.prototype.onAttrChange.call(this,b,W,fe),b==="matrix"){var Ee=this.getTotalMatrix();this._applyChildrenMarix(Ee)}},P.prototype.applyMatrix=function(b){var W=this.getTotalMatrix();Ut.prototype.applyMatrix.call(this,b);var fe=this.getTotalMatrix();fe!==W&&this._applyChildrenMarix(fe)},P.prototype._applyChildrenMarix=function(b){var W=this.getChildren();(0,xt.S6)(W,function(fe){fe.applyMatrix(b)})},P.prototype.addShape=function(){for(var b=[],W=0;W<arguments.length;W++)b[W]=arguments[W];var fe=b[0],Ee=b[1];(0,xt.Kn)(fe)?Ee=fe:Ee.type=fe;var Te=K[Ee.type];Te||(Te=(0,xt.jC)(Ee.type),K[Ee.type]=Te);var Mt=this.getShapeBase(),et=new Mt[Te](Ee);return this.add(et),et},P.prototype.addGroup=function(){for(var b=[],W=0;W<arguments.length;W++)b[W]=arguments[W];var fe=b[0],Ee=b[1],Te;if((0,xt.mf)(fe))Ee?Te=new fe(Ee):Te=new fe({parent:this});else{var Mt=fe||{},et=this.getGroupBase();Te=new et(Mt)}return this.add(Te),Te},P.prototype.getCanvas=function(){var b;return this.isCanvas()?b=this:b=this.get("canvas"),b},P.prototype.getShape=function(b,W,fe){if(!(0,xt.pP)(this))return null;var Ee=this.getChildren(),Te;if(this.isCanvas())Te=this._findShape(Ee,b,W,fe);else{var Mt=[b,W,1];Mt=this.invertFromMatrix(Mt),this.isClipped(Mt[0],Mt[1])||(Te=this._findShape(Ee,Mt[0],Mt[1],fe))}return Te},P.prototype._findShape=function(b,W,fe,Ee){for(var Te=null,Mt=b.length-1;Mt>=0;Mt--){var et=b[Mt];if((0,xt.pP)(et)&&(et.isGroup()?Te=et.getShape(W,fe,Ee):et.isHit(W,fe)&&(Te=et)),Te)break}return Te},P.prototype.add=function(b){var W=this.getCanvas(),fe=this.getChildren(),Ee=this.get("timeline"),Te=b.getParent();Te&&be(Te,b,!1),b.set("parent",this),W&&ht(b,W),Ee&&lt(b,Ee),fe.push(b),b.onCanvasChange("add"),this._applyElementMatrix(b)},P.prototype._applyElementMatrix=function(b){var W=this.getTotalMatrix();W&&b.applyMatrix(W)},P.prototype.getChildren=function(){return this.get("children")},P.prototype.sort=function(){var b=this.getChildren();(0,xt.S6)(b,function(W,fe){return W[ut]=fe,W}),b.sort(it(function(W,fe){return W.get("zIndex")-fe.get("zIndex")})),this.onCanvasChange("sort")},P.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var b=this.getChildren(),W=b.length-1;W>=0;W--)b[W].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},P.prototype.destroy=function(){this.get("destroyed")||(this.clear(),Ut.prototype.destroy.call(this))},P.prototype.getFirst=function(){return this.getChildByIndex(0)},P.prototype.getLast=function(){var b=this.getChildren();return this.getChildByIndex(b.length-1)},P.prototype.getChildByIndex=function(b){var W=this.getChildren();return W[b]},P.prototype.getCount=function(){var b=this.getChildren();return b.length},P.prototype.contain=function(b){var W=this.getChildren();return W.indexOf(b)>-1},P.prototype.removeChild=function(b,W){W===void 0&&(W=!0),this.contain(b)&&b.remove(W)},P.prototype.findAll=function(b){var W=[],fe=this.getChildren();return(0,xt.S6)(fe,function(Ee){b(Ee)&&W.push(Ee),Ee.isGroup()&&(W=W.concat(Ee.findAll(b)))}),W},P.prototype.find=function(b){var W=null,fe=this.getChildren();return(0,xt.S6)(fe,function(Ee){if(b(Ee)?W=Ee:Ee.isGroup()&&(W=Ee.find(b)),W)return!1}),W},P.prototype.findById=function(b){return this.find(function(W){return W.get("id")===b})},P.prototype.findByClassName=function(b){return this.find(function(W){return W.get("className")===b})},P.prototype.findAllByName=function(b){return this.findAll(function(W){return W.get("name")===b})},P}(I.Z);Ot.Z=st},29881:function(gn,Ot,ot){"use strict";var kt=ot(70655),bt=ot(45098),I=ot(31506),xt=ot(77341),K=ot(41482),ut=ot(2667),ht=I.vs,lt="matrix",tt=["zIndex","capture","visible","type"],be=["repeat"],it=":",st="*";function Ut(Ee){for(var Te=[],Mt=0;Mt<Ee.length;Mt++)(0,bt.kJ)(Ee[Mt])?Te.push([].concat(Ee[Mt])):Te.push(Ee[Mt]);return Te}function P(Ee,Te){var Mt={},et=Te.attrs;for(var Dt in Ee)Mt[Dt]=et[Dt];return Mt}function b(Ee,Te){var Mt={},et=Te.attr();return(0,bt.S6)(Ee,function(Dt,we){be.indexOf(we)===-1&&!(0,bt.Xy)(et[we],Dt)&&(Mt[we]=Dt)}),Mt}function W(Ee,Te){if(Te.onFrame)return Ee;var Mt=Te.startTime,et=Te.delay,Dt=Te.duration,we=Object.prototype.hasOwnProperty;return(0,bt.S6)(Ee,function(_e){Mt+et<_e.startTime+_e.delay+_e.duration&&Dt>_e.delay&&(0,bt.S6)(Te.toAttrs,function(ge,te){we.call(_e.toAttrs,te)&&(delete _e.toAttrs[te],delete _e.fromAttrs[te])})}),Ee}var fe=function(Ee){(0,kt.ZT)(Te,Ee);function Te(Mt){var et=Ee.call(this,Mt)||this;et.attrs={};var Dt=et.getDefaultAttrs();return(0,bt.CD)(Dt,Mt.attrs),et.attrs=Dt,et.initAttrs(Dt),et.initAnimate(),et}return Te.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},Te.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},Te.prototype.onCanvasChange=function(Mt){},Te.prototype.initAttrs=function(Mt){},Te.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},Te.prototype.isGroup=function(){return!1},Te.prototype.getParent=function(){return this.get("parent")},Te.prototype.getCanvas=function(){return this.get("canvas")},Te.prototype.attr=function(){for(var Mt,et=[],Dt=0;Dt<arguments.length;Dt++)et[Dt]=arguments[Dt];var we=et[0],_e=et[1];if(!we)return this.attrs;if((0,bt.Kn)(we)){for(var ge in we)this.setAttr(ge,we[ge]);return this.afterAttrsChange(we),this}return et.length===2?(this.setAttr(we,_e),this.afterAttrsChange((Mt={},Mt[we]=_e,Mt)),this):this.attrs[we]},Te.prototype.isClipped=function(Mt,et){var Dt=this.getClip();return Dt&&!Dt.isHit(Mt,et)},Te.prototype.setAttr=function(Mt,et){var Dt=this.attrs[Mt];Dt!==et&&(this.attrs[Mt]=et,this.onAttrChange(Mt,et,Dt))},Te.prototype.onAttrChange=function(Mt,et,Dt){Mt==="matrix"&&this.set("totalMatrix",null)},Te.prototype.afterAttrsChange=function(Mt){if(this.cfg.isClipShape){var et=this.cfg.applyTo;et&&et.onCanvasChange("clip")}else this.onCanvasChange("attr")},Te.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},Te.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},Te.prototype.setZIndex=function(Mt){this.set("zIndex",Mt);var et=this.getParent();return et&&et.sort(),this},Te.prototype.toFront=function(){var Mt=this.getParent();if(!!Mt){var et=Mt.getChildren(),Dt=this.get("el"),we=et.indexOf(this);et.splice(we,1),et.push(this),this.onCanvasChange("zIndex")}},Te.prototype.toBack=function(){var Mt=this.getParent();if(!!Mt){var et=Mt.getChildren(),Dt=this.get("el"),we=et.indexOf(this);et.splice(we,1),et.unshift(this),this.onCanvasChange("zIndex")}},Te.prototype.remove=function(Mt){Mt===void 0&&(Mt=!0);var et=this.getParent();et?((0,xt.As)(et.getChildren(),this),et.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),Mt&&this.destroy()},Te.prototype.resetMatrix=function(){this.attr(lt,this.getDefaultMatrix()),this.onCanvasChange("matrix")},Te.prototype.getMatrix=function(){return this.attr(lt)},Te.prototype.setMatrix=function(Mt){this.attr(lt,Mt),this.onCanvasChange("matrix")},Te.prototype.getTotalMatrix=function(){var Mt=this.cfg.totalMatrix;if(!Mt){var et=this.attr("matrix"),Dt=this.cfg.parentMatrix;Dt&&et?Mt=(0,K.xq)(Dt,et):Mt=et||Dt,this.set("totalMatrix",Mt)}return Mt},Te.prototype.applyMatrix=function(Mt){var et=this.attr("matrix"),Dt=null;Mt&&et?Dt=(0,K.xq)(Mt,et):Dt=et||Mt,this.set("totalMatrix",Dt),this.set("parentMatrix",Mt)},Te.prototype.getDefaultMatrix=function(){return null},Te.prototype.applyToMatrix=function(Mt){var et=this.attr("matrix");return et?(0,K.rG)(et,Mt):Mt},Te.prototype.invertFromMatrix=function(Mt){var et=this.attr("matrix");if(et){var Dt=(0,K.U_)(et);if(Dt)return(0,K.rG)(Dt,Mt)}return Mt},Te.prototype.setClip=function(Mt){var et=this.getCanvas(),Dt=null;if(Mt){var we=this.getShapeBase(),_e=(0,bt.jC)(Mt.type),ge=we[_e];ge&&(Dt=new ge({type:Mt.type,isClipShape:!0,applyTo:this,attrs:Mt.attrs,canvas:et}))}return this.set("clipShape",Dt),this.onCanvasChange("clip"),Dt},Te.prototype.getClip=function(){var Mt=this.cfg.clipShape;return Mt||null},Te.prototype.clone=function(){var Mt=this,et=this.attrs,Dt={};(0,bt.S6)(et,function(ge,te){(0,bt.kJ)(et[te])?Dt[te]=Ut(et[te]):Dt[te]=et[te]});var we=this.constructor,_e=new we({attrs:Dt});return(0,bt.S6)(tt,function(ge){_e.set(ge,Mt.get(ge))}),_e},Te.prototype.destroy=function(){var Mt=this.destroyed;Mt||(this.attrs={},Ee.prototype.destroy.call(this))},Te.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},Te.prototype.animate=function(){for(var Mt=[],et=0;et<arguments.length;et++)Mt[et]=arguments[et];if(!(!this.get("timeline")&&!this.get("canvas"))){this.set("animating",!0);var Dt=this.get("timeline");Dt||(Dt=this.get("canvas").get("timeline"),this.set("timeline",Dt));var we=this.get("animations")||[];Dt.timer||Dt.initTimer();var _e=Mt[0],ge=Mt[1],te=Mt[2],xe=te===void 0?"easeLinear":te,Ye=Mt[3],Lt=Ye===void 0?bt.ZT:Ye,Qt=Mt[4],ct=Qt===void 0?0:Qt,Ct,Y,yt,Xt,ie;(0,bt.mf)(_e)?(Ct=_e,_e={}):(0,bt.Kn)(_e)&&_e.onFrame&&(Ct=_e.onFrame,Y=_e.repeat),(0,bt.Kn)(ge)?(ie=ge,ge=ie.duration,xe=ie.easing||"easeLinear",ct=ie.delay||0,Y=ie.repeat||Y||!1,Lt=ie.callback||bt.ZT,yt=ie.pauseCallback||bt.ZT,Xt=ie.resumeCallback||bt.ZT):((0,bt.hj)(Lt)&&(ct=Lt,Lt=null),(0,bt.mf)(xe)?(Lt=xe,xe="easeLinear"):xe=xe||"easeLinear");var Ce=b(_e,this),er={fromAttrs:P(Ce,this),toAttrs:Ce,duration:ge,easing:xe,repeat:Y,callback:Lt,pauseCallback:yt,resumeCallback:Xt,delay:ct,startTime:Dt.getTime(),id:(0,bt.EL)(),onFrame:Ct,pathFormatted:!1};we.length>0?we=W(we,er):Dt.addAnimator(this),we.push(er),this.set("animations",we),this.set("_pause",{isPaused:!1})}},Te.prototype.stopAnimate=function(Mt){var et=this;Mt===void 0&&(Mt=!0);var Dt=this.get("animations");(0,bt.S6)(Dt,function(we){Mt&&(we.onFrame?et.attr(we.onFrame(1)):et.attr(we.toAttrs)),we.callback&&we.callback()}),this.set("animating",!1),this.set("animations",[])},Te.prototype.pauseAnimate=function(){var Mt=this.get("timeline"),et=this.get("animations"),Dt=Mt.getTime();return(0,bt.S6)(et,function(we){we._paused=!0,we._pauseTime=Dt,we.pauseCallback&&we.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:Dt}),this},Te.prototype.resumeAnimate=function(){var Mt=this.get("timeline"),et=Mt.getTime(),Dt=this.get("animations"),we=this.get("_pause").pauseTime;return(0,bt.S6)(Dt,function(_e){_e.startTime=_e.startTime+(et-we),_e._paused=!1,_e._pauseTime=null,_e.resumeCallback&&_e.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",Dt),this},Te.prototype.emitDelegation=function(Mt,et){var Dt=this,we=et.propagationPath,_e=this.getEvents(),ge;Mt==="mouseenter"?ge=et.fromShape:Mt==="mouseleave"&&(ge=et.toShape);for(var te=function(Qt){var ct=we[Qt],Ct=ct.get("name");if(Ct){if((ct.isGroup()||ct.isCanvas&&ct.isCanvas())&&ge&&(0,xt.UY)(ct,ge))return"break";(0,bt.kJ)(Ct)?(0,bt.S6)(Ct,function(Y){Dt.emitDelegateEvent(ct,Y,et)}):xe.emitDelegateEvent(ct,Ct,et)}},xe=this,Ye=0;Ye<we.length;Ye++){var Lt=te(Ye);if(Lt==="break")break}},Te.prototype.emitDelegateEvent=function(Mt,et,Dt){var we=this.getEvents(),_e=et+it+Dt.type;(we[_e]||we[st])&&(Dt.name=_e,Dt.currentTarget=Mt,Dt.delegateTarget=this,Dt.delegateObject=Mt.get("delegateObject"),this.emit(_e,Dt))},Te.prototype.translate=function(Mt,et){Mt===void 0&&(Mt=0),et===void 0&&(et=0);var Dt=this.getMatrix(),we=ht(Dt,[["t",Mt,et]]);return this.setMatrix(we),this},Te.prototype.move=function(Mt,et){var Dt=this.attr("x")||0,we=this.attr("y")||0;return this.translate(Mt-Dt,et-we),this},Te.prototype.moveTo=function(Mt,et){return this.move(Mt,et)},Te.prototype.scale=function(Mt,et){var Dt=this.getMatrix(),we=ht(Dt,[["s",Mt,et||Mt]]);return this.setMatrix(we),this},Te.prototype.rotate=function(Mt){var et=this.getMatrix(),Dt=ht(et,[["r",Mt]]);return this.setMatrix(Dt),this},Te.prototype.rotateAtStart=function(Mt){var et=this.attr(),Dt=et.x,we=et.y,_e=this.getMatrix(),ge=ht(_e,[["t",-Dt,-we],["r",Mt],["t",Dt,we]]);return this.setMatrix(ge),this},Te.prototype.rotateAtPoint=function(Mt,et,Dt){var we=this.getMatrix(),_e=ht(we,[["t",-Mt,-et],["r",Dt],["t",Mt,et]]);return this.setMatrix(_e),this},Te}(ut.Z);Ot.Z=fe},31841:function(gn,Ot,ot){"use strict";var kt=ot(70655),bt=ot(37153),I=function(xt){(0,kt.ZT)(K,xt);function K(){return xt!==null&&xt.apply(this,arguments)||this}return K.prototype.isGroup=function(){return!0},K.prototype.isEntityGroup=function(){return!1},K.prototype.clone=function(){for(var ut=xt.prototype.clone.call(this),ht=this.getChildren(),lt=0;lt<ht.length;lt++){var tt=ht[lt];ut.add(tt.clone())}return ut},K}(bt.Z);Ot.Z=I},15032:function(gn,Ot,ot){"use strict";var kt=ot(70655),bt=ot(29881),I=ot(41482),xt=function(K){(0,kt.ZT)(ut,K);function ut(ht){return K.call(this,ht)||this}return ut.prototype._isInBBox=function(ht,lt){var tt=this.getBBox();return tt.minX<=ht&&tt.maxX>=ht&&tt.minY<=lt&&tt.maxY>=lt},ut.prototype.afterAttrsChange=function(ht){K.prototype.afterAttrsChange.call(this,ht),this.clearCacheBBox()},ut.prototype.getBBox=function(){var ht=this.cfg.bbox;return ht||(ht=this.calculateBBox(),this.set("bbox",ht)),ht},ut.prototype.getCanvasBBox=function(){var ht=this.cfg.canvasBBox;return ht||(ht=this.calculateCanvasBBox(),this.set("canvasBBox",ht)),ht},ut.prototype.applyMatrix=function(ht){K.prototype.applyMatrix.call(this,ht),this.set("canvasBBox",null)},ut.prototype.calculateCanvasBBox=function(){var ht=this.getBBox(),lt=this.getTotalMatrix(),tt=ht.minX,be=ht.minY,it=ht.maxX,st=ht.maxY;if(lt){var Ut=(0,I.rG)(lt,[ht.minX,ht.minY]),P=(0,I.rG)(lt,[ht.maxX,ht.minY]),b=(0,I.rG)(lt,[ht.minX,ht.maxY]),W=(0,I.rG)(lt,[ht.maxX,ht.maxY]);tt=Math.min(Ut[0],P[0],b[0],W[0]),it=Math.max(Ut[0],P[0],b[0],W[0]),be=Math.min(Ut[1],P[1],b[1],W[1]),st=Math.max(Ut[1],P[1],b[1],W[1])}var fe=this.attrs;if(fe.shadowColor){var Ee=fe.shadowBlur,Te=Ee===void 0?0:Ee,Mt=fe.shadowOffsetX,et=Mt===void 0?0:Mt,Dt=fe.shadowOffsetY,we=Dt===void 0?0:Dt,_e=tt-Te+et,ge=it+Te+et,te=be-Te+we,xe=st+Te+we;tt=Math.min(tt,_e),it=Math.max(it,ge),be=Math.min(be,te),st=Math.max(st,xe)}return{x:tt,y:be,minX:tt,minY:be,maxX:it,maxY:st,width:it-tt,height:st-be}},ut.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},ut.prototype.isClipShape=function(){return this.get("isClipShape")},ut.prototype.isInShape=function(ht,lt){return!1},ut.prototype.isOnlyHitBox=function(){return!1},ut.prototype.isHit=function(ht,lt){var tt=this.get("startArrowShape"),be=this.get("endArrowShape"),it=[ht,lt,1];it=this.invertFromMatrix(it);var st=it[0],Ut=it[1],P=this._isInBBox(st,Ut);return this.isOnlyHitBox()?P:!!(P&&!this.isClipped(st,Ut)&&(this.isInShape(st,Ut)||tt&&tt.isHit(st,Ut)||be&&be.isHit(st,Ut)))},ut}(bt.Z);Ot.Z=xt},93924:function(gn,Ot,ot){"use strict";ot.d(Ot,{_:function(){return Yt},C:function(){return St}});var kt={};ot.r(kt),ot.d(kt,{easeBack:function(){return Me},easeBackIn:function(){return Ht},easeBackInOut:function(){return Me},easeBackOut:function(){return ne},easeBounce:function(){return ie},easeBounceIn:function(){return Xt},easeBounceInOut:function(){return Ce},easeBounceOut:function(){return ie},easeCircle:function(){return _e},easeCircleIn:function(){return Dt},easeCircleInOut:function(){return _e},easeCircleOut:function(){return we},easeCubic:function(){return lt},easeCubicIn:function(){return ut},easeCubicInOut:function(){return lt},easeCubicOut:function(){return ht},easeElastic:function(){return Jt},easeElasticIn:function(){return re},easeElasticInOut:function(){return Et},easeElasticOut:function(){return Jt},easeExp:function(){return et},easeExpIn:function(){return Te},easeExpInOut:function(){return et},easeExpOut:function(){return Mt},easeLinear:function(){return bt},easePoly:function(){return st},easePolyIn:function(){return be},easePolyInOut:function(){return st},easePolyOut:function(){return it},easeQuad:function(){return K},easeQuadIn:function(){return I},easeQuadInOut:function(){return K},easeQuadOut:function(){return xt},easeSin:function(){return fe},easeSinIn:function(){return b},easeSinInOut:function(){return fe},easeSinOut:function(){return W}});function bt(At){return+At}function I(At){return At*At}function xt(At){return At*(2-At)}function K(At){return((At*=2)<=1?At*At:--At*(2-At)+1)/2}function ut(At){return At*At*At}function ht(At){return--At*At*At+1}function lt(At){return((At*=2)<=1?At*At*At:(At-=2)*At*At+2)/2}var tt=3,be=function At(ue){ue=+ue;function Pe(je){return Math.pow(je,ue)}return Pe.exponent=At,Pe}(tt),it=function At(ue){ue=+ue;function Pe(je){return 1-Math.pow(1-je,ue)}return Pe.exponent=At,Pe}(tt),st=function At(ue){ue=+ue;function Pe(je){return((je*=2)<=1?Math.pow(je,ue):2-Math.pow(2-je,ue))/2}return Pe.exponent=At,Pe}(tt),Ut=Math.PI,P=Ut/2;function b(At){return+At==1?1:1-Math.cos(At*P)}function W(At){return Math.sin(At*P)}function fe(At){return(1-Math.cos(Ut*At))/2}function Ee(At){return(Math.pow(2,-10*At)-.0009765625)*1.0009775171065494}function Te(At){return Ee(1-+At)}function Mt(At){return 1-Ee(At)}function et(At){return((At*=2)<=1?Ee(1-At):2-Ee(At-1))/2}function Dt(At){return 1-Math.sqrt(1-At*At)}function we(At){return Math.sqrt(1- --At*At)}function _e(At){return((At*=2)<=1?1-Math.sqrt(1-At*At):Math.sqrt(1-(At-=2)*At)+1)/2}var ge=4/11,te=6/11,xe=8/11,Ye=3/4,Lt=9/11,Qt=10/11,ct=15/16,Ct=21/22,Y=63/64,yt=1/ge/ge;function Xt(At){return 1-ie(1-At)}function ie(At){return(At=+At)<ge?yt*At*At:At<xe?yt*(At-=te)*At+Ye:At<Qt?yt*(At-=Lt)*At+ct:yt*(At-=Ct)*At+Y}function Ce(At){return((At*=2)<=1?1-ie(1-At):ie(At-1)+1)/2}var er=1.70158,Ht=function At(ue){ue=+ue;function Pe(je){return(je=+je)*je*(ue*(je-1)+je)}return Pe.overshoot=At,Pe}(er),ne=function At(ue){ue=+ue;function Pe(je){return--je*je*((je+1)*ue+je)+1}return Pe.overshoot=At,Pe}(er),Me=function At(ue){ue=+ue;function Pe(je){return((je*=2)<1?je*je*((ue+1)*je-ue):(je-=2)*je*((ue+1)*je+ue)+2)/2}return Pe.overshoot=At,Pe}(er),ae=2*Math.PI,Je=1,or=.3,re=function At(ue,Pe){var je=Math.asin(1/(ue=Math.max(1,ue)))*(Pe/=ae);function Nt(wt){return ue*Ee(- --wt)*Math.sin((je-wt)/Pe)}return Nt.amplitude=function(wt){return At(wt,Pe*ae)},Nt.period=function(wt){return At(ue,wt)},Nt}(Je,or),Jt=function At(ue,Pe){var je=Math.asin(1/(ue=Math.max(1,ue)))*(Pe/=ae);function Nt(wt){return 1-ue*Ee(wt=+wt)*Math.sin((wt+je)/Pe)}return Nt.amplitude=function(wt){return At(wt,Pe*ae)},Nt.period=function(wt){return At(ue,wt)},Nt}(Je,or),Et=function At(ue,Pe){var je=Math.asin(1/(ue=Math.max(1,ue)))*(Pe/=ae);function Nt(wt){return((wt=wt*2-1)<0?ue*Ee(-wt)*Math.sin((je-wt)/Pe):2-ue*Ee(wt)*Math.sin((je+wt)/Pe))/2}return Nt.amplitude=function(wt){return At(wt,Pe*ae)},Nt.period=function(wt){return At(ue,wt)},Nt}(Je,or),$t={};function Yt(At){return $t[At.toLowerCase()]||kt[At]}function St(At,ue){$t[At.toLowerCase()]=ue}},46556:function(gn,Ot,ot){"use strict";ot.d(Ot,{b:function(){return I},W:function(){return bt}});var kt=new Map;function bt(Mt,et){kt.set(Mt,et)}function I(Mt){return kt.get(Mt)}function xt(Mt){var et=Mt.attr(),Dt=et.x,we=et.y,_e=et.width,ge=et.height;return{x:Dt,y:we,width:_e,height:ge}}function K(Mt){var et=Mt.attr(),Dt=et.x,we=et.y,_e=et.r;return{x:Dt-_e,y:we-_e,width:_e*2,height:_e*2}}var ut=ot(32793);function ht(Mt,et){return!Mt||!et?Mt||et:{minX:Math.min(Mt.minX,et.minX),minY:Math.min(Mt.minY,et.minY),maxX:Math.max(Mt.maxX,et.maxX),maxY:Math.max(Mt.maxY,et.maxY)}}function lt(Mt,et){var Dt=Mt.get("startArrowShape"),we=Mt.get("endArrowShape"),_e=null,ge=null;return Dt&&(_e=Dt.getCanvasBBox(),et=ht(et,_e)),we&&(ge=we.getCanvasBBox(),et=ht(et,ge)),et}function tt(Mt){for(var et=Mt.attr(),Dt=et.points,we=[],_e=[],ge=0;ge<Dt.length;ge++){var te=Dt[ge];we.push(te[0]),_e.push(te[1])}var xe=ut.Zr.getBBoxByArray(we,_e),Ye=xe.x,Lt=xe.y,Qt=xe.width,ct=xe.height,Ct={minX:Ye,minY:Lt,maxX:Ye+Qt,maxY:Lt+ct};return Ct=lt(Mt,Ct),{x:Ct.minX,y:Ct.minY,width:Ct.maxX-Ct.minX,height:Ct.maxY-Ct.minY}}function be(Mt){for(var et=Mt.attr(),Dt=et.points,we=[],_e=[],ge=0;ge<Dt.length;ge++){var te=Dt[ge];we.push(te[0]),_e.push(te[1])}return ut.Zr.getBBoxByArray(we,_e)}var it=ot(8723);function st(Mt){var et=Mt.attr(),Dt=et.x,we=et.y,_e=et.text,ge=et.fontSize,te=et.lineHeight,xe=et.font;xe||(xe=(0,it.$O)(et));var Ye=(0,it.mY)(_e,xe),Lt;if(!Ye)Lt={x:Dt,y:we,width:0,height:0};else{var Qt=et.textAlign,ct=et.textBaseline,Ct=(0,it.FE)(_e,ge,te),Y={x:Dt,y:we-Ct};Qt&&(Qt==="end"||Qt==="right"?Y.x-=Ye:Qt==="center"&&(Y.x-=Ye/2)),ct&&(ct==="top"?Y.y+=Ct:ct==="middle"&&(Y.y+=Ct/2)),Lt={x:Y.x,y:Y.y,width:Ye,height:Ct}}return Lt}var Ut=ot(39499),P=ot(45098);function b(Mt,et){for(var Dt=[],we=[],_e=[],ge=0;ge<Mt.length;ge++){var te=Mt[ge],xe=te.currentPoint,Ye=te.params,Lt=te.prePoint,Qt=void 0;switch(te.command){case"Q":Qt=ut.lD.box(Lt[0],Lt[1],Ye[1],Ye[2],Ye[3],Ye[4]);break;case"C":Qt=ut.Ll.box(Lt[0],Lt[1],Ye[1],Ye[2],Ye[3],Ye[4],Ye[5],Ye[6]);break;case"A":var ct=te.arcParams;Qt=ut.wN.box(ct.cx,ct.cy,ct.rx,ct.ry,ct.xRotation,ct.startAngle,ct.endAngle);break;default:Dt.push(xe[0]),we.push(xe[1]);break}Qt&&(te.box=Qt,Dt.push(Qt.x,Qt.x+Qt.width),we.push(Qt.y,Qt.y+Qt.height)),et&&(te.command==="L"||te.command==="M")&&te.prePoint&&te.nextPoint&&_e.push(te)}Dt=Dt.filter(function(Ce){return!Number.isNaN(Ce)&&Ce!==1/0&&Ce!==-1/0}),we=we.filter(function(Ce){return!Number.isNaN(Ce)&&Ce!==1/0&&Ce!==-1/0});var Ct=(0,P.VV)(Dt),Y=(0,P.VV)(we),yt=(0,P.Fp)(Dt),Xt=(0,P.Fp)(we);if(_e.length===0)return{x:Ct,y:Y,width:yt-Ct,height:Xt-Y};for(var ge=0;ge<_e.length;ge++){var te=_e[ge],xe=te.currentPoint,ie=void 0;xe[0]===Ct?(ie=W(te,et),Ct=Ct-ie.xExtra):xe[0]===yt&&(ie=W(te,et),yt=yt+ie.xExtra),xe[1]===Y?(ie=W(te,et),Y=Y-ie.yExtra):xe[1]===Xt&&(ie=W(te,et),Xt=Xt+ie.yExtra)}return{x:Ct,y:Y,width:yt-Ct,height:Xt-Y}}function W(Mt,et){var Dt=Mt.prePoint,we=Mt.currentPoint,_e=Mt.nextPoint,ge=Math.pow(we[0]-Dt[0],2)+Math.pow(we[1]-Dt[1],2),te=Math.pow(we[0]-_e[0],2)+Math.pow(we[1]-_e[1],2),xe=Math.pow(Dt[0]-_e[0],2)+Math.pow(Dt[1]-_e[1],2),Ye=Math.acos((ge+te-xe)/(2*Math.sqrt(ge)*Math.sqrt(te)));if(!Ye||Math.sin(Ye)===0||(0,P.vQ)(Ye,0))return{xExtra:0,yExtra:0};var Lt=Math.abs(Math.atan2(_e[1]-we[1],_e[0]-we[0])),Qt=Math.abs(Math.atan2(_e[0]-we[0],_e[1]-we[1]));Lt=Lt>Math.PI/2?Math.PI-Lt:Lt,Qt=Qt>Math.PI/2?Math.PI-Qt:Qt;var ct={xExtra:Math.cos(Ye/2-Lt)*(et/2*(1/Math.sin(Ye/2)))-et/2||0,yExtra:Math.cos(Qt-Ye/2)*(et/2*(1/Math.sin(Ye/2)))-et/2||0};return ct}function fe(Mt){var et=Mt.attr(),Dt=et.path,we=et.stroke,_e=we?et.lineWidth:0,ge=Mt.get("segments")||(0,Ut.zx)(Dt),te=b(ge,_e),xe=te.x,Ye=te.y,Lt=te.width,Qt=te.height,ct={minX:xe,minY:Ye,maxX:xe+Lt,maxY:Ye+Qt};return ct=lt(Mt,ct),{x:ct.minX,y:ct.minY,width:ct.maxX-ct.minX,height:ct.maxY-ct.minY}}function Ee(Mt){var et=Mt.attr(),Dt=et.x1,we=et.y1,_e=et.x2,ge=et.y2,te=Math.min(Dt,_e),xe=Math.max(Dt,_e),Ye=Math.min(we,ge),Lt=Math.max(we,ge),Qt={minX:te,maxX:xe,minY:Ye,maxY:Lt};return Qt=lt(Mt,Qt),{x:Qt.minX,y:Qt.minY,width:Qt.maxX-Qt.minX,height:Qt.maxY-Qt.minY}}function Te(Mt){var et=Mt.attr(),Dt=et.x,we=et.y,_e=et.rx,ge=et.ry;return{x:Dt-_e,y:we-ge,width:_e*2,height:ge*2}}bt("rect",xt),bt("image",xt),bt("circle",K),bt("marker",K),bt("polyline",tt),bt("polygon",be),bt("text",st),bt("path",fe),bt("line",Ee),bt("ellipse",Te)},89473:function(gn,Ot){"use strict";var ot=function(){function kt(bt,I){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=bt,this.name=bt,this.originalEvent=I,this.timeStamp=I.timeStamp}return kt.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},kt.prototype.stopPropagation=function(){this.propagationStopped=!0},kt.prototype.toString=function(){var bt=this.type;return"[Event (type="+bt+")]"},kt.prototype.save=function(){},kt.prototype.restore=function(){},kt}();Ot.Z=ot},98190:function(gn,Ot,ot){"use strict";ot.r(Ot),ot.d(Ot,{AbstractCanvas:function(){return be.Z},AbstractGroup:function(){return it.Z},AbstractShape:function(){return st.Z},Base:function(){return tt.Z},Event:function(){return lt.Z},PathUtil:function(){return kt},assembleFont:function(){return P.$O},getBBoxMethod:function(){return Ut.b},getOffScreenContext:function(){return fe.L},getTextHeight:function(){return P.FE},invert:function(){return W.U_},isAllowCapture:function(){return b.pP},multiplyVec2:function(){return W.rG},registerBBox:function(){return Ut.W},registerEasing:function(){return Ee.C},version:function(){return Te}});var kt=ot(47575),bt=ot(52),I=ot.n(bt),ht={};for(var xt in bt)["default","Event","Base","AbstractCanvas","AbstractGroup","AbstractShape","PathUtil","getBBoxMethod","registerBBox","getTextHeight","assembleFont","isAllowCapture","multiplyVec2","invert","getOffScreenContext","registerEasing","version"].indexOf(xt)<0&&(ht[xt]=function(Mt){return bt[Mt]}.bind(0,xt));ot.d(Ot,ht);var K=ot(15294),ut=ot.n(K),ht={};for(var xt in K)["default","Event","Base","AbstractCanvas","AbstractGroup","AbstractShape","PathUtil","getBBoxMethod","registerBBox","getTextHeight","assembleFont","isAllowCapture","multiplyVec2","invert","getOffScreenContext","registerEasing","version"].indexOf(xt)<0&&(ht[xt]=function(et){return K[et]}.bind(0,xt));ot.d(Ot,ht);var lt=ot(89473),tt=ot(2667),be=ot(2840),it=ot(31841),st=ot(15032),Ut=ot(46556),P=ot(8723),b=ot(77341),W=ot(41482),fe=ot(67052),Ee=ot(93924),Te="0.5.11"},15294:function(){},52:function(){},41482:function(gn,Ot,ot){"use strict";ot.d(Ot,{U_:function(){return I},rG:function(){return bt},xq:function(){return kt}});function kt(xt,K){var ut=[],ht=xt[0],lt=xt[1],tt=xt[2],be=xt[3],it=xt[4],st=xt[5],Ut=xt[6],P=xt[7],b=xt[8],W=K[0],fe=K[1],Ee=K[2],Te=K[3],Mt=K[4],et=K[5],Dt=K[6],we=K[7],_e=K[8];return ut[0]=W*ht+fe*be+Ee*Ut,ut[1]=W*lt+fe*it+Ee*P,ut[2]=W*tt+fe*st+Ee*b,ut[3]=Te*ht+Mt*be+et*Ut,ut[4]=Te*lt+Mt*it+et*P,ut[5]=Te*tt+Mt*st+et*b,ut[6]=Dt*ht+we*be+_e*Ut,ut[7]=Dt*lt+we*it+_e*P,ut[8]=Dt*tt+we*st+_e*b,ut}function bt(xt,K){var ut=[],ht=K[0],lt=K[1];return ut[0]=xt[0]*ht+xt[3]*lt+xt[6],ut[1]=xt[1]*ht+xt[4]*lt+xt[7],ut}function I(xt){var K=[],ut=xt[0],ht=xt[1],lt=xt[2],tt=xt[3],be=xt[4],it=xt[5],st=xt[6],Ut=xt[7],P=xt[8],b=P*be-it*Ut,W=-P*tt+it*st,fe=Ut*tt-be*st,Ee=ut*b+ht*W+lt*fe;return Ee?(Ee=1/Ee,K[0]=b*Ee,K[1]=(-P*ht+lt*Ut)*Ee,K[2]=(it*ht-lt*be)*Ee,K[3]=W*Ee,K[4]=(P*ut-lt*st)*Ee,K[5]=(-it*ut+lt*tt)*Ee,K[6]=fe*Ee,K[7]=(-Ut*ut+ht*st)*Ee,K[8]=(be*ut-ht*tt)*Ee,K):null}},67052:function(gn,Ot,ot){"use strict";ot.d(Ot,{L:function(){return bt}});var kt=null;function bt(){if(!kt){var I=document.createElement("canvas");I.width=1,I.height=1,kt=I.getContext("2d")}return kt}},47575:function(gn,Ot,ot){"use strict";ot.r(Ot),ot.d(Ot,{catmullRomToBezier:function(){return ut},fillPath:function(){return ct},fillPathByDiff:function(){return Xt},formatPath:function(){return er},intersection:function(){return xe},parsePathArray:function(){return P},parsePathString:function(){return K},pathToAbsolute:function(){return lt},pathToCurve:function(){return st},rectPath:function(){return Mt}});var kt=ot(45098),bt=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,I=new RegExp("([a-z])["+bt+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+bt+"]*,?["+bt+"]*)+)","ig"),xt=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+bt+"]*,?["+bt+"]*","ig"),K=function(Ht){if(!Ht)return null;if((0,kt.kJ)(Ht))return Ht;var ne={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},Me=[];return String(Ht).replace(I,function(ae,Je,or){var re=[],Jt=Je.toLowerCase();if(or.replace(xt,function(Et,$t){$t&&re.push(+$t)}),Jt==="m"&&re.length>2&&(Me.push([Je].concat(re.splice(0,2))),Jt="l",Je=Je==="m"?"l":"L"),Jt==="o"&&re.length===1&&Me.push([Je,re[0]]),Jt==="r")Me.push([Je].concat(re));else for(;re.length>=ne[Jt]&&(Me.push([Je].concat(re.splice(0,ne[Jt]))),!!ne[Jt]););return Ht}),Me},ut=function(Ht,ne){for(var Me=[],ae=0,Je=Ht.length;Je-2*!ne>ae;ae+=2){var or=[{x:+Ht[ae-2],y:+Ht[ae-1]},{x:+Ht[ae],y:+Ht[ae+1]},{x:+Ht[ae+2],y:+Ht[ae+3]},{x:+Ht[ae+4],y:+Ht[ae+5]}];ne?ae?Je-4===ae?or[3]={x:+Ht[0],y:+Ht[1]}:Je-2===ae&&(or[2]={x:+Ht[0],y:+Ht[1]},or[3]={x:+Ht[2],y:+Ht[3]}):or[0]={x:+Ht[Je-2],y:+Ht[Je-1]}:Je-4===ae?or[3]=or[2]:ae||(or[0]={x:+Ht[ae],y:+Ht[ae+1]}),Me.push(["C",(-or[0].x+6*or[1].x+or[2].x)/6,(-or[0].y+6*or[1].y+or[2].y)/6,(or[1].x+6*or[2].x-or[3].x)/6,(or[1].y+6*or[2].y-or[3].y)/6,or[2].x,or[2].y])}return Me},ht=function(Ht,ne,Me,ae,Je){var or=[];if(Je===null&&ae===null&&(ae=Me),Ht=+Ht,ne=+ne,Me=+Me,ae=+ae,Je!==null){var re=Math.PI/180,Jt=Ht+Me*Math.cos(-ae*re),Et=Ht+Me*Math.cos(-Je*re),$t=ne+Me*Math.sin(-ae*re),Yt=ne+Me*Math.sin(-Je*re);or=[["M",Jt,$t],["A",Me,Me,0,+(Je-ae>180),0,Et,Yt]]}else or=[["M",Ht,ne],["m",0,-ae],["a",Me,ae,0,1,1,0,2*ae],["a",Me,ae,0,1,1,0,-2*ae],["z"]];return or},lt=function(Ht){if(Ht=K(Ht),!Ht||!Ht.length)return[["M",0,0]];var ne=[],Me=0,ae=0,Je=0,or=0,re=0,Jt,Et;Ht[0][0]==="M"&&(Me=+Ht[0][1],ae=+Ht[0][2],Je=Me,or=ae,re++,ne[0]=["M",Me,ae]);for(var $t=Ht.length===3&&Ht[0][0]==="M"&&Ht[1][0].toUpperCase()==="R"&&Ht[2][0].toUpperCase()==="Z",Yt=void 0,St=void 0,At=re,ue=Ht.length;At<ue;At++){if(ne.push(Yt=[]),St=Ht[At],Jt=St[0],Jt!==Jt.toUpperCase())switch(Yt[0]=Jt.toUpperCase(),Yt[0]){case"A":Yt[1]=St[1],Yt[2]=St[2],Yt[3]=St[3],Yt[4]=St[4],Yt[5]=St[5],Yt[6]=+St[6]+Me,Yt[7]=+St[7]+ae;break;case"V":Yt[1]=+St[1]+ae;break;case"H":Yt[1]=+St[1]+Me;break;case"R":Et=[Me,ae].concat(St.slice(1));for(var Pe=2,je=Et.length;Pe<je;Pe++)Et[Pe]=+Et[Pe]+Me,Et[++Pe]=+Et[Pe]+ae;ne.pop(),ne=ne.concat(ut(Et,$t));break;case"O":ne.pop(),Et=ht(Me,ae,St[1],St[2]),Et.push(Et[0]),ne=ne.concat(Et);break;case"U":ne.pop(),ne=ne.concat(ht(Me,ae,St[1],St[2],St[3])),Yt=["U"].concat(ne[ne.length-1].slice(-2));break;case"M":Je=+St[1]+Me,or=+St[2]+ae;break;default:for(var Pe=1,je=St.length;Pe<je;Pe++)Yt[Pe]=+St[Pe]+(Pe%2?Me:ae)}else if(Jt==="R")Et=[Me,ae].concat(St.slice(1)),ne.pop(),ne=ne.concat(ut(Et,$t)),Yt=["R"].concat(St.slice(-2));else if(Jt==="O")ne.pop(),Et=ht(Me,ae,St[1],St[2]),Et.push(Et[0]),ne=ne.concat(Et);else if(Jt==="U")ne.pop(),ne=ne.concat(ht(Me,ae,St[1],St[2],St[3])),Yt=["U"].concat(ne[ne.length-1].slice(-2));else for(var Nt=0,wt=St.length;Nt<wt;Nt++)Yt[Nt]=St[Nt];if(Jt=Jt.toUpperCase(),Jt!=="O")switch(Yt[0]){case"Z":Me=+Je,ae=+or;break;case"H":Me=Yt[1];break;case"V":ae=Yt[1];break;case"M":Je=Yt[Yt.length-2],or=Yt[Yt.length-1];break;default:Me=Yt[Yt.length-2],ae=Yt[Yt.length-1]}}return ne},tt=function(Ht,ne,Me,ae){return[Ht,ne,Me,ae,Me,ae]},be=function(Ht,ne,Me,ae,Je,or){var re=.3333333333333333,Jt=2/3;return[re*Ht+Jt*Me,re*ne+Jt*ae,re*Je+Jt*Me,re*or+Jt*ae,Je,or]},it=function(Ht,ne,Me,ae,Je,or,re,Jt,Et,$t){Me===ae&&(Me+=1);var Yt=Math.PI*120/180,St=Math.PI/180*(+Je||0),At=[],ue,Pe,je,Nt,wt,Tt=function(Se,ze,fr){var wr=Se*Math.cos(fr)-ze*Math.sin(fr),Le=Se*Math.sin(fr)+ze*Math.cos(fr);return{x:wr,y:Le}};if($t)Pe=$t[0],je=$t[1],Nt=$t[2],wt=$t[3];else{ue=Tt(Ht,ne,-St),Ht=ue.x,ne=ue.y,ue=Tt(Jt,Et,-St),Jt=ue.x,Et=ue.y,Ht===Jt&&ne===Et&&(Jt+=1,Et+=1);var Ft=(Ht-Jt)/2,J=(ne-Et)/2,gt=Ft*Ft/(Me*Me)+J*J/(ae*ae);gt>1&&(gt=Math.sqrt(gt),Me=gt*Me,ae=gt*ae);var jt=Me*Me,ve=ae*ae,Gt=(or===re?-1:1)*Math.sqrt(Math.abs((jt*ve-jt*J*J-ve*Ft*Ft)/(jt*J*J+ve*Ft*Ft)));Nt=Gt*Me*J/ae+(Ht+Jt)/2,wt=Gt*-ae*Ft/Me+(ne+Et)/2,Pe=Math.asin(((ne-wt)/ae).toFixed(9)),je=Math.asin(((Et-wt)/ae).toFixed(9)),Pe=Ht<Nt?Math.PI-Pe:Pe,je=Jt<Nt?Math.PI-je:je,Pe<0&&(Pe=Math.PI*2+Pe),je<0&&(je=Math.PI*2+je),re&&Pe>je&&(Pe=Pe-Math.PI*2),!re&&je>Pe&&(je=je-Math.PI*2)}var Ae=je-Pe;if(Math.abs(Ae)>Yt){var He=je,qe=Jt,hr=Et;je=Pe+Yt*(re&&je>Pe?1:-1),Jt=Nt+Me*Math.cos(je),Et=wt+ae*Math.sin(je),At=it(Jt,Et,Me,ae,Je,0,re,qe,hr,[je,He,Nt,wt])}Ae=je-Pe;var tr=Math.cos(Pe),Br=Math.sin(Pe),Lr=Math.cos(je),Zr=Math.sin(je),Tn=Math.tan(Ae/4),rn=4/3*Me*Tn,Nn=4/3*ae*Tn,zn=[Ht,ne],jn=[Ht+rn*Br,ne-Nn*tr],Sn=[Jt+rn*Zr,Et-Nn*Lr],Wn=[Jt,Et];if(jn[0]=2*zn[0]-jn[0],jn[1]=2*zn[1]-jn[1],$t)return[jn,Sn,Wn].concat(At);At=[jn,Sn,Wn].concat(At).join().split(",");for(var Rt=[],Wt=0,oe=At.length;Wt<oe;Wt++)Rt[Wt]=Wt%2?Tt(At[Wt-1],At[Wt],St).y:Tt(At[Wt],At[Wt+1],St).x;return Rt},st=function(Ht,ne){var Me=lt(Ht),ae=ne&&lt(ne),Je={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},or={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},re=[],Jt=[],Et="",$t="",Yt,St=function(Ft,J,gt){var jt,ve;if(!Ft)return["C",J.x,J.y,J.x,J.y,J.x,J.y];switch(!(Ft[0]in{T:1,Q:1})&&(J.qx=J.qy=null),Ft[0]){case"M":J.X=Ft[1],J.Y=Ft[2];break;case"A":Ft=["C"].concat(it.apply(0,[J.x,J.y].concat(Ft.slice(1))));break;case"S":gt==="C"||gt==="S"?(jt=J.x*2-J.bx,ve=J.y*2-J.by):(jt=J.x,ve=J.y),Ft=["C",jt,ve].concat(Ft.slice(1));break;case"T":gt==="Q"||gt==="T"?(J.qx=J.x*2-J.qx,J.qy=J.y*2-J.qy):(J.qx=J.x,J.qy=J.y),Ft=["C"].concat(be(J.x,J.y,J.qx,J.qy,Ft[1],Ft[2]));break;case"Q":J.qx=Ft[1],J.qy=Ft[2],Ft=["C"].concat(be(J.x,J.y,Ft[1],Ft[2],Ft[3],Ft[4]));break;case"L":Ft=["C"].concat(tt(J.x,J.y,Ft[1],Ft[2]));break;case"H":Ft=["C"].concat(tt(J.x,J.y,Ft[1],J.y));break;case"V":Ft=["C"].concat(tt(J.x,J.y,J.x,Ft[1]));break;case"Z":Ft=["C"].concat(tt(J.x,J.y,J.X,J.Y));break;default:break}return Ft},At=function(Ft,J){if(Ft[J].length>7){Ft[J].shift();for(var gt=Ft[J];gt.length;)re[J]="A",ae&&(Jt[J]="A"),Ft.splice(J++,0,["C"].concat(gt.splice(0,6)));Ft.splice(J,1),Yt=Math.max(Me.length,ae&&ae.length||0)}},ue=function(Ft,J,gt,jt,ve){Ft&&J&&Ft[ve][0]==="M"&&J[ve][0]!=="M"&&(J.splice(ve,0,["M",jt.x,jt.y]),gt.bx=0,gt.by=0,gt.x=Ft[ve][1],gt.y=Ft[ve][2],Yt=Math.max(Me.length,ae&&ae.length||0))};Yt=Math.max(Me.length,ae&&ae.length||0);for(var Pe=0;Pe<Yt;Pe++){Me[Pe]&&(Et=Me[Pe][0]),Et!=="C"&&(re[Pe]=Et,Pe&&($t=re[Pe-1])),Me[Pe]=St(Me[Pe],Je,$t),re[Pe]!=="A"&&Et==="C"&&(re[Pe]="C"),At(Me,Pe),ae&&(ae[Pe]&&(Et=ae[Pe][0]),Et!=="C"&&(Jt[Pe]=Et,Pe&&($t=Jt[Pe-1])),ae[Pe]=St(ae[Pe],or,$t),Jt[Pe]!=="A"&&Et==="C"&&(Jt[Pe]="C"),At(ae,Pe)),ue(Me,ae,Je,or,Pe),ue(ae,Me,or,Je,Pe);var je=Me[Pe],Nt=ae&&ae[Pe],wt=je.length,Tt=ae&&Nt.length;Je.x=je[wt-2],Je.y=je[wt-1],Je.bx=parseFloat(je[wt-4])||Je.x,Je.by=parseFloat(je[wt-3])||Je.y,or.bx=ae&&(parseFloat(Nt[Tt-4])||or.x),or.by=ae&&(parseFloat(Nt[Tt-3])||or.y),or.x=ae&&Nt[Tt-2],or.y=ae&&Nt[Tt-1]}return ae?[Me,ae]:Me},Ut=/,?([a-z]),?/gi,P=function(Ht){return Ht.join(",").replace(Ut,"$1")},b=function(Ht,ne,Me,ae,Je){var or=-3*ne+9*Me-9*ae+3*Je,re=Ht*or+6*ne-12*Me+6*ae;return Ht*re-3*ne+3*Me},W=function(Ht,ne,Me,ae,Je,or,re,Jt,Et){Et===null&&(Et=1),Et=Et>1?1:Et<0?0:Et;for(var $t=Et/2,Yt=12,St=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],At=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],ue=0,Pe=0;Pe<Yt;Pe++){var je=$t*St[Pe]+$t,Nt=b(je,Ht,Me,Je,re),wt=b(je,ne,ae,or,Jt),Tt=Nt*Nt+wt*wt;ue+=At[Pe]*Math.sqrt(Tt)}return $t*ue},fe=function(Ht,ne,Me,ae,Je,or,re,Jt){for(var Et=[],$t=[[],[]],Yt,St,At,ue,Pe=0;Pe<2;++Pe){if(Pe===0?(St=6*Ht-12*Me+6*Je,Yt=-3*Ht+9*Me-9*Je+3*re,At=3*Me-3*Ht):(St=6*ne-12*ae+6*or,Yt=-3*ne+9*ae-9*or+3*Jt,At=3*ae-3*ne),Math.abs(Yt)<1e-12){if(Math.abs(St)<1e-12)continue;ue=-At/St,ue>0&&ue<1&&Et.push(ue);continue}var je=St*St-4*At*Yt,Nt=Math.sqrt(je);if(!(je<0)){var wt=(-St+Nt)/(2*Yt);wt>0&&wt<1&&Et.push(wt);var Tt=(-St-Nt)/(2*Yt);Tt>0&&Tt<1&&Et.push(Tt)}}for(var Ft=Et.length,J=Ft,gt;Ft--;)ue=Et[Ft],gt=1-ue,$t[0][Ft]=gt*gt*gt*Ht+3*gt*gt*ue*Me+3*gt*ue*ue*Je+ue*ue*ue*re,$t[1][Ft]=gt*gt*gt*ne+3*gt*gt*ue*ae+3*gt*ue*ue*or+ue*ue*ue*Jt;return $t[0][J]=Ht,$t[1][J]=ne,$t[0][J+1]=re,$t[1][J+1]=Jt,$t[0].length=$t[1].length=J+2,{min:{x:Math.min.apply(0,$t[0]),y:Math.min.apply(0,$t[1])},max:{x:Math.max.apply(0,$t[0]),y:Math.max.apply(0,$t[1])}}},Ee=function(Ht,ne,Me,ae,Je,or,re,Jt){if(!(Math.max(Ht,Me)<Math.min(Je,re)||Math.min(Ht,Me)>Math.max(Je,re)||Math.max(ne,ae)<Math.min(or,Jt)||Math.min(ne,ae)>Math.max(or,Jt))){var Et=(Ht*ae-ne*Me)*(Je-re)-(Ht-Me)*(Je*Jt-or*re),$t=(Ht*ae-ne*Me)*(or-Jt)-(ne-ae)*(Je*Jt-or*re),Yt=(Ht-Me)*(or-Jt)-(ne-ae)*(Je-re);if(!!Yt){var St=Et/Yt,At=$t/Yt,ue=+St.toFixed(2),Pe=+At.toFixed(2);if(!(ue<+Math.min(Ht,Me).toFixed(2)||ue>+Math.max(Ht,Me).toFixed(2)||ue<+Math.min(Je,re).toFixed(2)||ue>+Math.max(Je,re).toFixed(2)||Pe<+Math.min(ne,ae).toFixed(2)||Pe>+Math.max(ne,ae).toFixed(2)||Pe<+Math.min(or,Jt).toFixed(2)||Pe>+Math.max(or,Jt).toFixed(2)))return{x:St,y:At}}}},Te=function(Ht,ne,Me){return ne>=Ht.x&&ne<=Ht.x+Ht.width&&Me>=Ht.y&&Me<=Ht.y+Ht.height},Mt=function(Ht,ne,Me,ae,Je){if(Je)return[["M",+Ht+ +Je,ne],["l",Me-Je*2,0],["a",Je,Je,0,0,1,Je,Je],["l",0,ae-Je*2],["a",Je,Je,0,0,1,-Je,Je],["l",Je*2-Me,0],["a",Je,Je,0,0,1,-Je,-Je],["l",0,Je*2-ae],["a",Je,Je,0,0,1,Je,-Je],["z"]];var or=[["M",Ht,ne],["l",Me,0],["l",0,ae],["l",-Me,0],["z"]];return or.parsePathArray=P,or},et=function(Ht,ne,Me,ae){return Ht===null&&(Ht=ne=Me=ae=0),ne===null&&(ne=Ht.y,Me=Ht.width,ae=Ht.height,Ht=Ht.x),{x:Ht,y:ne,width:Me,w:Me,height:ae,h:ae,x2:Ht+Me,y2:ne+ae,cx:Ht+Me/2,cy:ne+ae/2,r1:Math.min(Me,ae)/2,r2:Math.max(Me,ae)/2,r0:Math.sqrt(Me*Me+ae*ae)/2,path:Mt(Ht,ne,Me,ae),vb:[Ht,ne,Me,ae].join(" ")}},Dt=function(Ht,ne){return Ht=et(Ht),ne=et(ne),Te(ne,Ht.x,Ht.y)||Te(ne,Ht.x2,Ht.y)||Te(ne,Ht.x,Ht.y2)||Te(ne,Ht.x2,Ht.y2)||Te(Ht,ne.x,ne.y)||Te(Ht,ne.x2,ne.y)||Te(Ht,ne.x,ne.y2)||Te(Ht,ne.x2,ne.y2)||(Ht.x<ne.x2&&Ht.x>ne.x||ne.x<Ht.x2&&ne.x>Ht.x)&&(Ht.y<ne.y2&&Ht.y>ne.y||ne.y<Ht.y2&&ne.y>Ht.y)},we=function(Ht,ne,Me,ae,Je,or,re,Jt){(0,kt.kJ)(Ht)||(Ht=[Ht,ne,Me,ae,Je,or,re,Jt]);var Et=fe.apply(null,Ht);return et(Et.min.x,Et.min.y,Et.max.x-Et.min.x,Et.max.y-Et.min.y)},_e=function(Ht,ne,Me,ae,Je,or,re,Jt,Et){var $t=1-Et,Yt=Math.pow($t,3),St=Math.pow($t,2),At=Et*Et,ue=At*Et,Pe=Yt*Ht+St*3*Et*Me+$t*3*Et*Et*Je+ue*re,je=Yt*ne+St*3*Et*ae+$t*3*Et*Et*or+ue*Jt,Nt=Ht+2*Et*(Me-Ht)+At*(Je-2*Me+Ht),wt=ne+2*Et*(ae-ne)+At*(or-2*ae+ne),Tt=Me+2*Et*(Je-Me)+At*(re-2*Je+Me),Ft=ae+2*Et*(or-ae)+At*(Jt-2*or+ae),J=$t*Ht+Et*Me,gt=$t*ne+Et*ae,jt=$t*Je+Et*re,ve=$t*or+Et*Jt,Gt=90-Math.atan2(Nt-Tt,wt-Ft)*180/Math.PI;return{x:Pe,y:je,m:{x:Nt,y:wt},n:{x:Tt,y:Ft},start:{x:J,y:gt},end:{x:jt,y:ve},alpha:Gt}},ge=function(Ht,ne,Me){var ae=we(Ht),Je=we(ne);if(!Dt(ae,Je))return Me?0:[];for(var or=W.apply(0,Ht),re=W.apply(0,ne),Jt=~~(or/8),Et=~~(re/8),$t=[],Yt=[],St={},At=Me?0:[],ue=0;ue<Jt+1;ue++){var Pe=_e.apply(0,Ht.concat(ue/Jt));$t.push({x:Pe.x,y:Pe.y,t:ue/Jt})}for(var ue=0;ue<Et+1;ue++){var Pe=_e.apply(0,ne.concat(ue/Et));Yt.push({x:Pe.x,y:Pe.y,t:ue/Et})}for(var ue=0;ue<Jt;ue++)for(var je=0;je<Et;je++){var Nt=$t[ue],wt=$t[ue+1],Tt=Yt[je],Ft=Yt[je+1],J=Math.abs(wt.x-Nt.x)<.001?"y":"x",gt=Math.abs(Ft.x-Tt.x)<.001?"y":"x",jt=Ee(Nt.x,Nt.y,wt.x,wt.y,Tt.x,Tt.y,Ft.x,Ft.y);if(jt){if(St[jt.x.toFixed(4)]===jt.y.toFixed(4))continue;St[jt.x.toFixed(4)]=jt.y.toFixed(4);var ve=Nt.t+Math.abs((jt[J]-Nt[J])/(wt[J]-Nt[J]))*(wt.t-Nt.t),Gt=Tt.t+Math.abs((jt[gt]-Tt[gt])/(Ft[gt]-Tt[gt]))*(Ft.t-Tt.t);ve>=0&&ve<=1&&Gt>=0&&Gt<=1&&(Me?At+=1:At.push({x:jt.x,y:jt.y,t1:ve,t2:Gt}))}}return At},te=function(Ht,ne,Me){Ht=st(Ht),ne=st(ne);for(var ae,Je,or,re,Jt,Et,$t,Yt,St,At,ue=Me?0:[],Pe=0,je=Ht.length;Pe<je;Pe++){var Nt=Ht[Pe];if(Nt[0]==="M")ae=Jt=Nt[1],Je=Et=Nt[2];else{Nt[0]==="C"?(St=[ae,Je].concat(Nt.slice(1)),ae=St[6],Je=St[7]):(St=[ae,Je,ae,Je,Jt,Et,Jt,Et],ae=Jt,Je=Et);for(var wt=0,Tt=ne.length;wt<Tt;wt++){var Ft=ne[wt];if(Ft[0]==="M")or=$t=Ft[1],re=Yt=Ft[2];else{Ft[0]==="C"?(At=[or,re].concat(Ft.slice(1)),or=At[6],re=At[7]):(At=[or,re,or,re,$t,Yt,$t,Yt],or=$t,re=Yt);var J=ge(St,At,Me);if(Me)ue+=J;else{for(var gt=0,jt=J.length;gt<jt;gt++)J[gt].segment1=Pe,J[gt].segment2=wt,J[gt].bez1=St,J[gt].bez2=At;ue=ue.concat(J)}}}}}return ue},xe=function(Ht,ne){return te(Ht,ne)};function Ye(Ht,ne){var Me=[],ae=[];function Je(or,re){if(or.length===1)Me.push(or[0]),ae.push(or[0]);else{for(var Jt=[],Et=0;Et<or.length-1;Et++)Et===0&&Me.push(or[0]),Et===or.length-2&&ae.push(or[Et+1]),Jt[Et]=[(1-re)*or[Et][0]+re*or[Et+1][0],(1-re)*or[Et][1]+re*or[Et+1][1]];Je(Jt,re)}}return Ht.length&&Je(Ht,ne),{left:Me,right:ae.reverse()}}function Lt(Ht,ne,Me){var ae=[[Ht[1],Ht[2]]];Me=Me||2;var Je=[];ne[0]==="A"?(ae.push(ne[6]),ae.push(ne[7])):ne[0]==="C"?(ae.push([ne[1],ne[2]]),ae.push([ne[3],ne[4]]),ae.push([ne[5],ne[6]])):ne[0]==="S"||ne[0]==="Q"?(ae.push([ne[1],ne[2]]),ae.push([ne[3],ne[4]])):ae.push([ne[1],ne[2]]);for(var or=ae,re=1/Me,Jt=0;Jt<Me-1;Jt++){var Et=re/(1-re*Jt),$t=Ye(or,Et);Je.push($t.left),or=$t.right}Je.push(or);var Yt=Je.map(function(St){var At=[];return St.length===4&&(At.push("C"),At=At.concat(St[2])),St.length>=3&&(St.length===3&&At.push("Q"),At=At.concat(St[1])),St.length===2&&At.push("L"),At=At.concat(St[St.length-1]),At});return Yt}var Qt=function(Ht,ne,Me){if(Me===1)return[[].concat(Ht)];var ae=[];if(ne[0]==="L"||ne[0]==="C"||ne[0]==="Q")ae=ae.concat(Lt(Ht,ne,Me));else{var Je=[].concat(Ht);Je[0]==="M"&&(Je[0]="L");for(var or=0;or<=Me-1;or++)ae.push(Je)}return ae},ct=function(Ht,ne){if(Ht.length===1)return Ht;var Me=Ht.length-1,ae=ne.length-1,Je=Me/ae,or=[];if(Ht.length===1&&Ht[0][0]==="M"){for(var re=0;re<ae-Me;re++)Ht.push(Ht[0]);return Ht}for(var re=0;re<ae;re++){var Jt=Math.floor(Je*re);or[Jt]=(or[Jt]||0)+1}var Et=or.reduce(function($t,Yt,St){return St===Me?$t.concat(Ht[Me]):$t.concat(Qt(Ht[St],Ht[St+1],Yt))},[]);return Et.unshift(Ht[0]),(ne[ae]==="Z"||ne[ae]==="z")&&Et.push("Z"),Et},Ct=function(Ht,ne){if(Ht.length!==ne.length)return!1;var Me=!0;return(0,kt.S6)(Ht,function(ae,Je){if(ae!==ne[Je])return Me=!1,!1}),Me};function Y(Ht,ne,Me){var ae=null,Je=Me;return ne<Je&&(Je=ne,ae="add"),Ht<Je&&(Je=Ht,ae="del"),{type:ae,min:Je}}var yt=function(Ht,ne){var Me=Ht.length,ae=ne.length,Je,or,re=0;if(Me===0||ae===0)return null;for(var Jt=[],Et=0;Et<=Me;Et++)Jt[Et]=[],Jt[Et][0]={min:Et};for(var $t=0;$t<=ae;$t++)Jt[0][$t]={min:$t};for(var Et=1;Et<=Me;Et++){Je=Ht[Et-1];for(var $t=1;$t<=ae;$t++){or=ne[$t-1],Ct(Je,or)?re=0:re=1;var Yt=Jt[Et-1][$t].min+1,St=Jt[Et][$t-1].min+1,At=Jt[Et-1][$t-1].min+re;Jt[Et][$t]=Y(Yt,St,At)}}return Jt},Xt=function(Ht,ne){var Me=yt(Ht,ne),ae=Ht.length,Je=ne.length,or=[],re=1,Jt=1;if(Me[ae][Je].min!==ae){for(var Et=1;Et<=ae;Et++){var $t=Me[Et][Et].min;Jt=Et;for(var Yt=re;Yt<=Je;Yt++)Me[Et][Yt].min<$t&&($t=Me[Et][Yt].min,Jt=Yt);re=Jt,Me[Et][re].type&&or.push({index:Et-1,type:Me[Et][re].type})}for(var Et=or.length-1;Et>=0;Et--)re=or[Et].index,or[Et].type==="add"?Ht.splice(re,0,[].concat(Ht[re])):Ht.splice(re,1)}ae=Ht.length;var St=Je-ae;if(ae<Je)for(var Et=0;Et<St;Et++)Ht[ae-1][0]==="z"||Ht[ae-1][0]==="Z"?Ht.splice(ae-2,0,Ht[ae-2]):Ht.push(Ht[ae-1]),ae+=1;return Ht};function ie(Ht,ne,Me){for(var ae=[].concat(Ht),Je,or=1/(Me+1),re=Ce(ne)[0],Jt=1;Jt<=Me;Jt++)or*=Jt,Je=Math.floor(Ht.length*or),Je===0?ae.unshift([re[0]*or+Ht[Je][0]*(1-or),re[1]*or+Ht[Je][1]*(1-or)]):ae.splice(Je,0,[re[0]*or+Ht[Je][0]*(1-or),re[1]*or+Ht[Je][1]*(1-or)]);return ae}function Ce(Ht){var ne=[];switch(Ht[0]){case"M":ne.push([Ht[1],Ht[2]]);break;case"L":ne.push([Ht[1],Ht[2]]);break;case"A":ne.push([Ht[6],Ht[7]]);break;case"Q":ne.push([Ht[3],Ht[4]]),ne.push([Ht[1],Ht[2]]);break;case"T":ne.push([Ht[1],Ht[2]]);break;case"C":ne.push([Ht[5],Ht[6]]),ne.push([Ht[1],Ht[2]]),ne.push([Ht[3],Ht[4]]);break;case"S":ne.push([Ht[3],Ht[4]]),ne.push([Ht[1],Ht[2]]);break;case"H":ne.push([Ht[1],Ht[1]]);break;case"V":ne.push([Ht[1],Ht[1]]);break;default:}return ne}var er=function(Ht,ne){if(Ht.length<=1)return Ht;for(var Me,ae=0;ae<ne.length;ae++)if(Ht[ae][0]!==ne[ae][0])switch(Me=Ce(Ht[ae]),ne[ae][0]){case"M":Ht[ae]=["M"].concat(Me[0]);break;case"L":Ht[ae]=["L"].concat(Me[0]);break;case"A":Ht[ae]=[].concat(ne[ae]),Ht[ae][6]=Me[0][0],Ht[ae][7]=Me[0][1];break;case"Q":if(Me.length<2)if(ae>0)Me=ie(Me,Ht[ae-1],1);else{Ht[ae]=ne[ae];break}Ht[ae]=["Q"].concat(Me.reduce(function(Je,or){return Je.concat(or)},[]));break;case"T":Ht[ae]=["T"].concat(Me[0]);break;case"C":if(Me.length<3)if(ae>0)Me=ie(Me,Ht[ae-1],2);else{Ht[ae]=ne[ae];break}Ht[ae]=["C"].concat(Me.reduce(function(Je,or){return Je.concat(or)},[]));break;case"S":if(Me.length<2)if(ae>0)Me=ie(Me,Ht[ae-1],1);else{Ht[ae]=ne[ae];break}Ht[ae]=["S"].concat(Me.reduce(function(Je,or){return Je.concat(or)},[]));break;default:Ht[ae]=ne[ae]}return Ht}},8723:function(gn,Ot,ot){"use strict";ot.d(Ot,{$O:function(){return ut},FE:function(){return I},mY:function(){return K}});var kt=ot(77341),bt=ot(67052);function I(ht,lt,tt){var be=1;if((0,kt.HD)(ht)&&(be=ht.split(`
`).length),be>1){var it=xt(lt,tt);return lt*be+it*(be-1)}return lt}function xt(ht,lt){return lt?lt-ht:ht*.14}function K(ht,lt){var tt=(0,bt.L)(),be=0;if((0,kt.kK)(ht)||ht==="")return be;if(tt.save(),tt.font=lt,(0,kt.HD)(ht)&&ht.includes(`
`)){var it=ht.split(`
`);(0,kt.S6)(it,function(st){var Ut=tt.measureText(st).width;be<Ut&&(be=Ut)})}else be=tt.measureText(ht).width;return tt.restore(),be}function ut(ht){var lt=ht.fontSize,tt=ht.fontFamily,be=ht.fontWeight,it=ht.fontStyle,st=ht.fontVariant;return[it,st,be,lt+"px",tt].join(" ").trim()}},77341:function(gn,Ot,ot){"use strict";ot.d(Ot,{As:function(){return bt},CD:function(){return kt.CD},HD:function(){return kt.HD},Kn:function(){return kt.Kn},S6:function(){return kt.S6},UY:function(){return xt},jC:function(){return kt.jC},jU:function(){return I},kK:function(){return kt.UM},mf:function(){return kt.mf},pP:function(){return K}});var kt=ot(45098);function bt(ut,ht){var lt=ut.indexOf(ht);lt!==-1&&ut.splice(lt,1)}var I=typeof window!="undefined"&&typeof window.document!="undefined";function xt(ut,ht){if(ut.isCanvas())return!0;for(var lt=ht.getParent(),tt=!1;lt;){if(lt===ut){tt=!0;break}lt=lt.getParent()}return tt}function K(ut){return ut.cfg.visible&&ut.cfg.capture}},32793:function(gn,Ot,ot){"use strict";ot.d(Ot,{wN:function(){return ie},Ll:function(){return _e},x1:function(){return tt},aH:function(){return ae},lD:function(){return Ee},Zr:function(){return kt}});var kt={};ot.r(kt),ot.d(kt,{distance:function(){return I},getBBoxByArray:function(){return K},getBBoxRange:function(){return ut},isNumberEqual:function(){return xt},piMod:function(){return ht}});var bt=ot(45098);function I(re,Jt,Et,$t){var Yt=re-Et,St=Jt-$t;return Math.sqrt(Yt*Yt+St*St)}function xt(re,Jt){return Math.abs(re-Jt)<.001}function K(re,Jt){var Et=(0,bt.VV)(re),$t=(0,bt.VV)(Jt),Yt=(0,bt.Fp)(re),St=(0,bt.Fp)(Jt);return{x:Et,y:$t,width:Yt-Et,height:St-$t}}function ut(re,Jt,Et,$t){return{minX:(0,bt.VV)([re,Et]),maxX:(0,bt.Fp)([re,Et]),minY:(0,bt.VV)([Jt,$t]),maxY:(0,bt.Fp)([Jt,$t])}}function ht(re){return(re+Math.PI*2)%(Math.PI*2)}var lt=ot(31437),tt={box:function(re,Jt,Et,$t){return K([re,Et],[Jt,$t])},length:function(re,Jt,Et,$t){return I(re,Jt,Et,$t)},pointAt:function(re,Jt,Et,$t,Yt){return{x:(1-Yt)*re+Yt*Et,y:(1-Yt)*Jt+Yt*$t}},pointDistance:function(re,Jt,Et,$t,Yt,St){var At=(Et-re)*(Yt-re)+($t-Jt)*(St-Jt);if(At<0)return I(re,Jt,Yt,St);var ue=(Et-re)*(Et-re)+($t-Jt)*($t-Jt);return At>ue?I(Et,$t,Yt,St):this.pointToLine(re,Jt,Et,$t,Yt,St)},pointToLine:function(re,Jt,Et,$t,Yt,St){var At=[Et-re,$t-Jt];if(lt.I6(At,[0,0]))return Math.sqrt((Yt-re)*(Yt-re)+(St-Jt)*(St-Jt));var ue=[-At[1],At[0]];lt.Fv(ue,ue);var Pe=[Yt-re,St-Jt];return Math.abs(lt.AK(Pe,ue))},tangentAngle:function(re,Jt,Et,$t){return Math.atan2($t-Jt,Et-re)}},be=1e-4;function it(re,Jt,Et,$t,Yt,St){var At,ue=1/0,Pe=[Et,$t],je=20;St&&St>200&&(je=St/10);for(var Nt=1/je,wt=Nt/10,Tt=0;Tt<=je;Tt++){var Ft=Tt*Nt,J=[Yt.apply(null,re.concat([Ft])),Yt.apply(null,Jt.concat([Ft]))],gt=I(Pe[0],Pe[1],J[0],J[1]);gt<ue&&(At=Ft,ue=gt)}if(At===0)return{x:re[0],y:Jt[0]};if(At===1){var jt=re.length;return{x:re[jt-1],y:Jt[jt-1]}}ue=1/0;for(var Tt=0;Tt<32&&!(wt<be);Tt++){var ve=At-wt,Gt=At+wt,J=[Yt.apply(null,re.concat([ve])),Yt.apply(null,Jt.concat([ve]))],gt=I(Pe[0],Pe[1],J[0],J[1]);if(ve>=0&&gt<ue)At=ve,ue=gt;else{var Ae=[Yt.apply(null,re.concat([Gt])),Yt.apply(null,Jt.concat([Gt]))],He=I(Pe[0],Pe[1],Ae[0],Ae[1]);Gt<=1&&He<ue?(At=Gt,ue=He):wt*=.5}}return{x:Yt.apply(null,re.concat([At])),y:Yt.apply(null,Jt.concat([At]))}}function st(re,Jt){for(var Et=0,$t=re.length,Yt=0;Yt<$t;Yt++){var St=re[Yt],At=Jt[Yt],ue=re[(Yt+1)%$t],Pe=Jt[(Yt+1)%$t];Et+=I(St,At,ue,Pe)}return Et/2}function Ut(re,Jt,Et,$t){var Yt=1-$t;return Yt*Yt*re+2*$t*Yt*Jt+$t*$t*Et}function P(re,Jt,Et){var $t=re+Et-2*Jt;if(xt($t,0))return[.5];var Yt=(re-Jt)/$t;return Yt<=1&&Yt>=0?[Yt]:[]}function b(re,Jt,Et,$t){return 2*(1-$t)*(Jt-re)+2*$t*(Et-Jt)}function W(re,Jt,Et,$t,Yt,St,At){var ue=Ut(re,Et,Yt,At),Pe=Ut(Jt,$t,St,At),je=tt.pointAt(re,Jt,Et,$t,At),Nt=tt.pointAt(Et,$t,Yt,St,At);return[[re,Jt,je.x,je.y,ue,Pe],[ue,Pe,Nt.x,Nt.y,Yt,St]]}function fe(re,Jt,Et,$t,Yt,St,At){if(At===0)return(I(re,Jt,Et,$t)+I(Et,$t,Yt,St)+I(re,Jt,Yt,St))/2;var ue=W(re,Jt,Et,$t,Yt,St,.5),Pe=ue[0],je=ue[1];return Pe.push(At-1),je.push(At-1),fe.apply(null,Pe)+fe.apply(null,je)}var Ee={box:function(re,Jt,Et,$t,Yt,St){var At=P(re,Et,Yt)[0],ue=P(Jt,$t,St)[0],Pe=[re,Yt],je=[Jt,St];return At!==void 0&&Pe.push(Ut(re,Et,Yt,At)),ue!==void 0&&je.push(Ut(Jt,$t,St,ue)),K(Pe,je)},length:function(re,Jt,Et,$t,Yt,St){return fe(re,Jt,Et,$t,Yt,St,3)},nearestPoint:function(re,Jt,Et,$t,Yt,St,At,ue){return it([re,Et,Yt],[Jt,$t,St],At,ue,Ut)},pointDistance:function(re,Jt,Et,$t,Yt,St,At,ue){var Pe=this.nearestPoint(re,Jt,Et,$t,Yt,St,At,ue);return I(Pe.x,Pe.y,At,ue)},interpolationAt:Ut,pointAt:function(re,Jt,Et,$t,Yt,St,At){return{x:Ut(re,Et,Yt,At),y:Ut(Jt,$t,St,At)}},divide:function(re,Jt,Et,$t,Yt,St,At){return W(re,Jt,Et,$t,Yt,St,At)},tangentAngle:function(re,Jt,Et,$t,Yt,St,At){var ue=b(re,Et,Yt,At),Pe=b(Jt,$t,St,At),je=Math.atan2(Pe,ue);return ht(je)}};function Te(re,Jt,Et,$t,Yt){var St=1-Yt;return St*St*St*re+3*Jt*Yt*St*St+3*Et*Yt*Yt*St+$t*Yt*Yt*Yt}function Mt(re,Jt,Et,$t,Yt){var St=1-Yt;return 3*(St*St*(Jt-re)+2*St*Yt*(Et-Jt)+Yt*Yt*($t-Et))}function et(re,Jt,Et,$t){var Yt=-3*re+9*Jt-9*Et+3*$t,St=6*re-12*Jt+6*Et,At=3*Jt-3*re,ue=[],Pe,je,Nt;if(xt(Yt,0))xt(St,0)||(Pe=-At/St,Pe>=0&&Pe<=1&&ue.push(Pe));else{var wt=St*St-4*Yt*At;xt(wt,0)?ue.push(-St/(2*Yt)):wt>0&&(Nt=Math.sqrt(wt),Pe=(-St+Nt)/(2*Yt),je=(-St-Nt)/(2*Yt),Pe>=0&&Pe<=1&&ue.push(Pe),je>=0&&je<=1&&ue.push(je))}return ue}function Dt(re,Jt,Et,$t,Yt,St,At,ue,Pe){var je=Te(re,Et,Yt,At,Pe),Nt=Te(Jt,$t,St,ue,Pe),wt=tt.pointAt(re,Jt,Et,$t,Pe),Tt=tt.pointAt(Et,$t,Yt,St,Pe),Ft=tt.pointAt(Yt,St,At,ue,Pe),J=tt.pointAt(wt.x,wt.y,Tt.x,Tt.y,Pe),gt=tt.pointAt(Tt.x,Tt.y,Ft.x,Ft.y,Pe);return[[re,Jt,wt.x,wt.y,J.x,J.y,je,Nt],[je,Nt,gt.x,gt.y,Ft.x,Ft.y,At,ue]]}function we(re,Jt,Et,$t,Yt,St,At,ue,Pe){if(Pe===0)return st([re,Et,Yt,At],[Jt,$t,St,ue]);var je=Dt(re,Jt,Et,$t,Yt,St,At,ue,.5),Nt=je[0],wt=je[1];return Nt.push(Pe-1),wt.push(Pe-1),we.apply(null,Nt)+we.apply(null,wt)}var _e={extrema:et,box:function(re,Jt,Et,$t,Yt,St,At,ue){for(var Pe=[re,At],je=[Jt,ue],Nt=et(re,Et,Yt,At),wt=et(Jt,$t,St,ue),Tt=0;Tt<Nt.length;Tt++)Pe.push(Te(re,Et,Yt,At,Nt[Tt]));for(var Tt=0;Tt<wt.length;Tt++)je.push(Te(Jt,$t,St,ue,wt[Tt]));return K(Pe,je)},length:function(re,Jt,Et,$t,Yt,St,At,ue){return we(re,Jt,Et,$t,Yt,St,At,ue,3)},nearestPoint:function(re,Jt,Et,$t,Yt,St,At,ue,Pe,je,Nt){return it([re,Et,Yt,At],[Jt,$t,St,ue],Pe,je,Te,Nt)},pointDistance:function(re,Jt,Et,$t,Yt,St,At,ue,Pe,je,Nt){var wt=this.nearestPoint(re,Jt,Et,$t,Yt,St,At,ue,Pe,je,Nt);return I(wt.x,wt.y,Pe,je)},interpolationAt:Te,pointAt:function(re,Jt,Et,$t,Yt,St,At,ue,Pe){return{x:Te(re,Et,Yt,At,Pe),y:Te(Jt,$t,St,ue,Pe)}},divide:function(re,Jt,Et,$t,Yt,St,At,ue,Pe){return Dt(re,Jt,Et,$t,Yt,St,At,ue,Pe)},tangentAngle:function(re,Jt,Et,$t,Yt,St,At,ue,Pe){var je=Mt(re,Et,Yt,At,Pe),Nt=Mt(Jt,$t,St,ue,Pe);return ht(Math.atan2(Nt,je))}};function ge(re,Jt){var Et=Math.abs(re);return Jt>0?Et:Et*-1}var te={box:function(re,Jt,Et,$t){return{x:re-Et,y:Jt-$t,width:Et*2,height:$t*2}},length:function(re,Jt,Et,$t){return Math.PI*(3*(Et+$t)-Math.sqrt((3*Et+$t)*(Et+3*$t)))},nearestPoint:function(re,Jt,Et,$t,Yt,St){var At=Et,ue=$t;if(At===0||ue===0)return{x:re,y:Jt};for(var Pe=Yt-re,je=St-Jt,Nt=Math.abs(Pe),wt=Math.abs(je),Tt=At*At,Ft=ue*ue,J=Math.PI/4,gt,jt,ve=0;ve<4;ve++){gt=At*Math.cos(J),jt=ue*Math.sin(J);var Gt=(Tt-Ft)*Math.pow(Math.cos(J),3)/At,Ae=(Ft-Tt)*Math.pow(Math.sin(J),3)/ue,He=gt-Gt,qe=jt-Ae,hr=Nt-Gt,tr=wt-Ae,Br=Math.hypot(qe,He),Lr=Math.hypot(tr,hr),Zr=Br*Math.asin((He*tr-qe*hr)/(Br*Lr)),Tn=Zr/Math.sqrt(Tt+Ft-gt*gt-jt*jt);J+=Tn,J=Math.min(Math.PI/2,Math.max(0,J))}return{x:re+ge(gt,Pe),y:Jt+ge(jt,je)}},pointDistance:function(re,Jt,Et,$t,Yt,St){var At=this.nearestPoint(re,Jt,Et,$t,Yt,St);return I(At.x,At.y,Yt,St)},pointAt:function(re,Jt,Et,$t,Yt){var St=2*Math.PI*Yt;return{x:re+Et*Math.cos(St),y:Jt+$t*Math.sin(St)}},tangentAngle:function(re,Jt,Et,$t,Yt){var St=2*Math.PI*Yt,At=Math.atan2($t*Math.cos(St),-Et*Math.sin(St));return ht(At)}};function xe(re,Jt,Et,$t,Yt,St,At,ue){return-1*Et*Math.cos(Yt)*Math.sin(ue)-$t*Math.sin(Yt)*Math.cos(ue)}function Ye(re,Jt,Et,$t,Yt,St,At,ue){return-1*Et*Math.sin(Yt)*Math.sin(ue)+$t*Math.cos(Yt)*Math.cos(ue)}function Lt(re,Jt,Et){return Math.atan(-Jt/re*Math.tan(Et))}function Qt(re,Jt,Et){return Math.atan(Jt/(re*Math.tan(Et)))}function ct(re,Jt,Et,$t,Yt,St){return Et*Math.cos(Yt)*Math.cos(St)-$t*Math.sin(Yt)*Math.sin(St)+re}function Ct(re,Jt,Et,$t,Yt,St){return Et*Math.sin(Yt)*Math.cos(St)+$t*Math.cos(Yt)*Math.sin(St)+Jt}function Y(re,Jt,Et,$t){var Yt=Math.atan2($t*re,Et*Jt);return(Yt+Math.PI*2)%(Math.PI*2)}function yt(re,Jt,Et){return{x:re*Math.cos(Et),y:Jt*Math.sin(Et)}}function Xt(re,Jt,Et){var $t=Math.cos(Et),Yt=Math.sin(Et);return[re*$t-Jt*Yt,re*Yt+Jt*$t]}var ie={box:function(re,Jt,Et,$t,Yt,St,At){for(var ue=Lt(Et,$t,Yt),Pe=1/0,je=-1/0,Nt=[St,At],wt=-Math.PI*2;wt<=Math.PI*2;wt+=Math.PI){var Tt=ue+wt;St<At?St<Tt&&Tt<At&&Nt.push(Tt):At<Tt&&Tt<St&&Nt.push(Tt)}for(var wt=0;wt<Nt.length;wt++){var Ft=ct(re,Jt,Et,$t,Yt,Nt[wt]);Ft<Pe&&(Pe=Ft),Ft>je&&(je=Ft)}for(var J=Qt(Et,$t,Yt),gt=1/0,jt=-1/0,ve=[St,At],wt=-Math.PI*2;wt<=Math.PI*2;wt+=Math.PI){var Gt=J+wt;St<At?St<Gt&&Gt<At&&ve.push(Gt):At<Gt&&Gt<St&&ve.push(Gt)}for(var wt=0;wt<ve.length;wt++){var Ae=Ct(re,Jt,Et,$t,Yt,ve[wt]);Ae<gt&&(gt=Ae),Ae>jt&&(jt=Ae)}return{x:Pe,y:gt,width:je-Pe,height:jt-gt}},length:function(re,Jt,Et,$t,Yt,St,At){},nearestPoint:function(re,Jt,Et,$t,Yt,St,At,ue,Pe){var je=Xt(ue-re,Pe-Jt,-Yt),Nt=je[0],wt=je[1],Tt=te.nearestPoint(0,0,Et,$t,Nt,wt),Ft=Y(Et,$t,Tt.x,Tt.y);Ft<St?Tt=yt(Et,$t,St):Ft>At&&(Tt=yt(Et,$t,At));var J=Xt(Tt.x,Tt.y,Yt);return{x:J[0]+re,y:J[1]+Jt}},pointDistance:function(re,Jt,Et,$t,Yt,St,At,ue,Pe){var je=this.nearestPoint(re,Jt,Et,$t,ue,Pe);return I(je.x,je.y,ue,Pe)},pointAt:function(re,Jt,Et,$t,Yt,St,At,ue){var Pe=(At-St)*ue+St;return{x:ct(re,Jt,Et,$t,Yt,Pe),y:Ct(re,Jt,Et,$t,Yt,Pe)}},tangentAngle:function(re,Jt,Et,$t,Yt,St,At,ue){var Pe=(At-St)*ue+St,je=xe(re,Jt,Et,$t,Yt,St,At,Pe),Nt=Ye(re,Jt,Et,$t,Yt,St,At,Pe);return ht(Math.atan2(Nt,je))}};function Ce(re){for(var Jt=0,Et=[],$t=0;$t<re.length-1;$t++){var Yt=re[$t],St=re[$t+1],At=I(Yt[0],Yt[1],St[0],St[1]),ue={from:Yt,to:St,length:At};Et.push(ue),Jt+=At}return{segments:Et,totalLength:Jt}}function er(re){if(re.length<2)return 0;for(var Jt=0,Et=0;Et<re.length-1;Et++){var $t=re[Et],Yt=re[Et+1];Jt+=I($t[0],$t[1],Yt[0],Yt[1])}return Jt}function Ht(re,Jt){if(Jt>1||Jt<0||re.length<2)return null;var Et=Ce(re),$t=Et.segments,Yt=Et.totalLength;if(Yt===0)return{x:re[0][0],y:re[0][1]};for(var St=0,At=null,ue=0;ue<$t.length;ue++){var Pe=$t[ue],je=Pe.from,Nt=Pe.to,wt=Pe.length/Yt;if(Jt>=St&&Jt<=St+wt){var Tt=(Jt-St)/wt;At=tt.pointAt(je[0],je[1],Nt[0],Nt[1],Tt);break}St+=wt}return At}function ne(re,Jt){if(Jt>1||Jt<0||re.length<2)return 0;for(var Et=Ce(re),$t=Et.segments,Yt=Et.totalLength,St=0,At=0,ue=0;ue<$t.length;ue++){var Pe=$t[ue],je=Pe.from,Nt=Pe.to,wt=Pe.length/Yt;if(Jt>=St&&Jt<=St+wt){At=Math.atan2(Nt[1]-je[1],Nt[0]-je[0]);break}St+=wt}return At}function Me(re,Jt,Et){for(var $t=1/0,Yt=0;Yt<re.length-1;Yt++){var St=re[Yt],At=re[Yt+1],ue=tt.pointDistance(St[0],St[1],At[0],At[1],Jt,Et);ue<$t&&($t=ue)}return $t}var ae={box:function(re){for(var Jt=[],Et=[],$t=0;$t<re.length;$t++){var Yt=re[$t];Jt.push(Yt[0]),Et.push(Yt[1])}return K(Jt,Et)},length:function(re){return er(re)},pointAt:function(re,Jt){return Ht(re,Jt)},pointDistance:function(re,Jt,Et){return Me(re,Jt,Et)},tangentAngle:function(re,Jt){return ne(re,Jt)}};function Je(re){var Jt=re.slice(0);return re.length&&Jt.push(re[0]),Jt}var or={box:function(re){return ae.box(re)},length:function(re){return er(Je(re))},pointAt:function(re,Jt){return Ht(Je(re),Jt)},pointDistance:function(re,Jt,Et){return Me(Je(re),Jt,Et)},tangentAngle:function(re,Jt){return ne(Je(re),Jt)}}},3083:function(gn,Ot,ot){"use strict";ot.d(Ot,{Bar:function(){return ZS},Column:function(){return VS},Pie:function(){return Fx}});var kt={};ot.r(kt),ot.d(kt,{assign:function(){return rs},default:function(){return ba},defaultI18n:function(){return sc},format:function(){return Gn},parse:function(){return $i},setGlobalDateI18n:function(){return nl},setGlobalDateMasks:function(){return Ln}});var bt={};ot.r(bt),ot.d(bt,{Arc:function(){return De},DataMarker:function(){return xr},DataRegion:function(){return Rr},Html:function(){return Ra},Image:function(){return br},Line:function(){return ft},Region:function(){return cr},RegionFilter:function(){return ln},Shape:function(){return Zn},Text:function(){return ee}});var I={};ot.r(I),ot.d(I,{ellipsisHead:function(){return da},ellipsisMiddle:function(){return ss},ellipsisTail:function(){return Ds},getDefault:function(){return pa}});var xt={};ot.r(xt),ot.d(xt,{equidistance:function(){return cl},equidistanceWithReverseBoth:function(){return yh},getDefault:function(){return Du},reserveBoth:function(){return Kl},reserveFirst:function(){return kc},reserveLast:function(){return qu}});var K={};ot.r(K),ot.d(K,{fixedAngle:function(){return Yf},getDefault:function(){return _h},unfixedAngle:function(){return dc}});var ut={};ot.r(ut),ot.d(ut,{autoEllipsis:function(){return I},autoHide:function(){return xt},autoRotate:function(){return K}});var ht={};ot.r(ht),ot.d(ht,{Base:function(){return vc},Circle:function(){return qc},Html:function(){return Jc},Line:function(){return Sl}});var lt={};ot.r(lt),ot.d(lt,{CONTAINER_CLASS:function(){return ef},CROSSHAIR_X:function(){return qf},CROSSHAIR_Y:function(){return Ad},LIST_CLASS:function(){return Pc},LIST_ITEM_CLASS:function(){return Vp},MARKER_CLASS:function(){return wh},NAME_CLASS:function(){return Ns},TITLE_CLASS:function(){return Cl},VALUE_CLASS:function(){return fv}});var tt={};ot.r(tt),ot.d(tt,{Base:function(){return Of},Circle:function(){return q_},Ellipse:function(){return Hd},Image:function(){return Qg},Line:function(){return bp},Marker:function(){return Qm},Path:function(){return J_},Polygon:function(){return d2},Polyline:function(){return g2},Rect:function(){return x2},Text:function(){return E2}});var be={};ot.r(be),ot.d(be,{Canvas:function(){return C2},Group:function(){return Fv},Shape:function(){return tt},getArcParams:function(){return Tv},version:function(){return xc}});var it={};ot.r(it),ot.d(it,{Base:function(){return Dh},Circle:function(){return mT},Dom:function(){return _T},Ellipse:function(){return L2},Image:function(){return O2},Line:function(){return bT},Marker:function(){return ST},Path:function(){return CT},Polygon:function(){return TT},Polyline:function(){return IT},Rect:function(){return FT},Text:function(){return N2}});var st={};ot.r(st),ot.d(st,{Canvas:function(){return HT},Group:function(){return ey},Shape:function(){return it},version:function(){return Wd}});var Ut={};ot.r(Ut),ot.d(Ut,{cluster:function(){return JC},hierarchy:function(){return Tg},pack:function(){return qy},packEnclose:function(){return Jx},packSiblings:function(){return eF},partition:function(){return Mb},stratify:function(){return iL},tree:function(){return kb},treemap:function(){return oL},treemapBinary:function(){return __},treemapDice:function(){return Tm},treemapResquarify:function(){return aA},treemapSlice:function(){return y_},treemapSliceDice:function(){return Lm},treemapSquarify:function(){return iA}});var P=ot(70655),b=ot(45098),W;(function(r){r.FORE="fore",r.MID="mid",r.BG="bg"})(W||(W={}));var fe;(function(r){r.TOP="top",r.TOP_LEFT="top-left",r.TOP_RIGHT="top-right",r.RIGHT="right",r.RIGHT_TOP="right-top",r.RIGHT_BOTTOM="right-bottom",r.LEFT="left",r.LEFT_TOP="left-top",r.LEFT_BOTTOM="left-bottom",r.BOTTOM="bottom",r.BOTTOM_LEFT="bottom-left",r.BOTTOM_RIGHT="bottom-right",r.RADIUS="radius",r.CIRCLE="circle",r.NONE="none"})(fe||(fe={}));var Ee;(function(r){r.AXIS="axis",r.GRID="grid",r.LEGEND="legend",r.TOOLTIP="tooltip",r.ANNOTATION="annotation",r.SLIDER="slider",r.SCROLLBAR="scrollbar",r.OTHER="other"})(Ee||(Ee={}));var Te={FORE:3,MID:2,BG:1},Mt;(function(r){r.BEFORE_RENDER="beforerender",r.AFTER_RENDER="afterrender",r.BEFORE_PAINT="beforepaint",r.AFTER_PAINT="afterpaint",r.BEFORE_CHANGE_DATA="beforechangedata",r.AFTER_CHANGE_DATA="afterchangedata",r.BEFORE_CLEAR="beforeclear",r.AFTER_CLEAR="afterclear",r.BEFORE_DESTROY="beforedestroy",r.BEFORE_CHANGE_SIZE="beforechangesize",r.AFTER_CHANGE_SIZE="afterchangesize"})(Mt||(Mt={}));var et;(function(r){r.BEFORE_DRAW_ANIMATE="beforeanimate",r.AFTER_DRAW_ANIMATE="afteranimate",r.BEFORE_RENDER_LABEL="beforerenderlabel",r.AFTER_RENDER_LABEL="afterrenderlabel"})(et||(et={}));var Dt;(function(r){r.MOUSE_ENTER="plot:mouseenter",r.MOUSE_DOWN="plot:mousedown",r.MOUSE_MOVE="plot:mousemove",r.MOUSE_UP="plot:mouseup",r.MOUSE_LEAVE="plot:mouseleave",r.TOUCH_START="plot:touchstart",r.TOUCH_MOVE="plot:touchmove",r.TOUCH_END="plot:touchend",r.TOUCH_CANCEL="plot:touchcancel",r.CLICK="plot:click",r.DBLCLICK="plot:dblclick",r.CONTEXTMENU="plot:contextmenu",r.LEAVE="plot:leave",r.ENTER="plot:enter"})(Dt||(Dt={}));var we;(function(r){r.ACTIVE="active",r.INACTIVE="inactive",r.SELECTED="selected",r.DEFAULT="default"})(we||(we={}));var _e=["color","shape","size"],ge="_origin",te=1,xe=1,Ye=.25,Lt={};function Qt(r){var e=Lt[r];if(!e)throw new Error("G engine '".concat(r,"' is not exist, please register it at first."));return e}function ct(r,e){Lt[r]=e}var Ct=ot(6056),Y=ot(45442);function yt(r){var e=getComputedStyle(r);return{width:(r.clientWidth||parseInt(e.width,10))-parseInt(e.paddingLeft,10)-parseInt(e.paddingRight,10),height:(r.clientHeight||parseInt(e.height,10))-parseInt(e.paddingTop,10)-parseInt(e.paddingBottom,10)}}function Xt(r){return typeof r=="number"&&!isNaN(r)}function ie(r,e,t,i){var u=t,c=i;if(e){var p=yt(r);u=p.width?p.width:u,c=p.height?p.height:c}return{width:Math.max(Xt(u)?u:te,te),height:Math.max(Xt(c)?c:xe,xe)}}function Ce(r){var e=r.parentNode;e&&e.removeChild(r)}var er=ot(90494),Ht=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this)||this;i.destroyed=!1;var u=t.visible,c=u===void 0?!0:u;return i.visible=c,i}return e.prototype.show=function(){var t=this.visible;t||this.changeVisible(!0)},e.prototype.hide=function(){var t=this.visible;t&&this.changeVisible(!1)},e.prototype.destroy=function(){this.off(),this.destroyed=!0},e.prototype.changeVisible=function(t){this.visible!==t&&(this.visible=t)},e}(er.Z),ne=Ht,Me=ot(98190),ae=0,Je=1/2,or=1/2,re=.05,Jt=function(){function r(e){var t=e.xField,i=e.yField,u=e.adjustNames,c=u===void 0?["x","y"]:u,p=e.dimValuesMap;this.adjustNames=c,this.xField=t,this.yField=i,this.dimValuesMap=p}return r.prototype.isAdjust=function(e){return this.adjustNames.indexOf(e)>=0},r.prototype.getAdjustRange=function(e,t,i){var u=this.yField,c=i.indexOf(t),p=i.length,g,_;return!u&&this.isAdjust("y")?(g=0,_=1):p>1?(g=i[c===0?0:c-1],_=i[c===p-1?p-1:c+1],c!==0?g+=(t-g)/2:g-=(_-t)/2,c!==p-1?_-=(_-t)/2:_+=(t-i[p-2])/2):(g=t===0?0:t-.5,_=t===0?1:t+.5),{pre:g,next:_}},r.prototype.adjustData=function(e,t){var i=this,u=this.getDimValues(t);b.S6(e,function(c,p){b.S6(u,function(g,_){i.adjustDim(_,g,c,p)})})},r.prototype.groupData=function(e,t){return b.S6(e,function(i){i[t]===void 0&&(i[t]=ae)}),b.vM(e,t)},r.prototype.adjustDim=function(e,t,i,u){},r.prototype.getDimValues=function(e){var t=this,i=t.xField,u=t.yField,c=b.f0({},this.dimValuesMap),p=[];if(i&&this.isAdjust("x")&&p.push(i),u&&this.isAdjust("y")&&p.push(u),p.forEach(function(_){c&&c[_]||(c[_]=b.I(e,_).sort(function(w,k){return w-k}))}),!u&&this.isAdjust("y")){var g="y";c[g]=[ae,1]}return c},r}(),Et=Jt,$t={},Yt=function(r){return $t[r.toLowerCase()]},St=function(r,e){if(Yt(r))throw new Error("Adjust type '"+r+"' existed.");$t[r.toLowerCase()]=e},At=ot(77190),ue=ot.n(At);var Pe=function(e,t){return Pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,u){i.__proto__=u}||function(i,u){for(var c in u)u.hasOwnProperty(c)&&(i[c]=u[c])},Pe(e,t)};function je(r,e){Pe(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Nt=function(){return Nt=Object.assign||function(t){for(var i,u=1,c=arguments.length;u<c;u++){i=arguments[u];for(var p in i)Object.prototype.hasOwnProperty.call(i,p)&&(t[p]=i[p])}return t},Nt.apply(this,arguments)};function wt(r,e){var t={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,i=Object.getOwnPropertySymbols(r);u<i.length;u++)e.indexOf(i[u])<0&&Object.prototype.propertyIsEnumerable.call(r,i[u])&&(t[i[u]]=r[i[u]]);return t}function Tt(r,e,t,i){var u=arguments.length,c=u<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,p;if((typeof Reflect=="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,i);else for(var g=r.length-1;g>=0;g--)(p=r[g])&&(c=(u<3?p(c):u>3?p(e,t,c):p(e,t))||c);return u>3&&c&&Object.defineProperty(e,t,c),c}function Ft(r,e){return function(t,i){e(t,i,r)}}function J(r,e){if((typeof Reflect=="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function gt(r,e,t,i){function u(c){return c instanceof t?c:new t(function(p){p(c)})}return new(t||(t=Promise))(function(c,p){function g(k){try{w(i.next(k))}catch(L){p(L)}}function _(k){try{w(i.throw(k))}catch(L){p(L)}}function w(k){k.done?c(k.value):u(k.value).then(g,_)}w((i=i.apply(r,e||[])).next())})}function jt(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,u,c,p;return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(w){return function(k){return _([w,k])}}function _(w){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,u&&(c=w[0]&2?u.return:w[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,w[1])).done)return c;switch(u=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return t.label++,{value:w[1],done:!1};case 5:t.label++,u=w[1],w=[0];continue;case 7:w=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){t=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){t.label=w[1];break}if(w[0]===6&&t.label<c[1]){t.label=c[1],c=w;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(w);break}c[2]&&t.ops.pop(),t.trys.pop();continue}w=e.call(r,t)}catch(k){w=[6,k],u=0}finally{i=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}}function ve(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}function Gt(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Ae(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function He(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),u,c=[],p;try{for(;(e===void 0||e-- >0)&&!(u=i.next()).done;)c.push(u.value)}catch(g){p={error:g}}finally{try{u&&!u.done&&(t=i.return)&&t.call(i)}finally{if(p)throw p.error}}return c}function qe(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(He(arguments[e]));return r}function hr(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),u=0,e=0;e<t;e++)for(var c=arguments[e],p=0,g=c.length;p<g;p++,u++)i[u]=c[p];return i}function tr(r){return this instanceof tr?(this.v=r,this):new tr(r)}function Br(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(r,e||[]),u,c=[];return u={},p("next"),p("throw"),p("return"),u[Symbol.asyncIterator]=function(){return this},u;function p(R){i[R]&&(u[R]=function(U){return new Promise(function(G,Q){c.push([R,U,G,Q])>1||g(R,U)})})}function g(R,U){try{_(i[R](U))}catch(G){L(c[0][3],G)}}function _(R){R.value instanceof tr?Promise.resolve(R.value.v).then(w,k):L(c[0][2],R)}function w(R){g("next",R)}function k(R){g("throw",R)}function L(R,U){R(U),c.shift(),c.length&&g(c[0][0],c[0][1])}}function Lr(r){var e,t;return e={},i("next"),i("throw",function(u){throw u}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(u,c){e[u]=r[u]?function(p){return(t=!t)?{value:tr(r[u](p)),done:u==="return"}:c?c(p):p}:c}}function Zr(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Ae=="function"?Ae(r):r[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=r[c]&&function(p){return new Promise(function(g,_){p=r[c](p),u(g,_,p.done,p.value)})}}function u(c,p,g,_){Promise.resolve(_).then(function(w){c({value:w,done:g})},p)}}function Tn(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function rn(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function Nn(r){return r&&r.__esModule?r:{default:r}}function zn(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function jn(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var Sn=function(r){je(e,r);function e(t){var i=r.call(this,t)||this;i.cacheMap={},i.adjustDataArray=[],i.mergeData=[];var u=t.marginRatio,c=u===void 0?Je:u,p=t.dodgeRatio,g=p===void 0?or:p,_=t.dodgeBy,w=t.intervalPadding,k=t.dodgePadding,L=t.xDimensionLength,R=t.groupNum,U=t.defaultSize,G=t.maxColumnWidth,Q=t.minColumnWidth,pt=t.columnWidthRatio,vt=t.customOffset;return i.marginRatio=c,i.dodgeRatio=g,i.dodgeBy=_,i.intervalPadding=w,i.dodgePadding=k,i.xDimensionLegenth=L,i.groupNum=R,i.defaultSize=U,i.maxColumnWidth=G,i.minColumnWidth=Q,i.columnWidthRatio=pt,i.customOffset=vt,i}return e.prototype.process=function(t){var i=b.d9(t),u=b.xH(i),c=this.dodgeBy,p=c?b.ru(u,c):i;return this.cacheMap={},this.adjustDataArray=p,this.mergeData=u,this.adjustData(p,u),this.adjustDataArray=[],this.mergeData=[],i},e.prototype.adjustDim=function(t,i,u,c){var p=this,g=this.customOffset,_=this.getDistribution(t),w=this.groupData(u,t);return b.S6(w,function(k,L){var R;i.length===1?R={pre:i[0]-1,next:i[0]+1}:R=p.getAdjustRange(t,parseFloat(L),i),b.S6(k,function(U){var G=U[t],Q=_[G],pt=Q.indexOf(c);if(b.UM(g))U[t]=p.getDodgeOffset(R,pt,Q.length);else{var vt=R.pre,Vt=R.next;U[t]=b.mf(g)?g(U,R):(vt+Vt)/2+g}})}),[]},e.prototype.getDodgeOffset=function(t,i,u){var c=this,p=c.dodgeRatio,g=c.marginRatio,_=c.intervalPadding,w=c.dodgePadding,k=t.pre,L=t.next,R=L-k,U;if(!b.UM(_)&&b.UM(w)&&_>=0){var G=this.getIntervalOnlyOffset(u,i);U=k+G}else if(!b.UM(w)&&b.UM(_)&&w>=0){var G=this.getDodgeOnlyOffset(u,i);U=k+G}else if(!b.UM(_)&&!b.UM(w)&&_>=0&&w>=0){var G=this.getIntervalAndDodgeOffset(u,i);U=k+G}else{var Q=R*p/u,pt=g*Q,G=1/2*(R-u*Q-(u-1)*pt)+((i+1)*Q+i*pt)-1/2*Q-1/2*R;U=(k+L)/2+G}return U},e.prototype.getIntervalOnlyOffset=function(t,i){var u=this,c=u.defaultSize,p=u.intervalPadding,g=u.xDimensionLegenth,_=u.groupNum,w=u.dodgeRatio,k=u.maxColumnWidth,L=u.minColumnWidth,R=u.columnWidthRatio,U=p/g,G=(1-(_-1)*U)/_*w/(t-1),Q=((1-U*(_-1))/_-G*(t-1))/t;if(Q=b.UM(R)?Q:1/_/t*R,!b.UM(k)){var pt=k/g;Q=Math.min(Q,pt)}if(!b.UM(L)){var vt=L/g;Q=Math.max(Q,vt)}Q=c?c/g:Q,G=((1-(_-1)*U)/_-t*Q)/(t-1);var Vt=((1/2+i)*Q+i*G+1/2*U)*_-U/2;return Vt},e.prototype.getDodgeOnlyOffset=function(t,i){var u=this,c=u.defaultSize,p=u.dodgePadding,g=u.xDimensionLegenth,_=u.groupNum,w=u.marginRatio,k=u.maxColumnWidth,L=u.minColumnWidth,R=u.columnWidthRatio,U=p/g,G=1*w/(_-1),Q=((1-G*(_-1))/_-U*(t-1))/t;if(Q=R?1/_/t*R:Q,!b.UM(k)){var pt=k/g;Q=Math.min(Q,pt)}if(!b.UM(L)){var vt=L/g;Q=Math.max(Q,vt)}Q=c?c/g:Q,G=(1-(Q*t+U*(t-1))*_)/(_-1);var Vt=((1/2+i)*Q+i*U+1/2*G)*_-G/2;return Vt},e.prototype.getIntervalAndDodgeOffset=function(t,i){var u=this,c=u.intervalPadding,p=u.dodgePadding,g=u.xDimensionLegenth,_=u.groupNum,w=c/g,k=p/g,L=((1-w*(_-1))/_-k*(t-1))/t,R=((1/2+i)*L+i*k+1/2*w)*_-w/2;return R},e.prototype.getDistribution=function(t){var i=this.adjustDataArray,u=this.cacheMap,c=u[t];return c||(c={},b.S6(i,function(p,g){var _=b.I(p,t);_.length||_.push(0),b.S6(_,function(w){c[w]||(c[w]=[]),c[w].push(g)})}),u[t]=c),c},e}(Et),Wn=Sn;function Rt(r,e){return(e-r)*Math.random()+r}var Wt=function(r){je(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.process=function(t){var i=b.d9(t),u=b.xH(i);return this.adjustData(i,u),i},e.prototype.adjustDim=function(t,i,u){var c=this,p=this.groupData(u,t);return b.S6(p,function(g,_){return c.adjustGroup(g,t,parseFloat(_),i)})},e.prototype.getAdjustOffset=function(t){var i=t.pre,u=t.next,c=(u-i)*re;return Rt(i+c,u-c)},e.prototype.adjustGroup=function(t,i,u,c){var p=this,g=this.getAdjustRange(i,u,c);return b.S6(t,function(_){_[i]=p.getAdjustOffset(g)}),t},e}(Et),oe=Wt,Se=b.Ct,ze=function(r){je(e,r);function e(t){var i=r.call(this,t)||this,u=t.adjustNames,c=u===void 0?["y"]:u,p=t.height,g=p===void 0?NaN:p,_=t.size,w=_===void 0?10:_,k=t.reverseOrder,L=k===void 0?!1:k;return i.adjustNames=c,i.height=g,i.size=w,i.reverseOrder=L,i}return e.prototype.process=function(t){var i=this,u=i.yField,c=i.reverseOrder,p=u?this.processStack(t):this.processOneDimStack(t);return c?this.reverse(p):p},e.prototype.reverse=function(t){return t.slice(0).reverse()},e.prototype.processStack=function(t){var i=this,u=i.xField,c=i.yField,p=i.reverseOrder,g=p?this.reverse(t):t,_=new Se,w=new Se;return g.map(function(k){return k.map(function(L){var R,U=b.U2(L,u,0),G=b.U2(L,[c]),Q=U.toString();if(G=b.kJ(G)?G[1]:G,!b.UM(G)){var pt=G>=0?_:w;pt.has(Q)||pt.set(Q,0);var vt=pt.get(Q),Vt=G+vt;return pt.set(Q,Vt),Nt(Nt({},L),(R={},R[c]=[vt,Vt],R))}return L})})},e.prototype.processOneDimStack=function(t){var i=this,u=this,c=u.xField,p=u.height,g=u.reverseOrder,_="y",w=g?this.reverse(t):t,k=new Se;return w.map(function(L){return L.map(function(R){var U,G=i.size,Q=R[c],pt=G*2/p;k.has(Q)||k.set(Q,pt/2);var vt=k.get(Q);return k.set(Q,vt+pt),Nt(Nt({},R),(U={},U[_]=vt,U))})})},e}(Et),fr=ze,wr=function(r){je(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.process=function(t){var i=b.xH(t),u=this,c=u.xField,p=u.yField,g=this.getXValuesMaxMap(i),_=Math.max.apply(Math,Object.keys(g).map(function(w){return g[w]}));return b.UI(t,function(w){return b.UI(w,function(k){var L,R,U=k[p],G=k[c];if(b.kJ(U)){var Q=(_-g[G])/2;return Nt(Nt({},k),(L={},L[p]=b.UI(U,function(vt){return Q+vt}),L))}var pt=(_-U)/2;return Nt(Nt({},k),(R={},R[p]=[pt,U+pt],R))})})},e.prototype.getXValuesMaxMap=function(t){var i=this,u=this,c=u.xField,p=u.yField,g=b.vM(t,function(_){return _[c]});return b.Q8(g,function(_){return i.getDimMaxValue(_,p)})},e.prototype.getDimMaxValue=function(t,i){var u=b.UI(t,function(p){return b.U2(p,i,[])}),c=b.xH(u);return Math.max.apply(Math,c)},e}(Et),Le=wr;St("Dodge",Wn),St("Jitter",oe),St("Stack",fr),St("Symmetric",Le);var ur=function(r,e){return(0,b.HD)(e)?e:r.invert(r.scale(e))},Wr=function(){function r(e){this.names=[],this.scales=[],this.linear=!1,this.values=[],this.callback=function(){return[]},this._parseCfg(e)}return r.prototype.mapping=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var u=t.map(function(c,p){return e._toOriginParam(c,e.scales[p])});return this.callback.apply(this,u)},r.prototype.getLinearValue=function(e){var t=this.values.length-1,i=Math.floor(t*e),u=t*e-i,c=this.values[i],p=i===t?c:this.values[i+1];return c+(p-c)*u},r.prototype.getNames=function(){for(var e=this.scales,t=this.names,i=Math.min(e.length,t.length),u=[],c=0;c<i;c+=1)u.push(t[c]);return u},r.prototype.getFields=function(){return this.scales.map(function(e){return e.field})},r.prototype.getScale=function(e){return this.scales[this.names.indexOf(e)]},r.prototype.defaultCallback=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.length===0?this.values:t.map(function(u,c){var p=e.scales[c];return p.type==="identity"?p.values[0]:e._getAttributeValue(p,u)})},r.prototype._parseCfg=function(e){var t=this,i=e.type,u=i===void 0?"base":i,c=e.names,p=c===void 0?[]:c,g=e.scales,_=g===void 0?[]:g,w=e.values,k=w===void 0?[]:w,L=e.callback;this.type=u,this.scales=_,this.values=k,this.names=p,this.callback=function(){for(var R=[],U=0;U<arguments.length;U++)R[U]=arguments[U];if(L){var G=L.apply(void 0,R);if(!(0,b.UM)(G))return[G]}return t.defaultCallback.apply(t,R)}},r.prototype._getAttributeValue=function(e,t){if(e.isCategory&&!this.linear){var i=e.translate(t);return this.values[i%this.values.length]}var u=e.scale(t);return this.getLinearValue(u)},r.prototype._toOriginParam=function(e,t){return t.isLinear?e:(0,b.kJ)(e)?e.map(function(i){return ur(t,i)}):ur(t,e)},r}(),wn=Wr;var qr=function(e,t){return qr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,u){i.__proto__=u}||function(i,u){for(var c in u)u.hasOwnProperty(c)&&(i[c]=u[c])},qr(e,t)};function Qr(r,e){qr(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Mn=function(){return Mn=Object.assign||function(t){for(var i,u=1,c=arguments.length;u<c;u++){i=arguments[u];for(var p in i)Object.prototype.hasOwnProperty.call(i,p)&&(t[p]=i[p])}return t},Mn.apply(this,arguments)};function bi(r,e){var t={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,i=Object.getOwnPropertySymbols(r);u<i.length;u++)e.indexOf(i[u])<0&&Object.prototype.propertyIsEnumerable.call(r,i[u])&&(t[i[u]]=r[i[u]]);return t}function wi(r,e,t,i){var u=arguments.length,c=u<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,p;if((typeof Reflect=="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,i);else for(var g=r.length-1;g>=0;g--)(p=r[g])&&(c=(u<3?p(c):u>3?p(e,t,c):p(e,t))||c);return u>3&&c&&Object.defineProperty(e,t,c),c}function Kr(r,e){return function(t,i){e(t,i,r)}}function ai(r,e){if((typeof Reflect=="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function li(r,e,t,i){function u(c){return c instanceof t?c:new t(function(p){p(c)})}return new(t||(t=Promise))(function(c,p){function g(k){try{w(i.next(k))}catch(L){p(L)}}function _(k){try{w(i.throw(k))}catch(L){p(L)}}function w(k){k.done?c(k.value):u(k.value).then(g,_)}w((i=i.apply(r,e||[])).next())})}function hi(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,u,c,p;return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(w){return function(k){return _([w,k])}}function _(w){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,u&&(c=w[0]&2?u.return:w[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,w[1])).done)return c;switch(u=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return t.label++,{value:w[1],done:!1};case 5:t.label++,u=w[1],w=[0];continue;case 7:w=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){t=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){t.label=w[1];break}if(w[0]===6&&t.label<c[1]){t.label=c[1],c=w;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(w);break}c[2]&&t.ops.pop(),t.trys.pop();continue}w=e.call(r,t)}catch(k){w=[6,k],u=0}finally{i=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}}function ra(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}function Ci(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Ba(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function po(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),u,c=[],p;try{for(;(e===void 0||e-- >0)&&!(u=i.next()).done;)c.push(u.value)}catch(g){p={error:g}}finally{try{u&&!u.done&&(t=i.return)&&t.call(i)}finally{if(p)throw p.error}}return c}function za(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(po(arguments[e]));return r}function Xa(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),u=0,e=0;e<t;e++)for(var c=arguments[e],p=0,g=c.length;p<g;p++,u++)i[u]=c[p];return i}function Ta(r){return this instanceof Ta?(this.v=r,this):new Ta(r)}function ga(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(r,e||[]),u,c=[];return u={},p("next"),p("throw"),p("return"),u[Symbol.asyncIterator]=function(){return this},u;function p(R){i[R]&&(u[R]=function(U){return new Promise(function(G,Q){c.push([R,U,G,Q])>1||g(R,U)})})}function g(R,U){try{_(i[R](U))}catch(G){L(c[0][3],G)}}function _(R){R.value instanceof Ta?Promise.resolve(R.value.v).then(w,k):L(c[0][2],R)}function w(R){g("next",R)}function k(R){g("throw",R)}function L(R,U){R(U),c.shift(),c.length&&g(c[0][0],c[0][1])}}function no(r){var e,t;return e={},i("next"),i("throw",function(u){throw u}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(u,c){e[u]=r[u]?function(p){return(t=!t)?{value:Ta(r[u](p)),done:u==="return"}:c?c(p):p}:c}}function Vo(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Ba=="function"?Ba(r):r[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=r[c]&&function(p){return new Promise(function(g,_){p=r[c](p),u(g,_,p.done,p.value)})}}function u(c,p,g,_){Promise.resolve(_).then(function(w){c({value:w,done:g})},p)}}function vo(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function ja(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function to(r){return r&&r.__esModule?r:{default:r}}function Uo(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function ju(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var Wo=/rgba?\(([\s.,0-9]+)\)/,bo=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,nr=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,ye=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,Ge=function(r){return/^[r,R,L,l]{1}[\s]*\(/.test(r)},Mr=function(){var r=document.createElement("i");return r.title="Web Colour Picker",r.style.display="none",document.body.appendChild(r),r},tn=function(r,e,t,i){return r[i]+(e[i]-r[i])*t};function In(r){return"#"+Cn(r[0])+Cn(r[1])+Cn(r[2])}var Un=function(r){return[parseInt(r.substr(1,2),16),parseInt(r.substr(3,2),16),parseInt(r.substr(5,2),16)]},Cn=function(r){var e=Math.round(r).toString(16);return e.length===1?"0"+e:e},ta=function(r,e){var t=isNaN(Number(e))||e<0?0:e>1?1:Number(e),i=r.length-1,u=Math.floor(i*t),c=i*t-u,p=r[u],g=u===i?p:r[u+1];return In([tn(p,g,c,0),tn(p,g,c,1),tn(p,g,c,2)])},Wa,es=function(r){if(r[0]==="#"&&r.length===7)return r;Wa||(Wa=Mr()),Wa.style.color=r;var e=document.defaultView.getComputedStyle(Wa,"").getPropertyValue("color"),t=Wo.exec(e),i=t[1].split(/\s*,\s*/).map(function(u){return Number(u)});return e=In(i),e},ko=function(r){var e=(0,b.HD)(r)?r.split("-"):r,t=(0,b.UI)(e,function(i){return Un(i.indexOf("#")===-1?es(i):i)});return function(i){return ta(t,i)}},ns=function(r){if(Ge(r)){var e,t=void 0;if(r[0]==="l"){var i=bo.exec(r),u=+i[1]+90;t=i[2],e="linear-gradient("+u+"deg, "}else if(r[0]==="r"){e="radial-gradient(";var i=nr.exec(r);t=i[4]}var c=t.match(ye);return(0,b.S6)(c,function(p,g){var _=p.split(":");e+=_[1]+" "+_[0]*100+"%",g!==c.length-1&&(e+=", ")}),e+=")",e}return r},Ya={rgb2arr:Un,gradient:ko,toRGB:(0,b.HP)(es),toCSSGradient:ns},Go=function(r){Qr(e,r);function e(t){var i=r.call(this,t)||this;return i.type="color",i.names=["color"],(0,b.HD)(i.values)&&(i.linear=!0),i.gradient=Ya.gradient(i.values),i}return e.prototype.getLinearValue=function(t){return this.gradient(t)},e}(wn),pu=Go,ys=function(r){Qr(e,r);function e(t){var i=r.call(this,t)||this;return i.type="opacity",i.names=["opacity"],i}return e}(wn),Rl=ys,mf=function(r){Qr(e,r);function e(t){var i=r.call(this,t)||this;return i.names=["x","y"],i.type="position",i}return e.prototype.mapping=function(t,i){var u=this.scales,c=u[0],p=u[1];return(0,b.UM)(t)||(0,b.UM)(i)?[]:[(0,b.kJ)(t)?t.map(function(g){return c.scale(g)}):c.scale(t),(0,b.kJ)(i)?i.map(function(g){return p.scale(g)}):p.scale(i)]},e}(wn),Wu=mf,Ie=function(r){Qr(e,r);function e(t){var i=r.call(this,t)||this;return i.type="shape",i.names=["shape"],i}return e.prototype.getLinearValue=function(t){var i=Math.round((this.values.length-1)*t);return this.values[i]},e}(wn),We=Ie,Tr=function(r){Qr(e,r);function e(t){var i=r.call(this,t)||this;return i.type="size",i.names=["size"],i}return e}(wn),un=Tr,si={};function ji(r){return si[r]}function Ma(r,e){si[r]=e}var ds=function(){function r(e){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=e,this.initCfg(),this.init()}return r.prototype.translate=function(e){return e},r.prototype.change=function(e){(0,b.f0)(this.__cfg__,e),this.init()},r.prototype.clone=function(){return this.constructor(this.__cfg__)},r.prototype.getTicks=function(){var e=this;return(0,b.UI)(this.ticks,function(t,i){return(0,b.Kn)(t)?t:{text:e.getText(t,i),tickValue:t,value:e.scale(t)}})},r.prototype.getText=function(e,t){var i=this.formatter,u=i?i(e,t):e;return(0,b.UM)(u)||!(0,b.mf)(u.toString)?"":u.toString()},r.prototype.getConfig=function(e){return this.__cfg__[e]},r.prototype.init=function(){(0,b.f0)(this,this.__cfg__),this.setDomain(),(0,b.xb)(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},r.prototype.initCfg=function(){},r.prototype.setDomain=function(){},r.prototype.calculateTicks=function(){var e=this.tickMethod,t=[];if((0,b.HD)(e)){var i=ji(e);if(!i)throw new Error("There is no method to to calculate ticks!");t=i(this)}else(0,b.mf)(e)&&(t=e(this));return t},r.prototype.rangeMin=function(){return this.range[0]},r.prototype.rangeMax=function(){return this.range[1]},r.prototype.calcPercent=function(e,t,i){return(0,b.hj)(e)?(e-t)/(i-t):NaN},r.prototype.calcValue=function(e,t,i){return t+e*(i-t)},r}(),Ho=ds,qo=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="cat",t.isCategory=!0,t}return e.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var t=0;t<this.values.length;t++)this.translateIndexMap.set(this.values[t],t)}},e.prototype.translate=function(t){this.buildIndexMap();var i=this.translateIndexMap.get(t);return i===void 0&&(i=(0,b.hj)(t)?t:NaN),i},e.prototype.scale=function(t){var i=this.translate(t),u=this.calcPercent(i,this.min,this.max);return this.calcValue(u,this.rangeMin(),this.rangeMax())},e.prototype.invert=function(t){var i=this.max-this.min,u=this.calcPercent(t,this.rangeMin(),this.rangeMax()),c=Math.round(i*u)+this.min;return c<this.min||c>this.max?NaN:this.values[c]},e.prototype.getText=function(t){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var c=t;return(0,b.hj)(t)&&!this.values.includes(t)&&(c=this.values[c]),r.prototype.getText.apply(this,(0,P.pr)([c],i))},e.prototype.initCfg=function(){this.tickMethod="cat"},e.prototype.setDomain=function(){if((0,b.UM)(this.getConfig("min"))&&(this.min=0),(0,b.UM)(this.getConfig("max"))){var t=this.values.length;this.max=t>1?t-1:t}this.translateIndexMap&&(this.translateIndexMap=void 0)},e}(Ho),Hs=qo,Xu=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,_s="\\d\\d?",vs="\\d\\d",Ou="\\d{3}",rl="\\d{4}",nu="[^\\s]+",dl=/\[([^]*?)\]/gm;function Fu(r,e){for(var t=[],i=0,u=r.length;i<u;i++)t.push(r[i].substr(0,e));return t}var Fo=function(r){return function(e,t){var i=t[r].map(function(c){return c.toLowerCase()}),u=i.indexOf(e.toLowerCase());return u>-1?u:null}};function rs(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var i=0,u=e;i<u.length;i++){var c=u[i];for(var p in c)r[p]=c[p]}return r}var Uc=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],_u=["January","February","March","April","May","June","July","August","September","October","November","December"],Zc=Fu(_u,3),Co=Fu(Uc,3),sc={dayNamesShort:Co,dayNames:Uc,monthNamesShort:Zc,monthNames:_u,amPm:["am","pm"],DoFn:function(r){return r+["th","st","nd","rd"][r%10>3?0:(r-r%10!==10?1:0)*r%10]}},Xl=rs({},sc),nl=function(r){return Xl=rs(Xl,r)},uc=function(r){return r.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},D=function(r,e){for(e===void 0&&(e=2),r=String(r);r.length<e;)r="0"+r;return r},X={D:function(r){return String(r.getDate())},DD:function(r){return D(r.getDate())},Do:function(r,e){return e.DoFn(r.getDate())},d:function(r){return String(r.getDay())},dd:function(r){return D(r.getDay())},ddd:function(r,e){return e.dayNamesShort[r.getDay()]},dddd:function(r,e){return e.dayNames[r.getDay()]},M:function(r){return String(r.getMonth()+1)},MM:function(r){return D(r.getMonth()+1)},MMM:function(r,e){return e.monthNamesShort[r.getMonth()]},MMMM:function(r,e){return e.monthNames[r.getMonth()]},YY:function(r){return D(String(r.getFullYear()),4).substr(2)},YYYY:function(r){return D(r.getFullYear(),4)},h:function(r){return String(r.getHours()%12||12)},hh:function(r){return D(r.getHours()%12||12)},H:function(r){return String(r.getHours())},HH:function(r){return D(r.getHours())},m:function(r){return String(r.getMinutes())},mm:function(r){return D(r.getMinutes())},s:function(r){return String(r.getSeconds())},ss:function(r){return D(r.getSeconds())},S:function(r){return String(Math.round(r.getMilliseconds()/100))},SS:function(r){return D(Math.round(r.getMilliseconds()/10),2)},SSS:function(r){return D(r.getMilliseconds(),3)},a:function(r,e){return r.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(r,e){return r.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(r){var e=r.getTimezoneOffset();return(e>0?"-":"+")+D(Math.floor(Math.abs(e)/60)*100+Math.abs(e)%60,4)},Z:function(r){var e=r.getTimezoneOffset();return(e>0?"-":"+")+D(Math.floor(Math.abs(e)/60),2)+":"+D(Math.abs(e)%60,2)}},_t=function(r){return+r-1},rt=[null,_s],se=[null,nu],Ze=["isPm",nu,function(r,e){var t=r.toLowerCase();return t===e.amPm[0]?0:t===e.amPm[1]?1:null}],Sr=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(r){var e=(r+"").match(/([+-]|\d\d)/gi);if(e){var t=+e[1]*60+parseInt(e[2],10);return e[0]==="+"?t:-t}return 0}],jr={D:["day",_s],DD:["day",vs],Do:["day",_s+nu,function(r){return parseInt(r,10)}],M:["month",_s,_t],MM:["month",vs,_t],YY:["year",vs,function(r){var e=new Date,t=+(""+e.getFullYear()).substr(0,2);return+(""+(+r>68?t-1:t)+r)}],h:["hour",_s,void 0,"isPm"],hh:["hour",vs,void 0,"isPm"],H:["hour",_s],HH:["hour",vs],m:["minute",_s],mm:["minute",vs],s:["second",_s],ss:["second",vs],YYYY:["year",rl],S:["millisecond","\\d",function(r){return+r*100}],SS:["millisecond",vs,function(r){return+r*10}],SSS:["millisecond",Ou],d:rt,dd:rt,ddd:se,dddd:se,MMM:["month",nu,Fo("monthNamesShort")],MMMM:["month",nu,Fo("monthNames")],a:Ze,A:Ze,ZZ:Sr,Z:Sr},Vr={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},Ln=function(r){return rs(Vr,r)},Gn=function(r,e,t){if(e===void 0&&(e=Vr.default),t===void 0&&(t={}),typeof r=="number"&&(r=new Date(r)),Object.prototype.toString.call(r)!=="[object Date]"||isNaN(r.getTime()))throw new Error("Invalid Date pass to format");e=Vr[e]||e;var i=[];e=e.replace(dl,function(c,p){return i.push(p),"@@@"});var u=rs(rs({},Xl),t);return e=e.replace(Xu,function(c){return X[c](r,u)}),e.replace(/@@@/g,function(){return i.shift()})};function $i(r,e,t){if(t===void 0&&(t={}),typeof e!="string")throw new Error("Invalid format in fecha parse");if(e=Vr[e]||e,r.length>1e3)return null;var i=new Date,u={year:i.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},c=[],p=[],g=e.replace(dl,function(he,Ne){return p.push(uc(Ne)),"@@@"}),_={},w={};g=uc(g).replace(Xu,function(he){var Ne=jr[he],Er=Ne[0],Fr=Ne[1],zr=Ne[3];if(_[Er])throw new Error("Invalid format. "+Er+" specified twice in format");return _[Er]=!0,zr&&(w[zr]=!0),c.push(Ne),"("+Fr+")"}),Object.keys(w).forEach(function(he){if(!_[he])throw new Error("Invalid format. "+he+" is required in specified format")}),g=g.replace(/@@@/g,function(){return p.shift()});var k=r.match(new RegExp(g,"i"));if(!k)return null;for(var L=rs(rs({},Xl),t),R=1;R<k.length;R++){var U=c[R-1],G=U[0],Q=U[2],pt=Q?Q(k[R],L):+k[R];if(pt==null)return null;u[G]=pt}u.isPm===1&&u.hour!=null&&+u.hour!=12?u.hour=+u.hour+12:u.isPm===0&&+u.hour==12&&(u.hour=0);var vt;if(u.timezoneOffset==null){vt=new Date(u.year,u.month,u.day,u.hour,u.minute,u.second,u.millisecond);for(var Vt=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],R=0,le=Vt.length;R<le;R++)if(_[Vt[R][0]]&&u[Vt[R][0]]!==vt[Vt[R][1]]())return null}else if(vt=new Date(Date.UTC(u.year,u.month,u.day,u.hour,u.minute-u.timezoneOffset,u.second,u.millisecond)),u.month>11||u.month<0||u.day>31||u.day<1||u.hour>23||u.hour<0||u.minute>59||u.minute<0||u.second>59||u.second<0)return null;return vt}var Pa={format:Gn,parse:$i,defaultI18n:sc,setGlobalDateI18n:nl,setGlobalDateMasks:Ln},ba=Pa;function uo(r){return function(e,t,i,u){for(var c=(0,b.UM)(i)?0:i,p=(0,b.UM)(u)?e.length:u;c<p;){var g=c+p>>>1;r(e[g])>t?p=g:c=g+1}return c}}var Ca="format";function Ao(r,e){var t=kt[Ca]||ba[Ca];return t(r,e)}function qa(r){return(0,b.HD)(r)&&(r.indexOf("T")>0?r=new Date(r).getTime():r=new Date(r.replace(/-/gi,"/")).getTime()),(0,b.J_)(r)&&(r=r.getTime()),r}var gs=1e3,xu=60*gs,il=60*xu,bu=24*il,iu=bu*31,Vc=bu*365,$s=[["HH:mm:ss",gs],["HH:mm:ss",gs*10],["HH:mm:ss",gs*30],["HH:mm",xu],["HH:mm",xu*10],["HH:mm",xu*30],["HH",il],["HH",il*6],["HH",il*12],["YYYY-MM-DD",bu],["YYYY-MM-DD",bu*4],["YYYY-WW",bu*7],["YYYY-MM",iu],["YYYY-MM",iu*4],["YYYY-MM",iu*6],["YYYY",bu*380]];function Yl(r,e,t){var i=(e-r)/t,u=uo(function(p){return p[1]})($s,i)-1,c=$s[u];return u<0?c=$s[0]:u>=$s.length&&(c=(0,b.Z$)($s)),c}var me=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="timeCat",t}return e.prototype.translate=function(t){t=qa(t);var i=this.values.indexOf(t);return i===-1&&((0,b.hj)(t)&&t<this.values.length?i=t:i=NaN),i},e.prototype.getText=function(t,i){var u=this.translate(t);if(u>-1){var c=this.values[u],p=this.formatter;return c=p?p(c,i):Ao(c,this.mask),c}return t},e.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},e.prototype.setDomain=function(){var t=this.values;(0,b.S6)(t,function(i,u){t[u]=qa(i)}),t.sort(function(i,u){return i-u}),r.prototype.setDomain.call(this)},e}(Hs),ir=me,Or=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isContinuous=!0,t}return e.prototype.scale=function(t){if((0,b.UM)(t))return NaN;var i=this.rangeMin(),u=this.rangeMax(),c=this.max,p=this.min;if(c===p)return i;var g=this.getScalePercent(t);return i+g*(u-i)},e.prototype.init=function(){r.prototype.init.call(this);var t=this.ticks,i=(0,b.YM)(t),u=(0,b.Z$)(t);i<this.min&&(this.min=i),u>this.max&&(this.max=u),(0,b.UM)(this.minLimit)||(this.min=i),(0,b.UM)(this.maxLimit)||(this.max=u)},e.prototype.setDomain=function(){var t=(0,b.rx)(this.values),i=t.min,u=t.max;(0,b.UM)(this.min)&&(this.min=i),(0,b.UM)(this.max)&&(this.max=u),this.min>this.max&&(this.min=i,this.max=u)},e.prototype.calculateTicks=function(){var t=this,i=r.prototype.calculateTicks.call(this);return this.nice||(i=(0,b.hX)(i,function(u){return u>=t.min&&u<=t.max})),i},e.prototype.getScalePercent=function(t){var i=this.max,u=this.min;return(t-u)/(i-u)},e.prototype.getInvertPercent=function(t){return(t-this.rangeMin())/(this.rangeMax()-this.rangeMin())},e}(Ho),$r=Or,xn=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="linear",t.isLinear=!0,t}return e.prototype.invert=function(t){var i=this.getInvertPercent(t);return this.min+i*(this.max-this.min)},e.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},e}($r),_i=xn;function qi(r,e){var t=Math.E,i;return e>=0?i=Math.pow(t,Math.log(e)/r):i=Math.pow(t,Math.log(-e)/r)*-1,i}function Ia(r,e){return r===1?1:Math.log(e)/Math.log(r)}function du(r,e,t){(0,b.UM)(t)&&(t=Math.max.apply(null,r));var i=t;return(0,b.S6)(r,function(u){u>0&&u<i&&(i=u)}),i===t&&(i=t/e),i>1&&(i=1),i}function qs(r){var e=r.toString().split(/[eE]/),t=(e[0].split(".")[1]||"").length-+(e[1]||0);return t>0?t:0}function $a(r,e){var t=qs(r),i=qs(e),u=Math.pow(10,Math.max(t,i));return(r*u+e*u)/u}var Dl=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="log",t}return e.prototype.invert=function(t){var i=this.base,u=Ia(i,this.max),c=this.rangeMin(),p=this.rangeMax()-c,g,_=this.positiveMin;if(_){if(t===0)return 0;g=Ia(i,_/i);var w=1/(u-g)*p;if(t<w)return t/w*_}else g=Ia(i,this.min);var k=(t-c)/p,L=k*(u-g)+g;return Math.pow(i,L)},e.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},e.prototype.setDomain=function(){r.prototype.setDomain.call(this);var t=this.min;if(t<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");t===0&&(this.positiveMin=du(this.values,this.base,this.max))},e.prototype.getScalePercent=function(t){var i=this.max,u=this.min;if(i===u||t<=0)return 0;var c=this.base,p=this.positiveMin;p&&(u=p*1/c);var g;return t<p?g=t/p/(Ia(c,i)-Ia(c,u)):g=(Ia(c,t)-Ia(c,u))/(Ia(c,i)-Ia(c,u)),g},e}($r),av=Dl,yf=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="pow",t}return e.prototype.invert=function(t){var i=this.getInvertPercent(t),u=this.exponent,c=qi(u,this.max),p=qi(u,this.min),g=i*(c-p)+p,_=g>=0?1:-1;return Math.pow(g,u)*_},e.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},e.prototype.getScalePercent=function(t){var i=this.max,u=this.min;if(i===u)return 0;var c=this.exponent,p=(qi(c,t)-qi(c,u))/(qi(c,i)-qi(c,u));return p},e}($r),vd=yf,ov=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="time",t}return e.prototype.getText=function(t,i){var u=this.translate(t),c=this.formatter;return c?c(u,i):Ao(u,this.mask)},e.prototype.scale=function(t){var i=t;return((0,b.HD)(i)||(0,b.J_)(i))&&(i=this.translate(i)),r.prototype.scale.call(this,i)},e.prototype.translate=function(t){return qa(t)},e.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},e.prototype.setDomain=function(){var t=this.values,i=this.getConfig("min"),u=this.getConfig("max");if((!(0,b.UM)(i)||!(0,b.hj)(i))&&(this.min=this.translate(this.min)),(!(0,b.UM)(u)||!(0,b.hj)(u))&&(this.max=this.translate(this.max)),t&&t.length){var c=[],p=1/0,g=p,_=0;(0,b.S6)(t,function(w){var k=qa(w);if(isNaN(k))throw new TypeError("Invalid Time: "+w+" in time scale!");p>k?(g=p,p=k):g>k&&(g=k),_<k&&(_=k),c.push(k)}),t.length>1&&(this.minTickInterval=g-p),(0,b.UM)(i)&&(this.min=p),(0,b.UM)(u)&&(this.max=_)}},e}(_i),sv=ov,dh=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="quantize",t}return e.prototype.invert=function(t){var i=this.ticks,u=i.length,c=this.getInvertPercent(t),p=Math.floor(c*(u-1));if(p>=u-1)return(0,b.Z$)(i);if(p<0)return(0,b.YM)(i);var g=i[p],_=i[p+1],w=p/(u-1),k=(p+1)/(u-1);return g+(c-w)/(k-w)*(_-g)},e.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},e.prototype.calculateTicks=function(){var t=r.prototype.calculateTicks.call(this);return this.nice||((0,b.Z$)(t)!==this.max&&t.push(this.max),(0,b.YM)(t)!==this.min&&t.unshift(this.min)),t},e.prototype.getScalePercent=function(t){var i=this.ticks;if(t<(0,b.YM)(i))return 0;if(t>(0,b.Z$)(i))return 1;var u=0;return(0,b.S6)(i,function(c,p){if(t>=c)u=p;else return!1}),u/(i.length-1)},e}($r),zf=dh,Gc=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="quantile",t}return e.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},e}(zf),vh=Gc,Uf={};function lc(r){return Uf[r]}function al(r,e){if(lc(r))throw new Error("type '"+r+"' existed.");Uf[r]=e}var _f=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="identity",t.isIdentity=!0,t}return e.prototype.calculateTicks=function(){return this.values},e.prototype.scale=function(t){return this.values[0]!==t&&(0,b.hj)(t)?t:this.range[0]},e.prototype.invert=function(t){var i=this.range;return t<i[0]||t>i[1]?NaN:this.values[0]},e}(Ho),vl=_f;function Eu(r){var e=r.values,t=r.tickInterval,i=r.tickCount,u=r.showLast;if((0,b.hj)(t)){var c=(0,b.hX)(e,function(G,Q){return Q%t===0}),p=(0,b.Z$)(e);return u&&(0,b.Z$)(c)!==p&&c.push(p),c}var g=e.length,_=r.min,w=r.max;if((0,b.UM)(_)&&(_=0),(0,b.UM)(w)&&(w=e.length-1),!(0,b.hj)(i)||i>=g)return e.slice(_,w+1);if(i<=0||w<=0)return[];for(var k=i===1?g:Math.floor(g/(i-1)),L=[],R=_,U=0;U<i&&!(R>=w);U++)R=Math.min(_+U*k,w),U===i-1&&u?L.push(e[w]):L.push(e[R]);return L}function Yh(r){var e=r.min,t=r.max,i=r.nice,u=r.tickCount,c=new qh;return c.domain([e,t]),i&&c.nice(u),c.ticks(u)}var Pp=5,wc=Math.sqrt(50),gl=Math.sqrt(10),$h=Math.sqrt(2),qh=function(){function r(){this._domain=[0,1]}return r.prototype.domain=function(e){return e?(this._domain=Array.from(e,Number),this):this._domain.slice()},r.prototype.nice=function(e){var t,i;e===void 0&&(e=Pp);var u=this._domain.slice(),c=0,p=this._domain.length-1,g=this._domain[c],_=this._domain[p],w;return _<g&&(t=[_,g],g=t[0],_=t[1],i=[p,c],c=i[0],p=i[1]),w=Hc(g,_,e),w>0?(g=Math.floor(g/w)*w,_=Math.ceil(_/w)*w,w=Hc(g,_,e)):w<0&&(g=Math.ceil(g*w)/w,_=Math.floor(_*w)/w,w=Hc(g,_,e)),w>0?(u[c]=Math.floor(g/w)*w,u[p]=Math.ceil(_/w)*w,this.domain(u)):w<0&&(u[c]=Math.ceil(g*w)/w,u[p]=Math.floor(_*w)/w,this.domain(u)),this},r.prototype.ticks=function(e){return e===void 0&&(e=Pp),Op(this._domain[0],this._domain[this._domain.length-1],e||Pp)},r}();function Op(r,e,t){var i,u=-1,c,p,g;if(e=+e,r=+r,t=+t,r===e&&t>0)return[r];if((i=e<r)&&(c=r,r=e,e=c),(g=Hc(r,e,t))===0||!isFinite(g))return[];if(g>0)for(r=Math.ceil(r/g),e=Math.floor(e/g),p=new Array(c=Math.ceil(e-r+1));++u<c;)p[u]=(r+u)*g;else for(r=Math.floor(r*g),e=Math.ceil(e*g),p=new Array(c=Math.ceil(r-e+1));++u<c;)p[u]=(r-u)/g;return i&&p.reverse(),p}function Hc(r,e,t){var i=(e-r)/Math.max(0,t),u=Math.floor(Math.log(i)/Math.LN10),c=i/Math.pow(10,u);return u>=0?(c>=wc?10:c>=gl?5:c>=$h?2:1)*Math.pow(10,u):-Math.pow(10,-u)/(c>=wc?10:c>=gl?5:c>=$h?2:1)}function Kh(r,e,t){var i;return t==="ceil"?i=Math.ceil(r/e):t==="floor"?i=Math.floor(r/e):i=Math.round(r/e),i*e}function $l(r,e,t){var i=Kh(r,t,"floor"),u=Kh(e,t,"ceil");i=(0,b.ri)(i,t),u=(0,b.ri)(u,t);for(var c=[],p=Math.max((u-i)/(Math.pow(2,12)-1),t),g=i;g<=u;g=g+p){var _=(0,b.ri)(g,p);c.push(_)}return{min:i,max:u,ticks:c}}function Qh(r,e,t){var i,u=r.minLimit,c=r.maxLimit,p=r.min,g=r.max,_=r.tickCount,w=_===void 0?5:_,k=(0,b.UM)(u)?(0,b.UM)(e)?p:e:u,L=(0,b.UM)(c)?(0,b.UM)(t)?g:t:c;if(k>L&&(i=[k,L],L=i[0],k=i[1]),w<=2)return[k,L];for(var R=(L-k)/(w-1),U=[],G=0;G<w;G++)U.push(k+R*G);return U}function Zf(r){var e=r.min,t=r.max,i=r.tickInterval,u=r.minLimit,c=r.maxLimit,p=Yh(r);return!(0,b.UM)(u)||!(0,b.UM)(c)?Qh(r,(0,b.YM)(p),(0,b.Z$)(p)):i?$l(e,t,i).ticks:p}function Tl(r){return Math.abs(r)<1e-15?r:parseFloat(r.toFixed(15))}var gd=[1,5,2,2.5,4,3],md=null,yd=Number.EPSILON*100;function gh(r,e){return(r%e+e)%e}function _d(r){return Math.round(r*1e12)/1e12}function xf(r,e,t,i,u,c){var p=(0,b.dp)(e),g=(0,b.cq)(e,r),_=0,w=gh(i,c);return(w<yd||c-w<yd)&&i<=0&&u>=0&&(_=1),1-g/(p-1)-t+_}function xs(r,e,t){var i=(0,b.dp)(e),u=(0,b.cq)(e,r),c=1;return 1-u/(i-1)-t+c}function Jh(r,e,t,i,u,c){var p=(r-1)/(c-u),g=(e-1)/(Math.max(c,i)-Math.min(t,u));return 2-Math.max(p/g,g/p)}function Vf(r,e){return r>=e?2-(r-1)/(e-1):1}function Bl(r,e,t,i){var u=e-r;return 1-.5*(Math.pow(e-i,2)+Math.pow(r-t,2))/Math.pow(.1*u,2)}function go(r,e,t){var i=e-r;if(t>i){var u=(t-i)/2;return 1-Math.pow(u,2)/Math.pow(.1*i,2)}return 1}function is(){return 1}function Yu(r,e,t,i,u,c){t===void 0&&(t=5),i===void 0&&(i=!0),u===void 0&&(u=gd),c===void 0&&(c=[.25,.2,.5,.05]);var p=t<0?0:Math.round(t);if(Number.isNaN(r)||Number.isNaN(e)||typeof r!="number"||typeof e!="number"||!p)return{min:0,max:0,ticks:[]};if(e-r<1e-15||p===1)return{min:r,max:e,ticks:[r]};if(e-r>1e148){var g=t||5,_=(e-r)/g;return{min:r,max:e,ticks:Array(g).fill(null).map(function(Fa,xo){return Tl(r+_*xo)})}}for(var w={score:-2,lmin:0,lmax:0,lstep:0},k=1;k<1/0;){for(var L=0;L<u.length;L+=1){var R=u[L],U=xs(R,u,k);if(c[0]*U+c[1]+c[2]+c[3]<w.score){k=1/0;break}for(var G=2;G<1/0;){var Q=Vf(G,p);if(c[0]*U+c[1]+c[2]*Q+c[3]<w.score)break;for(var pt=(e-r)/(G+1)/k/R,vt=Math.ceil(Math.log10(pt));vt<1/0;){var Vt=k*R*Math.pow(10,vt),le=go(r,e,Vt*(G-1));if(c[0]*U+c[1]*le+c[2]*Q+c[3]<w.score)break;var he=Math.floor(e/Vt)*k-(G-1)*k,Ne=Math.ceil(r/Vt)*k;if(he<=Ne)for(var g=Ne-he,Er=0;Er<=g;Er+=1){var Fr=he+Er,zr=Fr*(Vt/k),pn=zr+Vt*(G-1),nn=Vt,Pn=xf(R,u,k,zr,pn,nn),Si=Bl(r,e,zr,pn),ha=Jh(G,p,r,e,zr,pn),wa=is(),_o=c[0]*Pn+c[1]*Si+c[2]*ha+c[3]*wa;_o>w.score&&(!i||zr<=r&&pn>=e)&&(w.lmin=zr,w.lmax=pn,w.lstep=nn,w.score=_o)}vt+=1}G+=1}}k+=1}var Vn=Tl(w.lmax),Bi=Tl(w.lmin),fa=Tl(w.lstep),Ui=Math.floor(_d((Vn-Bi)/fa))+1,Ji=new Array(Ui);Ji[0]=Tl(Bi);for(var L=1;L<Ui;L++)Ji[L]=Tl(Ji[L-1]+fa);return{min:Math.min(r,(0,b.YM)(Ji)),max:Math.max(e,(0,b.Z$)(Ji)),ticks:Ji}}function Fp(r){var e=r.min,t=r.max,i=r.tickCount,u=r.nice,c=r.tickInterval,p=r.minLimit,g=r.maxLimit,_=Yu(e,t,i,u).ticks;return!(0,b.UM)(p)||!(0,b.UM)(g)?Qh(r,(0,b.YM)(_),(0,b.Z$)(_)):c?$l(e,t,c).ticks:_}function bf(r){var e=r.base,t=r.tickCount,i=r.min,u=r.max,c=r.values,p,g=Ia(e,u);if(i>0)p=Math.floor(Ia(e,i));else{var _=du(c,e,u);p=Math.floor(Ia(e,_))}for(var w=g-p,k=Math.ceil(w/t),L=[],R=p;R<g+k;R=R+k)L.push(Math.pow(e,R));return i<=0&&L.unshift(0),L}function tp(r,e,t){if(t===void 0&&(t=5),r===e)return{max:e,min:r,ticks:[r]};var i=t<0?0:Math.round(t);if(i===0)return{max:e,min:r,ticks:[]};var u=1.5,c=.5+1.5*u,p=e-r,g=p/i,_=Math.pow(10,Math.floor(Math.log10(g))),w=_;2*_-g<u*(g-w)&&(w=2*_,5*_-g<c*(g-w)&&(w=5*_,10*_-g<u*(g-w)&&(w=10*_)));for(var k=Math.ceil(e/w),L=Math.floor(r/w),R=Math.max(k*w,e),U=Math.min(L*w,r),G=Math.floor((R-U)/w)+1,Q=new Array(G),pt=0;pt<G;pt++)Q[pt]=Tl(U+pt*w);return{min:U,max:R,ticks:Q}}function xd(r){var e=r.exponent,t=r.tickCount,i=Math.ceil(qi(e,r.max)),u=Math.floor(qi(e,r.min)),c=tp(u,i,t).ticks;return c.map(function(p){var g=p>=0?1:-1;return Math.pow(p,e)*g})}function ep(r,e){var t=r.length*e;return e===1?r[r.length-1]:e===0?r[0]:t%1!==0?r[Math.ceil(t)-1]:r.length%2===0?(r[t-1]+r[t])/2:r[t]}function Rp(r){var e=r.tickCount,t=r.values;if(!t||!t.length)return[];for(var i=t.slice().sort(function(g,_){return g-_}),u=[],c=0;c<e;c++){var p=c/(e-1);u.push(ep(i,p))}return u}function rp(r){var e=r.min,t=r.max,i=r.tickCount,u=r.tickInterval,c=r.minLimit,p=r.maxLimit,g=tp(e,t,i).ticks;return!(0,b.UM)(c)||!(0,b.UM)(p)?Qh(r,(0,b.YM)(g),(0,b.Z$)(g)):u?$l(e,t,u).ticks:g}function Ef(r){var e=r.min,t=r.max,i=r.minTickInterval,u=r.tickInterval,c=r.tickCount;if(u)c=Math.ceil((t-e)/u);else{u=Yl(e,t,c)[1];var p=(t-e)/u,g=p/c;g>1&&(u=u*Math.ceil(g)),i&&u<i&&(u=i)}u=Math.max(Math.floor((t-e)/(Math.pow(2,12)-1)),u);for(var _=[],w=e;w<t+u;w+=u)_.push(w);return _}function au(r){var e=Eu((0,P.pi)({showLast:!0},r));return e}function Sf(r){return new Date(r).getFullYear()}function np(r){return new Date(r,0,1).getTime()}function As(r){return new Date(r).getMonth()}function Zi(r,e){var t=Sf(r),i=Sf(e),u=As(r),c=As(e);return(i-t)*12+(c-u)%12}function as(r,e){return new Date(r,e,1).getTime()}function wf(r,e){return Math.ceil((e-r)/bu)}function Gf(r,e){return Math.ceil((e-r)/il)}function cc(r,e){return Math.ceil((e-r)/(60*1e3))}function ml(r){var e=r.min,t=r.max,i=r.minTickInterval,u=r.tickCount,c=r.tickInterval,p=[];c||(c=(t-e)/u,i&&c<i&&(c=i)),c=Math.max(Math.floor((t-e)/(Math.pow(2,12)-1)),c);var g=Sf(e);if(c>Vc)for(var _=Sf(t),w=Math.ceil(c/Vc),k=g;k<=_+w;k=k+w)p.push(np(k));else if(c>iu)for(var L=Math.ceil(c/iu),R=As(e),U=Zi(e,t),k=0;k<=U+L;k=k+L)p.push(as(g,k+R));else if(c>bu)for(var G=new Date(e),Q=G.getFullYear(),pt=G.getMonth(),vt=G.getDate(),Vt=Math.ceil(c/bu),le=wf(e,t),k=0;k<le+Vt;k=k+Vt)p.push(new Date(Q,pt,vt+k).getTime());else if(c>il)for(var G=new Date(e),Q=G.getFullYear(),pt=G.getMonth(),Vt=G.getDate(),he=G.getHours(),Ne=Math.ceil(c/il),Er=Gf(e,t),k=0;k<=Er+Ne;k=k+Ne)p.push(new Date(Q,pt,Vt,he+k).getTime());else if(c>xu)for(var Fr=cc(e,t),zr=Math.ceil(c/xu),k=0;k<=Fr+zr;k=k+zr)p.push(e+k*xu);else{var pn=c;pn<gs&&(pn=gs);for(var nn=Math.floor(e/gs)*gs,Pn=Math.ceil((t-e)/gs),Si=Math.ceil(pn/gs),k=0;k<Pn+Si;k=k+Si)p.push(nn+k*gs)}return p.length>=512&&console.warn("Notice: current ticks length("+p.length+') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is '+c+") is too small, increase the value to solve the problem!"),p}Ma("cat",Eu),Ma("time-cat",au),Ma("wilkinson-extended",Fp),Ma("r-pretty",rp),Ma("time",Ef),Ma("time-pretty",ml),Ma("log",bf),Ma("pow",xd),Ma("quantile",Rp),Ma("d3-linear",Zf),al("cat",Hs),al("category",Hs),al("identity",vl),al("linear",_i),al("log",av),al("pow",vd),al("time",sv),al("timeCat",ir),al("quantize",zf),al("quantile",vh);var Dp={},Ai=function(r){return Dp[r.toLowerCase()]},Hf=function(r,e){if(Ai(r))throw new Error("Attribute type '"+r+"' existed.");Dp[r.toLowerCase()]=e};Hf("Color",pu),Hf("Opacity",Rl),Hf("Position",Wu),Hf("Shape",We),Hf("Size",un);var Cc=ot(77160),Cf=ot(35600),ma=ot(31506),yl=function(){function r(e){this.type="coordinate",this.isRect=!1,this.isHelix=!1,this.isPolar=!1,this.isReflectX=!1,this.isReflectY=!1;var t=e.start,i=e.end,u=e.matrix,c=u===void 0?[1,0,0,0,1,0,0,0,1]:u,p=e.isTransposed,g=p===void 0?!1:p;this.start=t,this.end=i,this.matrix=c,this.originalMatrix=(0,P.ev)([],c),this.isTransposed=g}return r.prototype.initial=function(){this.center={x:(this.start.x+this.end.x)/2,y:(this.start.y+this.end.y)/2},this.width=Math.abs(this.end.x-this.start.x),this.height=Math.abs(this.end.y-this.start.y)},r.prototype.update=function(e){(0,b.f0)(this,e),this.initial()},r.prototype.convertDim=function(e,t){var i,u=this[t],c=u.start,p=u.end;return this.isReflect(t)&&(i=[p,c],c=i[0],p=i[1]),c+e*(p-c)},r.prototype.invertDim=function(e,t){var i,u=this[t],c=u.start,p=u.end;return this.isReflect(t)&&(i=[p,c],c=i[0],p=i[1]),(e-c)/(p-c)},r.prototype.applyMatrix=function(e,t,i){i===void 0&&(i=0);var u=this.matrix,c=[e,t,i];return Cc.transformMat3(c,c,u),c},r.prototype.invertMatrix=function(e,t,i){i===void 0&&(i=0);var u=this.matrix,c=Cf.U_([0,0,0,0,0,0,0,0,0],u),p=[e,t,i];return c&&Cc.transformMat3(p,p,c),p},r.prototype.convert=function(e){var t=this.convertPoint(e),i=t.x,u=t.y,c=this.applyMatrix(i,u,1);return{x:c[0],y:c[1]}},r.prototype.invert=function(e){var t=this.invertMatrix(e.x,e.y,1);return this.invertPoint({x:t[0],y:t[1]})},r.prototype.rotate=function(e){var t=this.matrix,i=this.center;return ma.m$(t,t,[-i.x,-i.y]),ma.zu(t,t,e),ma.m$(t,t,[i.x,i.y]),this},r.prototype.reflect=function(e){return e==="x"?this.isReflectX=!this.isReflectX:this.isReflectY=!this.isReflectY,this},r.prototype.scale=function(e,t){var i=this.matrix,u=this.center;return ma.m$(i,i,[-u.x,-u.y]),ma.lh(i,i,[e,t]),ma.m$(i,i,[u.x,u.y]),this},r.prototype.translate=function(e,t){var i=this.matrix;return ma.m$(i,i,[e,t]),this},r.prototype.transpose=function(){return this.isTransposed=!this.isTransposed,this},r.prototype.getCenter=function(){return this.center},r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.getRadius=function(){return this.radius},r.prototype.isReflect=function(e){return e==="x"?this.isReflectX:this.isReflectY},r.prototype.resetMatrix=function(e){this.matrix=e||(0,P.ev)([],this.originalMatrix)},r}(),jf=yl,fc=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.isRect=!0,i.type="cartesian",i.initial(),i}return e.prototype.initial=function(){r.prototype.initial.call(this);var t=this.start,i=this.end;this.x={start:t.x,end:i.x},this.y={start:t.y,end:i.y}},e.prototype.convertPoint=function(t){var i,u=t.x,c=t.y;return this.isTransposed&&(i=[c,u],u=i[0],c=i[1]),{x:this.convertDim(u,"x"),y:this.convertDim(c,"y")}},e.prototype.invertPoint=function(t){var i,u=this.invertDim(t.x,"x"),c=this.invertDim(t.y,"y");return this.isTransposed&&(i=[c,u],u=i[0],c=i[1]),{x:u,y:c}},e}(jf),_l=fc,sa=ot(31437),Bp=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.isHelix=!0,i.type="helix";var u=t.startAngle,c=u===void 0?1.25*Math.PI:u,p=t.endAngle,g=p===void 0?7.25*Math.PI:p,_=t.innerRadius,w=_===void 0?0:_,k=t.radius;return i.startAngle=c,i.endAngle=g,i.innerRadius=w,i.radius=k,i.initial(),i}return e.prototype.initial=function(){r.prototype.initial.call(this);var t=(this.endAngle-this.startAngle)/(2*Math.PI)+1,i=Math.min(this.width,this.height)/2;this.radius&&this.radius>=0&&this.radius<=1&&(i=i*this.radius),this.d=Math.floor(i*(1-this.innerRadius)/t),this.a=this.d/(Math.PI*2),this.x={start:this.startAngle,end:this.endAngle},this.y={start:this.innerRadius*i,end:this.innerRadius*i+this.d*.99}},e.prototype.convertPoint=function(t){var i,u=t.x,c=t.y;this.isTransposed&&(i=[c,u],u=i[0],c=i[1]);var p=this.convertDim(u,"x"),g=this.a*p,_=this.convertDim(c,"y");return{x:this.center.x+Math.cos(p)*(g+_),y:this.center.y+Math.sin(p)*(g+_)}},e.prototype.invertPoint=function(t){var i,u=this.d+this.y.start,c=sa.$X([0,0],[t.x,t.y],[this.center.x,this.center.y]),p=ma.Dg(c,[1,0],!0),g=p*this.a;sa.kE(c)<g&&(g=sa.kE(c));var _=Math.floor((sa.kE(c)-g)/u);p=2*_*Math.PI+p;var w=this.a*p,k=sa.kE(c)-w;k=(0,b.vQ)(k,0)?0:k;var L=this.invertDim(p,"x"),R=this.invertDim(k,"y");return L=(0,b.vQ)(L,0)?0:L,R=(0,b.vQ)(R,0)?0:R,this.isTransposed&&(i=[R,L],L=i[0],R=i[1]),{x:L,y:R}},e}(jf),Np=Bp,bd=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.isPolar=!0,i.type="polar";var u=t.startAngle,c=u===void 0?-Math.PI/2:u,p=t.endAngle,g=p===void 0?Math.PI*3/2:p,_=t.innerRadius,w=_===void 0?0:_,k=t.radius;return i.startAngle=c,i.endAngle=g,i.innerRadius=w,i.radius=k,i.initial(),i}return e.prototype.initial=function(){for(r.prototype.initial.call(this);this.endAngle<this.startAngle;)this.endAngle+=Math.PI*2;var t=this.getOneBox(),i=t.maxX-t.minX,u=t.maxY-t.minY,c=Math.abs(t.minX)/i,p=Math.abs(t.minY)/u,g;this.height/u>this.width/i?(g=this.width/i,this.circleCenter={x:this.center.x-(.5-c)*this.width,y:this.center.y-(.5-p)*g*u}):(g=this.height/u,this.circleCenter={x:this.center.x-(.5-c)*g*i,y:this.center.y-(.5-p)*this.height}),this.polarRadius=this.radius,this.radius?this.radius>0&&this.radius<=1?this.polarRadius=g*this.radius:(this.radius<=0||this.radius>g)&&(this.polarRadius=g):this.polarRadius=g,this.x={start:this.startAngle,end:this.endAngle},this.y={start:this.innerRadius*this.polarRadius,end:this.polarRadius}},e.prototype.getRadius=function(){return this.polarRadius},e.prototype.convertPoint=function(t){var i,u=this.getCenter(),c=t.x,p=t.y;return this.isTransposed&&(i=[p,c],c=i[0],p=i[1]),c=this.convertDim(c,"x"),p=this.convertDim(p,"y"),{x:u.x+Math.cos(c)*p,y:u.y+Math.sin(c)*p}},e.prototype.invertPoint=function(t){var i,u=this.getCenter(),c=[t.x-u.x,t.y-u.y],p=this,g=p.startAngle,_=p.endAngle;this.isReflect("x")&&(i=[_,g],g=i[0],_=i[1]);var w=[1,0,0,0,1,0,0,0,1];ma.zu(w,w,g);var k=[1,0,0];Cc.transformMat3(k,k,w);var L=[k[0],k[1]],R=ma.Dg(L,c,_<g);(0,b.vQ)(R,Math.PI*2)&&(R=0);var U=sa.kE(c),G=R/(_-g);G=_-g>0?G:-G;var Q=this.invertDim(U,"y"),pt={x:0,y:0};return pt.x=this.isTransposed?Q:G,pt.y=this.isTransposed?G:Q,pt},e.prototype.getCenter=function(){return this.circleCenter},e.prototype.getOneBox=function(){var t=this.startAngle,i=this.endAngle;if(Math.abs(i-t)>=Math.PI*2)return{minX:-1,maxX:1,minY:-1,maxY:1};for(var u=[0,Math.cos(t),Math.cos(i)],c=[0,Math.sin(t),Math.sin(i)],p=Math.min(t,i);p<Math.max(t,i);p+=Math.PI/18)u.push(Math.cos(p)),c.push(Math.sin(p));return{minX:Math.min.apply(Math,u),maxX:Math.max.apply(Math,u),minY:Math.min.apply(Math,c),maxY:Math.max.apply(Math,c)}},e}(jf),Ed=bd,Ml={},Ko=function(r){return Ml[r.toLowerCase()]},Ka=function(r,e){Ml[r.toLowerCase()]=e};Ka("rect",_l),Ka("cartesian",_l),Ka("polar",Ed),Ka("helix",Np);function xl(r,e,t){var i=new Me.Event(e,t);i.target=r,i.propagationPath.push(r),r.emitDelegation(e,i);for(var u=r.getParent();u;)u.emitDelegation(e,i),i.propagationPath.push(u),u=u.getParent()}var ql=[1,0,0,0,1,0,0,0,1];function Ts(r,e,t){if(t===void 0&&(t=ql),!e)return null;var i=ma.vs(t,[["t",-r.x,-r.y],["r",e],["t",r.x,r.y]]);return i}function jc(r,e){return!r.x&&!r.y?null:ma.vs(e||ql,[["t",r.x,r.y]])}function Nl(r){var e=[1,0,0],t=[0,0,0];return Cc.transformMat3(t,e,r),Math.atan2(t[1],t[0])}function Su(r,e){var t=[0,0];return sa.kK(t,e,r),t}function wu(r,e){var t=Su(r,[e.minX,e.minY]),i=Su(r,[e.maxX,e.minY]),u=Su(r,[e.minX,e.maxY]),c=Su(r,[e.maxX,e.maxY]),p=Math.min(t[0],i[0],u[0],c[0]),g=Math.max(t[0],i[0],u[0],c[0]),_=Math.min(t[1],i[1],u[1],c[1]),w=Math.max(t[1],i[1],u[1],c[1]);return{x:p,y:_,minX:p,minY:_,maxX:g,maxY:w,width:g-p,height:w-_}}function Il(r,e,t,i){if(e){var u=Ts({x:t,y:i},e,r.getMatrix());r.setMatrix(u)}}function Ki(r,e,t){var i=jc({x:e,y:t});r.attr("matrix",i)}function Wi(r){var e=0,t=0,i=0,u=0;return(0,b.hj)(r)?e=t=i=u=r:(0,b.kJ)(r)&&(e=r[0],i=(0,b.UM)(r[1])?r[0]:r[1],u=(0,b.UM)(r[2])?r[0]:r[2],t=(0,b.UM)(r[3])?i:r[3]),[e,i,u,t]}function Af(r){for(var e=r.childNodes,t=e.length,i=t-1;i>=0;i--)r.removeChild(e[i])}function ol(r,e){return!!r.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function sl(r){var e=r.start,t=r.end,i=Math.min(e.x,t.x),u=Math.min(e.y,t.y),c=Math.max(e.x,t.x),p=Math.max(e.y,t.y);return{x:i,y:u,minX:i,minY:u,maxX:c,maxY:p,width:c-i,height:p-u}}function Ru(r){var e=r.map(function(g){return g.x}),t=r.map(function(g){return g.y}),i=Math.min.apply(Math,e),u=Math.min.apply(Math,t),c=Math.max.apply(Math,e),p=Math.max.apply(Math,t);return{x:i,y:u,minX:i,minY:u,maxX:c,maxY:p,width:c-i,height:p-u}}function bs(r,e,t,i){var u=r+t,c=e+i;return{x:r,y:e,width:t,height:i,minX:r,minY:e,maxX:isNaN(u)?0:u,maxY:isNaN(c)?0:c}}function Ac(r,e,t){return(1-t)*r+e*t}function Tc(r,e,t){return{x:r.x+Math.cos(t)*e,y:r.y+Math.sin(t)*e}}function No(r,e){var t=e.x-r.x,i=e.y-r.y;return Math.sqrt(t*t+i*i)}var os=function(r){return new Promise(function(e){setTimeout(e,r)})},ip=function(r,e,t){return t===void 0&&(t=Math.pow(Number.EPSILON,.5)),[r,e].includes(1/0)?Math.abs(r)===Math.abs(e):Math.abs(r-e)<t};function Wc(r,e){var t=Math.max(r.minX,e.minX),i=Math.max(r.minY,e.minY),u=Math.min(r.maxX,e.maxX),c=Math.min(r.maxY,e.maxY);return bs(t,i,u-t,c-i)}function hc(r,e){var t=Math.min(r.minX,e.minX),i=Math.min(r.minY,e.minY),u=Math.max(r.maxX,e.maxX),c=Math.max(r.maxY,e.maxY);return bs(t,i,u-t,c-i)}function ul(r){var e=r.getClip(),t=e&&e.getBBox(),i;if(!r.isGroup())i=r.getBBox();else{var u=1/0,c=-1/0,p=1/0,g=-1/0,_=r.getChildren();_.length>0?(0,b.S6)(_,function(w){if(w.get("visible")){if(w.isGroup()&&w.get("children").length===0)return!0;var k=ul(w),L=w.applyToMatrix([k.minX,k.minY,1]),R=w.applyToMatrix([k.minX,k.maxY,1]),U=w.applyToMatrix([k.maxX,k.minY,1]),G=w.applyToMatrix([k.maxX,k.maxY,1]),Q=Math.min(L[0],R[0],U[0],G[0]),pt=Math.max(L[0],R[0],U[0],G[0]),vt=Math.min(L[1],R[1],U[1],G[1]),Vt=Math.max(L[1],R[1],U[1],G[1]);Q<u&&(u=Q),pt>c&&(c=pt),vt<p&&(p=vt),Vt>g&&(g=Vt)}}):(u=0,c=0,p=0,g=0),i=bs(u,p,c-u,g-p)}return t?Wc(i,t):i}function Fs(r,e){if(!(!r.getClip()&&!e.getClip())){var t=e.getClip();if(!t){r.setClip(null);return}var i={type:t.get("type"),attrs:t.attr()};r.setClip(i)}}function Ms(r){return r+"px"}function $u(r,e,t,i){var u=No(r,e),c=i/u,p=0;return t==="start"?p=0-c:t==="end"&&(p=1+c),{x:Ac(r.x,e.x,p),y:Ac(r.y,e.y,p)}}var Xc={none:[],point:["x","y"],region:["start","end"],points:["points"],circle:["center","radius","startAngle","endAngle"]},ll=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.initCfg(),i}return e.prototype.getDefaultCfg=function(){return{id:"",name:"",type:"",locationType:"none",offsetX:0,offsetY:0,animate:!1,capture:!0,updateAutoRender:!1,animateOption:{appear:null,update:{duration:400,easing:"easeQuadInOut"},enter:{duration:400,easing:"easeQuadInOut"},leave:{duration:350,easing:"easeQuadIn"}},events:null,defaultCfg:{},visible:!0}},e.prototype.clear=function(){},e.prototype.update=function(t){var i=this,u=this.get("defaultCfg")||{};(0,b.S6)(t,function(c,p){var g=i.get(p),_=c;g!==c&&((0,b.Kn)(c)&&u[p]&&(_=(0,b.b$)({},u[p],c)),i.set(p,_))}),this.updateInner(t),this.afterUpdate(t)},e.prototype.updateInner=function(t){},e.prototype.afterUpdate=function(t){(0,b.wH)(t,"visible")&&(t.visible?this.show():this.hide()),(0,b.wH)(t,"capture")&&this.setCapture(t.capture)},e.prototype.getLayoutBBox=function(){return this.getBBox()},e.prototype.getLocationType=function(){return this.get("locationType")},e.prototype.getOffset=function(){return{offsetX:this.get("offsetX"),offsetY:this.get("offsetY")}},e.prototype.setOffset=function(t,i){this.update({offsetX:t,offsetY:i})},e.prototype.setLocation=function(t){var i=(0,P.pi)({},t);this.update(i)},e.prototype.getLocation=function(){var t=this,i={},u=this.get("locationType"),c=Xc[u];return(0,b.S6)(c,function(p){i[p]=t.get(p)}),i},e.prototype.isList=function(){return!1},e.prototype.isSlider=function(){return!1},e.prototype.init=function(){},e.prototype.initCfg=function(){var t=this,i=this.get("defaultCfg");(0,b.S6)(i,function(u,c){var p=t.get(c);if((0,b.Kn)(p)){var g=(0,b.b$)({},u,p);t.set(c,g)}})},e}(Me.Base),Wf=ll,Mc="update_status",mh=["visible","tip","delegateObject"],Xf=["container","group","shapesMap","isRegister","isUpdating","destroyed"],Sd=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{container:null,shapesMap:{},group:null,capture:!0,isRegister:!1,isUpdating:!1,isInit:!0})},e.prototype.remove=function(){this.clear();var t=this.get("group");t.remove()},e.prototype.clear=function(){var t=this.get("group");t.clear(),this.set("shapesMap",{}),this.clearOffScreenCache(),this.set("isInit",!0)},e.prototype.getChildComponentById=function(t){var i=this.getElementById(t),u=i&&i.get("component");return u},e.prototype.getElementById=function(t){return this.get("shapesMap")[t]},e.prototype.getElementByLocalId=function(t){var i=this.getElementId(t);return this.getElementById(i)},e.prototype.getElementsByName=function(t){var i=[];return(0,b.S6)(this.get("shapesMap"),function(u){u.get("name")===t&&i.push(u)}),i},e.prototype.getContainer=function(){return this.get("container")},e.prototype.updateInner=function(t){this.offScreenRender(),this.get("updateAutoRender")&&this.render()},e.prototype.render=function(){var t=this.get("offScreenGroup");t||(t=this.offScreenRender());var i=this.get("group");this.updateElements(t,i),this.deleteElements(),this.applyOffset(),this.get("eventInitted")||(this.initEvent(),this.set("eventInitted",!0)),this.set("isInit",!1)},e.prototype.show=function(){var t=this.get("group");t.show(),this.set("visible",!0)},e.prototype.hide=function(){var t=this.get("group");t.hide(),this.set("visible",!1)},e.prototype.setCapture=function(t){var i=this.get("group");i.set("capture",t),this.set("capture",t)},e.prototype.destroy=function(){this.removeEvent(),this.remove(),r.prototype.destroy.call(this)},e.prototype.getBBox=function(){return this.get("group").getCanvasBBox()},e.prototype.getLayoutBBox=function(){var t=this.get("group"),i=this.getInnerLayoutBBox(),u=t.getTotalMatrix();return u&&(i=wu(u,i)),i},e.prototype.on=function(t,i,u){var c=this.get("group");return c.on(t,i,u),this},e.prototype.off=function(t,i){var u=this.get("group");return u&&u.off(t,i),this},e.prototype.emit=function(t,i){var u=this.get("group");u.emit(t,i)},e.prototype.init=function(){r.prototype.init.call(this),this.get("group")||this.initGroup(),this.offScreenRender()},e.prototype.getInnerLayoutBBox=function(){return this.get("offScreenBBox")||this.get("group").getBBox()},e.prototype.delegateEmit=function(t,i){var u=this.get("group");i.target=u,u.emit(t,i),xl(u,t,i)},e.prototype.createOffScreenGroup=function(){var t=this.get("group"),i=t.getGroupBase(),u=new i({delegateObject:this.getDelegateObject()});return u},e.prototype.applyOffset=function(){var t=this.get("offsetX"),i=this.get("offsetY");this.moveElementTo(this.get("group"),{x:t,y:i})},e.prototype.initGroup=function(){var t=this.get("container");this.set("group",t.addGroup({id:this.get("id"),name:this.get("name"),capture:this.get("capture"),visible:this.get("visible"),isComponent:!0,component:this,delegateObject:this.getDelegateObject()}))},e.prototype.offScreenRender=function(){this.clearOffScreenCache();var t=this.createOffScreenGroup();return this.renderInner(t),this.set("offScreenGroup",t),this.set("offScreenBBox",ul(t)),t},e.prototype.addGroup=function(t,i){this.appendDelegateObject(t,i);var u=t.addGroup(i);return this.get("isRegister")&&this.registerElement(u),u},e.prototype.addShape=function(t,i){this.appendDelegateObject(t,i);var u=t.addShape(i);return this.get("isRegister")&&this.registerElement(u),u},e.prototype.addComponent=function(t,i){var u=i.id,c=i.component,p=(0,P._T)(i,["id","component"]),g=new c((0,P.pi)((0,P.pi)({},p),{id:u,container:t,updateAutoRender:this.get("updateAutoRender")}));return g.init(),g.render(),this.get("isRegister")&&this.registerElement(g.get("group")),g},e.prototype.initEvent=function(){},e.prototype.removeEvent=function(){var t=this.get("group");t.off()},e.prototype.getElementId=function(t){var i=this.get("id"),u=this.get("name");return i+"-"+u+"-"+t},e.prototype.registerElement=function(t){var i=t.get("id");this.get("shapesMap")[i]=t},e.prototype.unregisterElement=function(t){var i=t.get("id");delete this.get("shapesMap")[i]},e.prototype.moveElementTo=function(t,i){var u=jc(i);t.attr("matrix",u)},e.prototype.addAnimation=function(t,i,u){var c=i.attr("opacity");(0,b.UM)(c)&&(c=1),i.attr("opacity",0),i.animate({opacity:c},u)},e.prototype.removeAnimation=function(t,i,u){i.animate({opacity:0},u)},e.prototype.updateAnimation=function(t,i,u,c){i.animate(u,c)},e.prototype.updateElements=function(t,i){var u=this,c=this.get("animate"),p=this.get("animateOption"),g=t.getChildren().slice(0),_;(0,b.S6)(g,function(w){var k=w.get("id"),L=u.getElementById(k),R=w.get("name");if(L)if(w.get("isComponent")){var U=w.get("component"),G=L.get("component"),Q=(0,b.ei)(U.cfg,(0,b.e5)((0,b.XP)(U.cfg),Xf));G.update(Q),L.set(Mc,"update")}else{var pt=u.getReplaceAttrs(L,w);c&&p.update?u.updateAnimation(R,L,pt,p.update):L.attr(pt),w.isGroup()&&u.updateElements(w,L),(0,b.S6)(mh,function(he){L.set(he,w.get(he))}),Fs(L,w),_=L,L.set(Mc,"update")}else{i.add(w);var vt=i.getChildren();if(vt.splice(vt.length-1,1),_){var Vt=vt.indexOf(_);vt.splice(Vt+1,0,w)}else vt.unshift(w);if(u.registerElement(w),w.set(Mc,"add"),w.get("isComponent")){var U=w.get("component");U.set("container",i)}else w.isGroup()&&u.registerNewGroup(w);if(_=w,c){var le=u.get("isInit")?p.appear:p.enter;le&&u.addAnimation(R,w,le)}}})},e.prototype.clearUpdateStatus=function(t){var i=t.getChildren();(0,b.S6)(i,function(u){u.set(Mc,null)})},e.prototype.clearOffScreenCache=function(){var t=this.get("offScreenGroup");t&&t.destroy(),this.set("offScreenGroup",null),this.set("offScreenBBox",null)},e.prototype.getDelegateObject=function(){var t,i=this.get("name"),u=(t={},t[i]=this,t.component=this,t);return u},e.prototype.appendDelegateObject=function(t,i){var u=t.get("delegateObject");i.delegateObject||(i.delegateObject={}),(0,b.CD)(i.delegateObject,u)},e.prototype.getReplaceAttrs=function(t,i){var u=t.attr(),c=i.attr();return(0,b.S6)(u,function(p,g){c[g]===void 0&&(c[g]=void 0)}),c},e.prototype.registerNewGroup=function(t){var i=this,u=t.getChildren();(0,b.S6)(u,function(c){i.registerElement(c),c.set(Mc,"add"),c.isGroup()&&i.registerNewGroup(c)})},e.prototype.deleteElements=function(){var t=this,i=this.get("shapesMap"),u=[];(0,b.S6)(i,function(g,_){!g.get(Mc)||g.destroyed?u.push([_,g]):g.set(Mc,null)});var c=this.get("animate"),p=this.get("animateOption");(0,b.S6)(u,function(g){var _=g[0],w=g[1];if(!w.destroyed){var k=w.get("name");if(c&&p.leave){var L=(0,b.CD)({callback:function(){t.removeElement(w)}},p.leave);t.removeAnimation(k,w,L)}else t.removeElement(w)}delete i[_]})},e.prototype.removeElement=function(t){if(t.get("isGroup")){var i=t.get("component");i&&i.destroy()}t.remove()},e}(Wf),Rs=Sd,Ic="\u2026";function ap(r){for(var e=0,t=0;t<r.length;t++)e+=bl(r,t);return e}function bl(r,e){return r.charCodeAt(e)>0&&r.charCodeAt(e)<128?1:2}function zl(r,e,t){t===void 0&&(t="tail");var i=r.length,u="";if(t==="tail"){for(var c=0,p=0;c<e;){var g=bl(r,p);if(c+g<=e)u+=r[p],c+=bl(r,p),p++;else break}u+=Ic}else if(t==="head"){for(var c=0,p=i-1;c<e;){var g=bl(r,p);if(c+g<=e)u+=r[p],c+=bl(r,p),p--;else break}u=Ic+u}else{for(var _="",w="",c=0,k=0,L=i-1;c<e;){var R=bl(r,k),U=!1;R+c<=e&&(_+=r[k],k++,c+=R,U=!0);var G=bl(r,L);if(G+c<=e&&(w=r[L]+w,c+=G,L--,U=!0),!U)break}u=_+Ic+w}return u}var op="\u2026",pc=2,zp=400;function Yc(r){for(var e=r.map(function(_){var w=_.attr("text");return(0,b.UM)(w)?"":""+w}),t=0,i=0,u=0;u<e.length;u+=1){for(var c=0,p=0;p<=e[u].length;p+=1){var g=e[u].charCodeAt(p);g>=19968&&g<=40869?c+=2:c+=1}c>t&&(t=c,i=u)}return r[i].getBBox().width}function x(r){if(r.length>zp)return Yc(r);var e=0;return(0,b.S6)(r,function(t){var i=t.getBBox(),u=i.width;e<u&&(e=u)}),e}function C(r,e){var t=e.getCanvasBBox();return r?t.width:t.height}function S(r,e){return r.getBBox().width<e}function M(r,e,t,i){var u;i===void 0&&(i="tail");var c=(u=e.attr("text"))!==null&&u!==void 0?u:"";if(i==="tail"){var p=(0,b.ei)(e.attr(),["fontSize","fontFamily","fontWeight","fontStyle","fontVariant"]),g=(0,b.Lo)(c,t,p,"\u2026");return c!==g?(e.attr("text",g),e.set("tip",c),!0):(e.set("tip",null),!1)}var _=C(r,e),w=ap(c),k=!1;if(t<_){var L=Math.floor(t/_*w)-pc,R=void 0;L>=0?R=zl(c,L,i):R=op,R&&(e.attr("text",R),k=!0)}return k?e.set("tip",c):e.set("tip",null),k}function z(r,e){var t=e.x,i=e.y,u=e.content,c=e.style,p=e.id,g=e.name,_=e.rotate,w=e.maxLength,k=e.autoEllipsis,L=e.isVertical,R=e.ellipsisPosition,U=e.background,G=r.addGroup({id:p+"-group",name:g+"-group",attrs:{x:t,y:i}}),Q=G.addShape({type:"text",id:p,name:g,attrs:(0,P.pi)({x:0,y:0,text:u},c)}),pt=Wi((0,b.U2)(U,"padding",0));if(w&&k){var vt=w-(pt[1]+pt[3]);M(!L,Q,vt,R)}if(U){var Vt=(0,b.U2)(U,"style",{}),le=Q.getCanvasBBox(),he=le.minX,Ne=le.minY,Er=le.width,Fr=le.height,zr=G.addShape("rect",{id:p+"-bg",name:p+"-bg",attrs:(0,P.pi)({x:he-pt[3],y:Ne-pt[0],width:Er+pt[1]+pt[3],height:Fr+pt[0]+pt[2]},Vt)});zr.toBack()}Ki(G,t,i),Il(G,_,t,i)}var H={fontFamily:`
  BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`,textColor:"#2C3542",activeTextColor:"#333333",uncheckedColor:"#D8D8D8",lineColor:"#416180",regionColor:"#CCD7EB",verticalAxisRotate:-Math.PI/4,horizontalAxisRotate:Math.PI/4,descriptionIconStroke:"#fff",descriptionIconFill:"rgba(58, 73, 101, .25)"},$=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"line",locationType:"region",start:null,end:null,style:{},text:null,defaultCfg:{style:{fill:H.textColor,fontSize:12,textAlign:"center",textBaseline:"bottom",fontFamily:H.fontFamily},text:{position:"center",autoRotate:!0,content:null,offsetX:0,offsetY:0,style:{stroke:H.lineColor,lineWidth:1}}}})},e.prototype.renderInner=function(t){this.renderLine(t),this.get("text")&&this.renderLabel(t)},e.prototype.renderLine=function(t){var i=this.get("start"),u=this.get("end"),c=this.get("style");this.addShape(t,{type:"line",id:this.getElementId("line"),name:"annotation-line",attrs:(0,P.pi)({x1:i.x,y1:i.y,x2:u.x,y2:u.y},c)})},e.prototype.getLabelPoint=function(t,i,u){var c;return u==="start"?c=0:u==="center"?c=.5:(0,b.HD)(u)&&u.indexOf("%")!==-1?c=parseInt(u,10)/100:(0,b.hj)(u)?c=u:c=1,(c>1||c<0)&&(c=1),{x:Ac(t.x,i.x,c),y:Ac(t.y,i.y,c)}},e.prototype.renderLabel=function(t){var i=this.get("text"),u=this.get("start"),c=this.get("end"),p=i.position,g=i.content,_=i.style,w=i.offsetX,k=i.offsetY,L=i.autoRotate,R=i.maxLength,U=i.autoEllipsis,G=i.ellipsisPosition,Q=i.background,pt=i.isVertical,vt=pt===void 0?!1:pt,Vt=this.getLabelPoint(u,c,p),le=Vt.x+w,he=Vt.y+k,Ne={id:this.getElementId("line-text"),name:"annotation-line-text",x:le,y:he,content:g,style:_,maxLength:R,autoEllipsis:U,ellipsisPosition:G,background:Q,isVertical:vt};if(L){var Er=[c.x-u.x,c.y-u.y];Ne.rotate=Math.atan2(Er[1],Er[0])}z(t,Ne)},e}(Rs),ft=$,zt=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"text",locationType:"point",x:0,y:0,content:"",rotate:null,style:{},background:null,maxLength:null,autoEllipsis:!0,isVertical:!1,ellipsisPosition:"tail",defaultCfg:{style:{fill:H.textColor,fontSize:12,textAlign:"center",textBaseline:"middle",fontFamily:H.fontFamily}}})},e.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetLocation()},e.prototype.renderInner=function(t){var i=this.getLocation(),u=i.x,c=i.y,p=this.get("content"),g=this.get("style"),_=this.getElementId("text"),w=this.get("name")+"-text",k=this.get("maxLength"),L=this.get("autoEllipsis"),R=this.get("isVertical"),U=this.get("ellipsisPosition"),G=this.get("background"),Q=this.get("rotate"),pt={id:_,name:w,x:u,y:c,content:p,style:g,maxLength:k,autoEllipsis:L,isVertical:R,ellipsisPosition:U,background:G,rotate:Q};z(t,pt)},e.prototype.resetLocation=function(){var t=this.getElementByLocalId("text-group");if(t){var i=this.getLocation(),u=i.x,c=i.y,p=this.get("rotate");Ki(t,u,c),Il(t,p,u,c)}},e}(Rs),ee=zt,Re=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"arc",locationType:"circle",center:null,radius:100,startAngle:-Math.PI/2,endAngle:Math.PI*3/2,style:{stroke:"#999",lineWidth:1}})},e.prototype.renderInner=function(t){this.renderArc(t)},e.prototype.getArcPath=function(){var t=this.getLocation(),i=t.center,u=t.radius,c=t.startAngle,p=t.endAngle,g=Tc(i,u,c),_=Tc(i,u,p),w=p-c>Math.PI?1:0,k=[["M",g.x,g.y]];if(p-c===Math.PI*2){var L=Tc(i,u,c+Math.PI);k.push(["A",u,u,0,w,1,L.x,L.y]),k.push(["A",u,u,0,w,1,_.x,_.y])}else k.push(["A",u,u,0,w,1,_.x,_.y]);return k},e.prototype.renderArc=function(t){var i=this.getArcPath(),u=this.get("style");this.addShape(t,{type:"path",id:this.getElementId("arc"),name:"annotation-arc",attrs:(0,P.pi)({path:i},u)})},e}(Rs),De=Re,ke=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"region",locationType:"region",start:null,end:null,style:{},defaultCfg:{style:{lineWidth:0,fill:H.regionColor,opacity:.4}}})},e.prototype.renderInner=function(t){this.renderRegion(t)},e.prototype.renderRegion=function(t){var i=this.get("start"),u=this.get("end"),c=this.get("style"),p=sl({start:i,end:u});this.addShape(t,{type:"rect",id:this.getElementId("region"),name:"annotation-region",attrs:(0,P.pi)({x:p.x,y:p.y,width:p.width,height:p.height},c)})},e}(Rs),cr=ke,ar=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"image",locationType:"region",start:null,end:null,src:null,style:{}})},e.prototype.renderInner=function(t){this.renderImage(t)},e.prototype.getImageAttrs=function(){var t=this.get("start"),i=this.get("end"),u=this.get("style"),c=sl({start:t,end:i}),p=this.get("src");return(0,P.pi)({x:c.x,y:c.y,img:p,width:c.width,height:c.height},u)},e.prototype.renderImage=function(t){this.addShape(t,{type:"image",id:this.getElementId("image"),name:"annotation-image",attrs:this.getImageAttrs()})},e}(Rs),br=ar,rr=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"dataMarker",locationType:"point",x:0,y:0,point:{},line:{},text:{},direction:"upward",autoAdjust:!0,coordinateBBox:null,defaultCfg:{point:{display:!0,style:{r:3,fill:"#FFFFFF",stroke:"#1890FF",lineWidth:2}},line:{display:!0,length:20,style:{stroke:H.lineColor,lineWidth:1}},text:{content:"",display:!0,style:{fill:H.textColor,opacity:.65,fontSize:12,textAlign:"start",fontFamily:H.fontFamily}}}})},e.prototype.renderInner=function(t){(0,b.U2)(this.get("line"),"display")&&this.renderLine(t),(0,b.U2)(this.get("text"),"display")&&this.renderText(t),(0,b.U2)(this.get("point"),"display")&&this.renderPoint(t),this.get("autoAdjust")&&this.autoAdjust(t)},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x")+this.get("offsetX"),y:this.get("y")+this.get("offsetY")})},e.prototype.renderPoint=function(t){var i=this.getShapeAttrs().point;this.addShape(t,{type:"circle",id:this.getElementId("point"),name:"annotation-point",attrs:i})},e.prototype.renderLine=function(t){var i=this.getShapeAttrs().line;this.addShape(t,{type:"path",id:this.getElementId("line"),name:"annotation-line",attrs:i})},e.prototype.renderText=function(t){var i=this.getShapeAttrs().text,u=i.x,c=i.y,p=i.text,g=(0,P._T)(i,["x","y","text"]),_=this.get("text"),w=_.background,k=_.maxLength,L=_.autoEllipsis,R=_.isVertival,U=_.ellipsisPosition,G={x:u,y:c,id:this.getElementId("text"),name:"annotation-text",content:p,style:g,background:w,maxLength:k,autoEllipsis:L,isVertival:R,ellipsisPosition:U};z(t,G)},e.prototype.autoAdjust=function(t){var i=this.get("direction"),u=this.get("x"),c=this.get("y"),p=(0,b.U2)(this.get("line"),"length",0),g=this.get("coordinateBBox"),_=t.getBBox(),w=_.minX,k=_.maxX,L=_.minY,R=_.maxY,U=t.findById(this.getElementId("text-group")),G=t.findById(this.getElementId("text")),Q=t.findById(this.getElementId("line"));if(!!g){if(U){if(u+w<=g.minX){var pt=g.minX-(u+w);Ki(U,U.attr("x")+pt,U.attr("y"))}if(u+k>=g.maxX){var pt=u+k-g.maxX;Ki(U,U.attr("x")-pt,U.attr("y"))}}if(i==="upward"&&c+L<=g.minY||i!=="upward"&&c+R>=g.maxY){var vt=void 0,Vt=void 0;i==="upward"&&c+L<=g.minY?(vt="top",Vt=1):(vt="bottom",Vt=-1),G.attr("textBaseline",vt),Q&&Q.attr("path",[["M",0,0],["L",0,p*Vt]]),Ki(U,U.attr("x"),(p+2)*Vt)}}},e.prototype.getShapeAttrs=function(){var t=(0,b.U2)(this.get("line"),"display"),i=(0,b.U2)(this.get("point"),"style",{}),u=(0,b.U2)(this.get("line"),"style",{}),c=(0,b.U2)(this.get("text"),"style",{}),p=this.get("direction"),g=t?(0,b.U2)(this.get("line"),"length",0):0,_=p==="upward"?-1:1;return{point:(0,P.pi)({x:0,y:0},i),line:(0,P.pi)({path:[["M",0,0],["L",0,g*_]]},u),text:(0,P.pi)({x:0,y:(g+2)*_,text:(0,b.U2)(this.get("text"),"content",""),textBaseline:p==="upward"?"bottom":"top"},c)}},e}(Rs),xr=rr,Pr=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"dataRegion",locationType:"points",points:[],lineLength:0,region:{},text:{},defaultCfg:{region:{style:{lineWidth:0,fill:H.regionColor,opacity:.4}},text:{content:"",style:{textAlign:"center",textBaseline:"bottom",fontSize:12,fill:H.textColor,fontFamily:H.fontFamily}}}})},e.prototype.renderInner=function(t){var i=(0,b.U2)(this.get("region"),"style",{}),u=(0,b.U2)(this.get("text"),"style",{}),c=this.get("lineLength")||0,p=this.get("points");if(!!p.length){var g=Ru(p),_=[];_.push(["M",p[0].x,g.minY-c]),p.forEach(function(k){_.push(["L",k.x,k.y])}),_.push(["L",p[p.length-1].x,p[p.length-1].y-c]),this.addShape(t,{type:"path",id:this.getElementId("region"),name:"annotation-region",attrs:(0,P.pi)({path:_},i)});var w=(0,P.pi)({id:this.getElementId("text"),name:"annotation-text",x:(g.minX+g.maxX)/2,y:g.minY-c},this.get("text"));z(t,w)}},e}(Rs),Rr=Pr,vn=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"regionFilter",locationType:"region",start:null,end:null,color:null,shape:[]})},e.prototype.renderInner=function(t){var i=this,u=this.get("start"),c=this.get("end"),p=this.addGroup(t,{id:this.getElementId("region-filter"),capture:!1});(0,b.S6)(this.get("shapes"),function(_,w){var k=_.get("type"),L=(0,b.d9)(_.attr());i.adjustShapeAttrs(L),i.addShape(p,{id:i.getElementId("shape-"+k+"-"+w),capture:!1,type:k,attrs:L})});var g=sl({start:u,end:c});p.setClip({type:"rect",attrs:{x:g.minX,y:g.minY,width:g.width,height:g.height}})},e.prototype.adjustShapeAttrs=function(t){var i=this.get("color");t.fill&&(t.fill=t.fillStyle=i),t.stroke=t.strokeStyle=i},e}(Rs),ln=vn,bn=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"shape",draw:b.ZT})},e.prototype.renderInner=function(t){var i=this.get("render");(0,b.mf)(i)&&i(t)},e}(Rs),Zn=bn;function Kn(r,e,t){var i;try{i=window.getComputedStyle?window.getComputedStyle(r,null)[e]:r.style[e]}catch(u){}finally{i=i===void 0?t:i}return i}function ci(r,e){var t=Kn(r,"width",e);return t==="auto"&&(t=r.offsetWidth),parseFloat(t)}function Oi(r,e){var t=ci(r,e),i=parseFloat(Kn(r,"borderLeftWidth"))||0,u=parseFloat(Kn(r,"paddingLeft"))||0,c=parseFloat(Kn(r,"paddingRight"))||0,p=parseFloat(Kn(r,"borderRightWidth"))||0,g=parseFloat(Kn(r,"marginRight"))||0,_=parseFloat(Kn(r,"marginLeft"))||0;return t+i+p+u+c+_+g}function na(r,e){var t=Kn(r,"height",e);return t==="auto"&&(t=r.offsetHeight),parseFloat(t)}function ia(r,e){var t=na(r,e),i=parseFloat(Kn(r,"borderTopWidth"))||0,u=parseFloat(Kn(r,"paddingTop"))||0,c=parseFloat(Kn(r,"paddingBottom"))||0,p=parseFloat(Kn(r,"borderBottomWidth"))||0,g=parseFloat(Kn(r,"marginTop"))||0,_=parseFloat(Kn(r,"marginBottom"))||0;return t+i+p+u+c+g+_}var ua=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{container:null,containerTpl:"<div></div>",updateAutoRender:!0,containerClassName:"",parent:null})},e.prototype.getContainer=function(){return this.get("container")},e.prototype.show=function(){var t=this.get("container");t.style.display="",this.set("visible",!0)},e.prototype.hide=function(){var t=this.get("container");t.style.display="none",this.set("visible",!1)},e.prototype.setCapture=function(t){var i=this.getContainer(),u=t?"auto":"none";i.style.pointerEvents=u,this.set("capture",t)},e.prototype.getBBox=function(){var t=this.getContainer(),i=parseFloat(t.style.left)||0,u=parseFloat(t.style.top)||0;return bs(i,u,t.clientWidth,t.clientHeight)},e.prototype.clear=function(){var t=this.get("container");Af(t)},e.prototype.destroy=function(){this.removeEvent(),this.removeDom(),r.prototype.destroy.call(this)},e.prototype.init=function(){r.prototype.init.call(this),this.initContainer(),this.initDom(),this.resetStyles(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible()},e.prototype.initCapture=function(){this.setCapture(this.get("capture"))},e.prototype.initVisible=function(){this.get("visible")?this.show():this.hide()},e.prototype.initDom=function(){},e.prototype.initContainer=function(){var t=this.get("container");if((0,b.UM)(t)){t=this.createDom();var i=this.get("parent");(0,b.HD)(i)&&(i=document.getElementById(i),this.set("parent",i)),i.appendChild(t),this.get("containerId")&&t.setAttribute("id",this.get("containerId")),this.set("container",t)}else(0,b.HD)(t)&&(t=document.getElementById(t),this.set("container",t));this.get("parent")||this.set("parent",t.parentNode)},e.prototype.resetStyles=function(){var t=this.get("domStyles"),i=this.get("defaultStyles");t?t=(0,b.b$)({},i,t):t=i,this.set("domStyles",t)},e.prototype.applyStyles=function(){var t=this.get("domStyles");if(!!t){var i=this.getContainer();this.applyChildrenStyles(i,t);var u=this.get("containerClassName");if(u&&ol(i,u)){var c=t[u];(0,Y.Z)(i,c)}}},e.prototype.applyChildrenStyles=function(t,i){(0,b.S6)(i,function(u,c){var p=t.getElementsByClassName(c);(0,b.S6)(p,function(g){(0,Y.Z)(g,u)})})},e.prototype.applyStyle=function(t,i){var u=this.get("domStyles");(0,Y.Z)(i,u[t])},e.prototype.createDom=function(){var t=this.get("containerTpl");return(0,Ct.Z)(t)},e.prototype.initEvent=function(){},e.prototype.removeDom=function(){var t=this.get("container");t&&t.parentNode&&t.parentNode.removeChild(t)},e.prototype.removeEvent=function(){},e.prototype.updateInner=function(t){(0,b.wH)(t,"domStyles")&&(this.resetStyles(),this.applyStyles()),this.resetPosition()},e.prototype.resetPosition=function(){},e}(Wf),Qa=ua,Fi=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"html",locationType:"point",x:0,y:0,containerTpl:'<div class="g2-html-annotation" style="position:absolute"></div>',alignX:"left",alignY:"top",html:"",zIndex:7})},e.prototype.render=function(){var t=this.getContainer(),i=this.get("html");Af(t);var u=(0,b.mf)(i)?i(t):i;if((0,b.kK)(u))t.appendChild(u);else if((0,b.HD)(u)||(0,b.hj)(u)){var c=(0,Ct.Z)(""+u);c&&t.appendChild(c)}this.resetPosition()},e.prototype.resetPosition=function(){var t=this.getContainer(),i=this.getLocation(),u=i.x,c=i.y,p=this.get("alignX"),g=this.get("alignY"),_=this.get("offsetX"),w=this.get("offsetY"),k=Oi(t),L=ia(t),R={x:u,y:c};p==="middle"?R.x-=Math.round(k/2):p==="right"&&(R.x-=Math.round(k)),g==="middle"?R.y-=Math.round(L/2):g==="bottom"&&(R.y-=Math.round(L)),_&&(R.x+=_),w&&(R.y+=w),(0,Y.Z)(t,{position:"absolute",left:R.x+"px",top:R.y+"px",zIndex:this.get("zIndex")})},e}(Qa),Ra=Fi;function Aa(r,e,t){var i=e+"Style",u=null;return(0,b.S6)(t,function(c,p){r[p]&&c[i]&&(u||(u={}),(0,b.CD)(u,c[i]))}),u}var ka=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"axis",ticks:[],line:{},tickLine:{},subTickLine:null,title:null,label:{},verticalFactor:1,verticalLimitLength:null,overlapOrder:["autoRotate","autoEllipsis","autoHide"],tickStates:{},optimize:{},defaultCfg:{line:{style:{lineWidth:1,stroke:H.lineColor}},tickLine:{style:{lineWidth:1,stroke:H.lineColor},alignTick:!0,length:5,displayWithLabel:!0},subTickLine:{style:{lineWidth:1,stroke:H.lineColor},count:4,length:2},label:{autoRotate:!0,autoHide:!1,autoEllipsis:!1,style:{fontSize:12,fill:H.textColor,fontFamily:H.fontFamily,fontWeight:"normal"},offset:10,offsetX:0,offsetY:0},title:{autoRotate:!0,spacing:5,position:"center",style:{fontSize:12,fill:H.textColor,textBaseline:"middle",fontFamily:H.fontFamily,textAlign:"center"},iconStyle:{fill:H.descriptionIconFill,stroke:H.descriptionIconStroke},description:""},tickStates:{active:{labelStyle:{fontWeight:500},tickLineStyle:{lineWidth:2}},inactive:{labelStyle:{fill:H.uncheckedColor}}},optimize:{enable:!0,threshold:400}},theme:{}})},e.prototype.renderInner=function(t){this.get("line")&&this.drawLine(t),this.drawTicks(t),this.get("title")&&this.drawTitle(t)},e.prototype.isList=function(){return!0},e.prototype.getItems=function(){return this.get("ticks")},e.prototype.setItems=function(t){this.update({ticks:t})},e.prototype.updateItem=function(t,i){(0,b.CD)(t,i),this.clear(),this.render()},e.prototype.clearItems=function(){var t=this.getElementByLocalId("label-group");t&&t.clear()},e.prototype.setItemState=function(t,i,u){t[i]=u,this.updateTickStates(t)},e.prototype.hasState=function(t,i){return!!t[i]},e.prototype.getItemStates=function(t){var i=this.get("tickStates"),u=[];return(0,b.S6)(i,function(c,p){t[p]&&u.push(p)}),u},e.prototype.clearItemsState=function(t){var i=this,u=this.getItemsByState(t);(0,b.S6)(u,function(c){i.setItemState(c,t,!1)})},e.prototype.getItemsByState=function(t){var i=this,u=this.getItems();return(0,b.hX)(u,function(c){return i.hasState(c,t)})},e.prototype.getSidePoint=function(t,i){var u=this,c=u.getSideVector(i,t);return{x:t.x+c[0],y:t.y+c[1]}},e.prototype.getTextAnchor=function(t){var i;return(0,b.vQ)(t[0],0)?i="center":t[0]>0?i="start":t[0]<0&&(i="end"),i},e.prototype.getTextBaseline=function(t){var i;return(0,b.vQ)(t[1],0)?i="middle":t[1]>0?i="top":t[1]<0&&(i="bottom"),i},e.prototype.processOverlap=function(t){},e.prototype.drawLine=function(t){var i=this.getLinePath(),u=this.get("line");this.addShape(t,{type:"path",id:this.getElementId("line"),name:"axis-line",attrs:(0,b.CD)({path:i},u.style)})},e.prototype.getTickLineItems=function(t){var i=this,u=[],c=this.get("tickLine"),p=c.alignTick,g=c.length,_=1,w=t.length;return w>=2&&(_=t[1].value-t[0].value),(0,b.S6)(t,function(k){var L=k.point;p||(L=i.getTickPoint(k.value-_/2));var R=i.getSidePoint(L,g);u.push({startPoint:L,tickValue:k.value,endPoint:R,tickId:k.id,id:"tickline-"+k.id})}),u},e.prototype.getSubTickLineItems=function(t){var i=[],u=this.get("subTickLine"),c=u.count,p=t.length;if(p>=2)for(var g=0;g<p-1;g++)for(var _=t[g],w=t[g+1],k=0;k<c;k++){var L=(k+1)/(c+1),R=(1-L)*_.tickValue+L*w.tickValue,U=this.getTickPoint(R),G=this.getSidePoint(U,u.length);i.push({startPoint:U,endPoint:G,tickValue:R,id:"sub-"+_.id+"-"+k})}return i},e.prototype.getTickLineAttrs=function(t,i,u,c){var p=this.get(i).style,g={points:[t.startPoint,t.endPoint]},_=(0,b.U2)(this.get("theme"),["tickLine","style"],{});p=(0,b.mf)(p)?(0,b.CD)({},_,p(g,u,c)):p;var w=t.startPoint,k=t.endPoint;return(0,P.pi)({x1:w.x,y1:w.y,x2:k.x,y2:k.y},p)},e.prototype.drawTick=function(t,i,u,c,p){this.addShape(i,{type:"line",id:this.getElementId(t.id),name:"axis-"+u,attrs:this.getTickLineAttrs(t,u,c,p)})},e.prototype.drawTickLines=function(t){var i=this,u=this.get("ticks"),c=this.get("subTickLine"),p=this.getTickLineItems(u),g=this.addGroup(t,{name:"axis-tickline-group",id:this.getElementId("tickline-group")}),_=this.get("tickLine");if((0,b.S6)(p,function(k,L){if(_.displayWithLabel){var R=i.getElementId("label-"+k.tickId);t.findById(R)&&i.drawTick(k,g,"tickLine",L,p)}else i.drawTick(k,g,"tickLine",L,p)}),c){var w=this.getSubTickLineItems(p);(0,b.S6)(w,function(k,L){i.drawTick(k,g,"subTickLine",L,w)})}},e.prototype.processTicks=function(){var t=this,i=this.get("ticks");(0,b.S6)(i,function(u){u.point=t.getTickPoint(u.value),(0,b.UM)(u.id)&&(u.id=u.name)})},e.prototype.drawTicks=function(t){var i=this;this.optimizeTicks(),this.processTicks(),this.get("label")&&this.drawLabels(t),this.get("tickLine")&&this.drawTickLines(t);var u=this.get("ticks");(0,b.S6)(u,function(c){i.applyTickStates(c,t)})},e.prototype.optimizeTicks=function(){var t=this.get("optimize"),i=this.get("ticks");if(t&&t.enable&&t.threshold>0){var u=(0,b.dp)(i);if(u>t.threshold){var c=Math.ceil(u/t.threshold),p=i.filter(function(g,_){return _%c===0});this.set("ticks",p),this.set("originalTicks",i)}}},e.prototype.getLabelAttrs=function(t,i,u){var c=this.get("label"),p=c.offset,g=c.offsetX,_=c.offsetY,w=c.rotate,k=c.formatter,L=this.getSidePoint(t.point,p),R=this.getSideVector(p,L),U=k?k(t.name,t,i):t.name,G=c.style;G=(0,b.mf)(G)?(0,b.U2)(this.get("theme"),["label","style"],{}):G;var Q=(0,b.CD)({x:L.x+g,y:L.y+_,text:U,textAlign:this.getTextAnchor(R),textBaseline:this.getTextBaseline(R)},G);return w&&(Q.matrix=Ts(L,w)),Q},e.prototype.drawLabels=function(t){var i=this,u=this.get("ticks"),c=this.addGroup(t,{name:"axis-label-group",id:this.getElementId("label-group")});(0,b.S6)(u,function(R,U){i.addShape(c,{type:"text",name:"axis-label",id:i.getElementId("label-"+R.id),attrs:i.getLabelAttrs(R,U,u),delegateObject:{tick:R,item:R,index:U}})}),this.processOverlap(c);var p=c.getChildren(),g=(0,b.U2)(this.get("theme"),["label","style"],{}),_=this.get("label"),w=_.style,k=_.formatter;if((0,b.mf)(w)){var L=p.map(function(R){return(0,b.U2)(R.get("delegateObject"),"tick")});(0,b.S6)(p,function(R,U){var G=R.get("delegateObject").tick,Q=k?k(G.name,G,U):G.name,pt=(0,b.CD)({},g,w(Q,U,L));R.attr(pt)})}},e.prototype.getTitleAttrs=function(){var t=this.get("title"),i=t.style,u=t.position,c=t.offset,p=t.spacing,g=p===void 0?0:p,_=t.autoRotate,w=i.fontSize,k=.5;u==="start"?k=0:u==="end"&&(k=1);var L=this.getTickPoint(k),R=this.getSidePoint(L,c||g+w/2),U=(0,b.CD)({x:R.x,y:R.y,text:t.text},i),G=t.rotate,Q=G;if((0,b.UM)(G)&&_){var pt=this.getAxisVector(L),vt=[1,0];Q=ma.Dg(pt,vt,!0)}if(Q){var Vt=Ts(R,Q);U.matrix=Vt}return U},e.prototype.drawTitle=function(t){var i,u=this.getTitleAttrs(),c=this.addShape(t,{type:"text",id:this.getElementId("title"),name:"axis-title",attrs:u});!((i=this.get("title"))===null||i===void 0)&&i.description&&this.drawDescriptionIcon(t,c,u.matrix)},e.prototype.drawDescriptionIcon=function(t,i,u){var c=this.addGroup(t,{name:"axis-description",id:this.getElementById("description")}),p=i.getBBox(),g=p.maxX,_=p.maxY,w=p.height,k=this.get("title").iconStyle,L=4,R=w/2,U=R/6,G=g+L,Q=_-w/2,pt=[G+R,Q-R],vt=pt[0],Vt=pt[1],le=[vt+R,Vt+R],he=le[0],Ne=le[1],Er=[vt,Ne+R],Fr=Er[0],zr=Er[1],pn=[G,Vt+R],nn=pn[0],Pn=pn[1],Si=[G+R,Q-w/4],ha=Si[0],wa=Si[1],_o=[ha,wa+U],Vn=_o[0],Bi=_o[1],fa=[Vn,Bi+U],Ui=fa[0],Ji=fa[1],Fa=[Ui,Ji+R*3/4],xo=Fa[0],Mo=Fa[1];this.addShape(c,{type:"path",id:this.getElementId("title-description-icon"),name:"axis-title-description-icon",attrs:(0,P.pi)({path:[["M",vt,Vt],["A",R,R,0,0,1,he,Ne],["A",R,R,0,0,1,Fr,zr],["A",R,R,0,0,1,nn,Pn],["A",R,R,0,0,1,vt,Vt],["M",ha,wa],["L",Vn,Bi],["M",Ui,Ji],["L",xo,Mo]],lineWidth:U,matrix:u},k)}),this.addShape(c,{type:"rect",id:this.getElementId("title-description-rect"),name:"axis-title-description-rect",attrs:{x:G,y:Q-w/2,width:w,height:w,stroke:"#000",fill:"#000",opacity:0,matrix:u,cursor:"pointer"}})},e.prototype.applyTickStates=function(t,i){var u=this.getItemStates(t);if(u.length){var c=this.get("tickStates"),p=this.getElementId("label-"+t.id),g=i.findById(p);if(g){var _=Aa(t,"label",c);_&&g.attr(_)}var w=this.getElementId("tickline-"+t.id),k=i.findById(w);if(k){var L=Aa(t,"tickLine",c);L&&k.attr(L)}}},e.prototype.updateTickStates=function(t){var i=this.getItemStates(t),u=this.get("tickStates"),c=this.get("label"),p=this.getElementByLocalId("label-"+t.id),g=this.get("tickLine"),_=this.getElementByLocalId("tickline-"+t.id);if(i.length){if(p){var w=Aa(t,"label",u);w&&p.attr(w)}if(_){var k=Aa(t,"tickLine",u);k&&_.attr(k)}}else p&&p.attr(c.style),_&&_.attr(g.style)},e}(Rs),la=ka;function Na(r,e,t,i){var u=e.getChildren(),c=!1;return(0,b.S6)(u,function(p){var g=M(r,p,t,i);c=c||g}),c}function pa(){return Ds}function da(r,e,t){return Na(r,e,t,"head")}function Ds(r,e,t){return Na(r,e,t,"tail")}function ss(r,e,t){return Na(r,e,t,"middle")}function ou(r){var e=r.attr("matrix");return e&&e[0]!==1}function Ks(r){var e=ou(r)?Nl(r.attr("matrix")):0;return e%360}function ls(r,e,t,i){var u=!1,c=Ks(e),p=Math.abs(r?t.attr("y")-e.attr("y"):t.attr("x")-e.attr("x")),g=(r?t.attr("y")>e.attr("y"):t.attr("x")>e.attr("x"))?e.getBBox():t.getBBox();if(r){var _=Math.abs(Math.cos(c));ip(_,0,Math.PI/180)?u=g.width+i>p:u=g.height/_+i>p}else{var _=Math.abs(Math.sin(c));ip(_,0,Math.PI/180)?u=g.width+i>p:u=g.height/_+i>p}return u}function cs(r,e,t,i){var u=(i==null?void 0:i.minGap)||0,c=e.getChildren().slice().filter(function(G){return G.get("visible")});if(!c.length)return!1;var p=!1;t&&c.reverse();for(var g=c.length,_=c[0],w=_,k=1;k<g;k++){var L=c[k],R=L.getBBox(),U=ls(r,w,L,u);U?(L.hide(),p=!0):w=L}return p}function vu(r,e,t){var i=(t==null?void 0:t.minGap)||0,u=e.getChildren().slice();if(u.length<2)return!1;var c=!1,p=u[0],g=p.getBBox(),_=u[1],w=u.length,k=Ks(p),L=Math.abs(r?_.attr("y")-p.attr("y"):_.attr("x")-p.attr("x")),R=0;if(r){var U=Math.abs(Math.cos(k));if(ip(U,0,Math.PI/180)){var G=x(u);R=(G+i)/L}else R=(g.height/U+i)/L}else{var U=Math.abs(Math.sin(k));if(ip(U,0,Math.PI/180)){var G=x(u);R=(G+i)/L}else R=(g.height/U+i)/L}if(R>1){R=Math.ceil(R);for(var Q=0;Q<w;Q++)Q%R!==0&&(u[Q].hide(),c=!0)}return c}function Du(){return cl}function kc(r,e,t,i){return cs(r,e,!1,i)}function qu(r,e,t,i){return cs(r,e,!0,i)}function Kl(r,e,t,i){var u=(i==null?void 0:i.minGap)||0,c=e.getChildren().slice();if(c.length<=2)return!1;for(var p=!1,g=c.length,_=c[0],w=c[g-1],k=_,L=1;L<g-1;L++){var R=c[L],U=R.getBBox(),G=ls(r,k,R,u);G?(R.hide(),p=!0):k=R}var Q=ls(r,k,w,u);return Q&&(k.hide(),p=!0),p}function cl(r,e,t,i){var u=vu(r,e,i);return cs(r,e,!1)&&(u=!0),u}function yh(r,e,t,i){var u=e.getChildren().slice(),c=vu(r,e,i);if(u.length>2){var p=u[0],g=u[u.length-1];p.get("visible")||(p.show(),cs(r,e,!1,i)&&(c=!0)),g.get("visible")||(g.show(),cs(r,e,!0,i)&&(c=!0))}return c}function El(r,e){(0,b.S6)(r,function(t){var i=t.attr("x"),u=t.attr("y"),c=Ts({x:i,y:u},e);t.attr("matrix",c)})}function Ql(r,e,t,i){var u=e.getChildren();if(!u.length||!r&&u.length<2)return!1;var c=x(u),p=!1;if(r)p=!!t&&c>t;else{var g=Math.abs(u[1].attr("x")-u[0].attr("x"));p=c>g}if(p){var _=i(t,c);El(u,_)}return p}function _h(){return Yf}function Yf(r,e,t,i){return Ql(r,e,t,function(){return(0,b.hj)(i)?i:r?H.verticalAxisRotate:H.horizontalAxisRotate})}function dc(r,e,t){return Ql(r,e,t,function(i,u){if(!i)return r?H.verticalAxisRotate:H.horizontalAxisRotate;if(r)return-Math.acos(i/u);var c=0;return i>u?c=Math.PI/4:(c=Math.asin(i/u),c>Math.PI/4&&(c=Math.PI/4)),c})}var xh=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"line",locationType:"region",start:null,end:null})},e.prototype.getLinePath=function(){var t=this.get("start"),i=this.get("end"),u=[];return u.push(["M",t.x,t.y]),u.push(["L",i.x,i.y]),u},e.prototype.getInnerLayoutBBox=function(){var t=this.get("start"),i=this.get("end"),u=r.prototype.getInnerLayoutBBox.call(this),c=Math.min(t.x,i.x,u.x),p=Math.min(t.y,i.y,u.y),g=Math.max(t.x,i.x,u.maxX),_=Math.max(t.y,i.y,u.maxY);return{x:c,y:p,minX:c,minY:p,maxX:g,maxY:_,width:g-c,height:_-p}},e.prototype.isVertical=function(){var t=this.get("start"),i=this.get("end");return(0,b.vQ)(t.x,i.x)},e.prototype.isHorizontal=function(){var t=this.get("start"),i=this.get("end");return(0,b.vQ)(t.y,i.y)},e.prototype.getTickPoint=function(t){var i=this,u=i.get("start"),c=i.get("end"),p=c.x-u.x,g=c.y-u.y;return{x:u.x+p*t,y:u.y+g*t}},e.prototype.getSideVector=function(t){var i=this.getAxisVector(),u=sa.Fv([0,0],i),c=this.get("verticalFactor"),p=[u[1],u[0]*-1];return sa.bA([0,0],p,t*c)},e.prototype.getAxisVector=function(){var t=this.get("start"),i=this.get("end");return[i.x-t.x,i.y-t.y]},e.prototype.processOverlap=function(t){var i=this,u=this.isVertical(),c=this.isHorizontal();if(!(!u&&!c)){var p=this.get("label"),g=this.get("title"),_=this.get("verticalLimitLength"),w=p.offset,k=_,L=0,R=0;g&&(L=g.style.fontSize,R=g.spacing),k&&(k=k-w-R-L);var U=this.get("overlapOrder");if((0,b.S6)(U,function(pt){p[pt]&&i.canProcessOverlap(pt)&&i.autoProcessOverlap(pt,p[pt],t,k)}),g&&(0,b.UM)(g.offset)){var G=t.getCanvasBBox(),Q=u?G.width:G.height;g.offset=w+Q+R+L/2}}},e.prototype.canProcessOverlap=function(t){var i=this.get("label");return t==="autoRotate"?(0,b.UM)(i.rotate):!0},e.prototype.autoProcessOverlap=function(t,i,u,c){var p=this,g=this.isVertical(),_=!1,w=ut[t];if(i===!0){var k=this.get("label");_=w.getDefault()(g,u,c)}else if((0,b.mf)(i))_=i(g,u,c);else if((0,b.Kn)(i)){var L=i;w[L.type]&&(_=w[L.type](g,u,c,L.cfg))}else w[i]&&(_=w[i](g,u,c));if(t==="autoRotate"){if(_){var R=u.getChildren(),U=this.get("verticalFactor");(0,b.S6)(R,function(Q){var pt=Q.attr("textAlign");if(pt==="center"){var vt=U>0?"end":"start";Q.attr("textAlign",vt)}})}}else if(t==="autoHide"){var G=u.getChildren().slice(0);(0,b.S6)(G,function(Q){Q.get("visible")||(p.get("isRegister")&&p.unregisterElement(Q),Q.remove())})}},e}(la),Jl=xh,js=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"circle",locationType:"circle",center:null,radius:null,startAngle:-Math.PI/2,endAngle:Math.PI*3/2})},e.prototype.getLinePath=function(){var t=this.get("center"),i=t.x,u=t.y,c=this.get("radius"),p=c,g=this.get("startAngle"),_=this.get("endAngle"),w=[];if(Math.abs(_-g)===Math.PI*2)w=[["M",i,u-p],["A",c,p,0,1,1,i,u+p],["A",c,p,0,1,1,i,u-p],["Z"]];else{var k=this.getCirclePoint(g),L=this.getCirclePoint(_),R=Math.abs(_-g)>Math.PI?1:0,U=g>_?0:1;w=[["M",i,u],["L",k.x,k.y],["A",c,p,0,R,U,L.x,L.y],["L",i,u]]}return w},e.prototype.getTickPoint=function(t){var i=this.get("startAngle"),u=this.get("endAngle"),c=i+(u-i)*t;return this.getCirclePoint(c)},e.prototype.getSideVector=function(t,i){var u=this.get("center"),c=[i.x-u.x,i.y-u.y],p=this.get("verticalFactor"),g=sa.kE(c);return sa.bA(c,c,p*t/g),c},e.prototype.getAxisVector=function(t){var i=this.get("center"),u=[t.x-i.x,t.y-i.y];return[u[1],-1*u[0]]},e.prototype.getCirclePoint=function(t,i){var u=this.get("center");return i=i||this.get("radius"),{x:u.x+Math.cos(t)*i,y:u.y+Math.sin(t)*i}},e.prototype.canProcessOverlap=function(t){var i=this.get("label");return t==="autoRotate"?(0,b.UM)(i.rotate):!0},e.prototype.processOverlap=function(t){var i=this,u=this.get("label"),c=this.get("title"),p=this.get("verticalLimitLength"),g=u.offset,_=p,w=0,k=0;c&&(w=c.style.fontSize,k=c.spacing),_&&(_=_-g-k-w);var L=this.get("overlapOrder");if((0,b.S6)(L,function(U){u[U]&&i.canProcessOverlap(U)&&i.autoProcessOverlap(U,u[U],t,_)}),c&&(0,b.UM)(c.offset)){var R=t.getCanvasBBox().height;c.offset=g+R+k+w/2}},e.prototype.autoProcessOverlap=function(t,i,u,c){var p=this,g=!1,_=ut[t];if(c>0)if(i===!0)g=_.getDefault()(!1,u,c);else if((0,b.mf)(i))g=i(!1,u,c);else if((0,b.Kn)(i)){var w=i;_[w.type]&&(g=_[w.type](!1,u,c,w.cfg))}else _[i]&&(g=_[i](!1,u,c));if(t==="autoRotate"){if(g){var k=u.getChildren(),L=this.get("verticalFactor");(0,b.S6)(k,function(U){var G=U.attr("textAlign");if(G==="center"){var Q=L>0?"end":"start";U.attr("textAlign",Q)}})}}else if(t==="autoHide"){var R=u.getChildren().slice(0);(0,b.S6)(R,function(U){U.get("visible")||(p.get("isRegister")&&p.unregisterElement(U),U.remove())})}},e}(la),$c=js,Tf=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"crosshair",type:"base",line:{},text:null,textBackground:{},capture:!1,defaultCfg:{line:{style:{lineWidth:1,stroke:H.lineColor}},text:{position:"start",offset:10,autoRotate:!1,content:null,style:{fill:H.textColor,textAlign:"center",textBaseline:"middle",fontFamily:H.fontFamily}},textBackground:{padding:5,style:{stroke:H.lineColor}}}})},e.prototype.renderInner=function(t){this.get("line")&&this.renderLine(t),this.get("text")&&(this.renderText(t),this.renderBackground(t))},e.prototype.renderText=function(t){var i=this.get("text"),u=i.style,c=i.autoRotate,p=i.content;if(!(0,b.UM)(p)){var g=this.getTextPoint(),_=null;if(c){var w=this.getRotateAngle();_=Ts(g,w)}this.addShape(t,{type:"text",name:"crosshair-text",id:this.getElementId("text"),attrs:(0,P.pi)((0,P.pi)((0,P.pi)({},g),{text:p,matrix:_}),u)})}},e.prototype.renderLine=function(t){var i=this.getLinePath(),u=this.get("line"),c=u.style;this.addShape(t,{type:"path",name:"crosshair-line",id:this.getElementId("line"),attrs:(0,P.pi)({path:i},c)})},e.prototype.renderBackground=function(t){var i=this.getElementId("text"),u=t.findById(i),c=this.get("textBackground");if(c&&u){var p=u.getBBox(),g=Wi(c.padding),_=c.style,w=this.addShape(t,{type:"rect",name:"crosshair-text-background",id:this.getElementId("text-background"),attrs:(0,P.pi)({x:p.x-g[3],y:p.y-g[0],width:p.width+g[1]+g[3],height:p.height+g[0]+g[2],matrix:u.attr("matrix")},_)});w.toBack()}},e}(Rs),vc=Tf,Lo=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"line",locationType:"region",start:null,end:null})},e.prototype.getRotateAngle=function(){var t=this.getLocation(),i=t.start,u=t.end,c=this.get("text").position,p=Math.atan2(u.y-i.y,u.x-i.x),g=c==="start"?p-Math.PI/2:p+Math.PI/2;return g},e.prototype.getTextPoint=function(){var t=this.getLocation(),i=t.start,u=t.end,c=this.get("text"),p=c.position,g=c.offset;return $u(i,u,p,g)},e.prototype.getLinePath=function(){var t=this.getLocation(),i=t.start,u=t.end;return[["M",i.x,i.y],["L",u.x,u.y]]},e}(vc),Sl=Lo,Ku=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"circle",locationType:"circle",center:null,radius:100,startAngle:-Math.PI/2,endAngle:Math.PI*3/2})},e.prototype.getRotateAngle=function(){var t=this.getLocation(),i=t.startAngle,u=t.endAngle,c=this.get("text").position,p=c==="start"?i+Math.PI/2:u-Math.PI/2;return p},e.prototype.getTextPoint=function(){var t=this.get("text"),i=t.position,u=t.offset,c=this.getLocation(),p=c.center,g=c.radius,_=c.startAngle,w=c.endAngle,k=i==="start"?_:w,L=this.getRotateAngle()-Math.PI,R=Tc(p,g,k),U=Math.cos(L)*u,G=Math.sin(L)*u;return{x:R.x+U,y:R.y+G}},e.prototype.getLinePath=function(){var t=this.getLocation(),i=t.center,u=t.radius,c=t.startAngle,p=t.endAngle,g=null;if(p-c===Math.PI*2){var _=i.x,w=i.y;g=[["M",_,w-u],["A",u,u,0,1,1,_,w+u],["A",u,u,0,1,1,_,w-u],["Z"]]}else{var k=Tc(i,u,c),L=Tc(i,u,p),R=Math.abs(p-c)>Math.PI?1:0,U=c>p?0:1;g=[["M",k.x,k.y],["A",u,u,0,R,U,L.x,L.y]]}return g},e}(vc),qc=Ku,Kc="g2-crosshair",$f=Kc+"-line",Qc=Kc+"-text",Bu,bh=(Bu={},Bu[""+Kc]={position:"relative"},Bu[""+$f]={position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.25)"},Bu[""+Qc]={position:"absolute",color:H.textColor,fontFamily:H.fontFamily},Bu),tc=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"crosshair",type:"html",locationType:"region",start:{x:0,y:0},end:{x:0,y:0},capture:!1,text:null,containerTpl:'<div class="'+Kc+'"></div>',crosshairTpl:'<div class="'+$f+'"></div>',textTpl:'<span class="'+Qc+'">{content}</span>',domStyles:null,containerClassName:Kc,defaultStyles:bh,defaultCfg:{text:{position:"start",content:null,align:"center",offset:10}}})},e.prototype.render=function(){this.resetText(),this.resetPosition()},e.prototype.initCrossHair=function(){var t=this.getContainer(),i=this.get("crosshairTpl"),u=(0,Ct.Z)(i);t.appendChild(u),this.applyStyle($f,u),this.set("crosshairEl",u)},e.prototype.getTextPoint=function(){var t=this.getLocation(),i=t.start,u=t.end,c=this.get("text"),p=c.position,g=c.offset;return $u(i,u,p,g)},e.prototype.resetText=function(){var t=this.get("text"),i=this.get("textEl");if(t){var u=t.content;if(!i){var c=this.getContainer(),p=(0,b.ng)(this.get("textTpl"),t);i=(0,Ct.Z)(p),c.appendChild(i),this.applyStyle(Qc,i),this.set("textEl",i)}i.innerHTML=u}else i&&i.remove()},e.prototype.isVertical=function(t,i){return t.x===i.x},e.prototype.resetPosition=function(){var t=this.get("crosshairEl");t||(this.initCrossHair(),t=this.get("crosshairEl"));var i=this.get("start"),u=this.get("end"),c=Math.min(i.x,u.x),p=Math.min(i.y,u.y);this.isVertical(i,u)?(0,Y.Z)(t,{width:"1px",height:Ms(Math.abs(u.y-i.y))}):(0,Y.Z)(t,{height:"1px",width:Ms(Math.abs(u.x-i.x))}),(0,Y.Z)(t,{top:Ms(p),left:Ms(c)}),this.alignText()},e.prototype.alignText=function(){var t=this.get("textEl");if(t){var i=this.get("text").align,u=t.clientWidth,c=this.getTextPoint();switch(i){case"center":c.x=c.x-u/2;break;case"right":c.x=c.x-u;case"left":break}(0,Y.Z)(t,{top:Ms(c.y),left:Ms(c.x)})}},e.prototype.updateInner=function(t){(0,b.wH)(t,"text")&&this.resetText(),r.prototype.updateInner.call(this,t)},e}(Qa),Jc=tc,Eh=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"grid",line:{},alternateColor:null,capture:!1,items:[],closed:!1,defaultCfg:{line:{type:"line",style:{lineWidth:1,stroke:H.lineColor}}}})},e.prototype.getLineType=function(){var t=this.get("line")||this.get("defaultCfg").line;return t.type},e.prototype.renderInner=function(t){this.drawGrid(t)},e.prototype.getAlternatePath=function(t,i){var u=this.getGridPath(t),c=i.slice(0).reverse(),p=this.getGridPath(c,!0),g=this.get("closed");return g?u=u.concat(p):(p[0][0]="L",u=u.concat(p),u.push(["Z"])),u},e.prototype.getPathStyle=function(){return this.get("line").style},e.prototype.drawGrid=function(t){var i=this,u=this.get("line"),c=this.get("items"),p=this.get("alternateColor"),g=null;(0,b.S6)(c,function(_,w){var k=_.id||w;if(u){var L=i.getPathStyle();L=(0,b.mf)(L)?L(_,w,c):L;var R=i.getElementId("line-"+k),U=i.getGridPath(_.points);i.addShape(t,{type:"path",name:"grid-line",id:R,attrs:(0,b.CD)({path:U},L)})}if(p&&w>0){var G=i.getElementId("region-"+k),Q=w%2===0;if((0,b.HD)(p))Q&&i.drawAlternateRegion(G,t,g.points,_.points,p);else{var pt=Q?p[1]:p[0];i.drawAlternateRegion(G,t,g.points,_.points,pt)}}g=_})},e.prototype.drawAlternateRegion=function(t,i,u,c,p){var g=this.getAlternatePath(u,c);this.addShape(i,{type:"path",id:t,name:"grid-region",attrs:{path:g,fill:p}})},e}(Rs),kl=Eh;function Cu(r,e,t,i){var u=t-r,c=i-e;return Math.sqrt(u*u+c*c)}var sp=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"circle",center:null,closed:!0})},e.prototype.getGridPath=function(t,i){var u=this.getLineType(),c=this.get("closed"),p=[];if(t.length)if(u==="circle"){var g=this.get("center"),_=t[0],w=Cu(g.x,g.y,_.x,_.y),k=i?0:1;c?(p.push(["M",g.x,g.y-w]),p.push(["A",w,w,0,0,k,g.x,g.y+w]),p.push(["A",w,w,0,0,k,g.x,g.y-w]),p.push(["Z"])):(0,b.S6)(t,function(L,R){R===0?p.push(["M",L.x,L.y]):p.push(["A",w,w,0,0,k,L.x,L.y])})}else(0,b.S6)(t,function(L,R){R===0?p.push(["M",L.x,L.y]):p.push(["L",L.x,L.y])}),c&&p.push(["Z"]);return p},e}(kl),wd=sp,uv=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"line"})},e.prototype.getGridPath=function(t){var i=[];return(0,b.S6)(t,function(u,c){c===0?i.push(["M",u.x,u.y]):i.push(["L",u.x,u.y])}),i},e}(kl),lv=uv,G0=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"legend",layout:"horizontal",locationType:"point",x:0,y:0,offsetX:0,offsetY:0,title:null,background:null})},e.prototype.getLayoutBBox=function(){var t=r.prototype.getLayoutBBox.call(this),i=this.get("maxWidth"),u=this.get("maxHeight"),c=t.width,p=t.height;return i&&(c=Math.min(c,i)),u&&(p=Math.min(p,u)),bs(t.minX,t.minY,c,p)},e.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetLocation()},e.prototype.resetLocation=function(){var t=this.get("x"),i=this.get("y"),u=this.get("offsetX"),c=this.get("offsetY");this.moveElementTo(this.get("group"),{x:t+u,y:i+c})},e.prototype.applyOffset=function(){this.resetLocation()},e.prototype.getDrawPoint=function(){return this.get("currentPoint")},e.prototype.setDrawPoint=function(t){return this.set("currentPoint",t)},e.prototype.renderInner=function(t){this.resetDraw(),this.get("title")&&this.drawTitle(t),this.drawLegendContent(t),this.get("background")&&this.drawBackground(t)},e.prototype.drawBackground=function(t){var i=this.get("background"),u=t.getBBox(),c=Wi(i.padding),p=(0,P.pi)({x:0,y:0,width:u.width+c[1]+c[3],height:u.height+c[0]+c[2]},i.style),g=this.addShape(t,{type:"rect",id:this.getElementId("background"),name:"legend-background",attrs:p});g.toBack()},e.prototype.drawTitle=function(t){var i=this.get("currentPoint"),u=this.get("title"),c=u.spacing,p=u.style,g=u.text,_=this.addShape(t,{type:"text",id:this.getElementId("title"),name:"legend-title",attrs:(0,P.pi)({text:g,x:i.x,y:i.y},p)}),w=_.getBBox();this.set("currentPoint",{x:i.x,y:w.maxY+c})},e.prototype.resetDraw=function(){var t=this.get("background"),i={x:0,y:0};if(t){var u=Wi(t.padding);i.x=u[3],i.y=u[0]}this.set("currentPoint",i)},e}(Rs),Up=G0,Lc={marker:{style:{inactiveFill:"#000",inactiveOpacity:.45,fill:"#000",opacity:1,size:12}},text:{style:{fill:"#ccc",fontSize:12}}},tf={fill:H.textColor,fontSize:12,textAlign:"start",textBaseline:"middle",fontFamily:H.fontFamily,fontWeight:"normal",lineHeight:12},Sh="navigation-arrow-right",cv="navigation-arrow-left",wl={right:90*Math.PI/180,left:(360-90)*Math.PI/180,up:0,down:180*Math.PI/180},ei=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.currentPageIndex=1,t.totalPagesCnt=1,t.pageWidth=0,t.pageHeight=0,t.startX=0,t.startY=0,t.onNavigationBack=function(){var i=t.getElementByLocalId("item-group");if(t.currentPageIndex>1){t.currentPageIndex-=1,t.updateNavigation();var u=t.getCurrentNavigationMatrix();t.get("animate")?i.animate({matrix:u},100):i.attr({matrix:u})}},t.onNavigationAfter=function(){var i=t.getElementByLocalId("item-group");if(t.currentPageIndex<t.totalPagesCnt){t.currentPageIndex+=1,t.updateNavigation();var u=t.getCurrentNavigationMatrix();t.get("animate")?i.animate({matrix:u},100):i.attr({matrix:u})}},t}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"legend",type:"category",itemSpacing:24,itemMarginBottom:8,maxItemWidth:null,itemWidth:null,itemHeight:null,itemName:{},itemValue:null,maxWidth:null,maxHeight:null,marker:{},radio:null,items:[],itemStates:{},itemBackground:{},pageNavigator:{},defaultCfg:{title:{spacing:5,style:{fill:H.textColor,fontSize:12,textAlign:"start",textBaseline:"top"}},background:{padding:5,style:{stroke:H.lineColor}},itemBackground:{style:{opacity:0,fill:"#fff"}},pageNavigator:Lc,itemName:{spacing:16,style:tf},marker:{spacing:8,style:{r:6,symbol:"circle"}},itemValue:{alignRight:!1,formatter:null,style:tf,spacing:6},itemStates:{active:{nameStyle:{opacity:.8}},unchecked:{nameStyle:{fill:H.uncheckedColor},markerStyle:{fill:H.uncheckedColor,stroke:H.uncheckedColor}},inactive:{nameStyle:{fill:H.uncheckedColor},markerStyle:{opacity:.2}}}}})},e.prototype.isList=function(){return!0},e.prototype.getItems=function(){return this.get("items")},e.prototype.setItems=function(t){this.update({items:t})},e.prototype.updateItem=function(t,i){(0,b.CD)(t,i),this.clear(),this.render()},e.prototype.clearItems=function(){var t=this.getElementByLocalId("item-group");t&&t.clear()},e.prototype.setItemState=function(t,i,u){t[i]=u;var c=this.getElementByLocalId("item-"+t.id);if(c){var p=this.getItems(),g=p.indexOf(t),_=this.createOffScreenGroup(),w=this.drawItem(t,g,this.getItemHeight(),_);this.updateElements(w,c),this.clearUpdateStatus(c)}},e.prototype.hasState=function(t,i){return!!t[i]},e.prototype.getItemStates=function(t){var i=this.get("itemStates"),u=[];return(0,b.S6)(i,function(c,p){t[p]&&u.push(p)}),u},e.prototype.clearItemsState=function(t){var i=this,u=this.getItemsByState(t);(0,b.S6)(u,function(c){i.setItemState(c,t,!1)})},e.prototype.getItemsByState=function(t){var i=this,u=this.getItems();return(0,b.hX)(u,function(c){return i.hasState(c,t)})},e.prototype.drawLegendContent=function(t){this.processItems(),this.drawItems(t)},e.prototype.processItems=function(){var t=this.get("items");(0,b.S6)(t,function(i){i.id||(i.id=i.name)})},e.prototype.drawItems=function(t){var i=this,u=this.addGroup(t,{id:this.getElementId("item-container-group"),name:"legend-item-container-group"}),c=this.addGroup(u,{id:this.getElementId("item-group"),name:"legend-item-group"}),p=this.getItemHeight(),g=this.get("itemWidth"),_=this.get("itemSpacing"),w=this.get("itemMarginBottom"),k=this.get("currentPoint"),L=k.x,R=k.y,U=this.get("layout"),G=this.get("items"),Q=!1,pt=0,vt=this.get("maxWidth"),Vt=this.get("maxHeight");(0,b.S6)(G,function(le,he){var Ne=i.drawItem(le,he,p,c),Er=Ne.getBBox(),Fr=g||Er.width;Fr>pt&&(pt=Fr),U==="horizontal"?(vt&&vt<k.x+Fr-L&&(Q=!0,k.x=L,k.y+=p+w),i.moveElementTo(Ne,k),k.x+=Fr+_):(Vt&&Vt<k.y+p+w-R&&(Q=!0,k.x+=pt+_,k.y=R,pt=0),i.moveElementTo(Ne,k),k.y+=p+w)}),Q&&this.get("flipPage")&&(this.pageHeight=0,this.pageWidth=0,this.totalPagesCnt=1,this.startX=L,this.startY=R,this.adjustNavigation(t,c))},e.prototype.getItemHeight=function(){var t=this.get("itemHeight");if(!t){var i=(this.get("itemName")||{}).style;if((0,b.mf)(i)){var u=this.getItems();u.forEach(function(c,p){var g=(0,P.pi)((0,P.pi)({},tf),i(c,p,u)).fontSize;t<g&&(t=g)})}else i&&(t=i.fontSize)}return t},e.prototype.drawMarker=function(t,i,u,c){var p=(0,P.pi)((0,P.pi)((0,P.pi)({x:0,y:c/2},i.style),{symbol:(0,b.U2)(u.marker,"symbol","circle")}),(0,b.U2)(u.marker,"style",{})),g=this.addShape(t,{type:"marker",id:this.getElementId("item-"+u.id+"-marker"),name:"legend-item-marker",attrs:p}),_=g.getBBox();g.attr("x",_.width/2);var w=g.attr(),k=w.stroke,L=w.fill;return k&&g.set("isStroke",!0),L&&g.set("isFill",!0),g},e.prototype.drawItemText=function(t,i,u,c,p,g,_){var w=u.formatter,k=u.style,L=(0,P.pi)((0,P.pi)({x:g,y:p/2,text:w?w(c[i],c,_):c[i]},tf),(0,b.mf)(k)?k(c,_,this.getItems()):k);return this.addShape(t,{type:"text",id:this.getElementId("item-"+c.id+"-"+i),name:"legend-item-"+i,attrs:L})},e.prototype.drawRadio=function(t,i,u,c,p){var g,_,w=i.style||{},k=(g=w.r)!==null&&g!==void 0?g:c/2,L=k*3.6/8,R=[p+k,c/2-k],U=R[0],G=R[1],Q=[U+k,G+k],pt=Q[0],vt=Q[1],Vt=[U,vt+k],le=Vt[0],he=Vt[1],Ne=[p,G+k],Er=Ne[0],Fr=Ne[1],zr=u.showRadio,pn=(0,P.pi)((0,P.pi)({path:[["M",U,G],["A",k,k,0,0,1,pt,vt],["L",pt-L,vt],["L",pt,vt],["A",k,k,0,0,1,le,he],["L",le,he-L],["L",le,he],["A",k,k,0,0,1,Er,Fr],["L",Er+L,Fr],["L",Er,Fr],["A",k,k,0,0,1,U,G],["L",U,G+L]],stroke:"#000000",fill:"#ffffff"},w),{opacity:zr?(_=w==null?void 0:w.opacity)!==null&&_!==void 0?_:.45:0}),nn=this.addShape(t,{type:"path",id:this.getElementId("item-"+u.id+"-radio"),name:"legend-item-radio",attrs:pn});return nn.set("tip",i.tip),nn},e.prototype.drawItem=function(t,i,u,c){var p="item-"+t.id,g=this.addGroup(c,{name:"legend-item-container",id:this.getElementId("item-container-"+p),delegateObject:{item:t,index:i}}),_=this.addGroup(g,{name:"legend-item",id:this.getElementId(p),delegateObject:{item:t,index:i}}),w=this.get("marker"),k=this.get("itemName"),L=this.get("itemValue"),R=this.get("itemBackground"),U=this.get("radio"),G=this.getLimitItemWidth(),Q=0;if(w){var pt=this.drawMarker(_,w,t,u),vt=w.spacing,Vt=(0,b.U2)(t,["marker","spacing"]);(0,b.hj)(Vt)&&(vt=Vt),Q=pt.getBBox().maxX+vt}if(k){var le=this.drawItemText(_,"name",k,t,u,Q,i);G&&M(!0,le,(0,b.uZ)(G-Q,0,G)),Q=le.getBBox().maxX+k.spacing}if(L){var he=this.drawItemText(_,"value",L,t,u,Q,i);G&&(L.alignRight?(he.attr({textAlign:"right",x:G}),M(!0,he,(0,b.uZ)(G-Q,0,G),"head")):M(!0,he,(0,b.uZ)(G-Q,0,G))),Q=he.getBBox().maxX+L.spacing}if(U&&this.drawRadio(_,U,t,u,Q),R){var Ne=_.getBBox(),Er=this.addShape(_,{type:"rect",name:"legend-item-background",id:this.getElementId(p+"-background"),attrs:(0,P.pi)({x:0,y:0,width:Ne.width,height:u},R.style)});Er.toBack()}return this.applyItemStates(t,_),_},e.prototype.adjustNavigation=function(t,i){var u=this,c=this.startX,p=this.startY,g=this.get("layout"),_=i.findAll(function(nn){return nn.get("name")==="legend-item"}),w=this.get("maxWidth"),k=this.get("maxHeight"),L=this.get("itemWidth"),R=this.get("itemSpacing"),U=this.getItemHeight(),G=(0,b.b$)({},Lc,this.get("pageNavigator")),Q=this.drawNavigation(t,g,"00/00",G),pt=Q.getBBox(),vt={x:c,y:p},Vt=1,le=0,he=0,Ne=0,Er=this.get("itemMarginBottom");if(g==="horizontal"){var Fr=this.get("maxRow")||1,zr=U+(Fr===1?0:Er);this.pageHeight=zr*Fr,(0,b.S6)(_,function(nn){var Pn=nn.getBBox(),Si=L||Pn.width;(le&&le<vt.x+Si+R||w<vt.x+Si+R+pt.width)&&(Vt===1&&(le=vt.x+R,u.pageWidth=le,u.moveElementTo(Q,{x:w-R-pt.width-pt.minX,y:vt.y+U/2-pt.height/2-pt.minY})),Vt+=1,vt.x=c,vt.y+=zr),u.moveElementTo(nn,vt),nn.getParent().setClip({type:"rect",attrs:{x:vt.x,y:vt.y,width:Si+R,height:U}}),vt.x+=Si+R})}else{(0,b.S6)(_,function(nn){var Pn=nn.getBBox();Pn.width>he&&(he=Pn.width)}),Ne=he,he+=R,w&&(he=Math.min(w,he),Ne=Math.min(w,Ne)),this.pageWidth=he,this.pageHeight=k-Math.max(pt.height,U+Er);var pn=Math.floor(this.pageHeight/(U+Er));(0,b.S6)(_,function(nn,Pn){Pn!==0&&Pn%pn===0&&(Vt+=1,vt.x+=he,vt.y=p),u.moveElementTo(nn,vt),nn.getParent().setClip({type:"rect",attrs:{x:vt.x,y:vt.y,width:he,height:U}}),vt.y+=U+Er}),this.totalPagesCnt=Vt,this.moveElementTo(Q,{x:c+Ne/2-pt.width/2-pt.minX,y:k-pt.height-pt.minY})}this.pageHeight&&this.pageWidth&&i.getParent().setClip({type:"rect",attrs:{x:this.startX,y:this.startY,width:this.pageWidth,height:this.pageHeight}}),g==="horizontal"&&this.get("maxRow")?this.totalPagesCnt=Math.ceil(Vt/this.get("maxRow")):this.totalPagesCnt=Vt,this.currentPageIndex>this.totalPagesCnt&&(this.currentPageIndex=1),this.updateNavigation(Q),i.attr("matrix",this.getCurrentNavigationMatrix())},e.prototype.drawNavigation=function(t,i,u,c){var p={x:0,y:0},g=this.addGroup(t,{id:this.getElementId("navigation-group"),name:"legend-navigation"}),_=(0,b.U2)(c.marker,"style",{}),w=_.size,k=w===void 0?12:w,L=(0,P._T)(_,["size"]),R=this.drawArrow(g,p,cv,i==="horizontal"?"up":"left",k,L);R.on("click",this.onNavigationBack);var U=R.getBBox();p.x+=U.width+2;var G=this.addShape(g,{type:"text",id:this.getElementId("navigation-text"),name:"navigation-text",attrs:(0,P.pi)({x:p.x,y:p.y+k/2,text:u,textBaseline:"middle"},(0,b.U2)(c.text,"style"))}),Q=G.getBBox();p.x+=Q.width+2;var pt=this.drawArrow(g,p,Sh,i==="horizontal"?"down":"right",k,L);return pt.on("click",this.onNavigationAfter),g},e.prototype.updateNavigation=function(t){var i=(0,b.b$)({},Lc,this.get("pageNavigator")),u=i.marker.style,c=u.fill,p=u.opacity,g=u.inactiveFill,_=u.inactiveOpacity,w=this.currentPageIndex+"/"+this.totalPagesCnt,k=t?t.getChildren()[1]:this.getElementByLocalId("navigation-text"),L=t?t.findById(this.getElementId(cv)):this.getElementByLocalId(cv),R=t?t.findById(this.getElementId(Sh)):this.getElementByLocalId(Sh);k.attr("text",w),L.attr("opacity",this.currentPageIndex===1?_:p),L.attr("fill",this.currentPageIndex===1?g:c),L.attr("cursor",this.currentPageIndex===1?"not-allowed":"pointer"),R.attr("opacity",this.currentPageIndex===this.totalPagesCnt?_:p),R.attr("fill",this.currentPageIndex===this.totalPagesCnt?g:c),R.attr("cursor",this.currentPageIndex===this.totalPagesCnt?"not-allowed":"pointer");var U=L.getBBox().maxX+2;k.attr("x",U),U+=k.getBBox().width+2,this.updateArrowPath(R,{x:U,y:0})},e.prototype.drawArrow=function(t,i,u,c,p,g){var _=i.x,w=i.y,k=this.addShape(t,{type:"path",id:this.getElementId(u),name:u,attrs:(0,P.pi)({size:p,direction:c,path:[["M",_+p/2,w],["L",_,w+p],["L",_+p,w+p],["Z"]],cursor:"pointer"},g)});return k.attr("matrix",Ts({x:_+p/2,y:w+p/2},wl[c])),k},e.prototype.updateArrowPath=function(t,i){var u=i.x,c=i.y,p=t.attr(),g=p.size,_=p.direction,w=Ts({x:u+g/2,y:c+g/2},wl[_]);t.attr("path",[["M",u+g/2,c],["L",u,c+g],["L",u+g,c+g],["Z"]]),t.attr("matrix",w)},e.prototype.getCurrentNavigationMatrix=function(){var t=this,i=t.currentPageIndex,u=t.pageWidth,c=t.pageHeight,p=this.get("layout"),g=p==="horizontal"?{x:0,y:c*(1-i)}:{x:u*(1-i),y:0};return jc(g)},e.prototype.applyItemStates=function(t,i){var u=this.getItemStates(t),c=u.length>0;if(c){var p=i.getChildren(),g=this.get("itemStates");(0,b.S6)(p,function(_){var w=_.get("name"),k=w.split("-")[2],L=Aa(t,k,g);L&&(_.attr(L),k==="marker"&&!(_.get("isStroke")&&_.get("isFill"))&&(_.get("isStroke")&&_.attr("fill",null),_.get("isFill")&&_.attr("stroke",null)))})}},e.prototype.getLimitItemWidth=function(){var t=this.get("itemWidth"),i=this.get("maxItemWidth");return i?t&&(i=t<=i?t:i):t&&(i=t),i},e}(Up),Cd=ei,Gm=1.4,Bs=.4,Mf=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"continue",min:0,max:100,value:null,colors:[],track:{},rail:{},label:{},handler:{},slidable:!0,tip:null,step:null,maxWidth:null,maxHeight:null,defaultCfg:{label:{align:"rail",spacing:5,formatter:null,style:{fontSize:12,fill:H.textColor,textBaseline:"middle",fontFamily:H.fontFamily}},handler:{size:10,style:{fill:"#fff",stroke:"#333"}},track:{},rail:{type:"color",size:20,defaultLength:100,style:{fill:"#DCDEE2"}},title:{spacing:5,style:{fill:H.textColor,fontSize:12,textAlign:"start",textBaseline:"top"}}}})},e.prototype.isSlider=function(){return!0},e.prototype.getValue=function(){return this.getCurrentValue()},e.prototype.getRange=function(){return{min:this.get("min"),max:this.get("max")}},e.prototype.setRange=function(t,i){this.update({min:t,max:i})},e.prototype.setValue=function(t){var i=this.getValue();this.set("value",t);var u=this.get("group");this.resetTrackClip(),this.get("slidable")&&this.resetHandlers(u),this.delegateEmit("valuechanged",{originValue:i,value:t})},e.prototype.initEvent=function(){var t=this.get("group");this.bindSliderEvent(t),this.bindRailEvent(t),this.bindTrackEvent(t)},e.prototype.drawLegendContent=function(t){this.drawRail(t),this.drawLabels(t),this.fixedElements(t),this.resetTrack(t),this.resetTrackClip(t),this.get("slidable")&&this.resetHandlers(t)},e.prototype.bindSliderEvent=function(t){this.bindHandlersEvent(t)},e.prototype.bindHandlersEvent=function(t){var i=this;t.on("legend-handler-min:drag",function(u){var c=i.getValueByCanvasPoint(u.x,u.y),p=i.getCurrentValue(),g=p[1];g<c&&(g=c),i.setValue([c,g])}),t.on("legend-handler-max:drag",function(u){var c=i.getValueByCanvasPoint(u.x,u.y),p=i.getCurrentValue(),g=p[0];g>c&&(g=c),i.setValue([g,c])})},e.prototype.bindRailEvent=function(t){},e.prototype.bindTrackEvent=function(t){var i=this,u=null;t.on("legend-track:dragstart",function(c){u={x:c.x,y:c.y}}),t.on("legend-track:drag",function(c){if(!!u){var p=i.getValueByCanvasPoint(u.x,u.y),g=i.getValueByCanvasPoint(c.x,c.y),_=i.getCurrentValue(),w=_[1]-_[0],k=i.getRange(),L=g-p;L<0?_[0]+L>k.min?i.setValue([_[0]+L,_[1]+L]):i.setValue([k.min,k.min+w]):L>0&&(L>0&&_[1]+L<k.max?i.setValue([_[0]+L,_[1]+L]):i.setValue([k.max-w,k.max])),u={x:c.x,y:c.y}}}),t.on("legend-track:dragend",function(c){u=null})},e.prototype.drawLabels=function(t){this.drawLabel("min",t),this.drawLabel("max",t)},e.prototype.drawLabel=function(t,i){var u=this.get("label"),c=u.style,p=u.align,g=u.formatter,_=this.get(t),w=this.getLabelAlignAttrs(t,p),k="label-"+t;this.addShape(i,{type:"text",id:this.getElementId(k),name:"legend-label-"+t,attrs:(0,P.pi)((0,P.pi)({x:0,y:0,text:(0,b.mf)(g)?g(_):_},c),w)})},e.prototype.getLabelAlignAttrs=function(t,i){var u=this.isVertical(),c="center",p="middle";return u?(c="start",i!=="rail"?t==="min"?p="top":p="bottom":p="top"):i!=="rail"?(p="top",t==="min"?c="start":c="end"):(c="start",p="middle"),{textAlign:c,textBaseline:p}},e.prototype.getRailPath=function(t,i,u,c){var p=this.get("rail"),g=p.size,_=p.defaultLength,w=p.type,k=this.isVertical(),L=_,R=u,U=c;R||(R=k?g:L),U||(U=k?L:g);var G=[];return w==="color"?(G.push(["M",t,i]),G.push(["L",t+R,i]),G.push(["L",t+R,i+U]),G.push(["L",t,i+U]),G.push(["Z"])):(G.push(["M",t+R,i]),G.push(["L",t+R,i+U]),G.push(["L",t,i+U]),G.push(["Z"])),G},e.prototype.drawRail=function(t){var i=this.get("rail"),u=i.style;this.addShape(t,{type:"path",id:this.getElementId("rail"),name:"legend-rail",attrs:(0,P.pi)({path:this.getRailPath(0,0)},u)})},e.prototype.getTrackColor=function(t){var i=t.length;if(!i)return null;if(i===1)return t[0];var u;this.isVertical()?u="l(90)":u="l(0)";for(var c=0;c<i;c++){var p=c/(i-1);u+=" "+p+":"+t[c]}return u},e.prototype.getTrackPath=function(t){var i=this.getRailShape(t),u=i.attr("path");return(0,b.d9)(u)},e.prototype.getClipTrackAttrs=function(t){var i=this.getCurrentValue(),u=i[0],c=i[1],p=this.getRailBBox(t),g=this.getPointByValue(u,t),_=this.getPointByValue(c,t),w=this.isVertical(),k,L,R,U;return w?(k=p.minX,L=g.y,R=p.width,U=_.y-g.y):(k=g.x,L=p.minY,R=_.x-g.x,U=p.height),{x:k,y:L,width:R,height:U}},e.prototype.getTrackAttrs=function(t){var i=this.get("track"),u=this.get("colors"),c=this.getTrackPath(t);return(0,b.CD)({path:c,fill:this.getTrackColor(u)},i.style)},e.prototype.resetTrackClip=function(t){var i=t||this.get("group"),u=this.getElementId("track"),c=i.findById(u),p=c.getClip(),g=this.getClipTrackAttrs(t);p?p.attr(g):c.setClip({type:"rect",attrs:g})},e.prototype.resetTrack=function(t){var i=this.getElementId("track"),u=t.findById(i),c=this.getTrackAttrs(t);u?u.attr(c):this.addShape(t,{type:"path",id:i,draggable:this.get("slidable"),name:"legend-track",attrs:c})},e.prototype.getPointByValue=function(t,i){var u=this.getRange(),c=u.min,p=u.max,g=(t-c)/(p-c),_=this.getRailBBox(i),w=this.isVertical(),k={x:0,y:0};return w?(k.x=_.minX+_.width/2,k.y=Ac(_.minY,_.maxY,g)):(k.x=Ac(_.minX,_.maxX,g),k.y=_.minY+_.height/2),k},e.prototype.getRailShape=function(t){var i=t||this.get("group");return i.findById(this.getElementId("rail"))},e.prototype.getRailBBox=function(t){var i=this.getRailShape(t),u=i.getBBox();return u},e.prototype.getRailCanvasBBox=function(){var t=this.get("group"),i=t.findById(this.getElementId("rail")),u=i.getCanvasBBox();return u},e.prototype.isVertical=function(){return this.get("layout")==="vertical"},e.prototype.getValueByCanvasPoint=function(t,i){var u=this.getRange(),c=u.min,p=u.max,g=this.getRailCanvasBBox(),_=this.isVertical(),w=this.get("step"),k;_?k=(i-g.minY)/g.height:k=(t-g.minX)/g.width;var L=Ac(c,p,k);if(w){var R=Math.round((L-c)/w);L=c+R*w}return L>p&&(L=p),L<c&&(L=c),L},e.prototype.getCurrentValue=function(){var t=this.get("value");if(!t){var i=this.get("values");return i?[Math.max(Math.min.apply(Math,(0,P.pr)(i,[this.get("max")])),this.get("min")),Math.min(Math.max.apply(Math,(0,P.pr)(i,[this.get("min")])),this.get("max"))]:[this.get("min"),this.get("max")]}return t},e.prototype.resetHandlers=function(t){var i=this.getCurrentValue(),u=i[0],c=i[1];this.resetHandler(t,"min",u),this.resetHandler(t,"max",c)},e.prototype.getHandlerPath=function(t,i){var u=this.isVertical(),c=[],p=t.size,g=i.x,_=i.y,w=p*Gm,k=p/2,L=p/6;if(u){var R=g+w*Bs;c.push(["M",g,_]),c.push(["L",R,_+k]),c.push(["L",g+w,_+k]),c.push(["L",g+w,_-k]),c.push(["L",R,_-k]),c.push(["Z"]),c.push(["M",R,_+L]),c.push(["L",g+w-2,_+L]),c.push(["M",R,_-L]),c.push(["L",g+w-2,_-L])}else{var U=_+w*Bs;c.push(["M",g,_]),c.push(["L",g-k,U]),c.push(["L",g-k,_+w]),c.push(["L",g+k,_+w]),c.push(["L",g+k,U]),c.push(["Z"]),c.push(["M",g-L,U]),c.push(["L",g-L,_+w-2]),c.push(["M",g+L,U]),c.push(["L",g+L,_+w-2])}return c},e.prototype.resetHandler=function(t,i,u){var c=this.getPointByValue(u,t),p=this.get("handler"),g=this.getHandlerPath(p,c),_=this.getElementId("handler-"+i),w=t.findById(_),k=this.isVertical();w?w.attr("path",g):this.addShape(t,{type:"path",name:"legend-handler-"+i,draggable:!0,id:_,attrs:(0,P.pi)((0,P.pi)({path:g},p.style),{cursor:k?"ns-resize":"ew-resize"})})},e.prototype.fixedElements=function(t){var i=t.findById(this.getElementId("rail")),u=t.findById(this.getElementId("label-min")),c=t.findById(this.getElementId("label-max")),p=this.getDrawPoint();this.isVertical()?this.fixedVertail(u,c,i,p):this.fixedHorizontal(u,c,i,p)},e.prototype.fitRailLength=function(t,i,u,c){var p=this.isVertical(),g=p?"height":"width",_=this.get("label"),w=_.align,k=_.spacing,L=this.get("max"+(0,b.jC)(g));if(L){var R=w==="rail"?u[g]+t[g]+i[g]+k*2:u[g],U=R-L;U>0&&this.changeRailLength(c,g,u[g]-U)}},e.prototype.changeRailLength=function(t,i,u){var c=t.getBBox(),p;i==="height"?p=this.getRailPath(c.x,c.y,c.width,u):p=this.getRailPath(c.x,c.y,u,c.height),t.attr("path",p)},e.prototype.changeRailPosition=function(t,i,u){var c=t.getBBox(),p=this.getRailPath(i,u,c.width,c.height);t.attr("path",p)},e.prototype.fixedHorizontal=function(t,i,u,c){var p=this.get("label"),g=p.align,_=p.spacing,w=u.getBBox(),k=t.getBBox(),L=i.getBBox(),R=w.height;this.fitRailLength(k,L,w,u),w=u.getBBox(),g==="rail"?(t.attr({x:c.x,y:c.y+R/2}),this.changeRailPosition(u,c.x+k.width+_,c.y),i.attr({x:c.x+k.width+w.width+_*2,y:c.y+R/2})):g==="top"?(t.attr({x:c.x,y:c.y}),i.attr({x:c.x+w.width,y:c.y}),this.changeRailPosition(u,c.x,c.y+k.height+_)):(this.changeRailPosition(u,c.x,c.y),t.attr({x:c.x,y:c.y+w.height+_}),i.attr({x:c.x+w.width,y:c.y+w.height+_}))},e.prototype.fixedVertail=function(t,i,u,c){var p=this.get("label"),g=p.align,_=p.spacing,w=u.getBBox(),k=t.getBBox(),L=i.getBBox();if(this.fitRailLength(k,L,w,u),w=u.getBBox(),g==="rail")t.attr({x:c.x,y:c.y}),this.changeRailPosition(u,c.x,c.y+k.height+_),i.attr({x:c.x,y:c.y+k.height+w.height+_*2});else if(g==="right")t.attr({x:c.x+w.width+_,y:c.y}),this.changeRailPosition(u,c.x,c.y),i.attr({x:c.x+w.width+_,y:c.y+w.height});else{var R=Math.max(k.width,L.width);t.attr({x:c.x,y:c.y}),this.changeRailPosition(u,c.x+R+_,c.y),i.attr({x:c.x,y:c.y+w.height})}},e}(Up),Zp=Mf,ef="g2-tooltip",Cl="g2-tooltip-title",Pc="g2-tooltip-list",Vp="g2-tooltip-list-item",wh="g2-tooltip-marker",fv="g2-tooltip-value",Ns="g2-tooltip-name",qf="g2-tooltip-crosshair-x",Ad="g2-tooltip-crosshair-y",gc,hv=(gc={},gc[""+ef]={position:"absolute",visibility:"visible",zIndex:8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"0px 0px 10px #aeaeae",borderRadius:"3px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:H.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},gc[""+Cl]={marginBottom:"4px"},gc[""+Pc]={margin:"0px",listStyleType:"none",padding:"0px"},gc[""+Vp]={listStyleType:"none",marginBottom:"4px"},gc[""+wh]={width:"8px",height:"8px",borderRadius:"50%",display:"inline-block",marginRight:"8px"},gc[""+fv]={display:"inline-block",float:"right",marginLeft:"30px"},gc[""+qf]={position:"absolute",width:"1px",backgroundColor:"rgba(0, 0, 0, 0.25)"},gc[""+Ad]={position:"absolute",height:"1px",backgroundColor:"rgba(0, 0, 0, 0.25)"},gc);function Td(r,e,t,i,u){var c={left:r<u.x,right:r+t>u.x+u.width,top:e<u.y,bottom:e+i>u.y+u.height};return c}function pv(r,e,t,i,u,c){var p=r,g=e;switch(c){case"left":p=r-i-t,g=e-u/2;break;case"right":p=r+t,g=e-u/2;break;case"top":p=r-i/2,g=e-u-t;break;case"bottom":p=r-i/2,g=e+t;break;default:p=r+t,g=e-u-t;break}return{x:p,y:g}}function Md(r,e,t,i,u,c,p){var g=pv(r,e,t,i,u,c);if(p){var _=Td(g.x,g.y,i,u,p);c==="auto"?(_.right&&(g.x=Math.max(0,r-i-t)),_.top&&(g.y=Math.max(0,e-u-t))):c==="top"||c==="bottom"?(_.left&&(g.x=p.x),_.right&&(g.x=p.x+p.width-i),c==="top"&&_.top&&(g.y=e+t),c==="bottom"&&_.bottom&&(g.y=e-u-t)):(_.top&&(g.y=p.y),_.bottom&&(g.y=p.y+p.height-u),c==="left"&&_.left&&(g.x=r+t),c==="right"&&_.right&&(g.x=r-i-t))}return g}function Kf(r,e){var t=!1;return(0,b.S6)(e,function(i){if((0,b.wH)(r,i))return t=!0,!1}),t}var up=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"tooltip",type:"html",x:0,y:0,items:[],customContent:null,containerTpl:'<div class="'+ef+'"><div class="'+Cl+'"></div><ul class="'+Pc+'"></ul></div>',itemTpl:'<li class="'+Vp+`" data-index={index}>
          <span class="`+wh+`" style="background:{color}"></span>
          <span class="`+Ns+`">{name}</span>:
          <span class="`+fv+`">{value}</span>
        </li>`,xCrosshairTpl:'<div class="'+qf+'"></div>',yCrosshairTpl:'<div class="'+Ad+'"></div>',title:null,showTitle:!0,region:null,crosshairsRegion:null,containerClassName:ef,crosshairs:null,offset:10,position:"right",domStyles:null,defaultStyles:hv})},e.prototype.render=function(){this.get("customContent")?this.renderCustomContent():(this.resetTitle(),this.renderItems()),this.resetPosition()},e.prototype.clear=function(){this.clearCrosshairs(),this.setTitle(""),this.clearItemDoms()},e.prototype.show=function(){var t=this.getContainer();!t||this.destroyed||(this.set("visible",!0),(0,Y.Z)(t,{visibility:"visible"}),this.setCrossHairsVisible(!0))},e.prototype.hide=function(){var t=this.getContainer();!t||this.destroyed||(this.set("visible",!1),(0,Y.Z)(t,{visibility:"hidden"}),this.setCrossHairsVisible(!1))},e.prototype.getLocation=function(){return{x:this.get("x"),y:this.get("y")}},e.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetPosition()},e.prototype.setCrossHairsVisible=function(t){var i=t?"":"none",u=this.get("xCrosshairDom"),c=this.get("yCrosshairDom");u&&(0,Y.Z)(u,{display:i}),c&&(0,Y.Z)(c,{display:i})},e.prototype.initContainer=function(){if(r.prototype.initContainer.call(this),this.get("customContent")){this.get("container")&&this.get("container").remove();var t=this.getHtmlContentNode();this.get("parent").appendChild(t),this.set("container",t),this.resetStyles(),this.applyStyles()}},e.prototype.updateInner=function(t){this.get("customContent")?this.renderCustomContent():(Kf(t,["title","showTitle"])&&this.resetTitle(),(0,b.wH)(t,"items")&&this.renderItems()),r.prototype.updateInner.call(this,t)},e.prototype.initDom=function(){this.cacheDoms()},e.prototype.removeDom=function(){r.prototype.removeDom.call(this),this.clearCrosshairs()},e.prototype.resetPosition=function(){var t=this.get("x"),i=this.get("y"),u=this.get("offset"),c=this.getOffset(),p=c.offsetX,g=c.offsetY,_=this.get("position"),w=this.get("region"),k=this.getContainer(),L=this.getBBox(),R=L.width,U=L.height,G;w&&(G=sl(w));var Q=Md(t,i,u,R,U,_,G);(0,Y.Z)(k,{left:Ms(Q.x+p),top:Ms(Q.y+g)}),this.resetCrosshairs()},e.prototype.renderCustomContent=function(){var t=this.getHtmlContentNode(),i=this.get("parent"),u=this.get("container");u&&u.parentNode===i?i.replaceChild(t,u):i.appendChild(t),this.set("container",t),this.resetStyles(),this.applyStyles()},e.prototype.getHtmlContentNode=function(){var t,i=this.get("customContent");if(i){var u=i(this.get("title"),this.get("items"));(0,b.kK)(u)?t=u:t=(0,Ct.Z)(u)}return t},e.prototype.cacheDoms=function(){var t=this.getContainer(),i=t.getElementsByClassName(Cl)[0],u=t.getElementsByClassName(Pc)[0];this.set("titleDom",i),this.set("listDom",u)},e.prototype.resetTitle=function(){var t=this.get("title"),i=this.get("showTitle");i&&t?this.setTitle(t):this.setTitle("")},e.prototype.setTitle=function(t){var i=this.get("titleDom");i&&(i.innerText=t)},e.prototype.resetCrosshairs=function(){var t=this.get("crosshairsRegion"),i=this.get("crosshairs");if(!t||!i)this.clearCrosshairs();else{var u=sl(t),c=this.get("xCrosshairDom"),p=this.get("yCrosshairDom");i==="x"?(this.resetCrosshair("x",u),p&&(p.remove(),this.set("yCrosshairDom",null))):i==="y"?(this.resetCrosshair("y",u),c&&(c.remove(),this.set("xCrosshairDom",null))):(this.resetCrosshair("x",u),this.resetCrosshair("y",u)),this.setCrossHairsVisible(this.get("visible"))}},e.prototype.resetCrosshair=function(t,i){var u=this.checkCrosshair(t),c=this.get(t);t==="x"?(0,Y.Z)(u,{left:Ms(c),top:Ms(i.y),height:Ms(i.height)}):(0,Y.Z)(u,{top:Ms(c),left:Ms(i.x),width:Ms(i.width)})},e.prototype.checkCrosshair=function(t){var i=t+"CrosshairDom",u=t+"CrosshairTpl",c="CROSSHAIR_"+t.toUpperCase(),p=lt[c],g=this.get(i),_=this.get("parent");return g||(g=(0,Ct.Z)(this.get(u)),this.applyStyle(p,g),_.appendChild(g),this.set(i,g)),g},e.prototype.renderItems=function(){this.clearItemDoms();var t=this.get("items"),i=this.get("itemTpl"),u=this.get("listDom");u&&((0,b.S6)(t,function(c){var p=Ya.toCSSGradient(c.color),g=(0,P.pi)((0,P.pi)({},c),{color:p}),_=(0,b.ng)(i,g),w=(0,Ct.Z)(_);u.appendChild(w)}),this.applyChildrenStyles(u,this.get("domStyles")))},e.prototype.clearItemDoms=function(){this.get("listDom")&&Af(this.get("listDom"))},e.prototype.clearCrosshairs=function(){var t=this.get("xCrosshairDom"),i=this.get("yCrosshairDom");t&&t.remove(),i&&i.remove(),this.set("xCrosshairDom",null),this.set("yCrosshairDom",null)},e}(Qa),Id=up,Gp={opacity:0},Qf={stroke:"#C5C5C5",strokeOpacity:.85},dv={fill:"#CACED4",opacity:.85},rf=ot(39499);function vv(r){return(0,b.UI)(r,function(e,t){var i=t===0?"M":"L",u=e[0],c=e[1];return[i,u,c]})}function nf(r){return vv(r)}function Hp(r){if(r.length<=2)return nf(r);var e=[];(0,b.S6)(r,function(p){(0,b.Xy)(p,e.slice(e.length-2))||e.push(p[0],p[1])});var t=(0,rf.e9)(e,!1),i=(0,b.YM)(r),u=i[0],c=i[1];return t.unshift(["M",u,c]),t}function Ul(r,e,t,i){i===void 0&&(i=!0);var u=new _i({values:r}),c=new Hs({values:(0,b.UI)(r,function(g,_){return _})}),p=(0,b.UI)(r,function(g,_){return[c.scale(_)*e,t-u.scale(g)*t]});return i?Hp(p):nf(p)}function kd(r,e){var t=new _i({values:r}),i=t.max<0?t.max:Math.max(0,t.min);return e-t.scale(i)*e}function Ld(r,e,t,i){var u=(0,P.pr)(r),c=kd(i,t);return u.push(["L",e,c]),u.push(["L",0,c]),u.push(["Z"]),u}var Pd=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"trend",x:0,y:0,width:200,height:16,smooth:!0,isArea:!1,data:[],backgroundStyle:Gp,lineStyle:Qf,areaStyle:dv})},e.prototype.renderInner=function(t){var i=this.cfg,u=i.width,c=i.height,p=i.data,g=i.smooth,_=i.isArea,w=i.backgroundStyle,k=i.lineStyle,L=i.areaStyle;this.addShape(t,{id:this.getElementId("background"),type:"rect",attrs:(0,P.pi)({x:0,y:0,width:u,height:c},w)});var R=Ul(p,u,c,g);if(this.addShape(t,{id:this.getElementId("line"),type:"path",attrs:(0,P.pi)({path:R},k)}),_){var U=Ld(R,u,c,p);this.addShape(t,{id:this.getElementId("area"),type:"path",attrs:(0,P.pi)({path:U},L)})}},e.prototype.applyOffset=function(){var t=this.cfg,i=t.x,u=t.y;this.moveElementTo(this.get("group"),{x:i,y:u})},e}(Rs),jp=null,af={fill:"#F7F7F7",stroke:"#BFBFBF",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#FFF"},ec=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"handler",x:0,y:0,width:10,height:24,style:af})},e.prototype.renderInner=function(t){var i=this.cfg,u=i.width,c=i.height,p=i.style,g=p.fill,_=p.stroke,w=p.radius,k=p.opacity,L=p.cursor;this.addShape(t,{type:"rect",id:this.getElementId("background"),attrs:{x:0,y:0,width:u,height:c,fill:g,stroke:_,radius:w,opacity:k,cursor:L}});var R=1/3*u,U=2/3*u,G=1/4*c,Q=3/4*c;this.addShape(t,{id:this.getElementId("line-left"),type:"line",attrs:{x1:R,y1:G,x2:R,y2:Q,stroke:_,cursor:L}}),this.addShape(t,{id:this.getElementId("line-right"),type:"line",attrs:{x1:U,y1:G,x2:U,y2:Q,stroke:_,cursor:L}})},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},e.prototype.initEvent=function(){this.bindEvents()},e.prototype.bindEvents=function(){var t=this;this.get("group").on("mouseenter",function(){var i=t.get("style").highLightFill;t.getElementByLocalId("background").attr("fill",i),t.draw()}),this.get("group").on("mouseleave",function(){var i=t.get("style").fill;t.getElementByLocalId("background").attr("fill",i),t.draw()})},e.prototype.draw=function(){var t=this.get("container").get("canvas");t&&t.draw()},e}(Rs),Wp=null,H0={fill:"#416180",opacity:.05},Qv={fill:"#5B8FF9",opacity:.15,cursor:"move"},If=10,mc={width:If,height:24},j0={textBaseline:"middle",fill:"#000",opacity:.45},rc="sliderchange",Od=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.onMouseDown=function(i){return function(u){t.currentTarget=i;var c=u.originalEvent;c.stopPropagation(),c.preventDefault(),t.prevX=(0,b.U2)(c,"touches.0.pageX",c.pageX),t.prevY=(0,b.U2)(c,"touches.0.pageY",c.pageY);var p=t.getContainerDOM();p.addEventListener("mousemove",t.onMouseMove),p.addEventListener("mouseup",t.onMouseUp),p.addEventListener("mouseleave",t.onMouseUp),p.addEventListener("touchmove",t.onMouseMove),p.addEventListener("touchend",t.onMouseUp),p.addEventListener("touchcancel",t.onMouseUp)}},t.onMouseMove=function(i){var u=t.cfg.width,c=[t.get("start"),t.get("end")];i.stopPropagation(),i.preventDefault();var p=(0,b.U2)(i,"touches.0.pageX",i.pageX),g=(0,b.U2)(i,"touches.0.pageY",i.pageY),_=p-t.prevX,w=t.adjustOffsetRange(_/u);t.updateStartEnd(w),t.updateUI(t.getElementByLocalId("foreground"),t.getElementByLocalId("minText"),t.getElementByLocalId("maxText")),t.prevX=p,t.prevY=g,t.draw(),t.emit(rc,[t.get("start"),t.get("end")].sort()),t.delegateEmit("valuechanged",{originValue:c,value:[t.get("start"),t.get("end")]})},t.onMouseUp=function(){t.currentTarget&&(t.currentTarget=void 0);var i=t.getContainerDOM();i&&(i.removeEventListener("mousemove",t.onMouseMove),i.removeEventListener("mouseup",t.onMouseUp),i.removeEventListener("mouseleave",t.onMouseUp),i.removeEventListener("touchmove",t.onMouseMove),i.removeEventListener("touchend",t.onMouseUp),i.removeEventListener("touchcancel",t.onMouseUp))},t}return e.prototype.setRange=function(t,i){this.set("minLimit",t),this.set("maxLimit",i);var u=this.get("start"),c=this.get("end"),p=(0,b.uZ)(u,t,i),g=(0,b.uZ)(c,t,i);!this.get("isInit")&&(u!==p||c!==g)&&this.setValue([p,g])},e.prototype.getRange=function(){return{min:this.get("minLimit")||0,max:this.get("maxLimit")||1}},e.prototype.setValue=function(t){var i=this.getRange();if((0,b.kJ)(t)&&t.length===2){var u=[this.get("start"),this.get("end")];this.update({start:(0,b.uZ)(t[0],i.min,i.max),end:(0,b.uZ)(t[1],i.min,i.max)}),this.get("updateAutoRender")||this.render(),this.delegateEmit("valuechanged",{originValue:u,value:t})}},e.prototype.getValue=function(){return[this.get("start"),this.get("end")]},e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"slider",x:0,y:0,width:100,height:16,backgroundStyle:{},foregroundStyle:{},handlerStyle:{},textStyle:{},defaultCfg:{backgroundStyle:H0,foregroundStyle:Qv,handlerStyle:mc,textStyle:j0}})},e.prototype.update=function(t){var i=t.start,u=t.end,c=(0,P.pi)({},t);(0,b.UM)(i)||(c.start=(0,b.uZ)(i,0,1)),(0,b.UM)(u)||(c.end=(0,b.uZ)(u,0,1)),r.prototype.update.call(this,c),this.minHandler=this.getChildComponentById(this.getElementId("minHandler")),this.maxHandler=this.getChildComponentById(this.getElementId("maxHandler")),this.trend=this.getChildComponentById(this.getElementId("trend"))},e.prototype.init=function(){this.set("start",(0,b.uZ)(this.get("start"),0,1)),this.set("end",(0,b.uZ)(this.get("end"),0,1)),r.prototype.init.call(this)},e.prototype.render=function(){r.prototype.render.call(this),this.updateUI(this.getElementByLocalId("foreground"),this.getElementByLocalId("minText"),this.getElementByLocalId("maxText"))},e.prototype.renderInner=function(t){var i=this.cfg,u=i.start,c=i.end,p=i.width,g=i.height,_=i.trendCfg,w=_===void 0?{}:_,k=i.minText,L=i.maxText,R=i.backgroundStyle,U=R===void 0?{}:R,G=i.foregroundStyle,Q=G===void 0?{}:G,pt=i.textStyle,vt=pt===void 0?{}:pt,Vt=(0,b.b$)({},af,this.cfg.handlerStyle),le=u*p,he=c*p;(0,b.dp)((0,b.U2)(w,"data"))&&(this.trend=this.addComponent(t,(0,P.pi)({component:Pd,id:this.getElementId("trend"),x:0,y:0,width:p,height:g},w))),this.addShape(t,{id:this.getElementId("background"),type:"rect",attrs:(0,P.pi)({x:0,y:0,width:p,height:g},U)});var Ne=this.addShape(t,{id:this.getElementId("minText"),type:"text",attrs:(0,P.pi)({y:g/2,textAlign:"right",text:k,silent:!1},vt)}),Er=this.addShape(t,{id:this.getElementId("maxText"),type:"text",attrs:(0,P.pi)({y:g/2,textAlign:"left",text:L,silent:!1},vt)}),Fr=this.addShape(t,{id:this.getElementId("foreground"),name:"foreground",type:"rect",attrs:(0,P.pi)({y:0,height:g},Q)}),zr=(0,b.U2)(Vt,"width",If),pn=(0,b.U2)(Vt,"height",24);this.minHandler=this.addComponent(t,{component:ec,id:this.getElementId("minHandler"),name:"handler-min",x:0,y:(g-pn)/2,width:zr,height:pn,cursor:"ew-resize",style:Vt}),this.maxHandler=this.addComponent(t,{component:ec,id:this.getElementId("maxHandler"),name:"handler-max",x:0,y:(g-pn)/2,width:zr,height:pn,cursor:"ew-resize",style:Vt})},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},e.prototype.initEvent=function(){this.bindEvents()},e.prototype.updateUI=function(t,i,u){var c=this.cfg,p=c.start,g=c.end,_=c.width,w=c.minText,k=c.maxText,L=c.handlerStyle,R=c.height,U=p*_,G=g*_;this.trend&&(this.trend.update({width:_,height:R}),this.get("updateAutoRender")||this.trend.render()),t.attr("x",U),t.attr("width",G-U);var Q=(0,b.U2)(L,"width",If);i.attr("text",w),u.attr("text",k);var pt=this._dodgeText([U,G],i,u),vt=pt[0],Vt=pt[1];this.minHandler&&(this.minHandler.update({x:U-Q/2}),this.get("updateAutoRender")||this.minHandler.render()),(0,b.S6)(vt,function(le,he){return i.attr(he,le)}),this.maxHandler&&(this.maxHandler.update({x:G-Q/2}),this.get("updateAutoRender")||this.maxHandler.render()),(0,b.S6)(Vt,function(le,he){return u.attr(he,le)})},e.prototype.bindEvents=function(){var t=this.get("group");t.on("handler-min:mousedown",this.onMouseDown("minHandler")),t.on("handler-min:touchstart",this.onMouseDown("minHandler")),t.on("handler-max:mousedown",this.onMouseDown("maxHandler")),t.on("handler-max:touchstart",this.onMouseDown("maxHandler"));var i=t.findById(this.getElementId("foreground"));i.on("mousedown",this.onMouseDown("foreground")),i.on("touchstart",this.onMouseDown("foreground"))},e.prototype.adjustOffsetRange=function(t){var i=this.cfg,u=i.start,c=i.end;switch(this.currentTarget){case"minHandler":{var p=0-u,g=1-u;return Math.min(g,Math.max(p,t))}case"maxHandler":{var p=0-c,g=1-c;return Math.min(g,Math.max(p,t))}case"foreground":{var p=0-u,g=1-c;return Math.min(g,Math.max(p,t))}}},e.prototype.updateStartEnd=function(t){var i=this.cfg,u=i.start,c=i.end;switch(this.currentTarget){case"minHandler":u+=t;break;case"maxHandler":c+=t;break;case"foreground":u+=t,c+=t;break}this.set("start",u),this.set("end",c)},e.prototype._dodgeText=function(t,i,u){var c,p,g=this.cfg,_=g.handlerStyle,w=g.width,k=2,L=(0,b.U2)(_,"width",If),R=t[0],U=t[1],G=!1;R>U&&(c=[U,R],R=c[0],U=c[1],p=[u,i],i=p[0],u=p[1],G=!0);var Q=i.getBBox(),pt=u.getBBox(),vt=Q.width>R-k?{x:R+L/2+k,textAlign:"left"}:{x:R-L/2-k,textAlign:"right"},Vt=pt.width>w-U-k?{x:U-L/2-k,textAlign:"right"}:{x:U+L/2+k,textAlign:"left"};return G?[Vt,vt]:[vt,Vt]},e.prototype.draw=function(){var t=this.get("container"),i=t&&t.get("canvas");i&&i.draw()},e.prototype.getContainerDOM=function(){var t=this.get("container"),i=t&&t.get("canvas");return i&&i.get("container")},e}(Rs),Jv=null;function of(r,e,t){if(r){if(typeof r.addEventListener=="function")return r.addEventListener(e,t,!1),{remove:function(){r.removeEventListener(e,t,!1)}};if(typeof r.attachEvent=="function")return r.attachEvent("on"+e,t),{remove:function(){r.detachEvent("on"+e,t)}}}}var sf={trackColor:"rgba(0,0,0,0)",thumbColor:"rgba(0,0,0,0.15)",size:8,lineCap:"round"},Fd={default:sf,hover:{thumbColor:"rgba(0,0,0,0.2)"}},t0=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.clearEvents=b.ZT,t.onStartEvent=function(i){return function(u){t.isMobile=i,u.originalEvent.preventDefault();var c=i?(0,b.U2)(u.originalEvent,"touches.0.clientX"):u.clientX,p=i?(0,b.U2)(u.originalEvent,"touches.0.clientY"):u.clientY;t.startPos=t.cfg.isHorizontal?c:p,t.bindLaterEvent()}},t.bindLaterEvent=function(){var i=t.getContainerDOM(),u=[];t.isMobile?u=[of(i,"touchmove",t.onMouseMove),of(i,"touchend",t.onMouseUp),of(i,"touchcancel",t.onMouseUp)]:u=[of(i,"mousemove",t.onMouseMove),of(i,"mouseup",t.onMouseUp),of(i,"mouseleave",t.onMouseUp)],t.clearEvents=function(){u.forEach(function(c){c.remove()})}},t.onMouseMove=function(i){var u=t.cfg,c=u.isHorizontal,p=u.thumbOffset;i.preventDefault();var g=t.isMobile?(0,b.U2)(i,"touches.0.clientX"):i.clientX,_=t.isMobile?(0,b.U2)(i,"touches.0.clientY"):i.clientY,w=c?g:_,k=w-t.startPos;t.startPos=w,t.updateThumbOffset(p+k)},t.onMouseUp=function(i){i.preventDefault(),t.clearEvents()},t.onTrackClick=function(i){var u=t.cfg,c=u.isHorizontal,p=u.x,g=u.y,_=u.thumbLen,w=t.getContainerDOM(),k=w.getBoundingClientRect(),L=i.clientX,R=i.clientY,U=c?L-k.left-p-_/2:R-k.top-g-_/2,G=t.validateRange(U);t.updateThumbOffset(G)},t.onThumbMouseOver=function(){var i=t.cfg.theme.hover.thumbColor;t.getElementByLocalId("thumb").attr("stroke",i),t.draw()},t.onThumbMouseOut=function(){var i=t.cfg.theme.default.thumbColor;t.getElementByLocalId("thumb").attr("stroke",i),t.draw()},t}return e.prototype.setRange=function(t,i){this.set("minLimit",t),this.set("maxLimit",i);var u=this.getValue(),c=(0,b.uZ)(u,t,i);u!==c&&!this.get("isInit")&&this.setValue(c)},e.prototype.getRange=function(){var t=this.get("minLimit")||0,i=this.get("maxLimit")||1;return{min:t,max:i}},e.prototype.setValue=function(t){var i=this.getRange(),u=this.getValue();this.update({thumbOffset:(this.get("trackLen")-this.get("thumbLen"))*(0,b.uZ)(t,i.min,i.max)}),this.delegateEmit("valuechange",{originalValue:u,value:this.getValue()})},e.prototype.getValue=function(){return(0,b.uZ)(this.get("thumbOffset")/(this.get("trackLen")-this.get("thumbLen")),0,1)},e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"scrollbar",isHorizontal:!0,minThumbLen:20,thumbOffset:0,theme:Fd})},e.prototype.renderInner=function(t){this.renderTrackShape(t),this.renderThumbShape(t)},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},e.prototype.initEvent=function(){this.bindEvents()},e.prototype.renderTrackShape=function(t){var i=this.cfg,u=i.trackLen,c=i.theme,p=c===void 0?{default:{}}:c,g=(0,b.b$)({},Fd,p).default,_=g.lineCap,w=g.trackColor,k=g.size,L=(0,b.U2)(this.cfg,"size",k),R=this.get("isHorizontal")?{x1:0+L/2,y1:L/2,x2:u-L/2,y2:L/2,lineWidth:L,stroke:w,lineCap:_}:{x1:L/2,y1:0+L/2,x2:L/2,y2:u-L/2,lineWidth:L,stroke:w,lineCap:_};return this.addShape(t,{id:this.getElementId("track"),name:"track",type:"line",attrs:R})},e.prototype.renderThumbShape=function(t){var i=this.cfg,u=i.thumbOffset,c=i.thumbLen,p=i.theme,g=(0,b.b$)({},Fd,p).default,_=g.size,w=g.lineCap,k=g.thumbColor,L=(0,b.U2)(this.cfg,"size",_),R=this.get("isHorizontal")?{x1:u+L/2,y1:L/2,x2:u+c-L/2,y2:L/2,lineWidth:L,stroke:k,lineCap:w,cursor:"default"}:{x1:L/2,y1:u+L/2,x2:L/2,y2:u+c-L/2,lineWidth:L,stroke:k,lineCap:w,cursor:"default"};return this.addShape(t,{id:this.getElementId("thumb"),name:"thumb",type:"line",attrs:R})},e.prototype.bindEvents=function(){var t=this.get("group");t.on("mousedown",this.onStartEvent(!1)),t.on("mouseup",this.onMouseUp),t.on("touchstart",this.onStartEvent(!0)),t.on("touchend",this.onMouseUp);var i=t.findById(this.getElementId("track"));i.on("click",this.onTrackClick);var u=t.findById(this.getElementId("thumb"));u.on("mouseover",this.onThumbMouseOver),u.on("mouseout",this.onThumbMouseOut)},e.prototype.getContainerDOM=function(){var t=this.get("container"),i=t&&t.get("canvas");return i&&i.get("container")},e.prototype.validateRange=function(t){var i=this.cfg,u=i.thumbLen,c=i.trackLen,p=t;return t+u>c?p=c-u:t+u<u&&(p=0),p},e.prototype.draw=function(){var t=this.get("container"),i=t&&t.get("canvas");i&&i.draw()},e.prototype.updateThumbOffset=function(t){var i=this.cfg,u=i.thumbOffset,c=i.isHorizontal,p=i.thumbLen,g=i.size,_=this.validateRange(t);if(_!==u){var w=this.getElementByLocalId("thumb");c?w.attr({x1:_+g/2,x2:_+p-g/2}):w.attr({y1:_+g/2,y2:_+p-g/2}),this.emitOffsetChange(_)}},e.prototype.emitOffsetChange=function(t){var i=this.cfg,u=i.thumbOffset,c=i.trackLen,p=i.thumbLen;this.cfg.thumbOffset=t,this.emit("scrollchange",{thumbOffset:t,ratio:(0,b.uZ)(t/(c-p),0,1)}),this.delegateEmit("valuechange",{originalValue:u,value:t})},e}(Rs),nc=Jl,Rd=$c,Ch=lv,Ah=wd,e0=Cd,r0=Zp,lp=Id;function Dd(r){if((0,b.xb)(r))return null;var e=r[0].x,t=r[0].x,i=r[0].y,u=r[0].y;return(0,b.S6)(r,function(c){e=e>c.x?c.x:e,t=t<c.x?c.x:t,i=i>c.y?c.y:i,u=u<c.y?c.y:u}),{minX:e,maxX:t,minY:i,maxY:u,centerX:(e+t)/2,centerY:(i+u)/2}}function Ro(r){return Array.from(new Set(r)).length===1}function kf(r){return((0,b.VV)(r)+(0,b.Fp)(r))/2}function co(r,e,t,i){return{x:r+t*Math.cos(i),y:e+t*Math.sin(i)}}function gu(r,e,t,i,u,c){c===void 0&&(c=0);var p=co(r,e,t,i),g=co(r,e,t,u),_=co(r,e,c,i),w=co(r,e,c,u);if(u-i===Math.PI*2){var k=co(r,e,t,i+Math.PI),L=co(r,e,c,i+Math.PI),R=[["M",p.x,p.y],["A",t,t,0,1,1,k.x,k.y],["A",t,t,0,1,1,g.x,g.y],["M",_.x,_.y]];return c&&(R.push(["A",c,c,0,1,0,L.x,L.y]),R.push(["A",c,c,0,1,0,w.x,w.y])),R.push(["M",p.x,p.y]),R.push(["Z"]),R}var U=u-i<=Math.PI?0:1,G=[["M",p.x,p.y],["A",t,t,0,U,1,g.x,g.y],["L",w.x,w.y]];return c&&G.push(["A",c,c,0,U,0,_.x,_.y]),G.push(["L",p.x,p.y]),G.push(["Z"]),G}function W0(r,e,t,i,u){var c=co(r,e,t,i),p=co(r,e,t,u);if((0,b.vQ)(u-i,Math.PI*2)){var g=co(r,e,t,i+Math.PI);return[["M",c.x,c.y],["A",t,t,0,1,1,g.x,g.y],["A",t,t,0,1,1,c.x,c.y],["A",t,t,0,1,0,g.x,g.y],["A",t,t,0,1,0,c.x,c.y],["Z"]]}var _=u-i<=Math.PI?0:1;return[["M",c.x,c.y],["A",t,t,0,_,1,p.x,p.y]]}function Xp(r,e){var t=r.points,i=Dd(t),u,c,p=e.startAngle,g=e.endAngle,_=g-p;return e.isTransposed?(u=i.maxY*_,c=i.minY*_):(u=i.maxX*_,c=i.minX*_),u+=p,c+=p,{startAngle:c,endAngle:u}}function Bd(r,e){if((0,b.hj)(r)&&(0,b.hj)(e))return[r,e];if(r=r,e=e,Ro(r)||Ro(e))return[kf(r),kf(e)];for(var t=-1,i=0,u=0,c,p=r.length-1,g,_=0;++t<r.length;)c=p,p=t,_+=g=r[c]*e[p]-r[p]*e[c],i+=(r[c]+r[p])*g,u+=(e[c]+e[p])*g;return _*=3,[i/_,u/_]}function X0(r,e){var t=r.attr(),i=e.attr();return(0,b.S6)(t,function(u,c){i[c]===void 0&&(i[c]=void 0)}),i}function Yp(r,e,t){var i=Math.min(e,t),u=Math.max(e,t);return r>=i&&r<=u}function n0(r,e,t){if((0,b.HD)(r))return r.padEnd(e,t);if((0,b.kJ)(r)){var i=r.length;if(i<e)for(var u=e-i,c=0;c<u;c++)r.push(t)}return r}function ic(r,e){return typeof r=="object"&&e.forEach(function(t){delete r[t]}),r}function Th(r,e,t){var i,u;e===void 0&&(e=[]),t===void 0&&(t=new Map);try{for(var c=(0,P.XA)(r),p=c.next();!p.done;p=c.next()){var g=p.value;t.has(g)||(e.push(g),t.set(g,!0))}}catch(_){i={error:_}}finally{try{p&&!p.done&&(u=c.return)&&u.call(c)}finally{if(i)throw i.error}}return e}var Nu=function(){function r(e,t,i,u){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),u===void 0&&(u=0),this.x=e,this.y=t,this.height=u,this.width=i}return r.fromRange=function(e,t,i,u){return new r(e,t,i-e,u-t)},r.fromObject=function(e){return new r(e.minX,e.minY,e.width,e.height)},Object.defineProperty(r.prototype,"minX",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxX",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"minY",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxY",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tl",{get:function(){return{x:this.x,y:this.y}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tr",{get:function(){return{x:this.maxX,y:this.y}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bl",{get:function(){return{x:this.x,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"br",{get:function(){return{x:this.maxX,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return{x:this.x+this.width/2,y:this.minY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return{x:this.maxX,y:this.y+this.height/2}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return{x:this.x+this.width/2,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return{x:this.minX,y:this.y+this.height/2}},enumerable:!1,configurable:!0}),r.prototype.isEqual=function(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height},r.prototype.contains=function(e){return e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY},r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.clone();return(0,b.S6)(e,function(u){i.x=Math.min(u.x,i.x),i.y=Math.min(u.y,i.y),i.width=Math.max(u.maxX,i.maxX)-i.x,i.height=Math.max(u.maxY,i.maxY)-i.y}),i},r.prototype.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.clone();return(0,b.S6)(e,function(u){i.x=Math.max(u.x,i.x),i.y=Math.max(u.y,i.y),i.width=Math.min(u.maxX,i.maxX)-i.x,i.height=Math.min(u.maxY,i.maxY)-i.y}),i},r.prototype.cut=function(e,t){var i=e.width,u=e.height;switch(t){case fe.TOP:case fe.TOP_LEFT:case fe.TOP_RIGHT:return r.fromRange(this.minX,this.minY+u,this.maxX,this.maxY);case fe.RIGHT:case fe.RIGHT_TOP:case fe.RIGHT_BOTTOM:return r.fromRange(this.minX,this.minY,this.maxX-i,this.maxY);case fe.BOTTOM:case fe.BOTTOM_LEFT:case fe.BOTTOM_RIGHT:return r.fromRange(this.minX,this.minY,this.maxX,this.maxY-u);case fe.LEFT:case fe.LEFT_TOP:case fe.LEFT_BOTTOM:return r.fromRange(this.minX+i,this.minY,this.maxX,this.maxY);default:return this}},r.prototype.shrink=function(e){var t=(0,P.CR)(e,4),i=t[0],u=t[1],c=t[2],p=t[3];return new r(this.x+p,this.y+i,this.width-p-u,this.height-i-c)},r.prototype.expand=function(e){var t=(0,P.CR)(e,4),i=t[0],u=t[1],c=t[2],p=t[3];return new r(this.x-p,this.y-i,this.width+p+u,this.height+i+c)},r.prototype.exceed=function(e){return[Math.max(-this.minY+e.minY,0),Math.max(this.maxX-e.maxX,0),Math.max(this.maxY-e.maxY,0),Math.max(-this.minX+e.minX,0)]},r.prototype.collide=function(e){return this.minX<e.maxX&&this.maxX>e.minX&&this.minY<e.maxY&&this.maxY>e.minY},r.prototype.size=function(){return this.width*this.height},r.prototype.isPointIn=function(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY},r}(),Ug=function(r,e){var t=e.start,i=e.end;return new Nu(r.x+r.width*t.x,r.y+r.height*t.y,r.width*Math.abs(i.x-t.x),r.height*Math.abs(i.y-t.y))};function Jf(r){return[[r.minX,r.minY],[r.maxX,r.minY],[r.maxX,r.maxY],[r.minX,r.maxY]]}function th(r){if(r.isPolar&&!r.isTransposed)return(r.endAngle-r.startAngle)*r.getRadius();var e=r.convert({x:0,y:0}),t=r.convert({x:1,y:0});return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Qo(r){if(r.isPolar){var e=r.startAngle,t=r.endAngle;return t-e===Math.PI*2}return!1}function $p(r,e){var t=r.getCenter();return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function eh(r,e){var t=!1;if(r)if(r.type==="theta"){var i=r.start,u=r.end;t=Yp(e.x,i.x,u.x)&&Yp(e.y,i.y,u.y)}else{var c=r.invert(e);t=Yp(c.x,0,1)&&Yp(c.y,0,1)}return t}function uf(r,e){var t=r.getCenter();return Math.atan2(e.y-t.y,e.x-t.x)}function qp(r,e){e===void 0&&(e=0);var t=r.start,i=r.end,u=r.getWidth(),c=r.getHeight();if(r.isPolar){var p=r.startAngle,g=r.endAngle,_=r.getCenter(),w=r.getRadius();return{type:"path",startState:{path:gu(_.x,_.y,w+e,p,p)},endState:function(L){var R=(g-p)*L+p,U=gu(_.x,_.y,w+e,p,R);return{path:U}},attrs:{path:gu(_.x,_.y,w+e,p,g)}}}var k;return r.isTransposed?k={height:c+e*2}:k={width:u+e*2},{type:"rect",startState:{x:t.x-e,y:i.y-e,width:r.isTransposed?u+e*2:0,height:r.isTransposed?0:c+e*2},endState:k,attrs:{x:t.x-e,y:i.y-e,width:u+e*2,height:c+e*2}}}function Hm(r,e){e===void 0&&(e=0);var t=r.start,i=r.end,u=r.getWidth(),c=r.getHeight(),p=Math.min(t.x,i.x),g=Math.min(t.y,i.y);return Nu.fromRange(p-e,g-e,p+u+e,g+c+e)}var It=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]+)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/;function Ue(r){var e="linear";return It.test(r)?e="timeCat":(0,b.HD)(r)&&(e="cat"),e}function dr(r,e,t,i){return e===void 0&&(e={}),e.type?e.type:r.type!=="identity"&&_e.includes(t)&&["interval"].includes(i)||r.isCategory?"cat":r.type}function cn(r,e,t){var i=e||[];if((0,b.hj)(r)||(0,b.UM)((0,b.Wx)(i,r))&&(0,b.xb)(t)){var u=lc("identity");return new u({field:r.toString(),values:[r]})}var c=(0,b.I)(i,r),p=(0,b.U2)(t,"type",Ue(c[0])),g=lc(p);return new g((0,P.pi)({field:r,values:c},t))}function On(r,e){if(r.type!=="identity"&&e.type!=="identity"){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);r.change(t)}}function on(r){return r.alias||r.field}function En(r,e,t){var i=r.values,u=i.length,c;if(u===1)c=[.5,1];else{var p=1,g=0;Qo(e)?e.isTransposed?(p=(0,b.U2)(t,"widthRatio.multiplePie",1/1.3),g=1/u*p,c=[g/2,1-g/2]):c=[0,1-1/u]:(g=1/u/2,c=[g,1-g])}return c}function Dn(r){var e=r.values.filter(function(t){return!(0,b.UM)(t)&&!isNaN(t)});return Math.max.apply(Math,(0,P.ev)((0,P.ev)([],(0,P.CR)(e),!1),[(0,b.UM)(r.max)?-1/0:r.max],!1))}function Hn(r){var e,t;switch(r){case fe.TOP:e={x:0,y:1},t={x:1,y:1};break;case fe.RIGHT:e={x:1,y:0},t={x:1,y:1};break;case fe.BOTTOM:e={x:0,y:0},t={x:1,y:0};break;case fe.LEFT:e={x:0,y:0},t={x:0,y:1};break;default:e=t={x:0,y:0}}return{start:e,end:t}}function Jn(r){var e,t;return r.isTransposed?(e={x:0,y:0},t={x:1,y:0}):(e={x:0,y:0},t={x:0,y:1}),{start:e,end:t}}function ii(r,e){var t={start:{x:0,y:0},end:{x:0,y:0}};r.isRect?t=Hn(e):r.isPolar&&(t=Jn(r));var i=t.start,u=t.end;return{start:r.convert(i),end:r.convert(u)}}function ui(r,e){if(r.isRect)return r.isTransposed?[DIRECTION.RIGHT,DIRECTION.BOTTOM].includes(e)?1:-1:[DIRECTION.BOTTOM,DIRECTION.RIGHT].includes(e)?-1:1;if(r.isPolar){var t=r.x.start;return t<0?-1:1}return 1}function yi(r){var e=r.start,t=r.end;return e.x===t.x}function qn(r,e){var t=r.start,i=r.end,u=yi(r);return u?(t.y-i.y)*(e.x-t.x)>0?1:-1:(i.x-t.x)*(t.y-e.y)>0?-1:1}function ri(r,e){var t=(0,b.U2)(r,["components","axis"],{});return(0,b.b$)({},(0,b.U2)(t,["common"],{}),(0,b.b$)({},(0,b.U2)(t,[e],{})))}function Gr(r,e,t){var i=(0,b.U2)(r,["components","axis"],{});return(0,b.b$)({},(0,b.U2)(i,["common","title"],{}),(0,b.b$)({},(0,b.U2)(i,[e,"title"],{})),t)}function dn(r){var e=r.x,t=r.y,i=r.circleCenter,u=t.start>t.end,c=r.isTransposed?r.convert({x:u?0:1,y:0}):r.convert({x:0,y:u?0:1}),p=[c.x-i.x,c.y-i.y],g=[1,0],_=c.y>i.y?sa.EU(p,g):sa.EU(p,g)*-1,w=_+(e.end-e.start),k=Math.sqrt(Math.pow(c.x-i.x,2)+Math.pow(c.y-i.y,2));return{center:i,radius:k,startAngle:_,endAngle:w}}function Xn(r,e){return(0,b.jn)(r)?r===!1?!1:{}:(0,b.U2)(r,[e])}function vi(r,e){return(0,b.U2)(r,"position",e)}function Rn(r,e){return(0,b.U2)(e,["title","text"],on(r))}var Qn=function(){function r(e,t){this.destroyed=!1,this.facets=[],this.view=e,this.cfg=(0,b.b$)({},this.getDefaultCfg(),t)}return r.prototype.init=function(){this.container||(this.container=this.createContainer());var e=this.view.getData();this.facets=this.generateFacets(e)},r.prototype.render=function(){this.renderViews()},r.prototype.update=function(){},r.prototype.clear=function(){this.clearFacetViews()},r.prototype.destroy=function(){this.clear(),this.container&&(this.container.remove(!0),this.container=void 0),this.destroyed=!0,this.view=void 0,this.facets=[]},r.prototype.facetToView=function(e){var t=e.region,i=e.data,u=e.padding,c=u===void 0?this.cfg.padding:u,p=this.view.createView({region:t,padding:c});p.data(i||[]),e.view=p,this.beforeEachView(p,e);var g=this.cfg.eachView;return g&&g(p,e),this.afterEachView(p,e),p},r.prototype.createContainer=function(){var e=this.view.getLayer(W.FORE);return e.addGroup()},r.prototype.renderViews=function(){this.createFacetViews()},r.prototype.createFacetViews=function(){var e=this;return this.facets.map(function(t){return e.facetToView(t)})},r.prototype.clearFacetViews=function(){var e=this;(0,b.S6)(this.facets,function(t){t.view&&(e.view.removeView(t.view),t.view=void 0)})},r.prototype.parseSpacing=function(){var e=this.view.viewBBox,t=e.width,i=e.height,u=this.cfg.spacing;return u.map(function(c,p){return(0,b.hj)(c)?c/(p===0?t:i):parseFloat(c)/100})},r.prototype.getFieldValues=function(e,t){var i=[],u={};return(0,b.S6)(e,function(c){var p=c[t];!(0,b.UM)(p)&&!u[p]&&(i.push(p),u[p]=!0)}),i},r.prototype.getRegion=function(e,t,i,u){var c=(0,P.CR)(this.parseSpacing(),2),p=c[0],g=c[1],_=(1+p)/(t===0?1:t)-p,w=(1+g)/(e===0?1:e)-g,k={x:(_+p)*i,y:(w+g)*u},L={x:k.x+_,y:k.y+w};return{start:k,end:L}},r.prototype.getDefaultCfg=function(){return{eachView:void 0,showTitle:!0,spacing:[0,0],padding:10,fields:[]}},r.prototype.getDefaultTitleCfg=function(){var e=this.view.getTheme().fontFamily;return{style:{fontSize:14,fill:"#666",fontFamily:e}}},r.prototype.processAxis=function(e,t){var i=e.getOptions(),u=i.coordinate,c=e.geometries,p=(0,b.U2)(u,"type","rect");if(p==="rect"&&c.length){(0,b.UM)(i.axes)&&(i.axes={});var g=i.axes,_=(0,P.CR)(c[0].getXYFields(),2),w=_[0],k=_[1],L=Xn(g,w),R=Xn(g,k);L!==!1&&(i.axes[w]=this.getXAxisOption(w,g,L,t)),R!==!1&&(i.axes[k]=this.getYAxisOption(k,g,R,t))}},r.prototype.getFacetDataFilter=function(e){return function(t){return(0,b.yW)(e,function(i){var u=i.field,c=i.value;return!(0,b.UM)(c)&&u?t[u]===c:!0})}},r}(),Ti={},aa=function(r){return Ti[(0,b.vl)(r)]},_n=function(r,e){Ti[(0,b.vl)(r)]=e},An=function(){function r(e,t){this.context=e,this.cfg=t,e.addAction(this)}return r.prototype.applyCfg=function(e){(0,b.f0)(this,e)},r.prototype.init=function(){this.applyCfg(this.cfg)},r.prototype.destroy=function(){this.context.removeAction(this),this.context=null},r}(),oi=An,Ei=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.execute=function(){this.callback&&this.callback(this.context)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.callback=null},e}(oi),ti=Ei,xi={};function Mi(r,e){var t=xi[r],i=null;if(t){var u=t.ActionClass,c=t.cfg;i=new u(e,c),i.name=r,i.init()}return i}function Ua(r){var e=xi[r];return(0,b.U2)(e,"ActionClass")}function Yn(r,e,t){xi[r]={ActionClass:e,cfg:t}}function Ii(r){delete xi[r]}function Li(r,e){var t=new ti(e);return t.callback=r,t.name="callback",t}function Sa(r,e){var t=[];if(r.length){t.push(["M",r[0].x,r[0].y]);for(var i=1,u=r.length;i<u;i+=1){var c=r[i];t.push(["L",c.x,c.y])}e&&t.push(["Z"])}return t}function Da(r,e){for(var t=[r[0]],i=1,u=r.length;i<u;i=i+2){var c=e.convert({x:r[i],y:r[i+1]});t.push(c.x,c.y)}return t}function oo(r,e){var t=e.isTransposed,i=r[1],u=r[6],c=r[7],p=e.convert({x:u,y:c}),g=t?0:1;return["A",i,i,0,0,g,p.x,p.y]}function Is(r,e,t){var i=t.isTransposed,u=t.startAngle,c=t.endAngle,p=r[0].toLowerCase()==="a"?{x:r[6],y:r[7]}:{x:r[1],y:r[2]},g={x:e[1],y:e[2]},_=[],w=i?"y":"x",k=Math.abs(g[w]-p[w])*(c-u),L=g[w]>=p[w]?1:0,R=k>Math.PI?1:0,U=t.convert(g),G=$p(t,U);if(G>=.5)if(k===Math.PI*2){var Q={x:(g.x+p.x)/2,y:(g.y+p.y)/2},pt=t.convert(Q);_.push(["A",G,G,0,R,L,pt.x,pt.y]),_.push(["A",G,G,0,R,L,U.x,U.y])}else _.push(["A",G,G,0,R,L,U.x,U.y]);return _}function zs(r){(0,b.S6)(r,function(e,t){var i=e;if(i[0].toLowerCase()==="a"){var u=r[t-1],c=r[t+1];c&&c[0].toLowerCase()==="a"?u&&u[0].toLowerCase()==="l"&&(u[0]="M"):u&&u[0].toLowerCase()==="a"&&c&&c[0].toLowerCase()==="l"&&(c[0]="M")}})}var io=function(r,e,t,i){var u,c=[],p=!!i,g,_,w,k,L,R,U;if(p){u=(0,P.CR)(i,2),w=u[0],k=u[1];for(var G=0,Q=r.length;G<Q;G++){var pt=r[G];w=sa.VV([0,0],w,pt),k=sa.Fp([0,0],k,pt)}}for(var G=0,vt=r.length;G<vt;G++){var pt=r[G];if(G===0&&!t)U=pt;else if(G===vt-1&&!t)R=pt,c.push(U),c.push(R);else{g=r[t?G?G-1:vt-1:G-1],_=r[t?(G+1)%vt:G+1];var Vt=[0,0];Vt=sa.lu(Vt,_,g),Vt=sa.bA(Vt,Vt,e);var le=sa.TE(pt,g),he=sa.TE(pt,_),Ne=le+he;Ne!==0&&(le/=Ne,he/=Ne);var Er=sa.bA([0,0],Vt,-le),Fr=sa.bA([0,0],Vt,he);R=sa.IH([0,0],pt,Er),L=sa.IH([0,0],pt,Fr),L=sa.VV([0,0],L,sa.Fp([0,0],_,pt)),L=sa.Fp([0,0],L,sa.VV([0,0],_,pt)),Er=sa.lu([0,0],L,pt),Er=sa.bA([0,0],Er,-le/he),R=sa.IH([0,0],pt,Er),R=sa.VV([0,0],R,sa.Fp([0,0],g,pt)),R=sa.Fp([0,0],R,sa.VV([0,0],g,pt)),Fr=sa.lu([0,0],pt,R),Fr=sa.bA([0,0],Fr,he/le),L=sa.IH([0,0],pt,Fr),p&&(R=sa.Fp([0,0],R,w),R=sa.VV([0,0],R,k),L=sa.Fp([0,0],L,w),L=sa.VV([0,0],L,k)),c.push(U),c.push(R),U=L}}return t&&c.push(c.shift()),c};function Au(r,e,t){for(var i=!!e,u=[],c=0,p=r.length;c<p;c+=2)u.push([r[c],r[c+1]]);for(var g=io(u,.4,i,t),_=u.length,w=[],k,L,R,c=0;c<_-1;c++)k=g[c*2],L=g[c*2+1],R=u[c+1],w.push(["C",k[0],k[1],L[0],L[1],R[0],R[1]]);return i&&(k=g[_],L=g[_+1],R=u[0],w.push(["C",k[0],k[1],L[0],L[1],R[0],R[1]])),w}function Xo(r,e){return Sa(r,e)}function Qs(r,e,t){var i=[],u=r[0],c=null;if(r.length<=2)return Xo(r,e);for(var p=0,g=r.length;p<g;p++){var _=r[p];(!c||!(c.x===_.x&&c.y===_.y))&&(i.push(_.x),i.push(_.y),c=_)}var w=t||[[0,0],[1,1]],k=Au(i,e,w);return k.unshift(["M",u.x,u.y]),k}function su(r,e){var t=[];return(0,b.S6)(e,function(i){var u=i[0];switch(u.toLowerCase()){case"m":case"l":case"c":t.push(Da(i,r));break;case"a":t.push(oo(i,r));break;case"z":default:t.push(i);break}}),t}function Tu(r,e){var t=[],i,u,c,p;return(0,b.S6)(e,function(g,_){var w=g[0];switch(w.toLowerCase()){case"m":case"c":case"q":t.push(Da(g,r));break;case"l":i=e[_-1],u=g,c=r.isTransposed,p=c?i[i.length-2]===u[1]:i[i.length-1]===u[2],p?t=t.concat(Is(i,u,r)):t.push(Da(g,r));break;case"a":t.push(oo(g,r));break;case"z":default:t.push(g);break}}),zs(t),t}function Js(r,e){var t=r.event,i=t.target,u=i.getCanvasBBox();return u.width>=e||u.height>=e?u:null}function zu(r,e){var t=r.event,i=t.target,u=i.getCanvasBBox();return u.width>=e||u.height>=e?i.attr("path"):null}function Jo(r){var e=r.event,t,i=e.target;return i&&(t=i.get("element")),t}function La(r){var e=r.event,t=e.target,i;return t&&(i=t.get("delegateObject")),i}function tu(r){var e=r.event.gEvent;return!(e&&e.fromShape&&e.toShape&&e.fromShape.get("element")===e.toShape.get("element"))}function fo(r){return r&&r.component&&r.component.isList()}function Mu(r){return r&&r.component&&r.component.isSlider()}function ya(r){var e=r.event,t=e.target;return t&&t.get("name")==="mask"}function eo(r,e){var t=r.event.target;if(t.get("type")==="path"){var i=zu(r,e);return i?$e(r.view,i):void 0}var u=Js(r,e);return u?Ri(r.view,u):null}function Eo(r,e,t){var i=Js(r,t);if(!i)return null;var u=r.view,c=kr(u,e,{x:i.x,y:i.y}),p=kr(u,e,{x:i.maxX,y:i.maxY}),g={minX:c.x,minY:c.y,maxX:p.x,maxY:p.y};return Ri(e,g)}function So(r){var e=r.geometries,t=[];return(0,b.S6)(e,function(i){var u=i.elements;t=t.concat(u)}),r.views&&r.views.length&&(0,b.S6)(r.views,function(i){t=t.concat(So(i))}),t}function Po(r,e,t){var i=So(r);return i.filter(function(u){return an(u,e)===t})}function Ke(r,e){var t=r.geometries,i=[];return(0,b.S6)(t,function(u){var c=u.getElementsBy(function(p){return p.hasState(e)});i=i.concat(c)}),i}function an(r,e){var t=r.getModel(),i=t.data,u;return(0,b.kJ)(i)?u=i[0][e]:u=i[e],u}function en(r,e){return!(e.minX>r.maxX||e.maxX<r.minX||e.minY>r.maxY||e.maxY<r.minY)}function Ri(r,e){var t=So(r),i=[];return(0,b.S6)(t,function(u){var c=u.shape,p=c.getCanvasBBox();en(e,p)&&i.push(u)}),i}function so(r){var e=[];return(0,b.S6)(r,function(t){var i=t[0];if(i!=="A")for(var u=1;u<t.length;u=u+2)e.push([t[u],t[u+1]]);else{var c=t.length;e.push([t[c-2],t[c-1]])}}),e}function $e(r,e){var t=So(r),i=so(e),u=t.filter(function(c){var p=c.shape,g;if(p.get("type")==="path")g=so(p.attr("path"));else{var _=p.getCanvasBBox();g=Jf(_)}return(0,rf.Wq)(i,g)});return u}function Fe(r){return r.getComponents().map(function(e){return e.component})}function yr(r,e){var t=e.x-r.x,i=e.y-r.y;return Math.sqrt(t*t+i*i)}function Xr(r,e){if(r.length<=2)return Xo(r,!1);var t=r[0],i=[];(0,b.S6)(r,function(c){i.push(c.x),i.push(c.y)});var u=Au(i,e,null);return u.unshift(["M",t.x,t.y]),u}function sn(r,e){return r.x<=e.x&&r.maxX>=e.x&&r.y<=e.y&&r.maxY>e.y}function mr(r){var e=r.parent,t=null;return e&&(t=e.views.filter(function(i){return i!==r})),t}function pr(r,e){var t=r.getCoordinate();return t.invert(e)}function kr(r,e,t){var i=pr(r,t);return e.getCoordinate().convert(i)}function Ve(r,e,t,i){var u=!1;return(0,b.S6)(r,function(c){if(c[t]===e[t]&&c[i]===e[i])return u=!0,!1}),u}function vr(r,e){var t=r.getScaleByField(e);return!t&&r.views&&(0,b.S6)(r.views,function(i){if(t=vr(i,e),t)return!1}),t}var Qe=function(){function r(e){this.actions=[],this.event=null,this.cacheMap={},this.view=e}return r.prototype.cache=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length===1)return this.cacheMap[e[0]];e.length===2&&(this.cacheMap[e[0]]=e[1])},r.prototype.getAction=function(e){return this.actions.find(function(t){return t.name===e})},r.prototype.addAction=function(e){this.actions.push(e)},r.prototype.removeAction=function(e){var t=this.actions,i=this.actions.indexOf(e);i>=0&&t.splice(i,1)},r.prototype.getCurrentPoint=function(){var e=this.event;if(e)if(e.target instanceof HTMLElement){var t=this.view.getCanvas(),i=t.getPointByClient(e.clientX,e.clientY);return i}else return{x:e.x,y:e.y};return null},r.prototype.getCurrentShape=function(){return(0,b.U2)(this.event,["gEvent","shape"])},r.prototype.isInPlot=function(){var e=this.getCurrentPoint();return e?this.view.isPointInPlot(e):!1},r.prototype.isInShape=function(e){var t=this.getCurrentShape();return t?t.get("name")===e:!1},r.prototype.isInComponent=function(e){var t=Fe(this.view),i=this.getCurrentPoint();return i?!!t.find(function(u){var c=u.getBBox();return e?u.get("name")===e&&sn(c,i):sn(c,i)}):!1},r.prototype.destroy=function(){(0,b.S6)(this.actions.slice(),function(e){e.destroy()}),this.view=null,this.event=null,this.actions=null,this.cacheMap=null},r}(),Hr=Qe,Jr=function(){function r(e,t){this.view=e,this.cfg=t}return r.prototype.init=function(){this.initEvents()},r.prototype.initEvents=function(){},r.prototype.clearEvents=function(){},r.prototype.destroy=function(){this.clearEvents()},r}(),Bn=Jr;function gi(r,e,t){var i=r.split(":"),u=i[0],c=e.getAction(u)||Mi(u,e);if(!c)throw new Error("There is no action named ".concat(u));var p=i[1];return{action:c,methodName:p,arg:t}}function mi(r){var e=r.action,t=r.methodName,i=r.arg;if(e[t])e[t](i);else throw new Error("Action(".concat(e.name,") doesn't have a method called ").concat(t))}var pi={START:"start",SHOW_ENABLE:"showEnable",END:"end",ROLLBACK:"rollback",PROCESSING:"processing"},fi=function(r){(0,P.ZT)(e,r);function e(t,i){var u=r.call(this,t,i)||this;return u.callbackCaches={},u.emitCaches={},u.steps=i,u}return e.prototype.init=function(){this.initContext(),r.prototype.init.call(this)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.steps=null,this.context&&(this.context.destroy(),this.context=null),this.callbackCaches=null,this.view=null},e.prototype.initEvents=function(){var t=this;(0,b.S6)(this.steps,function(i,u){(0,b.S6)(i,function(c){var p=t.getActionCallback(u,c);p&&t.bindEvent(c.trigger,p)})})},e.prototype.clearEvents=function(){var t=this;(0,b.S6)(this.steps,function(i,u){(0,b.S6)(i,function(c){var p=t.getActionCallback(u,c);p&&t.offEvent(c.trigger,p)})})},e.prototype.initContext=function(){var t=this.view,i=new Hr(t);this.context=i;var u=this.steps;(0,b.S6)(u,function(c){(0,b.S6)(c,function(p){if((0,b.mf)(p.action))p.actionObject={action:Li(p.action,i),methodName:"execute"};else if((0,b.HD)(p.action))p.actionObject=gi(p.action,i,p.arg);else if((0,b.kJ)(p.action)){var g=p.action,_=(0,b.kJ)(p.arg)?p.arg:[p.arg];p.actionObject=[],(0,b.S6)(g,function(w,k){p.actionObject.push(gi(w,i,_[k]))})}})})},e.prototype.isAllowStep=function(t){var i=this.currentStepName,u=this.steps;if(i===t||t===pi.SHOW_ENABLE)return!0;if(t===pi.PROCESSING)return i===pi.START;if(t===pi.START)return i!==pi.PROCESSING;if(t===pi.END)return i===pi.PROCESSING||i===pi.START;if(t===pi.ROLLBACK){if(u[pi.END])return i===pi.END;if(i===pi.START)return!0}return!1},e.prototype.isAllowExecute=function(t,i){if(this.isAllowStep(t)){var u=this.getKey(t,i);return i.once&&this.emitCaches[u]?!1:i.isEnable?i.isEnable(this.context):!0}return!1},e.prototype.enterStep=function(t){this.currentStepName=t,this.emitCaches={}},e.prototype.afterExecute=function(t,i){t!==pi.SHOW_ENABLE&&this.currentStepName!==t&&this.enterStep(t);var u=this.getKey(t,i);this.emitCaches[u]=!0},e.prototype.getKey=function(t,i){return t+i.trigger+i.action},e.prototype.getActionCallback=function(t,i){var u=this,c=this.context,p=this.callbackCaches,g=i.actionObject;if(i.action&&g){var _=this.getKey(t,i);if(!p[_]){var w=function(k){c.event=k,u.isAllowExecute(t,i)?((0,b.kJ)(g)?(0,b.S6)(g,function(L){c.event=k,mi(L)}):(c.event=k,mi(g)),u.afterExecute(t,i),i.callback&&(c.event=k,i.callback(c))):c.event=null};i.debounce?p[_]=(0,b.Ds)(w,i.debounce.wait,i.debounce.immediate):i.throttle?p[_]=(0,b.P2)(w,i.throttle.wait,{leading:i.throttle.leading,trailing:i.throttle.trailing}):p[_]=w}return p[_]}return null},e.prototype.bindEvent=function(t,i){var u=t.split(":");u[0]==="window"?window.addEventListener(u[1],i):u[0]==="document"?document.addEventListener(u[1],i):this.view.on(t,i)},e.prototype.offEvent=function(t,i){var u=t.split(":");u[0]==="window"?window.removeEventListener(u[1],i):u[0]==="document"?document.removeEventListener(u[1],i):this.view.off(t,i)},e}(Bn),Xi=fi,Pi={};function Gi(r){return Pi[(0,b.vl)(r)]}function kn(r,e){Pi[(0,b.vl)(r)]=e}function Ni(r,e,t){var i=Gi(r);if(!i)return null;if((0,b.PO)(i)){var u=(0,b.CD)((0,b.d9)(i),t);return new Xi(e,u)}else{var c=i;return new c(e,t)}}function Ea(r){return{title:{autoRotate:!0,position:"center",spacing:r.axisTitleSpacing,style:{fill:r.axisTitleTextFillColor,fontSize:r.axisTitleTextFontSize,lineHeight:r.axisTitleTextLineHeight,textBaseline:"middle",fontFamily:r.fontFamily},iconStyle:{fill:r.axisDescriptionIconFillColor}},label:{autoRotate:!1,autoEllipsis:!1,autoHide:{type:"equidistance",cfg:{minGap:6}},offset:r.axisLabelOffset,style:{fill:r.axisLabelFillColor,fontSize:r.axisLabelFontSize,lineHeight:r.axisLabelLineHeight,fontFamily:r.fontFamily}},line:{style:{lineWidth:r.axisLineBorder,stroke:r.axisLineBorderColor}},grid:{line:{type:"line",style:{stroke:r.axisGridBorderColor,lineWidth:r.axisGridBorder,lineDash:r.axisGridLineDash}},alignTick:!0,animate:!0},tickLine:{style:{lineWidth:r.axisTickLineBorder,stroke:r.axisTickLineBorderColor},alignTick:!0,length:r.axisTickLineLength},subTickLine:null,animate:!0}}function jo(r){return{title:null,marker:{symbol:"circle",spacing:r.legendMarkerSpacing,style:{r:r.legendCircleMarkerSize,fill:r.legendMarkerColor}},itemName:{spacing:5,style:{fill:r.legendItemNameFillColor,fontFamily:r.fontFamily,fontSize:r.legendItemNameFontSize,lineHeight:r.legendItemNameLineHeight,fontWeight:r.legendItemNameFontWeight,textAlign:"start",textBaseline:"middle"}},itemStates:{active:{nameStyle:{opacity:.8}},unchecked:{nameStyle:{fill:"#D8D8D8"},markerStyle:{fill:"#D8D8D8",stroke:"#D8D8D8"}},inactive:{nameStyle:{fill:"#D8D8D8"},markerStyle:{opacity:.2}}},flipPage:!0,pageNavigator:{marker:{style:{size:r.legendPageNavigatorMarkerSize,inactiveFill:r.legendPageNavigatorMarkerInactiveFillColor,inactiveOpacity:r.legendPageNavigatorMarkerInactiveFillOpacity,fill:r.legendPageNavigatorMarkerFillColor,opacity:r.legendPageNavigatorMarkerFillOpacity}},text:{style:{fill:r.legendPageNavigatorTextFillColor,fontSize:r.legendPageNavigatorTextFontSize}}},animate:!1,maxItemWidth:200,itemSpacing:r.legendItemSpacing,itemMarginBottom:r.legendItemMarginBottom,padding:r.legendPadding}}function Iu(r){var e,t={point:{default:{fill:r.pointFillColor,r:r.pointSize,stroke:r.pointBorderColor,lineWidth:r.pointBorder,fillOpacity:r.pointFillOpacity},active:{stroke:r.pointActiveBorderColor,lineWidth:r.pointActiveBorder},selected:{stroke:r.pointSelectedBorderColor,lineWidth:r.pointSelectedBorder},inactive:{fillOpacity:r.pointInactiveFillOpacity,strokeOpacity:r.pointInactiveBorderOpacity}},hollowPoint:{default:{fill:r.hollowPointFillColor,lineWidth:r.hollowPointBorder,stroke:r.hollowPointBorderColor,strokeOpacity:r.hollowPointBorderOpacity,r:r.hollowPointSize},active:{stroke:r.hollowPointActiveBorderColor,strokeOpacity:r.hollowPointActiveBorderOpacity},selected:{lineWidth:r.hollowPointSelectedBorder,stroke:r.hollowPointSelectedBorderColor,strokeOpacity:r.hollowPointSelectedBorderOpacity},inactive:{strokeOpacity:r.hollowPointInactiveBorderOpacity}},area:{default:{fill:r.areaFillColor,fillOpacity:r.areaFillOpacity,stroke:null},active:{fillOpacity:r.areaActiveFillOpacity},selected:{fillOpacity:r.areaSelectedFillOpacity},inactive:{fillOpacity:r.areaInactiveFillOpacity}},hollowArea:{default:{fill:null,stroke:r.hollowAreaBorderColor,lineWidth:r.hollowAreaBorder,strokeOpacity:r.hollowAreaBorderOpacity},active:{fill:null,lineWidth:r.hollowAreaActiveBorder},selected:{fill:null,lineWidth:r.hollowAreaSelectedBorder},inactive:{strokeOpacity:r.hollowAreaInactiveBorderOpacity}},interval:{default:{fill:r.intervalFillColor,fillOpacity:r.intervalFillOpacity},active:{stroke:r.intervalActiveBorderColor,lineWidth:r.intervalActiveBorder},selected:{stroke:r.intervalSelectedBorderColor,lineWidth:r.intervalSelectedBorder},inactive:{fillOpacity:r.intervalInactiveFillOpacity,strokeOpacity:r.intervalInactiveBorderOpacity}},hollowInterval:{default:{fill:r.hollowIntervalFillColor,stroke:r.hollowIntervalBorderColor,lineWidth:r.hollowIntervalBorder,strokeOpacity:r.hollowIntervalBorderOpacity},active:{stroke:r.hollowIntervalActiveBorderColor,lineWidth:r.hollowIntervalActiveBorder,strokeOpacity:r.hollowIntervalActiveBorderOpacity},selected:{stroke:r.hollowIntervalSelectedBorderColor,lineWidth:r.hollowIntervalSelectedBorder,strokeOpacity:r.hollowIntervalSelectedBorderOpacity},inactive:{stroke:r.hollowIntervalInactiveBorderColor,lineWidth:r.hollowIntervalInactiveBorder,strokeOpacity:r.hollowIntervalInactiveBorderOpacity}},line:{default:{stroke:r.lineBorderColor,lineWidth:r.lineBorder,strokeOpacity:r.lineBorderOpacity,fill:null,lineAppendWidth:10,lineCap:"round",lineJoin:"round"},active:{lineWidth:r.lineActiveBorder},selected:{lineWidth:r.lineSelectedBorder},inactive:{strokeOpacity:r.lineInactiveBorderOpacity}}},i=Ea(r),u=jo(r);return{background:r.backgroundColor,defaultColor:r.brandColor,subColor:r.subColor,semanticRed:r.paletteSemanticRed,semanticGreen:r.paletteSemanticGreen,padding:"auto",fontFamily:r.fontFamily,columnWidthRatio:1/2,maxColumnWidth:null,minColumnWidth:null,roseWidthRatio:.9999999,multiplePieWidthRatio:1/1.3,colors10:r.paletteQualitative10,colors20:r.paletteQualitative20,sequenceColors:r.paletteSequence,shapes:{point:["hollow-circle","hollow-square","hollow-bowtie","hollow-diamond","hollow-hexagon","hollow-triangle","hollow-triangle-down","circle","square","bowtie","diamond","hexagon","triangle","triangle-down","cross","tick","plus","hyphen","line"],line:["line","dash","dot","smooth"],area:["area","smooth","line","smooth-line"],interval:["rect","hollow-rect","line","tick"]},sizes:[1,10],geometries:{interval:{rect:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:function(c){var p=c.geometry.coordinate;if(p.isPolar&&p.isTransposed){var g=Xp(c.getModel(),p),_=g.startAngle,w=g.endAngle,k=(_+w)/2,L=7.5,R=L*Math.cos(k),U=L*Math.sin(k);return{matrix:ma.vs(null,[["t",R,U]])}}return t.interval.selected}}},"hollow-rect":{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},line:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},tick:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},funnel:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}},pyramid:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}}},line:{line:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},dot:{default:{style:(0,P.pi)((0,P.pi)({},t.line.default),{lineCap:null,lineDash:[1,1]})},active:{style:(0,P.pi)((0,P.pi)({},t.line.active),{lineCap:null,lineDash:[1,1]})},inactive:{style:(0,P.pi)((0,P.pi)({},t.line.inactive),{lineCap:null,lineDash:[1,1]})},selected:{style:(0,P.pi)((0,P.pi)({},t.line.selected),{lineCap:null,lineDash:[1,1]})}},dash:{default:{style:(0,P.pi)((0,P.pi)({},t.line.default),{lineCap:null,lineDash:[5.5,1]})},active:{style:(0,P.pi)((0,P.pi)({},t.line.active),{lineCap:null,lineDash:[5.5,1]})},inactive:{style:(0,P.pi)((0,P.pi)({},t.line.inactive),{lineCap:null,lineDash:[5.5,1]})},selected:{style:(0,P.pi)((0,P.pi)({},t.line.selected),{lineCap:null,lineDash:[5.5,1]})}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vh:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hvh:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vhv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}}},polygon:{polygon:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}}},point:{circle:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},square:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},bowtie:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},diamond:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},hexagon:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},triangle:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},"triangle-down":{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},"hollow-circle":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-square":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-bowtie":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-diamond":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-hexagon":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-triangle":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-triangle-down":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},cross:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},tick:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},plus:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},hyphen:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},line:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}}},area:{area:{default:{style:t.area.default},active:{style:t.area.active},inactive:{style:t.area.inactive},selected:{style:t.area.selected}},smooth:{default:{style:t.area.default},active:{style:t.area.active},inactive:{style:t.area.inactive},selected:{style:t.area.selected}},line:{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}},"smooth-line":{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}}},schema:{candle:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},box:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}}},edge:{line:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vhv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},arc:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}}},violin:{violin:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hollow:{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}},"hollow-smooth":{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}}}},components:{axis:{common:i,top:{position:"top",grid:null,title:null,verticalLimitLength:1/2},bottom:{position:"bottom",grid:null,title:null,verticalLimitLength:1/2},left:{position:"left",title:null,line:null,tickLine:null,verticalLimitLength:1/3},right:{position:"right",title:null,line:null,tickLine:null,verticalLimitLength:1/3},circle:{title:null,grid:(0,b.b$)({},i.grid,{line:{type:"line"}})},radius:{title:null,grid:(0,b.b$)({},i.grid,{line:{type:"circle"}})}},legend:{common:u,right:{layout:"vertical",padding:r.legendVerticalPadding},left:{layout:"vertical",padding:r.legendVerticalPadding},top:{layout:"horizontal",padding:r.legendHorizontalPadding},bottom:{layout:"horizontal",padding:r.legendHorizontalPadding},continuous:{title:null,background:null,track:{},rail:{type:"color",size:r.sliderRailHeight,defaultLength:r.sliderRailWidth,style:{fill:r.sliderRailFillColor,stroke:r.sliderRailBorderColor,lineWidth:r.sliderRailBorder}},label:{align:"rail",spacing:4,formatter:null,style:{fill:r.sliderLabelTextFillColor,fontSize:r.sliderLabelTextFontSize,lineHeight:r.sliderLabelTextLineHeight,textBaseline:"middle",fontFamily:r.fontFamily}},handler:{size:r.sliderHandlerWidth,style:{fill:r.sliderHandlerFillColor,stroke:r.sliderHandlerBorderColor}},slidable:!0,padding:u.padding}},tooltip:{showContent:!0,follow:!0,showCrosshairs:!1,showMarkers:!0,shared:!1,enterable:!1,position:"auto",marker:{symbol:"circle",stroke:"#fff",shadowBlur:10,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(0,0,0,0.09)",lineWidth:2,r:4},crosshairs:{line:{style:{stroke:r.tooltipCrosshairsBorderColor,lineWidth:r.tooltipCrosshairsBorder}},text:null,textBackground:{padding:2,style:{fill:"rgba(0, 0, 0, 0.25)",lineWidth:0,stroke:null}},follow:!1},domStyles:(e={},e["".concat(ef)]={position:"absolute",visibility:"hidden",zIndex:8,transition:"left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s",backgroundColor:r.tooltipContainerFillColor,opacity:r.tooltipContainerFillOpacity,boxShadow:r.tooltipContainerShadow,borderRadius:"".concat(r.tooltipContainerBorderRadius,"px"),color:r.tooltipTextFillColor,fontSize:"".concat(r.tooltipTextFontSize,"px"),fontFamily:r.fontFamily,lineHeight:"".concat(r.tooltipTextLineHeight,"px"),padding:"0 12px 0 12px"},e["".concat(Cl)]={marginBottom:"12px",marginTop:"12px"},e["".concat(Pc)]={margin:0,listStyleType:"none",padding:0},e["".concat(Vp)]={listStyleType:"none",padding:0,marginBottom:"12px",marginTop:"12px",marginLeft:0,marginRight:0},e["".concat(wh)]={width:"8px",height:"8px",borderRadius:"50%",display:"inline-block",marginRight:"8px"},e["".concat(fv)]={display:"inline-block",float:"right",marginLeft:"30px"},e)},annotation:{arc:{style:{stroke:r.annotationArcBorderColor,lineWidth:r.annotationArcBorder},animate:!0},line:{style:{stroke:r.annotationLineBorderColor,lineDash:r.annotationLineDash,lineWidth:r.annotationLineBorder},text:{position:"start",autoRotate:!0,style:{fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,textAlign:"start",fontFamily:r.fontFamily,textBaseline:"bottom"}},animate:!0},text:{style:{fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,textBaseline:"middle",textAlign:"start",fontFamily:r.fontFamily},animate:!0},region:{top:!1,style:{lineWidth:r.annotationRegionBorder,stroke:r.annotationRegionBorderColor,fill:r.annotationRegionFillColor,fillOpacity:r.annotationRegionFillOpacity},animate:!0},image:{top:!1,animate:!0},dataMarker:{top:!0,point:{style:{r:3,stroke:r.brandColor,lineWidth:2}},line:{style:{stroke:r.annotationLineBorderColor,lineWidth:r.annotationLineBorder},length:r.annotationDataMarkerLineLength},text:{style:{textAlign:"start",fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,fontFamily:r.fontFamily}},direction:"upward",autoAdjust:!0,animate:!0},dataRegion:{style:{region:{fill:r.annotationRegionFillColor,fillOpacity:r.annotationRegionFillOpacity},text:{textAlign:"center",textBaseline:"bottom",fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,fontFamily:r.fontFamily}},animate:!0}},slider:{common:{padding:[8,8,8,8],backgroundStyle:{fill:r.cSliderBackgroundFillColor,opacity:r.cSliderBackgroundFillOpacity},foregroundStyle:{fill:r.cSliderForegroundFillColor,opacity:r.cSliderForegroundFillOpacity},handlerStyle:{width:r.cSliderHandlerWidth,height:r.cSliderHandlerHeight,fill:r.cSliderHandlerFillColor,opacity:r.cSliderHandlerFillOpacity,stroke:r.cSliderHandlerBorderColor,lineWidth:r.cSliderHandlerBorder,radius:r.cSliderHandlerBorderRadius,highLightFill:r.cSliderHandlerHighlightFillColor},textStyle:{fill:r.cSliderTextFillColor,opacity:r.cSliderTextFillOpacity,fontSize:r.cSliderTextFontSize,lineHeight:r.cSliderTextLineHeight,fontWeight:r.cSliderTextFontWeight,stroke:r.cSliderTextBorderColor,lineWidth:r.cSliderTextBorder}}},scrollbar:{common:{padding:[8,8,8,8]},default:{style:{trackColor:r.scrollbarTrackFillColor,thumbColor:r.scrollbarThumbFillColor}},hover:{style:{thumbColor:r.scrollbarThumbHighlightFillColor}}}},labels:{offset:12,style:{fill:r.labelFillColor,fontSize:r.labelFontSize,fontFamily:r.fontFamily,stroke:r.labelBorderColor,lineWidth:r.labelBorder},fillColorDark:r.labelFillColorDark,fillColorLight:r.labelFillColorLight,autoRotate:!0},innerLabels:{style:{fill:r.innerLabelFillColor,fontSize:r.innerLabelFontSize,fontFamily:r.fontFamily,stroke:r.innerLabelBorderColor,lineWidth:r.innerLabelBorder},autoRotate:!0},overflowLabels:{style:{fill:r.overflowLabelFillColor,fontSize:r.overflowLabelFontSize,fontFamily:r.fontFamily,stroke:r.overflowLabelBorderColor,lineWidth:r.overflowLabelBorder}},pieLabels:{labelHeight:14,offset:10,labelLine:{style:{lineWidth:r.labelLineBorder}},autoRotate:!0}}}var _a={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},mo={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},Oc=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],Al=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],lf=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],Zl=function(r){r===void 0&&(r={});var e=r.paletteQualitative10,t=e===void 0?Oc:e,i=r.paletteQualitative20,u=i===void 0?Al:i,c=r.brandColor,p=c===void 0?t[0]:c,g={backgroundColor:"transparent",brandColor:p,subColor:"rgba(0,0,0,0.05)",paletteQualitative10:t,paletteQualitative20:u,paletteSemanticRed:"#F4664A",paletteSemanticGreen:"#30BF78",paletteSemanticYellow:"#FAAD14",paletteSequence:lf,fontFamily:`"Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`,axisLineBorderColor:_a[25],axisLineBorder:1,axisLineDash:null,axisTitleTextFillColor:_a[65],axisTitleTextFontSize:12,axisTitleTextLineHeight:12,axisTitleTextFontWeight:"normal",axisTitleSpacing:12,axisDescriptionIconFillColor:mo[85],axisTickLineBorderColor:_a[25],axisTickLineLength:4,axisTickLineBorder:1,axisSubTickLineBorderColor:_a[15],axisSubTickLineLength:2,axisSubTickLineBorder:1,axisLabelFillColor:_a[45],axisLabelFontSize:12,axisLabelLineHeight:12,axisLabelFontWeight:"normal",axisLabelOffset:8,axisGridBorderColor:_a[15],axisGridBorder:1,axisGridLineDash:null,legendTitleTextFillColor:_a[45],legendTitleTextFontSize:12,legendTitleTextLineHeight:21,legendTitleTextFontWeight:"normal",legendMarkerColor:p,legendMarkerSpacing:8,legendMarkerSize:4,legendCircleMarkerSize:4,legendSquareMarkerSize:4,legendLineMarkerSize:5,legendItemNameFillColor:_a[65],legendItemNameFontSize:12,legendItemNameLineHeight:12,legendItemNameFontWeight:"normal",legendItemSpacing:24,legendItemMarginBottom:12,legendPadding:[8,8,8,8],legendHorizontalPadding:[8,0,8,0],legendVerticalPadding:[0,8,0,8],legendPageNavigatorMarkerSize:12,legendPageNavigatorMarkerInactiveFillColor:_a[100],legendPageNavigatorMarkerInactiveFillOpacity:.45,legendPageNavigatorMarkerFillColor:_a[100],legendPageNavigatorMarkerFillOpacity:1,legendPageNavigatorTextFillColor:_a[45],legendPageNavigatorTextFontSize:12,sliderRailFillColor:_a[15],sliderRailBorder:0,sliderRailBorderColor:null,sliderRailWidth:100,sliderRailHeight:12,sliderLabelTextFillColor:_a[45],sliderLabelTextFontSize:12,sliderLabelTextLineHeight:12,sliderLabelTextFontWeight:"normal",sliderHandlerFillColor:_a[6],sliderHandlerWidth:10,sliderHandlerHeight:14,sliderHandlerBorder:1,sliderHandlerBorderColor:_a[25],annotationArcBorderColor:_a[15],annotationArcBorder:1,annotationLineBorderColor:_a[25],annotationLineBorder:1,annotationLineDash:null,annotationTextFillColor:_a[65],annotationTextFontSize:12,annotationTextLineHeight:12,annotationTextFontWeight:"normal",annotationTextBorderColor:null,annotationTextBorder:0,annotationRegionFillColor:_a[100],annotationRegionFillOpacity:.06,annotationRegionBorder:0,annotationRegionBorderColor:null,annotationDataMarkerLineLength:16,tooltipCrosshairsBorderColor:_a[25],tooltipCrosshairsBorder:1,tooltipCrosshairsLineDash:null,tooltipContainerFillColor:"rgb(255, 255, 255)",tooltipContainerFillOpacity:.95,tooltipContainerShadow:"0px 0px 10px #aeaeae",tooltipContainerBorderRadius:3,tooltipTextFillColor:_a[65],tooltipTextFontSize:12,tooltipTextLineHeight:12,tooltipTextFontWeight:"bold",labelFillColor:_a[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,labelLineHeight:12,labelFontWeight:"normal",labelBorderColor:null,labelBorder:0,innerLabelFillColor:mo[100],innerLabelFontSize:12,innerLabelLineHeight:12,innerLabelFontWeight:"normal",innerLabelBorderColor:null,innerLabelBorder:0,overflowLabelFillColor:_a[65],overflowLabelFontSize:12,overflowLabelLineHeight:12,overflowLabelFontWeight:"normal",overflowLabelBorderColor:mo[100],overflowLabelBorder:1,labelLineBorder:1,labelLineBorderColor:_a[25],cSliderRailHieght:16,cSliderBackgroundFillColor:"#416180",cSliderBackgroundFillOpacity:.05,cSliderForegroundFillColor:"#5B8FF9",cSliderForegroundFillOpacity:.15,cSliderHandlerHeight:24,cSliderHandlerWidth:10,cSliderHandlerFillColor:"#F7F7F7",cSliderHandlerFillOpacity:1,cSliderHandlerHighlightFillColor:"#FFF",cSliderHandlerBorderColor:"#BFBFBF",cSliderHandlerBorder:1,cSliderHandlerBorderRadius:2,cSliderTextFillColor:"#000",cSliderTextFillOpacity:.45,cSliderTextFontSize:12,cSliderTextLineHeight:12,cSliderTextFontWeight:"normal",cSliderTextBorderColor:null,cSliderTextBorder:0,scrollbarTrackFillColor:"rgba(0,0,0,0)",scrollbarThumbFillColor:"rgba(0,0,0,0.15)",scrollbarThumbHighlightFillColor:"rgba(0,0,0,0.2)",pointFillColor:p,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:mo[100],pointBorderOpacity:1,pointActiveBorderColor:_a[100],pointSelectedBorder:2,pointSelectedBorderColor:_a[100],pointInactiveFillOpacity:.3,pointInactiveBorderOpacity:.3,hollowPointSize:4,hollowPointBorder:1,hollowPointBorderColor:p,hollowPointBorderOpacity:.95,hollowPointFillColor:mo[100],hollowPointActiveBorder:1,hollowPointActiveBorderColor:_a[100],hollowPointActiveBorderOpacity:1,hollowPointSelectedBorder:2,hollowPointSelectedBorderColor:_a[100],hollowPointSelectedBorderOpacity:1,hollowPointInactiveBorderOpacity:.3,lineBorder:2,lineBorderColor:p,lineBorderOpacity:1,lineActiveBorder:3,lineSelectedBorder:3,lineInactiveBorderOpacity:.3,areaFillColor:p,areaFillOpacity:.25,areaActiveFillColor:p,areaActiveFillOpacity:.5,areaSelectedFillColor:p,areaSelectedFillOpacity:.5,areaInactiveFillOpacity:.3,hollowAreaBorderColor:p,hollowAreaBorder:2,hollowAreaBorderOpacity:1,hollowAreaActiveBorder:3,hollowAreaActiveBorderColor:_a[100],hollowAreaSelectedBorder:3,hollowAreaSelectedBorderColor:_a[100],hollowAreaInactiveBorderOpacity:.3,intervalFillColor:p,intervalFillOpacity:.95,intervalActiveBorder:1,intervalActiveBorderColor:_a[100],intervalActiveBorderOpacity:1,intervalSelectedBorder:2,intervalSelectedBorderColor:_a[100],intervalSelectedBorderOpacity:1,intervalInactiveBorderOpacity:.3,intervalInactiveFillOpacity:.3,hollowIntervalBorder:2,hollowIntervalBorderColor:p,hollowIntervalBorderOpacity:1,hollowIntervalFillColor:mo[100],hollowIntervalActiveBorder:2,hollowIntervalActiveBorderColor:_a[100],hollowIntervalSelectedBorder:3,hollowIntervalSelectedBorderColor:_a[100],hollowIntervalSelectedBorderOpacity:1,hollowIntervalInactiveBorderOpacity:.3};return(0,P.pi)((0,P.pi)({},g),r)},Y0=Zl();function Ll(r){var e=r.styleSheet,t=e===void 0?{}:e,i=(0,P._T)(r,["styleSheet"]),u=Zl(t);return(0,b.b$)({},Iu(u),i)}var rh=Ll({}),cp={default:rh};function gv(r){return(0,b.U2)(cp,(0,b.vl)(r),cp.default)}function ku(r,e){cp[(0,b.vl)(r)]=Ll(e)}function mv(r,e,t){var i=t.translate(r),u=t.translate(e);return(0,b.vQ)(i,u)}function Mh(r,e){var t=e.coordinate,i=e.getXScale(),u=i.range,c=u[u.length-1],p=u[0],g=t.invert(r),_=g.x;return t.isPolar&&_>(1+c)/2&&(_=p),i.translate(i.invert(_))}function i0(r,e,t){var i=t.coordinate,u=t.getYScale(),c=u.field,p=i.invert(e),g=u.invert(p.y),_=(0,b.sE)(r,function(w){var k=w[ge];return k[c][0]<=g&&k[c][1]>=g});return _||r[r.length-1]}var $0=(0,b.HP)(function(r){if(r.isCategory)return 1;for(var e=r.values,t=e.length,i=r.translate(e[0]),u=i,c=0;c<t;c++){var p=e[c],g=r.translate(p);g<i&&(i=g),g>u&&(u=g)}return(u-i)/(t-1)});function Zg(r,e,t){var i=e.getAttribute("position"),u=i.getFields(),c=e.scales,p=(0,b.mf)(t)||!t?u[0]:t,g=c[p],_=g?g.getText(r[p]):r[p]||p;return(0,b.mf)(t)?t(_,r):_}function Kp(r){var e=(0,b.VO)(r.attributes);return(0,b.hX)(e,function(t){return(0,b.FX)(_e,t.type)})}function Ih(r){var e,t,i=Kp(r),u;try{for(var c=(0,P.XA)(i),p=c.next();!p.done;p=c.next()){var g=p.value,_=g.getScale(g.type);if(_&&_.isLinear){var w=(0,b.U2)(r.scaleDefs,_.field),k=dr(_,w,g.type,r.type);if(k!=="cat"){u=_;break}}}}catch(U){e={error:U}}finally{try{p&&!p.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}var L=r.getXScale(),R=r.getYScale();return u||R||L}function jm(r,e){var t=e.field,i=r[t];if((0,b.kJ)(i)){var u=i.map(function(c){return e.getText(c)});return u.join("-")}return e.getText(i)}function Vg(r,e){var t,i=e.getGroupScales();if(i.length&&(t=i[0]),t){var u=t.field;return t.getText(r[u])}var c=Ih(e);return on(c)}function Gg(r,e,t){if(e.length===0)return null;var i=t.type,u=t.getXScale(),c=t.getYScale(),p=u.field,g=c.field,_=null;if(i==="heatmap"||i==="point"){for(var w=t.coordinate,k=w.invert(r),L=u.invert(k.x),R=c.invert(k.y),U=1/0,G=0;G<e.length;G++){var Q=e[G],pt=Q[ge],vt=Math.pow(pt[p]-L,2)+Math.pow(pt[g]-R,2);vt<U&&(U=vt,_=Q)}return _}var Vt=e[0],le=e[e.length-1],he=Mh(r,t),Ne=Vt[ge][p],Er=Vt[ge][g],Fr=le[ge][p],zr=c.isLinear&&(0,b.kJ)(Er);if((0,b.kJ)(Ne)){for(var G=0;G<e.length;G++){var pn=e[G],pt=pn[ge];if(u.translate(pt[p][0])<=he&&u.translate(pt[p][1])>=he)if(zr)(0,b.kJ)(_)||(_=[]),_.push(pn);else{_=pn;break}}(0,b.kJ)(_)&&(_=i0(_,r,t))}else{var nn=void 0;if(!u.isLinear&&u.type!=="timeCat"){for(var G=0;G<e.length;G++){var pn=e[G],pt=pn[ge];if(mv(pt[p],he,u))if(zr)(0,b.kJ)(_)||(_=[]),_.push(pn);else{_=pn;break}else u.translate(pt[p])<=he&&(le=pn,nn=e[G+1])}(0,b.kJ)(_)&&(_=i0(_,r,t))}else{if((he>u.translate(Fr)||he<u.translate(Ne))&&(he>u.max||he<u.min))return null;for(var Pn=0,Si=e.length-1,ha=void 0;Pn<=Si;){ha=Math.floor((Pn+Si)/2);var wa=e[ha][ge][p];if(mv(wa,he,u))return e[ha];u.translate(wa)<=u.translate(he)?(Pn=ha+1,le=e[ha],nn=e[ha+1]):(Si===0&&(le=e[0]),Si=ha-1)}}le&&nn&&Math.abs(u.translate(le[ge][p])-he)>Math.abs(u.translate(nn[ge][p])-he)&&(le=nn)}var _o=$0(t.getXScale());return!_&&Math.abs(u.translate(le[ge][p])-he)<=_o/2&&(_=le),_}function Lu(r,e,t,i){var u,c;t===void 0&&(t=""),i===void 0&&(i=!1);var p=r[ge],g=Zg(p,e,t),_=e.tooltipOption,w=e.theme.defaultColor,k=[],L,R;function U(pn,nn){if(i||!(0,b.UM)(nn)&&nn!==""){var Pn={title:g,data:p,mappingData:r,name:pn,value:nn,color:r.color||w,marker:!0};k.push(Pn)}}if((0,b.Kn)(_)){var G=_.fields,Q=_.callback;if(Q){var pt=G.map(function(pn){return r[ge][pn]}),vt=Q.apply(void 0,(0,P.ev)([],(0,P.CR)(pt),!1)),Vt=(0,P.pi)({data:r[ge],mappingData:r,title:g,color:r.color||w,marker:!0},vt);k.push(Vt)}else{var le=e.scales;try{for(var he=(0,P.XA)(G),Ne=he.next();!Ne.done;Ne=he.next()){var Er=Ne.value;if(!(0,b.UM)(p[Er])){var Fr=le[Er];L=on(Fr),R=Fr.getText(p[Er]),U(L,R)}}}catch(pn){u={error:pn}}finally{try{Ne&&!Ne.done&&(c=he.return)&&c.call(he)}finally{if(u)throw u.error}}}}else{var zr=Ih(e);R=jm(p,zr),L=Vg(p,e),U(L,R)}return k}function Vl(r,e,t,i){var u,c,p=i.showNil,g=[],_=r.dataArray;if(!(0,b.xb)(_)){r.sort(_);try{for(var w=(0,P.XA)(_),k=w.next();!k.done;k=w.next()){var L=k.value,R=Gg(e,L,r);if(R){var U=r.getElementId(R),G=r.elementsMap[U];if(r.type==="heatmap"||G.visible){var Q=Lu(R,r,t,p);Q.length&&g.push(Q)}}}}catch(pt){u={error:pt}}finally{try{k&&!k.done&&(c=w.return)&&c.call(w)}finally{if(u)throw u.error}}}return g}function q0(r,e,t,i){var u=i.showNil,c=[],p=r.container,g=p.getShape(e.x,e.y);if(g&&g.get("visible")&&g.get("origin")){var _=g.get("origin").mappingData,w=Lu(_,r,t,u);w.length&&c.push(w)}return c}function f(r,e,t){var i,u,c=[],p=r.geometries,g=t.shared,_=t.title,w=t.reversed;try{for(var k=(0,P.XA)(p),L=k.next();!L.done;L=k.next()){var R=L.value;if(R.visible&&R.tooltipOption!==!1){var U=R.type,G=void 0;["point","edge","polygon"].includes(U)?G=q0(R,e,_,t):["area","line","path","heatmap"].includes(U)||g!==!1?G=Vl(R,e,_,t):G=q0(R,e,_,t),G.length&&(w&&G.reverse(),c.push(G))}}}catch(Q){i={error:Q}}finally{try{L&&!L.done&&(u=k.return)&&u.call(k)}finally{if(i)throw i.error}}return c}function d(r,e,t){var i,u,c=f(r,e,t);try{for(var p=(0,P.XA)(r.views),g=p.next();!g.done;g=p.next()){var _=g.value;c=c.concat(f(_,e,t))}}catch(w){i={error:w}}finally{try{g&&!g.done&&(u=p.return)&&u.call(p)}finally{if(i)throw i.error}}return c}function y(r){return!(0,b.hj)(r)&&!(0,b.kJ)(r)}function T(r){r===void 0&&(r=0);var e=(0,b.kJ)(r)?r:[r];switch(e.length){case 0:e=[0,0,0,0];break;case 1:e=new Array(4).fill(e[0]);break;case 2:e=(0,P.ev)((0,P.ev)([],(0,P.CR)(e),!1),(0,P.CR)(e),!1);break;case 3:e=(0,P.ev)((0,P.ev)([],(0,P.CR)(e),!1),[e[1]],!1);break;default:e=e.slice(0,4);break}return e}var O={};function N(r,e){O[r]=e}function Z(r){delete O[r]}function q(){return Object.keys(O)}function dt(r){return O[r]}var Pt=function(){function r(e){this.option=this.wrapperOption(e)}return r.prototype.update=function(e){return this.option=this.wrapperOption(e),this},r.prototype.hasAction=function(e){var t=this.option.actions;return(0,b.G)(t,function(i){return i[0]===e})},r.prototype.create=function(e,t){var i=this.option,u=i.type,c=i.cfg,p=u==="theta",g=(0,P.pi)({start:e,end:t},c),_=Ko(p?"polar":u);return this.coordinate=new _(g),this.coordinate.type=u,p&&(this.hasAction("transpose")||this.transpose()),this.execActions(),this.coordinate},r.prototype.adjust=function(e,t){return this.coordinate.update({start:e,end:t}),this.coordinate.resetMatrix(),this.execActions(["scale","rotate","translate"]),this.coordinate},r.prototype.rotate=function(e){return this.option.actions.push(["rotate",e]),this},r.prototype.reflect=function(e){return this.option.actions.push(["reflect",e]),this},r.prototype.scale=function(e,t){return this.option.actions.push(["scale",e,t]),this},r.prototype.transpose=function(){return this.option.actions.push(["transpose"]),this},r.prototype.getOption=function(){return this.option},r.prototype.getCoordinate=function(){return this.coordinate},r.prototype.wrapperOption=function(e){return(0,P.pi)({type:"rect",actions:[],cfg:{}},e)},r.prototype.execActions=function(e){var t=this,i=this.option.actions;(0,b.S6)(i,function(u){var c,p=(0,P.CR)(u),g=p[0],_=p.slice(1),w=(0,b.UM)(e)?!0:e.includes(g);w&&(c=t.coordinate)[g].apply(c,(0,P.ev)([],(0,P.CR)(_),!1))})},r}(),Zt=Pt,qt=function(){function r(e,t,i){this.view=e,this.gEvent=t,this.data=i,this.type=t.type}return r.fromData=function(e,t,i){return new r(e,new Me.Event(t,{}),i)},Object.defineProperty(r.prototype,"target",{get:function(){return this.gEvent.target},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"event",{get:function(){return this.gEvent.originalEvent},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"x",{get:function(){return this.gEvent.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this.gEvent.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clientX",{get:function(){return this.gEvent.clientX},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clientY",{get:function(){return this.gEvent.clientY},enumerable:!1,configurable:!0}),r.prototype.toString=function(){return"[Event (type=".concat(this.type,")]")},r.prototype.clone=function(){return new r(this.view,this.gEvent,this.data)},r}(),pe=qt;function Oe(r){var e=r.getController("axis"),t=r.getController("legend"),i=r.getController("annotation"),u=r.getController("slider"),c=r.getController("scrollbar");[e,u,c,t,i].forEach(function(p){p&&p.layout()})}var sr=function(){function r(){this.scales=new Map,this.syncScales=new Map}return r.prototype.createScale=function(e,t,i,u){var c=i,p=this.getScaleMeta(u);if(t.length===0&&p){var g=p.scale,_={type:g.type};g.isCategory&&(_.values=g.values),c=(0,b.b$)(_,p.scaleDef,i)}var w=cn(e,t,c);return this.cacheScale(w,i,u),w},r.prototype.sync=function(e,t){var i=this;this.syncScales.forEach(function(u,c){var p=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,_=[];(0,b.S6)(u,function(w){var k=i.getScale(w);g=(0,b.hj)(k.max)?Math.max(g,k.max):g,p=(0,b.hj)(k.min)?Math.min(p,k.min):p,(0,b.S6)(k.values,function(L){_.includes(L)||_.push(L)})}),(0,b.S6)(u,function(w){var k=i.getScale(w);if(k.isContinuous)k.change({min:p,max:g,values:_});else if(k.isCategory){var L=k.range,R=i.getScaleMeta(w);_&&!(0,b.U2)(R,["scaleDef","range"])&&(L=En((0,b.b$)({},k,{values:_}),e,t)),k.change({values:_,range:L})}})})},r.prototype.cacheScale=function(e,t,i){var u=this.getScaleMeta(i);u&&u.scale.type===e.type?(On(u.scale,e),u.scaleDef=t):(u={key:i,scale:e,scaleDef:t},this.scales.set(i,u));var c=this.getSyncKey(u);if(u.syncKey=c,this.removeFromSyncScales(i),c){var p=this.syncScales.get(c);p||(p=[],this.syncScales.set(c,p)),p.push(i)}},r.prototype.getScale=function(e){var t=this.getScaleMeta(e);if(!t){var i=(0,b.Z$)(e.split("-")),u=this.syncScales.get(i);u&&u.length&&(t=this.getScaleMeta(u[0]))}return t&&t.scale},r.prototype.deleteScale=function(e){var t=this.getScaleMeta(e);if(t){var i=t.syncKey,u=this.syncScales.get(i);if(u&&u.length){var c=u.indexOf(e);c!==-1&&u.splice(c,1)}}this.scales.delete(e)},r.prototype.clear=function(){this.scales.clear(),this.syncScales.clear()},r.prototype.removeFromSyncScales=function(e){var t=this;this.syncScales.forEach(function(i,u){var c=i.indexOf(e);if(c!==-1)return i.splice(c,1),i.length===0&&t.syncScales.delete(u),!1})},r.prototype.getSyncKey=function(e){var t=e.scale,i=e.scaleDef,u=t.field,c=(0,b.U2)(i,["sync"]);return c===!0?u:c===!1?void 0:c},r.prototype.getScaleMeta=function(e){return this.scales.get(e)},r}(),lr=function(){function r(e,t,i,u){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),u===void 0&&(u=0),this.top=e,this.right=t,this.bottom=i,this.left=u}return r.instance=function(e,t,i,u){return e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),u===void 0&&(u=0),new r(e,t,i,u)},r.prototype.max=function(e){var t=(0,P.CR)(e,4),i=t[0],u=t[1],c=t[2],p=t[3];return this.top=Math.max(this.top,i),this.right=Math.max(this.right,u),this.bottom=Math.max(this.bottom,c),this.left=Math.max(this.left,p),this},r.prototype.shrink=function(e){var t=(0,P.CR)(e,4),i=t[0],u=t[1],c=t[2],p=t[3];return this.top+=i,this.right+=u,this.bottom+=c,this.left+=p,this},r.prototype.inc=function(e,t){var i=e.width,u=e.height;switch(t){case fe.TOP:case fe.TOP_LEFT:case fe.TOP_RIGHT:this.top+=u;break;case fe.RIGHT:case fe.RIGHT_TOP:case fe.RIGHT_BOTTOM:this.right+=i;break;case fe.BOTTOM:case fe.BOTTOM_LEFT:case fe.BOTTOM_RIGHT:this.bottom+=u;break;case fe.LEFT:case fe.LEFT_TOP:case fe.LEFT_BOTTOM:this.left+=i;break;default:break}return this},r.prototype.getPadding=function(){return[this.top,this.right,this.bottom,this.left]},r.prototype.clone=function(){return new(r.bind.apply(r,(0,P.ev)([void 0],(0,P.CR)(this.getPadding()),!1)))},r}();function Cr(r){var e=r.padding;if(!y(e))return new(lr.bind.apply(lr,(0,P.ev)([void 0],(0,P.CR)(T(e)),!1)));var t=r.viewBBox,i=new lr,u=[],c=[],p=[];return(0,b.S6)(r.getComponents(),function(g){var _=g.type;_===Ee.AXIS?u.push(g):[Ee.LEGEND,Ee.SLIDER,Ee.SCROLLBAR].includes(_)?c.push(g):_!==Ee.GRID&&_!==Ee.TOOLTIP&&p.push(g)}),(0,b.S6)(u,function(g){var _=g.component,w=_.getLayoutBBox(),k=new Nu(w.x,w.y,w.width,w.height),L=k.exceed(t);i.max(L)}),(0,b.S6)(c,function(g){var _=g.component,w=g.direction,k=_.getLayoutBBox(),L=_.get("padding"),R=new Nu(k.x,k.y,k.width,k.height).expand(L);i.inc(R,w)}),(0,b.S6)(p,function(g){var _=g.component,w=g.direction,k=_.getLayoutBBox(),L=new Nu(k.x,k.y,k.width,k.height);i.inc(L,w)}),i}function gr(r,e,t){var i=t.instance();e.forEach(function(u){u.autoPadding=i.max(u.autoPadding.getPadding())})}var Ur=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,{visible:t.visible})||this;i.views=[],i.geometries=[],i.controllers=[],i.interactions={},i.limitInPlot=!1,i.options={data:[],animate:!0},i.usedControllers=q(),i.scalePool=new sr,i.layoutFunc=Oe,i.isPreMouseInPlot=!1,i.isDataChanged=!1,i.isCoordinateChanged=!1,i.createdScaleKeys=new Map,i.onCanvasEvent=function(le){var he=le.name;if(!he.includes(":")){var Ne=i.createViewEvent(le);i.doPlotEvent(Ne),i.emit(he,Ne)}},i.onDelegateEvents=function(le){var he=le.name;if(!!he.includes(":")){var Ne=i.createViewEvent(le);i.emit(he,Ne)}};var u=t.id,c=u===void 0?(0,b.EL)("view"):u,p=t.parent,g=t.canvas,_=t.backgroundGroup,w=t.middleGroup,k=t.foregroundGroup,L=t.region,R=L===void 0?{start:{x:0,y:0},end:{x:1,y:1}}:L,U=t.padding,G=t.appendPadding,Q=t.theme,pt=t.options,vt=t.limitInPlot,Vt=t.syncViewPadding;return i.parent=p,i.canvas=g,i.backgroundGroup=_,i.middleGroup=w,i.foregroundGroup=k,i.region=R,i.padding=U,i.appendPadding=G,i.options=(0,P.pi)((0,P.pi)({},i.options),pt),i.limitInPlot=vt,i.id=c,i.syncViewPadding=Vt,i.themeObject=(0,b.Kn)(Q)?(0,b.b$)({},gv("default"),Ll(Q)):gv(Q),i.init(),i}return e.prototype.setLayout=function(t){this.layoutFunc=t},e.prototype.init=function(){this.calculateViewBBox(),this.initEvents(),this.initComponentController(),this.initOptions()},e.prototype.render=function(t,i){t===void 0&&(t=!1),this.emit(Mt.BEFORE_RENDER,pe.fromData(this,Mt.BEFORE_RENDER,i)),this.paint(t),this.emit(Mt.AFTER_RENDER,pe.fromData(this,Mt.AFTER_RENDER,i)),this.visible===!1&&this.changeVisible(!1)},e.prototype.clear=function(){var t=this;this.emit(Mt.BEFORE_CLEAR),this.filteredData=[],this.coordinateInstance=void 0,this.isDataChanged=!1,this.isCoordinateChanged=!1;for(var i=this.geometries,u=0;u<i.length;u++)i[u].clear(),i[u].container.remove(!0),i[u].labelsContainer.remove(!0);this.geometries=[];for(var c=this.controllers,u=0;u<c.length;u++)c[u].name==="annotation"?c[u].clear(!0):c[u].clear();this.createdScaleKeys.forEach(function(g,_){t.getRootView().scalePool.deleteScale(_)}),this.createdScaleKeys.clear();for(var p=this.views,u=0;u<p.length;u++)p[u].clear();this.emit(Mt.AFTER_CLEAR)},e.prototype.destroy=function(){this.emit(Mt.BEFORE_DESTROY);var t=this.interactions;(0,b.S6)(t,function(g){g&&g.destroy()}),this.clear();for(var i=this.controllers,u=0,c=i.length;u<c;u++){var p=i[u];p.destroy()}this.backgroundGroup.remove(!0),this.middleGroup.remove(!0),this.foregroundGroup.remove(!0),r.prototype.destroy.call(this)},e.prototype.changeVisible=function(t){r.prototype.changeVisible.call(this,t);for(var i=this.geometries,u=0,c=i.length;u<c;u++){var p=i[u];p.changeVisible(t)}for(var g=this.controllers,u=0,c=g.length;u<c;u++){var _=g[u];_.changeVisible(t)}return this.foregroundGroup.set("visible",t),this.middleGroup.set("visible",t),this.backgroundGroup.set("visible",t),this.getCanvas().draw(),this},e.prototype.data=function(t){return(0,b.t8)(this.options,"data",t),this.isDataChanged=!0,this},e.prototype.source=function(t){return console.warn("This method will be removed at G2 V4.1. Please use chart.data() instead."),this.data(t)},e.prototype.filter=function(t,i){return(0,b.mf)(i)?((0,b.t8)(this.options,["filters",t],i),this):(!i&&(0,b.U2)(this.options,["filters",t])&&delete this.options.filters[t],this)},e.prototype.axis=function(t,i){return(0,b.jn)(t)?(0,b.t8)(this.options,["axes"],t):(0,b.t8)(this.options,["axes",t],i),this},e.prototype.legend=function(t,i){return(0,b.jn)(t)?(0,b.t8)(this.options,["legends"],t):(0,b.HD)(t)?((0,b.t8)(this.options,["legends",t],i),(0,b.PO)(i)&&(i==null?void 0:i.selected)&&(0,b.t8)(this.options,["filters",t],function(u){var c;return(c=i==null?void 0:i.selected[u])!==null&&c!==void 0?c:!0})):(0,b.t8)(this.options,["legends"],t),this},e.prototype.scale=function(t,i){var u=this;return(0,b.HD)(t)?(0,b.t8)(this.options,["scales",t],i):(0,b.Kn)(t)&&(0,b.S6)(t,function(c,p){(0,b.t8)(u.options,["scales",p],c)}),this},e.prototype.tooltip=function(t){return(0,b.t8)(this.options,"tooltip",t),this},e.prototype.annotation=function(){return this.getController("annotation")},e.prototype.guide=function(){return console.warn("This method will be removed at G2 V4.1. Please use chart.annotation() instead."),this.annotation()},e.prototype.coordinate=function(t,i){return(0,b.HD)(t)?(0,b.t8)(this.options,"coordinate",{type:t,cfg:i}):(0,b.t8)(this.options,"coordinate",t),this.coordinateController.update(this.options.coordinate),this.coordinateController},e.prototype.coord=function(t,i){return console.warn("This method will be removed at G2 V4.1. Please use chart.coordinate() instead."),this.coordinate(t,i)},e.prototype.facet=function(t,i){this.facetInstance&&this.facetInstance.destroy();var u=aa(t);if(!u)throw new Error("facet '".concat(t,"' is not exist!"));return this.facetInstance=new u(this,(0,P.pi)((0,P.pi)({},i),{type:t})),this},e.prototype.animate=function(t){return(0,b.t8)(this.options,"animate",t),this},e.prototype.updateOptions=function(t){return this.clear(),(0,b.CD)(this.options,t),this.views.forEach(function(i){return i.destroy()}),this.views=[],this.initOptions(),this.coordinateBBox=this.viewBBox,this},e.prototype.option=function(t,i){if(e.prototype[t])throw new Error(`Can't use built in variable name "`.concat(t,'", please change another one.'));return(0,b.t8)(this.options,t,i),this},e.prototype.theme=function(t){return this.themeObject=(0,b.Kn)(t)?(0,b.b$)({},this.themeObject,Ll(t)):gv(t),this},e.prototype.interaction=function(t,i){var u=this.interactions[t];u&&u.destroy();var c=Ni(t,this,i);return c&&(c.init(),this.interactions[t]=c),this},e.prototype.removeInteraction=function(t){var i=this.interactions[t];i&&(i.destroy(),this.interactions[t]=void 0)},e.prototype.changeData=function(t){this.isDataChanged=!0,this.emit(Mt.BEFORE_CHANGE_DATA,pe.fromData(this,Mt.BEFORE_CHANGE_DATA,null)),this.data(t),this.paint(!0);for(var i=this.views,u=0,c=i.length;u<c;u++){var p=i[u];p.changeData(t)}this.emit(Mt.AFTER_CHANGE_DATA,pe.fromData(this,Mt.AFTER_CHANGE_DATA,null))},e.prototype.createView=function(t){this.parent&&this.parent.parent&&console.warn("The view nesting recursive feature will be removed at G2 V4.1. Please avoid to use it.");var i={data:this.options.data,scales:(0,b.d9)(this.options.scales),axes:(0,b.d9)(this.options.axes),coordinate:(0,b.d9)(this.coordinateController.getOption()),tooltip:(0,b.d9)(this.options.tooltip),legends:(0,b.d9)(this.options.legends),animate:this.options.animate,visible:this.visible},u=new e((0,P.pi)((0,P.pi)({parent:this,canvas:this.canvas,backgroundGroup:this.backgroundGroup.addGroup({zIndex:Te.BG}),middleGroup:this.middleGroup.addGroup({zIndex:Te.MID}),foregroundGroup:this.foregroundGroup.addGroup({zIndex:Te.FORE}),theme:this.themeObject,padding:this.padding},t),{options:(0,P.pi)((0,P.pi)({},i),(0,b.U2)(t,"options",{}))}));return this.views.push(u),u},e.prototype.view=function(t){return console.warn("This method will be removed at G2 V4.1. Please use chart.createView() instead."),this.createView(t)},e.prototype.removeView=function(t){var i=(0,b.Od)(this.views,function(u){return u===t})[0];return i&&i.destroy(),i},e.prototype.getCoordinate=function(){return this.coordinateInstance},e.prototype.getTheme=function(){return this.themeObject},e.prototype.getXScale=function(){var t=this.geometries[0];return t?t.getXScale():null},e.prototype.getYScales=function(){var t={},i=[];return this.geometries.forEach(function(u){var c=u.getYScale(),p=c.field;t[p]||(t[p]=!0,i.push(c))}),i},e.prototype.getScalesByDim=function(t){for(var i=this.geometries,u={},c=0,p=i.length;c<p;c++){var g=i[c],_=t==="x"?g.getXScale():g.getYScale();_&&!u[_.field]&&(u[_.field]=_)}return u},e.prototype.getScale=function(t,i){var u=i||this.getScaleKey(t);return this.getRootView().scalePool.getScale(u)},e.prototype.getScaleByField=function(t,i){return this.getScale(t,i)},e.prototype.getOptions=function(){return this.options},e.prototype.getData=function(){return this.filteredData},e.prototype.getOriginalData=function(){return this.options.data},e.prototype.getPadding=function(){return this.autoPadding.getPadding()},e.prototype.getGeometries=function(){return this.geometries},e.prototype.getElements=function(){return(0,b.u4)(this.geometries,function(t,i){return t.concat(i.getElements())},[])},e.prototype.getElementsBy=function(t){return this.getElements().filter(function(i){return t(i)})},e.prototype.getLayer=function(t){return t===W.BG?this.backgroundGroup:t===W.MID?this.middleGroup:t===W.FORE?this.foregroundGroup:this.foregroundGroup},e.prototype.isPointInPlot=function(t){return eh(this.getCoordinate(),t)},e.prototype.getLegendAttributes=function(){return(0,b.xH)(this.geometries.map(function(t){return t.getGroupAttributes()}))},e.prototype.getGroupScales=function(){var t=this.geometries.map(function(i){return i.getGroupScales()});return Th((0,b.xH)(t))},e.prototype.getCanvas=function(){return this.getRootView().canvas},e.prototype.getRootView=function(){for(var t=this;;){if(t.parent){t=t.parent;continue}break}return t},e.prototype.getXY=function(t){var i=this.getCoordinate(),u=this.getScalesByDim("x"),c=this.getScalesByDim("y"),p,g;if((0,b.S6)(t,function(_,w){u[w]&&(p=u[w].scale(_)),c[w]&&(g=c[w].scale(_))}),!(0,b.UM)(p)&&!(0,b.UM)(g))return i.convert({x:p,y:g})},e.prototype.getController=function(t){return(0,b.sE)(this.controllers,function(i){return i.name===t})},e.prototype.showTooltip=function(t){var i=this.getController("tooltip");return i&&i.showTooltip(t),this},e.prototype.hideTooltip=function(){var t=this.getController("tooltip");return t&&t.hideTooltip(),this},e.prototype.lockTooltip=function(){var t=this.getController("tooltip");return t&&t.lockTooltip(),this},e.prototype.unlockTooltip=function(){var t=this.getController("tooltip");return t&&t.unlockTooltip(),this},e.prototype.isTooltipLocked=function(){var t=this.getController("tooltip");return t&&t.isTooltipLocked()},e.prototype.getTooltipItems=function(t){var i=this.getController("tooltip");return i?i.getTooltipItems(t):[]},e.prototype.getSnapRecords=function(t){for(var i=this.geometries,u=[],c=0,p=i.length;c<p;c++){var g=i[c],_=g.dataArray;g.sort(_);for(var w=void 0,k=0,L=_.length;k<L;k++){var R=_[k];w=Gg(t,R,g),w&&u.push(w)}}for(var U=this.views,c=0,p=U.length;c<p;c++){var G=U[c],Q=G.getSnapRecords(t);u=u.concat(Q)}return u},e.prototype.getComponents=function(){for(var t=[],i=this.controllers,u=0,c=i.length;u<c;u++){var p=i[u];t=t.concat(p.getComponents())}return t},e.prototype.filterData=function(t){var i=this.options.filters;return(0,b.dp)(i)===0?t:(0,b.hX)(t,function(u,c){var p=Object.keys(i);return p.every(function(g){var _=i[g];return _(u[g],u,c)})})},e.prototype.filterFieldData=function(t,i){var u=this.options.filters,c=(0,b.U2)(u,t);return(0,b.o8)(c)?i:i.filter(function(p,g){return c(p[t],p,g)})},e.prototype.adjustCoordinate=function(){var t=this.getCoordinate(),i=t.start,u=t.end,c=this.coordinateBBox.bl,p=this.coordinateBBox.tr;if((0,b.Xy)(i,c)&&(0,b.Xy)(u,p)){this.isCoordinateChanged=!1;return}this.isCoordinateChanged=!0,this.coordinateInstance=this.coordinateController.adjust(c,p)},e.prototype.paint=function(t){this.renderDataRecursive(t),this.syncScale(),this.emit(Mt.BEFORE_PAINT),this.renderPaddingRecursive(t),this.renderLayoutRecursive(t),this.renderBackgroundStyleShape(),this.renderPaintRecursive(t),this.emit(Mt.AFTER_PAINT),this.isDataChanged=!1},e.prototype.renderBackgroundStyleShape=function(){if(!this.parent){var t=(0,b.U2)(this.themeObject,"background");if(t){this.backgroundStyleRectShape||(this.backgroundStyleRectShape=this.backgroundGroup.addShape("rect",{attrs:{},zIndex:-1,capture:!1}),this.backgroundStyleRectShape.toBack());var i=this.viewBBox,u=i.x,c=i.y,p=i.width,g=i.height;this.backgroundStyleRectShape.attr({fill:t,x:u,y:c,width:p,height:g})}else this.backgroundStyleRectShape&&(this.backgroundStyleRectShape.remove(!0),this.backgroundStyleRectShape=void 0)}},e.prototype.renderPaddingRecursive=function(t){this.calculateViewBBox(),this.adjustCoordinate(),this.initComponents(t),this.autoPadding=Cr(this).shrink(T(this.appendPadding)),this.coordinateBBox=this.viewBBox.shrink(this.autoPadding.getPadding()),this.adjustCoordinate();var i=this.controllers.find(function(_){return _.name==="tooltip"});i.update();for(var u=this.views,c=0,p=u.length;c<p;c++){var g=u[c];g.renderPaddingRecursive(t)}},e.prototype.renderLayoutRecursive=function(t){var i=this.syncViewPadding===!0?gr:(0,b.mf)(this.syncViewPadding)?this.syncViewPadding:void 0;i&&(i(this,this.views,lr),this.views.forEach(function(_){_.coordinateBBox=_.viewBBox.shrink(_.autoPadding.getPadding()),_.adjustCoordinate()})),this.doLayout();for(var u=this.views,c=0,p=u.length;c<p;c++){var g=u[c];g.renderLayoutRecursive(t)}},e.prototype.renderPaintRecursive=function(t){var i=this.middleGroup;if(this.limitInPlot){var u=qp(this.coordinateInstance),c=u.type,p=u.attrs;i.setClip({type:c,attrs:p})}else i.setClip(void 0);this.paintGeometries(t),this.renderComponents(t);for(var g=this.views,_=0,w=g.length;_<w;_++){var k=g[_];k.renderPaintRecursive(t)}},e.prototype.createScale=function(t,i,u,c){var p=(0,b.U2)(this.options.scales,[t]),g=(0,P.pi)((0,P.pi)({},p),u);return this.parent?this.parent.createScale(t,i,g,c):this.scalePool.createScale(t,i,g,c)},e.prototype.renderDataRecursive=function(t){this.doFilterData(),this.createCoordinate(),this.initGeometries(t),this.renderFacet(t);for(var i=this.views,u=0,c=i.length;u<c;u++){var p=i[u];p.renderDataRecursive(t)}},e.prototype.calculateViewBBox=function(){var t,i,u,c;if(this.parent){var p=this.parent.coordinateBBox;t=p.x,i=p.y,u=p.width,c=p.height}else t=0,i=0,u=this.canvas.get("width"),c=this.canvas.get("height");var g=this.region,_=g.start,w=g.end,k=new Nu(t+u*_.x,i+c*_.y,u*(w.x-_.x),c*(w.y-_.y));(!this.viewBBox||!this.viewBBox.isEqual(k))&&(this.viewBBox=new Nu(t+u*_.x,i+c*_.y,u*(w.x-_.x),c*(w.y-_.y))),this.coordinateBBox=this.viewBBox},e.prototype.initEvents=function(){this.foregroundGroup.on("*",this.onDelegateEvents),this.middleGroup.on("*",this.onDelegateEvents),this.backgroundGroup.on("*",this.onDelegateEvents),this.canvas.on("*",this.onCanvasEvent)},e.prototype.initComponentController=function(){for(var t=this.usedControllers,i=0,u=t.length;i<u;i++){var c=t[i],p=dt(c);p&&this.controllers.push(new p(this))}},e.prototype.createViewEvent=function(t){var i=t.shape,u=t.name,c=i?i.get("origin"):null,p=new pe(this,t,c);return p.type=u,p},e.prototype.doPlotEvent=function(t){var i=t.type,u=t.x,c=t.y,p={x:u,y:c},g=["mousedown","mouseup","mousemove","mouseleave","mousewheel","touchstart","touchmove","touchend","touchcancel","click","dblclick","contextmenu"];if(g.includes(i)){var _=this.isPointInPlot(p),w=t.clone();if(_){var k="plot:".concat(i);w.type=k,this.emit(k,w),(i==="mouseleave"||i==="touchend")&&(this.isPreMouseInPlot=!1)}i==="mousemove"||i==="touchmove"?(this.isPreMouseInPlot&&!_?(i==="mousemove"&&(w.type=Dt.MOUSE_LEAVE,this.emit(Dt.MOUSE_LEAVE,w)),w.type=Dt.LEAVE,this.emit(Dt.LEAVE,w)):!this.isPreMouseInPlot&&_&&(i==="mousemove"&&(w.type=Dt.MOUSE_ENTER,this.emit(Dt.MOUSE_ENTER,w)),w.type=Dt.ENTER,this.emit(Dt.ENTER,w)),this.isPreMouseInPlot=_):(i==="mouseleave"||i==="touchend")&&this.isPreMouseInPlot&&(i==="mouseleave"&&(w.type=Dt.MOUSE_LEAVE,this.emit(Dt.MOUSE_LEAVE,w)),w.type=Dt.LEAVE,this.emit(Dt.LEAVE,w),this.isPreMouseInPlot=!1)}},e.prototype.doFilterData=function(){var t=this.options.data;this.filteredData=this.filterData(t)},e.prototype.initGeometries=function(t){this.createOrUpdateScales();for(var i=this.getCoordinate(),u=(0,b.U2)(this.options,"scales",{}),c=this.geometries,p=0,g=c.length;p<g;p++){var _=c[p];_.scales=this.getGeometryScales();var w={coordinate:i,scaleDefs:u,data:this.filteredData,theme:this.themeObject,isDataChanged:this.isDataChanged,isCoordinateChanged:this.isCoordinateChanged};t?_.update(w):_.init(w)}this.adjustScales()},e.prototype.createOrUpdateScales=function(){for(var t=this.getScaleFields(),i=this.getGroupedFields(),u=this.getOptions(),c=u.data,p=u.scales,g=p===void 0?{}:p,_=this.filteredData,w=0,k=t.length;w<k;w++){var L=t[w],R=g[L],U=this.getScaleKey(L);this.createScale(L,i.includes(L)?c:_,R,U),this.createdScaleKeys.set(U,!0)}},e.prototype.syncScale=function(){this.getRootView().scalePool.sync(this.getCoordinate(),this.theme)},e.prototype.getGeometryScales=function(){for(var t=this.getScaleFields(),i={},u=0;u<t.length;u++){var c=t[u];i[c]=this.getScaleByField(c)}return i},e.prototype.getScaleFields=function(){for(var t=[],i=new Map,u=this.geometries,c=0;c<u.length;c++){var p=u[c],g=p.getScaleFields();Th(g,t,i)}return t},e.prototype.getGroupedFields=function(){for(var t=[],i=new Map,u=this.geometries,c=0;c<u.length;c++){var p=u[c],g=p.getGroupFields();Th(g,t,i)}return t},e.prototype.adjustScales=function(){this.adjustCategoryScaleRange()},e.prototype.adjustCategoryScaleRange=function(){var t=this,i=(0,P.ev)([this.getXScale()],(0,P.CR)(this.getYScales()),!1).filter(function(p){return!!p}),u=this.getCoordinate(),c=this.options.scales;(0,b.S6)(i,function(p){var g=p.field,_=p.values,w=p.isCategory,k=p.isIdentity;(w||k)&&_&&!(0,b.U2)(c,[g,"range"])&&(p.range=En(p,u,t.theme))})},e.prototype.initComponents=function(t){for(var i=this.controllers,u=0;u<i.length;u++){var c=i[u];t?c.update():(c.clear(),c.render())}},e.prototype.doLayout=function(){this.layoutFunc(this)},e.prototype.createCoordinate=function(){var t=this.coordinateBBox.bl,i=this.coordinateBBox.tr;this.coordinateInstance=this.coordinateController.create(t,i)},e.prototype.paintGeometries=function(t){for(var i=this.options.animate,u=this.getCoordinate(),c={x:this.viewBBox.x,y:this.viewBBox.y,minX:this.viewBBox.minX,minY:this.viewBBox.minY,maxX:this.viewBBox.maxX,maxY:this.viewBBox.maxY,width:this.viewBBox.width,height:this.viewBBox.height},p=this.geometries,g=0;g<p.length;g++){var _=p[g];_.coordinate=u,_.canvasRegion=c,i||_.animate(!1),_.paint(t)}},e.prototype.renderComponents=function(t){for(var i=this.getComponents(),u=0;u<i.length;u++){var c=i[u];c.component.render()}},e.prototype.renderFacet=function(t){this.facetInstance&&(t?this.facetInstance.update():(this.facetInstance.clear(),this.facetInstance.init(),this.facetInstance.render()))},e.prototype.initOptions=function(){var t=this,i=this.options,u=i.geometries,c=u===void 0?[]:u,p=i.interactions,g=p===void 0?[]:p,_=i.views,w=_===void 0?[]:_,k=i.annotations,L=k===void 0?[]:k,R=i.coordinate,U=i.events,G=i.facets;this.coordinateController?R&&this.coordinateController.update(R):this.coordinateController=new Zt(R);for(var Q=0;Q<c.length;Q++){var pt=c[Q];this.createGeometry(pt)}for(var vt=0;vt<g.length;vt++){var Vt=g[vt],le=Vt.type,he=Vt.cfg;this.interaction(le,he)}for(var Ne=0;Ne<w.length;Ne++){var Er=w[Ne];this.createView(Er)}for(var Fr=this.getController("annotation"),zr=0;zr<L.length;zr++){var pn=L[zr];Fr.annotation(pn)}U&&(0,b.S6)(U,function(nn,Pn){t.on(Pn,nn)}),G&&(0,b.S6)(G,function(nn){var Pn=nn.type,Si=(0,P._T)(nn,["type"]);t.facet(Pn,Si)})},e.prototype.createGeometry=function(t){var i=t.type,u=t.cfg,c=u===void 0?{}:u;if(this[i]){var p=this[i](c);(0,b.S6)(t,function(g,_){(0,b.mf)(p[_])&&p[_](g)})}},e.prototype.getScaleKey=function(t){return"".concat(this.id,"-").concat(t)},e}(ne);function Ar(r,e){Ur.prototype[r.toLowerCase()]=function(t){t===void 0&&(t={});var i=(0,P.pi)({container:this.middleGroup.addGroup(),labelsContainer:this.foregroundGroup.addGroup()},t),u=new e(i);return this.geometries.push(u),u}}var Dr=Ur,mn=function(r){(0,P.ZT)(e,r);function e(t){var i=this,u=t.container,c=t.width,p=t.height,g=t.autoFit,_=g===void 0?!1:g,w=t.padding,k=t.appendPadding,L=t.renderer,R=L===void 0?"canvas":L,U=t.pixelRatio,G=t.localRefresh,Q=G===void 0?!0:G,pt=t.visible,vt=pt===void 0?!0:pt,Vt=t.supportCSSTransform,le=Vt===void 0?!1:Vt,he=t.defaultInteractions,Ne=he===void 0?["tooltip","legend-filter","legend-active","continuous-filter","ellipsis-text","axis-description"]:he,Er=t.options,Fr=t.limitInPlot,zr=t.theme,pn=t.syncViewPadding,nn=(0,b.HD)(u)?document.getElementById(u):u,Pn=(0,Ct.Z)('<div style="position:relative;"></div>');nn.appendChild(Pn);var Si=ie(nn,_,c,p),ha=Qt(R),wa=new ha.Canvas((0,P.pi)({container:Pn,pixelRatio:U,localRefresh:Q,supportCSSTransform:le},Si));return i=r.call(this,{parent:null,canvas:wa,backgroundGroup:wa.addGroup({zIndex:Te.BG}),middleGroup:wa.addGroup({zIndex:Te.MID}),foregroundGroup:wa.addGroup({zIndex:Te.FORE}),padding:w,appendPadding:k,visible:vt,options:Er,limitInPlot:Fr,theme:zr,syncViewPadding:pn})||this,i.onResize=(0,b.Ds)(function(){i.forceFit()},300),i.ele=nn,i.canvas=wa,i.width=Si.width,i.height=Si.height,i.autoFit=_,i.localRefresh=Q,i.renderer=R,i.wrapperElement=Pn,i.updateCanvasStyle(),i.bindAutoFit(),i.initDefaultInteractions(Ne),i}return e.prototype.initDefaultInteractions=function(t){var i=this;(0,b.S6)(t,function(u){i.interaction(u)})},e.prototype.aria=function(t){var i="aria-label";t===!1?this.ele.removeAttribute(i):this.ele.setAttribute(i,t.label)},e.prototype.changeSize=function(t,i){return this.width===t&&this.height===i?this:(this.emit(Mt.BEFORE_CHANGE_SIZE),this.width=t,this.height=i,this.canvas.changeSize(t,i),this.render(!0),this.emit(Mt.AFTER_CHANGE_SIZE),this)},e.prototype.clear=function(){r.prototype.clear.call(this),this.aria(!1)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.unbindAutoFit(),this.canvas.destroy(),Ce(this.wrapperElement),this.wrapperElement=null},e.prototype.changeVisible=function(t){return r.prototype.changeVisible.call(this,t),this.wrapperElement.style.display=t?"":"none",this},e.prototype.forceFit=function(){if(!this.destroyed){var t=ie(this.ele,!0,this.width,this.height),i=t.width,u=t.height;this.changeSize(i,u)}},e.prototype.updateCanvasStyle=function(){(0,Y.Z)(this.canvas.get("el"),{display:"inline-block",verticalAlign:"middle"})},e.prototype.bindAutoFit=function(){this.autoFit&&window.addEventListener("resize",this.onResize)},e.prototype.unbindAutoFit=function(){this.autoFit&&window.removeEventListener("resize",this.onResize)},e}(Dr),Fn=mn,ni=function(){function r(e){this.visible=!0,this.components=[],this.view=e}return r.prototype.clear=function(e){(0,b.S6)(this.components,function(t){t.component.destroy()}),this.components=[]},r.prototype.destroy=function(){this.clear()},r.prototype.getComponents=function(){return this.components},r.prototype.changeVisible=function(e){this.visible!==e&&(this.components.forEach(function(t){e?t.component.show():t.component.hide()}),this.visible=e)},r}();function ki(r){for(var e=[],t=function(u){var c=r[u],p=(0,b.sE)(e,function(g){return g.color===c.color&&g.name===c.name&&g.value===c.value&&g.title===c.title});p||e.push(c)},i=0;i<r.length;i++)t(i);return e}var oa=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isLocked=!1,t}return Object.defineProperty(e.prototype,"name",{get:function(){return"tooltip"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.isVisible=function(){var t=this.view.getOptions().tooltip;return t!==!1},e.prototype.render=function(){},e.prototype.showTooltip=function(t){if(this.point=t,!!this.isVisible()){var i=this.view,u=this.getTooltipItems(t);if(!u.length){this.hideTooltip();return}var c=this.getTitle(u),p={x:u[0].x,y:u[0].y};i.emit("tooltip:show",pe.fromData(i,"tooltip:show",(0,P.pi)({items:u,title:c},t)));var g=this.getTooltipCfg(),_=g.follow,w=g.showMarkers,k=g.showCrosshairs,L=g.showContent,R=g.marker,U=this.items,G=this.title;if(!(0,b.Xy)(G,c)||!(0,b.Xy)(U,u)?(i.emit("tooltip:change",pe.fromData(i,"tooltip:change",(0,P.pi)({items:u,title:c},t))),((0,b.mf)(L)?L(u):L)&&(this.tooltip||this.renderTooltip(),this.tooltip.update((0,b.CD)({},g,{items:this.getItemsAfterProcess(u),title:c},_?t:{})),this.tooltip.show()),w&&this.renderTooltipMarkers(u,R)):(this.tooltip&&_&&(this.tooltip.update(t),this.tooltip.show()),this.tooltipMarkersGroup&&this.tooltipMarkersGroup.show()),this.items=u,this.title=c,k){var Q=(0,b.U2)(g,["crosshairs","follow"],!1);this.renderCrosshairs(Q?t:p,g)}}},e.prototype.hideTooltip=function(){var t=this.getTooltipCfg().follow;if(!t){this.point=null;return}var i=this.tooltipMarkersGroup;i&&i.hide();var u=this.xCrosshair,c=this.yCrosshair;u&&u.hide(),c&&c.hide();var p=this.tooltip;p&&p.hide(),this.view.emit("tooltip:hide",pe.fromData(this.view,"tooltip:hide",{})),this.point=null},e.prototype.lockTooltip=function(){this.isLocked=!0,this.tooltip&&this.tooltip.setCapture(!0)},e.prototype.unlockTooltip=function(){this.isLocked=!1;var t=this.getTooltipCfg();this.tooltip&&this.tooltip.setCapture(t.capture)},e.prototype.isTooltipLocked=function(){return this.isLocked},e.prototype.clear=function(){var t=this,i=t.tooltip,u=t.xCrosshair,c=t.yCrosshair,p=t.tooltipMarkersGroup;i&&(i.hide(),i.clear()),u&&u.clear(),c&&c.clear(),p&&p.clear(),i!=null&&i.get("customContent")&&(this.tooltip.destroy(),this.tooltip=null),this.title=null,this.items=null},e.prototype.destroy=function(){this.tooltip&&this.tooltip.destroy(),this.xCrosshair&&this.xCrosshair.destroy(),this.yCrosshair&&this.yCrosshair.destroy(),this.guideGroup&&this.guideGroup.remove(!0),this.reset()},e.prototype.reset=function(){this.items=null,this.title=null,this.tooltipMarkersGroup=null,this.tooltipCrosshairsGroup=null,this.xCrosshair=null,this.yCrosshair=null,this.tooltip=null,this.guideGroup=null,this.isLocked=!1,this.point=null},e.prototype.changeVisible=function(t){if(this.visible!==t){var i=this,u=i.tooltip,c=i.tooltipMarkersGroup,p=i.xCrosshair,g=i.yCrosshair;t?(u&&u.show(),c&&c.show(),p&&p.show(),g&&g.show()):(u&&u.hide(),c&&c.hide(),p&&p.hide(),g&&g.hide()),this.visible=t}},e.prototype.getTooltipItems=function(t){var i,u,c,p,g,_,w=this.findItemsFromView(this.view,t);if(w.length){w=(0,b.xH)(w);try{for(var k=(0,P.XA)(w),L=k.next();!L.done;L=k.next()){var R=L.value;try{for(var U=(c=void 0,(0,P.XA)(R)),G=U.next();!G.done;G=U.next()){var Q=G.value,pt=Q.mappingData,vt=pt.x,Vt=pt.y;Q.x=(0,b.kJ)(vt)?vt[vt.length-1]:vt,Q.y=(0,b.kJ)(Vt)?Vt[Vt.length-1]:Vt}}catch(nn){c={error:nn}}finally{try{G&&!G.done&&(p=U.return)&&p.call(U)}finally{if(c)throw c.error}}}}catch(nn){i={error:nn}}finally{try{L&&!L.done&&(u=k.return)&&u.call(k)}finally{if(i)throw i.error}}var le=this.getTooltipCfg().shared;if(le===!1&&w.length>1){var he=w[0],Ne=Math.abs(t.y-he[0].y);try{for(var Er=(0,P.XA)(w),Fr=Er.next();!Fr.done;Fr=Er.next()){var zr=Fr.value,pn=Math.abs(t.y-zr[0].y);pn<=Ne&&(he=zr,Ne=pn)}}catch(nn){g={error:nn}}finally{try{Fr&&!Fr.done&&(_=Er.return)&&_.call(Er)}finally{if(g)throw g.error}}w=[he]}return ki((0,b.xH)(w))}return[]},e.prototype.layout=function(){},e.prototype.update=function(){if(this.point&&this.showTooltip(this.point),this.tooltip){var t=this.view.getCanvas();this.tooltip.set("region",{start:{x:0,y:0},end:{x:t.get("width"),y:t.get("height")}})}},e.prototype.isCursorEntered=function(t){if(this.tooltip){var i=this.tooltip.getContainer(),u=this.tooltip.get("capture");if(i&&u){var c=i.getBoundingClientRect(),p=c.x,g=c.y,_=c.width,w=c.height;return new Nu(p,g,_,w).isPointIn(t)}}return!1},e.prototype.getTooltipCfg=function(){var t=this.view,i=t.getOptions().tooltip,u=this.processCustomContent(i),c=t.getTheme(),p=(0,b.U2)(c,["components","tooltip"],{}),g=(0,b.U2)(u,"enterable",p.enterable);return(0,b.b$)({},p,u,{capture:!!(g||this.isLocked)})},e.prototype.processCustomContent=function(t){if((0,b.jn)(t)||!(0,b.U2)(t,"customContent"))return t;var i=t.customContent,u=function(c,p){var g=i(c,p)||"";return(0,b.HD)(g)?'<div class="g2-tooltip">'+g+"</div>":g};return(0,P.pi)((0,P.pi)({},t),{customContent:u})},e.prototype.getTitle=function(t){var i=t[0].title||t[0].name;return this.title=i,i},e.prototype.renderTooltip=function(){var t=this.view.getCanvas(),i={start:{x:0,y:0},end:{x:t.get("width"),y:t.get("height")}},u=this.getTooltipCfg(),c=new lp((0,P.pi)((0,P.pi)({parent:t.get("el").parentNode,region:i},u),{visible:!1,crosshairs:null}));c.init(),this.tooltip=c},e.prototype.renderTooltipMarkers=function(t,i){var u,c,p=this.getTooltipMarkersGroup(),g=this.view.getRootView(),_=g.limitInPlot;try{for(var w=(0,P.XA)(t),k=w.next();!k.done;k=w.next()){var L=k.value,R=L.x,U=L.y;if(_||(p==null?void 0:p.getClip())){var G=qp(g.getCoordinate()),Q=G.type,pt=G.attrs;p==null||p.setClip({type:Q,attrs:pt})}else p==null||p.setClip(void 0);var vt=this.view.getTheme(),Vt=(0,b.U2)(vt,["components","tooltip","marker"],{}),le=(0,P.pi)((0,P.pi)({fill:L.color,symbol:"circle",shadowColor:L.color},(0,b.mf)(i)?(0,P.pi)((0,P.pi)({},Vt),i(L)):i),{x:R,y:U});p.addShape("marker",{attrs:le})}}catch(he){u={error:he}}finally{try{k&&!k.done&&(c=w.return)&&c.call(w)}finally{if(u)throw u.error}}},e.prototype.renderCrosshairs=function(t,i){var u=(0,b.U2)(i,["crosshairs","type"],"x");u==="x"?(this.yCrosshair&&this.yCrosshair.hide(),this.renderXCrosshairs(t,i)):u==="y"?(this.xCrosshair&&this.xCrosshair.hide(),this.renderYCrosshairs(t,i)):u==="xy"&&(this.renderXCrosshairs(t,i),this.renderYCrosshairs(t,i))},e.prototype.renderXCrosshairs=function(t,i){var u=this.getViewWithGeometry(this.view).getCoordinate(),c,p;if(u.isRect)u.isTransposed?(c={x:u.start.x,y:t.y},p={x:u.end.x,y:t.y}):(c={x:t.x,y:u.end.y},p={x:t.x,y:u.start.y});else{var g=uf(u,t),_=u.getCenter(),w=u.getRadius();p=co(_.x,_.y,w,g),c=_}var k=(0,b.b$)({start:c,end:p,container:this.getTooltipCrosshairsGroup()},(0,b.U2)(i,"crosshairs",{}),this.getCrosshairsText("x",t,i));delete k.type;var L=this.xCrosshair;L?L.update(k):(L=new Sl(k),L.init()),L.render(),L.show(),this.xCrosshair=L},e.prototype.renderYCrosshairs=function(t,i){var u=this.getViewWithGeometry(this.view).getCoordinate(),c,p;if(u.isRect){var g=void 0,_=void 0;u.isTransposed?(g={x:t.x,y:u.end.y},_={x:t.x,y:u.start.y}):(g={x:u.start.x,y:t.y},_={x:u.end.x,y:t.y}),c={start:g,end:_},p="Line"}else c={center:u.getCenter(),radius:$p(u,t),startAngle:u.startAngle,endAngle:u.endAngle},p="Circle";c=(0,b.b$)({container:this.getTooltipCrosshairsGroup()},c,(0,b.U2)(i,"crosshairs",{}),this.getCrosshairsText("y",t,i)),delete c.type;var w=this.yCrosshair;w?u.isRect&&w.get("type")==="circle"||!u.isRect&&w.get("type")==="line"?(w=new ht[p](c),w.init()):w.update(c):(w=new ht[p](c),w.init()),w.render(),w.show(),this.yCrosshair=w},e.prototype.getCrosshairsText=function(t,i,u){var c=(0,b.U2)(u,["crosshairs","text"]),p=(0,b.U2)(u,["crosshairs","follow"]),g=this.items;if(c){var _=this.getViewWithGeometry(this.view),w=g[0],k=_.getXScale(),L=_.getYScales()[0],R=void 0,U=void 0;if(p){var G=this.view.getCoordinate().invert(i);R=k.invert(G.x),U=L.invert(G.y)}else R=w.data[k.field],U=w.data[L.field];var Q=t==="x"?R:U;return(0,b.mf)(c)?c=c(t,Q,g,i):c.content=Q,{text:c}}},e.prototype.getGuideGroup=function(){if(!this.guideGroup){var t=this.view.foregroundGroup;this.guideGroup=t.addGroup({name:"tooltipGuide",capture:!1})}return this.guideGroup},e.prototype.getTooltipMarkersGroup=function(){var t=this.tooltipMarkersGroup;return t&&!t.destroyed?(t.clear(),t.show()):(t=this.getGuideGroup().addGroup({name:"tooltipMarkersGroup"}),t.toFront(),this.tooltipMarkersGroup=t),t},e.prototype.getTooltipCrosshairsGroup=function(){var t=this.tooltipCrosshairsGroup;return t||(t=this.getGuideGroup().addGroup({name:"tooltipCrosshairsGroup",capture:!1}),t.toBack(),this.tooltipCrosshairsGroup=t),t},e.prototype.findItemsFromView=function(t,i){var u,c;if(t.getOptions().tooltip===!1)return[];var p=this.getTooltipCfg(),g=f(t,i,p);try{for(var _=(0,P.XA)(t.views),w=_.next();!w.done;w=_.next()){var k=w.value;g=g.concat(this.findItemsFromView(k,i))}}catch(L){u={error:L}}finally{try{w&&!w.done&&(c=_.return)&&c.call(_)}finally{if(u)throw u.error}}return g},e.prototype.getViewWithGeometry=function(t){var i=this;return t.geometries.length?t:(0,b.sE)(t.views,function(u){return i.getViewWithGeometry(u)})},e.prototype.getItemsAfterProcess=function(t){var i=this.getTooltipCfg().customItems,u=i||function(c){return c};return u(t)},e}(ni),Di=oa,ca={};function zi(r){return ca[r.toLowerCase()]}function Oa(r,e){ca[r.toLowerCase()]=e}var xa={appear:{duration:450,easing:"easeQuadOut"},update:{duration:400,easing:"easeQuadInOut"},enter:{duration:400,easing:"easeQuadInOut"},leave:{duration:350,easing:"easeQuadIn"}},Qi={interval:function(r){return{enter:{animation:r.isRect?r.isTransposed?"scale-in-x":"scale-in-y":"fade-in"},update:{animation:r.isPolar&&r.isTransposed?"sector-path-update":null},leave:{animation:"fade-out"}}},line:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},path:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},point:{appear:{animation:"zoom-in"},enter:{animation:"zoom-in"},leave:{animation:"zoom-out"}},area:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},polygon:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},schema:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},edge:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},label:{appear:{animation:"fade-in",delay:450},enter:{animation:"fade-in"},update:{animation:"position-update"},leave:{animation:"fade-out"}}},lo={line:function(){return{animation:"wave-in"}},area:function(){return{animation:"wave-in"}},path:function(){return{animation:"fade-in"}},interval:function(r){var e;return r.isRect?e=r.isTransposed?"grow-in-x":"grow-in-y":(e="grow-in-xy",r.isPolar&&r.isTransposed&&(e="wave-in")),{animation:e}},schema:function(r){var e;return r.isRect?e=r.isTransposed?"grow-in-x":"grow-in-y":e="grow-in-xy",{animation:e}},polygon:function(){return{animation:"fade-in",duration:500}},edge:function(){return{animation:"fade-in"}}};function Ja(r,e){return{delay:(0,b.mf)(r.delay)?r.delay(e):r.delay,easing:(0,b.mf)(r.easing)?r.easing(e):r.easing,duration:(0,b.mf)(r.duration)?r.duration(e):r.duration,callback:r.callback,repeat:r.repeat}}function To(r,e,t){var i=Qi[r];return i&&((0,b.mf)(i)&&(i=i(e)),i=(0,b.b$)({},xa,i),t)?i[t]:i}function ea(r,e,t){var i=(0,b.U2)(r.get("origin"),"data",ge),u=e.animation,c=Ja(e,i);if(u){var p=zi(u);p&&p(r,c,t)}else r.animate(t.toAttrs,c)}function Zo(r,e,t,i,u){if(lo[t]){var c=lo[t](i),p=zi((0,b.U2)(c,"animation",""));if(p){var g=(0,P.pi)((0,P.pi)((0,P.pi)({},xa.appear),c),e);r.stopAnimate(),p(r,g,{coordinate:i,minYPoint:u,toAttrs:null})}}}var Es="element-background",uu=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.labelShape=[],i.states=[];var u=t.shapeFactory,c=t.container,p=t.offscreenGroup,g=t.elementIndex,_=t.visible,w=_===void 0?!0:_;return i.shapeFactory=u,i.container=c,i.offscreenGroup=p,i.visible=w,i.elementIndex=g,i}return e.prototype.draw=function(t,i){i===void 0&&(i=!1),this.model=t,this.data=t.data,this.shapeType=this.getShapeType(t),this.drawShape(t,i),this.visible===!1&&this.changeVisible(!1)},e.prototype.update=function(t){var i=this,u=i.shapeFactory,c=i.shape;if(!!c){this.model=t,this.data=t.data,this.shapeType=this.getShapeType(t),this.setShapeInfo(c,t);var p=this.getOffscreenGroup(),g=u.drawShape(this.shapeType,t,p);g.cfg.data=this.data,g.cfg.origin=t,g.cfg.element=this,this.syncShapeStyle(c,g,this.getStates(),this.getAnimateCfg("update"))}},e.prototype.destroy=function(){var t=this,i=t.shapeFactory,u=t.shape;if(u){var c=this.getAnimateCfg("leave");c?ea(u,c,{coordinate:i.coordinate,toAttrs:(0,P.pi)({},u.attr())}):u.remove(!0)}this.states=[],this.shapeFactory=void 0,this.container=void 0,this.shape=void 0,this.animate=void 0,this.geometry=void 0,this.labelShape=[],this.model=void 0,this.data=void 0,this.offscreenGroup=void 0,this.statesStyle=void 0,r.prototype.destroy.call(this)},e.prototype.changeVisible=function(t){r.prototype.changeVisible.call(this,t),t?(this.shape&&this.shape.show(),this.labelShape&&this.labelShape.forEach(function(i){i.show()})):(this.shape&&this.shape.hide(),this.labelShape&&this.labelShape.forEach(function(i){i.hide()}))},e.prototype.setState=function(t,i){var u=this,c=u.states,p=u.shapeFactory,g=u.model,_=u.shape,w=u.shapeType,k=c.indexOf(t);if(i){if(k>-1)return;c.push(t),(t==="active"||t==="selected")&&(_==null||_.toFront())}else{if(k===-1)return;if(c.splice(k,1),t==="active"||t==="selected"){var L=this.geometry,R=L.sortZIndex,U=L.zIndexReversed,G=U?this.geometry.elements.length-this.elementIndex:this.elementIndex;R?_.setZIndex(G):_.set("zIndex",G)}}var Q=p.drawShape(w,g,this.getOffscreenGroup());c.length?this.syncShapeStyle(_,Q,c,null):this.syncShapeStyle(_,Q,["reset"],null),Q.remove(!0);var pt={state:t,stateStatus:i,element:this,target:this.container};this.container.emit("statechange",pt),xl(this.shape,"statechange",pt)},e.prototype.clearStates=function(){var t=this,i=this.states;(0,b.S6)(i,function(u){t.setState(u,!1)}),this.states=[]},e.prototype.hasState=function(t){return this.states.includes(t)},e.prototype.getStates=function(){return this.states},e.prototype.getData=function(){return this.data},e.prototype.getModel=function(){return this.model},e.prototype.getBBox=function(){var t=this,i=t.shape,u=t.labelShape,c={x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0};return i&&(c=i.getCanvasBBox()),u&&u.forEach(function(p){var g=p.getCanvasBBox();c.x=Math.min(g.x,c.x),c.y=Math.min(g.y,c.y),c.minX=Math.min(g.minX,c.minX),c.minY=Math.min(g.minY,c.minY),c.maxX=Math.max(g.maxX,c.maxX),c.maxY=Math.max(g.maxY,c.maxY)}),c.width=c.maxX-c.minX,c.height=c.maxY-c.minY,c},e.prototype.getStatesStyle=function(){if(!this.statesStyle){var t=this,i=t.shapeType,u=t.geometry,c=t.shapeFactory,p=u.stateOption,g=c.defaultShapeType,_=c.theme[i]||c.theme[g];this.statesStyle=(0,b.b$)({},_,p)}return this.statesStyle},e.prototype.getStateStyle=function(t,i){var u=this.getStatesStyle(),c=(0,b.U2)(u,[t,"style"],{}),p=c[i]||c;return(0,b.mf)(p)?p(this):p},e.prototype.getAnimateCfg=function(t){var i=this,u=this.animate;if(u){var c=u[t];return c&&(0,P.pi)((0,P.pi)({},c),{callback:function(){var p;(0,b.mf)(c.callback)&&c.callback(),(p=i.geometry)===null||p===void 0||p.emit(et.AFTER_DRAW_ANIMATE)}})}return null},e.prototype.drawShape=function(t,i){var u;i===void 0&&(i=!1);var c=this,p=c.shapeFactory,g=c.container,_=c.shapeType;if(this.shape=p.drawShape(_,t,g),this.shape){this.setShapeInfo(this.shape,t);var w=this.shape.cfg.name;w?(0,b.HD)(w)&&(this.shape.cfg.name=["element",w]):this.shape.cfg.name=["element",this.shapeFactory.geometryType];var k=i?"enter":"appear",L=this.getAnimateCfg(k);L&&((u=this.geometry)===null||u===void 0||u.emit(et.BEFORE_DRAW_ANIMATE),ea(this.shape,L,{coordinate:p.coordinate,toAttrs:(0,P.pi)({},this.shape.attr())}))}},e.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var t=this.container.getGroupBase();this.offscreenGroup=new t({})}return this.offscreenGroup},e.prototype.setShapeInfo=function(t,i){var u=this;if(t.cfg.origin=i,t.cfg.element=this,t.isGroup()){var c=t.get("children");c.forEach(function(p){u.setShapeInfo(p,i)})}},e.prototype.syncShapeStyle=function(t,i,u,c,p){var g=this,_;if(u===void 0&&(u=[]),p===void 0&&(p=0),!(!t||!i)){var w=t.get("clipShape"),k=i.get("clipShape");if(this.syncShapeStyle(w,k,u,c),t.isGroup())for(var L=t.get("children"),R=i.get("children"),U=0;U<L.length;U++)this.syncShapeStyle(L[U],R[U],u,c,p+U);else{if(!(0,b.xb)(u)&&!(0,b.Xy)(u,["reset"])){var G=t.get("name");(0,b.kJ)(G)&&(G=G[1]),(0,b.S6)(u,function(pt){if(i.get("name")!==Es){var vt=g.getStateStyle(pt,G||p);i.attr(vt)}})}var Q=X0(t,i);this.animate?c?((_=this.geometry)===null||_===void 0||_.emit(et.BEFORE_DRAW_ANIMATE),ea(t,c,{coordinate:this.shapeFactory.coordinate,toAttrs:Q,shapeModel:this.model})):(0,b.xb)(u)?t.attr(Q):(t.stopAnimate(),t.animate(Q,{duration:300})):t.attr(Q)}}},e.prototype.getShapeType=function(t){var i=(0,b.U2)(t,"shape");return(0,b.kJ)(i)?i[0]:i},e}(ne),Ws=uu,ks={},eu={};function Qu(r){return ks[r.toLowerCase()]}function lu(r,e){ks[r.toLowerCase()]=e}function Gl(r){return eu[r.toLowerCase()]}function us(r,e){eu[r.toLowerCase()]=e}var Hl={coordinate:null,defaultShapeType:null,theme:null,getShapePoints:function(r,e){var t=this.getShape(r);return t.getPoints?t.getPoints(e):this.getDefaultPoints(e)},getShape:function(r){var e=this[r]||this[this.defaultShapeType];return e.coordinate=this.coordinate,e},getDefaultPoints:function(){return[]},getDefaultStyle:function(r){return(0,b.U2)(r,[this.defaultShapeType,"default","style"],{})},getMarker:function(r,e){var t=this.getShape(r);if(!t.getMarker){var i=this.defaultShapeType;t=this.getShape(i)}var u=this.theme,c=(0,b.U2)(u,[r,"default"],{}),p=t.getMarker(e);return(0,b.b$)({},c,p)},drawShape:function(r,e,t){var i=this.getShape(r);return i.draw(e,t)}},mu={coordinate:null,parsePath:function(r){var e=this.coordinate,t=(0,rf.tr)(r);return e.isPolar?t=Tu(e,t):t=su(e,t),t},parsePoint:function(r){var e=this.coordinate;return e.convert(r)},parsePoints:function(r){var e=this.coordinate;return r.map(function(t){return e.convert(t)})},draw:function(r,e){}},cu={};function ro(r,e){var t=(0,b.jC)(r),i=(0,P.pi)((0,P.pi)((0,P.pi)({},Hl),e),{geometryType:r});return cu[t]=i,i}function va(r,e,t){var i=(0,b.jC)(r),u=cu[i],c=(0,P.pi)((0,P.pi)({},mu),t);return u[e]=c,c}function ts(r){var e=(0,b.jC)(r);return cu[e]}function Do(r,e,t){var i,u;if(t===void 0&&(t={}),!e)return[r];var c=(0,b.Ms)(r,e),p=[];if(e.length===1&&t[e[0]]){var g=t[e[0]];try{for(var _=(0,P.XA)(g),w=_.next();!w.done;w=_.next()){var k=w.value,L=c["_".concat(k)];L&&p.push(L)}}catch(G){i={error:G}}finally{try{w&&!w.done&&(u=_.return)&&u.call(_)}finally{if(i)throw i.error}}}else for(var R in c)if(c.hasOwnProperty(R)){var U=c[R];p.push(U)}return p}function jl(r,e){return(0,b.G)(["color","shape","size","x","y","isInCircle","data","style","defaultStyle","points","mappingData"],function(t){return!(0,b.Xy)(r[t],e[t])})}function Uu(r){return(0,b.kJ)(r)?r:r.split("*")}function Ss(r,e){for(var t=[],i=[],u=[],c=new Map,p=0;p<e.length;p++){var g=e[p];r[g]?i.push(g):t.push(g),c.set(g,!0)}return Object.keys(r).forEach(function(_){c.has(_)||u.push(_)}),{added:t,updated:i,removed:u}}var Pu=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="base",i.attributes={},i.elements=[],i.elementsMap={},i.animateOption=!0,i.attributeOption={},i.lastElementsMap={},i.generatePoints=!1,i.beforeMappingData=null,i.adjusts={},i.idFields=[],i.hasSorted=!1,i.isCoordinateChanged=!1;var u=t.container,c=t.labelsContainer,p=t.coordinate,g=t.data,_=t.sortable,w=_===void 0?!1:_,k=t.visible,L=k===void 0?!0:k,R=t.theme,U=t.scales,G=U===void 0?{}:U,Q=t.scaleDefs,pt=Q===void 0?{}:Q,vt=t.intervalPadding,Vt=t.dodgePadding,le=t.maxColumnWidth,he=t.minColumnWidth,Ne=t.columnWidthRatio,Er=t.roseWidthRatio,Fr=t.multiplePieWidthRatio,zr=t.zIndexReversed,pn=t.sortZIndex,nn=t.useDeferredLabel;return i.container=u,i.labelsContainer=c,i.coordinate=p,i.data=g,i.sortable=w,i.visible=L,i.userTheme=R,i.scales=G,i.scaleDefs=pt,i.intervalPadding=vt,i.dodgePadding=Vt,i.maxColumnWidth=le,i.minColumnWidth=he,i.columnWidthRatio=Ne,i.roseWidthRatio=Er,i.multiplePieWidthRatio=Fr,i.zIndexReversed=zr,i.sortZIndex=pn,i.useDeferredLabel=nn?typeof nn=="number"?nn:1/0:null,i}return e.prototype.position=function(t){var i=t;(0,b.PO)(t)||(i={fields:Uu(t)});var u=(0,b.U2)(i,"fields");return u.length===1&&(u.unshift("1"),(0,b.t8)(i,"fields",u)),(0,b.t8)(this.attributeOption,"position",i),this},e.prototype.color=function(t,i){return this.createAttrOption("color",t,i),this},e.prototype.shape=function(t,i){return this.createAttrOption("shape",t,i),this},e.prototype.size=function(t,i){return this.createAttrOption("size",t,i),this},e.prototype.adjust=function(t){var i=t;return((0,b.HD)(t)||(0,b.PO)(t))&&(i=[t]),(0,b.S6)(i,function(u,c){(0,b.Kn)(u)||(i[c]={type:u})}),this.adjustOption=i,this},e.prototype.style=function(t,i){if((0,b.HD)(t)){var u=Uu(t);this.styleOption={fields:u,callback:i}}else{var c=t,u=c.fields,p=c.callback,g=c.cfg;u||p||g?this.styleOption=t:this.styleOption={cfg:t}}return this},e.prototype.tooltip=function(t,i){if((0,b.HD)(t)){var u=Uu(t);this.tooltipOption={fields:u,callback:i}}else this.tooltipOption=t;return this},e.prototype.animate=function(t){return this.animateOption=t,this},e.prototype.label=function(t,i,u){if((0,b.HD)(t)){var c={},p=Uu(t);c.fields=p,(0,b.mf)(i)?c.callback=i:(0,b.PO)(i)&&(c.cfg=i),u&&(c.cfg=u),this.labelOption=c}else this.labelOption=t;return this},e.prototype.state=function(t){return this.stateOption=t,this},e.prototype.customInfo=function(t){return this.customOption=t,this},e.prototype.init=function(t){t===void 0&&(t={}),this.setCfg(t),this.initAttributes(),this.processData(this.data),this.adjustScale()},e.prototype.update=function(t){t===void 0&&(t={});var i=t.data,u=t.isDataChanged,c=t.isCoordinateChanged,p=this,g=p.attributeOption,_=p.lastAttributeOption;(0,b.Xy)(g,_)?i&&(u||!(0,b.Xy)(i,this.data))?(this.setCfg(t),this.initAttributes(),this.processData(i)):this.setCfg(t):this.init(t),this.adjustScale(),this.isCoordinateChanged=c},e.prototype.paint=function(t){var i=this;t===void 0&&(t=!1),this.animateOption&&(this.animateOption=(0,b.b$)({},To(this.type,this.coordinate),this.animateOption)),this.defaultSize=void 0,this.elementsMap={},this.elements=[];var u=this.getOffscreenGroup();u.clear();var c=this.beforeMappingData,p=this.beforeMapping(c);this.dataArray=new Array(p.length);for(var g=0;g<p.length;g++){var _=p[g];this.dataArray[g]=this.mapping(_)}if(this.updateElements(this.dataArray,t),this.lastElementsMap=this.elementsMap,this.canDoGroupAnimation(t)){var w=this.container,k=this.type,L=this.coordinate,R=(0,b.U2)(this.animateOption,"appear"),U=this.getYScale(),G=L.convert({x:0,y:U.scale(this.getYMinValue())});Zo(w,R,k,L,G)}if(this.labelOption){var Q=this.useDeferredLabel,pt=function(){return i.renderLabels((0,b.xH)(i.dataArray),t)}.bind(this);if(typeof Q=="number"){var vt=typeof Q=="number"&&Q!==1/0?Q:0;if(!window.requestIdleCallback)setTimeout(pt,vt);else{var Vt=vt&&vt!==1/0?{timeout:vt}:void 0;window.requestIdleCallback(pt,Vt)}}else pt()}this.lastAttributeOption=(0,P.pi)({},this.attributeOption),this.visible===!1&&this.changeVisible(!1)},e.prototype.clear=function(){var t=this,i=t.container,u=t.geometryLabel,c=t.offscreenGroup;i&&i.clear(),u&&u.clear(),c&&c.clear(),this.scaleDefs=void 0,this.attributes={},this.scales={},this.elementsMap={},this.lastElementsMap={},this.elements=[],this.adjusts={},this.dataArray=null,this.beforeMappingData=null,this.lastAttributeOption=void 0,this.defaultSize=void 0,this.idFields=[],this.groupScales=void 0,this.hasSorted=!1,this.isCoordinateChanged=!1},e.prototype.destroy=function(){this.clear();var t=this.container;t.remove(!0),this.offscreenGroup&&(this.offscreenGroup.remove(!0),this.offscreenGroup=null),this.geometryLabel&&(this.geometryLabel.destroy(),this.geometryLabel=null),this.theme=void 0,this.shapeFactory=void 0,r.prototype.destroy.call(this)},e.prototype.getGroupScales=function(){return this.groupScales},e.prototype.getAttribute=function(t){return this.attributes[t]},e.prototype.getXScale=function(){return this.getAttribute("position").scales[0]},e.prototype.getYScale=function(){return this.getAttribute("position").scales[1]},e.prototype.getGroupAttributes=function(){var t=[];return(0,b.S6)(this.attributes,function(i){_e.includes(i.type)&&t.push(i)}),t},e.prototype.getDefaultValue=function(t){var i,u=this.getAttribute(t);return u&&(0,b.xb)(u.scales)&&(i=u.values[0]),i},e.prototype.getAttributeValues=function(t,i){for(var u=[],c=t.scales,p=0,g=c.length;p<g;p++){var _=c[p],w=_.field;_.isIdentity?u.push(_.values):u.push(i[w])}return t.mapping.apply(t,(0,P.ev)([],(0,P.CR)(u),!1))},e.prototype.getAdjust=function(t){return this.adjusts[t]},e.prototype.getCoordinate=function(){return this.coordinate},e.prototype.getData=function(){return this.data},e.prototype.getShapeMarker=function(t,i){var u=this.getShapeFactory();return u.getMarker(t,i)},e.prototype.getElementsBy=function(t){return this.elements.filter(function(i){return t(i)})},e.prototype.getElements=function(){return this.elements},e.prototype.getElementId=function(t){t=(0,b.kJ)(t)?t[0]:t;var i=t[ge];if(this.idFields.length){for(var u=i[this.idFields[0]],c=1;c<this.idFields.length;c++)u+="-"+i[this.idFields[c]];return u}var p=this.type,g=this.getXScale(),_=this.getYScale(),w=g.field||"x",k=_.field||"y",L=i[k],R;g.type==="identity"?R=g.values[0]:R=i[w];var U;p==="interval"||p==="schema"?U="".concat(R):p==="line"||p==="area"||p==="path"?U=p:U="".concat(R,"-").concat(L);for(var G=this.groupScales,c=0,Q=G.length;c<Q;c++){var pt=G[c],vt=pt.field;U="".concat(U,"-").concat(i[vt])}var Vt=this.getAdjust("dodge");if(Vt){var le=Vt.dodgeBy;le&&(U="".concat(U,"-").concat(i[le]))}return this.getAdjust("jitter")&&(U="".concat(U,"-").concat(t.x,"-").concat(t.y)),U},e.prototype.getScaleFields=function(){var t=[],i=new Map,u=this,c=u.attributeOption,p=u.labelOption,g=u.tooltipOption;for(var _ in c)if(c.hasOwnProperty(_)){var w=c[_];w.fields?Th(w.fields,t,i):w.values&&Th(w.values,t,i)}return p&&p.fields&&Th(p.fields,t,i),(0,b.Kn)(g)&&g.fields&&Th(g.fields,t,i),t},e.prototype.changeVisible=function(t){r.prototype.changeVisible.call(this,t);for(var i=this.elements,u=0,c=i.length;u<c;u++){var p=i[u];p.changeVisible(t)}t?(this.container&&this.container.show(),this.labelsContainer&&this.labelsContainer.show()):(this.container&&this.container.hide(),this.labelsContainer&&this.labelsContainer.hide())},e.prototype.getFields=function(){var t=new Map,i=[];return Object.values(this.attributeOption).forEach(function(u){var c=(u==null?void 0:u.fields)||[];c.forEach(function(p){t.has(p)||i.push(p),t.set(p,!0)})},[]),i},e.prototype.getGroupFields=function(){for(var t=[],i=new Map,u=0,c=_e.length;u<c;u++){var p=_e[u],g=this.attributeOption[p];g&&g.fields&&Th(g.fields,t,i)}return t},e.prototype.getXYFields=function(){var t=(0,P.CR)(this.attributeOption.position.fields,2),i=t[0],u=t[1];return[i,u]},e.prototype.getXField=function(){return(0,b.U2)(this.getXYFields(),[0])},e.prototype.getYField=function(){return(0,b.U2)(this.getXYFields(),[1])},e.prototype.getShapes=function(){return this.elements.map(function(t){return t.shape})},e.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var t=this.container.getGroupBase();this.offscreenGroup=new t({})}return this.offscreenGroup},e.prototype.sort=function(t){if(!this.hasSorted)for(var i=this.getXScale(),u=i.field,c=0;c<t.length;c++){var p=t[c];p.sort(function(g,_){return i.translate(g[ge][u])-i.translate(_[ge][u])})}this.hasSorted=!0},e.prototype.adjustScale=function(){var t=this.getYScale();t&&this.getAdjust("stack")&&this.updateStackRange(t,this.beforeMappingData)},e.prototype.getShapeFactory=function(){var t=this.shapeType;if(!!ts(t))return this.shapeFactory||(this.shapeFactory=(0,b.d9)(ts(t))),this.shapeFactory.coordinate=this.coordinate,this.shapeFactory.theme=this.theme.geometries[t]||{},this.shapeFactory},e.prototype.createShapePointsCfg=function(t){var i=this.getXScale(),u=this.getYScale(),c=this.normalizeValues(t[i.field],i),p;return u?p=this.normalizeValues(t[u.field],u):p=t.y?t.y:.1,{x:c,y:p,y0:u?u.scale(this.getYMinValue()):void 0}},e.prototype.createElement=function(t,i,u){u===void 0&&(u=!1);var c=this.container,p=this.getDrawCfg(t),g=this.getShapeFactory(),_=new Ws({shapeFactory:g,container:c,offscreenGroup:this.getOffscreenGroup(),elementIndex:i});return _.animate=this.animateOption,_.geometry=this,_.draw(p,u),_},e.prototype.getDrawCfg=function(t){var i=t[ge],u={mappingData:t,data:i,x:t.x,y:t.y,color:t.color,size:t.size,isInCircle:this.coordinate.isPolar,customInfo:this.customOption},c=t.shape;!c&&this.getShapeFactory()&&(c=this.getShapeFactory().defaultShapeType),u.shape=c;var p=this.theme.geometries[this.shapeType];u.defaultStyle=(0,b.U2)(p,[c,"default"],{}).style,!u.defaultStyle&&this.getShapeFactory()&&(u.defaultStyle=this.getShapeFactory().getDefaultStyle(p));var g=this.styleOption;return g&&(u.style=this.getStyleCfg(g,i)),this.generatePoints&&(u.points=t.points,u.nextPoints=t.nextPoints),u},e.prototype.updateElements=function(t,i){var u,c,p,g,_,w;i===void 0&&(i=!1);for(var k=new Map,L=[],R=new Map,U=0,G=0;G<t.length;G++)for(var Q=t[G],pt=0;pt<Q.length;pt++){var vt=Q[pt],Vt=this.getElementId(vt),le=k.has(Vt)?"".concat(Vt,"-").concat(G,"-").concat(pt):Vt;L.push(le),k.set(le,vt),R.set(le,U),U++}this.elements=new Array(U);var he=Ss(this.lastElementsMap,L),Ne=he.added,Er=he.updated,Fr=he.removed;try{for(var zr=(0,P.XA)(Ne),pn=zr.next();!pn.done;pn=zr.next()){var Vt=pn.value,vt=k.get(Vt),G=R.get(Vt),nn=this.createElement(vt,G,i);this.elements[G]=nn,this.elementsMap[Vt]=nn,nn.shape&&nn.shape.set("zIndex",this.zIndexReversed?this.elements.length-G:G)}}catch(Bi){u={error:Bi}}finally{try{pn&&!pn.done&&(c=zr.return)&&c.call(zr)}finally{if(u)throw u.error}}try{for(var Pn=(0,P.XA)(Er),Si=Pn.next();!Si.done;Si=Pn.next()){var Vt=Si.value,nn=this.lastElementsMap[Vt],vt=k.get(Vt),ha=this.getDrawCfg(vt),wa=nn.getModel(),G=R.get(Vt);(this.isCoordinateChanged||jl(ha,wa))&&(nn.animate=this.animateOption,nn.update(ha)),this.elements[G]=nn,this.elementsMap[Vt]=nn,nn.shape&&nn.shape.set("zIndex",this.zIndexReversed?this.elements.length-G:G)}}catch(Bi){p={error:Bi}}finally{try{Si&&!Si.done&&(g=Pn.return)&&g.call(Pn)}finally{if(p)throw p.error}}this.container&&this.container.sort();try{for(var _o=(0,P.XA)(Fr),Vn=_o.next();!Vn.done;Vn=_o.next()){var Vt=Vn.value,nn=this.lastElementsMap[Vt];nn.animate=this.animateOption,nn.destroy()}}catch(Bi){_={error:Bi}}finally{try{Vn&&!Vn.done&&(w=_o.return)&&w.call(_o)}finally{if(_)throw _.error}}},e.prototype.getLabelType=function(){var t=this,i=t.labelOption,u=t.coordinate,c=t.type,p=u.type,g=u.isTransposed,_=(0,b.U2)(i,["cfg","type"]);return _||(p==="polar"?_=g?"pie":"polar":p==="theta"?_="pie":c==="interval"||c==="polygon"?_="interval":_="base"),_},e.prototype.getYMinValue=function(){var t=this.getYScale(),i=t.min,u=t.max,c;return i>=0?c=i:u<=0?c=u:c=0,c},e.prototype.createAttrOption=function(t,i,u){if((0,b.UM)(i)||(0,b.Kn)(i))(0,b.Kn)(i)&&(0,b.Xy)(Object.keys(i),["values"])?(0,b.t8)(this.attributeOption,t,{fields:i.values}):(0,b.t8)(this.attributeOption,t,i);else{var c={};(0,b.hj)(i)?c.values=[i]:c.fields=Uu(i),u&&((0,b.mf)(u)?c.callback=u:c.values=u),(0,b.t8)(this.attributeOption,t,c)}},e.prototype.initAttributes=function(){var t=this,i=this,u=i.attributes,c=i.attributeOption,p=i.theme,g=i.shapeType;this.groupScales=[];var _={},w=function(R){if(c.hasOwnProperty(R)){var U=c[R];if(!U)return{value:void 0};var G=(0,P.pi)({},U),Q=G.callback,pt=G.values,vt=G.fields,Vt=vt===void 0?[]:vt,le=Vt.map(function(Ne){var Er=t.scales[Ne];if(!_[Ne]&&_e.includes(R)){var Fr=dr(Er,(0,b.U2)(t.scaleDefs,Ne),R,t.type);Fr==="cat"&&(t.groupScales.push(Er),_[Ne]=!0)}return Er});G.scales=le,R!=="position"&&le.length===1&&le[0].type==="identity"?G.values=le[0].values:!Q&&!pt&&(R==="size"?G.values=p.sizes:R==="shape"?G.values=p.shapes[g]||[]:R==="color"&&(le.length?G.values=le[0].values.length<=10?p.colors10:p.colors20:G.values=p.colors10));var he=Ai(R);u[R]=new he(G)}};for(var k in c){var L=w(k);if(typeof L=="object")return L.value}},e.prototype.processData=function(t){var i,u;this.hasSorted=!1;for(var c=this.getAttribute("position").scales,p=c.filter(function(Fr){return Fr.isCategory}),g=this.groupData(t),_=[],w=0,k=g.length;w<k;w++){for(var L=g[w],R=[],U=0,G=L.length;U<G;U++){var Q=L[U],pt={};for(var vt in Q)pt[vt]=Q[vt];pt[ge]=Q;try{for(var Vt=(i=void 0,(0,P.XA)(p)),le=Vt.next();!le.done;le=Vt.next()){var he=le.value,Ne=he.field;pt[Ne]=he.translate(pt[Ne])}}catch(Fr){i={error:Fr}}finally{try{le&&!le.done&&(u=Vt.return)&&u.call(Vt)}finally{if(i)throw i.error}}R.push(pt)}_.push(R)}var Er=this.adjustData(_);return this.beforeMappingData=Er,Er},e.prototype.adjustData=function(t){var i=this.adjustOption,u=this,c=u.intervalPadding,p=u.dodgePadding,g=u.theme,_=this.maxColumnWidth||g.maxColumnWidth,w=this.minColumnWidth||g.minColumnWidth,k=this.columnWidthRatio||g.columnWidthRatio,L=t;if(i){var R=this.getXScale(),U=this.getYScale(),G=R.field,Q=U?U.field:null,pt=th(this.coordinate),vt=R.values.length,Vt=this.getAttribute("size"),le=void 0;Vt&&(le=Vt.values[0]);for(var he=0,Ne=i.length;he<Ne;he++){var Er=i[he],Fr=(0,P.pi)({xField:G,yField:Q,intervalPadding:c,dodgePadding:p,xDimensionLength:pt,groupNum:vt,defaultSize:le,maxColumnWidth:_,minColumnWidth:w,columnWidthRatio:k},Er),zr=Er.type;if(zr==="dodge"){var pn=[];if(R.isCategory||R.type==="identity")pn.push("x");else if(!U)pn.push("y");else throw new Error("dodge is not support linear attribute, please use category attribute!");Fr.adjustNames=pn,Fr.dodgeRatio=k}else if(zr==="stack"){var nn=this.coordinate;if(!U){Fr.height=nn.getHeight();var Pn=this.getDefaultValue("size")||3;Fr.size=Pn}!nn.isTransposed&&(0,b.UM)(Fr.reverseOrder)&&(Fr.reverseOrder=!0)}var Si=Yt(zr);Fr.dimValuesMap={},R&&R.values&&(Fr.dimValuesMap[R.field]=R.values.map(function(wa){return R.translate(wa)}));var ha=new Si(Fr);L=ha.process(L),this.adjusts[zr]=ha}}return L},e.prototype.groupData=function(t){for(var i=this.getGroupScales(),u=this.scaleDefs,c={},p=[],g=0;g<i.length;g++){var _=i[g],w=_.field;p.push(w),(0,b.U2)(u,[w,"values"])&&(c[w]=u[w].values)}return Do(t,p,c)},e.prototype.updateStackRange=function(t,i){for(var u=(0,b.xH)(i),c=t.field,p=t.min,g=t.max,_=0;_<u.length;_++){var w=u[_],k=Math.min.apply(null,w[c]),L=Math.max.apply(null,w[c]);k<p&&(p=k),L>g&&(g=L)}var R=this.scaleDefs,U={};p<t.min&&!(0,b.U2)(R,[c,"min"])&&(U.min=p),g>t.max&&!(0,b.U2)(R,[c,"max"])&&(U.max=g),t.change(U)},e.prototype.beforeMapping=function(t){var i=t;if(this.sortable&&this.sort(i),this.generatePoints)for(var u=0,c=i.length;u<c;u++){var p=i[u];this.generateShapePoints(p);var g=i[u+1];g&&(this.generateShapePoints(g),p[0].nextPoints=g[0].points)}return i},e.prototype.generateShapePoints=function(t){for(var i=this.getShapeFactory(),u=this.getAttribute("shape"),c=0;c<t.length;c++){var p=t[c],g=this.createShapePointsCfg(p),_=u?this.getAttributeValues(u,p):null,w=i.getShapePoints(_,g);p.points=w}},e.prototype.normalizeValues=function(t,i){var u=[];if((0,b.kJ)(t))for(var c=0;c<t.length;c++){var p=t[c];u.push(i.scale(p))}else u=i.scale(t);return u},e.prototype.mapping=function(t){for(var i=this.attributes,u=[],c=0;c<t.length;c++){var p=t[c],g={_origin:p[ge],points:p.points,nextPoints:p.nextPoints};for(var _ in i)if(i.hasOwnProperty(_)){var w=i[_],k=w.names,L=this.getAttributeValues(w,p);if(k.length>1)for(var R=0;R<L.length;R+=1){var U=L[R],G=k[R];g[G]=(0,b.kJ)(U)&&U.length===1?U[0]:U}else g[k[0]]=L.length===1?L[0]:L}this.convertPoint(g),u.push(g)}return u},e.prototype.convertPoint=function(t){var i=t.x,u=t.y,c,p,g,_=this.coordinate;if((0,b.kJ)(i)&&(0,b.kJ)(u)){c=[],p=[];for(var w=0,k=0,L=i.length,R=u.length;w<L&&k<R;w+=1,k+=1)g=_.convert({x:i[w],y:u[k]}),c.push(g.x),p.push(g.y)}else if((0,b.kJ)(u)){p=[];for(var U=0;U<u.length;U++){var G=u[U];g=_.convert({x:i,y:G}),c&&c!==g.x?((0,b.kJ)(c)||(c=[c]),c.push(g.x)):c=g.x,p.push(g.y)}}else if((0,b.kJ)(i)){c=[];for(var U=0;U<i.length;U++){var Q=i[U];g=_.convert({x:Q,y:u}),p&&p!==g.y?((0,b.kJ)(p)||(p=[p]),p.push(g.y)):p=g.y,c.push(g.x)}}else{var pt=_.convert({x:i,y:u});c=pt.x,p=pt.y}t.x=c,t.y=p},e.prototype.getStyleCfg=function(t,i){var u=t.fields,c=u===void 0?[]:u,p=t.callback,g=t.cfg;if(g)return g;var _=c.map(function(w){return i[w]});return p.apply(void 0,(0,P.ev)([],(0,P.CR)(_),!1))},e.prototype.setCfg=function(t){var i=this,u=t.coordinate,c=t.data,p=t.theme,g=t.scaleDefs;u&&(this.coordinate=u),c&&(this.data=c),g&&(this.scaleDefs=g,this.idFields=[],(0,b.S6)(g,function(_,w){_&&_.key&&i.idFields.push(w)})),p&&(this.theme=this.userTheme?(0,b.b$)({},p,this.userTheme):p)},e.prototype.renderLabels=function(t,i){return i===void 0&&(i=!1),(0,P.mG)(this,void 0,void 0,function(){var u,c,p,g,_,w,k,L,R,U,G,Q,pt=this;return(0,P.Jh)(this,function(vt){switch(vt.label){case 0:return u=this.geometryLabel,this.emit(et.BEFORE_RENDER_LABEL),u||(c=this.getLabelType(),p=Qu(c),u=new p(this),this.geometryLabel=u),[4,u.render(t,i)];case 1:vt.sent(),g=u.labelsRenderer.shapesMap,_=new Map,(0,b.S6)(g,function(Vt,le){for(var he=Vt.getChildren()||[],Ne=0;Ne<he.length;Ne++){var Er=he[Ne],Fr=pt.elementsMap[Er.get("elementId")||le.split(" ")[0]];if(Fr){Er.cfg.name=["element","label"],Er.cfg.element=Fr;var zr=_.get(Fr)||new Set;zr.add(Vt),_.set(Fr,zr)}}});try{for(w=(0,P.XA)(_.entries()),k=w.next();!k.done;k=w.next())L=(0,P.CR)(k.value,2),R=L[0],U=L[1],R.labelShape=(0,P.ev)([],(0,P.CR)(U),!1)}catch(Vt){G={error:Vt}}finally{try{k&&!k.done&&(Q=w.return)&&Q.call(w)}finally{if(G)throw G.error}}return this.emit(et.AFTER_RENDER_LABEL),[2]}})})},e.prototype.canDoGroupAnimation=function(t){return!t&&this.animateOption&&((0,b.U2)(this.animateOption,"appear")===void 0||(0,b.U2)(this.animateOption,"appear")&&(0,b.U2)(this.animateOption,["appear","animation"])===void 0)},e}(ne),fu=Pu,Oo=ma.vs;function cf(r,e,t){var i=Oo(r.getMatrix(),[["t",e,t]]);r.setMatrix(i)}function ff(r,e){var t=r.attr(),i=t.x,u=t.y,c=Oo(r.getMatrix(),[["t",-i,-u],["r",e],["t",i,u]]);return c}function nh(r,e){var t=ff(r,e);r.setMatrix(t)}function ru(){return[1,0,0,0,1,0,0,0,1]}function kh(r,e){var t=r.getBBox(),i=(t.minX+t.maxX)/2,u=(t.minY+t.maxY)/2;r.applyToMatrix([i,u,1]);var c=Oo(r.getMatrix(),[["t",-i,-u],["s",e,e],["t",i,u]]);r.setMatrix(c)}function fl(r){return r.find(function(e){return e.get("type")==="text"})}function Qp(r,e,t){t===void 0&&(t=[0,0,0,0]);var i=r&&r.getChildren()[0];if(i){var u=i.clone();e!=null&&e.rotate&&nh(u,-e.rotate);var c=u.getCanvasBBox(),p=c.x,g=c.y,_=c.width,w=c.height;u.destroy();var k=t;return(0,b.UM)(k)?k=[2,2,2,2]:(0,b.hj)(k)&&(k=new Array(4).fill(k)),{x:p-k[3],y:g-k[0],width:_+k[1]+k[3],height:w+k[0]+k[2],rotation:(e==null?void 0:e.rotate)||0}}return{x:0,y:0,width:0,height:0,rotation:0}}function Pl(r,e,t){t===void 0&&(t=0);var i=Math.max(0,Math.min(r.x+r.width+t,e.x+e.width+t)-Math.max(r.x-t,e.x-t)),u=Math.max(0,Math.min(r.y+r.height+t,e.y+e.height+t)-Math.max(r.y-t,e.y-t));return i*u}function Lf(r,e){var t=r.getBBox();return(0,b.G)(e,function(i){var u=i.getBBox();return Pl(t,u,2)>0})}function ih(r,e,t){var i=t.data,u=t.origin,c=t.animateCfg,p=t.coordinate,g=(0,b.U2)(c,"update");r.set("data",i),r.set("origin",u),r.set("animateCfg",c),r.set("coordinate",p),r.set("visible",e.get("visible")),(r.getChildren()||[]).forEach(function(_,w){var k=e.getChildByIndex(w);if(!k)r.removeChild(_),_.remove(!0);else{_.set("data",i),_.set("origin",u),_.set("animateCfg",c),_.set("coordinate",p);var L=X0(_,k);g?ea(_,g,{toAttrs:L,coordinate:p}):_.attr(L),k.isGroup()&&ih(_,k,t)}}),(0,b.S6)(e.getChildren(),function(_,w){w>=r.getCount()&&(_.destroyed||r.add(_))})}var Nd=function(){function r(e){this.shapesMap={};var t=e.layout,i=e.container;this.layout=t,this.container=i}return r.prototype.render=function(e,t,i){return i===void 0&&(i=!1),(0,P.mG)(this,void 0,void 0,function(){var u,c,p,g,_,w,k,L,R=this;return(0,P.Jh)(this,function(U){switch(U.label){case 0:if(u={},c=this.createOffscreenGroup(),!e.length)return[3,2];try{for(p=(0,P.XA)(e),g=p.next();!g.done;g=p.next())_=g.value,_&&(u[_.id]=this.renderLabel(_,c))}catch(G){k={error:G}}finally{try{g&&!g.done&&(L=p.return)&&L.call(p)}finally{if(k)throw k.error}}return[4,this.doLayout(e,t,u)];case 1:U.sent(),this.renderLabelLine(e,u),this.renderLabelBackground(e,u),this.adjustLabel(e,u),U.label=2;case 2:return w=this.shapesMap,(0,b.S6)(u,function(G,Q){if(G.destroyed)delete u[Q];else{if(w[Q]){var pt=G.get("data"),vt=G.get("origin"),Vt=G.get("coordinate"),le=G.get("animateCfg"),he=w[Q];ih(he,u[Q],{data:pt,origin:vt,animateCfg:le,coordinate:Vt}),u[Q]=he}else{if(R.container.destroyed)return;R.container.add(G);var Ne=(0,b.U2)(G.get("animateCfg"),i?"enter":"appear");Ne&&ea(G,Ne,{toAttrs:(0,P.pi)({},G.attr()),coordinate:G.get("coordinate")})}delete w[Q]}}),(0,b.S6)(w,function(G){var Q=(0,b.U2)(G.get("animateCfg"),"leave");Q?ea(G,Q,{toAttrs:null,coordinate:G.get("coordinate")}):G.remove(!0)}),this.shapesMap=u,c.destroy(),[2]}})})},r.prototype.clear=function(){this.container.clear(),this.shapesMap={}},r.prototype.destroy=function(){this.container.destroy(),this.shapesMap=null},r.prototype.renderLabel=function(e,t){var i=e.id,u=e.elementId,c=e.data,p=e.mappingData,g=e.coordinate,_=e.animate,w=e.content,k=e.capture,L={id:i,elementId:u,capture:k,data:c,origin:(0,P.pi)((0,P.pi)({},p),{data:p[ge]}),coordinate:g},R=t.addGroup((0,P.pi)({name:"label",animateCfg:this.animate===!1||_===null||_===!1?!1:(0,b.b$)({},this.animate,_)},L)),U;if(w.isGroup&&w.isGroup()||w.isShape&&w.isShape()){var G=w.getCanvasBBox(),Q=G.width,pt=G.height,vt=(0,b.U2)(e,"textAlign","left"),Vt=e.x,le=e.y-pt/2;vt==="center"?Vt=Vt-Q/2:(vt==="right"||vt==="end")&&(Vt=Vt-Q),cf(w,Vt,le),U=w,R.add(w)}else{var he=(0,b.U2)(e,["style","fill"]);U=R.addShape("text",(0,P.pi)({attrs:(0,P.pi)((0,P.pi)({x:e.x,y:e.y,textAlign:e.textAlign,textBaseline:(0,b.U2)(e,"textBaseline","middle"),text:e.content},e.style),{fill:(0,b.Ft)(he)?e.color:he})},L))}return e.rotate&&nh(U,e.rotate),R},r.prototype.doLayout=function(e,t,i){return(0,P.mG)(this,void 0,void 0,function(){var u,c=this;return(0,P.Jh)(this,function(p){switch(p.label){case 0:return this.layout?(u=(0,b.kJ)(this.layout)?this.layout:[this.layout],[4,Promise.all(u.map(function(g){var _=Gl((0,b.U2)(g,"type",""));if(!!_){var w=[],k=[];return(0,b.S6)(i,function(L,R){w.push(L),k.push(t[L.get("elementId")])}),_(e,w,k,c.region,g.cfg)}}))]):[3,2];case 1:p.sent(),p.label=2;case 2:return[2]}})})},r.prototype.renderLabelLine=function(e,t){(0,b.S6)(e,function(i){var u=(0,b.U2)(i,"coordinate");if(!(!i||!u)){var c=u.getCenter(),p=u.getRadius();if(!!i.labelLine){var g=(0,b.U2)(i,"labelLine",{}),_=i.id,w=g.path;if(!w){var k=co(c.x,c.y,p,i.angle);w=[["M",k.x,k.y],["L",i.x,i.y]]}var L=t[_];L.destroyed||L.addShape("path",{capture:!1,attrs:(0,P.pi)({path:w,stroke:i.color?i.color:(0,b.U2)(i,["style","fill"],"#000"),fill:null},g.style),id:_,origin:i.mappingData,data:i.data,coordinate:i.coordinate})}}})},r.prototype.renderLabelBackground=function(e,t){(0,b.S6)(e,function(i){var u=(0,b.U2)(i,"coordinate"),c=(0,b.U2)(i,"background");if(!(!c||!u)){var p=i.id,g=t[p];if(!g.destroyed){var _=g.getChildren()[0];if(_){var w=Qp(g,i,c.padding),k=w.rotation,L=(0,P._T)(w,["rotation"]),R=g.addShape("rect",{attrs:(0,P.pi)((0,P.pi)({},L),c.style||{}),id:p,origin:i.mappingData,data:i.data,coordinate:i.coordinate});if(R.setZIndex(-1),k){var U=_.getMatrix();R.setMatrix(U)}}}}})},r.prototype.createOffscreenGroup=function(){var e=this.container,t=e.getGroupBase(),i=new t({});return i},r.prototype.adjustLabel=function(e,t){(0,b.S6)(e,function(i){if(i){var u=i.id,c=t[u];if(!c.destroyed){var p=c.findAll(function(g){return g.get("type")!=="path"});(0,b.S6)(p,function(g){g&&(i.offsetX&&g.attr("x",g.attr("x")+i.offsetX),i.offsetY&&g.attr("y",g.attr("y")+i.offsetY))})}}})},r}(),a0=Nd;function fp(r){var e=0;return(0,b.S6)(r,function(t){e+=t}),e/r.length}var yv=function(){function r(e){this.geometry=e}return r.prototype.getLabelItems=function(e){var t=this,i=[],u=this.getLabelCfgs(e);return(0,b.S6)(e,function(c,p){var g=u[p];if(!g||(0,b.UM)(c.x)||(0,b.UM)(c.y)){i.push(null);return}var _=(0,b.kJ)(g.content)?g.content:[g.content];g.content=_;var w=_.length;(0,b.S6)(_,function(k,L){if((0,b.UM)(k)||k===""){i.push(null);return}var R=(0,P.pi)((0,P.pi)({},g),t.getLabelPoint(g,c,L));R.textAlign||(R.textAlign=t.getLabelAlign(R,L,w)),R.offset<=0&&(R.labelLine=null),i.push(R)})}),i},r.prototype.render=function(e,t){return t===void 0&&(t=!1),(0,P.mG)(this,void 0,void 0,function(){var i,u,c;return(0,P.Jh)(this,function(p){switch(p.label){case 0:return i=this.getLabelItems(e),u=this.getLabelsRenderer(),c=this.getGeometryShapes(),[4,u.render(i,c,t)];case 1:return p.sent(),[2]}})})},r.prototype.clear=function(){var e=this.labelsRenderer;e&&e.clear()},r.prototype.destroy=function(){var e=this.labelsRenderer;e&&e.destroy(),this.labelsRenderer=null},r.prototype.getCoordinate=function(){return this.geometry.coordinate},r.prototype.getDefaultLabelCfg=function(e,t){var i=this.geometry,u=i.type,c=i.theme;return u==="polygon"||u==="interval"&&t==="middle"||e<0&&!["line","point","path"].includes(u)?(0,b.U2)(c,"innerLabels",{}):(0,b.U2)(c,"labels",{})},r.prototype.getThemedLabelCfg=function(e){var t=this.geometry,i=this.getDefaultLabelCfg(),u=t.type,c=t.theme,p;return u==="polygon"||e.offset<0&&!["line","point","path"].includes(u)?p=(0,b.b$)({},i,c.innerLabels,e):p=(0,b.b$)({},i,c.labels,e),p},r.prototype.setLabelPosition=function(e,t,i,u){},r.prototype.getLabelOffset=function(e){var t=this.getCoordinate(),i=this.getOffsetVector(e);return t.isTransposed?i[0]:i[1]},r.prototype.getLabelOffsetPoint=function(e,t,i){var u=e.offset,c=this.getCoordinate(),p=c.isTransposed,g=p?"x":"y",_=p?1:-1,w={x:0,y:0};return t>0||i===1?w[g]=u*_:w[g]=u*_*-1,w},r.prototype.getLabelPoint=function(e,t,i){var u=this.getCoordinate(),c=e.content.length;function p(pt,vt,Vt){Vt===void 0&&(Vt=!1);var le=pt;return(0,b.kJ)(le)&&(e.content.length===1?Vt?le=fp(le):le.length<=2?le=le[pt.length-1]:le=fp(le):le=le[vt]),le}var g={content:e.content[i],x:0,y:0,start:{x:0,y:0},color:"#fff"},_=(0,b.kJ)(t.shape)?t.shape[0]:t.shape,w=_==="funnel"||_==="pyramid";if(this.geometry.type==="polygon"){var k=Bd(t.x,t.y);g.x=k[0],g.y=k[1]}else this.geometry.type==="interval"&&!w?(g.x=p(t.x,i,!0),g.y=p(t.y,i)):(g.x=p(t.x,i),g.y=p(t.y,i));if(w){var L=(0,b.U2)(t,"nextPoints"),R=(0,b.U2)(t,"points");if(L){var U=u.convert(R[1]),G=u.convert(L[1]);g.x=(U.x+G.x)/2,g.y=(U.y+G.y)/2}else if(_==="pyramid"){var U=u.convert(R[1]),G=u.convert(R[2]);g.x=(U.x+G.x)/2,g.y=(U.y+G.y)/2}}e.position&&this.setLabelPosition(g,t,i,e.position);var Q=this.getLabelOffsetPoint(e,i,c);return g.start={x:g.x,y:g.y},g.x+=Q.x,g.y+=Q.y,g.color=t.color,g},r.prototype.getLabelAlign=function(e,t,i){var u="center",c=this.getCoordinate();if(c.isTransposed){var p=e.offset;p<0?u="right":p===0?u="center":u="left",i>1&&t===0&&(u==="right"?u="left":u==="left"&&(u="right"))}return u},r.prototype.getLabelId=function(e){var t=this.geometry,i=t.type,u=t.getXScale(),c=t.getYScale(),p=e[ge],g=t.getElementId(e);return i==="line"||i==="area"?g+=" ".concat(p[u.field]):i==="path"&&(g+=" ".concat(p[u.field],"-").concat(p[c.field])),g},r.prototype.getLabelsRenderer=function(){var e=this.geometry,t=e.labelsContainer,i=e.labelOption,u=e.canvasRegion,c=e.animateOption,p=this.geometry.coordinate,g=this.labelsRenderer;return g||(g=new a0({container:t,layout:(0,b.U2)(i,["cfg","layout"],{type:this.defaultLayout})}),this.labelsRenderer=g),g.region=u,g.animate=c?To("label",p):!1,g},r.prototype.getLabelCfgs=function(e){var t=this,i=this.geometry,u=i.labelOption,c=i.scales,p=i.coordinate,g=u,_=g.fields,w=g.callback,k=g.cfg,L=_.map(function(U){return c[U]}),R=[];return(0,b.S6)(e,function(U,G){var Q=U[ge],pt=t.getLabelText(Q,L),vt;if(w){var Vt=_.map(function(Fr){return Q[Fr]});if(vt=w.apply(void 0,(0,P.ev)([],(0,P.CR)(Vt),!1)),(0,b.UM)(vt)){R.push(null);return}}var le=(0,P.pi)((0,P.pi)({id:t.getLabelId(U),elementId:t.geometry.getElementId(U),data:Q,mappingData:U,coordinate:p},k),vt);(0,b.mf)(le.position)&&(le.position=le.position(Q,U,G));var he=t.getLabelOffset(le.offset||0),Ne=t.getDefaultLabelCfg(he,le.position);le=(0,b.b$)({},Ne,le),le.offset=t.getLabelOffset(le.offset||0);var Er=le.content;(0,b.mf)(Er)?le.content=Er(Q,U,G):(0,b.o8)(Er)&&(le.content=pt[0]),R.push(le)}),R},r.prototype.getLabelText=function(e,t){var i=[];return(0,b.S6)(t,function(u){var c=e[u.field];(0,b.kJ)(c)?c=c.map(function(p){return u.getText(p)}):c=u.getText(c),(0,b.UM)(c)||c===""?i.push(null):i.push(c)}),i},r.prototype.getOffsetVector=function(e){e===void 0&&(e=0);var t=this.getCoordinate(),i=0;return(0,b.hj)(e)&&(i=e),t.isTransposed?t.applyMatrix(i,0):t.applyMatrix(0,i)},r.prototype.getGeometryShapes=function(){var e=this.geometry,t={};return(0,b.S6)(e.elementsMap,function(i,u){t[u]=i.shape}),(0,b.S6)(e.getOffscreenGroup().getChildren(),function(i){var u=e.getElementId(i.get("origin").mappingData);t[u]=i}),t},r}(),zd=yv;function _v(r,e,t){if(!r)return t;var i;if(r.callback&&r.callback.length>1){var u=Array(r.callback.length-1).fill("");i=r.mapping.apply(r,(0,P.ev)([e],(0,P.CR)(u),!1)).join("")}else i=r.mapping(e).join("");return i||t}var yc={hexagon:function(r,e,t){var i=t/2*Math.sqrt(3);return[["M",r,e-t],["L",r+i,e-t/2],["L",r+i,e+t/2],["L",r,e+t],["L",r-i,e+t/2],["L",r-i,e-t/2],["Z"]]},bowtie:function(r,e,t){var i=t-1.5;return[["M",r-t,e-i],["L",r+t,e+i],["L",r+t,e-i],["L",r-t,e+i],["Z"]]},cross:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e+t],["M",r+t,e-t],["L",r-t,e+t]]},tick:function(r,e,t){return[["M",r-t/2,e-t],["L",r+t/2,e-t],["M",r,e-t],["L",r,e+t],["M",r-t/2,e+t],["L",r+t/2,e+t]]},plus:function(r,e,t){return[["M",r-t,e],["L",r+t,e],["M",r,e-t],["L",r,e+t]]},hyphen:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},line:function(r,e,t){return[["M",r,e-t],["L",r,e+t]]}},hp=["line","cross","tick","plus","hyphen"];function Zu(r,e){return(0,b.mf)(e)?e(r):(0,b.b$)({},r,e)}function pp(r,e){var t=r.symbol;if((0,b.HD)(t)&&hp.indexOf(t)!==-1){var i=(0,b.U2)(r,"style",{}),u=(0,b.U2)(i,"lineWidth",1),c=i.stroke||i.fill||e;r.style=(0,b.b$)({},r.style,{lineWidth:u,stroke:c,fill:null})}}function Jp(r){var e=r.symbol;(0,b.HD)(e)&&yc[e]&&(r.symbol=yc[e])}function Ud(r){return r.startsWith(fe.LEFT)||r.startsWith(fe.RIGHT)?"vertical":"horizontal"}function Zd(r,e,t,i,u){var c=t.getScale(t.type);if(c.isCategory){var p=c.field,g=e.getAttribute("color"),_=e.getAttribute("shape"),w=r.getTheme().defaultColor,k=e.coordinate.isPolar;return c.getTicks().map(function(L,R){var U,G=L.text,Q=L.value,pt=G,vt=c.invert(Q),Vt=r.filterFieldData(p,[(U={},U[p]=vt,U)]).length===0;(0,b.S6)(r.views,function(Fr){var zr;Fr.filterFieldData(p,[(zr={},zr[p]=vt,zr)]).length||(Vt=!0)});var le=_v(g,vt,w),he=_v(_,vt,"point"),Ne=e.getShapeMarker(he,{color:le,isInPolar:k}),Er=u;return(0,b.mf)(Er)&&(Er=Er(pt,R,(0,P.pi)({name:pt,value:vt},(0,b.b$)({},i,Ne)))),Ne=(0,b.b$)({},i,Ne,ic((0,P.pi)({},Er),["style"])),pp(Ne,le),Er&&Er.style&&(Ne.style=Zu(Ne.style,Er.style)),Jp(Ne),{id:vt,name:pt,value:vt,marker:Ne,unchecked:Vt}})}return[]}function xv(r,e,t){return t.map(function(i,u){var c=e;(0,b.mf)(c)&&(c=c(i.name,u,(0,b.b$)({},r,i)));var p=(0,b.mf)(i.marker)?i.marker(i.name,u,(0,b.b$)({},r,i)):i.marker,g=(0,b.b$)({},r,c,p);return Jp(g),i.marker=g,i})}function bv(r,e){var t=(0,b.U2)(r,["components","legend"],{});return(0,b.b$)({},(0,b.U2)(t,["common"],{}),(0,b.b$)({},(0,b.U2)(t,[e],{})))}function Ev(r){return r?!1:r==null||isNaN(r)}function Sv(r){if((0,b.kJ)(r))return Ev(r[1].y);var e=r.y;return(0,b.kJ)(e)?Ev(e[0]):Ev(e)}function td(r,e,t){if(e===void 0&&(e=!1),t===void 0&&(t=!0),!r.length||r.length===1&&!t)return[];if(e){for(var i=[],u=0,c=r.length;u<c;u++){var p=r[u];Sv(p)||i.push(p)}return[i]}for(var g=[],_=[],u=0,c=r.length;u<c;u++){var p=r[u];Sv(p)?_.length&&(_.length===1&&!t||g.push(_),_=[]):_.push(p)}return _.length&&g.push(_),g}function wv(r){for(var e=[],t=0;t<r.length;t++){var i=r[t];if(i){var u=t===0?"M":"L";e.push([u,i.x,i.y])}}var c=r[0];return c&&(e.push(["L",c.x,c.y]),e.push(["z"])),e}function o0(r){for(var e=r.length/2,t=[],i=[],u=0;u<r.length;u++)u<e?t.push(r[u]):i.push(r[u]);var c=Qs(t,!1),p=Qs(i,!1);i.length&&c.push(["L",i[0].x,i[0].y]),p.shift();var g=c.concat(p);return t.length&&g.push(["L",t[0].x,t[0].y]),g.push(["z"]),g}function Us(r,e,t,i){i===void 0&&(i="");var u=r.style,c=u===void 0?{}:u,p=r.defaultStyle,g=r.color,_=r.size,w=(0,P.pi)((0,P.pi)({},p),c);return g&&(e&&(c.stroke||(w.stroke=g)),t&&(c.fill||(w.fill=g))),i&&(0,b.UM)(c[i])&&!(0,b.UM)(_)&&(w[i]=_),w}function Kt(r){return(0,b.b$)({},{fill:"#CCD6EC",fillOpacity:.3},(0,b.U2)(r,["background","style"]))}function dp(r){var e=r.x,t=(0,b.kJ)(r.y)?r.y:[r.y];return t.map(function(i,u){return{x:(0,b.kJ)(e)?e[u]:e,y:i}})}var Cv={line:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},dot:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},dash:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},smooth:function(r,e,t){return[["M",r-t,e],["A",t/2,t/2,0,1,1,r,e],["A",t/2,t/2,0,1,0,r+t,e]]},hv:function(r,e,t){return[["M",r-t-1,e-2.5],["L",r,e-2.5],["L",r,e+2.5],["L",r+t+1,e+2.5]]},vh:function(r,e,t){return[["M",r-t-1,e+2.5],["L",r,e+2.5],["L",r,e-2.5],["L",r+t+1,e-2.5]]},hvh:function(r,e,t){return[["M",r-(t+1),e+2.5],["L",r-t/2,e+2.5],["L",r-t/2,e-2.5],["L",r+t/2,e-2.5],["L",r+t/2,e+2.5],["L",r+t+1,e+2.5]]},vhv:function(r,e){return[["M",r-5,e+2.5],["L",r-5,e],["L",r,e],["L",r,e-3],["L",r,e+3],["L",r+6.5,e+3]]}};function vp(r,e){var t=r.color;return{symbol:Cv[e],style:{lineWidth:2,r:6,stroke:t}}}function Av(r,e,t){for(var i=r.isStack,u=r.connectNulls,c=r.isInCircle,p=r.showSinglePoint,g=Us(r,!0,!1,"lineWidth"),_=td(r.points,u,p),w=[],k=0,L=_.length;k<L;k++){var R=_[k];w=w.concat(Q0(R,c,i,e,t,g))}return g.path=w,g}function gp(r,e,t,i,u){if(r.length===1)return[["M",r[0].x,r[0].y-u.lineWidth/2],["L",r[0].x,r[0].y],["L",r[0].x,r[0].y+u.lineWidth/2]];var c;return t?(e&&r.length&&r.push({x:r[0].x,y:r[0].y}),c=Qs(r,!1,i)):(c=Xo(r,!1),e&&c.push(["Z"])),c}function K0(r,e,t,i,u,c){var p=[],g=[];(0,b.S6)(r,function(k){var L=dp(k);p.push(L[1]),g.push(L[0])});var _=gp(p,e,i,u,c),w=gp(g,e,i,u,c);return t?_:_.concat(w)}function Q0(r,e,t,i,u,c){if(r.length){var p=r[0];return(0,b.kJ)(p.y)?K0(r,e,t,i,u,c):gp(r,e,i,u,c)}return[]}var ed=ro("line",{defaultShapeType:"line"});(0,b.S6)(["line","dot","dash","smooth"],function(r){va("line",r,{draw:function(e,t){var i=r==="smooth",u;if(i){var c=this.coordinate,p=c.start,g=c.end;u=[[p.x,g.y],[g.x,p.y]]}var _=Av(e,i,u),w=t.addShape({type:"path",attrs:_,name:"line",capture:!i});return w},getMarker:function(e){return vp(e,r)}})});var Wm=null,Hg="4.2.8",_c={getLegendItems:Zd,translate:cf,rotate:nh,zoom:kh,transform:Oo,getAngle:Xp,getSectorPath:gu,polarToCartesian:co,getDelegationObject:La,getTooltipItems:Lu,getMappingValue:_v,getPath:Q0,getPathPoints:td},hf={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},Va={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},Ju=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],Y_=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],mp=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],J0=function(r){r===void 0&&(r={});var e=r.paletteQualitative10,t=e===void 0?Ju:e,i=r.paletteQualitative20,u=i===void 0?Y_:i,c=r.brandColor,p=c===void 0?t[0]:c,g={backgroundColor:"#141414",brandColor:p,subColor:"rgba(255,255,255,0.05)",paletteQualitative10:t,paletteQualitative20:u,paletteSemanticRed:"#F4664A",paletteSemanticGreen:"#30BF78",paletteSemanticYellow:"#FAAD14",paletteSequence:mp,fontFamily:`"Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`,axisLineBorderColor:Va[25],axisLineBorder:1,axisLineDash:null,axisTitleTextFillColor:Va[65],axisTitleTextFontSize:12,axisTitleTextLineHeight:12,axisTitleTextFontWeight:"normal",axisTitleSpacing:12,axisDescriptionIconFillColor:hf[85],axisTickLineBorderColor:Va[25],axisTickLineLength:4,axisTickLineBorder:1,axisSubTickLineBorderColor:Va[15],axisSubTickLineLength:2,axisSubTickLineBorder:1,axisLabelFillColor:Va[45],axisLabelFontSize:12,axisLabelLineHeight:12,axisLabelFontWeight:"normal",axisLabelOffset:8,axisGridBorderColor:Va[15],axisGridBorder:1,axisGridLineDash:null,legendTitleTextFillColor:Va[45],legendTitleTextFontSize:12,legendTitleTextLineHeight:21,legendTitleTextFontWeight:"normal",legendMarkerColor:Ju[0],legendMarkerSpacing:8,legendMarkerSize:4,legendCircleMarkerSize:4,legendSquareMarkerSize:4,legendLineMarkerSize:5,legendItemNameFillColor:Va[65],legendItemNameFontSize:12,legendItemNameLineHeight:12,legendItemNameFontWeight:"normal",legendItemSpacing:24,legendItemMarginBottom:12,legendSpacing:16,legendPadding:[8,8,8,8],legendHorizontalPadding:[8,0,8,0],legendVerticalPadding:[0,8,0,8],legendPageNavigatorMarkerSize:12,legendPageNavigatorMarkerInactiveFillColor:Va[45],legendPageNavigatorMarkerInactiveFillOpacity:.45,legendPageNavigatorMarkerFillColor:Va[45],legendPageNavigatorMarkerFillOpacity:1,legendPageNavigatorTextFillColor:Va[65],legendPageNavigatorTextFontSize:12,sliderRailFillColor:Va[15],sliderRailBorder:0,sliderRailBorderColor:null,sliderRailWidth:100,sliderRailHeight:12,sliderLabelTextFillColor:Va[45],sliderLabelTextFontSize:12,sliderLabelTextLineHeight:12,sliderLabelTextFontWeight:"normal",sliderHandlerFillColor:hf[6],sliderHandlerWidth:10,sliderHandlerHeight:14,sliderHandlerBorder:1,sliderHandlerBorderColor:hf[25],annotationArcBorderColor:Va[15],annotationArcBorder:1,annotationLineBorderColor:Va[25],annotationLineBorder:1,annotationLineDash:null,annotationTextFillColor:Va[65],annotationTextFontSize:12,annotationTextLineHeight:12,annotationTextFontWeight:"normal",annotationTextBorderColor:null,annotationTextBorder:0,annotationRegionFillColor:Va[100],annotationRegionFillOpacity:.06,annotationRegionBorder:0,annotationRegionBorderColor:null,annotationDataMarkerLineLength:16,tooltipCrosshairsBorderColor:Va[25],tooltipCrosshairsBorder:1,tooltipCrosshairsLineDash:null,tooltipContainerFillColor:"#1f1f1f",tooltipContainerFillOpacity:.95,tooltipContainerShadow:"0px 2px 4px rgba(0,0,0,.5)",tooltipContainerBorderRadius:3,tooltipTextFillColor:Va[65],tooltipTextFontSize:12,tooltipTextLineHeight:12,tooltipTextFontWeight:"bold",labelFillColor:Va[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,labelLineHeight:12,labelFontWeight:"normal",labelBorderColor:null,labelBorder:0,innerLabelFillColor:hf[100],innerLabelFontSize:12,innerLabelLineHeight:12,innerLabelFontWeight:"normal",innerLabelBorderColor:null,innerLabelBorder:0,overflowLabelFillColor:Va[65],overflowLabelFillColorDark:"#2c3542",overflowLabelFillColorLight:"#ffffff",overflowLabelFontSize:12,overflowLabelLineHeight:12,overflowLabelFontWeight:"normal",overflowLabelBorderColor:hf[100],overflowLabelBorder:1,labelLineBorder:1,labelLineBorderColor:Va[25],cSliderRailHieght:16,cSliderBackgroundFillColor:"#416180",cSliderBackgroundFillOpacity:.05,cSliderForegroundFillColor:"#5B8FF9",cSliderForegroundFillOpacity:.15,cSliderHandlerHeight:24,cSliderHandlerWidth:10,cSliderHandlerFillColor:"#F7F7F7",cSliderHandlerFillOpacity:1,cSliderHandlerHighlightFillColor:"#FFF",cSliderHandlerBorderColor:"#BFBFBF",cSliderHandlerBorder:1,cSliderHandlerBorderRadius:2,cSliderTextFillColor:"#fff",cSliderTextFillOpacity:.45,cSliderTextFontSize:12,cSliderTextLineHeight:12,cSliderTextFontWeight:"normal",cSliderTextBorderColor:null,cSliderTextBorder:0,scrollbarTrackFillColor:"rgba(255,255,255,0.65)",scrollbarThumbFillColor:"rgba(0,0,0,0.35)",scrollbarThumbHighlightFillColor:"rgba(0,0,0,0.45)",pointFillColor:Ju[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:hf[100],pointBorderOpacity:1,pointActiveBorderColor:Va[100],pointSelectedBorder:2,pointSelectedBorderColor:Va[100],pointInactiveFillOpacity:.3,pointInactiveBorderOpacity:.3,hollowPointSize:4,hollowPointBorder:1,hollowPointBorderColor:Ju[0],hollowPointBorderOpacity:.95,hollowPointFillColor:hf[100],hollowPointActiveBorder:1,hollowPointActiveBorderColor:Va[100],hollowPointActiveBorderOpacity:1,hollowPointSelectedBorder:2,hollowPointSelectedBorderColor:Va[100],hollowPointSelectedBorderOpacity:1,hollowPointInactiveBorderOpacity:.3,lineBorder:2,lineBorderColor:Ju[0],lineBorderOpacity:1,lineActiveBorder:3,lineSelectedBorder:3,lineInactiveBorderOpacity:.3,areaFillColor:Ju[0],areaFillOpacity:.25,areaActiveFillColor:Ju[0],areaActiveFillOpacity:.5,areaSelectedFillColor:Ju[0],areaSelectedFillOpacity:.5,areaInactiveFillOpacity:.3,hollowAreaBorderColor:Ju[0],hollowAreaBorder:2,hollowAreaBorderOpacity:1,hollowAreaActiveBorder:3,hollowAreaActiveBorderColor:Va[100],hollowAreaSelectedBorder:3,hollowAreaSelectedBorderColor:Va[100],hollowAreaInactiveBorderOpacity:.3,intervalFillColor:Ju[0],intervalFillOpacity:.95,intervalActiveBorder:1,intervalActiveBorderColor:Va[100],intervalActiveBorderOpacity:1,intervalSelectedBorder:2,intervalSelectedBorderColor:Va[100],intervalSelectedBorderOpacity:1,intervalInactiveBorderOpacity:.3,intervalInactiveFillOpacity:.3,hollowIntervalBorder:2,hollowIntervalBorderColor:Ju[0],hollowIntervalBorderOpacity:1,hollowIntervalFillColor:hf[100],hollowIntervalActiveBorder:2,hollowIntervalActiveBorderColor:Va[100],hollowIntervalSelectedBorder:3,hollowIntervalSelectedBorderColor:Va[100],hollowIntervalSelectedBorderOpacity:1,hollowIntervalInactiveBorderOpacity:.3};return(0,P.pi)((0,P.pi)({},g),r)},jg=J0();function s0(){return window?window.devicePixelRatio:1}function Fc(r,e,t,i){var u=r-t,c=e-i;return Math.sqrt(u*u+c*c)}function ah(r,e,t,i,u,c){return u>=r&&u<=r+t&&c>=e&&c<=e+i}function Lh(r,e){return!(e.minX>r.maxX||e.maxX<r.minX||e.minY>r.maxY||e.maxY<r.minY)}function tg(r,e){return!r||!e?r||e:{minX:Math.min(r.minX,e.minX),minY:Math.min(r.minY,e.minY),maxX:Math.max(r.maxX,e.maxX),maxY:Math.max(r.maxY,e.maxY)}}function u0(r,e){return r[0]===e[0]&&r[1]===e[1]}var eg=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Xm=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,l0=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Wg=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function Wl(r,e){var t=r.match(Wg);(0,b.S6)(t,function(i){var u=i.split(":");e.addColorStop(u[0],u[1])})}function Ym(r,e,t){var i=eg.exec(t),u=parseFloat(i[1])%360*(Math.PI/180),c=i[2],p=e.getBBox(),g,_;u>=0&&u<1/2*Math.PI?(g={x:p.minX,y:p.minY},_={x:p.maxX,y:p.maxY}):1/2*Math.PI<=u&&u<Math.PI?(g={x:p.maxX,y:p.minY},_={x:p.minX,y:p.maxY}):Math.PI<=u&&u<3/2*Math.PI?(g={x:p.maxX,y:p.maxY},_={x:p.minX,y:p.minY}):(g={x:p.minX,y:p.maxY},_={x:p.maxX,y:p.minY});var w=Math.tan(u),k=w*w,L=(_.x-g.x+w*(_.y-g.y))/(k+1)+g.x,R=w*(_.x-g.x+w*(_.y-g.y))/(k+1)+g.y,U=r.createLinearGradient(g.x,g.y,L,R);return Wl(c,U),U}function $m(r,e,t){var i=Xm.exec(t),u=parseFloat(i[1]),c=parseFloat(i[2]),p=parseFloat(i[3]),g=i[4];if(p===0){var _=g.match(Wg);return _[_.length-1].split(":")[1]}var w=e.getBBox(),k=w.maxX-w.minX,L=w.maxY-w.minY,R=Math.sqrt(k*k+L*L)/2,U=r.createRadialGradient(w.minX+k*u,w.minY+L*c,0,w.minX+k/2,w.minY+L/2,p*R);return Wl(g,U),U}function qm(r,e,t){if(e.get("patternSource")&&e.get("patternSource")===t)return e.get("pattern");var i,u,c=l0.exec(t),p=c[1],g=c[2];function _(){i=r.createPattern(u,p),e.set("pattern",i),e.set("patternSource",t)}switch(p){case"a":p="repeat";break;case"x":p="repeat-x";break;case"y":p="repeat-y";break;case"n":p="no-repeat";break;default:p="no-repeat"}return u=new Image,g.match(/^data:/i)||(u.crossOrigin="Anonymous"),u.src=g,u.complete?_():(u.onload=_,u.src=u.src),i}function Rc(r,e,t){var i=e.getBBox();if(isNaN(i.x)||isNaN(i.y)||isNaN(i.width)||isNaN(i.height))return t;if((0,b.HD)(t)){if(t[1]==="("||t[2]==="("){if(t[0]==="l")return Ym(r,e,t);if(t[0]==="r")return $m(r,e,t);if(t[0]==="p")return qm(r,e,t)}return t}if(t instanceof CanvasPattern)return t}function rg(r){var e=0,t=0,i=0,u=0;return(0,b.kJ)(r)?r.length===1?e=t=i=u=r[0]:r.length===2?(e=i=r[0],t=u=r[1]):r.length===3?(e=r[0],t=u=r[1],i=r[2]):(e=r[0],t=r[1],i=r[2],u=r[3]):e=t=i=u=r,[e,t,i,u]}function yp(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function pf(r,e){return yp(r)*yp(e)?(r[0]*e[0]+r[1]*e[1])/(yp(r)*yp(e)):1}function Xg(r,e){return(r[0]*e[1]<r[1]*e[0]?-1:1)*Math.acos(pf(r,e))}function Tv(r,e){var t=e[1],i=e[2],u=(0,b.wQ)((0,b.c$)(e[3]),Math.PI*2),c=e[4],p=e[5],g=r[0],_=r[1],w=e[6],k=e[7],L=Math.cos(u)*(g-w)/2+Math.sin(u)*(_-k)/2,R=-1*Math.sin(u)*(g-w)/2+Math.cos(u)*(_-k)/2,U=L*L/(t*t)+R*R/(i*i);U>1&&(t*=Math.sqrt(U),i*=Math.sqrt(U));var G=t*t*(R*R)+i*i*(L*L),Q=G?Math.sqrt((t*t*(i*i)-G)/G):1;c===p&&(Q*=-1),isNaN(Q)&&(Q=0);var pt=i?Q*t*R/i:0,vt=t?Q*-i*L/t:0,Vt=(g+w)/2+Math.cos(u)*pt-Math.sin(u)*vt,le=(_+k)/2+Math.sin(u)*pt+Math.cos(u)*vt,he=[(L-pt)/t,(R-vt)/i],Ne=[(-1*L-pt)/t,(-1*R-vt)/i],Er=Xg([1,0],he),Fr=Xg(he,Ne);return pf(he,Ne)<=-1&&(Fr=Math.PI),pf(he,Ne)>=1&&(Fr=0),p===0&&Fr>0&&(Fr=Fr-2*Math.PI),p===1&&Fr<0&&(Fr=Fr+2*Math.PI),{cx:Vt,cy:le,rx:u0(r,[w,k])?0:t,ry:u0(r,[w,k])?0:i,startAngle:Er,endAngle:Er+Fr,xRotation:u,arcFlag:c,sweepFlag:p}}var Pf=Math.sin,Ph=Math.cos,rd=Math.atan2,_p=Math.PI;function xp(r,e,t,i,u,c,p){var g=e.stroke,_=e.lineWidth,w=t-u,k=i-c,L=rd(k,w),R=new J_({type:"path",canvas:r.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*Ph(_p/6)+","+10*Pf(_p/6)+" L0,0 L"+10*Ph(_p/6)+",-"+10*Pf(_p/6),stroke:g,lineWidth:_}});R.translate(u,c),R.rotateAtPoint(u,c,L),r.set(p?"startArrowShape":"endArrowShape",R)}function c0(r,e,t,i,u,c,p){var g=e.startArrow,_=e.endArrow,w=e.stroke,k=e.lineWidth,L=p?g:_,R=L.d,U=L.fill,G=L.stroke,Q=L.lineWidth,pt=(0,P._T)(L,["d","fill","stroke","lineWidth"]),vt=t-u,Vt=i-c,le=rd(Vt,vt);R&&(u=u-Ph(le)*R,c=c-Pf(le)*R);var he=new J_({type:"path",canvas:r.get("canvas"),isArrowShape:!0,attrs:(0,P.pi)((0,P.pi)({},pt),{stroke:G||w,lineWidth:Q||k,fill:U})});he.translate(u,c),he.rotateAtPoint(u,c,le),r.set(p?"startArrowShape":"endArrowShape",he)}function Oh(r,e,t,i,u){var c=rd(i-e,t-r);return{dx:Ph(c)*u,dy:Pf(c)*u}}function Vd(r,e,t,i,u,c){typeof e.startArrow=="object"?c0(r,e,t,i,u,c,!0):e.startArrow?xp(r,e,t,i,u,c,!0):r.set("startArrowShape",null)}function Gd(r,e,t,i,u,c){typeof e.endArrow=="object"?c0(r,e,t,i,u,c,!1):e.endArrow?xp(r,e,t,i,u,c,!1):r.set("startArrowShape",null)}var Mv={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function Fh(r,e){var t=e.attr();for(var i in t){var u=t[i],c=Mv[i]?Mv[i]:i;c==="matrix"&&u?r.transform(u[0],u[1],u[3],u[4],u[6],u[7]):c==="lineDash"&&r.setLineDash?(0,b.kJ)(u)&&r.setLineDash(u):(c==="strokeStyle"||c==="fillStyle"?u=Rc(r,e,u):c==="globalAlpha"&&(u=u*r.globalAlpha),r[c]=u)}}function Dc(r,e,t){for(var i=0;i<e.length;i++){var u=e[i];u.cfg.visible?u.draw(r,t):u.skipDraw()}}function Iv(r,e,t){var i=r.get("refreshElements");(0,b.S6)(i,function(u){if(u!==r)for(var c=u.cfg.parent;c&&c!==r&&!c.cfg.refresh;)c.cfg.refresh=!0,c=c.cfg.parent}),i[0]===r?Lv(e,t):Ol(e,t)}function Ol(r,e){for(var t=0;t<r.length;t++){var i=r[t];if(i.cfg.visible)if(i.cfg.hasChanged)i.cfg.refresh=!0,i.isGroup()&&Lv(i.cfg.children,e);else if(i.cfg.refresh)i.isGroup()&&Ol(i.cfg.children,e);else{var u=Rh(i,e);i.cfg.refresh=u,u&&i.isGroup()&&Ol(i.cfg.children,e)}}}function kv(r){for(var e=0;e<r.length;e++){var t=r[e];t.cfg.hasChanged=!1,t.isGroup()&&!t.destroyed&&kv(t.cfg.children)}}function Lv(r,e){for(var t=0;t<r.length;t++){var i=r[t];i.cfg.refresh=!0,i.isGroup()&&Lv(i.get("children"),e)}}function Rh(r,e){var t=r.cfg.cacheCanvasBBox,i=r.cfg.isInView&&t&&Lh(t,e);return i}function Yg(r,e,t,i){var u=t.path,c=t.startArrow,p=t.endArrow;if(!!u){var g=[0,0],_=[0,0],w={dx:0,dy:0};e.beginPath();for(var k=0;k<u.length;k++){var L=u[k],R=L[0];if(k===0&&c&&c.d){var U=r.getStartTangent();w=Oh(U[0][0],U[0][1],U[1][0],U[1][1],c.d)}else if(k===u.length-2&&u[k+1][0]==="Z"&&p&&p.d){var G=u[k+1];if(G[0]==="Z"){var U=r.getEndTangent();w=Oh(U[0][0],U[0][1],U[1][0],U[1][1],p.d)}}else if(k===u.length-1&&p&&p.d&&u[0]!=="Z"){var U=r.getEndTangent();w=Oh(U[0][0],U[0][1],U[1][0],U[1][1],p.d)}var Q=w.dx,pt=w.dy;switch(R){case"M":e.moveTo(L[1]-Q,L[2]-pt),_=[L[1],L[2]];break;case"L":e.lineTo(L[1]-Q,L[2]-pt);break;case"Q":e.quadraticCurveTo(L[1],L[2],L[3]-Q,L[4]-pt);break;case"C":e.bezierCurveTo(L[1],L[2],L[3],L[4],L[5]-Q,L[6]-pt);break;case"A":{var vt=void 0;i?(vt=i[k],vt||(vt=Tv(g,L),i[k]=vt)):vt=Tv(g,L);var Vt=vt.cx,le=vt.cy,he=vt.rx,Ne=vt.ry,Er=vt.startAngle,Fr=vt.endAngle,zr=vt.xRotation,pn=vt.sweepFlag;if(e.ellipse)e.ellipse(Vt,le,he,Ne,zr,Er,Fr,1-pn);else{var nn=he>Ne?he:Ne,Pn=he>Ne?1:he/Ne,Si=he>Ne?Ne/he:1;e.translate(Vt,le),e.rotate(zr),e.scale(Pn,Si),e.arc(0,0,nn,Er,Fr,1-pn),e.scale(1/Pn,1/Si),e.rotate(-zr),e.translate(-Vt,-le)}break}case"Z":e.closePath();break;default:break}if(R==="Z")g=_;else{var ha=L.length;g=[L[ha-2],L[ha-1]]}}}}function $g(r,e){var t=r.get("canvas");t&&(e==="remove"&&(r._cacheCanvasBBox=r.get("cacheCanvasBBox")),r.get("hasChanged")||(r.set("hasChanged",!0),r.cfg.parent&&r.cfg.parent.get("hasChanged")||(t.refreshElement(r,e,t),t.get("autoDraw")&&t.draw())))}function qg(r){var e;if(r.destroyed)e=r._cacheCanvasBBox;else{var t=r.get("cacheCanvasBBox"),i=t&&!!(t.width&&t.height),u=r.getCanvasBBox(),c=u&&!!(u.width&&u.height);i&&c?e=tg(t,u):i?e=t:c&&(e=u)}return e}function Kg(r){if(!r.length)return null;var e=[],t=[],i=[],u=[];return(0,b.S6)(r,function(c){var p=qg(c);p&&(e.push(p.minX),t.push(p.minY),i.push(p.maxX),u.push(p.maxY))}),{minX:(0,b.VV)(e),minY:(0,b.VV)(t),maxX:(0,b.Fp)(i),maxY:(0,b.Fp)(u)}}function Pv(r,e){return!r||!e||!Lh(r,e)?null:{minX:Math.max(r.minX,e.minX),minY:Math.max(r.minY,e.minY),maxX:Math.min(r.maxX,e.maxX),maxY:Math.min(r.maxY,e.maxY)}}var Ov=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.onCanvasChange=function(t){$g(this,t)},e.prototype.getShapeBase=function(){return tt},e.prototype.getGroupBase=function(){return e},e.prototype._applyClip=function(t,i){i&&(t.save(),Fh(t,i),i.createPath(t),t.restore(),t.clip(),i._afterDraw())},e.prototype.cacheCanvasBBox=function(){var t=this.cfg.children,i=[],u=[];(0,b.S6)(t,function(R){var U=R.cfg.cacheCanvasBBox;U&&R.cfg.isInView&&(i.push(U.minX,U.maxX),u.push(U.minY,U.maxY))});var c=null;if(i.length){var p=(0,b.VV)(i),g=(0,b.Fp)(i),_=(0,b.VV)(u),w=(0,b.Fp)(u);c={minX:p,minY:_,x:p,y:_,maxX:g,maxY:w,width:g-p,height:w-_};var k=this.cfg.canvas;if(k){var L=k.getViewRange();this.set("isInView",Lh(c,L))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",c)},e.prototype.draw=function(t,i){var u=this.cfg.children,c=i?this.cfg.refresh:!0;u.length&&c&&(t.save(),Fh(t,this),this._applyClip(t,this.getClip()),Dc(t,u,i),t.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},e.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},e}(Me.AbstractGroup),Fv=Ov,$_=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},e.prototype.getShapeBase=function(){return tt},e.prototype.getGroupBase=function(){return Fv},e.prototype.onCanvasChange=function(t){$g(this,t)},e.prototype.calculateBBox=function(){var t=this.get("type"),i=this.getHitLineWidth(),u=(0,Me.getBBoxMethod)(t),c=u(this),p=i/2,g=c.x-p,_=c.y-p,w=c.x+c.width+p,k=c.y+c.height+p;return{x:g,minX:g,y:_,minY:_,width:c.width+i,height:c.height+i,maxX:w,maxY:k}},e.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},e.prototype.isStroke=function(){return!!this.attrs.stroke},e.prototype._applyClip=function(t,i){i&&(t.save(),Fh(t,i),i.createPath(t),t.restore(),t.clip(),i._afterDraw())},e.prototype.draw=function(t,i){var u=this.cfg.clipShape;if(i){if(this.cfg.refresh===!1){this.set("hasChanged",!1);return}var c=this.getCanvasBBox();if(!Lh(i,c)){this.set("hasChanged",!1),this.cfg.isInView&&this._afterDraw();return}}t.save(),Fh(t,this),this._applyClip(t,u),this.drawPath(t),t.restore(),this._afterDraw()},e.prototype.getCanvasViewBox=function(){var t=this.cfg.canvas;return t?t.getViewRange():null},e.prototype.cacheCanvasBBox=function(){var t=this.getCanvasViewBox();if(t){var i=this.getCanvasBBox(),u=Lh(i,t);this.set("isInView",u),u?this.set("cacheCanvasBBox",i):this.set("cacheCanvasBBox",null)}},e.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},e.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},e.prototype.drawPath=function(t){this.createPath(t),this.strokeAndFill(t),this.afterDrawPath(t)},e.prototype.fill=function(t){t.fill()},e.prototype.stroke=function(t){t.stroke()},e.prototype.strokeAndFill=function(t){var i=this.attrs,u=i.lineWidth,c=i.opacity,p=i.strokeOpacity,g=i.fillOpacity;this.isFill()&&(!(0,b.UM)(g)&&g!==1?(t.globalAlpha=g,this.fill(t),t.globalAlpha=c):this.fill(t)),this.isStroke()&&u>0&&(!(0,b.UM)(p)&&p!==1&&(t.globalAlpha=p),this.stroke(t)),this.afterDrawPath(t)},e.prototype.createPath=function(t){},e.prototype.afterDrawPath=function(t){},e.prototype.isInShape=function(t,i){var u=this.isStroke(),c=this.isFill(),p=this.getHitLineWidth();return this.isInStrokeOrPath(t,i,u,c,p)},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){return!1},e.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var t=this.attrs;return t.lineWidth+t.lineAppendWidth},e}(Me.AbstractShape),Of=$_,Km=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,r:0})},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){var g=this.attr(),_=g.x,w=g.y,k=g.r,L=p/2,R=Fc(_,w,t,i);return c&&u?R<=k+L:c?R<=k:u?R>=k-L&&R<=k+L:!1},e.prototype.createPath=function(t){var i=this.attr(),u=i.x,c=i.y,p=i.r;t.beginPath(),t.arc(u,c,p,0,Math.PI*2,!1),t.closePath()},e}(Of),q_=Km;function ng(r,e,t,i){return r/(t*t)+e/(i*i)}var K_=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,rx:0,ry:0})},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){var g=this.attr(),_=p/2,w=g.x,k=g.y,L=g.rx,R=g.ry,U=(t-w)*(t-w),G=(i-k)*(i-k);return c&&u?ng(U,G,L+_,R+_)<=1:c?ng(U,G,L,R)<=1:u?ng(U,G,L-_,R-_)>=1&&ng(U,G,L+_,R+_)<=1:!1},e.prototype.createPath=function(t){var i=this.attr(),u=i.x,c=i.y,p=i.rx,g=i.ry;if(t.beginPath(),t.ellipse)t.ellipse(u,c,p,g,0,0,Math.PI*2,!1);else{var _=p>g?p:g,w=p>g?1:p/g,k=p>g?g/p:1;t.save(),t.translate(u,c),t.scale(w,k),t.arc(0,0,_,0,Math.PI*2),t.restore(),t.closePath()}},e}(Of),Hd=K_;function ig(r){return r instanceof HTMLElement&&(0,b.HD)(r.nodeName)&&r.nodeName.toUpperCase()==="CANVAS"}var ag=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0})},e.prototype.initAttrs=function(t){this._setImage(t.img)},e.prototype.isStroke=function(){return!1},e.prototype.isOnlyHitBox=function(){return!0},e.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var t=this.get("canvas");t?t.draw():this.createPath(this.get("context"))}},e.prototype._setImage=function(t){var i=this,u=this.attrs;if((0,b.HD)(t)){var c=new Image;c.onload=function(){if(i.destroyed)return!1;i.attr("img",c),i.set("loading",!1),i._afterLoading();var p=i.get("callback");p&&p.call(i)},c.crossOrigin="Anonymous",c.src=t,this.set("loading",!0)}else t instanceof Image?(u.width||(u.width=t.width),u.height||(u.height=t.height)):ig(t)&&(u.width||(u.width=Number(t.getAttribute("width"))),u.height||(u.height,Number(t.getAttribute("height"))))},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),t==="img"&&this._setImage(i)},e.prototype.createPath=function(t){if(this.get("loading")){this.set("toDraw",!0),this.set("context",t);return}var i=this.attr(),u=i.x,c=i.y,p=i.width,g=i.height,_=i.sx,w=i.sy,k=i.swidth,L=i.sheight,R=i.img;(R instanceof Image||ig(R))&&(!(0,b.UM)(_)&&!(0,b.UM)(w)&&!(0,b.UM)(k)&&!(0,b.UM)(L)?t.drawImage(R,_,w,k,L,u,c,p,g):t.drawImage(R,u,c,p,g))},e}(Of),Qg=ag,Ls=ot(32793);function df(r,e,t,i,u,c,p){var g=Math.min(r,t),_=Math.max(r,t),w=Math.min(e,i),k=Math.max(e,i),L=u/2;return c>=g-L&&c<=_+L&&p>=w-L&&p<=k+L?Ls.x1.pointToLine(r,e,t,i,c,p)<=u/2:!1}var og=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this.setArrow()},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),this.setArrow()},e.prototype.setArrow=function(){var t=this.attr(),i=t.x1,u=t.y1,c=t.x2,p=t.y2,g=t.startArrow,_=t.endArrow;g&&Vd(this,t,c,p,i,u),_&&Gd(this,t,i,u,c,p)},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){if(!u||!p)return!1;var g=this.attr(),_=g.x1,w=g.y1,k=g.x2,L=g.y2;return df(_,w,k,L,p,t,i)},e.prototype.createPath=function(t){var i=this.attr(),u=i.x1,c=i.y1,p=i.x2,g=i.y2,_=i.startArrow,w=i.endArrow,k={dx:0,dy:0},L={dx:0,dy:0};_&&_.d&&(k=Oh(u,c,p,g,i.startArrow.d)),w&&w.d&&(L=Oh(u,c,p,g,i.endArrow.d)),t.beginPath(),t.moveTo(u+k.dx,c+k.dy),t.lineTo(p-L.dx,g-L.dy)},e.prototype.afterDrawPath=function(t){var i=this.get("startArrowShape"),u=this.get("endArrowShape");i&&i.draw(t),u&&u.draw(t)},e.prototype.getTotalLength=function(){var t=this.attr(),i=t.x1,u=t.y1,c=t.x2,p=t.y2;return Ls.x1.length(i,u,c,p)},e.prototype.getPoint=function(t){var i=this.attr(),u=i.x1,c=i.y1,p=i.x2,g=i.y2;return Ls.x1.pointAt(u,c,p,g,t)},e}(Of),bp=og,sg={circle:function(r,e,t){return[["M",r-t,e],["A",t,t,0,1,0,r+t,e],["A",t,t,0,1,0,r-t,e]]},square:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},diamond:function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},triangle:function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e+i],["L",r,e-i],["L",r+t,e+i],["Z"]]},"triangle-down":function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e-i],["L",r+t,e-i],["L",r,e+i],["Z"]]}},Jg=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.initAttrs=function(t){this._resetParamsCache()},e.prototype._resetParamsCache=function(){this.set("paramsCache",{})},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),["symbol","x","y","r","radius"].indexOf(t)!==-1&&this._resetParamsCache()},e.prototype.isOnlyHitBox=function(){return!0},e.prototype._getR=function(t){return(0,b.UM)(t.r)?t.radius:t.r},e.prototype._getPath=function(){var t=this.attr(),i=t.x,u=t.y,c=t.symbol||"circle",p=this._getR(t),g,_;if((0,b.mf)(c))g=c,_=g(i,u,p),_=(0,rf.wb)(_);else{if(g=e.Symbols[c],!g)return console.warn(c+" marker is not supported."),null;_=g(i,u,p)}return _},e.prototype.createPath=function(t){var i=this._getPath(),u=this.get("paramsCache");Yg(this,t,{path:i},u)},e.Symbols=sg,e}(Of),Qm=Jg;function Ep(r,e,t){var i=(0,Me.getOffScreenContext)();return r.createPath(i),i.isPointInPath(e,t)}var Q_=1e-6;function tm(r){return Math.abs(r)<Q_?0:r<0?-1:1}function hT(r,e,t){return(t[0]-r[0])*(e[1]-r[1])===(e[0]-r[0])*(t[1]-r[1])&&Math.min(r[0],e[0])<=t[0]&&t[0]<=Math.max(r[0],e[0])&&Math.min(r[1],e[1])<=t[1]&&t[1]<=Math.max(r[1],e[1])}function pT(r,e,t){var i=!1,u=r.length;if(u<=2)return!1;for(var c=0;c<u;c++){var p=r[c],g=r[(c+1)%u];if(hT(p,g,[e,t]))return!0;tm(p[1]-t)>0!=tm(g[1]-t)>0&&tm(e-(t-p[1])*(p[0]-g[0])/(p[1]-g[1])-p[0])<0&&(i=!i)}return i}function f0(r,e,t,i,u,c,p,g){var _=(Math.atan2(g-e,p-r)+Math.PI*2)%(Math.PI*2);if(_<i||_>u)return!1;var w={x:r+t*Math.cos(_),y:e+t*Math.sin(_)};return Fc(w.x,w.y,p,g)<=c/2}var l2=ma.vs;function lO(r){for(var e=!1,t=r.length,i=0;i<t;i++){var u=r[i],c=u[0];if(c==="C"||c==="A"||c==="Q"){e=!0;break}}return e}function c2(r,e,t,i,u){for(var c=!1,p=e/2,g=0;g<r.length;g++){var _=r[g],w=_.currentPoint,k=_.params,L=_.prePoint,R=_.box;if(!(R&&!ah(R.x-p,R.y-p,R.width+e,R.height+e,t,i))){switch(_.command){case"L":case"Z":c=df(L[0],L[1],w[0],w[1],e,t,i);break;case"Q":var U=Ls.lD.pointDistance(L[0],L[1],k[1],k[2],k[3],k[4],t,i);c=U<=e/2;break;case"C":var G=Ls.Ll.pointDistance(L[0],L[1],k[1],k[2],k[3],k[4],k[5],k[6],t,i,u);c=G<=e/2;break;case"A":var Q=_.arcParams,pt=Q.cx,vt=Q.cy,Vt=Q.rx,le=Q.ry,he=Q.startAngle,Ne=Q.endAngle,Er=Q.xRotation,Fr=[t,i,1],zr=Vt>le?Vt:le,pn=Vt>le?1:Vt/le,nn=Vt>le?le/Vt:1,Pn=l2(null,[["t",-pt,-vt],["r",-Er],["s",1/pn,1/nn]]);Cc.transformMat3(Fr,Fr,Pn),c=f0(0,0,zr,he,Ne,e,Fr[0],Fr[1]);break;default:break}if(c)break}}return c}function dT(r){for(var e=r.length,t=[],i=[],u=[],c=0;c<e;c++){var p=r[c],g=p[0];g==="M"?(u.length&&(i.push(u),u=[]),u.push([p[1],p[2]])):g==="Z"?u.length&&(t.push(u),u=[]):u.push([p[1],p[2]])}return u.length>0&&i.push(u),{polygons:t,polylines:i}}var Jm=(0,P.pi)({hasArc:lO,extractPolygons:dT,isPointInStroke:c2},Me.PathUtil);function f2(r,e,t){for(var i=!1,u=0;u<r.length;u++){var c=r[u];if(i=pT(c,e,t),i)break}return i}var h2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this._setPathArr(t.path),this.setArrow()},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),t==="path"&&this._setPathArr(i),this.setArrow()},e.prototype._setPathArr=function(t){this.attrs.path=(0,rf.wb)(t);var i=Jm.hasArc(t);this.set("hasArc",i),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},e.prototype.getSegments=function(){var t=this.get("segements");return t||(t=(0,rf.zx)(this.attr("path")),this.set("segments",t)),t},e.prototype.setArrow=function(){var t=this.attr(),i=t.startArrow,u=t.endArrow;if(i){var c=this.getStartTangent();Vd(this,t,c[0][0],c[0][1],c[1][0],c[1][1])}if(u){var c=this.getEndTangent();Gd(this,t,c[0][0],c[0][1],c[1][0],c[1][1])}},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){var g=this.getSegments(),_=this.get("hasArc"),w=!1;if(u){var k=this.getTotalLength();w=Jm.isPointInStroke(g,p,t,i,k)}if(!w&&c)if(_)w=Ep(this,t,i);else{var L=this.attr("path"),R=Jm.extractPolygons(L);w=f2(R.polygons,t,i)||f2(R.polylines,t,i)}return w},e.prototype.createPath=function(t){var i=this.attr(),u=this.get("paramsCache");Yg(this,t,i,u)},e.prototype.afterDrawPath=function(t){var i=this.get("startArrowShape"),u=this.get("endArrowShape");i&&i.draw(t),u&&u.draw(t)},e.prototype.getTotalLength=function(){var t=this.get("totalLength");return(0,b.UM)(t)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):t},e.prototype.getPoint=function(t){var i=this.get("tCache");i||(this._calculateCurve(),this._setTcache(),i=this.get("tCache"));var u,c,p=this.get("curve");if(!i||i.length===0)return p?{x:p[0][1],y:p[0][2]}:null;(0,b.S6)(i,function(k,L){t>=k[0]&&t<=k[1]&&(u=(t-k[0])/(k[1]-k[0]),c=L)});var g=p[c];if((0,b.UM)(g)||(0,b.UM)(c))return null;var _=g.length,w=p[c+1];return Ls.Ll.pointAt(g[_-2],g[_-1],w[1],w[2],w[3],w[4],w[5],w[6],u)},e.prototype._calculateCurve=function(){var t=this.attr().path;this.set("curve",Jm.pathToCurve(t))},e.prototype._setTcache=function(){var t=0,i=0,u=[],c,p,g,_,w=this.get("curve");if(!!w){if((0,b.S6)(w,function(k,L){g=w[L+1],_=k.length,g&&(t+=Ls.Ll.length(k[_-2],k[_-1],g[1],g[2],g[3],g[4],g[5],g[6])||0)}),this.set("totalLength",t),t===0){this.set("tCache",[]);return}(0,b.S6)(w,function(k,L){g=w[L+1],_=k.length,g&&(c=[],c[0]=i/t,p=Ls.Ll.length(k[_-2],k[_-1],g[1],g[2],g[3],g[4],g[5],g[6]),i+=p||0,c[1]=i/t,u.push(c))}),this.set("tCache",u)}},e.prototype.getStartTangent=function(){var t=this.getSegments(),i;if(t.length>1){var u=t[0].currentPoint,c=t[1].currentPoint,p=t[1].startTangent;i=[],p?(i.push([u[0]-p[0],u[1]-p[1]]),i.push([u[0],u[1]])):(i.push([c[0],c[1]]),i.push([u[0],u[1]]))}return i},e.prototype.getEndTangent=function(){var t=this.getSegments(),i=t.length,u;if(i>1){var c=t[i-2].currentPoint,p=t[i-1].currentPoint,g=t[i-1].endTangent;u=[],g?(u.push([p[0]-g[0],p[1]-g[1]]),u.push([p[0],p[1]])):(u.push([c[0],c[1]]),u.push([p[0],p[1]]))}return u},e}(Of),J_=h2;function t1(r,e,t,i,u){var c=r.length;if(c<2)return!1;for(var p=0;p<c-1;p++){var g=r[p][0],_=r[p][1],w=r[p+1][0],k=r[p+1][1];if(df(g,_,w,k,e,t,i))return!0}if(u){var L=r[0],R=r[c-1];if(df(L[0],L[1],R[0],R[1],e,t,i))return!0}return!1}var p2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.isInStrokeOrPath=function(t,i,u,c,p){var g=this.attr().points,_=!1;return u&&(_=t1(g,p,t,i,!0)),!_&&c&&(_=pT(g,t,i)),_},e.prototype.createPath=function(t){var i=this.attr(),u=i.points;if(!(u.length<2)){t.beginPath();for(var c=0;c<u.length;c++){var p=u[c];c===0?t.moveTo(p[0],p[1]):t.lineTo(p[0],p[1])}t.closePath()}},e}(Of),d2=p2,v2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this.setArrow()},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),this.setArrow(),["points"].indexOf(t)!==-1&&this._resetCache()},e.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},e.prototype.setArrow=function(){var t=this.attr(),i=this.attrs,u=i.points,c=i.startArrow,p=i.endArrow,g=u.length,_=u[0][0],w=u[0][1],k=u[g-1][0],L=u[g-1][1];c&&Vd(this,t,u[1][0],u[1][1],_,w),p&&Gd(this,t,u[g-2][0],u[g-2][1],k,L)},e.prototype.isFill=function(){return!1},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){if(!u||!p)return!1;var g=this.attr().points;return t1(g,p,t,i,!1)},e.prototype.isStroke=function(){return!0},e.prototype.createPath=function(t){var i=this.attr(),u=i.points,c=i.startArrow,p=i.endArrow,g=u.length;if(!(u.length<2)){var _=u[0][0],w=u[0][1],k=u[g-1][0],L=u[g-1][1];if(c&&c.d){var R=Oh(_,w,u[1][0],u[1][1],c.d);_+=R.dx,w+=R.dy}if(p&&p.d){var R=Oh(u[g-2][0],u[g-2][1],k,L,p.d);k-=R.dx,L-=R.dy}t.beginPath(),t.moveTo(_,w);for(var U=0;U<g-1;U++){var G=u[U];t.lineTo(G[0],G[1])}t.lineTo(k,L)}},e.prototype.afterDrawPath=function(t){var i=this.get("startArrowShape"),u=this.get("endArrowShape");i&&i.draw(t),u&&u.draw(t)},e.prototype.getTotalLength=function(){var t=this.attr().points,i=this.get("totalLength");return(0,b.UM)(i)?(this.set("totalLength",Ls.aH.length(t)),this.get("totalLength")):i},e.prototype.getPoint=function(t){var i=this.attr().points,u=this.get("tCache");u||(this._setTcache(),u=this.get("tCache"));var c,p;return(0,b.S6)(u,function(g,_){t>=g[0]&&t<=g[1]&&(c=(t-g[0])/(g[1]-g[0]),p=_)}),Ls.x1.pointAt(i[p][0],i[p][1],i[p+1][0],i[p+1][1],c)},e.prototype._setTcache=function(){var t=this.attr().points;if(!(!t||t.length===0)){var i=this.getTotalLength();if(!(i<=0)){var u=0,c=[],p,g;(0,b.S6)(t,function(_,w){t[w+1]&&(p=[],p[0]=u/i,g=Ls.x1.length(_[0],_[1],t[w+1][0],t[w+1][1]),u+=g,p[1]=u/i,c.push(p))}),this.set("tCache",c)}}},e.prototype.getStartTangent=function(){var t=this.attr().points,i=[];return i.push([t[1][0],t[1][1]]),i.push([t[0][0],t[0][1]]),i},e.prototype.getEndTangent=function(){var t=this.attr().points,i=t.length-1,u=[];return u.push([t[i-1][0],t[i-1][1]]),u.push([t[i][0],t[i][1]]),u},e}(Of),g2=v2;function m2(r,e,t,i,u,c,p){var g=u/2;return ah(r-g,e-g,t,u,c,p)||ah(r+t-g,e-g,u,i,c,p)||ah(r+g,e+i-g,t,u,c,p)||ah(r-g,e+g,u,i,c,p)}function y2(r,e,t,i,u,c,p,g){var _=c/2;return df(r+u,e,r+t-u,e,c,p,g)||df(r+t,e+u,r+t,e+i-u,c,p,g)||df(r+t-u,e+i,r+u,e+i,c,p,g)||df(r,e+i-u,r,e+u,c,p,g)||f0(r+t-u,e+u,u,1.5*Math.PI,2*Math.PI,c,p,g)||f0(r+t-u,e+i-u,u,0,.5*Math.PI,c,p,g)||f0(r+u,e+i-u,u,.5*Math.PI,Math.PI,c,p,g)||f0(r+u,e+u,u,Math.PI,1.5*Math.PI,c,p,g)}var _2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0,radius:0})},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){var g=this.attr(),_=g.x,w=g.y,k=g.width,L=g.height,R=g.radius;if(R){var G=!1;return u&&(G=y2(_,w,k,L,R,p,t,i)),!G&&c&&(G=Ep(this,t,i)),G}else{var U=p/2;if(c&&u)return ah(_-U,w-U,k+U,L+U,t,i);if(c)return ah(_,w,k,L,t,i);if(u)return m2(_,w,k,L,p,t,i)}},e.prototype.createPath=function(t){var i=this.attr(),u=i.x,c=i.y,p=i.width,g=i.height,_=i.radius;if(t.beginPath(),_===0)t.rect(u,c,p,g);else{var w=rg(_),k=w[0],L=w[1],R=w[2],U=w[3];t.moveTo(u+k,c),t.lineTo(u+p-L,c),L!==0&&t.arc(u+p-L,c+L,L,-Math.PI/2,0),t.lineTo(u+p,c+g-R),R!==0&&t.arc(u+p-R,c+g-R,R,0,Math.PI/2),t.lineTo(u+U,c+g),U!==0&&t.arc(u+U,c+g-U,U,Math.PI/2,Math.PI),t.lineTo(u,c+k),k!==0&&t.arc(u+k,c+k,k,Math.PI,Math.PI*1.5),t.closePath()}},e}(Of),x2=_2,b2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},e.prototype.isOnlyHitBox=function(){return!0},e.prototype.initAttrs=function(t){this._assembleFont(),t.text&&this._setText(t.text)},e.prototype._assembleFont=function(){var t=this.attrs;t.font=(0,Me.assembleFont)(t)},e.prototype._setText=function(t){var i=null;(0,b.HD)(t)&&t.indexOf(`
`)!==-1&&(i=t.split(`
`)),this.set("textArr",i)},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),t.startsWith("font")&&this._assembleFont(),t==="text"&&this._setText(i)},e.prototype._getSpaceingY=function(){var t=this.attrs,i=t.lineHeight,u=t.fontSize*1;return i?i-u:u*.14},e.prototype._drawTextArr=function(t,i,u){var c=this.attrs,p=c.textBaseline,g=c.x,_=c.y,w=c.fontSize*1,k=this._getSpaceingY(),L=(0,Me.getTextHeight)(c.text,c.fontSize,c.lineHeight),R;(0,b.S6)(i,function(U,G){R=_+G*(k+w)-L+w,p==="middle"&&(R+=L-w-(L-w)/2),p==="top"&&(R+=L-w),(0,b.UM)(U)||(u?t.fillText(U,g,R):t.strokeText(U,g,R))})},e.prototype._drawText=function(t,i){var u=this.attr(),c=u.x,p=u.y,g=this.get("textArr");if(g)this._drawTextArr(t,g,i);else{var _=u.text;(0,b.UM)(_)||(i?t.fillText(_,c,p):t.strokeText(_,c,p))}},e.prototype.strokeAndFill=function(t){var i=this.attrs,u=i.lineWidth,c=i.opacity,p=i.strokeOpacity,g=i.fillOpacity;this.isStroke()&&u>0&&(!(0,b.UM)(p)&&p!==1&&(t.globalAlpha=c),this.stroke(t)),this.isFill()&&(!(0,b.UM)(g)&&g!==1?(t.globalAlpha=g,this.fill(t),t.globalAlpha=c):this.fill(t)),this.afterDrawPath(t)},e.prototype.fill=function(t){this._drawText(t,!0)},e.prototype.stroke=function(t){this._drawText(t,!1)},e}(Of),E2=b2;function S2(r,e){if(e){var t=(0,Me.invert)(e);return(0,Me.multiplyVec2)(t,r)}return r}function e1(r,e,t){var i=r.getTotalMatrix();if(i){var u=S2([e,t,1],i),c=u[0],p=u[1];return[c,p]}return[e,t]}function r1(r,e,t){if(r.isCanvas&&r.isCanvas())return!0;if(!(0,Me.isAllowCapture)(r)||r.cfg.isInView===!1)return!1;if(r.cfg.clipShape){var i=e1(r,e,t),u=i[0],c=i[1];if(r.isClipped(u,c))return!1}var p=r.cfg.cacheCanvasBBox||r.getCanvasBBox();return e>=p.minX&&e<=p.maxX&&t>=p.minY&&t<=p.maxY}function n1(r,e,t){if(!r1(r,e,t))return null;for(var i=null,u=r.getChildren(),c=u.length,p=c-1;p>=0;p--){var g=u[p];if(g.isGroup())i=n1(g,e,t);else if(r1(g,e,t)){var _=g,w=e1(g,e,t),k=w[0],L=w[1];_.isInShape(k,L)&&(i=g)}if(i)break}return i}var w2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return t.renderer="canvas",t.autoDraw=!0,t.localRefresh=!0,t.refreshElements=[],t.clipView=!0,t.quickHit=!1,t},e.prototype.onCanvasChange=function(t){(t==="attr"||t==="sort"||t==="changeSize")&&(this.set("refreshElements",[this]),this.draw())},e.prototype.getShapeBase=function(){return tt},e.prototype.getGroupBase=function(){return Fv},e.prototype.getPixelRatio=function(){var t=this.get("pixelRatio")||s0();return t>=1?Math.ceil(t):1},e.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},e.prototype.createDom=function(){var t=document.createElement("canvas"),i=t.getContext("2d");return this.set("context",i),t},e.prototype.setDOMSize=function(t,i){r.prototype.setDOMSize.call(this,t,i);var u=this.get("context"),c=this.get("el"),p=this.getPixelRatio();c.width=p*t,c.height=p*i,p>1&&u.scale(p,p)},e.prototype.clear=function(){r.prototype.clear.call(this),this._clearFrame();var t=this.get("context"),i=this.get("el");t.clearRect(0,0,i.width,i.height)},e.prototype.getShape=function(t,i){var u;return this.get("quickHit")?u=n1(this,t,i):u=r.prototype.getShape.call(this,t,i,null),u},e.prototype._getRefreshRegion=function(){var t=this.get("refreshElements"),i=this.getViewRange(),u;if(t.length&&t[0]===this)u=i;else if(u=Kg(t),u){u.minX=Math.floor(u.minX),u.minY=Math.floor(u.minY),u.maxX=Math.ceil(u.maxX),u.maxY=Math.ceil(u.maxY),u.maxY+=1;var c=this.get("clipView");c&&(u=Pv(u,i))}return u},e.prototype.refreshElement=function(t){var i=this.get("refreshElements");i.push(t)},e.prototype._clearFrame=function(){var t=this.get("drawFrame");t&&((0,b.VS)(t),this.set("drawFrame",null),this.set("refreshElements",[]))},e.prototype.draw=function(){var t=this.get("drawFrame");this.get("autoDraw")&&t||this._startDraw()},e.prototype._drawAll=function(){var t=this.get("context"),i=this.get("el"),u=this.getChildren();t.clearRect(0,0,i.width,i.height),Fh(t,this),Dc(t,u),this.set("refreshElements",[])},e.prototype._drawRegion=function(){var t=this.get("context"),i=this.get("refreshElements"),u=this.getChildren(),c=this._getRefreshRegion();c?(t.clearRect(c.minX,c.minY,c.maxX-c.minX,c.maxY-c.minY),t.save(),t.beginPath(),t.rect(c.minX,c.minY,c.maxX-c.minX,c.maxY-c.minY),t.clip(),Fh(t,this),Iv(this,u,c),Dc(t,u,c),t.restore()):i.length&&kv(i),(0,b.S6)(i,function(p){p.get("hasChanged")&&p.set("hasChanged",!1)}),this.set("refreshElements",[])},e.prototype._startDraw=function(){var t=this,i=this.get("drawFrame");i||(i=(0,b.U7)(function(){t.get("localRefresh")?t._drawRegion():t._drawAll(),t.set("drawFrame",null)}),this.set("drawFrame",i))},e.prototype.skipDraw=function(){},e.prototype.removeDom=function(){var t=this.get("el");t.width=0,t.height=0,t.parentNode.removeChild(t)},e}(Me.AbstractCanvas),C2=w2,xc="0.5.12",ty={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},Yo={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"},vT=null;function oh(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function i1(r){var e=ty[r.type],t=r.getParent();if(!e)throw new Error("the type "+r.type+" is not supported by svg");var i=oh(e);if(r.get("id")&&(i.id=r.get("id")),r.set("el",i),r.set("attrs",{}),t){var u=t.get("el");u||(u=t.createDom(),t.set("el",u)),u.appendChild(i)}return i}function a1(r,e){var t=r.get("el"),i=(0,b.qo)(t.children).sort(e),u=document.createDocumentFragment();i.forEach(function(c){u.appendChild(c)}),t.appendChild(u)}function A2(r,e){var t=r.parentNode,i=Array.from(t.childNodes).filter(function(g){return g.nodeType===1&&g.nodeName.toLowerCase()!=="defs"}),u=i[e],c=i.indexOf(r);if(u){if(c>e)t.insertBefore(r,u);else if(c<e){var p=i[e+1];p?t.insertBefore(r,p):t.appendChild(r)}}else t.appendChild(r)}function T2(r,e){var t=r.cfg.el,i=r.attr(),u={dx:i.shadowOffsetX,dy:i.shadowOffsetY,blur:i.shadowBlur,color:i.shadowColor};if(!u.dx&&!u.dy&&!u.blur&&!u.color)t.removeAttribute("filter");else{var c=e.find("filter",u);c||(c=e.addShadow(u)),t.setAttribute("filter","url(#"+c+")")}}function ug(r){var e=r.attr().matrix;if(e){for(var t=r.cfg.el,i=[],u=0;u<9;u+=3)i.push(e[u]+","+e[u+1]);i=i.join(","),i.indexOf("NaN")===-1?t.setAttribute("transform","matrix("+i+")"):console.warn("invalid matrix:",e)}}function lg(r,e){var t=r.getClip(),i=r.get("el");if(!t)i.removeAttribute("clip-path");else if(t&&!i.hasAttribute("clip-path")){i1(t),t.createPath(e);var u=e.addClip(t);i.setAttribute("clip-path","url(#"+u+")")}}function o1(r,e){e.forEach(function(t){t.draw(r)})}function s1(r,e){var t=r.get("canvas");if(t&&t.get("autoDraw")){var i=t.get("context"),u=r.getParent(),c=u?u.getChildren():[t],p=r.get("el");if(e==="remove"){var g=r.get("isClipShape");if(g){var _=p&&p.parentNode,w=_&&_.parentNode;_&&w&&w.removeChild(_)}else p&&p.parentNode&&p.parentNode.removeChild(p)}else if(e==="show")p.setAttribute("visibility","visible");else if(e==="hide")p.setAttribute("visibility","hidden");else if(e==="zIndex")A2(p,c.indexOf(r));else if(e==="sort"){var k=r.get("children");k&&k.length&&a1(r,function(L,R){return k.indexOf(L)-k.indexOf(R)?1:0})}else e==="clear"?p&&(p.innerHTML=""):e==="matrix"?ug(r):e==="clip"?lg(r,i):e==="attr"||e==="add"&&r.draw(i)}}var M2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.isEntityGroup=function(){return!0},e.prototype.createDom=function(){var t=oh("g");this.set("el",t);var i=this.getParent();if(i){var u=i.get("el");u||(u=i.createDom(),i.set("el",u)),u.appendChild(t)}return t},e.prototype.afterAttrsChange=function(t){r.prototype.afterAttrsChange.call(this,t);var i=this.get("canvas");if(i&&i.get("autoDraw")){var u=i.get("context");this.createPath(u,t)}},e.prototype.onCanvasChange=function(t){s1(this,t)},e.prototype.getShapeBase=function(){return it},e.prototype.getGroupBase=function(){return e},e.prototype.draw=function(t){var i=this.getChildren(),u=this.get("el");this.get("destroyed")?u&&u.parentNode.removeChild(u):(u||this.createDom(),lg(this,t),this.createPath(t),i.length&&o1(t,i))},e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){Yo[g]&&c.setAttribute(Yo[g],p)}),ug(this)},e}(Me.AbstractGroup),ey=M2,I2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="svg",t.canFill=!1,t.canStroke=!1,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},e.prototype.afterAttrsChange=function(t){r.prototype.afterAttrsChange.call(this,t);var i=this.get("canvas");if(i&&i.get("autoDraw")){var u=i.get("context");this.draw(u,t)}},e.prototype.getShapeBase=function(){return it},e.prototype.getGroupBase=function(){return ey},e.prototype.onCanvasChange=function(t){s1(this,t)},e.prototype.calculateBBox=function(){var t=this.get("el"),i=null;if(t)i=t.getBBox();else{var u=(0,Me.getBBoxMethod)(this.get("type"));u&&(i=u(this))}if(i){var c=i.x,p=i.y,g=i.width,_=i.height,w=this.getHitLineWidth(),k=w/2,L=c-k,R=p-k,U=c+g+k,G=p+_+k;return{x:L,y:R,minX:L,minY:R,maxX:U,maxY:G,width:g+w,height:_+w}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},e.prototype.isFill=function(){var t=this.attr(),i=t.fill,u=t.fillStyle;return(i||u||this.isClipShape())&&this.canFill},e.prototype.isStroke=function(){var t=this.attr(),i=t.stroke,u=t.strokeStyle;return(i||u)&&this.canStroke},e.prototype.draw=function(t,i){var u=this.get("el");this.get("destroyed")?u&&u.parentNode.removeChild(u):(u||i1(this),lg(this,t),this.createPath(t,i),this.shadow(t,i),this.strokeAndFill(t,i),this.transform(i))},e.prototype.createPath=function(t,i){},e.prototype.strokeAndFill=function(t,i){var u=i||this.attr(),c=u.fill,p=u.fillStyle,g=u.stroke,_=u.strokeStyle,w=u.fillOpacity,k=u.strokeOpacity,L=u.lineWidth,R=this.get("el");this.canFill&&(i?"fill"in u?this._setColor(t,"fill",c):"fillStyle"in u&&this._setColor(t,"fill",p):this._setColor(t,"fill",c||p),w&&R.setAttribute(Yo.fillOpacity,w)),this.canStroke&&L>0&&(i?"stroke"in u?this._setColor(t,"stroke",g):"strokeStyle"in u&&this._setColor(t,"stroke",_):this._setColor(t,"stroke",g||_),k&&R.setAttribute(Yo.strokeOpacity,k),L&&R.setAttribute(Yo.lineWidth,L))},e.prototype._setColor=function(t,i,u){var c=this.get("el");if(!u){c.setAttribute(Yo[i],"none");return}if(u=u.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(u)){var p=t.find("gradient",u);p||(p=t.addGradient(u)),c.setAttribute(Yo[i],"url(#"+p+")")}else if(/^[p,P]{1}[\s]*\(/.test(u)){var p=t.find("pattern",u);p||(p=t.addPattern(u)),c.setAttribute(Yo[i],"url(#"+p+")")}else c.setAttribute(Yo[i],u)},e.prototype.shadow=function(t,i){var u=this.attr(),c=i||u,p=c.shadowOffsetX,g=c.shadowOffsetY,_=c.shadowBlur,w=c.shadowColor;(p||g||_||w)&&T2(this,t)},e.prototype.transform=function(t){var i=this.attr(),u=(t||i).matrix;u&&ug(this)},e.prototype.isInShape=function(t,i){return this.isPointInPath(t,i)},e.prototype.isPointInPath=function(t,i){var u=this.get("el"),c=this.get("canvas"),p=c.get("el").getBoundingClientRect(),g=t+p.left,_=i+p.top,w=document.elementFromPoint(g,_);return!!(w&&w.isEqualNode(u))},e.prototype.getHitLineWidth=function(){var t=this.attrs,i=t.lineWidth,u=t.lineAppendWidth;return this.isStroke()?i+u:0},e}(Me.AbstractShape),Dh=I2,gT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="circle",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,r:0})},e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){g==="x"||g==="y"?c.setAttribute("c"+g,p):Yo[g]&&c.setAttribute(Yo[g],p)})},e}(Dh),mT=gT,yT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="dom",t.canFill=!1,t.canStroke=!1,t}return e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");if((0,b.S6)(i||u,function(w,k){Yo[k]&&c.setAttribute(Yo[k],w)}),typeof u.html=="function"){var p=u.html.call(this,u);if(p instanceof Element||p instanceof HTMLDocument){for(var g=c.childNodes,_=g.length-1;_>=0;_--)c.removeChild(g[_]);c.appendChild(p)}else c.innerHTML=p}else c.innerHTML=u.html},e}(Dh),_T=yT,k2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="ellipse",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,rx:0,ry:0})},e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){g==="x"||g==="y"?c.setAttribute("c"+g,p):Yo[g]&&c.setAttribute(Yo[g],p)})},e}(Dh),L2=k2,P2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="image",t.canFill=!1,t.canStroke=!1,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0})},e.prototype.createPath=function(t,i){var u=this,c=this.attr(),p=this.get("el");(0,b.S6)(i||c,function(g,_){_==="img"?u._setImage(c.img):Yo[_]&&p.setAttribute(Yo[_],g)})},e.prototype.setAttr=function(t,i){this.attrs[t]=i,t==="img"&&this._setImage(i)},e.prototype._setImage=function(t){var i=this.attr(),u=this.get("el");if((0,b.HD)(t))u.setAttribute("href",t);else if(t instanceof window.Image)i.width||(u.setAttribute("width",t.width),this.attr("width",t.width)),i.height||(u.setAttribute("height",t.height),this.attr("height",t.height)),u.setAttribute("href",t.src);else if(t instanceof HTMLElement&&(0,b.HD)(t.nodeName)&&t.nodeName.toUpperCase()==="CANVAS")u.setAttribute("href",t.toDataURL());else if(t instanceof ImageData){var c=document.createElement("canvas");c.setAttribute("width",""+t.width),c.setAttribute("height",""+t.height),c.getContext("2d").putImageData(t,0,0),i.width||(u.setAttribute("width",""+t.width),this.attr("width",t.width)),i.height||(u.setAttribute("height",""+t.height),this.attr("height",t.height)),u.setAttribute("href",c.toDataURL())}},e}(Dh),O2=P2,xT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="line",t.canFill=!1,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){if(g==="startArrow"||g==="endArrow")if(p){var _=(0,b.Kn)(p)?t.addArrow(u,Yo[g]):t.getDefaultArrow(u,Yo[g]);c.setAttribute(Yo[g],"url(#"+_+")")}else c.removeAttribute(Yo[g]);else Yo[g]&&c.setAttribute(Yo[g],p)})},e.prototype.getTotalLength=function(){var t=this.attr(),i=t.x1,u=t.y1,c=t.x2,p=t.y2;return Ls.x1.length(i,u,c,p)},e.prototype.getPoint=function(t){var i=this.attr(),u=i.x1,c=i.y1,p=i.x2,g=i.y2;return Ls.x1.pointAt(u,c,p,g,t)},e}(Dh),bT=xT,ry={circle:function(r,e,t){return[["M",r,e],["m",-t,0],["a",t,t,0,1,0,t*2,0],["a",t,t,0,1,0,-t*2,0]]},square:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},diamond:function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},triangle:function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e+i],["L",r,e-i],["L",r+t,e+i],["z"]]},triangleDown:function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e-i],["L",r+t,e-i],["L",r,e+i],["Z"]]}},F2={get:function(r){return ry[r]},register:function(r,e){ry[r]=e},remove:function(r){delete ry[r]},getAll:function(){return ry}},ET=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="marker",t.canFill=!0,t.canStroke=!0,t}return e.prototype.createPath=function(t){var i=this.get("el");i.setAttribute("d",this._assembleMarker())},e.prototype._assembleMarker=function(){var t=this._getPath();return(0,b.kJ)(t)?t.map(function(i){return i.join(" ")}).join(""):t},e.prototype._getPath=function(){var t=this.attr(),i=t.x,u=t.y,c=t.r||t.radius,p=t.symbol||"circle",g;return(0,b.mf)(p)?g=p:g=F2.get(p),g?g(i,u,c):(console.warn(g+" symbol is not exist."),null)},e.symbolsFactory=F2,e}(Dh),ST=ET,wT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="path",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.createPath=function(t,i){var u=this,c=this.attr(),p=this.get("el");(0,b.S6)(i||c,function(g,_){if(_==="path"&&(0,b.kJ)(g))p.setAttribute("d",u._formatPath(g));else if(_==="startArrow"||_==="endArrow")if(g){var w=(0,b.Kn)(g)?t.addArrow(c,Yo[_]):t.getDefaultArrow(c,Yo[_]);p.setAttribute(Yo[_],"url(#"+w+")")}else p.removeAttribute(Yo[_]);else Yo[_]&&p.setAttribute(Yo[_],g)})},e.prototype._formatPath=function(t){var i=t.map(function(u){return u.join(" ")}).join("");return~i.indexOf("NaN")?"":i},e.prototype.getTotalLength=function(){var t=this.get("el");return t?t.getTotalLength():null},e.prototype.getPoint=function(t){var i=this.get("el"),u=this.getTotalLength();if(u===0)return null;var c=i?i.getPointAtLength(t*u):null;return c?{x:c.x,y:c.y}:null},e}(Dh),CT=wT,AT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polygon",t.canFill=!0,t.canStroke=!0,t}return e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){g==="points"&&(0,b.kJ)(p)&&p.length>=2?c.setAttribute("points",p.map(function(_){return _[0]+","+_[1]}).join(" ")):Yo[g]&&c.setAttribute(Yo[g],p)})},e}(Dh),TT=AT,MT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polyline",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),["points"].indexOf(t)!==-1&&this._resetCache()},e.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){g==="points"&&(0,b.kJ)(p)&&p.length>=2?c.setAttribute("points",p.map(function(_){return _[0]+","+_[1]}).join(" ")):Yo[g]&&c.setAttribute(Yo[g],p)})},e.prototype.getTotalLength=function(){var t=this.attr().points,i=this.get("totalLength");return(0,b.UM)(i)?(this.set("totalLength",Ls.aH.length(t)),this.get("totalLength")):i},e.prototype.getPoint=function(t){var i=this.attr().points,u=this.get("tCache");u||(this._setTcache(),u=this.get("tCache"));var c,p;return(0,b.S6)(u,function(g,_){t>=g[0]&&t<=g[1]&&(c=(t-g[0])/(g[1]-g[0]),p=_)}),Ls.x1.pointAt(i[p][0],i[p][1],i[p+1][0],i[p+1][1],c)},e.prototype._setTcache=function(){var t=this.attr().points;if(!(!t||t.length===0)){var i=this.getTotalLength();if(!(i<=0)){var u=0,c=[],p,g;(0,b.S6)(t,function(_,w){t[w+1]&&(p=[],p[0]=u/i,g=Ls.x1.length(_[0],_[1],t[w+1][0],t[w+1][1]),u+=g,p[1]=u/i,c.push(p))}),this.set("tCache",c)}}},e.prototype.getStartTangent=function(){var t=this.attr().points,i=[];return i.push([t[1][0],t[1][1]]),i.push([t[0][0],t[0][1]]),i},e.prototype.getEndTangent=function(){var t=this.attr().points,i=t.length-1,u=[];return u.push([t[i-1][0],t[i-1][1]]),u.push([t[i][0],t[i][1]]),u},e}(Dh),IT=MT,kT=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/gi,LT=/[^\s,]+/gi;function PT(r){var e=0,t=0,i=0,u=0;return(0,b.kJ)(r)?r.length===1?e=t=i=u=r[0]:r.length===2?(e=i=r[0],t=u=r[1]):r.length===3?(e=r[0],t=u=r[1],i=r[2]):(e=r[0],t=r[1],i=r[2],u=r[3]):e=t=i=u=r,{r1:e,r2:t,r3:i,r4:u}}function cO(r){if(r=r||[],isArray(r))return r;if(isString(r))return r=r.match(kT),each(r,function(e,t){if(e=e.match(LT),e[0].length>1){var i=e[0].charAt(0);e.splice(1,0,e[0].substr(1)),e[0]=i}each(e,function(u,c){isNaN(u)||(e[c]=+u)}),r[t]=e}),r}var OT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="rect",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0,radius:0})},e.prototype.createPath=function(t,i){var u=this,c=this.attr(),p=this.get("el"),g=!1,_=["x","y","width","height","radius"];(0,b.S6)(i||c,function(w,k){_.indexOf(k)!==-1&&!g?(p.setAttribute("d",u._assembleRect(c)),g=!0):_.indexOf(k)===-1&&Yo[k]&&p.setAttribute(Yo[k],w)})},e.prototype._assembleRect=function(t){var i=t.x,u=t.y,c=t.width,p=t.height,g=t.radius;if(!g)return"M "+i+","+u+" l "+c+",0 l 0,"+p+" l"+-c+" 0 z";var _=PT(g);(0,b.kJ)(g)?g.length===1?_.r1=_.r2=_.r3=_.r4=g[0]:g.length===2?(_.r1=_.r3=g[0],_.r2=_.r4=g[1]):g.length===3?(_.r1=g[0],_.r2=_.r4=g[1],_.r3=g[2]):(_.r1=g[0],_.r2=g[1],_.r3=g[2],_.r4=g[3]):_.r1=_.r2=_.r3=_.r4=g;var w=[["M "+(i+_.r1)+","+u],["l "+(c-_.r1-_.r2)+",0"],["a "+_.r2+","+_.r2+",0,0,1,"+_.r2+","+_.r2],["l 0,"+(p-_.r2-_.r3)],["a "+_.r3+","+_.r3+",0,0,1,"+-_.r3+","+_.r3],["l "+(_.r3+_.r4-c)+",0"],["a "+_.r4+","+_.r4+",0,0,1,"+-_.r4+","+-_.r4],["l 0,"+(_.r4+_.r1-p)],["a "+_.r1+","+_.r1+",0,0,1,"+_.r1+","+-_.r1],["z"]];return w.join(" ")},e}(Dh),FT=OT,$o=ot(43631),jd=.3,R2={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},D2={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},ny={left:"left",start:"left",center:"middle",right:"end",end:"end"},B2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="text",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},e.prototype.createPath=function(t,i){var u=this,c=this.attr(),p=this.get("el");this._setFont(),(0,b.S6)(i||c,function(g,_){_==="text"?u._setText(""+g):_==="matrix"&&g?ug(u):Yo[_]&&p.setAttribute(Yo[_],g)}),p.setAttribute("paint-order","stroke"),p.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},e.prototype._setFont=function(){var t=this.get("el"),i=this.attr(),u=i.textBaseline,c=i.textAlign,p=(0,$o.qY)();p&&p.name==="firefox"?t.setAttribute("dominant-baseline",D2[u]||"alphabetic"):t.setAttribute("alignment-baseline",R2[u]||"baseline"),t.setAttribute("text-anchor",ny[c]||"left")},e.prototype._setText=function(t){var i=this.get("el"),u=this.attr(),c=u.x,p=u.textBaseline,g=p===void 0?"bottom":p;if(!t)i.innerHTML="";else if(~t.indexOf(`
`)){var _=t.split(`
`),w=_.length-1,k="";(0,b.S6)(_,function(L,R){R===0?g==="alphabetic"?k+='<tspan x="'+c+'" dy="'+-w+'em">'+L+"</tspan>":g==="top"?k+='<tspan x="'+c+'" dy="0.9em">'+L+"</tspan>":g==="middle"?k+='<tspan x="'+c+'" dy="'+-(w-1)/2+'em">'+L+"</tspan>":g==="bottom"?k+='<tspan x="'+c+'" dy="-'+(w+jd)+'em">'+L+"</tspan>":g==="hanging"&&(k+='<tspan x="'+c+'" dy="'+(-(w-1)-jd)+'em">'+L+"</tspan>"):k+='<tspan x="'+c+'" dy="1em">'+L+"</tspan>"}),i.innerHTML=k}else i.innerHTML=t},e}(Dh),N2=B2,RT=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,DT=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,BT=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function u1(r){var e=r.match(BT);if(!e)return"";var t="";return e.sort(function(i,u){return i=i.split(":"),u=u.split(":"),Number(i[0])-Number(u[0])}),(0,b.S6)(e,function(i){i=i.split(":"),t+='<stop offset="'+i[0]+'" stop-color="'+i[1]+'"></stop>'}),t}function z2(r,e){var t=RT.exec(r),i=(0,b.wQ)((0,b.c$)(parseFloat(t[1])),Math.PI*2),u=t[2],c,p;i>=0&&i<.5*Math.PI?(c={x:0,y:0},p={x:1,y:1}):.5*Math.PI<=i&&i<Math.PI?(c={x:1,y:0},p={x:0,y:1}):Math.PI<=i&&i<1.5*Math.PI?(c={x:1,y:1},p={x:0,y:0}):(c={x:0,y:1},p={x:1,y:0});var g=Math.tan(i),_=g*g,w=(p.x-c.x+g*(p.y-c.y))/(_+1)+c.x,k=g*(p.x-c.x+g*(p.y-c.y))/(_+1)+c.y;e.setAttribute("x1",c.x),e.setAttribute("y1",c.y),e.setAttribute("x2",w),e.setAttribute("y2",k),e.innerHTML=u1(u)}function U2(r,e){var t=DT.exec(r),i=parseFloat(t[1]),u=parseFloat(t[2]),c=parseFloat(t[3]),p=t[4];e.setAttribute("cx",i),e.setAttribute("cy",u),e.setAttribute("r",c),e.innerHTML=u1(p)}var l1=function(){function r(e){this.cfg={};var t=null,i=(0,b.EL)("gradient_");return e.toLowerCase()[0]==="l"?(t=oh("linearGradient"),z2(e,t)):(t=oh("radialGradient"),U2(e,t)),t.setAttribute("id",i),this.el=t,this.id=i,this.cfg=e,this}return r.prototype.match=function(e,t){return this.cfg===t},r}(),Z2=l1,NT={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},zT={x:"-40%",y:"-40%",width:"200%",height:"200%"},V2=function(){function r(e){this.type="filter",this.cfg={},this.type="filter";var t=oh("filter");return(0,b.S6)(zT,function(i,u){t.setAttribute(u,i)}),this.el=t,this.id=(0,b.EL)("filter_"),this.el.id=this.id,this.cfg=e,this._parseShadow(e,t),this}return r.prototype.match=function(e,t){if(this.type!==e)return!1;var i=!0,u=this.cfg;return(0,b.S6)(Object.keys(u),function(c){if(u[c]!==t[c])return i=!1,!1}),i},r.prototype.update=function(e,t){var i=this.cfg;return i[NT[e]]=t,this._parseShadow(i,this.el),this},r.prototype._parseShadow=function(e,t){var i=`<feDropShadow
      dx="`+(e.dx||0)+`"
      dy="`+(e.dy||0)+`"
      stdDeviation="`+(e.blur?e.blur/10:0)+`"
      flood-color="`+(e.color?e.color:"#000")+`"
      flood-opacity="`+(e.opacity?e.opacity:1)+`"
      />`;t.innerHTML=i},r}(),UT=V2,G2=function(){function r(e,t){this.cfg={};var i=oh("marker"),u=(0,b.EL)("marker_");i.setAttribute("id",u);var c=oh("path");c.setAttribute("stroke",e.stroke||"none"),c.setAttribute("fill",e.fill||"none"),i.appendChild(c),i.setAttribute("overflow","visible"),i.setAttribute("orient","auto-start-reverse"),this.el=i,this.child=c,this.id=u;var p=e[t==="marker-start"?"startArrow":"endArrow"];return this.stroke=e.stroke||"#000",p===!0?this._setDefaultPath(t,c):(this.cfg=p,this._setMarker(e.lineWidth,c)),this}return r.prototype.match=function(){return!1},r.prototype._setDefaultPath=function(e,t){var i=this.el;t.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),i.setAttribute("refX",""+10*Math.cos(Math.PI/6)),i.setAttribute("refY",""+5)},r.prototype._setMarker=function(e,t){var i=this.el,u=this.cfg.path,c=this.cfg.d;(0,b.kJ)(u)&&(u=u.map(function(p){return p.join(" ")}).join("")),t.setAttribute("d",u),i.appendChild(t),c&&i.setAttribute("refX",""+c/e)},r.prototype.update=function(e){var t=this.child;t.attr?t.attr("fill",e):t.setAttribute("fill",e)},r}(),c1=G2,ZT=function(){function r(e){this.type="clip",this.cfg={};var t=oh("clipPath");this.el=t,this.id=(0,b.EL)("clip_"),t.id=this.id;var i=e.cfg.el;return t.appendChild(i),this.cfg=e,this}return r.prototype.match=function(){return!1},r.prototype.remove=function(){var e=this.el;e.parentNode.removeChild(e)},r}(),VT=ZT,GT=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,H2=function(){function r(e){this.cfg={};var t=oh("pattern");t.setAttribute("patternUnits","userSpaceOnUse");var i=oh("image");t.appendChild(i);var u=(0,b.EL)("pattern_");t.id=u,this.el=t,this.id=u,this.cfg=e;var c=GT.exec(e),p=c[2];i.setAttribute("href",p);var g=new Image;p.match(/^data:/i)||(g.crossOrigin="Anonymous"),g.src=p;function _(){t.setAttribute("width",""+g.width),t.setAttribute("height",""+g.height)}return g.complete?_():(g.onload=_,g.src=g.src),this}return r.prototype.match=function(e,t){return this.cfg===t},r}(),j2=H2,W2=function(){function r(e){var t=oh("defs"),i=(0,b.EL)("defs_");t.id=i,e.appendChild(t),this.children=[],this.defaultArrow={},this.el=t,this.canvas=e}return r.prototype.find=function(e,t){for(var i=this.children,u=null,c=0;c<i.length;c++)if(i[c].match(e,t)){u=i[c].id;break}return u},r.prototype.findById=function(e){for(var t=this.children,i=null,u=0;u<t.length;u++)if(t[u].id===e){i=t[u];break}return i},r.prototype.add=function(e){this.children.push(e),e.canvas=this.canvas,e.parent=this},r.prototype.getDefaultArrow=function(e,t){var i=e.stroke||e.strokeStyle;if(this.defaultArrow[i])return this.defaultArrow[i].id;var u=new c1(e,t);return this.defaultArrow[i]=u,this.el.appendChild(u.el),this.add(u),u.id},r.prototype.addGradient=function(e){var t=new Z2(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addArrow=function(e,t){var i=new c1(e,t);return this.el.appendChild(i.el),this.add(i),i.id},r.prototype.addShadow=function(e){var t=new UT(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addPattern=function(e){var t=new j2(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addClip=function(e){var t=new VT(e);return this.el.appendChild(t.el),this.add(t),t.id},r}(),f1=W2,X2=function(r){(0,P.ZT)(e,r);function e(t){return r.call(this,(0,P.pi)((0,P.pi)({},t),{autoDraw:!0,renderer:"svg"}))||this}return e.prototype.getShapeBase=function(){return it},e.prototype.getGroupBase=function(){return ey},e.prototype.getShape=function(t,i,u){var c=u.target||u.srcElement;if(!ty[c.tagName]){for(var p=c.parentNode;p&&!ty[p.tagName];)p=p.parentNode;c=p}return this.find(function(g){return g.get("el")===c})},e.prototype.createDom=function(){var t=oh("svg"),i=new f1(t);return t.setAttribute("width",""+this.get("width")),t.setAttribute("height",""+this.get("height")),this.set("context",i),t},e.prototype.onCanvasChange=function(t){var i=this.get("context"),u=this.get("el");if(t==="sort"){var c=this.get("children");c&&c.length&&a1(this,function(g,_){return c.indexOf(g)-c.indexOf(_)?1:0})}else if(t==="clear"){if(u){u.innerHTML="";var p=i.el;p.innerHTML="",u.appendChild(p)}}else t==="matrix"?ug(this):t==="clip"?lg(this,i):t==="changeSize"&&(u.setAttribute("width",""+this.get("width")),u.setAttribute("height",""+this.get("height")))},e.prototype.draw=function(){var t=this.get("context"),i=this.getChildren();lg(this,t),i.length&&o1(t,i)},e}(Me.AbstractCanvas),HT=X2,Wd="0.5.6",Y2=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="path",i.shapeType="line";var u=t.connectNulls,c=u===void 0?!1:u,p=t.showSinglePoint,g=p===void 0?!0:p;return i.connectNulls=c,i.showSinglePoint=g,i}return e.prototype.updateElements=function(t,i){var u,c,p,g,_,w;i===void 0&&(i=!1);for(var k=new Map,L=new Map,R=[],U=0,G=0;G<t.length;G++){var Q=t[G],pt=this.getElementId(Q);R.push(pt),k.set(pt,Q),L.set(pt,U),U++}this.elements=new Array(U);var vt=Ss(this.lastElementsMap,R),Vt=vt.added,le=vt.updated,he=vt.removed;try{for(var Ne=(0,P.XA)(Vt),Er=Ne.next();!Er.done;Er=Ne.next()){var pt=Er.value,Q=k.get(pt),Fr=this.getShapeFactory(),zr=this.getShapeInfo(Q),G=L.get(pt),pn=new Ws({shapeFactory:Fr,container:this.container,offscreenGroup:this.getOffscreenGroup(),elementIndex:G});pn.geometry=this,pn.animate=this.animateOption,pn.draw(zr,i),this.elementsMap[pt]=pn,this.elements[G]=pn}}catch(_o){u={error:_o}}finally{try{Er&&!Er.done&&(c=Ne.return)&&c.call(Ne)}finally{if(u)throw u.error}}try{for(var nn=(0,P.XA)(le),Pn=nn.next();!Pn.done;Pn=nn.next()){var pt=Pn.value,Q=k.get(pt),pn=this.lastElementsMap[pt],G=L.get(pt),zr=this.getShapeInfo(Q),Si=pn.getModel();(this.isCoordinateChanged||jl(Si,zr))&&(pn.animate=this.animateOption,pn.update(zr)),this.elementsMap[pt]=pn,this.elements[G]=pn}}catch(_o){p={error:_o}}finally{try{Pn&&!Pn.done&&(g=nn.return)&&g.call(nn)}finally{if(p)throw p.error}}try{for(var ha=(0,P.XA)(he),wa=ha.next();!wa.done;wa=ha.next()){var pt=wa.value,pn=this.lastElementsMap[pt];pn.animate=this.animateOption,pn.destroy()}}catch(_o){_={error:_o}}finally{try{wa&&!wa.done&&(w=ha.return)&&w.call(ha)}finally{if(_)throw _.error}}},e.prototype.getPointsAndData=function(t){for(var i=[],u=[],c=0,p=t.length;c<p;c++){var g=t[c];i.push({x:g.x,y:g.y}),u.push(g[ge])}return{points:i,data:u}},e.prototype.getShapeInfo=function(t){var i=this.getDrawCfg(t[0]),u=this.getPointsAndData(t),c=u.points,p=u.data;return i.mappingData=t,i.data=p,i.isStack=!!this.getAdjust("stack"),i.points=c,i.connectNulls=this.connectNulls,i.showSinglePoint=this.showSinglePoint,i},e}(fu),iy=Y2;function jT(r,e,t,i,u){var c=[];if(r.length){for(var p=[],g=[],_=0,w=r.length;_<w;_++){var k=r[_];p.push(k[1]),g.push(k[0])}g=g.reverse(),(0,b.S6)([p,g],function(L,R){var U=[],G=i.parsePoints(L),Q=G[0];p.length===1&&g.length===1?U=R===0?[["M",Q.x-.5,Q.y],["L",Q.x+.5,Q.y]]:[["L",Q.x+.5,Q.y],["L",Q.x-.5,Q.y]]:(e&&G.push({x:Q.x,y:Q.y}),t?U=Qs(G,!1,u):U=Xo(G,!1),R>0&&(U[0][0]="L")),c=c.concat(U)}),c.push(["Z"])}return c}function ay(r,e,t,i,u){for(var c=Us(r,e,!e,"lineWidth"),p=r.connectNulls,g=r.isInCircle,_=r.points,w=r.showSinglePoint,k=td(_,p,w),L=[],R=0,U=k.length;R<U;R++){var G=k[R];L=L.concat(jT(G,g,t,i,u))}return c.path=L,c}function $2(r){var e=r.start,t=r.end;return[[e.x,t.y],[t.x,e.y]]}var fO=ro("area",{defaultShapeType:"area",getDefaultPoints:function(r){var e=r.x,t=r.y0,i=(0,b.kJ)(r.y)?r.y:[t,r.y];return i.map(function(u){return{x:e,y:u}})}});va("area","area",{draw:function(r,e){var t=ay(r,!1,!1,this),i=e.addShape({type:"path",attrs:t,name:"area"});return i},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return u===void 0&&(u=5.5),[["M",t-u,i-4],["L",t+u,i-4],["L",t+u,i+4],["L",t-u,i+4],["Z"]]},style:{r:5,fill:e,fillOpacity:1}}}});var hO=null,q2=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="area",i.shapeType="area",i.generatePoints=!0,i.startOnZero=!0;var u=t.startOnZero,c=u===void 0?!0:u,p=t.sortable,g=p===void 0?!1:p,_=t.showSinglePoint,w=_===void 0?!1:_;return i.startOnZero=c,i.sortable=g,i.showSinglePoint=w,i}return e.prototype.getPointsAndData=function(t){for(var i=[],u=[],c=0,p=t.length;c<p;c++){var g=t[c];i.push(g.points),u.push(g[ge])}return{points:i,data:u}},e.prototype.getYMinValue=function(){if(this.startOnZero)return r.prototype.getYMinValue.call(this);var t=this.getYScale();return t.min},e}(iy),K2=q2,pO=ro("edge",{defaultShapeType:"line",getDefaultPoints:function(r){return dp(r)}});va("edge","line",{draw:function(r,e){var t=Us(r,!0,!1,"lineWidth"),i=Xo(this.parsePoints(r.points),this.coordinate.isPolar);return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}});var dO=null,WT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="edge",t.shapeType="edge",t.generatePoints=!0,t}return e}(fu),XT=WT,YT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="heatmap",t.paletteCache={},t}return e.prototype.updateElements=function(t,i){i===void 0&&(i=!1);for(var u=0;u<t.length;u++){var c=t[u],p=this.prepareRange(c),g=this.prepareSize(),_=(0,b.U2)(this.styleOption,["cfg","shadowBlur"]);(0,b.hj)(_)||(_=g/2),this.prepareGreyScaleBlurredCircle(g,_),this.drawWithRange(c,p,g,_)}},e.prototype.color=function(t,i){return this.createAttrOption("color",t,typeof i!="function"?i:""),this},e.prototype.clear=function(){r.prototype.clear.call(this),this.clearShadowCanvasCtx(),this.paletteCache={}},e.prototype.prepareRange=function(t){var i=this.getAttribute("color"),u=i.getFields()[0],c=1/0,p=-1/0;return t.forEach(function(g){var _=g[ge][u];_>p&&(p=_),_<c&&(c=_)}),c===p&&(c=p-1),[c,p]},e.prototype.prepareSize=function(){var t=this.getDefaultValue("size");return(0,b.hj)(t)||(t=this.getDefaultSize()),t},e.prototype.prepareGreyScaleBlurredCircle=function(t,i){var u=this.getGrayScaleBlurredCanvas(),c=t+i,p=u.getContext("2d");u.width=u.height=c*2,p.clearRect(0,0,u.width,u.height),p.shadowOffsetX=p.shadowOffsetY=c*2,p.shadowBlur=i,p.shadowColor="black",p.beginPath(),p.arc(-c,-c,t,0,Math.PI*2,!0),p.closePath(),p.fill()},e.prototype.drawWithRange=function(t,i,u,c){var p,g,_=this.coordinate,w=_.start,k=_.end,L=this.coordinate.getWidth(),R=this.coordinate.getHeight(),U=this.getAttribute("color"),G=U.getFields()[0];this.clearShadowCanvasCtx();var Q=this.getShadowCanvasCtx();i&&(t=t.filter(function(nn){return nn[ge][G]<=i[1]&&nn[ge][G]>=i[0]}));var pt=this.scales[G];try{for(var vt=(0,P.XA)(t),Vt=vt.next();!Vt.done;Vt=vt.next()){var le=Vt.value,he=this.getDrawCfg(le),Ne=he.x,Er=he.y,Fr=pt.scale(le[ge][G]);this.drawGrayScaleBlurredCircle(Ne-w.x,Er-k.y,u+c,Fr,Q)}}catch(nn){p={error:nn}}finally{try{Vt&&!Vt.done&&(g=vt.return)&&g.call(vt)}finally{if(p)throw p.error}}var zr=Q.getImageData(0,0,L,R);this.clearShadowCanvasCtx(),this.colorize(zr),Q.putImageData(zr,0,0);var pn=this.getImageShape();pn.attr("x",w.x),pn.attr("y",k.y),pn.attr("width",L),pn.attr("height",R),pn.attr("img",Q.canvas),pn.set("origin",this.getShapeInfo(t))},e.prototype.getDefaultSize=function(){var t=this.getAttribute("position"),i=this.coordinate;return Math.min(i.getWidth()/(t.scales[0].ticks.length*4),i.getHeight()/(t.scales[1].ticks.length*4))},e.prototype.clearShadowCanvasCtx=function(){var t=this.getShadowCanvasCtx();t.clearRect(0,0,t.canvas.width,t.canvas.height)},e.prototype.getShadowCanvasCtx=function(){var t=this.shadowCanvas;return t||(t=document.createElement("canvas"),this.shadowCanvas=t),t.width=this.coordinate.getWidth(),t.height=this.coordinate.getHeight(),t.getContext("2d")},e.prototype.getGrayScaleBlurredCanvas=function(){return this.grayScaleBlurredCanvas||(this.grayScaleBlurredCanvas=document.createElement("canvas")),this.grayScaleBlurredCanvas},e.prototype.drawGrayScaleBlurredCircle=function(t,i,u,c,p){var g=this.getGrayScaleBlurredCanvas();p.globalAlpha=c,p.drawImage(g,t-u,i-u)},e.prototype.colorize=function(t){for(var i=this.getAttribute("color"),u=t.data,c=this.paletteCache,p=3;p<u.length;p+=4){var g=u[p];if((0,b.hj)(g)){var _=c[g]?c[g]:Ya.rgb2arr(i.gradient(g/256));u[p-3]=_[0],u[p-2]=_[1],u[p-1]=_[2],u[p]=g}}},e.prototype.getImageShape=function(){var t=this.imageShape;if(t)return t;var i=this.container;return t=i.addShape({type:"image",attrs:{}}),this.imageShape=t,t},e.prototype.getShapeInfo=function(t){var i=this.getDrawCfg(t[0]),u=t.map(function(c){return c[ge]});return(0,P.pi)((0,P.pi)({},i),{mappingData:t,data:u})},e}(fu),Q2=YT;function oy(r){var e,t,i=r.x,u=r.y,c=r.y0,p=r.size,g,_;(0,b.kJ)(u)?(e=(0,P.CR)(u,2),g=e[0],_=e[1]):(g=c,_=u);var w,k;(0,b.kJ)(i)?(t=(0,P.CR)(i,2),w=t[0],k=t[1]):(w=i-p/2,k=i+p/2);var L=[{x:w,y:g},{x:w,y:_}];return L.push({x:k,y:_},{x:k,y:g}),L}function h1(r,e){e===void 0&&(e=!0);var t=[],i=r[0];t.push(["M",i.x,i.y]);for(var u=1,c=r.length;u<c;u++)t.push(["L",r[u].x,r[u].y]);return e&&(t.push(["L",i.x,i.y]),t.push(["z"])),t}function J2(r,e){var t=0,i=0,u=0,c=0;return(0,b.kJ)(r)?r.length===1?t=i=u=c=r[0]:r.length===2?(t=u=r[0],i=c=r[1]):r.length===3?(t=r[0],i=c=r[1],u=r[2]):(t=r[0],i=r[1],u=r[2],c=r[3]):t=i=u=c=r,t+i>e&&(t=t?e/(1+i/t):0,i=e-t),u+c>e&&(u=u?e/(1+c/u):0,c=e-u),[t||0,i||0,u||0,c||0]}function tE(r,e,t){var i=[];if(t.isRect){var u=t.isTransposed?{x:t.start.x,y:e[0].y}:{x:e[0].x,y:t.start.y},c=t.isTransposed?{x:t.end.x,y:e[2].y}:{x:e[3].x,y:t.end.y},p=(0,b.U2)(r,["background","style","radius"]);if(p){var g=t.isTransposed?Math.abs(e[0].y-e[2].y):e[2].x-e[1].x,_=t.isTransposed?t.getWidth():t.getHeight(),w=(0,P.CR)(J2(p,Math.min(g,_)),4),k=w[0],L=w[1],R=w[2],U=w[3],G=t.isTransposed&&t.isReflect("y"),Q=G?0:1,pt=function(Er){return G?-Er:Er};i.push(["M",u.x,c.y+pt(k)]),k!==0&&i.push(["A",k,k,0,0,Q,u.x+k,c.y]),i.push(["L",c.x-L,c.y]),L!==0&&i.push(["A",L,L,0,0,Q,c.x,c.y+pt(L)]),i.push(["L",c.x,u.y-pt(R)]),R!==0&&i.push(["A",R,R,0,0,Q,c.x-R,u.y]),i.push(["L",u.x+U,u.y]),U!==0&&i.push(["A",U,U,0,0,Q,u.x,u.y-pt(U)])}else i.push(["M",u.x,u.y]),i.push(["L",c.x,u.y]),i.push(["L",c.x,c.y]),i.push(["L",u.x,c.y]),i.push(["L",u.x,u.y]);i.push(["z"])}if(t.isPolar){var vt=t.getCenter(),Vt=Xp(r,t),le=Vt.startAngle,he=Vt.endAngle;if(t.type!=="theta"&&!t.isTransposed)i=gu(vt.x,vt.y,t.getRadius(),le,he);else{var Ne=function(zr){return Math.pow(zr,2)},k=Math.sqrt(Ne(vt.x-e[0].x)+Ne(vt.y-e[0].y)),L=Math.sqrt(Ne(vt.x-e[2].x)+Ne(vt.y-e[2].y));i=gu(vt.x,vt.y,k,t.startAngle,t.endAngle,L)}}return i}function $T(r,e,t){var i=t.getWidth(),u=t.getHeight(),c=t.type==="rect",p=[],g=(r[2].x-r[1].x)/2,_=t.isTransposed?g*u/i:g*i/u;return e==="round"?(c?(p.push(["M",r[0].x,r[0].y+_]),p.push(["L",r[1].x,r[1].y-_]),p.push(["A",g,g,0,0,1,r[2].x,r[2].y-_]),p.push(["L",r[3].x,r[3].y+_]),p.push(["A",g,g,0,0,1,r[0].x,r[0].y+_])):(p.push(["M",r[0].x,r[0].y]),p.push(["L",r[1].x,r[1].y]),p.push(["A",g,g,0,0,1,r[2].x,r[2].y]),p.push(["L",r[3].x,r[3].y]),p.push(["A",g,g,0,0,1,r[0].x,r[0].y])),p.push(["z"])):p=h1(r),p}function eE(r,e,t){var i=[];return(0,b.UM)(e)?t?i.push(["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["L",(r[2].x+r[3].x)/2,(r[2].y+r[3].y)/2],["Z"]):i.push(["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["L",r[2].x,r[2].y],["L",r[3].x,r[3].y],["Z"]):i.push(["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["L",e[1].x,e[1].y],["L",e[0].x,e[0].y],["Z"]),i}function cg(r,e){return[e,r]}function rE(r,e,t){var i,u,c,p,g,_,w,k=(0,P.CR)((0,P.ev)([],(0,P.CR)(r),!1),4),L=k[0],R=k[1],U=k[2],G=k[3],Q=(0,P.CR)(typeof t=="number"?Array(4).fill(t):t,4),pt=Q[0],vt=Q[1],Vt=Q[2],le=Q[3];e.isTransposed&&(i=(0,P.CR)(cg(R,G),2),R=i[0],G=i[1]),e.isReflect("y")&&(u=(0,P.CR)(cg(L,R),2),L=u[0],R=u[1],c=(0,P.CR)(cg(U,G),2),U=c[0],G=c[1]),e.isReflect("x")&&(p=(0,P.CR)(cg(L,G),2),L=p[0],G=p[1],g=(0,P.CR)(cg(R,U),2),R=g[0],U=g[1]);var he=[],Ne=function(Er){return Math.abs(Er)};return _=(0,P.CR)(J2([pt,vt,Vt,le],Math.min(Ne(G.x-L.x),Ne(R.y-L.y))).map(function(Er){return Ne(Er)}),4),pt=_[0],vt=_[1],Vt=_[2],le=_[3],e.isTransposed&&(w=(0,P.CR)([le,pt,vt,Vt],4),pt=w[0],vt=w[1],Vt=w[2],le=w[3]),L.y<R.y?(he.push(["M",G.x,G.y+Vt]),Vt!==0&&he.push(["A",Vt,Vt,0,0,0,G.x-Vt,G.y]),he.push(["L",L.x+le,L.y]),le!==0&&he.push(["A",le,le,0,0,0,L.x,L.y+le]),he.push(["L",R.x,R.y-pt]),pt!==0&&he.push(["A",pt,pt,0,0,0,R.x+pt,R.y]),he.push(["L",U.x-vt,U.y]),vt!==0&&he.push(["A",vt,vt,0,0,0,U.x,U.y-vt]),he.push(["L",G.x,G.y+Vt]),he.push(["z"])):G.x<L.x?(he.push(["M",U.x+vt,U.y]),vt!==0&&he.push(["A",vt,vt,0,0,0,U.x,U.y+vt]),he.push(["L",G.x,G.y-Vt]),Vt!==0&&he.push(["A",Vt,Vt,0,0,0,G.x+Vt,G.y]),he.push(["L",L.x-le,L.y]),le!==0&&he.push(["A",le,le,0,0,0,L.x,L.y-le]),he.push(["L",R.x,R.y+pt]),pt!==0&&he.push(["A",pt,pt,0,0,0,R.x-pt,R.y]),he.push(["L",U.x+vt,U.y]),he.push(["z"])):(he.push(["M",R.x,R.y+pt]),pt!==0&&he.push(["A",pt,pt,0,0,1,R.x+pt,R.y]),he.push(["L",U.x-vt,U.y]),vt!==0&&he.push(["A",vt,vt,0,0,1,U.x,U.y+vt]),he.push(["L",G.x,G.y-Vt]),Vt!==0&&he.push(["A",Vt,Vt,0,0,1,G.x-Vt,G.y]),he.push(["L",L.x+le,L.y]),le!==0&&he.push(["A",le,le,0,0,1,L.x,L.y-le]),he.push(["L",R.x,R.y+pt]),he.push(["z"])),he}var vO=ro("interval",{defaultShapeType:"rect",getDefaultPoints:function(r){return oy(r)}});va("interval","rect",{draw:function(r,e){var t=Us(r,!1,!0),i=e,u=r==null?void 0:r.background;if(u){i=e.addGroup({name:"interval-group"});var c=Kt(r),p=tE(r,this.parsePoints(r.points),this.coordinate);i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},c),{path:p}),zIndex:-1,name:Es})}var g;t.radius&&this.coordinate.isRect?g=rE(this.parsePoints(r.points),this.coordinate,t.radius):g=this.parsePath($T(r.points,t.lineCap,this.coordinate));var _=i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:g}),name:"interval"});return u?i:_},getMarker:function(r){var e=r.color,t=r.isInPolar;return t?{symbol:"circle",style:{r:4.5,fill:e}}:{symbol:"square",style:{r:4,fill:e}}}});var gO=null;function qT(r,e){var t=r.length,i=r;(0,b.HD)(i[0])&&(i=r.map(function(g){return e.translate(g)}));for(var u=i[1]-i[0],c=2;c<t;c++){var p=i[c]-i[c-1];u>p&&(u=p)}return u}function KT(r,e){if(e){var t=(0,b.xH)(r),i=(0,b.I)(t,e);return i.length}return r.length}function p1(r){var e=r.theme,t=r.coordinate,i=r.getXScale(),u=i.values,c=r.beforeMappingData,p=u.length,g=th(r.coordinate),_=r.intervalPadding,w=r.dodgePadding,k=r.maxColumnWidth||e.maxColumnWidth,L=r.minColumnWidth||e.minColumnWidth,R=r.columnWidthRatio||e.columnWidthRatio,U=r.multiplePieWidthRatio||e.multiplePieWidthRatio,G=r.roseWidthRatio||e.roseWidthRatio;if(i.isLinear&&u.length>1){u.sort();var Q=qT(u,i);p=(i.max-i.min)/Q,u.length>p&&(p=u.length)}var pt=i.range,vt=1/p,Vt=1;if(t.isPolar?t.isTransposed&&p>1?Vt=U:Vt=G:(i.isLinear&&(vt*=pt[1]-pt[0]),Vt=R),!(0,b.UM)(_)&&_>=0){var le=_/g;vt=(1-(p-1)*le)/p}else vt*=Vt;if(r.getAdjust("dodge")){var he=r.getAdjust("dodge"),Ne=he.dodgeBy,Er=KT(c,Ne);if(!(0,b.UM)(w)&&w>=0){var Fr=w/g;vt=(vt-Fr*(Er-1))/Er}else!(0,b.UM)(_)&&_>=0&&(vt*=Vt),vt=vt/Er;vt=vt>=0?vt:0}if(!(0,b.UM)(k)&&k>=0){var zr=k/g;vt>zr&&(vt=zr)}if(!(0,b.UM)(L)&&L>=0){var pn=L/g;vt<pn&&(vt=pn)}return vt}var nE=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="interval",i.shapeType="interval",i.generatePoints=!0;var u=t.background;return i.background=u,i}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),u,c=this.getAttribute("size");if(c){u=this.getAttributeValues(c,t)[0];var p=this.coordinate,g=th(p);u=u/g}else this.defaultSize||(this.defaultSize=p1(this)),u=this.defaultSize;return i.size=u,i},e.prototype.adjustScale=function(){r.prototype.adjustScale.call(this);var t=this.getYScale();if(this.coordinate.type==="theta")t.change({nice:!1,min:0,max:Dn(t)});else{var i=this.scaleDefs,u=t.field,c=t.min,p=t.max,g=t.type;g!=="time"&&(c>0&&!(0,b.U2)(i,[u,"min"])&&t.change({min:0}),p<=0&&!(0,b.U2)(i,[u,"max"])&&t.change({max:0}))}},e.prototype.getDrawCfg=function(t){var i=r.prototype.getDrawCfg.call(this,t);return i.background=this.background,i},e}(fu),iE=nE,QT=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="line";var u=t.sortable,c=u===void 0?!1:u;return i.sortable=c,i}return e}(iy),JT=QT,aE=["circle","square","bowtie","diamond","hexagon","triangle","triangle-down"],tM=["cross","tick","plus","hyphen","line"];function d1(r,e,t,i,u){var c,p,g=Us(e,u,!u,"r"),_=r.parsePoints(e.points),w=_[0];if(e.isStack)w=_[1];else if(_.length>1){var k=t.addGroup();try{for(var L=(0,P.XA)(_),R=L.next();!R.done;R=L.next()){var U=R.value;k.addShape({type:"marker",attrs:(0,P.pi)((0,P.pi)((0,P.pi)({},g),{symbol:yc[i]||i}),U)})}}catch(G){c={error:G}}finally{try{R&&!R.done&&(p=L.return)&&p.call(L)}finally{if(c)throw c.error}}return k}return t.addShape({type:"marker",attrs:(0,P.pi)((0,P.pi)((0,P.pi)({},g),{symbol:yc[i]||i}),w)})}var eM=ro("point",{defaultShapeType:"hollow-circle",getDefaultPoints:function(r){return dp(r)}});(0,b.S6)(aE,function(r){va("point","hollow-".concat(r),{draw:function(e,t){return d1(this,e,t,r,!0)},getMarker:function(e){var t=e.color;return{symbol:yc[r]||r,style:{r:4.5,stroke:t,fill:null}}}})});var rM=null,nM=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="point",t.shapeType="point",t.generatePoints=!0,t}return e.prototype.getDrawCfg=function(t){var i=r.prototype.getDrawCfg.call(this,t);return(0,P.pi)((0,P.pi)({},i),{isStack:!!this.getAdjust("stack")})},e}(fu),iM=nM;function aM(r){for(var e=r[0],t=1,i=[["M",e.x,e.y]];t<r.length;){var u=r[t];(u.x!==r[t-1].x||u.y!==r[t-1].y)&&(i.push(["L",u.x,u.y]),u.x===e.x&&u.y===e.y&&t<r.length-1&&(e=r[t+1],i.push(["Z"]),i.push(["M",e.x,e.y]),t++)),t++}return(0,b.Xy)((0,b.Z$)(i),e)||i.push(["L",e.x,e.y]),i.push(["Z"]),i}var mO=ro("polygon",{defaultShapeType:"polygon",getDefaultPoints:function(r){var e=[];return(0,b.S6)(r.x,function(t,i){var u=r.y[i];e.push({x:t,y:u})}),e}});va("polygon","polygon",{draw:function(r,e){if(!(0,b.xb)(r.points)){var t=Us(r,!0,!0),i=this.parsePath(aM(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"polygon"})}},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}});var yO=null,oE=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polygon",t.shapeType="polygon",t.generatePoints=!0,t}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),u=i.x,c=i.y,p;if(!((0,b.kJ)(u)&&(0,b.kJ)(c))){var g=this.getXScale(),_=this.getYScale(),w=g.values.length,k=_.values.length,L=.5*1/w,R=.5*1/k;g.isCategory&&_.isCategory?(u=[u-L,u-L,u+L,u+L],c=[c-R,c+R,c+R,c-R]):(0,b.kJ)(u)?(p=u,u=[p[0],p[0],p[1],p[1]],c=[c-R/2,c+R/2,c+R/2,c-R/2]):(0,b.kJ)(c)&&(p=c,c=[p[0],p[1],p[1],p[0]],u=[u-L/2,u-L/2,u+L/2,u+L/2]),i.x=u,i.y=c}return i},e}(fu),sE=oE,_O=ro("schema",{defaultShapeType:""}),xO=null,oM=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="schema",t.shapeType="schema",t.generatePoints=!0,t}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),u,c=this.getAttribute("size");if(c){u=this.getAttributeValues(c,t)[0];var p=this.coordinate,g=th(p);u=u/g}else this.defaultSize||(this.defaultSize=p1(this)),u=this.defaultSize;return i.size=u,i},e}(fu),sM=oM;function uM(r){if(!(0,b.kJ)(r))return[];var e=(0,b.Fp)(r);return(0,b.UI)(r,function(t){return t/e})}var lM=ro("violin",{defaultShapeType:"violin",getDefaultPoints:function(r){var e=r.size/2,t=[],i=uM(r._size);return(0,b.S6)(r.y,function(u,c){var p=i[c]*e,g=c===0,_=c===r.y.length-1;t.push({isMin:g,isMax:_,x:r.x-p,y:u}),t.unshift({isMin:g,isMax:_,x:r.x+p,y:u})}),t}});va("violin","violin",{draw:function(r,e){var t=Us(r,!0,!0),i=this.parsePath(wv(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"violin"})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4,fill:e}}}});var cM=null,fM=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="violin",t.shapeType="violin",t.generatePoints=!0,t}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),u,c=this.getAttribute("size");if(c){u=this.getAttributeValues(c,t)[0];var p=this.coordinate,g=th(p);u=u/g}else this.defaultSize||(this.defaultSize=p1(this)),u=this.defaultSize;return i.size=u,i._size=(0,b.U2)(t[ge],[this._sizeField]),i},e.prototype.initAttributes=function(){var t=this.attributeOption,i=t.size?t.size.fields[0]:this._sizeField?this._sizeField:"size";this._sizeField=i,delete t.size,r.prototype.initAttributes.call(this)},e}(fu),hM=fM;va("area","line",{draw:function(r,e){var t=ay(r,!0,!1,this),i=e.addShape({type:"path",attrs:t,name:"area"});return i},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return u===void 0&&(u=5.5),[["M",t-u,i-4],["L",t+u,i-4],["L",t+u,i+4],["L",t-u,i+4],["Z"]]},style:{r:5,stroke:e,fill:null}}}}),va("area","smooth",{draw:function(r,e){var t=this.coordinate,i=ay(r,!1,!0,this,$2(t)),u=e.addShape({type:"path",attrs:i,name:"area"});return u},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return u===void 0&&(u=5.5),[["M",t-u,i-4],["L",t+u,i-4],["L",t+u,i+4],["L",t-u,i+4],["Z"]]},style:{r:5,fill:e,fillOpacity:1}}}}),va("area","smooth-line",{draw:function(r,e){var t=this.coordinate,i=ay(r,!0,!0,this,$2(t)),u=e.addShape({type:"path",attrs:i,name:"area"});return u},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return u===void 0&&(u=5.5),[["M",t-u,i-4],["L",t+u,i-4],["L",t+u,i+4],["L",t-u,i+4],["Z"]]},style:{r:5,stroke:e,fill:null}}}});function v1(r,e){return["C",r.x*1/2+e.x*1/2,r.y,r.x*1/2+e.x*1/2,e.y,e.x,e.y]}function g1(r,e){var t=[];t.push({x:e.x,y:e.y}),t.push(r);var i=["Q"];return(0,b.S6)(t,function(u){i.push(u.x,u.y)}),i}function pM(r,e,t){var i=g1(e,t),u=[["M",r.x,r.y]];return u.push(i),u}function uE(r,e){var t=g1(r[1],e),i=g1(r[3],e),u=[["M",r[0].x,r[0].y]];return u.push(i),u.push(["L",r[3].x,r[3].y]),u.push(["L",r[2].x,r[2].y]),u.push(t),u.push(["L",r[1].x,r[1].y]),u.push(["L",r[0].x,r[0].y]),u.push(["Z"]),u}va("edge","arc",{draw:function(r,e){var t=Us(r,!0,!1,"lineWidth"),i=r.points,u=i.length>2?"weight":"normal",c;if(r.isInCircle){var p={x:0,y:1};return u==="normal"?c=pM(i[0],i[1],p):(t.fill=t.stroke,c=uE(i,p)),c=this.parsePath(c),e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:c})})}else{if(u==="normal")return i=this.parsePoints(i),c=W0((i[1].x+i[0].x)/2,i[0].y,Math.abs(i[1].x-i[0].x)/2,Math.PI,Math.PI*2),e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:c})});var g=v1(i[1],i[3]),_=v1(i[2],i[0]);return c=[["M",i[0].x,i[0].y],["L",i[1].x,i[1].y],g,["L",i[3].x,i[3].y],["L",i[2].x,i[2].y],_,["Z"]],c=this.parsePath(c),t.fill=t.stroke,e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:c})})}},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}});function lE(r,e){var t=v1(r,e),i=[["M",r.x,r.y]];return i.push(t),i}va("edge","smooth",{draw:function(r,e){var t=Us(r,!0,!1,"lineWidth"),i=r.points,u=this.parsePath(lE(i[0],i[1]));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:u})})},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}});var sy=1/3;function dM(r,e){var t=[];t.push({x:r.x,y:r.y*(1-sy)+e.y*sy}),t.push({x:e.x,y:r.y*(1-sy)+e.y*sy}),t.push(e);var i=[["M",r.x,r.y]];return(0,b.S6)(t,function(u){i.push(["L",u.x,u.y])}),i}va("edge","vhv",{draw:function(r,e){var t=Us(r,!0,!1,"lineWidth"),i=r.points,u=this.parsePath(dM(i[0],i[1]));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:u})})},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}}),va("interval","funnel",{getPoints:function(r){return r.size=r.size*2,oy(r)},draw:function(r,e){var t=Us(r,!1,!0),i=this.parsePath(eE(r.points,r.nextPoints,!1)),u=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"interval"});return u},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}}),va("interval","hollow-rect",{draw:function(r,e){var t=Us(r,!0,!1),i=e,u=r==null?void 0:r.background;if(u){i=e.addGroup();var c=Kt(r),p=tE(r,this.parsePoints(r.points),this.coordinate);i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},c),{path:p}),zIndex:-1,name:Es})}var g=this.parsePath(h1(r.points)),_=i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:g}),name:"interval"});return u?i:_},getMarker:function(r){var e=r.color,t=r.isInPolar;return t?{symbol:"circle",style:{r:4.5,stroke:e,fill:null}}:{symbol:"square",style:{r:4,stroke:e,fill:null}}}});function vM(r){var e=r.x,t=r.y,i=r.y0;return(0,b.kJ)(t)?t.map(function(u,c){return{x:(0,b.kJ)(e)?e[c]:e,y:u}}):[{x:e,y:i},{x:e,y:t}]}va("interval","line",{getPoints:function(r){return vM(r)},draw:function(r,e){var t=Us(r,!0,!1,"lineWidth"),i=ic((0,P.pi)({},t),["fill"]),u=this.parsePath(h1(r.points,!1)),c=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},i),{path:u}),name:"interval"});return c},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return[["M",t,i-u],["L",t,i+u]]},style:{r:5,stroke:e}}}}),va("interval","pyramid",{getPoints:function(r){return r.size=r.size*2,oy(r)},draw:function(r,e){var t=Us(r,!1,!0),i=this.parsePath(eE(r.points,r.nextPoints,!0)),u=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"interval"});return u},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}});function gM(r){var e,t=r.x,i=r.y,u=r.y0,c=r.size,p,g;(0,b.kJ)(i)?(e=(0,P.CR)(i,2),p=e[0],g=e[1]):(p=u,g=i);var _=t+c/2,w=t-c/2;return[{x:t,y:p},{x:t,y:g},{x:w,y:p},{x:_,y:p},{x:w,y:g},{x:_,y:g}]}function mM(r){return[["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["M",r[2].x,r[2].y],["L",r[3].x,r[3].y],["M",r[4].x,r[4].y],["L",r[5].x,r[5].y]]}va("interval","tick",{getPoints:function(r){return gM(r)},draw:function(r,e){var t=Us(r,!0,!1),i=this.parsePath(mM(r.points)),u=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"interval"});return u},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return[["M",t-u/2,i-u],["L",t+u/2,i-u],["M",t,i-u],["L",t,i+u],["M",t-u/2,i+u],["L",t+u/2,i+u]]},style:{r:5,stroke:e}}}});var cE=function(r,e,t){var i=r.x,u=r.y,c=e.x,p=e.y,g;switch(t){case"hv":g=[{x:c,y:u}];break;case"vh":g=[{x:i,y:p}];break;case"hvh":var _=(c+i)/2;g=[{x:_,y:u},{x:_,y:p}];break;case"vhv":var w=(u+p)/2;g=[{x:i,y:w},{x:c,y:w}];break;default:break}return g};function fE(r,e){var t=[];return(0,b.S6)(r,function(i,u){var c=r[u+1];if(t.push(i),c){var p=cE(i,c,e);t=t.concat(p)}}),t}function hE(r){return r.map(function(e,t){return t===0?["M",e.x,e.y]:["L",e.x,e.y]})}function pE(r,e){var t=td(r.points,r.connectNulls,r.showSinglePoint),i=[];return(0,b.S6)(t,function(u){var c=fE(u,e);i=i.concat(hE(c))}),(0,P.pi)((0,P.pi)({},Us(r,!0,!1,"lineWidth")),{path:i})}(0,b.S6)(["hv","vh","hvh","vhv"],function(r){va("line",r,{draw:function(e,t){var i=pE(e,r),u=t.addShape({type:"path",attrs:i,name:"line"});return u},getMarker:function(e){return vp(e,r)}})}),(0,b.S6)(tM,function(r){va("point",r,{draw:function(e,t){return d1(this,e,t,r,!0)},getMarker:function(e){var t=e.color;return{symbol:yc[r],style:{r:4.5,stroke:t,fill:null}}}})}),va("point","image",{draw:function(r,e){var t,i,u=Us(r,!1,!1,"r").r,c=this.parsePoints(r.points),p=c[0];if(r.isStack)p=c[1];else if(c.length>1){var g=e.addGroup();try{for(var _=(0,P.XA)(c),w=_.next();!w.done;w=_.next()){var k=w.value;g.addShape("image",{attrs:{x:k.x-u/2,y:k.y-u,width:u,height:u,img:r.shape[1]}})}}catch(L){t={error:L}}finally{try{w&&!w.done&&(i=_.return)&&i.call(_)}finally{if(t)throw t.error}}return g}return e.addShape("image",{attrs:{x:p.x-u/2,y:p.y-u,width:u,height:u,img:r.shape[1]}})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4.5,fill:e}}}}),(0,b.S6)(aE,function(r){va("point",r,{draw:function(e,t){return d1(this,e,t,r,!1)},getMarker:function(e){var t=e.color;return{symbol:yc[r]||r,style:{r:4.5,fill:t}}}})});function h0(r){var e=(0,b.kJ)(r)?r:[r],t=e[0],i=e[e.length-1],u=e.length>1?e[1]:t,c=e.length>3?e[3]:i,p=e.length>2?e[2]:u;return{min:t,max:i,min1:u,max1:c,median:p}}function m1(r,e,t){var i=t/2,u;if((0,b.kJ)(e)){var c=h0(e),p=c.min,g=c.max,_=c.median,w=c.min1,k=c.max1,L=r-i,R=r+i;u=[[L,g],[R,g],[r,g],[r,k],[L,w],[L,k],[R,k],[R,w],[r,w],[r,p],[L,p],[R,p],[L,_],[R,_]]}else{e=(0,b.UM)(e)?.5:e;var U=h0(r),p=U.min,g=U.max,_=U.median,w=U.min1,k=U.max1,G=e-i,Q=e+i;u=[[p,G],[p,Q],[p,e],[w,e],[w,G],[w,Q],[k,Q],[k,G],[k,e],[g,e],[g,G],[g,Q],[_,G],[_,Q]]}return u.map(function(pt){return{x:pt[0],y:pt[1]}})}function yM(r){return[["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["M",r[2].x,r[2].y],["L",r[3].x,r[3].y],["M",r[4].x,r[4].y],["L",r[5].x,r[5].y],["L",r[6].x,r[6].y],["L",r[7].x,r[7].y],["L",r[4].x,r[4].y],["Z"],["M",r[8].x,r[8].y],["L",r[9].x,r[9].y],["M",r[10].x,r[10].y],["L",r[11].x,r[11].y],["M",r[12].x,r[12].y],["L",r[13].x,r[13].y]]}va("schema","box",{getPoints:function(r){var e=r.x,t=r.y,i=r.size;return m1(e,t,i)},draw:function(r,e){var t=Us(r,!0,!1),i=this.parsePath(yM(r.points)),u=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i,name:"schema"})});return u},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){var c=[i-6,i-3,i,i+3,i+6],p=m1(t,c,u);return[["M",p[0].x+1,p[0].y],["L",p[1].x-1,p[1].y],["M",p[2].x,p[2].y],["L",p[3].x,p[3].y],["M",p[4].x,p[4].y],["L",p[5].x,p[5].y],["L",p[6].x,p[6].y],["L",p[7].x,p[7].y],["L",p[4].x,p[4].y],["Z"],["M",p[8].x,p[8].y],["L",p[9].x,p[9].y],["M",p[10].x+1,p[10].y],["L",p[11].x-1,p[11].y],["M",p[12].x,p[12].y],["L",p[13].x,p[13].y]]},style:{r:6,lineWidth:1,stroke:e}}}});function dE(r){var e=(0,b.kJ)(r)?r:[r],t=e.sort(function(i,u){return u-i});return n0(t,4,t[t.length-1])}function y1(r,e,t){var i=dE(e);return[{x:r,y:i[0]},{x:r,y:i[1]},{x:r-t/2,y:i[2]},{x:r-t/2,y:i[1]},{x:r+t/2,y:i[1]},{x:r+t/2,y:i[2]},{x:r,y:i[2]},{x:r,y:i[3]}]}function _M(r){return[["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["M",r[2].x,r[2].y],["L",r[3].x,r[3].y],["L",r[4].x,r[4].y],["L",r[5].x,r[5].y],["Z"],["M",r[6].x,r[6].y],["L",r[7].x,r[7].y]]}va("schema","candle",{getPoints:function(r){var e=r.x,t=r.y,i=r.size;return y1(e,t,i)},draw:function(r,e){var t=Us(r,!0,!0),i=this.parsePath(_M(r.points)),u=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i,name:"schema"})});return u},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){var c=[i+7.5,i+3,i-3,i-7.5],p=y1(t,c,u);return[["M",p[0].x,p[0].y],["L",p[1].x,p[1].y],["M",p[2].x,p[2].y],["L",p[3].x,p[3].y],["L",p[4].x,p[4].y],["L",p[5].x,p[5].y],["Z"],["M",p[6].x,p[6].y],["L",p[7].x,p[7].y]]},style:{lineWidth:1,stroke:e,fill:e,r:6}}}});function xM(r,e){var t=Math.abs(r[0].x-r[2].x),i=Math.abs(r[0].y-r[2].y),u=Math.min(t,i);e&&(u=(0,b.uZ)(e,0,Math.min(t,i))),u=u/2;var c=(r[0].x+r[2].x)/2,p=(r[0].y+r[2].y)/2;return{x:c-u,y:p-u,width:u*2,height:u*2}}va("polygon","square",{draw:function(r,e){if(!(0,b.xb)(r.points)){var t=Us(r,!0,!0),i=this.parsePoints(r.points);return e.addShape("rect",{attrs:(0,P.pi)((0,P.pi)({},t),xM(i,r.size)),name:"polygon"})}},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}}),va("violin","smooth",{draw:function(r,e){var t=Us(r,!0,!0),i=this.parsePath(o0(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{stroke:null,r:4,fill:e}}}}),va("violin","hollow",{draw:function(r,e){var t=Us(r,!0,!1),i=this.parsePath(wv(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4,fill:null,stroke:e}}}}),va("violin","hollow-smooth",{draw:function(r,e){var t=Us(r,!0,!1),i=this.parsePath(o0(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4,fill:null,stroke:e}}}});var bM=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getLabelValueDir=function(t){var i="y",u=t.points;return u[0][i]<=u[2][i]?1:-1},e.prototype.getLabelOffsetPoint=function(t,i,u,c){var p,g=r.prototype.getLabelOffsetPoint.call(this,t,i,u),_=this.getCoordinate(),w=_.isTransposed,k=w?"x":"y",L=this.getLabelValueDir(t.mappingData);return g=(0,P.pi)((0,P.pi)({},g),(p={},p[k]=g[k]*L,p)),_.isReflect("x")&&(g=(0,P.pi)((0,P.pi)({},g),{x:g.x*-1})),_.isReflect("y")&&(g=(0,P.pi)((0,P.pi)({},g),{y:g.y*-1})),g},e.prototype.getThemedLabelCfg=function(t){var i=this.geometry,u=this.getDefaultLabelCfg(),c=i.theme;return(0,b.b$)({},u,c.labels,t.position==="middle"?{offset:0}:{},t)},e.prototype.setLabelPosition=function(t,i,u,c){var p=this.getCoordinate(),g=p.isTransposed,_=i.points,w=p.convert(_[0]),k=p.convert(_[2]),L=this.getLabelValueDir(i),R,U,G,Q,pt=(0,b.kJ)(i.shape)?i.shape[0]:i.shape;if(pt==="funnel"||pt==="pyramid"){var vt=(0,b.U2)(i,"nextPoints"),Vt=(0,b.U2)(i,"points");if(vt){var le=p.convert(Vt[0]),he=p.convert(Vt[1]),Ne=p.convert(vt[0]),Er=p.convert(vt[1]);g?(R=Math.min(Ne.y,le.y),G=Math.max(Ne.y,le.y),U=(he.x+Er.x)/2,Q=(le.x+Ne.x)/2):(R=Math.min((he.y+Er.y)/2,(le.y+Ne.y)/2),G=Math.max((he.y+Er.y)/2,(le.y+Ne.y)/2),U=Er.x,Q=le.x)}else R=Math.min(k.y,w.y),G=Math.max(k.y,w.y),U=k.x,Q=w.x}else R=Math.min(k.y,w.y),G=Math.max(k.y,w.y),U=k.x,Q=w.x;switch(c){case"right":t.x=U,t.y=(R+G)/2,t.textAlign=(0,b.U2)(t,"textAlign",L>0?"left":"right");break;case"left":t.x=Q,t.y=(R+G)/2,t.textAlign=(0,b.U2)(t,"textAlign",L>0?"left":"right");break;case"bottom":g&&(t.x=(U+Q)/2),t.y=G,t.textAlign=(0,b.U2)(t,"textAlign","center"),t.textBaseline=(0,b.U2)(t,"textBaseline",L>0?"bottom":"top");break;case"middle":g&&(t.x=(U+Q)/2),t.y=(R+G)/2,t.textAlign=(0,b.U2)(t,"textAlign","center"),t.textBaseline=(0,b.U2)(t,"textBaseline","middle");break;case"top":g&&(t.x=(U+Q)/2),t.y=R,t.textAlign=(0,b.U2)(t,"textAlign","center"),t.textBaseline=(0,b.U2)(t,"textBaseline",L>0?"bottom":"top");break;default:break}},e}(zd),vE=bM,em=Math.PI/2,gE=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getLabelOffset=function(t){var i=this.getCoordinate(),u=0;if((0,b.hj)(t))u=t;else if((0,b.HD)(t)&&t.indexOf("%")!==-1){var c=i.getRadius();i.innerRadius>0&&(c=c*(1-i.innerRadius)),u=parseFloat(t)*.01*c}return u},e.prototype.getLabelItems=function(t){var i=r.prototype.getLabelItems.call(this,t),u=this.geometry.getYScale();return(0,b.UI)(i,function(c){if(c&&u){var p=u.scale((0,b.U2)(c.data,u.field));return(0,P.pi)((0,P.pi)({},c),{percent:p})}return c})},e.prototype.getLabelAlign=function(t){var i=this.getCoordinate(),u;if(t.labelEmit)u=t.angle<=Math.PI/2&&t.angle>=-Math.PI/2?"left":"right";else if(!i.isTransposed)u="center";else{var c=i.getCenter(),p=t.offset;Math.abs(t.x-c.x)<1?u="center":t.angle>Math.PI||t.angle<=0?u=p>0?"left":"right":u=p>0?"right":"left"}return u},e.prototype.getLabelPoint=function(t,i,u){var c=1,p,g=t.content[u];this.isToMiddle(i)?p=this.getMiddlePoint(i.points):(t.content.length===1&&u===0?u=1:u===0&&(c=-1),p=this.getArcPoint(i,u));var _=t.offset*c,w=this.getPointAngle(p),k=t.labelEmit,L=this.getCirclePoint(w,_,p,k);return L.r===0?L.content="":(L.content=g,L.angle=w,L.color=i.color),L.rotate=t.autoRotate?this.getLabelRotate(w,_,k):t.rotate,L.start={x:p.x,y:p.y},L},e.prototype.getArcPoint=function(t,i){return i===void 0&&(i=0),!(0,b.kJ)(t.x)&&!(0,b.kJ)(t.y)?{x:t.x,y:t.y}:{x:(0,b.kJ)(t.x)?t.x[i]:t.x,y:(0,b.kJ)(t.y)?t.y[i]:t.y}},e.prototype.getPointAngle=function(t){return uf(this.getCoordinate(),t)},e.prototype.getCirclePoint=function(t,i,u,c){var p=this.getCoordinate(),g=p.getCenter(),_=$p(p,u);if(_===0)return(0,P.pi)((0,P.pi)({},g),{r:_});var w=t;if(p.isTransposed&&_>i&&!c){var k=Math.asin(i/(2*_));w=t+k*2}else _=_+i;return{x:g.x+_*Math.cos(w),y:g.y+_*Math.sin(w),r:_}},e.prototype.getLabelRotate=function(t,i,u){var c=t+em;return u&&(c-=em),c&&(c>em?c=c-Math.PI:c<-em&&(c=c+Math.PI)),c},e.prototype.getMiddlePoint=function(t){var i=this.getCoordinate(),u=t.length,c={x:0,y:0};return(0,b.S6)(t,function(p){c.x+=p.x,c.y+=p.y}),c.x/=u,c.y/=u,c=i.convert(c),c},e.prototype.isToMiddle=function(t){return t.x.length>2},e}(zd),uy=gE,mE=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.defaultLayout="distribute",t}return e.prototype.getDefaultLabelCfg=function(t,i){var u=r.prototype.getDefaultLabelCfg.call(this,t,i);return(0,b.b$)({},u,(0,b.U2)(this.geometry.theme,"pieLabels",{}))},e.prototype.getLabelOffset=function(t){return r.prototype.getLabelOffset.call(this,t)||0},e.prototype.getLabelRotate=function(t,i,u){var c;return i<0&&(c=t,c>Math.PI/2&&(c=c-Math.PI),c<-Math.PI/2&&(c=c+Math.PI)),c},e.prototype.getLabelAlign=function(t){var i=this.getCoordinate(),u=i.getCenter(),c;return t.angle<=Math.PI/2&&t.x>=u.x?c="left":c="right",t.offset<=0&&(c==="right"?c="left":c="right"),c},e.prototype.getArcPoint=function(t){return t},e.prototype.getPointAngle=function(t){var i=this.getCoordinate(),u={x:(0,b.kJ)(t.x)?t.x[0]:t.x,y:t.y[0]},c={x:(0,b.kJ)(t.x)?t.x[1]:t.x,y:t.y[1]},p,g=uf(i,u);if(t.points&&t.points[0].y===t.points[1].y)p=g;else{var _=uf(i,c);g>=_&&(_=_+Math.PI*2),p=g+(_-g)/2}return p},e.prototype.getCirclePoint=function(t,i){var u=this.getCoordinate(),c=u.getCenter(),p=u.getRadius()+i;return(0,P.pi)((0,P.pi)({},co(c.x,c.y,p,t)),{angle:t,r:p})},e}(uy),EM=mE,yE=4;function SM(r,e,t,i,u,c){var p,g,_=!0,w=i.start,k=i.end,L=Math.min(w.y,k.y),R=Math.abs(w.y-k.y),U,G=0,Q=Number.MIN_VALUE,pt=e.map(function(Fr){return Fr.y>G&&(G=Fr.y),Fr.y<Q&&(Q=Fr.y),{size:t,targets:[Fr.y-L]}});for(Q-=L,G-L>R&&(R=G-L);_;)for(pt.forEach(function(Fr){var zr=(Math.min.apply(Q,Fr.targets)+Math.max.apply(Q,Fr.targets))/2;Fr.pos=Math.min(Math.max(Q,zr-Fr.size/2),R-Fr.size)}),_=!1,U=pt.length;U--;)if(U>0){var vt=pt[U-1],Vt=pt[U];vt.pos+vt.size>Vt.pos&&(vt.size+=Vt.size,vt.targets=vt.targets.concat(Vt.targets),vt.pos+vt.size>R&&(vt.pos=R-vt.size),pt.splice(U,1),_=!0)}U=0,pt.forEach(function(Fr){var zr=L+t/2;Fr.targets.forEach(function(){e[U].y=Fr.pos+zr,zr+=t,U++})});var le={};try{for(var he=(0,P.XA)(r),Ne=he.next();!Ne.done;Ne=he.next()){var Er=Ne.value;le[Er.get("id")]=Er}}catch(Fr){p={error:Fr}}finally{try{Ne&&!Ne.done&&(g=he.return)&&g.call(he)}finally{if(p)throw p.error}}e.forEach(function(Fr){var zr=Fr.r*Fr.r,pn=Math.pow(Math.abs(Fr.y-u.y),2);if(zr<pn)Fr.x=u.x;else{var nn=Math.sqrt(zr-pn);c?Fr.x=u.x+nn:Fr.x=u.x-nn}var Pn=le[Fr.id];Pn.attr("x",Fr.x),Pn.attr("y",Fr.y);var Si=(0,b.sE)(Pn.getChildren(),function(ha){return ha.get("type")==="text"});Si&&(Si.attr("y",Fr.y),Si.attr("x",Fr.x))})}function _E(r,e,t,i){if(!(!r.length||!e.length)){var u=r[0]?r[0].offset:0,c=e[0].get("coordinate"),p=c.getRadius(),g=c.getCenter();if(u>0){var _=14,w=p+u,k=w*2+_*2,L={start:c.start,end:c.end},R=[[],[]];r.forEach(function(U){!U||(U.textAlign==="right"?R[0].push(U):R[1].push(U))}),R.forEach(function(U,G){var Q=k/_;U.length>Q&&(U.sort(function(pt,vt){return vt["..percent"]-pt["..percent"]}),U.splice(Q,U.length-Q)),U.sort(function(pt,vt){return pt.y-vt.y}),SM(e,U,_,L,g,G)})}(0,b.S6)(r,function(U){if(U&&U.labelLine){var G=U.offset,Q=U.angle,pt=co(g.x,g.y,p,Q),vt=co(g.x,g.y,p+G/2,Q),Vt=U.x+(0,b.U2)(U,"offsetX",0),le=U.y+(0,b.U2)(U,"offsetY",0),he={x:Vt-Math.cos(Q)*yE,y:le-Math.sin(Q)*yE};(0,b.Kn)(U.labelLine)||(U.labelLine={}),U.labelLine.path=["M ".concat(pt.x),"".concat(pt.y," Q").concat(vt.x),"".concat(vt.y," ").concat(he.x),he.y].join(",")}})}}function xE(r,e,t){var i=r.filter(function(G){return!G.invisible});i.sort(function(G,Q){return G.y-Q.y});var u=!0,c=t.minY,p=t.maxY,g=Math.abs(c-p),_,w=0,k=Number.MIN_VALUE,L=i.map(function(G){return G.y>w&&(w=G.y),G.y<k&&(k=G.y),{content:G.content,size:e,targets:[G.y-c],pos:null}});for(k-=c,w-c>g&&(g=w-c);u;)for(L.forEach(function(G){var Q=(Math.min.apply(k,G.targets)+Math.max.apply(k,G.targets))/2;G.pos=Math.min(Math.max(k,Q-G.size/2),g-G.size),G.pos=Math.max(0,G.pos)}),u=!1,_=L.length;_--;)if(_>0){var R=L[_-1],U=L[_];R.pos+R.size>U.pos&&(R.size+=U.size,R.targets=R.targets.concat(U.targets),R.pos+R.size>g&&(R.pos=g-R.size),L.splice(_,1),u=!0)}_=0,L.forEach(function(G){var Q=c+e/2;G.targets.forEach(function(){i[_].y=G.pos+Q,Q+=e,_++})})}var _1=4;function wM(r,e){var t=e.getCenter(),i=e.getRadius();if(r&&r.labelLine){var u=r.angle,c=r.offset,p=co(t.x,t.y,i,u),g=r.x+(0,b.U2)(r,"offsetX",0)*(Math.cos(u)>0?1:-1),_=r.y+(0,b.U2)(r,"offsetY",0)*(Math.sin(u)>0?1:-1),w={x:g-Math.cos(u)*_1,y:_-Math.sin(u)*_1},k=r.labelLine.smooth,L=[],R=w.x-t.x,U=w.y-t.y,G=Math.atan(U/R);if(R<0&&(G+=Math.PI),k===!1){(0,b.Kn)(r.labelLine)||(r.labelLine={});var Q=0;(u<0&&u>-Math.PI/2||u>Math.PI*1.5)&&w.y>p.y&&(Q=1),u>=0&&u<Math.PI/2&&w.y>p.y&&(Q=1),u>=Math.PI/2&&u<Math.PI&&p.y>w.y&&(Q=1),(u<-Math.PI/2||u>=Math.PI&&u<Math.PI*1.5)&&p.y>w.y&&(Q=1);var pt=c/2>4?4:Math.max(c/2-1,0),vt=co(t.x,t.y,i+pt,u),Vt=co(t.x,t.y,i+c/2,G),le=0;L.push("M ".concat(p.x," ").concat(p.y)),L.push("L ".concat(vt.x," ").concat(vt.y)),L.push("A ".concat(t.x," ").concat(t.y," 0 ").concat(le," ").concat(Q," ").concat(Vt.x," ").concat(Vt.y)),L.push("L ".concat(w.x," ").concat(w.y))}else{var vt=co(t.x,t.y,i+(c/2>4?4:Math.max(c/2-1,0)),u),he=p.x<t.x?1:-1;L.push("M ".concat(w.x," ").concat(w.y));var Ne=(p.y-t.y)/(p.x-t.x),Er=(w.y-t.y)/(w.x-t.x);Math.abs(Ne-Er)>Math.pow(Math.E,-16)&&L.push.apply(L,["C",w.x+he*4,w.y,2*vt.x-p.x,2*vt.y-p.y,p.x,p.y]),L.push("L ".concat(p.x," ").concat(p.y))}r.labelLine.path=L.join(" ")}}function CM(r,e,t,i){var u,c,p=(0,b.hX)(r,function(zr){return!(0,b.UM)(zr)}),g=e[0]&&e[0].get("coordinate");if(!!g){var _=g.getCenter(),w=g.getRadius(),k={};try{for(var L=(0,P.XA)(e),R=L.next();!R.done;R=L.next()){var U=R.value;k[U.get("id")]=U}}catch(zr){u={error:zr}}finally{try{R&&!R.done&&(c=L.return)&&c.call(L)}finally{if(u)throw u.error}}var G=(0,b.U2)(p[0],"labelHeight",14),Q=(0,b.U2)(p[0],"offset",0);if(!(Q<=0)){var pt="left",vt="right",Vt=(0,b.vM)(p,function(zr){return zr.x<_.x?pt:vt}),le=g.start,he=g.end,Ne=Math.min((w+Q+G)*2,g.getHeight()),Er=Ne/2,Fr={minX:le.x,maxX:he.x,minY:_.y-Er,maxY:_.y+Er};(0,b.S6)(Vt,function(zr,pn){var nn=Math.floor(Ne/G);zr.length>nn&&(zr.sort(function(Pn,Si){return Si.percent-Pn.percent}),(0,b.S6)(zr,function(Pn,Si){Si+1>nn&&(k[Pn.id].set("visible",!1),Pn.invisible=!0)})),xE(zr,G,Fr)}),(0,b.S6)(Vt,function(zr,pn){(0,b.S6)(zr,function(nn){var Pn=pn===vt,Si=k[nn.id],ha=Si.getChildByIndex(0);if(ha){var wa=w+Q,_o=nn.y-_.y,Vn=Math.pow(wa,2),Bi=Math.pow(_o,2),fa=Vn-Bi>0?Vn-Bi:0,Ui=Math.sqrt(fa),Ji=Math.abs(Math.cos(nn.angle)*wa);Pn?nn.x=_.x+Math.max(Ui,Ji):nn.x=_.x-Math.max(Ui,Ji)}ha&&(ha.attr("y",nn.y),ha.attr("x",nn.x)),wM(nn,g)})})}}}var p0=4,bE=4,ly=4;function bO(r,e,t){var i=e.getCenter(),u=e.getRadius(),c={x:r.x-(t?ly:-ly),y:r.y},p=co(i.x,i.y,u+p0,r.angle),g={x:c.x,y:c.y},_={x:p.x,y:p.y},w=co(i.x,i.y,u,r.angle),k="";if(c.y!==p.y){var L=t?4:-4;g.y=c.y,r.angle<0&&r.angle>=-Math.PI/2&&(g.x=Math.max(p.x,c.x-L),c.y<p.y?_.y=g.y:(_.y=p.y,_.x=Math.max(_.x,g.x-L))),r.angle>0&&r.angle<Math.PI/2&&(g.x=Math.max(p.x,c.x-L),c.y>p.y?_.y=g.y:(_.y=p.y,_.x=Math.max(_.x,g.x-L))),r.angle>Math.PI/2&&(g.x=Math.min(p.x,c.x-L),c.y>p.y?_.y=g.y:(_.y=p.y,_.x=Math.min(_.x,g.x-L))),r.angle<-Math.PI/2&&(g.x=Math.min(p.x,c.x-L),c.y<p.y?_.y=g.y:(_.y=p.y,_.x=Math.min(_.x,g.x-L)))}k=["M ".concat(c.x,",").concat(c.y),"L ".concat(g.x,",").concat(g.y),"L ".concat(_.x,",").concat(_.y),"L ".concat(p.x,",").concat(p.y),"L ".concat(w.x,",").concat(w.y)].join(" "),r.labelLine=(0,b.b$)({},r.labelLine,{path:k})}function sh(r,e,t,i){var u,c,p=e[0]&&e[0].get("coordinate");if(!!p){var g=p.getCenter(),_=p.getRadius(),w={};try{for(var k=(0,P.XA)(e),L=k.next();!L.done;L=k.next()){var R=L.value;w[R.get("id")]=R}}catch(zr){u={error:zr}}finally{try{L&&!L.done&&(c=k.return)&&c.call(k)}finally{if(u)throw u.error}}var U=(0,b.U2)(r[0],"labelHeight",14),G=Math.max((0,b.U2)(r[0],"offset",0),p0);(0,b.S6)(r,function(zr){if(!!zr){var pn=(0,b.U2)(w,[zr.id]);if(!!pn){var nn=zr.x>g.x||zr.x===g.x&&zr.y>g.y,Pn=(0,b.UM)(zr.offsetX)?bE:zr.offsetX,Si=co(g.x,g.y,_+p0,zr.angle),ha=G+Pn;zr.x=g.x+(nn?1:-1)*(_+ha),zr.y=Si.y}}});var Q=p.start,pt=p.end,vt="left",Vt="right",le=(0,b.vM)(r,function(zr){return zr.x<g.x?vt:Vt}),he=(_+G)*2+U;(0,b.S6)(le,function(zr){var pn=zr.length*U;pn>he&&(he=Math.min(pn,Math.abs(Q.y-pt.y)))});var Ne={minX:Q.x,maxX:pt.x,minY:g.y-he/2,maxY:g.y+he/2};(0,b.S6)(le,function(zr,pn){var nn=he/U;zr.length>nn&&(zr.sort(function(Pn,Si){return Si.percent-Pn.percent}),(0,b.S6)(zr,function(Pn,Si){Si>nn&&(w[Pn.id].set("visible",!1),Pn.invisible=!0)})),xE(zr,U,Ne)});var Er=Ne.minY,Fr=Ne.maxY;(0,b.S6)(le,function(zr,pn){var nn=pn===Vt;(0,b.S6)(zr,function(Pn){var Si=(0,b.U2)(w,Pn&&[Pn.id]);if(!!Si){if(Pn.y<Er||Pn.y>Fr){Si.set("visible",!1);return}var ha=Si.getChildByIndex(0),wa=ha.getCanvasBBox(),_o={x:nn?wa.x:wa.maxX,y:wa.y+wa.height/2};cf(ha,Pn.x-_o.x,Pn.y-_o.y),Pn.labelLine&&bO(Pn,p,nn)}})})}}function AM(r,e,t,i){(0,b.S6)(e,function(u){var c=i.minX,p=i.minY,g=i.maxX,_=i.maxY,w=u.getCanvasBBox(),k=w.minX,L=w.minY,R=w.maxX,U=w.maxY,G=w.x,Q=w.y,pt=w.width,vt=w.height,Vt=G,le=Q;(k<c||R<c)&&(Vt=c),(L<p||U<p)&&(le=p),k>g?Vt=g-pt:R>g&&(Vt=Vt-(R-g)),L>_?le=_-vt:U>_&&(le=le-(U-_)),(Vt!==G||le!==Q)&&cf(u,Vt-G,le-Q)})}function TM(r,e,t,i){(0,b.S6)(e,function(u,c){var p=u.getCanvasBBox(),g=t[c].getBBox();(p.minX<g.minX||p.minY<g.minY||p.maxX>g.maxX||p.maxY>g.maxY)&&u.remove(!0)})}var cy=100,EE=function(){function r(e){e===void 0&&(e={}),this.bitmap={};var t=e.xGap,i=t===void 0?1:t,u=e.yGap,c=u===void 0?8:u;this.xGap=i,this.yGap=c}return r.prototype.hasGap=function(e){for(var t=!0,i=this.bitmap,u=Math.round(e.minX),c=Math.round(e.maxX),p=Math.round(e.minY),g=Math.round(e.maxY),_=u;_<=c;_+=1){if(!i[_]){i[_]={};continue}if(_===u||_===c){for(var w=p;w<=g;w++)if(i[_][w]){t=!1;break}}else if(i[_][p]||i[_][g]){t=!1;break}}return t},r.prototype.fillGap=function(e){for(var t=this.bitmap,i=Math.round(e.minX),u=Math.round(e.maxX),c=Math.round(e.minY),p=Math.round(e.maxY),g=i;g<=u;g+=1)t[g]||(t[g]={});for(var g=i;g<=u;g+=this.xGap){for(var _=c;_<=p;_+=this.yGap)t[g][_]=!0;t[g][p]=!0}if(this.yGap!==1)for(var g=c;g<=p;g+=1)t[i][g]=!0,t[u][g]=!0;if(this.xGap!==1)for(var g=i;g<=u;g+=1)t[g][c]=!0,t[g][p]=!0},r.prototype.destroy=function(){this.bitmap={}},r}();function EO(r,e,t){t===void 0&&(t=cy);var i=-1,u=r.attr(),c=u.x,p=u.y,g=r.getCanvasBBox(),_=Math.sqrt(g.width*g.width+g.height*g.height),w,k=-i,L=0,R=0,U=function(vt){var Vt=vt*.1;return[Vt*Math.cos(Vt),Vt*Math.sin(Vt)]};if(e.hasGap(g))return e.fillGap(g),!0;for(var G=!1,Q=0,pt={};Math.min(Math.abs(L),Math.abs(R))<_&&Q<t;)if(w=U(k+=i),L=~~w[0],R=~~w[1],!(!L&&!R||pt["".concat(L,"-").concat(R)])&&(r.attr({x:c+L,y:p+R}),L+R<0&&r.attr("textAlign","right"),Q++,e.hasGap(r.getCanvasBBox()))){e.fillGap(r.getCanvasBBox()),G=!0,pt["".concat(L,"-").concat(R)]=!0;break}return G}function MM(r,e,t,i){var u=r.getCanvasBBox(),c=u.width,p=u.height,g={x:e,y:t,textAlign:"center"};switch(i){case 0:g.y-=p+1,g.x+=1,g.textAlign="left";break;case 1:g.y-=p+1,g.x-=1,g.textAlign="right";break;case 2:g.y+=p+1,g.x-=1,g.textAlign="right";break;case 3:g.y+=p+1,g.x+=1,g.textAlign="left";break;case 5:g.y-=p*2+2;break;case 6:g.y+=p*2+2;break;case 7:g.x+=c+1,g.textAlign="left";break;case 8:g.x-=c+1,g.textAlign="right";break;default:break}return r.attr(g),r.getCanvasBBox()}function SO(r,e,t,i){var u=new EE;(0,b.S6)(e,function(c){var p=c.find(function(g){return g.get("type")==="text"});EO(p,u)||c.remove(!0)}),u.destroy()}function IM(r,e,t,i){var u=new EE;(0,b.S6)(e,function(c){for(var p=c.find(function(U){return U.get("type")==="text"}),g=p.attr(),_=g.x,w=g.y,k=!1,L=0;L<=8;L++){var R=MM(p,_,w,L);if(u.hasGap(R)){u.fillGap(R),k=!0;break}}k||c.remove(!0)}),u.destroy()}function wO(r,e){return(r[0]||0)*(e[0]||0)+(r[1]||0)*(e[1]||0)+(r[2]||0)*(e[2]||0)}function SE(r){if(r.length>4)return[];var e=function(u,c){return[c.x-u.x,c.y-u.y]},t=e(r[0],r[1]),i=e(r[1],r[2]);return[t,i]}function fy(r,e,t){e===void 0&&(e=0),t===void 0&&(t={x:0,y:0});var i=r.x,u=r.y;return{x:(i-t.x)*Math.cos(-e)+(u-t.y)*Math.sin(-e)+t.x,y:(t.x-i)*Math.sin(-e)+(u-t.y)*Math.cos(-e)+t.y}}function kM(r){var e=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height},{x:r.x,y:r.y+r.height}],t=r.rotation;return t?[fy(e[0],t,e[0]),fy(e[1],t,e[0]),fy(e[2],t,e[0]),fy(e[3],t,e[0])]:e}function LM(r,e){if(r.length>4)return{min:0,max:0};var t=[];return r.forEach(function(i){t.push(wO([i.x,i.y],e))}),{min:Math.min.apply(Math,(0,P.ev)([],(0,P.CR)(t),!1)),max:Math.max.apply(Math,(0,P.ev)([],(0,P.CR)(t),!1))}}function CO(r,e){return r.max>e.min&&r.min<e.max}function PM(r){return typeof r=="number"&&!Number.isNaN(r)&&r!==1/0&&r!==-1/0}function x1(r){return["x","y","width","height"].every(function(e){return PM(r[e])})}function AO(r,e,t){return t===void 0&&(t=0),!(e.x>r.x+r.width+t||e.x+e.width<r.x-t||e.y>r.y+r.height+t||e.y+e.height<r.y-t)}function OM(r,e,t){if(t===void 0&&(t=0),!x1(r)||!x1(e))return!1;if(!r.rotation&&!e.rotation)return AO(r,e,t);for(var i=kM(r),u=kM(e),c=SE(i).concat(SE(u)),p=0;p<c.length;p++){var g=c[p],_=LM(i,g),w=LM(u,g);if(!CO(_,w))return!1}return!0}var TO=function(){function r(e){var t=this;this.queue=[],this.worker=new Worker(e),this.worker.onmessage=function(i){var u;(u=t.queue.shift())===null||u===void 0||u.resolve(i)},this.worker.onmessageerror=function(i){var u;console.warn("[AntV G2] Web worker is not available"),(u=t.queue.shift())===null||u===void 0||u.reject(i)}}return r.prototype.post=function(e,t){var i=this;return new Promise(function(u,c){i.queue.push({resolve:u,reject:c});try{i.worker.postMessage(e)}catch(p){console.warn("[AntV G2] Web worker is not available"),(0,b.mf)(t)&&t()}})},r.prototype.destroy=function(){this.worker.terminate()},r}();function FM(r){if(typeof window!="undefined"){var e;try{e=new Blob([r.toString()],{type:"application/javascript"})}catch(t){e=new window.BlobBuilder,e.append(r.toString()),e=e.getBlob()}return new TO(URL.createObjectURL(e))}}var MO=function(r){function e(){function w(le,he){return(le[0]||0)*(he[0]||0)+(le[1]||0)*(he[1]||0)+(le[2]||0)*(he[2]||0)}function k(le){if(le.length>4)return[];var he=function(Fr,zr){return[zr.x-Fr.x,zr.y-Fr.y]},Ne=he(le[0],le[1]),Er=he(le[1],le[2]);return[Ne,Er]}function L(le,he,Ne){he===void 0&&(he=0),Ne===void 0&&(Ne={x:0,y:0});var Er=le.x,Fr=le.y;return{x:(Er-Ne.x)*Math.cos(-he)+(Fr-Ne.y)*Math.sin(-he)+Ne.x,y:(Ne.x-Er)*Math.sin(-he)+(Fr-Ne.y)*Math.cos(-he)+Ne.y}}function R(le){var he=[{x:le.x,y:le.y},{x:le.x+le.width,y:le.y},{x:le.x+le.width,y:le.y+le.height},{x:le.x,y:le.y+le.height}],Ne=le.rotation;return Ne?[L(he[0],Ne,he[0]),L(he[1],Ne,he[0]),L(he[2],Ne,he[0]),L(he[3],Ne,he[0])]:he}function U(le,he){if(le.length>4)return{min:0,max:0};var Ne=[];return le.forEach(function(Er){Ne.push(w([Er.x,Er.y],he))}),{min:Math.min.apply(null,Ne),max:Math.max.apply(null,Ne)}}function G(le,he){return le.max>he.min&&le.min<he.max}function Q(le){return typeof le=="number"&&!Number.isNaN(le)&&le!==1/0&&le!==-1/0}function pt(le){return["x","y","width","height"].every(function(he){return Q(le[he])})}function vt(le,he,Ne){return Ne===void 0&&(Ne=0),!(he.x>le.x+le.width+Ne||he.x+he.width<le.x-Ne||he.y>le.y+le.height+Ne||he.y+he.height<le.y-Ne)}function Vt(le,he,Ne){if(Ne===void 0&&(Ne=0),!pt(le)||!pt(he))return!1;if(!le.rotation&&!he.rotation)return vt(le,he,Ne);for(var Er=R(le),Fr=R(he),zr=k(Er).concat(k(Fr)),pn=0;pn<zr.length;pn++){var nn=zr[pn],Pn=U(Er,nn),Si=U(Fr,nn);if(!G(Pn,Si))return!1}return!0}return{intersect:Vt}}var t=e().intersect;function i(w){for(var k=w.slice(),L=0;L<k.length;L++){var R=k[L];if(R.visible)for(var U=L+1;U<k.length;U++){var G=k[U];R!==G&&G.visible&&t(R,G)&&(G.visible=!1)}}return k}var u={"hide-overlap":i};try{var c=JSON.parse(r.data);if(!c||!c.type||!u[c.type])return;var p=c.type,g=c.items,_=u[p](g);self.postMessage(_)}catch(w){throw w}},RM=`
   self.onmessage = `.concat(MO.toString(),`
`),b1=function(r){for(var e=r.slice(),t=0;t<e.length;t++){var i=e[t];if(i.visible)for(var u=t+1;u<e.length;u++){var c=e[u];i!==c&&c.visible&&OM(i,c)&&(c.visible=!1)}}return e},E1=new Map,rm=FM(RM);function IO(r,e,t,i){return(0,P.mG)(this,void 0,void 0,function(){var u,c,p,g,_,w;return(0,P.Jh)(this,function(k){switch(k.label){case 0:return u=e.map(function(L,R){return(0,P.pi)((0,P.pi)({},Qp(L,r[R],(0,b.U2)(r[R],"background.padding"))),{visible:!0})}),c=JSON.stringify(u),p=function(L){return E1.set(c,L),(0,b.S6)(L,function(R,U){var G=R.visible,Q=e[U];G?Q==null||Q.show():Q==null||Q.hide()}),L},E1.get(c)?(p(E1.get(c)),[3,7]):[3,1];case 1:if(!rm)return[3,6];k.label=2;case 2:return k.trys.push([2,4,,5]),g=JSON.stringify({type:"hide-overlap",items:u}),[4,rm.post(g,function(){return p(b1(u))})];case 3:return _=k.sent(),p(Array.isArray(_.data)?_.data:[]),[3,5];case 4:return w=k.sent(),console.error(w),p(b1(u)),[3,5];case 5:return[3,7];case 6:p(b1(u)),k.label=7;case 7:return[2]}})})}var DM={"#5B8FF9":!0},Sp=function(r){var e=Ya.toRGB(r).toUpperCase();if(DM[e])return DM[e];var t=(0,P.CR)(Ya.rgb2arr(e),3),i=t[0],u=t[1],c=t[2],p=(i*299+u*587+c*114)/1e3<128;return p};function Ps(r,e,t){if(t.length!==0){var i=t[0].get("element"),u=i.geometry.theme,c=u.labels||{},p=c.fillColorLight,g=c.fillColorDark;t.forEach(function(_,w){var k=e[w],L=k.find(function(vt){return vt.get("type")==="text"}),R=Nu.fromObject(_.getBBox()),U=Nu.fromObject(L.getCanvasBBox()),G=!R.contains(U),Q=_.attr("fill"),pt=Sp(Q);G?L.attr(u.overflowLabels.style):pt?p&&L.attr("fill",p):g&&L.attr("fill",g)})}}function Rv(r,e,t){var i=r.coordinate,u=fl(e),c=Nu.fromObject(u.getCanvasBBox()),p=Nu.fromObject(t.getBBox());return i.isTransposed?p.height>=c.height:p.width>=c.width}function Vi(r,e,t){var i=!!r.getAdjust("stack");return i||e.every(function(u,c){var p=t[c];return Rv(r,u,p)})}function wp(r,e,t){var i=r.coordinate,u=Nu.fromObject(t.getBBox()),c=fl(e);i.isTransposed?c.attr({x:u.minX+u.width/2,textAlign:"center"}):c.attr({y:u.minY+u.height/2,textBaseline:"middle"})}function S1(r,e,t){var i;if(t.length!==0){var u=(i=t[0])===null||i===void 0?void 0:i.get("element"),c=u==null?void 0:u.geometry;if(!(!c||c.type!=="interval")){var p=Vi(c,e,t);p&&t.forEach(function(g,_){var w=e[_];wp(c,w,g)})}}}function d0(r){var e=500,t=[],i=Math.max(Math.floor(r.length/e),1);return(0,b.S6)(r,function(u,c){c%i===0?t.push(u):u.set("visible",!1)}),t}function hy(r,e,t){var i;if(t.length!==0){var u=(i=t[0])===null||i===void 0?void 0:i.get("element"),c=u==null?void 0:u.geometry;if(!(!c||c.type!=="interval")){var p=d0(e),g=(0,P.CR)(c.getXYFields(),1),_=g[0],w=[],k=[],L=(0,b.vM)(p,function(pt){return pt.get("data")[_]}),R=(0,b.jj)((0,b.UI)(p,function(pt){return pt.get("data")[_]})),U;p.forEach(function(pt){pt.set("visible",!0)});var G=function(pt){pt&&(pt.length&&k.push(pt.pop()),k.push.apply(k,(0,P.ev)([],(0,P.CR)(pt),!1)))};for((0,b.dp)(R)>0&&(U=R.shift(),G(L[U])),(0,b.dp)(R)>0&&(U=R.pop(),G(L[U])),(0,b.S6)(R.reverse(),function(pt){G(L[pt])});k.length>0;){var Q=k.shift();Q.get("visible")&&(Lf(Q,w)?Q.set("visible",!1):w.push(Q))}}}}function BM(r,e){var t=r.getXYFields()[1],i=[],u=e.sort(function(c,p){return c.get("data")[t]-c.get("data")[t]});return u.length>0&&i.push(u.shift()),u.length>0&&i.push(u.pop()),i.push.apply(i,(0,P.ev)([],(0,P.CR)(u),!1)),i}function wE(r,e,t){return r.some(function(i){return t(i,e)})}function w1(r,e,t){t===void 0&&(t=0);var i=Math.max(0,Math.min(r.x+r.width+t,e.x+e.width+t)-Math.max(r.x-t,e.x-t)),u=Math.max(0,Math.min(r.y+r.height+t,e.y+e.height+t)-Math.max(r.y-t,e.y-t));return i*u}function CE(r,e){return wE(r,e,function(t,i){var u=fl(t),c=fl(i);return w1(u.getCanvasBBox(),c.getCanvasBBox(),2)>0})}function AE(r,e,t,i,u){var c,p;if(t.length!==0){var g=(c=t[0])===null||c===void 0?void 0:c.get("element"),_=g==null?void 0:g.geometry;if(!(!_||_.type!=="point")){var w=(0,P.CR)(_.getXYFields(),2),k=w[0],L=w[1],R=(0,b.vM)(e,function(Q){return Q.get("data")[k]}),U=[],G=u&&u.offset||((p=r[0])===null||p===void 0?void 0:p.offset)||12;(0,b.UI)((0,b.XP)(R).reverse(),function(Q){for(var pt=BM(_,R[Q]);pt.length;){var vt=pt.shift(),Vt=fl(vt);if(wE(U,vt,function(Ne,Er){return Ne.get("data")[k]===Er.get("data")[k]&&Ne.get("data")[L]===Er.get("data")[L]})){Vt.set("visible",!1);continue}var le=CE(U,vt),he=!1;if(le&&(Vt.attr("y",Vt.attr("y")+2*G),he=CE(U,vt)),he){Vt.set("visible",!1);continue}U.push(vt)}})}}}function NM(r,e){var t=r.getXYFields()[1],i=[],u=e.sort(function(c,p){return c.get("data")[t]-c.get("data")[t]});return u.length>0&&i.push(u.shift()),u.length>0&&i.push(u.pop()),i.push.apply(i,(0,P.ev)([],(0,P.CR)(u),!1)),i}function TE(r,e,t){return r.some(function(i){return t(i,e)})}function kO(r,e,t){t===void 0&&(t=0);var i=Math.max(0,Math.min(r.x+r.width+t,e.x+e.width+t)-Math.max(r.x-t,e.x-t)),u=Math.max(0,Math.min(r.y+r.height+t,e.y+e.height+t)-Math.max(r.y-t,e.y-t));return i*u}function zM(r,e){return TE(r,e,function(t,i){var u=fl(t),c=fl(i);return kO(u.getCanvasBBox(),c.getCanvasBBox(),2)>0})}function UM(r,e,t,i,u){var c,p;if(t.length!==0){var g=(c=t[0])===null||c===void 0?void 0:c.get("element"),_=g==null?void 0:g.geometry;if(!(!_||["path","line","area"].indexOf(_.type)<0)){var w=(0,P.CR)(_.getXYFields(),2),k=w[0],L=w[1],R=(0,b.vM)(e,function(Q){return Q.get("data")[k]}),U=[],G=u&&u.offset||((p=r[0])===null||p===void 0?void 0:p.offset)||12;(0,b.UI)((0,b.XP)(R).reverse(),function(Q){for(var pt=NM(_,R[Q]);pt.length;){var vt=pt.shift(),Vt=fl(vt);if(TE(U,vt,function(Ne,Er){return Ne.get("data")[k]===Er.get("data")[k]&&Ne.get("data")[L]===Er.get("data")[L]})){Vt.set("visible",!1);continue}var le=zM(U,vt),he=!1;if(le&&(Vt.attr("y",Vt.attr("y")+2*G),he=zM(U,vt)),he){Vt.set("visible",!1);continue}U.push(vt)}})}}}var C1;function v0(){return C1||(C1=document.createElement("canvas").getContext("2d")),C1}var py=(0,b.HP)(function(r,e){e===void 0&&(e={});var t=e.fontSize,i=e.fontFamily,u=e.fontWeight,c=e.fontStyle,p=e.fontVariant,g=v0();return g.font=[c,p,u,"".concat(t,"px"),i].join(" "),g.measureText((0,b.HD)(r)?r:"").width},function(r,e){return e===void 0&&(e={}),(0,P.ev)([r],(0,P.CR)((0,b.VO)(e)),!1).join("")}),ZM=function(r,e,t){var i=16,u=py("...",t),c;(0,b.HD)(r)?c=r:c=(0,b.BB)(r);var p=e,g=[],_,w;if(py(r,t)<=e)return r;for(;_=c.substr(0,i),w=py(_,t),!(w+u>p&&w>p);)if(g.push(_),p-=w,c=c.substr(i),!c)return g.join("");for(;_=c.substr(0,1),w=py(_,t),!(w+u>p);)if(g.push(_),p-=w,c=c.substr(1),!c)return g.join("");return"".concat(g.join(""),"...")};function dy(r,e,t,i,u){if(!(e.length<=0)){var c=(u==null?void 0:u.direction)||["top","right","bottom","left"],p=(u==null?void 0:u.action)||"translate",g=(u==null?void 0:u.margin)||0,_=e[0].get("coordinate");if(!!_){var w=Hm(_,g),k=w.minX,L=w.minY,R=w.maxX,U=w.maxY;(0,b.S6)(e,function(G){var Q=G.getCanvasBBox(),pt=Q.minX,vt=Q.minY,Vt=Q.maxX,le=Q.maxY,he=Q.x,Ne=Q.y,Er=Q.width,Fr=Q.height,zr=he,pn=Ne;if(c.indexOf("left")>=0&&(pt<k||Vt<k)&&(zr=k),c.indexOf("top")>=0&&(vt<L||le<L)&&(pn=L),c.indexOf("right")>=0&&(pt>R?zr=R-Er:Vt>R&&(zr=zr-(Vt-R))),c.indexOf("bottom")>=0&&(vt>U?pn=U-Fr:le>U&&(pn=pn-(le-U))),zr!==he||pn!==Ne){var nn=zr-he;if(p==="translate")cf(G,nn,pn-Ne);else if(p==="ellipsis"){var Pn=G.findAll(function(Si){return Si.get("type")==="text"});Pn.forEach(function(Si){var ha=(0,b.ei)(Si.attr(),["fontSize","fontFamily","fontWeight","fontStyle","fontVariant"]),wa=Si.getCanvasBBox(),_o=ZM(Si.attr("text"),wa.width-Math.abs(nn),ha);Si.attr("text",_o)})}else G.hide()}})}}}function VM(r,e,t){var i={fillOpacity:(0,b.UM)(r.attr("fillOpacity"))?1:r.attr("fillOpacity"),strokeOpacity:(0,b.UM)(r.attr("strokeOpacity"))?1:r.attr("strokeOpacity"),opacity:(0,b.UM)(r.attr("opacity"))?1:r.attr("opacity")};r.attr({fillOpacity:0,strokeOpacity:0,opacity:0}),r.animate(i,e)}function GM(r,e,t){var i={fillOpacity:0,strokeOpacity:0,opacity:0},u=e.easing,c=e.duration,p=e.delay;r.animate(i,c,u,function(){r.remove(!0)},p)}function ME(r,e,t){var i,u=(0,P.CR)(e,2),c=u[0],p=u[1];return r.applyToMatrix([c,p,1]),t==="x"?(r.setMatrix(ma.vs(r.getMatrix(),[["t",-c,-p],["s",.01,1],["t",c,p]])),i=ma.vs(r.getMatrix(),[["t",-c,-p],["s",100,1],["t",c,p]])):t==="y"?(r.setMatrix(ma.vs(r.getMatrix(),[["t",-c,-p],["s",1,.01],["t",c,p]])),i=ma.vs(r.getMatrix(),[["t",-c,-p],["s",1,100],["t",c,p]])):t==="xy"&&(r.setMatrix(ma.vs(r.getMatrix(),[["t",-c,-p],["s",.01,.01],["t",c,p]])),i=ma.vs(r.getMatrix(),[["t",-c,-p],["s",100,100],["t",c,p]])),i}function A1(r,e,t,i,u){var c=t.start,p=t.end,g=t.getWidth(),_=t.getHeight(),w,k;u==="y"?(w=c.x+g/2,k=i.y<c.y?i.y:c.y):u==="x"?(w=i.x>c.x?i.x:c.x,k=c.y+_/2):u==="xy"&&(t.isPolar?(w=t.getCenter().x,k=t.getCenter().y):(w=(c.x+p.x)/2,k=(c.y+p.y)/2));var L=ME(r,[w,k],u);r.animate({matrix:L},e)}function HM(r,e,t){var i=t.coordinate,u=t.minYPoint;A1(r,e,i,u,"x")}function jM(r,e,t){var i=t.coordinate,u=t.minYPoint;A1(r,e,i,u,"y")}function WM(r,e,t){var i=t.coordinate,u=t.minYPoint;A1(r,e,i,u,"xy")}function XM(r,e,t){var i=r.getTotalLength();r.attr("lineDash",[i]),r.animate(function(u){return{lineDashOffset:(1-u)*i}},e)}function YM(r,e,t){var i=t.toAttrs,u=i.x,c=i.y;delete i.x,delete i.y,r.attr(i),r.animate({x:u,y:c},e)}function Xd(r,e,t){var i=r.getBBox(),u=r.get("origin").mappingData,c=u.points,p=c[0].y-c[1].y>0?i.maxX:i.minX,g=(i.minY+i.maxY)/2;r.applyToMatrix([p,g,1]);var _=ma.vs(r.getMatrix(),[["t",-p,-g],["s",.01,1],["t",p,g]]);r.setMatrix(_),r.animate({matrix:ma.vs(r.getMatrix(),[["t",-p,-g],["s",100,1],["t",p,g]])},e)}function IE(r,e,t){var i=r.getBBox(),u=r.get("origin").mappingData,c=(i.minX+i.maxX)/2,p=u.points,g=p[0].y-p[1].y<=0?i.maxY:i.minY;r.applyToMatrix([c,g,1]);var _=ma.vs(r.getMatrix(),[["t",-c,-g],["s",1,.01],["t",c,g]]);r.setMatrix(_),r.animate({matrix:ma.vs(r.getMatrix(),[["t",-c,-g],["s",1,100],["t",c,g]])},e)}function kE(r,e){var t,i=Tv(r,e),u=i.startAngle,c=i.endAngle;return!(0,b.vQ)(u,-Math.PI*.5)&&u<-Math.PI*.5&&(u+=Math.PI*2),!(0,b.vQ)(c,-Math.PI*.5)&&c<-Math.PI*.5&&(c+=Math.PI*2),e[5]===0&&(t=(0,P.CR)([c,u],2),u=t[0],c=t[1]),(0,b.vQ)(u,Math.PI*1.5)&&(u=Math.PI*-.5),(0,b.vQ)(c,Math.PI*-.5)&&!(0,b.vQ)(u,c)&&(c=Math.PI*1.5),{startAngle:u,endAngle:c}}function LE(r){var e;return r[0]==="M"||r[0]==="L"?e=[r[1],r[2]]:(r[0]==="a"||r[0]==="A"||r[0]==="C")&&(e=[r[r.length-2],r[r.length-1]]),e}function PE(r){var e,t,i,u=r.filter(function(le){return le[0]==="A"||le[0]==="a"});if(u.length===0)return{startAngle:0,endAngle:0,radius:0,innerRadius:0};var c=u[0],p=u.length>1?u[1]:u[0],g=r.indexOf(c),_=r.indexOf(p),w=LE(r[g-1]),k=LE(r[_-1]),L=kE(w,c),R=L.startAngle,U=L.endAngle,G=kE(k,p),Q=G.startAngle,pt=G.endAngle;(0,b.vQ)(R,Q)&&(0,b.vQ)(U,pt)?(t=R,i=U):(t=Math.min(R,Q),i=Math.max(U,pt));var vt=c[1],Vt=u[u.length-1][1];return vt<Vt?(e=(0,P.CR)([Vt,vt],2),vt=e[0],Vt=e[1]):vt===Vt&&(Vt=0),{startAngle:t,endAngle:i,radius:vt,innerRadius:Vt}}function Yd(r,e,t){var i=t.toAttrs,u=t.coordinate,c=i.path||[],p=c.map(function(Vt){return Vt[0]});if(!(c.length<1)){var g=PE(c),_=g.startAngle,w=g.endAngle,k=g.radius,L=g.innerRadius,R=PE(r.attr("path")),U=R.startAngle,G=R.endAngle,Q=u.getCenter(),pt=_-U,vt=w-G;if(pt===0&&vt===0){r.attr("path",c);return}r.animate(function(Vt){var le=U+Vt*pt,he=G+Vt*vt;return(0,P.pi)((0,P.pi)({},i),{path:(0,b.Xy)(p,["M","A","A","Z"])?W0(Q.x,Q.y,k,le,he):gu(Q.x,Q.y,k,le,he,L)})},(0,P.pi)((0,P.pi)({},e),{callback:function(){r.attr("path",c)}}))}}function OE(r,e,t){var i=qp(t.coordinate,20),u=i.type,c=i.startState,p=i.endState,g=r.setClip({type:u,attrs:c});t.toAttrs&&r.attr(t.toAttrs),g.animate(p,(0,P.pi)((0,P.pi)({},e),{callback:function(){r&&!r.get("destroyed")&&r.set("clipShape",null),g.remove(!0)}}))}function T1(r,e,t){if(r.isGroup())(0,b.S6)(r.getChildren(),function(g){T1(g,e,t)});else{var i=r.getBBox(),u=(i.minX+i.maxX)/2,c=(i.minY+i.maxY)/2;if(r.applyToMatrix([u,c,1]),t==="zoomIn"){var p=ma.vs(r.getMatrix(),[["t",-u,-c],["s",.01,.01],["t",u,c]]);r.setMatrix(p),r.animate({matrix:ma.vs(r.getMatrix(),[["t",-u,-c],["s",100,100],["t",u,c]])},e)}else r.animate({matrix:ma.vs(r.getMatrix(),[["t",-u,-c],["s",.01,.01],["t",u,c]])},(0,P.pi)((0,P.pi)({},e),{callback:function(){r.remove(!0)}}))}}function FE(r,e,t){T1(r,e,"zoomIn")}function RE(r,e,t){T1(r,e,"zoomOut")}function bc(r){return[fe.TOP,fe.BOTTOM].includes(r)?{offsetX:0,offsetY:r===fe.TOP?-8:8,style:{textAlign:"center",textBaseline:r===fe.TOP?"bottom":"top"}}:[fe.LEFT,fe.RIGHT].includes(r)?{offsetX:r===fe.LEFT?-8:8,offsetY:0,style:{textAlign:r===fe.LEFT?"right":"left",textBaseline:"middle",rotate:Math.PI/2}}:{}}function vy(r,e,t){return{x:r.x+e*Math.cos(t),y:r.y+e*Math.sin(t)}}var uh=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"circle",showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this)})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.getRegion=function(t,i){var u=.5,c={x:.5,y:.5},p=Math.PI*2/t,g=-1*Math.PI/2+p*i,_=u/(1+1/Math.sin(p/2)),w=vy(c,u-_,g),k=Math.PI*5/4,L=Math.PI*1/4;return{start:vy(w,_,k),end:vy(w,_,L)}},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.generateFacets=function(t){var i=this,u=this.cfg,c=u.fields,p=u.type,g=(0,P.CR)(c,1),_=g[0];if(!_)throw new Error("No `fields` specified!");var w=this.getFieldValues(t,_),k=w.length,L=[];return w.forEach(function(R,U){var G=[{field:_,value:R,values:w}],Q=(0,b.hX)(t,i.getFacetDataFilter(G)),pt={type:p,data:Q,region:i.getRegion(k,U),columnValue:R,columnField:_,columnIndex:U,columnValuesLength:k,rowValue:null,rowField:null,rowIndex:0,rowValuesLength:1};L.push(pt)}),L},e.prototype.getXAxisOption=function(t,i,u,c){return u},e.prototype.getYAxisOption=function(t,i,u,c){return u},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i){var u=i.columnValue,c=i.view,p=(0,b.U2)(t.cfg.title,"formatter"),g=(0,b.b$)({position:["50%","0%"],content:p?p(u):u},bc(fe.TOP),t.cfg.title);c.annotation().text(g)})},e}(Qn),M1=uh,$M=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"list",cols:null,showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this)})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.generateFacets=function(t){var i=this,u=this.cfg.fields,c=this.cfg.cols,p=(0,P.CR)(u,1),g=p[0];if(!g)throw new Error("No `fields` specified!");var _=this.getFieldValues(t,g),w=_.length;c=c||w;var k=this.getPageCount(w,c),L=[];return _.forEach(function(R,U){var G=i.getRowCol(U,c),Q=G.row,pt=G.col,vt=[{field:g,value:R,values:_}],Vt=(0,b.hX)(t,i.getFacetDataFilter(vt)),le={type:i.cfg.type,data:Vt,region:i.getRegion(k,c,pt,Q),columnValue:R,rowValue:R,columnField:g,rowField:null,columnIndex:pt,rowIndex:Q,columnValuesLength:c,rowValuesLength:k,total:w};L.push(le)}),L},e.prototype.getXAxisOption=function(t,i,u,c){return c.rowIndex!==c.rowValuesLength-1&&c.columnValuesLength*c.rowIndex+c.columnIndex+1+c.columnValuesLength<=c.total?(0,P.pi)((0,P.pi)({},u),{label:null,title:null}):u},e.prototype.getYAxisOption=function(t,i,u,c){return c.columnIndex!==0?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):u},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i){var u=i.columnValue,c=i.view,p=(0,b.U2)(t.cfg.title,"formatter"),g=(0,b.b$)({position:["50%","0%"],content:p?p(u):u},bc(fe.TOP),t.cfg.title);c.annotation().text(g)})},e.prototype.getPageCount=function(t,i){return Math.floor((t+i-1)/i)},e.prototype.getRowCol=function(t,i){var u=Math.floor(t/i),c=t%i;return{row:u,col:c}},e}(Qn),qM=$M,LO=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"matrix",showTitle:!1,columnTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this)),rowTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this))})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.generateFacets=function(t){for(var i=this.cfg,u=i.fields,c=i.type,p=u.length,g=p,_=[],w=0;w<g;w++)for(var k=u[w],L=0;L<p;L++){var R=u[L],U={type:c,data:t,region:this.getRegion(p,g,w,L),columnValue:k,rowValue:R,columnField:k,rowField:R,columnIndex:w,rowIndex:L,columnValuesLength:g,rowValuesLength:p};_.push(U)}return _},e.prototype.getXAxisOption=function(t,i,u,c){return c.rowIndex!==c.rowValuesLength-1?(0,P.pi)((0,P.pi)({},u),{label:null,title:null}):u},e.prototype.getYAxisOption=function(t,i,u,c){return c.columnIndex!==0?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):u},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i,u){var c=i.columnIndex,p=i.rowIndex,g=i.columnValuesLength,_=i.rowValuesLength,w=i.columnValue,k=i.rowValue,L=i.view;if(p===0){var R=(0,b.U2)(t.cfg.columnTitle,"formatter"),U=(0,b.b$)({position:["50%","0%"],content:R?R(w):w},bc(fe.TOP),t.cfg.columnTitle);L.annotation().text(U)}if(c===g-1){var R=(0,b.U2)(t.cfg.rowTitle,"formatter"),U=(0,b.b$)({position:["100%","50%"],content:R?R(k):k},bc(fe.RIGHT),t.cfg.rowTitle);L.annotation().text(U)}})},e}(Qn),KM=LO,QM=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"mirror",showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this),transpose:!1})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.beforeEachView=function(t,i){this.cfg.transpose?i.columnIndex%2===0?t.coordinate().transpose().reflect("x"):t.coordinate().transpose():i.rowIndex%2!==0&&t.coordinate().reflect("y")},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.generateFacets=function(t){var i=this,u=(0,P.CR)(this.cfg.fields,1),c=u[0],p=[],g=1,_=1,w=[""],k=[""],L,R;return this.cfg.transpose?(L=c,w=this.getFieldValues(t,L).slice(0,2),g=w.length):(R=c,k=this.getFieldValues(t,R).slice(0,2),_=k.length),w.forEach(function(U,G){k.forEach(function(Q,pt){var vt=[{field:L,value:U,values:w},{field:R,value:Q,values:k}],Vt=(0,b.hX)(t,i.getFacetDataFilter(vt)),le={type:i.cfg.type,data:Vt,region:i.getRegion(_,g,G,pt),columnValue:U,rowValue:Q,columnField:L,rowField:R,columnIndex:G,rowIndex:pt,columnValuesLength:g,rowValuesLength:_};p.push(le)})}),p},e.prototype.getXAxisOption=function(t,i,u,c){return c.columnIndex===1||c.rowIndex===1?(0,P.pi)((0,P.pi)({},u),{label:null,title:null}):u},e.prototype.getYAxisOption=function(t,i,u,c){return u},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i,u){var c=i.columnValue,p=i.rowValue,g=i.view,_=(0,b.U2)(t.cfg.title,"formatter");if(t.cfg.transpose){var w=(0,b.b$)({position:["50%","0%"],content:_?_(c):c},bc(fe.TOP),t.cfg.title);g.annotation().text(w)}else{var w=(0,b.b$)({position:["100%","50%"],content:_?_(p):p},bc(fe.RIGHT),t.cfg.title);g.annotation().text(w)}})},e}(Qn),PO=QM,JM=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"rect",columnTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this)),rowTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this))})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.generateFacets=function(t){var i=this,u=(0,P.CR)(this.cfg.fields,2),c=u[0],p=u[1],g=[],_=1,w=1,k=[""],L=[""];return c&&(k=this.getFieldValues(t,c),_=k.length),p&&(L=this.getFieldValues(t,p),w=L.length),k.forEach(function(R,U){L.forEach(function(G,Q){var pt=[{field:c,value:R,values:k},{field:p,value:G,values:L}],vt=(0,b.hX)(t,i.getFacetDataFilter(pt)),Vt={type:i.cfg.type,data:vt,region:i.getRegion(w,_,U,Q),columnValue:R,rowValue:G,columnField:c,rowField:p,columnIndex:U,rowIndex:Q,columnValuesLength:_,rowValuesLength:w};g.push(Vt)})}),g},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i,u){var c=i.columnIndex,p=i.rowIndex,g=i.columnValuesLength,_=i.columnValue,w=i.rowValue,k=i.view;if(p===0){var L=(0,b.U2)(t.cfg.columnTitle,"formatter"),R=(0,b.b$)({position:["50%","0%"],content:L?L(_):_},bc(fe.TOP),t.cfg.columnTitle);k.annotation().text(R)}if(c===g-1){var L=(0,b.U2)(t.cfg.rowTitle,"formatter"),R=(0,b.b$)({position:["100%","50%"],content:L?L(w):w},bc(fe.RIGHT),t.cfg.rowTitle);k.annotation().text(R)}})},e.prototype.getXAxisOption=function(t,i,u,c){return c.rowIndex!==c.rowValuesLength-1?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):c.columnIndex!==Math.floor((c.columnValuesLength-1)/2)?(0,P.pi)((0,P.pi)({},u),{title:null}):u},e.prototype.getYAxisOption=function(t,i,u,c){return c.columnIndex!==0?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):c.rowIndex!==Math.floor((c.rowValuesLength-1)/2)?(0,P.pi)((0,P.pi)({},u),{title:null}):u},e}(Qn),t3=JM,OO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.afterChartRender=function(){t.facets&&t.cfg.line&&(t.container.clear(),t.drawLines(t.facets))},t}return e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.init=function(){r.prototype.init.call(this),this.view.on(Mt.AFTER_RENDER,this.afterChartRender)},e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"tree",line:{style:{lineWidth:1,stroke:"#ddd"},smooth:!1},showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this)})},e.prototype.generateFacets=function(t){var i=this.cfg.fields;if(!i.length)throw new Error("Please specify for the fields for rootFacet!");var u=[],c={type:this.cfg.type,data:t,region:null,rowValuesLength:this.getRows(),columnValuesLength:1,rowIndex:0,columnIndex:0,rowField:"",columnField:"",rowValue:"",columnValue:""};return u.push(c),c.children=this.getChildFacets(t,1,u),this.setRegion(u),u},e.prototype.setRegion=function(t){var i=this;this.forceColIndex(t),t.forEach(function(u){u.region=i.getRegion(u.rowValuesLength,u.columnValuesLength,u.columnIndex,u.rowIndex)})},e.prototype.getRegion=function(t,i,u,c){var p=1/i,g=1/t,_={x:p*u,y:g*c},w={x:_.x+p,y:_.y+g*2/3};return{start:_,end:w}},e.prototype.forceColIndex=function(t){var i,u,c=this,p=[],g=0;t.forEach(function(G){c.isLeaf(G)&&(p.push(G),G.columnIndex=g,g++)}),p.forEach(function(G){G.columnValuesLength=p.length});for(var _=this.cfg.fields.length,w=_-1;w>=0;w--){var k=this.getFacetsByLevel(t,w);try{for(var L=(i=void 0,(0,P.XA)(k)),R=L.next();!R.done;R=L.next()){var U=R.value;this.isLeaf(U)||(U.originColIndex=U.columnIndex,U.columnIndex=this.getRegionIndex(U.children),U.columnValuesLength=p.length)}}catch(G){i={error:G}}finally{try{R&&!R.done&&(u=L.return)&&u.call(L)}finally{if(i)throw i.error}}}},e.prototype.getFacetsByLevel=function(t,i){var u=[];return t.forEach(function(c){c.rowIndex===i&&u.push(c)}),u},e.prototype.getRegionIndex=function(t){var i=t[0],u=t[t.length-1];return(u.columnIndex-i.columnIndex)/2+i.columnIndex},e.prototype.isLeaf=function(t){return!t.children||!t.children.length},e.prototype.getRows=function(){return this.cfg.fields.length+1},e.prototype.getChildFacets=function(t,i,u){var c=this,p=this.cfg.fields,g=p.length;if(!(g<i)){var _=[],w=p[i-1],k=this.getFieldValues(t,w);return k.forEach(function(L,R){var U=[{field:w,value:L,values:k}],G=t.filter(c.getFacetDataFilter(U));if(G.length){var Q={type:c.cfg.type,data:G,region:null,columnValue:L,rowValue:"",columnField:w,rowField:"",columnIndex:R,rowValuesLength:c.getRows(),columnValuesLength:1,rowIndex:i,children:c.getChildFacets(G,i+1,u)};_.push(Q),u.push(Q)}}),_}},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i){var u=i.columnValue,c=i.view,p=(0,b.U2)(t.cfg.title,"formatter"),g=(0,b.b$)({position:["50%","0%"],content:p?p(u):u},bc(fe.TOP),t.cfg.title);c.annotation().text(g)})},e.prototype.drawLines=function(t){var i=this;t.forEach(function(u){if(!i.isLeaf(u)){var c=u.children;i.addFacetLines(u,c)}})},e.prototype.addFacetLines=function(t,i){var u=this,c=t.view,p=c.coordinateBBox,g={x:p.x+p.width/2,y:p.y+p.height};i.forEach(function(_){var w=_.view.coordinateBBox,k={x:w.bl.x+(w.tr.x-w.bl.x)/2,y:w.tr.y},L={x:g.x,y:g.y+(k.y-g.y)/2},R={x:k.x,y:L.y};u.drawLine([g,L,R,k])})},e.prototype.getPath=function(t){var i=[],u=this.cfg.line.smooth;return u?(i.push(["M",t[0].x,t[0].y]),i.push(["C",t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y])):t.forEach(function(c,p){p===0?i.push(["M",c.x,c.y]):i.push(["L",c.x,c.y])}),i},e.prototype.drawLine=function(t){var i=this.getPath(t),u=this.cfg.line.style;this.container.addShape("path",{attrs:(0,b.f0)({path:i},u)})},e.prototype.getXAxisOption=function(t,i,u,c){return c.rowIndex!==c.rowValuesLength-1?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):u},e.prototype.getYAxisOption=function(t,i,u,c){return c.originColIndex!==0&&c.columnIndex!==0?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):u},e}(Qn),e3=OO;function DE(r){var e=(0,P.ev)([],(0,P.CR)(r),!1);e.sort(function(i,u){return i-u});var t=e.length;return t===0?0:t%2===1?e[(t-1)/2]:(e[t/2]+e[t/2-1])/2}function r3(r){var e=(0,b.u4)(r,function(t,i){return t+=isNaN(i)||!(0,b.hj)(i)?0:i},0);return r.length===0?0:e/r.length}function gy(r,e){if(!e)return null;var t;switch(r){case"start":return 0;case"center":return .5;case"end":return 1;case"median":{t=e.isCategory?DE(e.values.map(function(i,u){return u})):DE(e.values);break}case"mean":{t=e.isCategory?(e.values.length-1)/2:r3(e.values);break}case"min":t=e.isCategory?0:e[r];break;case"max":t=e.isCategory?e.values.length-1:e[r];break;default:t=r;break}return e.scale(t)}var I1=["regionFilter","shape"],n3=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.cache=new Map,i.foregroundContainer=i.view.getLayer(W.FORE).addGroup(),i.backgroundContainer=i.view.getLayer(W.BG).addGroup(),i.option=[],i}return Object.defineProperty(e.prototype,"name",{get:function(){return"annotation"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.layout=function(){this.update()},e.prototype.render=function(){},e.prototype.update=function(){var t=this;this.onAfterRender(function(){var u=new Map;(0,b.S6)(t.option,function(c){if((0,b.q9)(I1,c.type)){var p=t.updateOrCreate(c);p&&u.set(t.getCacheKey(c),p)}}),t.cache=t.syncCache(u)});var i=new Map;(0,b.S6)(this.option,function(u){if(!(0,b.q9)(I1,u.type)){var c=t.updateOrCreate(u);c&&i.set(t.getCacheKey(u),c)}}),this.cache=this.syncCache(i)},e.prototype.clear=function(t){t===void 0&&(t=!1),r.prototype.clear.call(this),this.clearComponents(),this.foregroundContainer.clear(),this.backgroundContainer.clear(),t&&(this.option=[])},e.prototype.destroy=function(){this.clear(!0),this.foregroundContainer.remove(!0),this.backgroundContainer.remove(!0)},e.prototype.getComponents=function(){var t=[];return this.cache.forEach(function(i){t.push(i)}),t},e.prototype.clearComponents=function(){this.getComponents().forEach(function(t){t.component.destroy()}),this.cache.clear()},e.prototype.onAfterRender=function(t){var i=!1;this.view.getOptions().animate&&this.view.geometries.forEach(function(u){u.animateOption&&(u.once(et.AFTER_DRAW_ANIMATE,function(){t()}),i=!0)}),i||this.view.getRootView().once(Mt.AFTER_RENDER,function(){t()})},e.prototype.createAnnotation=function(t){var i=t.type,u=bt[(0,b.jC)(i)];if(u){var c=this.getAnnotationTheme(i),p=this.getAnnotationCfg(i,t,c);if(!p)return null;var g=new u(p);return{component:g,layer:this.isTop(p)?W.FORE:W.BG,direction:fe.NONE,type:Ee.ANNOTATION,extra:t}}},e.prototype.annotation=function(t){this.option.push(t)},e.prototype.arc=function(t){return this.annotation((0,P.pi)({type:"arc"},t)),this},e.prototype.image=function(t){return this.annotation((0,P.pi)({type:"image"},t)),this},e.prototype.line=function(t){return this.annotation((0,P.pi)({type:"line"},t)),this},e.prototype.region=function(t){return this.annotation((0,P.pi)({type:"region"},t)),this},e.prototype.text=function(t){return this.annotation((0,P.pi)({type:"text"},t)),this},e.prototype.dataMarker=function(t){return this.annotation((0,P.pi)({type:"dataMarker"},t)),this},e.prototype.dataRegion=function(t){this.annotation((0,P.pi)({type:"dataRegion"},t))},e.prototype.regionFilter=function(t){this.annotation((0,P.pi)({type:"regionFilter"},t))},e.prototype.shape=function(t){this.annotation((0,P.pi)({type:"shape"},t))},e.prototype.html=function(t){this.annotation((0,P.pi)({type:"html"},t))},e.prototype.parsePosition=function(t){var i,u,c=this.view.getXScale(),p=this.view.getScalesByDim("y"),g=(0,b.mf)(t)?t.call(null,c,p):t,_=0,w=0;if((0,b.kJ)(g)){var k=(0,P.CR)(g,2),L=k[0],R=k[1];if((0,b.HD)(L)&&L.indexOf("%")!==-1&&!isNaN(L.slice(0,-1)))return this.parsePercentPosition(g);_=gy(L,c),w=gy(R,Object.values(p)[0])}else if(!(0,b.UM)(g))try{for(var U=(0,P.XA)((0,b.XP)(g)),G=U.next();!G.done;G=U.next()){var Q=G.value,pt=g[Q];Q===c.field&&(_=gy(pt,c)),p[Q]&&(w=gy(pt,p[Q]))}}catch(vt){i={error:vt}}finally{try{G&&!G.done&&(u=U.return)&&u.call(U)}finally{if(i)throw i.error}}return isNaN(_)||isNaN(w)?null:this.view.getCoordinate().convert({x:_,y:w})},e.prototype.getRegionPoints=function(t,i){var u=this,c=this.view.getXScale(),p=this.view.getScalesByDim("y"),g=Object.values(p)[0],_=c.field,w=this.view.getData(),k=(0,b.kJ)(t)?t[0]:t[_],L=(0,b.kJ)(i)?i[0]:i[_],R=[],U;return(0,b.S6)(w,function(G,Q){if(G[_]===k&&(U=Q),Q>=U){var pt=u.parsePosition([G[_],G[g.field]]);pt&&R.push(pt)}if(G[_]===L)return!1}),R},e.prototype.parsePercentPosition=function(t){var i=parseFloat(t[0])/100,u=parseFloat(t[1])/100,c=this.view.getCoordinate(),p=c.start,g=c.end,_={x:Math.min(p.x,g.x),y:Math.min(p.y,g.y)},w=c.getWidth()*i+_.x,k=c.getHeight()*u+_.y;return{x:w,y:k}},e.prototype.getCoordinateBBox=function(){var t=this.view.getCoordinate(),i=t.start,u=t.end,c=t.getWidth(),p=t.getHeight(),g={x:Math.min(i.x,u.x),y:Math.min(i.y,u.y)};return{x:g.x,y:g.y,minX:g.x,minY:g.y,maxX:g.x+c,maxY:g.y+p,width:c,height:p}},e.prototype.getAnnotationCfg=function(t,i,u){var c=this,p=this.view.getCoordinate(),g=this.view.getCanvas(),_={};if((0,b.UM)(i))return null;var w=i.start,k=i.end,L=i.position,R=this.parsePosition(w),U=this.parsePosition(k),G=this.parsePosition(L);if(["arc","image","line","region","regionFilter"].includes(t)&&(!R||!U))return null;if(["text","dataMarker","html"].includes(t)&&!G)return null;if(t==="arc"){var Q=i,pt=Q.start,vt=Q.end,Vt=(0,P._T)(Q,["start","end"]),le=uf(p,R),he=uf(p,U);le>he&&(he=Math.PI*2+he),_=(0,P.pi)((0,P.pi)({},Vt),{center:p.getCenter(),radius:$p(p,R),startAngle:le,endAngle:he})}else if(t==="image"){var Ne=i,Er=Ne.start,Fr=Ne.end,Vt=(0,P._T)(Ne,["start","end"]);_=(0,P.pi)((0,P.pi)({},Vt),{start:R,end:U,src:i.src})}else if(t==="line"){var zr=i,pn=zr.start,nn=zr.end,Vt=(0,P._T)(zr,["start","end"]);_=(0,P.pi)((0,P.pi)({},Vt),{start:R,end:U,text:(0,b.U2)(i,"text",null)})}else if(t==="region"){var Pn=i,Si=Pn.start,ha=Pn.end,Vt=(0,P._T)(Pn,["start","end"]);_=(0,P.pi)((0,P.pi)({},Vt),{start:R,end:U})}else if(t==="text"){var wa=this.view.getData(),_o=i,Vn=_o.position,Bi=_o.content,Vt=(0,P._T)(_o,["position","content"]),fa=Bi;(0,b.mf)(Bi)&&(fa=Bi(wa)),_=(0,P.pi)((0,P.pi)((0,P.pi)({},G),Vt),{content:fa})}else if(t==="dataMarker"){var Ui=i,Ji=Ui.position,Fa=Ui.point,xo=Ui.line,Mo=Ui.text,ao=Ui.autoAdjust,Io=Ui.direction,Vt=(0,P._T)(Ui,["position","point","line","text","autoAdjust","direction"]);_=(0,P.pi)((0,P.pi)((0,P.pi)({},Vt),G),{coordinateBBox:this.getCoordinateBBox(),point:Fa,line:xo,text:Mo,autoAdjust:ao,direction:Io})}else if(t==="dataRegion"){var hs=i,tl=hs.start,pl=hs.end,pd=hs.region,Mo=hs.text,iv=hs.lineLength,Vt=(0,P._T)(hs,["start","end","region","text","lineLength"]);_=(0,P.pi)((0,P.pi)({},Vt),{points:this.getRegionPoints(tl,pl),region:pd,text:Mo,lineLength:iv})}else if(t==="regionFilter"){var jh=i,Dg=jh.start,Bg=jh.end,qA=jh.apply,OP=jh.color,Vt=(0,P._T)(jh,["start","end","apply","color"]),KA=this.view.geometries,Qb=[],Jb=function(dd){!dd||(dd.isGroup()?dd.getChildren().forEach(function(Dm){return Jb(Dm)}):Qb.push(dd))};(0,b.S6)(KA,function(dd){qA?(0,b.FX)(qA,dd.type)&&(0,b.S6)(dd.elements,function(Dm){Jb(Dm.shape)}):(0,b.S6)(dd.elements,function(Dm){Jb(Dm.shape)})}),_=(0,P.pi)((0,P.pi)({},Vt),{color:OP,shapes:Qb,start:R,end:U})}else if(t==="shape"){var QA=i,FP=QA.render,D_=(0,P._T)(QA,["render"]),JA=function(DP){if((0,b.mf)(i.render))return FP(DP,c.view,{parsePosition:c.parsePosition.bind(c)})};_=(0,P.pi)((0,P.pi)({},D_),{render:JA})}else if(t==="html"){var B_=i,tT=B_.html,BR=B_.position,D_=(0,P._T)(B_,["html","position"]),RP=function(dd){return(0,b.mf)(tT)?tT(dd,c.view):tT};_=(0,P.pi)((0,P.pi)((0,P.pi)({},D_),G),{parent:g.get("el").parentNode,html:RP})}var Kv=(0,b.b$)({},u,(0,P.pi)((0,P.pi)({},_),{top:i.top,style:i.style,offsetX:i.offsetX,offsetY:i.offsetY}));return t!=="html"&&(Kv.container=this.getComponentContainer(Kv)),Kv.animate=this.view.getOptions().animate&&Kv.animate&&(0,b.U2)(i,"animate",Kv.animate),Kv.animateOption=(0,b.b$)({},xa,Kv.animateOption,i.animateOption),Kv},e.prototype.isTop=function(t){return(0,b.U2)(t,"top",!0)},e.prototype.getComponentContainer=function(t){return this.isTop(t)?this.foregroundContainer:this.backgroundContainer},e.prototype.getAnnotationTheme=function(t){return(0,b.U2)(this.view.getTheme(),["components","annotation",t],{})},e.prototype.updateOrCreate=function(t){var i=this.cache.get(this.getCacheKey(t));if(i){var u=t.type,c=this.getAnnotationTheme(u),p=this.getAnnotationCfg(u,t,c);p&&ic(p,["container"]),i.component.update((0,P.pi)((0,P.pi)({},p||{}),{visible:!!p})),(0,b.q9)(I1,t.type)&&i.component.render()}else i=this.createAnnotation(t),i&&(i.component.init(),(0,b.q9)(I1,t.type)&&i.component.render());return i},e.prototype.syncCache=function(t){var i=this,u=new Map(this.cache);return t.forEach(function(c,p){u.set(p,c)}),u.forEach(function(c,p){(0,b.sE)(i.option,function(g){return p===i.getCacheKey(g)})||(c.component.destroy(),u.delete(p))}),u},e.prototype.getCacheKey=function(t){return t},e}(ni),i3=n3;function a3(r,e){var t=(0,b.b$)({},(0,b.U2)(r,["components","axis","common"]),(0,b.U2)(r,["components","axis",e]));return(0,b.U2)(t,["grid"],{})}function yy(r,e,t,i){var u=[],c=e.getTicks();return r.isPolar&&c.push({value:1,text:"",tickValue:""}),c.reduce(function(p,g,_){var w=g.value;if(i)u.push({points:[r.convert(t==="y"?{x:0,y:w}:{x:w,y:0}),r.convert(t==="y"?{x:1,y:w}:{x:w,y:1})]});else if(_){var k=p.value,L=(k+w)/2;u.push({points:[r.convert(t==="y"?{x:0,y:L}:{x:L,y:0}),r.convert(t==="y"?{x:1,y:L}:{x:L,y:1})]})}return g},c[0]),u}function k1(r,e,t,i,u){var c=e.values.length,p=[],g=t.getTicks();return g.reduce(function(_,w){var k=_?_.value:w.value,L=w.value,R=(k+L)/2;return u==="x"?p.push({points:[r.convert({x:i?L:R,y:0}),r.convert({x:i?L:R,y:1})]}):p.push({points:(0,b.UI)(Array(c+1),function(U,G){return r.convert({x:G/c,y:i?L:R})})}),w},g[0]),p}function o3(r,e){var t=(0,b.U2)(e,"grid");if(t===null)return!1;var i=(0,b.U2)(r,"grid");return!(t===void 0&&i===null)}var Dv=["container"],BE=(0,P.pi)((0,P.pi)({},xa),{appear:null}),s3=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.cache=new Map,i.gridContainer=i.view.getLayer(W.BG).addGroup(),i.gridForeContainer=i.view.getLayer(W.FORE).addGroup(),i.axisContainer=i.view.getLayer(W.BG).addGroup(),i.axisForeContainer=i.view.getLayer(W.FORE).addGroup(),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"axis"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.render=function(){this.update()},e.prototype.layout=function(){var t=this,i=this.view.getCoordinate();(0,b.S6)(this.getComponents(),function(u){var c=u.component,p=u.direction,g=u.type,_=u.extra,w=_.dim,k=_.scale,L=_.alignTick,R;if(g===Ee.AXIS)i.isPolar?w==="x"?R=i.isTransposed?ii(i,p):dn(i):w==="y"&&(R=i.isTransposed?dn(i):ii(i,p)):R=ii(i,p);else if(g===Ee.GRID)if(i.isPolar){var U=void 0;i.isTransposed?U=w==="x"?k1(i,t.view.getYScales()[0],k,L,w):yy(i,k,w,L):U=w==="x"?yy(i,k,w,L):k1(i,t.view.getXScale(),k,L,w),R={items:U,center:t.view.getCoordinate().getCenter()}}else R={items:yy(i,k,w,L)};c.update(R)})},e.prototype.update=function(){this.option=this.view.getOptions().axes;var t=new Map;this.updateXAxes(t),this.updateYAxes(t);var i=new Map;this.cache.forEach(function(u,c){t.has(c)?i.set(c,u):u.component.destroy()}),this.cache=i},e.prototype.clear=function(){r.prototype.clear.call(this),this.cache.clear(),this.gridContainer.clear(),this.gridForeContainer.clear(),this.axisContainer.clear(),this.axisForeContainer.clear()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.gridContainer.remove(!0),this.gridForeContainer.remove(!0),this.axisContainer.remove(!0),this.axisForeContainer.remove(!0)},e.prototype.getComponents=function(){var t=[];return this.cache.forEach(function(i){t.push(i)}),t},e.prototype.updateXAxes=function(t){var i=this.view.getXScale();if(!(!i||i.isIdentity)){var u=Xn(this.option,i.field);if(u!==!1){var c=vi(u,fe.BOTTOM),p=W.BG,g="x",_=this.view.getCoordinate(),w=this.getId("axis",i.field),k=this.getId("grid",i.field);if(_.isRect){var L=this.cache.get(w);if(L){var R=this.getLineAxisCfg(i,u,c);ic(R,Dv),L.component.update(R),t.set(w,L)}else L=this.createLineAxis(i,u,p,c,g),this.cache.set(w,L),t.set(w,L);var U=this.cache.get(k);if(U){var R=this.getLineGridCfg(i,u,c,g);ic(R,Dv),U.component.update(R),t.set(k,U)}else U=this.createLineGrid(i,u,p,c,g),U&&(this.cache.set(k,U),t.set(k,U))}else if(_.isPolar){var L=this.cache.get(w);if(L){var R=_.isTransposed?this.getLineAxisCfg(i,u,fe.RADIUS):this.getCircleAxisCfg(i,u,c);ic(R,Dv),L.component.update(R),t.set(w,L)}else{if(_.isTransposed){if((0,b.o8)(u))return;L=this.createLineAxis(i,u,p,fe.RADIUS,g)}else L=this.createCircleAxis(i,u,p,c,g);this.cache.set(w,L),t.set(w,L)}var U=this.cache.get(k);if(U){var R=_.isTransposed?this.getCircleGridCfg(i,u,fe.RADIUS,g):this.getLineGridCfg(i,u,fe.CIRCLE,g);ic(R,Dv),U.component.update(R),t.set(k,U)}else{if(_.isTransposed){if((0,b.o8)(u))return;U=this.createCircleGrid(i,u,p,fe.RADIUS,g)}else U=this.createLineGrid(i,u,p,fe.CIRCLE,g);U&&(this.cache.set(k,U),t.set(k,U))}}}}},e.prototype.updateYAxes=function(t){var i=this,u=this.view.getYScales();(0,b.S6)(u,function(c,p){if(!(!c||c.isIdentity)){var g=c.field,_=Xn(i.option,g);if(_!==!1){var w=W.BG,k="y",L=i.getId("axis",g),R=i.getId("grid",g),U=i.view.getCoordinate();if(U.isRect){var G=vi(_,p===0?fe.LEFT:fe.RIGHT),Q=i.cache.get(L);if(Q){var pt=i.getLineAxisCfg(c,_,G);ic(pt,Dv),Q.component.update(pt),t.set(L,Q)}else Q=i.createLineAxis(c,_,w,G,k),i.cache.set(L,Q),t.set(L,Q);var vt=i.cache.get(R);if(vt){var pt=i.getLineGridCfg(c,_,G,k);ic(pt,Dv),vt.component.update(pt),t.set(R,vt)}else vt=i.createLineGrid(c,_,w,G,k),vt&&(i.cache.set(R,vt),t.set(R,vt))}else if(U.isPolar){var Q=i.cache.get(L);if(Q){var pt=U.isTransposed?i.getCircleAxisCfg(c,_,fe.CIRCLE):i.getLineAxisCfg(c,_,fe.RADIUS);ic(pt,Dv),Q.component.update(pt),t.set(L,Q)}else{if(U.isTransposed){if((0,b.o8)(_))return;Q=i.createCircleAxis(c,_,w,fe.CIRCLE,k)}else Q=i.createLineAxis(c,_,w,fe.RADIUS,k);i.cache.set(L,Q),t.set(L,Q)}var vt=i.cache.get(R);if(vt){var pt=U.isTransposed?i.getLineGridCfg(c,_,fe.CIRCLE,k):i.getCircleGridCfg(c,_,fe.RADIUS,k);ic(pt,Dv),vt.component.update(pt),t.set(R,vt)}else{if(U.isTransposed){if((0,b.o8)(_))return;vt=i.createLineGrid(c,_,w,fe.CIRCLE,k)}else vt=i.createCircleGrid(c,_,w,fe.RADIUS,k);vt&&(i.cache.set(R,vt),t.set(R,vt))}}}}})},e.prototype.createLineAxis=function(t,i,u,c,p){var g={component:new nc(this.getLineAxisCfg(t,i,c)),layer:u,direction:c===fe.RADIUS?fe.NONE:c,type:Ee.AXIS,extra:{dim:p,scale:t}};return g.component.set("field",t.field),g.component.init(),g},e.prototype.createLineGrid=function(t,i,u,c,p){var g=this.getLineGridCfg(t,i,c,p);if(g){var _={component:new Ch(g),layer:u,direction:fe.NONE,type:Ee.GRID,extra:{dim:p,scale:t,alignTick:(0,b.U2)(g,"alignTick",!0)}};return _.component.init(),_}},e.prototype.createCircleAxis=function(t,i,u,c,p){var g={component:new Rd(this.getCircleAxisCfg(t,i,c)),layer:u,direction:c,type:Ee.AXIS,extra:{dim:p,scale:t}};return g.component.set("field",t.field),g.component.init(),g},e.prototype.createCircleGrid=function(t,i,u,c,p){var g=this.getCircleGridCfg(t,i,c,p);if(g){var _={component:new Ah(g),layer:u,direction:fe.NONE,type:Ee.GRID,extra:{dim:p,scale:t,alignTick:(0,b.U2)(g,"alignTick",!0)}};return _.component.init(),_}},e.prototype.getLineAxisCfg=function(t,i,u){var c=(0,b.U2)(i,["top"])?this.axisForeContainer:this.axisContainer,p=this.view.getCoordinate(),g=ii(p,u),_=Rn(t,i),w=ri(this.view.getTheme(),u),k=(0,b.U2)(i,["title"])?(0,b.b$)({title:{style:{text:_}}},{title:Gr(this.view.getTheme(),u,i.title)},i):i,L=(0,b.b$)((0,P.pi)((0,P.pi)({container:c},g),{ticks:t.getTicks().map(function(le){return{id:"".concat(le.tickValue),name:le.text,value:le.value}}),verticalFactor:p.isPolar?qn(g,p.getCenter())*-1:qn(g,p.getCenter()),theme:w}),w,k),R=this.getAnimateCfg(L),U=R.animate,G=R.animateOption;L.animateOption=G,L.animate=U;var Q=yi(g),pt=(0,b.U2)(L,"verticalLimitLength",Q?1/3:1/2);if(pt<=1){var vt=this.view.getCanvas().get("width"),Vt=this.view.getCanvas().get("height");L.verticalLimitLength=pt*(Q?vt:Vt)}return L},e.prototype.getLineGridCfg=function(t,i,u,c){if(!!o3(ri(this.view.getTheme(),u),i)){var p=a3(this.view.getTheme(),u),g=(0,b.b$)({container:(0,b.U2)(i,["top"])?this.gridForeContainer:this.gridContainer},p,(0,b.U2)(i,"grid"),this.getAnimateCfg(i));return g.items=yy(this.view.getCoordinate(),t,c,(0,b.U2)(g,"alignTick",!0)),g}},e.prototype.getCircleAxisCfg=function(t,i,u){var c=(0,b.U2)(i,["top"])?this.axisForeContainer:this.axisContainer,p=this.view.getCoordinate(),g=t.getTicks().map(function(Q){return{id:"".concat(Q.tickValue),name:Q.text,value:Q.value}});!t.isCategory&&Math.abs(p.endAngle-p.startAngle)===Math.PI*2&&g.pop();var _=Rn(t,i),w=ri(this.view.getTheme(),fe.CIRCLE),k=(0,b.U2)(i,["title"])?(0,b.b$)({title:{style:{text:_}}},{title:Gr(this.view.getTheme(),u,i.title)},i):i,L=(0,b.b$)((0,P.pi)((0,P.pi)({container:c},dn(this.view.getCoordinate())),{ticks:g,verticalFactor:1,theme:w}),w,k),R=this.getAnimateCfg(L),U=R.animate,G=R.animateOption;return L.animate=U,L.animateOption=G,L},e.prototype.getCircleGridCfg=function(t,i,u,c){if(!!o3(ri(this.view.getTheme(),u),i)){var p=a3(this.view.getTheme(),fe.RADIUS),g=(0,b.b$)({container:(0,b.U2)(i,["top"])?this.gridForeContainer:this.gridContainer,center:this.view.getCoordinate().getCenter()},p,(0,b.U2)(i,"grid"),this.getAnimateCfg(i)),_=(0,b.U2)(g,"alignTick",!0),w=c==="x"?this.view.getYScales()[0]:this.view.getXScale();return g.items=k1(this.view.getCoordinate(),w,t,_,c),g}},e.prototype.getId=function(t,i){var u=this.view.getCoordinate();return"".concat(t,"-").concat(i,"-").concat(u.type)},e.prototype.getAnimateCfg=function(t){return{animate:this.view.getOptions().animate&&(0,b.U2)(t,"animate"),animateOption:t&&t.animateOption?(0,b.b$)({},BE,t.animateOption):BE}},e}(ni),u3=s3;function Bv(r,e,t){return t===fe.TOP?[r.minX+r.width/2-e.width/2,r.minY]:t===fe.BOTTOM?[r.minX+r.width/2-e.width/2,r.maxY-e.height]:t===fe.LEFT?[r.minX,r.minY+r.height/2-e.height/2]:t===fe.RIGHT?[r.maxX-e.width,r.minY+r.height/2-e.height/2]:t===fe.TOP_LEFT||t===fe.LEFT_TOP?[r.tl.x,r.tl.y]:t===fe.TOP_RIGHT||t===fe.RIGHT_TOP?[r.tr.x-e.width,r.tr.y]:t===fe.BOTTOM_LEFT||t===fe.LEFT_BOTTOM?[r.bl.x,r.bl.y-e.height]:t===fe.BOTTOM_RIGHT||t===fe.RIGHT_BOTTOM?[r.br.x-e.width,r.br.y-e.height]:[0,0]}function l3(r,e){if(e.isTransposed)switch(r){case DIRECTION.BOTTOM:return DIRECTION.LEFT;case DIRECTION.LEFT:return DIRECTION.BOTTOM;case DIRECTION.RIGHT:return DIRECTION.TOP;case DIRECTION.TOP:return DIRECTION.RIGHT}return r}function NE(r){return r===DIRECTION.LEFT?DIRECTION.RIGHT:r===DIRECTION.RIGHT?DIRECTION.LEFT:r}function zE(r){return r===DIRECTION.TOP?DIRECTION.BOTTOM:r===DIRECTION.BOTTOM?DIRECTION.TOP:r}function c3(r,e){var t=e.matrix[0],i=e.matrix[4],u=r;return t<0&&(u=NE(u)),i<0&&(u=zE(u)),u}function f3(r,e){var t=r;return e.isReflect("x")&&(t=NE(t)),e.isReflect("y")&&(t=zE(t)),t}function FO(r,e){var t=r;return t=l3(t,e),t=c3(t,e),t=f3(t,e),t}function h3(r,e){return(0,b.jn)(r)?r===!1?!1:{}:(0,b.U2)(r,[e],r)}function _y(r){return(0,b.U2)(r,"position",fe.BOTTOM)}var UE=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.container=i.view.getLayer(W.FORE).addGroup(),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"legend"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.render=function(){this.update()},e.prototype.layout=function(){var t=this;this.layoutBBox=this.view.viewBBox,(0,b.S6)(this.components,function(i){var u=i.component,c=i.direction,p=Ud(c),g=u.get("maxWidthRatio"),_=u.get("maxHeightRatio"),w=t.getCategoryLegendSizeCfg(p,g,_),k=u.get("maxWidth"),L=u.get("maxHeight");u.update({maxWidth:Math.min(w.maxWidth,k||0),maxHeight:Math.min(w.maxHeight,L||0)});var R=u.get("padding"),U=u.getLayoutBBox(),G=new Nu(U.x,U.y,U.width,U.height).expand(R),Q=(0,P.CR)(Bv(t.view.viewBBox,G,c),2),pt=Q[0],vt=Q[1],Vt=(0,P.CR)(Bv(t.layoutBBox,G,c),2),le=Vt[0],he=Vt[1],Ne=0,Er=0;c.startsWith("top")||c.startsWith("bottom")?(Ne=pt,Er=he):(Ne=le,Er=vt),u.setLocation({x:Ne+R[3],y:Er+R[0]}),t.layoutBBox=t.layoutBBox.cut(G,c)})},e.prototype.update=function(){var t=this;this.option=this.view.getOptions().legends;var i={},u=function(R,U,G){var Q=t.getId(G.field),pt=t.getComponentById(Q);if(pt){var vt=void 0,Vt=h3(t.option,G.field);Vt!==!1&&((0,b.U2)(Vt,"custom")?vt=t.getCategoryCfg(R,U,G,Vt,!0):G.isLinear?vt=t.getContinuousCfg(R,U,G,Vt):G.isCategory&&(vt=t.getCategoryCfg(R,U,G,Vt))),vt&&(ic(vt,["container"]),pt.direction=_y(Vt),pt.component.update(vt),i[Q]=!0)}else{var le=t.createFieldLegend(R,U,G);le&&(le.component.init(),t.components.push(le),i[Q]=!0)}};if((0,b.U2)(this.option,"custom")){var c="global-custom",p=this.getComponentById(c);if(p){var g=this.getCategoryCfg(void 0,void 0,void 0,this.option,!0);ic(g,["container"]),p.component.update(g),i[c]=!0}else{var _=this.createCustomLegend(void 0,void 0,void 0,this.option);if(_){_.init();var w=W.FORE,k=_y(this.option);this.components.push({id:c,component:_,layer:w,direction:k,type:Ee.LEGEND,extra:void 0}),i[c]=!0}}}else this.loopLegends(u);var L=[];(0,b.S6)(this.getComponents(),function(R){i[R.id]?L.push(R):R.component.destroy()}),this.components=L},e.prototype.clear=function(){r.prototype.clear.call(this),this.container.clear()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.container.remove(!0)},e.prototype.getGeometries=function(t){var i=this,u=t.geometries;return(0,b.S6)(t.views,function(c){u=u.concat(i.getGeometries(c))}),u},e.prototype.loopLegends=function(t){var i=this.view.getRootView()===this.view;if(!!i){var u=this.getGeometries(this.view),c={};(0,b.S6)(u,function(p){var g=p.getGroupAttributes();(0,b.S6)(g,function(_){var w=_.getScale(_.type);!w||w.type==="identity"||c[w.field]||(t(p,_,w),c[w.field]=!0)})})}},e.prototype.createFieldLegend=function(t,i,u){var c,p=h3(this.option,u.field),g=W.FORE,_=_y(p);if(p!==!1&&((0,b.U2)(p,"custom")?c=this.createCustomLegend(t,i,u,p):u.isLinear?c=this.createContinuousLegend(t,i,u,p):u.isCategory&&(c=this.createCategoryLegend(t,i,u,p))),c)return c.set("field",u.field),{id:this.getId(u.field),component:c,layer:g,direction:_,type:Ee.LEGEND,extra:{scale:u}}},e.prototype.createCustomLegend=function(t,i,u,c){var p=this.getCategoryCfg(t,i,u,c,!0);return new e0(p)},e.prototype.createContinuousLegend=function(t,i,u,c){var p=this.getContinuousCfg(t,i,u,ic(c,["value"]));return new r0(p)},e.prototype.createCategoryLegend=function(t,i,u,c){var p=this.getCategoryCfg(t,i,u,c);return new e0(p)},e.prototype.getContinuousCfg=function(t,i,u,c){var p=u.getTicks(),g=(0,b.sE)(p,function(Q){return Q.value===0}),_=(0,b.sE)(p,function(Q){return Q.value===1}),w=p.map(function(Q){var pt=Q.value,vt=Q.tickValue,Vt=i.mapping(u.invert(pt)).join("");return{value:vt,attrValue:Vt,color:Vt,scaleValue:pt}});g||w.push({value:u.min,attrValue:i.mapping(u.invert(0)).join(""),color:i.mapping(u.invert(0)).join(""),scaleValue:0}),_||w.push({value:u.max,attrValue:i.mapping(u.invert(1)).join(""),color:i.mapping(u.invert(1)).join(""),scaleValue:1}),w.sort(function(Q,pt){return Q.value-pt.value});var k={min:(0,b.YM)(w).value,max:(0,b.Z$)(w).value,colors:[],rail:{type:i.type},track:{}};i.type==="size"&&(k.track={style:{fill:i.type==="size"?this.view.getTheme().defaultColor:void 0}}),i.type==="color"&&(k.colors=w.map(function(Q){return Q.attrValue}));var L=this.container,R=_y(c),U=Ud(R),G=(0,b.U2)(c,"title");return G&&(G=(0,b.b$)({text:on(u)},G)),k.container=L,k.layout=U,k.title=G,k.animateOption=xa,this.mergeLegendCfg(k,c,"continuous")},e.prototype.getCategoryCfg=function(t,i,u,c,p){var g=this.container,_=(0,b.U2)(c,"position",fe.BOTTOM),w=bv(this.view.getTheme(),_),k=(0,b.U2)(w,["marker"]),L=(0,b.U2)(c,"marker"),R=Ud(_),U=(0,b.U2)(w,["pageNavigator"]),G=(0,b.U2)(c,"pageNavigator"),Q=p?xv(k,L,c.items):Zd(this.view,t,i,k,L),pt=(0,b.U2)(c,"title");pt&&(pt=(0,b.b$)({text:u?on(u):""},pt));var vt=(0,b.U2)(c,"maxWidthRatio"),Vt=(0,b.U2)(c,"maxHeightRatio"),le=this.getCategoryLegendSizeCfg(R,vt,Vt);le.container=g,le.layout=R,le.items=Q,le.title=pt,le.animateOption=xa,le.pageNavigator=(0,b.b$)({},U,G);var he=this.mergeLegendCfg(le,c,_);he.reversed&&he.items.reverse();var Ne=(0,b.U2)(he,"maxItemWidth");return Ne&&Ne<=1&&(he.maxItemWidth=this.view.viewBBox.width*Ne),he},e.prototype.mergeLegendCfg=function(t,i,u){var c=u.split("-")[0],p=bv(this.view.getTheme(),c);return(0,b.b$)({},p,t,i)},e.prototype.getId=function(t){return"".concat(this.name,"-").concat(t)},e.prototype.getComponentById=function(t){return(0,b.sE)(this.components,function(i){return i.id===t})},e.prototype.getCategoryLegendSizeCfg=function(t,i,u){i===void 0&&(i=Ye),u===void 0&&(u=Ye);var c=this.view.viewBBox,p=c.width,g=c.height;return t==="vertical"?{maxWidth:p*i,maxHeight:g}:{maxWidth:p,maxHeight:g*u}},e}(ni),ZE=UE,VE=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.onChangeFn=b.ZT,i.resetMeasure=function(){i.clear()},i.onValueChange=function(u){var c=(0,P.CR)(u,2),p=c[0],g=c[1];i.start=p,i.end=g,i.changeViewData(p,g)},i.container=i.view.getLayer(W.FORE).addGroup(),i.onChangeFn=(0,b.P2)(i.onValueChange,20,{leading:!0}),i.width=0,i.view.on(Mt.BEFORE_CHANGE_DATA,i.resetMeasure),i.view.on(Mt.BEFORE_CHANGE_SIZE,i.resetMeasure),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"slider"},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.view.off(Mt.BEFORE_CHANGE_DATA,this.resetMeasure),this.view.off(Mt.BEFORE_CHANGE_SIZE,this.resetMeasure)},e.prototype.init=function(){},e.prototype.render=function(){this.option=this.view.getOptions().slider;var t=this.getSliderCfg(),i=t.start,u=t.end;(0,b.UM)(this.start)&&(this.start=i,this.end=u);var c=this.view.getOptions().data;this.option&&!(0,b.xb)(c)?this.slider?this.slider=this.updateSlider():(this.slider=this.createSlider(),this.slider.component.on("sliderchange",this.onChangeFn)):this.slider&&(this.slider.component.destroy(),this.slider=void 0)},e.prototype.layout=function(){var t=this;if(this.option&&!this.width&&(this.measureSlider(),setTimeout(function(){t.view.destroyed||t.changeViewData(t.start,t.end)},0)),this.slider){var i=this.view.coordinateBBox.width,u=this.slider.component.get("padding"),c=(0,P.CR)(u,4),p=c[0],g=c[1],_=c[2],w=c[3],k=this.slider.component.getLayoutBBox(),L=new Nu(k.x,k.y,Math.min(k.width,i),k.height).expand(u),R=this.getMinMaxText(this.start,this.end),U=R.minText,G=R.maxText,Q=(0,P.CR)(Bv(this.view.viewBBox,L,fe.BOTTOM),2),pt=Q[0],vt=Q[1],Vt=(0,P.CR)(Bv(this.view.coordinateBBox,L,fe.BOTTOM),2),le=Vt[0],he=Vt[1];this.slider.component.update((0,P.pi)((0,P.pi)({},this.getSliderCfg()),{x:le+w,y:vt+p,width:this.width,start:this.start,end:this.end,minText:U,maxText:G})),this.view.viewBBox=this.view.viewBBox.cut(L,fe.BOTTOM)}},e.prototype.update=function(){this.render()},e.prototype.createSlider=function(){var t=this.getSliderCfg(),i=new Od((0,P.pi)({container:this.container},t));return i.init(),{component:i,layer:W.FORE,direction:fe.BOTTOM,type:Ee.SLIDER}},e.prototype.updateSlider=function(){var t=this.getSliderCfg();if(this.width){var i=this.getMinMaxText(this.start,this.end),u=i.minText,c=i.maxText;t=(0,P.pi)((0,P.pi)({},t),{width:this.width,start:this.start,end:this.end,minText:u,maxText:c})}return this.slider.component.update(t),this.slider},e.prototype.measureSlider=function(){var t=this.getSliderCfg().width;this.width=t},e.prototype.getSliderCfg=function(){var t={height:16,start:0,end:1,minText:"",maxText:"",x:0,y:0,width:this.view.coordinateBBox.width};if((0,b.Kn)(this.option)){var i=(0,P.pi)({data:this.getData()},(0,b.U2)(this.option,"trendCfg",{}));t=(0,b.b$)({},t,this.getThemeOptions(),this.option),t=(0,P.pi)((0,P.pi)({},t),{trendCfg:i})}return t.start=(0,b.uZ)(Math.min((0,b.UM)(t.start)?0:t.start,(0,b.UM)(t.end)?1:t.end),0,1),t.end=(0,b.uZ)(Math.max((0,b.UM)(t.start)?0:t.start,(0,b.UM)(t.end)?1:t.end),0,1),t},e.prototype.getData=function(){var t=this.view.getOptions().data,i=(0,P.CR)(this.view.getYScales(),1),u=i[0],c=this.view.getGroupScales();if(c.length){var p=c[0],g=p.field,_=p.ticks;return t.reduce(function(w,k){return k[g]===_[0]&&w.push(k[u.field]),w},[])}return t.map(function(w){return w[u.field]||0})},e.prototype.getThemeOptions=function(){var t=this.view.getTheme();return(0,b.U2)(t,["components","slider","common"],{})},e.prototype.getMinMaxText=function(t,i){var u=this.view.getOptions().data,c=this.view.getXScale(),p=!0,g=(0,b.I)(u,c.field);c.isLinear&&(g=g.sort());var _=p?g:g.reverse(),w=(0,b.dp)(u);if(!c||!w)return{};var k=(0,b.dp)(_),L=Math.round(t*(k-1)),R=Math.round(i*(k-1)),U=(0,b.U2)(_,[L]),G=(0,b.U2)(_,[R]),Q=this.getSliderCfg().formatter;return Q&&(U=Q(U,u[L],L),G=Q(G,u[R],R)),{minText:U,maxText:G}},e.prototype.changeViewData=function(t,i){var u=this.view.getOptions().data,c=this.view.getXScale(),p=(0,b.dp)(u);if(!(!c||!p)){var g=!0,_=(0,b.I)(u,c.field),w=this.view.getXScale().isLinear?_.sort(function(G,Q){return Number(G)-Number(Q)}):_,k=g?w:w.reverse(),L=(0,b.dp)(k),R=Math.round(t*(L-1)),U=Math.round(i*(L-1));this.view.filter(c.field,function(G,Q){var pt=k.indexOf(G);return pt>-1?Yp(pt,R,U):!0}),this.view.render(!0)}},e.prototype.getComponents=function(){return this.slider?[this.slider]:[]},e.prototype.clear=function(){this.slider&&(this.slider.component.destroy(),this.slider=void 0),this.width=0,this.start=void 0,this.end=void 0},e}(ni),nd=VE,xy=0,g0=8,GE=32,L1=20,P1=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.onChangeFn=b.ZT,i.resetMeasure=function(){i.clear()},i.onValueChange=function(u){var c=u.ratio,p=i.getValidScrollbarCfg().animate;i.ratio=(0,b.uZ)(c,0,1);var g=i.view.getOptions().animate;p||i.view.animate(!1),i.changeViewData(i.getScrollRange(),!0),i.view.animate(g)},i.container=i.view.getLayer(W.FORE).addGroup(),i.onChangeFn=(0,b.P2)(i.onValueChange,20,{leading:!0}),i.trackLen=0,i.thumbLen=0,i.ratio=0,i.view.on(Mt.BEFORE_CHANGE_DATA,i.resetMeasure),i.view.on(Mt.BEFORE_CHANGE_SIZE,i.resetMeasure),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"scrollbar"},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.view.off(Mt.BEFORE_CHANGE_DATA,this.resetMeasure),this.view.off(Mt.BEFORE_CHANGE_SIZE,this.resetMeasure)},e.prototype.init=function(){},e.prototype.render=function(){this.option=this.view.getOptions().scrollbar,this.option?this.scrollbar?this.scrollbar=this.updateScrollbar():(this.scrollbar=this.createScrollbar(),this.scrollbar.component.on("scrollchange",this.onChangeFn)):this.scrollbar&&(this.scrollbar.component.destroy(),this.scrollbar=void 0)},e.prototype.layout=function(){var t=this;if(this.option&&!this.trackLen&&(this.measureScrollbar(),setTimeout(function(){t.view.destroyed||t.changeViewData(t.getScrollRange(),!0)})),this.scrollbar){var i=this.view.coordinateBBox.width,u=this.scrollbar.component.get("padding"),c=this.scrollbar.component.getLayoutBBox(),p=new Nu(c.x,c.y,Math.min(c.width,i),c.height).expand(u),g=this.getScrollbarComponentCfg(),_=void 0,w=void 0;if(g.isHorizontal){var k=(0,P.CR)(Bv(this.view.viewBBox,p,fe.BOTTOM),2),L=k[0],R=k[1],U=(0,P.CR)(Bv(this.view.coordinateBBox,p,fe.BOTTOM),2),G=U[0],Q=U[1];_=G,w=R}else{var pt=(0,P.CR)(Bv(this.view.viewBBox,p,fe.RIGHT),2),L=pt[0],R=pt[1],vt=(0,P.CR)(Bv(this.view.viewBBox,p,fe.RIGHT),2),G=vt[0],Q=vt[1];_=G,w=R}_+=u[3],w+=u[0],this.trackLen?this.scrollbar.component.update((0,P.pi)((0,P.pi)({},g),{x:_,y:w,trackLen:this.trackLen,thumbLen:this.thumbLen,thumbOffset:(this.trackLen-this.thumbLen)*this.ratio})):this.scrollbar.component.update((0,P.pi)((0,P.pi)({},g),{x:_,y:w})),this.view.viewBBox=this.view.viewBBox.cut(p,g.isHorizontal?fe.BOTTOM:fe.RIGHT)}},e.prototype.update=function(){this.render()},e.prototype.getComponents=function(){return this.scrollbar?[this.scrollbar]:[]},e.prototype.clear=function(){this.scrollbar&&(this.scrollbar.component.destroy(),this.scrollbar=void 0),this.trackLen=0,this.thumbLen=0,this.ratio=0,this.cnt=0,this.step=0,this.data=void 0,this.xScaleCfg=void 0,this.yScalesCfg=[]},e.prototype.setValue=function(t){this.onValueChange({ratio:t})},e.prototype.getValue=function(){return this.ratio},e.prototype.getThemeOptions=function(){var t=this.view.getTheme();return(0,b.U2)(t,["components","scrollbar","common"],{})},e.prototype.getScrollbarTheme=function(t){var i=(0,b.U2)(this.view.getTheme(),["components","scrollbar"]),u=t||{},c=u.thumbHighlightColor,p=(0,P._T)(u,["thumbHighlightColor"]);return{default:(0,b.b$)({},(0,b.U2)(i,["default","style"],{}),p),hover:(0,b.b$)({},(0,b.U2)(i,["hover","style"],{}),{thumbColor:c})}},e.prototype.measureScrollbar=function(){var t=this.view.getXScale(),i=this.view.getYScales().slice();this.data=this.getScrollbarData(),this.step=this.getStep(),this.cnt=this.getCnt();var u=this.getScrollbarComponentCfg(),c=u.trackLen,p=u.thumbLen;this.trackLen=c,this.thumbLen=p,this.xScaleCfg={field:t.field,values:t.values||[]},this.yScalesCfg=i},e.prototype.getScrollRange=function(){var t=Math.floor((this.cnt-this.step)*(0,b.uZ)(this.ratio,0,1)),i=Math.min(t+this.step-1,this.cnt-1);return[t,i]},e.prototype.changeViewData=function(t,i){var u=this,c=(0,P.CR)(t,2),p=c[0],g=c[1],_=this.getValidScrollbarCfg().type,w=_!=="vertical",k=(0,b.I)(this.data,this.xScaleCfg.field),L=this.view.getXScale().isLinear?k.sort(function(U,G){return Number(U)-Number(G)}):k,R=w?L:L.reverse();this.yScalesCfg.forEach(function(U){u.view.scale(U.field,{formatter:U.formatter,type:U.type,min:U.min,max:U.max,tickMethod:U.tickMethod})}),this.view.filter(this.xScaleCfg.field,function(U){var G=R.indexOf(U);return G>-1?Yp(G,p,g):!0}),this.view.render(!0)},e.prototype.createScrollbar=function(){var t=this.getValidScrollbarCfg().type,i=t!=="vertical",u=new t0((0,P.pi)((0,P.pi)({container:this.container},this.getScrollbarComponentCfg()),{x:0,y:0}));return u.init(),{component:u,layer:W.FORE,direction:i?fe.BOTTOM:fe.RIGHT,type:Ee.SCROLLBAR}},e.prototype.updateScrollbar=function(){var t=this.getScrollbarComponentCfg(),i=this.trackLen?(0,P.pi)((0,P.pi)({},t),{trackLen:this.trackLen,thumbLen:this.thumbLen,thumbOffset:(this.trackLen-this.thumbLen)*this.ratio}):(0,P.pi)({},t);return this.scrollbar.component.update(i),this.scrollbar},e.prototype.getStep=function(){if(this.step)return this.step;var t=this.view.coordinateBBox,i=this.getValidScrollbarCfg(),u=i.type,c=i.categorySize,p=u!=="vertical";return Math.floor((p?t.width:t.height)/c)},e.prototype.getCnt=function(){if(this.cnt)return this.cnt;var t=this.view.getXScale(),i=this.getScrollbarData(),u=(0,b.I)(i,t.field);return(0,b.dp)(u)},e.prototype.getScrollbarComponentCfg=function(){var t=this.view,i=t.coordinateBBox,u=t.viewBBox,c=this.getValidScrollbarCfg(),p=c.type,g=c.padding,_=c.width,w=c.height,k=c.style,L=p!=="vertical",R=(0,P.CR)(g,4),U=R[0],G=R[1],Q=R[2],pt=R[3],vt=L?{x:i.minX+pt,y:u.maxY-w-Q}:{x:u.maxX-_-G,y:i.minY+U},Vt=this.getStep(),le=this.getCnt(),he=L?i.width-pt-G:i.height-U-Q,Ne=Math.max(he*(0,b.uZ)(Vt/le,0,1),L1);return(0,P.pi)((0,P.pi)({},this.getThemeOptions()),{x:vt.x,y:vt.y,size:L?w:_,isHorizontal:L,trackLen:he,thumbLen:Ne,thumbOffset:0,theme:this.getScrollbarTheme(k)})},e.prototype.getValidScrollbarCfg=function(){var t={type:"horizontal",categorySize:GE,width:g0,height:g0,padding:[0,0,0,0],animate:!0,style:{}};return(0,b.Kn)(this.option)&&(t=(0,P.pi)((0,P.pi)({},t),this.option)),(!(0,b.Kn)(this.option)||!this.option.padding)&&(t.padding=t.type==="horizontal"?[xy,0,xy,0]:[0,xy,0,xy]),t},e.prototype.getScrollbarData=function(){var t=this.view.getCoordinate(),i=this.getValidScrollbarCfg(),u=this.view.getOptions().data||[];return t.isReflect("y")&&i.type==="vertical"&&(u=(0,P.ev)([],(0,P.CR)(u),!1).reverse()),u},e}(ni),nm=P1,O1={fill:"#CCD6EC",opacity:.3};function HE(r,e,t){var i,u,c,p,g,_,w=d(r,e,t);if(w.length){w=(0,b.xH)(w);try{for(var k=(0,P.XA)(w),L=k.next();!L.done;L=k.next()){var R=L.value;try{for(var U=(c=void 0,(0,P.XA)(R)),G=U.next();!G.done;G=U.next()){var Q=G.value,pt=Q.mappingData,vt=pt.x,Vt=pt.y;Q.x=(0,b.kJ)(vt)?vt[vt.length-1]:vt,Q.y=(0,b.kJ)(Vt)?Vt[Vt.length-1]:Vt}}catch(nn){c={error:nn}}finally{try{G&&!G.done&&(p=U.return)&&p.call(U)}finally{if(c)throw c.error}}}}catch(nn){i={error:nn}}finally{try{L&&!L.done&&(u=k.return)&&u.call(k)}finally{if(i)throw i.error}}var le=t.shared;if(le===!1&&w.length>1){var he=w[0],Ne=Math.abs(e.y-he[0].y);try{for(var Er=(0,P.XA)(w),Fr=Er.next();!Fr.done;Fr=Er.next()){var zr=Fr.value,pn=Math.abs(e.y-zr[0].y);pn<=Ne&&(he=zr,Ne=pn)}}catch(nn){g={error:nn}}finally{try{Fr&&!Fr.done&&(_=Er.return)&&_.call(Er)}finally{if(g)throw g.error}}w=[he]}return(0,b.jj)((0,b.xH)(w))}return[]}var p3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.show=function(t){var i=this.context.view,u=this.context.event,c=i.getController("tooltip").getTooltipCfg(),p=HE(i,{x:u.x,y:u.y},c);if(!(0,b.Xy)(p,this.items)&&(this.items=p,p.length)){var g=i.getXScale().field,_=p[0].data[g],w=[],k=i.geometries;if((0,b.S6)(k,function(fa){if(fa.type==="interval"||fa.type==="schema"){var Ui=fa.getElementsBy(function(Ji){var Fa=Ji.getData();return Fa[g]===_});w=w.concat(Ui)}}),w.length){var L=i.getCoordinate(),R=w[0].shape.getCanvasBBox(),U=w[0].shape.getCanvasBBox(),G=R;(0,b.S6)(w,function(fa){var Ui=fa.shape.getCanvasBBox();L.isTransposed?(Ui.minY<R.minY&&(R=Ui),Ui.maxY>U.maxY&&(U=Ui)):(Ui.minX<R.minX&&(R=Ui),Ui.maxX>U.maxX&&(U=Ui)),G.x=Math.min(Ui.minX,G.minX),G.y=Math.min(Ui.minY,G.minY),G.width=Math.max(Ui.maxX,G.maxX)-G.x,G.height=Math.max(Ui.maxY,G.maxY)-G.y});var Q=i.backgroundGroup,pt=i.coordinateBBox,vt=void 0;if(L.isRect){var Vt=i.getXScale(),le=t||{},he=le.appendRatio,Ne=le.appendWidth;(0,b.UM)(Ne)&&(he=(0,b.UM)(he)?Vt.isLinear?0:.25:he,Ne=L.isTransposed?he*U.height:he*R.width);var Er=void 0,Fr=void 0,zr=void 0,pn=void 0;L.isTransposed?(Er=pt.minX,Fr=Math.min(U.minY,R.minY)-Ne,zr=pt.width,pn=G.height+Ne*2):(Er=Math.min(R.minX,U.minX)-Ne,Fr=pt.minY,zr=G.width+Ne*2,pn=pt.height),vt=[["M",Er,Fr],["L",Er+zr,Fr],["L",Er+zr,Fr+pn],["L",Er,Fr+pn],["Z"]]}else{var nn=(0,b.YM)(w),Pn=(0,b.Z$)(w),Si=Xp(nn.getModel(),L).startAngle,ha=Xp(Pn.getModel(),L).endAngle,wa=L.getCenter(),_o=L.getRadius(),Vn=L.innerRadius*_o;vt=gu(wa.x,wa.y,_o,Si,ha,Vn)}if(this.regionPath)this.regionPath.attr("path",vt),this.regionPath.show();else{var Bi=(0,b.U2)(t,"style",O1);this.regionPath=Q.addShape({type:"path",name:"active-region",capture:!1,attrs:(0,P.pi)((0,P.pi)({},Bi),{path:vt})})}}}},e.prototype.hide=function(){this.regionPath&&this.regionPath.hide(),this.items=null},e.prototype.destroy=function(){this.hide(),this.regionPath&&this.regionPath.remove(!0),r.prototype.destroy.call(this)},e}(oi),jE=p3,Ff=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.timeStamp=0,t}return e.prototype.show=function(){var t=this.context,i=t.event,u=t.view,c=u.isTooltipLocked();if(!c){var p=this.timeStamp,g=+new Date,_=(0,b.U2)(t.view.getOptions(),"tooltip.showDelay",16);if(g-p>_){var w=this.location,k={x:i.x,y:i.y};(!w||!(0,b.Xy)(w,k))&&this.showTooltip(u,k),this.timeStamp=g,this.location=k}}},e.prototype.hide=function(){var t=this.context.view,i=t.getController("tooltip"),u=this.context.event,c=u.clientX,p=u.clientY;i.isCursorEntered({x:c,y:p})||t.isTooltipLocked()||(this.hideTooltip(t),this.location=null)},e.prototype.showTooltip=function(t,i){t.showTooltip(i)},e.prototype.hideTooltip=function(t){t.hideTooltip()},e}(oi),WE=Ff,v3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.showTooltip=function(t,i){var u=mr(t);(0,b.S6)(u,function(c){var p=kr(t,c,i);c.showTooltip(p)})},e.prototype.hideTooltip=function(t){var i=mr(t);(0,b.S6)(i,function(u){u.hideTooltip()})},e}(WE),g3=v3,m0=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.timeStamp=0,t}return e.prototype.destroy=function(){r.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},e.prototype.show=function(){var t=this.context,i=t.event,u=this.timeStamp,c=+new Date;if(c-u>16){var p=this.location,g={x:i.x,y:i.y};(!p||!(0,b.Xy)(p,g))&&this.showTooltip(g),this.timeStamp=c,this.location=g}},e.prototype.hide=function(){this.hideTooltip(),this.location=null},e.prototype.showTooltip=function(t){var i=this.context,u=i.event,c=u.target;if(c&&c.get("tip")){this.tooltip||this.renderTooltip();var p=c.get("tip");this.tooltip.update((0,P.pi)({title:p},t)),this.tooltip.show()}},e.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},e.prototype.renderTooltip=function(){var t,i=this.context.view,u=i.canvas,c={start:{x:0,y:0},end:{x:u.get("width"),y:u.get("height")}},p=i.getTheme(),g=(0,b.U2)(p,["components","tooltip","domStyles"],{}),_=new lp({parent:u.get("el").parentNode,region:c,visible:!1,crosshairs:null,domStyles:(0,P.pi)({},(0,b.b$)({},g,(t={},t[ef]={"max-width":"50%"},t[Cl]={"word-break":"break-all"},t)))});_.init(),_.setCapture(!1),this.tooltip=_},e}(oi),m3=m0,RO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="",t}return e.prototype.hasState=function(t){return t.hasState(this.stateName)},e.prototype.setElementState=function(t,i){t.setState(this.stateName,i)},e.prototype.setState=function(){this.setStateEnable(!0)},e.prototype.clear=function(){var t=this.context.view;this.clearViewState(t)},e.prototype.clearViewState=function(t){var i=this,u=Ke(t,this.stateName);(0,b.S6)(u,function(c){i.setElementState(c,!1)})},e}(oi),XE=RO;function y3(r){return(0,b.U2)(r.get("delegateObject"),"item")}var DO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.ignoreListItemStates=["unchecked"],t}return e.prototype.isItemIgnore=function(t,i){var u=this.ignoreListItemStates,c=u.filter(function(p){return i.hasState(t,p)});return!!c.length},e.prototype.setStateByComponent=function(t,i,u){var c=this.context.view,p=t.get("field"),g=So(c);this.setElementsStateByItem(g,p,i,u)},e.prototype.setStateByElement=function(t,i){this.setElementState(t,i)},e.prototype.isMathItem=function(t,i,u){var c=this.context.view,p=vr(c,i),g=an(t,i);return!(0,b.UM)(g)&&u.name===p.getText(g)},e.prototype.setElementsStateByItem=function(t,i,u,c){var p=this;(0,b.S6)(t,function(g){p.isMathItem(g,i,u)&&g.setState(p.stateName,c)})},e.prototype.setStateEnable=function(t){var i=Jo(this.context);if(i)tu(this.context)&&this.setStateByElement(i,t);else{var u=La(this.context);if(fo(u)){var c=u.item,p=u.component;if(c&&p&&!this.isItemIgnore(c,p)){var g=this.context.event.gEvent;if(g&&g.fromShape&&g.toShape&&y3(g.fromShape)===y3(g.toShape))return;this.setStateByComponent(p,c,t)}}}},e.prototype.toggle=function(){var t=Jo(this.context);if(t){var i=t.hasState(this.stateName);this.setElementState(t,!i)}},e.prototype.reset=function(){this.setStateEnable(!1)},e}(XE),YE=DO,BO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(YE),_3=BO,F1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.cache={},t}return e.prototype.getColorScale=function(t,i){var u=i.geometry.getAttribute("color");if(!u)return null;var c=t.getScaleByField(u.getFields()[0]);return c},e.prototype.getLinkPath=function(t,i){var u=this.context.view,c=u.getCoordinate().isTransposed,p=t.shape.getCanvasBBox(),g=i.shape.getCanvasBBox(),_=c?[["M",p.minX,p.minY],["L",g.minX,g.maxY],["L",g.maxX,g.maxY],["L",p.maxX,p.minY],["Z"]]:[["M",p.maxX,p.minY],["L",g.minX,g.minY],["L",g.minX,g.maxY],["L",p.maxX,p.maxY],["Z"]];return _},e.prototype.addLinkShape=function(t,i,u,c){var p={opacity:.4,fill:i.shape.attr("fill")};t.addShape({type:"path",attrs:(0,P.pi)((0,P.pi)({},(0,b.b$)({},p,(0,b.mf)(c)?c(p,i):c)),{path:this.getLinkPath(i,u)})})},e.prototype.linkByElement=function(t,i){var u=this,c=this.context.view,p=this.getColorScale(c,t);if(!!p){var g=an(t,p.field);if(!this.cache[g]){var _=Po(c,p.field,g),w=this.linkGroup,k=w.addGroup();this.cache[g]=k;var L=_.length;(0,b.S6)(_,function(R,U){if(U<L-1){var G=_[U+1];u.addLinkShape(k,R,G,i)}})}}},e.prototype.removeLink=function(t){var i=this.getColorScale(this.context.view,t);if(!!i){var u=an(t,i.field);this.cache[u]&&(this.cache[u].remove(),this.cache[u]=null)}},e.prototype.link=function(t){var i=this.context;this.linkGroup||(this.linkGroup=i.view.foregroundGroup.addGroup({id:"link-by-color-group",capture:!1}));var u=Jo(i);u&&this.linkByElement(u,t==null?void 0:t.style)},e.prototype.unlink=function(){var t=Jo(this.context);t&&this.removeLink(t)},e.prototype.clear=function(){this.linkGroup&&this.linkGroup.clear(),this.cache={}},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.linkGroup&&this.linkGroup.remove()},e}(oi),NO=F1,$E=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.startPoint=null,t.endPoint=null,t.isStarted=!1,t.effectSiblings=!1,t.effectByRecord=!1,t}return e.prototype.getCurrentPoint=function(){var t=this.context.event;return{x:t.x,y:t.y}},e.prototype.start=function(){this.clear(),this.startPoint=this.getCurrentPoint(),this.isStarted=!0},e.prototype.getIntersectElements=function(){var t=null;if(ya(this.context))t=eo(this.context,10);else{var i=this.startPoint,u=this.isStarted?this.getCurrentPoint():this.endPoint;if(!i||!u)return;var c={minX:Math.min(i.x,u.x),minY:Math.min(i.y,u.y),maxX:Math.max(i.x,u.x),maxY:Math.max(i.y,u.y)},p=this.context.view;t=Ri(p,c)}return t},e.prototype.setStateEnable=function(t){if(this.effectSiblings&&!this.effectByRecord)this.setSiblingsState(t);else{var i=So(this.context.view),u=this.getIntersectElements();u&&u.length?this.effectByRecord?this.setSiblingsStateByRecord(u,t):this.setElementsState(u,t,i):this.clear()}},e.prototype.setSiblingsStateByRecord=function(t,i){var u=this,c=this.context.view,p=mr(c),g=t.map(function(k){return k.getModel().data}),_=c.getXScale().field,w=c.getYScales()[0].field;(0,b.S6)(p,function(k){var L=So(k),R=L.filter(function(U){var G=U.getModel().data;return Ve(g,G,_,w)});u.setElementsState(R,i,L)})},e.prototype.setSiblingsState=function(t){var i=this,u=this.context.view,c=mr(u);ya(this.context)&&(0,b.S6)(c,function(p){var g=So(p),_=Eo(i.context,p,10);_&&_.length?i.setElementsState(_,t,g):i.clearViewState(p)})},e.prototype.setElementsState=function(t,i,u){var c=this;(0,b.S6)(u,function(p){t.includes(p)?c.setElementState(p,i):c.setElementState(p,!1)})},e.prototype.end=function(){this.isStarted=!1,this.endPoint=this.getCurrentPoint()},e.prototype.clear=function(){var t=this,i=this.context.view;if(this.effectSiblings){var u=mr(i);(0,b.S6)(u,function(c){t.clearViewState(c)})}else this.clearViewState(i)},e}(XE),R1=$E,zO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(R1),UO=zO,ZO=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setStateEnable=function(t){var i=Jo(this.context);if(i){if(!tu(this.context))return;t?(this.clear(),this.setElementState(i,!0)):this.hasState(i)&&this.setElementState(i,!1)}},e.prototype.toggle=function(){var t=Jo(this.context);if(t){var i=this.hasState(t);i||this.clear(),this.setElementState(t,!i)}},e.prototype.reset=function(){this.setStateEnable(!1)},e}(XE),by=ZO,VO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(by),qE=VO,im="inactive",am="active";function D1(r){var e=So(r);(0,b.S6)(e,function(t){t.hasState(am)&&t.setState(am,!1),t.hasState(im)&&t.setState(im,!1)})}function KE(r,e,t){(0,b.S6)(r,function(i){e(i)?(i.hasState(im)&&i.setState(im,!1),i.setState(am,t)):(i.hasState(am)&&i.setState(am,!1),i.setState(im,t))})}var Nv=we.INACTIVE,$d=we.ACTIVE,x3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName=$d,t}return e.prototype.setElementsStateByItem=function(t,i,u,c){var p=this,g=function(_){return p.isMathItem(_,i,u)};this.setHighlightBy(t,g,c)},e.prototype.setElementHighlight=function(t,i){i(t)?(t.hasState(Nv)&&t.setState(Nv,!1),t.setState($d,!0)):t.hasState($d)||t.setState(Nv,!0)},e.prototype.setHighlightBy=function(t,i,u){var c=this;if(u)(0,b.S6)(t,function(_){c.setElementHighlight(_,i)});else{var p=Ke(this.context.view,$d),g=!0;(0,b.S6)(p,function(_){if(!i(_))return g=!1,!1}),g?this.clear():(0,b.S6)(t,function(_){i(_)&&(_.hasState($d)&&_.setState($d,!1),_.setState(Nv,!0))})}},e.prototype.setElementState=function(t,i){var u=this.context.view,c=So(u);this.setHighlightBy(c,function(p){return t===p},i)},e.prototype.highlight=function(){this.setState()},e.prototype.clear=function(){var t=this.context.view;D1(t)},e}(YE),B1=x3,b3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setStateByElement=function(t,i){var u=this.context.view,c=t.geometry.getAttribute("color");if(!!c){var p=u.getScaleByField(c.getFields()[0]),g=an(t,p.field),_=So(u),w=_.filter(function(k){return an(k,p.field)===g});this.setHighlightBy(_,function(k){return w.includes(k)},i)}},e}(B1),E3=b3,S3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setElementHighlight=function(t,i){i(t)?(t.hasState(Nv)&&t.setState(Nv,!1),t.setState($d,!0)):(t.setState(Nv,!0),t.hasState($d)&&t.setState($d,!1))},e.prototype.setStateByElement=function(t,i){var u=this.context.view,c=u.getXScale(),p=an(t,c.field),g=So(u),_=g.filter(function(w){return an(w,c.field)===p});this.setHighlightBy(g,function(w){return _.includes(w)},i)},e.prototype.toggle=function(){var t=Jo(this.context);if(t){var i=t.hasState(this.stateName);this.setStateByElement(t,!i)}},e}(B1),w3=S3,id;(function(r){r.BEFORE_HIGHLIGHT="element-range-highlight:beforehighlight",r.AFTER_HIGHLIGHT="element-range-highlight:afterhighlight",r.BEFORE_CLEAR="element-range-highlight:beforeclear",r.AFTER_CLEAR="element-range-highlight:afterclear"})(id||(id={}));var N1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.clearViewState=function(t){D1(t)},e.prototype.highlight=function(){var t=this.context,i=t.view,u=t.event,c=this.getIntersectElements(),p={view:i,event:u,highlightElements:c};i.emit(id.BEFORE_HIGHLIGHT,pe.fromData(i,id.BEFORE_HIGHLIGHT,p)),this.setState(),i.emit(id.AFTER_HIGHLIGHT,pe.fromData(i,id.AFTER_HIGHLIGHT,p))},e.prototype.clear=function(){var t=this.context.view;t.emit(id.BEFORE_CLEAR,pe.fromData(t,id.BEFORE_CLEAR,{})),r.prototype.clear.call(this),t.emit(id.AFTER_CLEAR,pe.fromData(t,id.AFTER_CLEAR,{}))},e.prototype.setElementsState=function(t,i,u){KE(u,function(c){return t.indexOf(c)>=0},i)},e}(R1),QE=N1,om=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.highlight=function(){this.setState()},e.prototype.setElementState=function(t,i){var u=this.context.view,c=So(u);KE(c,function(p){return t===p},i)},e.prototype.clear=function(){var t=this.context.view;D1(t)},e}(by),C3=om,z1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(R1),A3=z1,Ey=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(YE),JE=Ey,U1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(by),Z1=U1,tS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="",t.ignoreItemStates=[],t}return e.prototype.getTriggerListInfo=function(){var t=La(this.context),i=null;return fo(t)&&(i={item:t.item,list:t.component}),i},e.prototype.getAllowComponents=function(){var t=this,i=this.context.view,u=Fe(i),c=[];return(0,b.S6)(u,function(p){p.isList()&&t.allowSetStateByElement(p)&&c.push(p)}),c},e.prototype.hasState=function(t,i){return t.hasState(i,this.stateName)},e.prototype.clearAllComponentsState=function(){var t=this,i=this.getAllowComponents();(0,b.S6)(i,function(u){u.clearItemsState(t.stateName)})},e.prototype.allowSetStateByElement=function(t){var i=t.get("field");if(!i)return!1;if(this.cfg&&this.cfg.componentNames){var u=t.get("name");if(this.cfg.componentNames.indexOf(u)===-1)return!1}var c=this.context.view,p=vr(c,i);return p&&p.isCategory},e.prototype.allowSetStateByItem=function(t,i){var u=this.ignoreItemStates;if(u.length){var c=u.filter(function(p){return i.hasState(t,p)});return c.length===0}return!0},e.prototype.setStateByElement=function(t,i,u){var c=t.get("field"),p=this.context.view,g=vr(p,c),_=an(i,c),w=g.getText(_);this.setItemsState(t,w,u)},e.prototype.setStateEnable=function(t){var i=this,u=Jo(this.context);if(u){var c=this.getAllowComponents();(0,b.S6)(c,function(w){i.setStateByElement(w,u,t)})}else{var p=La(this.context);if(fo(p)){var g=p.item,_=p.component;this.allowSetStateByElement(_)&&this.allowSetStateByItem(g,_)&&this.setItemState(_,g,t)}}},e.prototype.setItemsState=function(t,i,u){var c=this,p=t.getItems();(0,b.S6)(p,function(g){g.name===i&&c.setItemState(t,g,u)})},e.prototype.setItemState=function(t,i,u){t.setItemState(i,this.stateName,u)},e.prototype.setState=function(){this.setStateEnable(!0)},e.prototype.reset=function(){this.setStateEnable(!1)},e.prototype.toggle=function(){var t=this.getTriggerListInfo();if(t&&t.item){var i=t.list,u=t.item,c=this.hasState(i,u);this.setItemState(i,u,!c)}},e.prototype.clear=function(){var t=this.getTriggerListInfo();t?t.list.clearItemsState(this.stateName):this.clearAllComponentsState()},e}(oi),zv=tS,qd=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(zv),T3=qd,V1="inactive",G1="active";function H1(r){var e=r.getItems();(0,b.S6)(e,function(t){r.hasState(t,G1)&&r.setItemState(t,G1,!1),r.hasState(t,V1)&&r.setItemState(t,V1,!1)})}var y0="inactive",_0="active",M3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName=_0,t.ignoreItemStates=["unchecked"],t}return e.prototype.setItemsState=function(t,i,u){this.setHighlightBy(t,function(c){return c.name===i},u)},e.prototype.setItemState=function(t,i,u){var c=t.getItems();this.setHighlightBy(t,function(p){return p===i},u)},e.prototype.setHighlightBy=function(t,i,u){var c=t.getItems();if(u)(0,b.S6)(c,function(_){i(_)?(t.hasState(_,y0)&&t.setItemState(_,y0,!1),t.setItemState(_,_0,!0)):t.hasState(_,_0)||t.setItemState(_,y0,!0)});else{var p=t.getItemsByState(_0),g=!0;(0,b.S6)(p,function(_){if(!i(_))return g=!1,!1}),g?this.clear():(0,b.S6)(c,function(_){i(_)&&(t.hasState(_,_0)&&t.setItemState(_,_0,!1),t.setItemState(_,y0,!0))})}},e.prototype.highlight=function(){this.setState()},e.prototype.clear=function(){var t=this.getTriggerListInfo();if(t)H1(t.list);else{var i=this.getAllowComponents();(0,b.S6)(i,function(u){u.clearItemsState(_0),u.clearItemsState(y0)})}},e}(zv),j1=M3,eS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(zv),W1=eS,rS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="unchecked",t}return e.prototype.unchecked=function(){this.setState()},e}(zv),nS=rS,fg="unchecked",Sy="checked",X1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName=Sy,t}return e.prototype.setItemState=function(t,i,u){this.setCheckedBy(t,function(c){return c===i},u)},e.prototype.setCheckedBy=function(t,i,u){var c=t.getItems();u&&(0,b.S6)(c,function(p){i(p)?(t.hasState(p,fg)&&t.setItemState(p,fg,!1),t.setItemState(p,Sy,!0)):t.hasState(p,Sy)||t.setItemState(p,fg,!0)})},e.prototype.toggle=function(){var t=this.getTriggerListInfo();if(t&&t.item){var i=t.list,u=t.item,c=!(0,b.G)(i.getItems(),function(p){return i.hasState(p,fg)});c||i.hasState(u,fg)?this.setItemState(i,u,!0):this.reset()}},e.prototype.checked=function(){this.setState()},e.prototype.reset=function(){var t=this.getAllowComponents();(0,b.S6)(t,function(i){i.clearItemsState(Sy),i.clearItemsState(fg)})},e}(zv),I3=X1,hg="unchecked",wy=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.toggle=function(){var t,i,u,c,p,g,_,w,k=this.getTriggerListInfo();if(k!=null&&k.item){var L=k.list,R=k.item,U=L.getItems(),G=U.filter(function(nn){return!L.hasState(nn,hg)}),Q=U.filter(function(nn){return L.hasState(nn,hg)}),pt=G[0];if(U.length===G.length)try{for(var vt=(0,P.XA)(U),Vt=vt.next();!Vt.done;Vt=vt.next()){var le=Vt.value;L.setItemState(le,hg,le.id!==R.id)}}catch(nn){t={error:nn}}finally{try{Vt&&!Vt.done&&(i=vt.return)&&i.call(vt)}finally{if(t)throw t.error}}else if(U.length-Q.length===1)if(pt.id===R.id)try{for(var he=(0,P.XA)(U),Ne=he.next();!Ne.done;Ne=he.next()){var le=Ne.value;L.setItemState(le,hg,!1)}}catch(nn){u={error:nn}}finally{try{Ne&&!Ne.done&&(c=he.return)&&c.call(he)}finally{if(u)throw u.error}}else try{for(var Er=(0,P.XA)(U),Fr=Er.next();!Fr.done;Fr=Er.next()){var le=Fr.value;L.setItemState(le,hg,le.id!==R.id)}}catch(nn){p={error:nn}}finally{try{Fr&&!Fr.done&&(g=Er.return)&&g.call(Er)}finally{if(p)throw p.error}}else try{for(var zr=(0,P.XA)(U),pn=zr.next();!pn.done;pn=zr.next()){var le=pn.value;L.setItemState(le,hg,le.id!==R.id)}}catch(nn){_={error:nn}}finally{try{pn&&!pn.done&&(w=zr.return)&&w.call(zr)}finally{if(_)throw _.error}}}},e}(zv),Y1=wy,iS="showRadio",$1="legend-radio-tip",k3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.timeStamp=0,t}return e.prototype.show=function(){var t=this.getTriggerListInfo();if(t!=null&&t.item){var i=t.list,u=t.item;i.setItemState(u,iS,!0)}},e.prototype.hide=function(){var t=this.getTriggerListInfo();if(t!=null&&t.item){var i=t.list,u=t.item;i.setItemState(u,iS,!1)}},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},e.prototype.showTip=function(){var t=this.context,i=t.event,u=this.timeStamp,c=+new Date,p=this.context.event.target;if(c-u>16&&p.get("name")==="legend-item-radio"){var g=this.location,_={x:i.x,y:i.y};this.timeStamp=c,this.location=_,(!g||!(0,b.Xy)(g,_))&&this.showTooltip(_)}},e.prototype.hideTip=function(){this.hideTooltip(),this.location=null},e.prototype.showTooltip=function(t){var i=this.context,u=i.event,c=u.target;if(c&&c.get("tip")){this.tooltip||this.renderTooltip();var p=i.view.getCanvas().get("el").getBoundingClientRect(),g=p.x,_=p.y;this.tooltip.update((0,P.pi)((0,P.pi)({title:c.get("tip")},t),{x:t.x+g,y:t.y+_})),this.tooltip.show()}},e.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},e.prototype.renderTooltip=function(){var t,i=(t={},t[ef]={padding:"6px 8px",transform:"translate(-50%, -80%)",background:"rgba(0,0,0,0.75)",color:"#fff","border-radius":"2px","z-index":100},t[Cl]={"font-size":"12px","line-height":"14px","margin-bottom":0,"word-break":"break-all"},t);document.getElementById($1)&&document.body.removeChild(document.getElementById($1));var u=new lp({parent:document.body,region:null,visible:!1,crosshairs:null,domStyles:i,containerId:$1});u.init(),u.setCapture(!1),this.tooltip=u},e}(zv),L3=k3,P3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.maskShape=null,t.points=[],t.starting=!1,t.moving=!1,t.preMovePoint=null,t.shapeType="path",t}return e.prototype.getCurrentPoint=function(){var t=this.context.event;return{x:t.x,y:t.y}},e.prototype.emitEvent=function(t){var i="mask:".concat(t),u=this.context.view,c=this.context.event;u.emit(i,{target:this.maskShape,shape:this.maskShape,points:this.points,x:c.x,y:c.y})},e.prototype.createMask=function(){var t=this.context.view,i=this.getMaskAttrs(),u=t.foregroundGroup.addShape({type:this.shapeType,name:"mask",draggable:!0,attrs:(0,P.pi)({fill:"#C5D4EB",opacity:.3},i)});return u},e.prototype.getMaskPath=function(){return[]},e.prototype.show=function(){this.maskShape&&(this.maskShape.show(),this.emitEvent("show"))},e.prototype.start=function(t){this.starting=!0,this.moving=!1,this.points=[this.getCurrentPoint()],this.maskShape||(this.maskShape=this.createMask(),this.maskShape.set("capture",!1)),this.updateMask(t==null?void 0:t.maskStyle),this.emitEvent("start")},e.prototype.moveStart=function(){this.moving=!0,this.preMovePoint=this.getCurrentPoint()},e.prototype.move=function(){if(!(!this.moving||!this.maskShape)){var t=this.getCurrentPoint(),i=this.preMovePoint,u=t.x-i.x,c=t.y-i.y,p=this.points;(0,b.S6)(p,function(g){g.x+=u,g.y+=c}),this.updateMask(),this.emitEvent("change"),this.preMovePoint=t}},e.prototype.updateMask=function(t){var i=(0,b.b$)({},this.getMaskAttrs(),t);this.maskShape.attr(i)},e.prototype.moveEnd=function(){this.moving=!1,this.preMovePoint=null},e.prototype.end=function(){this.starting=!1,this.emitEvent("end"),this.maskShape&&this.maskShape.set("capture",!0)},e.prototype.hide=function(){this.maskShape&&(this.maskShape.hide(),this.emitEvent("hide"))},e.prototype.resize=function(){this.starting&&this.maskShape&&(this.points.push(this.getCurrentPoint()),this.updateMask(),this.emitEvent("change"))},e.prototype.destroy=function(){this.points=[],this.maskShape&&this.maskShape.remove(),this.maskShape=null,this.preMovePoint=null,r.prototype.destroy.call(this)},e}(oi),q1=P3,O3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.shapeType="circle",t}return e.prototype.getMaskAttrs=function(){var t=this.points,i=(0,b.Z$)(this.points),u=0,c=0,p=0;if(t.length){var g=t[0];u=yr(g,i)/2,c=(i.x+g.x)/2,p=(i.y+g.y)/2}return{x:c,y:p,r:u}},e}(q1),F3=O3,R3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.shapeType="rect",t}return e.prototype.getRegion=function(){var t=this.points;return{start:(0,b.YM)(t),end:(0,b.Z$)(t)}},e.prototype.getMaskAttrs=function(){var t=this.getRegion(),i=t.start,u=t.end,c=Math.min(i.x,u.x),p=Math.min(i.y,u.y),g=Math.abs(u.x-i.x),_=Math.abs(u.y-i.y);return{x:c,y:p,width:g,height:_}},e}(q1),aS=R3;function oS(r){r.x=(0,b.uZ)(r.x,0,1),r.y=(0,b.uZ)(r.y,0,1)}var sm=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dim="x",t.inPlot=!0,t}return e.prototype.getRegion=function(){var t=null,i=null,u=this.points,c=this.dim,p=this.context.view.getCoordinate(),g=p.invert((0,b.YM)(u)),_=p.invert((0,b.Z$)(u));return this.inPlot&&(oS(g),oS(_)),c==="x"?(t=p.convert({x:g.x,y:0}),i=p.convert({x:_.x,y:1})):(t=p.convert({x:0,y:g.y}),i=p.convert({x:1,y:_.y})),{start:t,end:i}},e}(aS),K1=sm,D3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getMaskPath=function(){var t=this.points,i=[];return t.length&&((0,b.S6)(t,function(u,c){c===0?i.push(["M",u.x,u.y]):i.push(["L",u.x,u.y])}),i.push(["L",t[0].x,t[0].y])),i},e.prototype.getMaskAttrs=function(){return{path:this.getMaskPath()}},e.prototype.addPoint=function(){this.resize()},e}(q1),Cy=D3,B3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getMaskPath=function(){var t=this.points;return Xr(t,!0)},e}(Cy),N3=B3,Q1=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setCursor=function(t){var i=this.context.view;i.getCanvas().setCursor(t)},e.prototype.default=function(){this.setCursor("default")},e.prototype.pointer=function(){this.setCursor("pointer")},e.prototype.move=function(){this.setCursor("move")},e.prototype.crosshair=function(){this.setCursor("crosshair")},e.prototype.wait=function(){this.setCursor("wait")},e.prototype.help=function(){this.setCursor("help")},e.prototype.text=function(){this.setCursor("text")},e.prototype.eResize=function(){this.setCursor("e-resize")},e.prototype.wResize=function(){this.setCursor("w-resize")},e.prototype.nResize=function(){this.setCursor("n-resize")},e.prototype.sResize=function(){this.setCursor("s-resize")},e.prototype.neResize=function(){this.setCursor("ne-resize")},e.prototype.nwResize=function(){this.setCursor("nw-resize")},e.prototype.seResize=function(){this.setCursor("se-resize")},e.prototype.swResize=function(){this.setCursor("sw-resize")},e.prototype.nsResize=function(){this.setCursor("ns-resize")},e.prototype.ewResize=function(){this.setCursor("ew-resize")},e.prototype.zoomIn=function(){this.setCursor("zoom-in")},e.prototype.zoomOut=function(){this.setCursor("zoom-out")},e}(oi),J1=Q1,tx=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.filterView=function(t,i,u){var c=this;t.getScaleByField(i)&&t.filter(i,u),t.views&&t.views.length&&(0,b.S6)(t.views,function(p){c.filterView(p,i,u)})},e.prototype.filter=function(){var t=La(this.context);if(t){var i=this.context.view,u=t.component,c=u.get("field");if(fo(t)){if(c){var p=u.getItemsByState("unchecked"),g=vr(i,c),_=p.map(function(U){return U.name});_.length?this.filterView(i,c,function(U){var G=g.getText(U);return!_.includes(G)}):this.filterView(i,c,null),i.render(!0)}}else if(Mu(t)){var w=u.getValue(),k=(0,P.CR)(w,2),L=k[0],R=k[1];this.filterView(i,c,function(U){return U>=L&&U<=R}),i.render(!0)}}},e}(oi),z3=tx;function sS(r,e,t,i){var u=Math.min(t[e],i[e]),c=Math.max(t[e],i[e]),p=(0,P.CR)(r.range,2),g=p[0],_=p[1];if(u<g&&(u=g),c>_&&(c=_),u===_&&c===_)return null;var w=r.invert(u),k=r.invert(c);if(r.isCategory){var L=r.values.indexOf(w),R=r.values.indexOf(k),U=r.values.slice(L,R+1);return function(G){return U.includes(G)}}else return function(G){return G>=w&&G<=k}}var Bc;(function(r){r.FILTER="brush-filter-processing",r.RESET="brush-filter-reset",r.BEFORE_FILTER="brush-filter:beforefilter",r.AFTER_FILTER="brush-filter:afterfilter",r.BEFORE_RESET="brush-filter:beforereset",r.AFTER_RESET="brush-filter:afterreset"})(Bc||(Bc={}));var ex=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dims=["x","y"],t.startPoint=null,t.isStarted=!1,t}return e.prototype.hasDim=function(t){return this.dims.includes(t)},e.prototype.start=function(){var t=this.context;this.isStarted=!0,this.startPoint=t.getCurrentPoint()},e.prototype.filter=function(){var t,i;if(ya(this.context)){var u=this.context.event.target,c=u.getCanvasBBox();t={x:c.x,y:c.y},i={x:c.maxX,y:c.maxY}}else{if(!this.isStarted)return;t=this.startPoint,i=this.context.getCurrentPoint()}if(!(Math.abs(t.x-i.x)<5||Math.abs(t.x-i.y)<5)){var p=this.context,g=p.view,_=p.event,w={view:g,event:_,dims:this.dims};g.emit(Bc.BEFORE_FILTER,pe.fromData(g,Bc.BEFORE_FILTER,w));var k=g.getCoordinate(),L=k.invert(i),R=k.invert(t);if(this.hasDim("x")){var U=g.getXScale(),G=sS(U,"x",L,R);this.filterView(g,U.field,G)}if(this.hasDim("y")){var Q=g.getYScales()[0],G=sS(Q,"y",L,R);this.filterView(g,Q.field,G)}this.reRender(g,{source:Bc.FILTER}),g.emit(Bc.AFTER_FILTER,pe.fromData(g,Bc.AFTER_FILTER,w))}},e.prototype.end=function(){this.isStarted=!1},e.prototype.reset=function(){var t=this.context.view;if(t.emit(Bc.BEFORE_RESET,pe.fromData(t,Bc.BEFORE_RESET,{})),this.isStarted=!1,this.hasDim("x")){var i=t.getXScale();this.filterView(t,i.field,null)}if(this.hasDim("y")){var u=t.getYScales()[0];this.filterView(t,u.field,null)}this.reRender(t,{source:Bc.RESET}),t.emit(Bc.AFTER_RESET,pe.fromData(t,Bc.AFTER_RESET,{}))},e.prototype.filterView=function(t,i,u){t.filter(i,u)},e.prototype.reRender=function(t,i){t.render(!0,i)},e}(oi),Ay=ex,U3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.filterView=function(t,i,u){var c=mr(t);(0,b.S6)(c,function(p){p.filter(i,u)})},e.prototype.reRender=function(t){var i=mr(t);(0,b.S6)(i,function(u){u.render(!0)})},e}(Ay),uS=U3,lS=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.filter=function(){var t=La(this.context),i=this.context.view,u=So(i);if(ya(this.context)){var c=eo(this.context,10);c&&(0,b.S6)(u,function(Q){c.includes(Q)?Q.show():Q.hide()})}else if(t){var p=t.component,g=p.get("field");if(fo(t)){if(g){var _=p.getItemsByState("unchecked"),w=vr(i,g),k=_.map(function(Q){return Q.name});(0,b.S6)(u,function(Q){var pt=an(Q,g),vt=w.getText(pt);k.indexOf(vt)>=0?Q.hide():Q.show()})}}else if(Mu(t)){var L=p.getValue(),R=(0,P.CR)(L,2),U=R[0],G=R[1];(0,b.S6)(u,function(Q){var pt=an(Q,g);pt>=U&&pt<=G?Q.show():Q.hide()})}}},e.prototype.clear=function(){var t=So(this.context.view);(0,b.S6)(t,function(i){i.show()})},e.prototype.reset=function(){this.clear()},e}(oi),Z3=lS,V3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.byRecord=!1,t}return e.prototype.filter=function(){ya(this.context)&&(this.byRecord?this.filterByRecord():this.filterByBBox())},e.prototype.filterByRecord=function(){var t=this.context.view,i=eo(this.context,10);if(!!i){var u=t.getXScale().field,c=t.getYScales()[0].field,p=i.map(function(_){return _.getModel().data}),g=mr(t);(0,b.S6)(g,function(_){var w=So(_);(0,b.S6)(w,function(k){var L=k.getModel().data;Ve(p,L,u,c)?k.show():k.hide()})})}},e.prototype.filterByBBox=function(){var t=this,i=this.context.view,u=mr(i);(0,b.S6)(u,function(c){var p=Eo(t.context,c,10),g=So(c);p&&(0,b.S6)(g,function(_){p.includes(_)?_.show():_.hide()})})},e.prototype.reset=function(){var t=mr(this.context.view);(0,b.S6)(t,function(i){var u=So(i);(0,b.S6)(u,function(c){c.show()})})},e}(oi),cS=V3,G3=10,H3=5,j3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.buttonGroup=null,t.buttonCfg={name:"button",text:"button",textStyle:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"},padding:[8,10],style:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},activeStyle:{fill:"#e6e6e6"}},t}return e.prototype.getButtonCfg=function(){return(0,b.b$)(this.buttonCfg,this.cfg)},e.prototype.drawButton=function(){var t=this.getButtonCfg(),i=this.context.view.foregroundGroup.addGroup({name:t.name}),u=i.addShape({type:"text",name:"button-text",attrs:(0,P.pi)({text:t.text},t.textStyle)}),c=u.getBBox(),p=T(t.padding),g=i.addShape({type:"rect",name:"button-rect",attrs:(0,P.pi)({x:c.x-p[3],y:c.y-p[0],width:c.width+p[1]+p[3],height:c.height+p[0]+p[2]},t.style)});g.toBack(),i.on("mouseenter",function(){g.attr(t.activeStyle)}),i.on("mouseleave",function(){g.attr(t.style)}),this.buttonGroup=i},e.prototype.resetPosition=function(){var t=this.context.view,i=t.getCoordinate(),u=i.convert({x:1,y:1}),c=this.buttonGroup,p=c.getBBox(),g=ma.vs(null,[["t",u.x-p.width-G3,u.y+p.height+H3]]);c.setMatrix(g)},e.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},e.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},e.prototype.destroy=function(){var t=this.buttonGroup;t&&t.remove(),r.prototype.destroy.call(this)},e}(oi),fS=j3,W3=4,X3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.starting=!1,t.dragStart=!1,t}return e.prototype.start=function(){this.starting=!0,this.startPoint=this.context.getCurrentPoint()},e.prototype.drag=function(){if(!!this.startPoint){var t=this.context.getCurrentPoint(),i=this.context.view,u=this.context.event;this.dragStart?i.emit("drag",{target:u.target,x:u.x,y:u.y}):yr(t,this.startPoint)>W3&&(i.emit("dragstart",{target:u.target,x:u.x,y:u.y}),this.dragStart=!0)}},e.prototype.end=function(){if(this.dragStart){var t=this.context.view,i=this.context.event;t.emit("dragend",{target:i.target,x:i.x,y:i.y})}this.starting=!1,this.dragStart=!1},e}(oi),rx=X3,Y3=5,hS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.starting=!1,t.isMoving=!1,t.startPoint=null,t.startMatrix=null,t}return e.prototype.start=function(){this.starting=!0,this.startPoint=this.context.getCurrentPoint(),this.startMatrix=this.context.view.middleGroup.getMatrix()},e.prototype.move=function(){if(!!this.starting){var t=this.startPoint,i=this.context.getCurrentPoint(),u=yr(t,i);if(u>Y3&&!this.isMoving&&(this.isMoving=!0),this.isMoving){var c=this.context.view,p=ma.vs(this.startMatrix,[["t",i.x-t.x,i.y-t.y]]);c.backgroundGroup.setMatrix(p),c.foregroundGroup.setMatrix(p),c.middleGroup.setMatrix(p)}}},e.prototype.end=function(){this.isMoving&&(this.isMoving=!1),this.startMatrix=null,this.starting=!1,this.startPoint=null},e.prototype.reset=function(){this.starting=!1,this.startPoint=null,this.isMoving=!1;var t=this.context.view;t.backgroundGroup.resetMatrix(),t.foregroundGroup.resetMatrix(),t.middleGroup.resetMatrix(),this.isMoving=!1},e}(oi),pS=hS,dS="x",$3="y",q3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dims=[dS,$3],t.cfgFields=["dims"],t.cacheScaleDefs={},t}return e.prototype.hasDim=function(t){return this.dims.includes(t)},e.prototype.getScale=function(t){var i=this.context.view;return t==="x"?i.getXScale():i.getYScales()[0]},e.prototype.resetDim=function(t){var i=this.context.view;if(this.hasDim(t)&&this.cacheScaleDefs[t]){var u=this.getScale(t);i.scale(u.field,this.cacheScaleDefs[t]),this.cacheScaleDefs[t]=null}},e.prototype.reset=function(){this.resetDim(dS),this.resetDim($3);var t=this.context.view;t.render(!0)},e}(oi),vS=q3,K3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.startPoint=null,t.starting=!1,t.startCache={},t}return e.prototype.start=function(){var t=this;this.startPoint=this.context.getCurrentPoint(),this.starting=!0;var i=this.dims;(0,b.S6)(i,function(u){var c=t.getScale(u),p=c.min,g=c.max,_=c.values;t.startCache[u]={min:p,max:g,values:_}})},e.prototype.end=function(){this.startPoint=null,this.starting=!1,this.startCache={}},e.prototype.translate=function(){var t=this;if(!!this.starting){var i=this.startPoint,u=this.context.view.getCoordinate(),c=this.context.getCurrentPoint(),p=u.invert(i),g=u.invert(c),_=g.x-p.x,w=g.y-p.y,k=this.context.view,L=this.dims;(0,b.S6)(L,function(R){t.translateDim(R,{x:_*-1,y:w*-1})}),k.render(!0)}},e.prototype.translateDim=function(t,i){if(this.hasDim(t)){var u=this.getScale(t);u.isLinear&&this.translateLinear(t,u,i)}},e.prototype.translateLinear=function(t,i,u){var c=this.context.view,p=this.startCache[t],g=p.min,_=p.max,w=_-g,k=u[t]*w;this.cacheScaleDefs[t]||(this.cacheScaleDefs[t]={nice:i.nice,min:g,max:_}),c.scale(i.field,{nice:!1,min:g+k,max:_+k})},e.prototype.reset=function(){r.prototype.reset.call(this),this.startPoint=null,this.starting=!1},e}(vS),Q3=K3,J3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.zoomRatio=.05,t}return e.prototype.zoomIn=function(){this.zoom(this.zoomRatio)},e.prototype.zoom=function(t){var i=this,u=this.dims;(0,b.S6)(u,function(c){i.zoomDim(c,t)}),this.context.view.render(!0)},e.prototype.zoomOut=function(){this.zoom(-1*this.zoomRatio)},e.prototype.zoomDim=function(t,i){if(this.hasDim(t)){var u=this.getScale(t);u.isLinear&&this.zoomLinear(t,u,i)}},e.prototype.zoomLinear=function(t,i,u){var c=this.context.view;this.cacheScaleDefs[t]||(this.cacheScaleDefs[t]={nice:i.nice,min:i.min,max:i.max});var p=this.cacheScaleDefs[t],g=p.max-p.min,_=i.min,w=i.max,k=u*g,L=_-k,R=w+k,U=R-L,G=U/g;R>L&&G<100&&G>.01&&c.scale(i.field,{nice:!1,min:_-k,max:w+k})},e}(vS),gS=J3;function t5(r){var e=r.gEvent.originalEvent;return e.deltaY>0}var e5=1,r5=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.scroll=function(t){var i=this.context,u=i.view,c=i.event;if(!!u.getOptions().scrollbar){var p=(t==null?void 0:t.wheelDelta)||e5,g=u.getController("scrollbar"),_=u.getXScale(),w=u.getOptions().data,k=(0,b.dp)((0,b.I)(w,_.field)),L=(0,b.dp)(_.values),R=g.getValue(),U=Math.floor((k-L)*R),G=U+(t5(c)?p:-p),Q=p/(k-L)/1e4,pt=(0,b.uZ)(G/(k-L)+Q,0,1);g.setValue(pt)}},e}(oi),mS=r5,n5="aixs-description-tooltip",i5=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.show=function(){var t=this.context,i=La(t).axis,u=i.cfg.title,c=u.description,p=u.text,g=u.descriptionTooltipStyle,_=t.event,w=_.x,k=_.y;this.tooltip||this.renderTooltip(),this.tooltip.update({title:p||"",customContent:function(){return`
          <div class="`.concat(ef,'" style={').concat(g,`}>
            <div class="`).concat(Cl,`">
              \u5B57\u6BB5\u8BF4\u660E\uFF1A`).concat(c,`
            </div>
          </div>
        `)},x:w,y:k}),this.tooltip.show()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},e.prototype.hide=function(){this.tooltip&&this.tooltip.hide()},e.prototype.renderTooltip=function(){var t,i=this.context.view,u=i.canvas,c={start:{x:0,y:0},end:{x:u.get("width"),y:u.get("height")}},p=new lp({parent:u.get("el").parentNode,region:c,visible:!1,containerId:n5,domStyles:(0,P.pi)({},(0,b.b$)({},(t={},t[ef]={"max-width":"50%",padding:"10px","line-height":"15px","font-size":"12px",color:"rgba(0, 0, 0, .65)"},t[Cl]={"word-break":"break-all","margin-bottom":"3px"},t)))});p.init(),p.setCapture(!1),this.tooltip=p},e}(oi),a5=i5;ku("dark",Iu(jg)),ct("canvas",be),ct("svg",st),Ar("Polygon",sE),Ar("Interval",iE),Ar("Schema",sM),Ar("Path",iy),Ar("Point",iM),Ar("Line",JT),Ar("Area",K2),Ar("Edge",XT),Ar("Heatmap",Q2),Ar("Violin",hM),lu("base",zd),lu("interval",vE),lu("pie",EM),lu("polar",uy),us("overlap",IM),us("distribute",_E),us("fixed-overlap",SO),us("hide-overlap",IO),us("limit-in-shape",TM),us("limit-in-canvas",AM),us("limit-in-plot",dy),us("pie-outer",CM),us("adjust-color",Ps),us("interval-adjust-position",S1),us("interval-hide-overlap",hy),us("point-adjust-position",AE),us("pie-spider",sh),us("path-adjust-position",UM),Oa("fade-in",VM),Oa("fade-out",GM),Oa("grow-in-x",HM),Oa("grow-in-xy",WM),Oa("grow-in-y",jM),Oa("scale-in-x",Xd),Oa("scale-in-y",IE),Oa("wave-in",OE),Oa("zoom-in",FE),Oa("zoom-out",RE),Oa("position-update",YM),Oa("sector-path-update",Yd),Oa("path-in",XM),_n("rect",t3),_n("mirror",PO),_n("list",qM),_n("matrix",KM),_n("circle",M1),_n("tree",e3),N("axis",u3),N("legend",ZE),N("tooltip",Di),N("annotation",i3),N("slider",nd),N("scrollbar",nm),Yn("tooltip",WE),Yn("sibling-tooltip",g3),Yn("ellipsis-text",m3),Yn("element-active",_3),Yn("element-single-active",qE),Yn("element-range-active",UO),Yn("element-highlight",B1),Yn("element-highlight-by-x",w3),Yn("element-highlight-by-color",E3),Yn("element-single-highlight",C3),Yn("element-range-highlight",QE),Yn("element-sibling-highlight",QE,{effectSiblings:!0,effectByRecord:!0}),Yn("element-selected",JE),Yn("element-single-selected",Z1),Yn("element-range-selected",A3),Yn("element-link-by-color",NO),Yn("active-region",jE),Yn("list-active",T3),Yn("list-selected",W1),Yn("list-highlight",j1),Yn("list-unchecked",nS),Yn("list-checked",I3),Yn("list-focus",Y1),Yn("list-radio",L3),Yn("legend-item-highlight",j1,{componentNames:["legend"]}),Yn("axis-label-highlight",j1,{componentNames:["axis"]}),Yn("axis-description",a5),Yn("rect-mask",aS),Yn("x-rect-mask",K1,{dim:"x"}),Yn("y-rect-mask",K1,{dim:"y"}),Yn("circle-mask",F3),Yn("path-mask",Cy),Yn("smooth-path-mask",N3),Yn("cursor",J1),Yn("data-filter",z3),Yn("brush",Ay),Yn("brush-x",Ay,{dims:["x"]}),Yn("brush-y",Ay,{dims:["y"]}),Yn("sibling-filter",uS),Yn("sibling-x-filter",uS),Yn("sibling-y-filter",uS),Yn("element-filter",Z3),Yn("element-sibling-filter",cS),Yn("element-sibling-filter-record",cS,{byRecord:!0}),Yn("view-drag",rx),Yn("view-move",pS),Yn("scale-translate",Q3),Yn("scale-zoom",gS),Yn("reset-button",fS,{name:"reset-button",text:"reset"}),Yn("mousewheel-scroll",mS);function Uv(r){return r.isInPlot()}kn("tooltip",{start:[{trigger:"plot:mousemove",action:"tooltip:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"plot:touchmove",action:"tooltip:show",throttle:{wait:50,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseleave",action:"tooltip:hide"},{trigger:"plot:leave",action:"tooltip:hide"},{trigger:"plot:touchend",action:"tooltip:hide"}]}),kn("ellipsis-text",{start:[{trigger:"legend-item-name:mousemove",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"legend-item-name:touchstart",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"axis-label:mousemove",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"axis-label:touchstart",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}}],end:[{trigger:"legend-item-name:mouseleave",action:"ellipsis-text:hide"},{trigger:"legend-item-name:touchend",action:"ellipsis-text:hide"},{trigger:"axis-label:mouseleave",action:"ellipsis-text:hide"},{trigger:"axis-label:mouseout",action:"ellipsis-text:hide"},{trigger:"axis-label:touchend",action:"ellipsis-text:hide"}]}),kn("element-active",{start:[{trigger:"element:mouseenter",action:"element-active:active"}],end:[{trigger:"element:mouseleave",action:"element-active:reset"}]}),kn("element-selected",{start:[{trigger:"element:click",action:"element-selected:toggle"}]}),kn("element-highlight",{start:[{trigger:"element:mouseenter",action:"element-highlight:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight:reset"}]}),kn("element-highlight-by-x",{start:[{trigger:"element:mouseenter",action:"element-highlight-by-x:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight-by-x:reset"}]}),kn("element-highlight-by-color",{start:[{trigger:"element:mouseenter",action:"element-highlight-by-color:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight-by-color:reset"}]}),kn("legend-active",{start:[{trigger:"legend-item:mouseenter",action:["list-active:active","element-active:active"]}],end:[{trigger:"legend-item:mouseleave",action:["list-active:reset","element-active:reset"]}]}),kn("legend-highlight",{start:[{trigger:"legend-item:mouseenter",action:["legend-item-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"legend-item:mouseleave",action:["legend-item-highlight:reset","element-highlight:reset"]}]}),kn("axis-label-highlight",{start:[{trigger:"axis-label:mouseenter",action:["axis-label-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"axis-label:mouseleave",action:["axis-label-highlight:reset","element-highlight:reset"]}]}),kn("element-list-highlight",{start:[{trigger:"element:mouseenter",action:["list-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"element:mouseleave",action:["list-highlight:reset","element-highlight:reset"]}]}),kn("element-range-highlight",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(r){return!r.isInShape("mask")},action:["rect-mask:start","rect-mask:show"]},{trigger:"mask:dragstart",action:["rect-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]},{trigger:"mask:drag",action:["rect-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["rect-mask:end"]},{trigger:"mask:dragend",action:["rect-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(r){return!r.isInPlot()},action:["element-range-highlight:clear","rect-mask:end","rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear","rect-mask:hide"]}]}),kn("brush",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Uv,action:["brush:start","rect-mask:start","rect-mask:show"]}],processing:[{trigger:"mousemove",isEnable:Uv,action:["rect-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Uv,action:["brush:filter","brush:end","rect-mask:end","rect-mask:hide","reset-button:show"]}],rollback:[{trigger:"reset-button:click",action:["brush:reset","reset-button:hide","cursor:crosshair"]}]}),kn("brush-visible",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"plot:mousedown",action:["rect-mask:start","rect-mask:show"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["rect-mask:end","rect-mask:hide","element-filter:filter","element-range-highlight:clear"]}],rollback:[{trigger:"dblclick",action:["element-filter:clear"]}]}),kn("brush-x",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Uv,action:["brush-x:start","x-rect-mask:start","x-rect-mask:show"]}],processing:[{trigger:"mousemove",isEnable:Uv,action:["x-rect-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Uv,action:["brush-x:filter","brush-x:end","x-rect-mask:end","x-rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]}),kn("element-path-highlight",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Uv,action:"path-mask:start"},{trigger:"mousedown",isEnable:Uv,action:"path-mask:show"}],processing:[{trigger:"mousemove",action:"path-mask:addPoint"}],end:[{trigger:"mouseup",action:"path-mask:end"}],rollback:[{trigger:"dblclick",action:"path-mask:hide"}]}),kn("element-single-selected",{start:[{trigger:"element:click",action:"element-single-selected:toggle"}]}),kn("legend-filter",{showEnable:[{trigger:"legend-item:mouseenter",action:["cursor:pointer","list-radio:show"]},{trigger:"legend-item:mouseleave",action:["cursor:default","list-radio:hide"]}],start:[{trigger:"legend-item:click",isEnable:function(r){return!r.isInShape("legend-item-radio")},action:["legend-item-highlight:reset","element-highlight:reset","list-unchecked:toggle","data-filter:filter","list-radio:show"]},{trigger:"legend-item-radio:mouseenter",action:["list-radio:showTip"]},{trigger:"legend-item-radio:mouseleave",action:["list-radio:hideTip"]},{trigger:"legend-item-radio:click",action:["list-focus:toggle","data-filter:filter","list-radio:show"]}]}),kn("continuous-filter",{start:[{trigger:"legend:valuechanged",action:"data-filter:filter"}]}),kn("continuous-visible-filter",{start:[{trigger:"legend:valuechanged",action:"element-filter:filter"}]}),kn("legend-visible-filter",{showEnable:[{trigger:"legend-item:mouseenter",action:"cursor:pointer"},{trigger:"legend-item:mouseleave",action:"cursor:default"}],start:[{trigger:"legend-item:click",action:["legend-item-highlight:reset","element-highlight:reset","list-unchecked:toggle","element-filter:filter"]}]}),kn("active-region",{start:[{trigger:"plot:mousemove",action:"active-region:show"}],end:[{trigger:"plot:mouseleave",action:"active-region:hide"}]}),kn("axis-description",{start:[{trigger:"axis-description:mousemove",action:"axis-description:show"}],end:[{trigger:"axis-description:mouseleave",action:"axis-description:hide"}]});function yS(r){return r.gEvent.preventDefault(),r.gEvent.originalEvent.deltaY>0}kn("view-zoom",{start:[{trigger:"plot:mousewheel",isEnable:function(r){return yS(r.event)},action:"scale-zoom:zoomOut",throttle:{wait:100,leading:!0,trailing:!1}},{trigger:"plot:mousewheel",isEnable:function(r){return!yS(r.event)},action:"scale-zoom:zoomIn",throttle:{wait:100,leading:!0,trailing:!1}}]}),kn("sibling-tooltip",{start:[{trigger:"plot:mousemove",action:"sibling-tooltip:show"}],end:[{trigger:"plot:mouseleave",action:"sibling-tooltip:hide"}]}),kn("plot-mousewheel-scroll",{start:[{trigger:"plot:mousewheel",action:"mousewheel-scroll:scroll"}]});var Rf=["type","alias","tickCount","tickInterval","min","max","nice","minLimit","maxLimit","range","tickMethod","base","exponent","mask","sync"],Cp;(function(r){r.ERROR="error",r.WARN="warn",r.INFO="log"})(Cp||(Cp={}));var nx="AntV/G2Plot";function _S(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var i=0;return nx+": "+r.replace(/%s/g,function(){return""+e[i++]})}function o5(r,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];if(!r){var u=new Error(_S.apply(void 0,__spreadArrays([e],t)));throw u.name=nx,u}}function Ap(r,e,t){for(var i=[],u=3;u<arguments.length;u++)i[u-3]=arguments[u];e||console[r](_S.apply(void 0,(0,P.pr)([t],i)))}function fs(r,e){var t={};return r!==null&&typeof r=="object"&&e.forEach(function(i){var u=r[i];u!==void 0&&(t[i]=u)}),t}function ix(r,e){if(!r)return{};var t=r.filter(function(c){var p=(0,b.U2)(c,[e]);return(0,b.hj)(p)&&!isNaN(p)}),i=t.every(function(c){return(0,b.U2)(c,[e])>=0}),u=t.every(function(c){return(0,b.U2)(c,[e])<=0});return i?{min:0}:u?{max:0}:{}}function xS(r,e,t,i,u){if(u===void 0&&(u=[]),!Array.isArray(r))return{nodes:[],links:[]};var c=[],p={},g=-1;return r.forEach(function(_){var w=_[e],k=_[t],L=_[i],R=fs(_,u);p[w]||(p[w]=(0,P.pi)({id:++g,name:w},R)),p[k]||(p[k]=(0,P.pi)({id:++g,name:k},R)),c.push((0,P.pi)({source:p[w].id,target:p[k].id,value:L},R))}),{nodes:Object.values(p).sort(function(_,w){return _.id-w.id}),links:c}}function pg(r,e){var t=(0,b.hX)(r,function(i){var u=i[e];return u===null||typeof u=="number"&&!isNaN(u)});return Ap(Cp.WARN,t.length===r.length,"illegal data existed in chart data."),t}var s5=5,u5={}.toString,x0=function(r,e){return u5.call(r)==="[object "+e+"]"},l5=function(r){return x0(r,"Array")},c5=function(r){return typeof r=="object"&&r!==null},bS=function(r){if(!c5(r)||!x0(r,"Object"))return!1;for(var e=r;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e},ES=function(r,e,t,i){t=t||0,i=i||s5;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var c=e[u];c?bS(c)?(bS(r[u])||(r[u]={}),t<i?ES(r[u],c,t+1,i):r[u]=e[u]):l5(c)?(r[u]=[],r[u]=r[u].concat(c)):r[u]=c:r[u]=c}},hn=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var i=0;i<e.length;i+=1)ES(r,e[i]);return r};function ax(r){if(!r)return{width:0,height:0};var e=getComputedStyle(r);return{width:(r.clientWidth||parseInt(e.width,10))-parseInt(e.paddingLeft,10)-parseInt(e.paddingRight,10),height:(r.clientHeight||parseInt(e.height,10))-parseInt(e.paddingTop,10)-parseInt(e.paddingBottom,10)}}function Ga(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return function(t){return r.reduce(function(i,u){return u(i)},t)}}function Ec(r,e){return r.geometries.find(function(t){return t.type===e})}function Zv(r){return(0,b.u4)(r.geometries,function(e,t){return e.concat(t.elements)},[])}function Bh(r){return(0,b.U2)(r,["views","length"],0)<=0?Zv(r):(0,b.u4)(r.views,function(e,t){return e.concat(Bh(t))},Zv(r))}function ox(r){return(0,b.U2)(r,["views","length"],0)<=0?r.geometries:(0,b.u4)(r.views,function(e,t){return e.concat(t.geometries)},r.geometries)}function Os(r){if(!(0,b.P9)(r,"Object"))return r;var e=(0,P.pi)({},r);return e.formatter&&!e.content&&(e.content=e.formatter),e}var sx;function Ty(){return sx||(sx=document.createElement("canvas").getContext("2d")),sx}var f5=(0,b.HP)(function(r,e){e===void 0&&(e={});var t=e.fontSize,i=e.fontFamily,u=i===void 0?"sans-serif":i,c=e.fontWeight,p=e.fontStyle,g=e.fontVariant,_=Ty();_.font=[p,c,g,t+"px",u].join(" ");var w=_.measureText((0,b.HD)(r)?r:"");return w.width},function(r,e){return e===void 0&&(e={}),(0,P.pr)([r],(0,b.VO)(e)).join("")});function b0(r){return typeof r=="number"&&!isNaN(r)}function yu(r,e,t){var i=Math.min(e,t),u=Math.max(e,t);return r>=i&&r<=u}function Vv(r){if((0,b.hj)(r))return[r,r,r,r];if((0,b.kJ)(r)){var e=r.length;if(e===1)return[r[0],r[0],r[0],r[0]];if(e===2)return[r[0],r[1],r[0],r[1]];if(e===3)return[r[0],r[1],r[2],r[1]];if(e===4)return r}return[0,0,0,0]}function My(r,e,t){e===void 0&&(e="bottom"),t===void 0&&(t=25);var i=Vv(r),u=[e.startsWith("top")?t:0,e.startsWith("right")?t:0,e.startsWith("bottom")?t:0,e.startsWith("left")?t:0];return[i[0]+u[0],i[1]+u[1],i[2]+u[2],i[3]+u[3]]}function ux(r){var e=r.map(function(i){return Vv(i)}),t=[0,0,0,0];return e.length>0&&(t=t.map(function(i,u){return e.forEach(function(c,p){i+=e[p][u]}),i})),t}function h5(r,e){var t=[];if(r.length){t.push(["M",r[0].x,r[0].y]);for(var i=1,u=r.length;i<u;i+=1){var c=r[i];t.push(["L",c.x,c.y])}e&&t.push(["Z"])}return t}var p5=function(r,e,t,i){var u=[],c,p,g=!!i,_,w;if(g){_=[1/0,1/0],w=[-1/0,-1/0];for(var k=0,L=r.length;k<L;k++){var R=r[k];_=sa.VV([0,0],_,R),w=sa.Fp([0,0],w,R)}_=sa.VV([0,0],_,i[0]),w=sa.Fp([0,0],w,i[1])}for(var k=0,U=r.length;k<U;k++){var R=r[k];if(t)c=r[k?k-1:U-1],p=r[(k+1)%U];else if(k===0||k===U-1){u.push(R);continue}else c=r[k-1],p=r[k+1];var G=[0,0];G=sa.lu(G,p,c),G=sa.bA(G,G,e);var Q=sa.TE(R,c),pt=sa.TE(R,p),vt=Q+pt;vt!==0&&(Q/=vt,pt/=vt);var Vt=sa.bA([0,0],G,-Q),le=sa.bA([0,0],G,pt),he=sa.IH([0,0],R,Vt),Ne=sa.IH([0,0],R,le);g&&(he=sa.Fp([0,0],he,_),he=sa.VV([0,0],he,w),Ne=sa.Fp([0,0],Ne,_),Ne=sa.VV([0,0],Ne,w)),u.push(he),u.push(Ne)}return t&&u.push(u.shift()),u};function d5(r,e,t){for(var i=!!e,u=[],c=0,p=r.length;c<p;c+=2)u.push([r[c],r[c+1]]);for(var g=p5(u,.4,i,t),_=u.length,w=[],k,L,R,c=0;c<_-1;c++)k=g[c*2],L=g[c*2+1],R=u[c+1],w.push(["C",k[0],k[1],L[0],L[1],R[0],R[1]]);return i&&(k=g[_],L=g[_+1],R=u[0],w.push(["C",k[0],k[1],L[0],L[1],R[0],R[1]])),w}function v5(r,e,t){var i=[],u=r[0],c=null;if(r.length<=2)return h5(r,e);for(var p=0,g=r.length;p<g;p++){var _=r[p];(!c||!(c.x===_.x&&c.y===_.y))&&(i.push(_.x),i.push(_.y),c=_)}var w=t||[[0,0],[1,1]],k=d5(i,e,w);return k.unshift(["M",u.x,u.y]),k}function lx(r){if(!r)return r;var e=r.match(/(([A-Z]{0,1}[a-z]*[^A-Z])|([A-Z]{1}))/g);return e.map(function(t){return t.toLowerCase()}).join("-")}function cx(r){var e={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",display:"flex",justifyContent:"center",alignItems:"center"},t=["stroke","lineWidth","shadowColor","strokeOpacity","shadowBlur","shadowOffsetX","shadowOffsetY","fill"];(0,b.U2)(r,"fill")&&(e.color=r.fill);var i=fs(r,t),u=i.shadowColor,c=i.shadowBlur,p=c===void 0?0:c,g=i.shadowOffsetX,_=g===void 0?0:g,w=i.shadowOffsetY,k=w===void 0?0:w;e["text-shadow"]=""+[u,_+"px",k+"px",p+"px"].join(" ");var L=fs(r,t),R=L.stroke,U=L.lineWidth,G=U===void 0?0:U;return e["-webkit-text-stroke"]=""+[G+"px",R].join(" "),(0,b.S6)(r,function(Q,pt){["fontSize"].includes(pt)&&(0,b.hj)(Q)?e[lx(pt)]=Q+"px":pt&&!t.includes(pt)&&(e[lx(pt)]=""+Q)}),e}function SS(r,e){r.style["pointer-events"]="none",(0,b.S6)(e,function(t,i){i&&t&&(r.style[i]=t)})}var Iy=function(r,e,t){var i=e.statistic,u=e.plotType,c=i.title,p=i.content;[c,p].forEach(function(g,_){if(!!g){var w="";_===0?w=p?"translate(-50%, -100%)":"translate(-50%, -50%)":w=c?"translate(-50%, 0)":"translate(-50%, -50%)";var k=(0,b.mf)(g.style)?g.style(t):g.style;r.annotation().html((0,P.pi)({position:["50%","50%"],html:function(L,R){var U=R.getCoordinate(),G=0;if(u==="pie"||u==="ring-progress")G=U.getRadius()*U.innerRadius*2;else if(u==="liquid"){var Q=(0,b.U2)(R.geometries,[0,"elements",0,"shape"]);if(Q){var pt=Q.find(function(he){return he.get("name")==="wrap"}),vt=pt.getCanvasBBox().width;G=vt}}else G||(G=U.getWidth());SS(L,(0,P.pi)({width:G+"px",transform:w},cx(k)));var Vt=R.getData();if(g.customHtml)return g.customHtml(L,R,t,Vt);var le=g.content;return g.formatter&&(le=g.formatter(t,Vt)),le?(0,b.HD)(le)?le:""+le:"<div></div>"},key:(_===0?"top":"bottom")+"-statistic"},fs(g,["offsetX","offsetY","rotate","style","formatter"])))}})},g5=function(r,e,t){var i=e.statistic,u=i.title,c=i.content;[u,c].forEach(function(p){if(!!p){var g=(0,b.mf)(p.style)?p.style(t):p.style;r.annotation().html((0,P.pi)({position:["50%","100%"],html:function(_,w){var k=w.getCoordinate(),L=w.views[0].getCoordinate(),R=L.getCenter(),U=L.getRadius(),G=Math.max(Math.sin(L.startAngle),Math.sin(L.endAngle))*U,Q=R.y+G-k.y.start-parseFloat((0,b.U2)(g,"fontSize",0)),pt=k.getRadius()*k.innerRadius*2;SS(_,(0,P.pi)({width:pt+"px",transform:"translate(-50%, "+Q+"px)"},cx(g)));var vt=w.getData();if(p.customHtml)return p.customHtml(_,w,t,vt);var Vt=p.content;return p.formatter&&(Vt=p.formatter(t,vt)),Vt?(0,b.HD)(Vt)?Vt:""+Vt:"<div></div>"}},fs(p,["offsetX","offsetY","rotate","style","formatter"])))}})};function wS(r,e){return e?(0,b.u4)(e,function(t,i,u){return t.replace(new RegExp("{\\s*"+u+"\\s*}","g"),i)},r):r}function yo(r,e){return r.views.find(function(t){return t.id===e})}function um(r){var e=r.parent;return e?e.views:[]}function fx(r){return um(r).filter(function(e){return e!==r})}function E0(r,e,t){t===void 0&&(t=r.geometries),typeof e=="boolean"?r.animate(e):r.animate(!0),(0,b.S6)(t,function(i){var u;(0,b.mf)(e)?u=e(i.type||i.shapeType,i)||!0:u=e,i.animate(u)})}function lm(){return typeof window=="object"?window==null?void 0:window.devicePixelRatio:2}function hx(r,e){e===void 0&&(e=r);var t=document.createElement("canvas"),i=lm();t.width=r*i,t.height=e*i,t.style.width=r+"px",t.style.height=e+"px";var u=t.getContext("2d");return u.scale(i,i),t}function px(r,e,t,i){i===void 0&&(i=t);var u=e.backgroundColor,c=e.opacity;r.globalAlpha=c,r.fillStyle=u,r.beginPath(),r.fillRect(0,0,t,i),r.closePath()}function dx(r,e,t){var i=r+e;return t?i*2:i}function CS(r,e){var t=e?[[r*.25,r*.25],[r*.75,r*.75]]:[[r*.5,r*.5]];return t}function vx(r,e){var t=e*Math.PI/180,i={a:Math.cos(t)*(1/r),b:Math.sin(t)*(1/r),c:-Math.sin(t)*(1/r),d:Math.cos(t)*(1/r),e:0,f:0};return i}var AS={size:6,padding:2,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0,isStagger:!0};function dg(r,e,t,i){var u=e.size,c=e.fill,p=e.lineWidth,g=e.stroke,_=e.fillOpacity;r.beginPath(),r.globalAlpha=_,r.fillStyle=c,r.strokeStyle=g,r.lineWidth=p,r.arc(t,i,u/2,0,2*Math.PI,!1),r.fill(),p&&r.stroke(),r.closePath()}function TS(r){var e=hn({},AS,r),t=e.size,i=e.padding,u=e.isStagger,c=e.rotation,p=dx(t,i,u),g=CS(p,u),_=hx(p,p),w=_.getContext("2d");px(w,e,p);for(var k=0,L=g;k<L.length;k++){var R=L[k],U=R[0],G=R[1];dg(w,e,U,G)}var Q=w.createPattern(_,"repeat");if(Q){var pt=lm(),vt=vx(pt,c);Q.setTransform(vt)}return Q}var gx={rotation:45,spacing:5,opacity:1,backgroundColor:"transparent",strokeOpacity:.5,stroke:"#fff",lineWidth:2};function MS(r,e,t){var i=e.stroke,u=e.lineWidth,c=e.strokeOpacity,p=new Path2D(t);r.globalAlpha=c,r.lineCap="square",r.strokeStyle=u?i:"transparent",r.lineWidth=u,r.stroke(p)}function m5(r){var e=hn({},gx,r),t=e.spacing,i=e.rotation,u=e.lineWidth,c=t+u||1,p=t+u||1,g=`
            M 0 0 L `+c+` 0
            M 0 `+p+" L "+c+" "+p+`
            `,_=hx(c,p),w=_.getContext("2d");px(w,e,c,p),MS(w,e,g);var k=w.createPattern(_,"repeat");if(k){var L=lm(),R=vx(L,i);k.setTransform(R)}return k}var y5={size:6,padding:1,isStagger:!0,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0};function IS(r,e,t,i){var u=e.stroke,c=e.size,p=e.fill,g=e.lineWidth,_=e.fillOpacity;r.globalAlpha=_,r.strokeStyle=u,r.lineWidth=g,r.fillStyle=p,r.strokeRect(t-c/2,i-c/2,c,c),r.fillRect(t-c/2,i-c/2,c,c)}function ws(r){var e=hn({},y5,r),t=e.size,i=e.padding,u=e.isStagger,c=e.rotation,p=dx(t,i,u),g=CS(p,u),_=hx(p,p),w=_.getContext("2d");px(w,e,p);for(var k=0,L=g;k<L.length;k++){var R=L[k],U=R[0],G=R[1];IS(w,e,U,G)}var Q=w.createPattern(_,"repeat");if(Q){var pt=lm(),vt=vx(pt,c);Q.setTransform(vt)}return Q}function mx(r){var e=r.type,t=r.cfg,i;switch(e){case"dot":i=TS(t);break;case"line":i=m5(t);break;case"square":i=ws(t);break;default:break}return i}function Nh(r){var e=this;return function(t){var i,u=t.options,c=t.chart,p=u.pattern;if(!p)return t;var g=function(_){for(var w,k,L,R=[],U=1;U<arguments.length;U++)R[U-1]=arguments[U];var G=c.getTheme().defaultColor,Q=G,pt=(k=(w=c.geometries)===null||w===void 0?void 0:w[0])===null||k===void 0?void 0:k.getAttribute("color");if(pt){var vt=pt.getFields()[0],Vt=(0,b.U2)(_,vt);Q=_c.getMappingValue(pt,Vt,((L=pt.values)===null||L===void 0?void 0:L[0])||G)}var le=p;typeof p=="function"&&(le=p.call(e,_,Q)),le instanceof CanvasPattern||(le=mx(hn({},{cfg:{backgroundColor:Q}},le)));var he=u[r];return(0,P.pi)((0,P.pi)({},typeof he=="function"?he.call.apply(he,(0,P.pr)([e,_],R)):he||{}),{fill:le||Q})};return hn({},t,{options:(i={},i[r]=g,i)})}}function vg(r){var e=r.chart,t=r.options,i=t.legend,u=t.colorField,c=t.seriesField;return i===!1?e.legend(!1):(u||c)&&e.legend(u||c,i),r}function hl(r){var e=r.chart,t=r.options,i=t.tooltip;return i!==void 0&&e.tooltip(i),r}function Xs(r){var e=r.chart,t=r.options,i=t.interactions;return(0,b.S6)(i,function(u){u.enable===!1?e.removeInteraction(u.type):e.interaction(u.type,u.cfg||{})}),r}function ms(r){var e=r.chart,t=r.options,i=t.animation;return E0(e,i),r}function Bo(r){var e=r.chart,t=r.options,i=t.theme;return i&&e.theme(i),r}function S0(r){var e=r.chart,t=r.options,i=t.state;return i&&(0,b.S6)(e.geometries,function(u){u.state(i)}),r}function Vu(r){var e=r.chart,t=r.options,i=t.slider;return e.option("slider",i),r}function ad(r){var e=r.chart,t=r.options,i=t.scrollbar;return e.option("scrollbar",i),r}function Zs(r,e){return function(t){var i=t.chart,u=t.options,c={};return(0,b.S6)(r,function(p,g){c[g]=fs(p,Rf)}),c=hn({},e,u.meta,c),i.scale(c),t}}function Ys(r){return function(e){var t=e.chart,i=e.options,u=t.getController("annotation");return(0,b.S6)((0,P.pr)(i.annotations||[],r||[]),function(c){u.annotation(c)}),e}}function Df(r){var e=r.chart,t=r.options,i=t.yAxis,u=t.limitInPlot,c=u;return(0,b.Kn)(i)&&(0,b.UM)(u)&&(Object.values(fs(i,["min","max","minLimit","maxLimit"])).some(function(p){return!(0,b.UM)(p)})?c=!0:c=!1),e.limitInPlot=c,r}function w0(r){return r===void 0&&(r="rect"),function(e){var t=e.chart,i=e.options,u=i.coordinate,c=Array.from(u||[]).map(function(p){return p.type==="reflectX"?["reflect","x"]:p.type==="reflectY"?["reflect","y"]:p.type==="transpose"?["transpose"]:null}).filter(function(p){return!!p});return c.length!==0&&t.coordinate({type:r,actions:c}),e}}var ky={locale:"en-US"};function FR(r){each(r,function(e,t){return ky[t]=e})}var Ly={};function wo(r,e){Ly[r]=e}function yx(r){return{get:function(e,t){return wS((0,b.U2)(Ly[r],e)||(0,b.U2)(Ly[ky.locale],e)||(0,b.U2)(Ly["en-US"],e)||e,t)}}}var GO={locale:"en-US",general:{increase:"Increase",decrease:"Decrease",root:"Root"},statistic:{total:"Total"},conversionTag:{label:"Rate"},legend:{},tooltip:{},slider:{},scrollbar:{},waterfall:{total:"Total"}},kS={locale:"zh-CN",general:{increase:"\u589E\u52A0",decrease:"\u51CF\u5C11",root:"\u521D\u59CB"},statistic:{total:"\u603B\u8BA1"},conversionTag:{label:"\u8F6C\u5316\u7387"},legend:{},tooltip:{},slider:{},scrollbar:{},waterfall:{total:"\u603B\u8BA1"}};function zh(r,e){if(r===!1)return{fields:!1};var t=(0,b.U2)(r,"fields"),i=(0,b.U2)(r,"formatter");return i&&!t&&(t=e),{fields:t,formatter:i}}function vf(r,e){var t=r.type,i=r.xField,u=r.yField,c=r.colorField,p=r.shapeField,g=r.sizeField,_=r.styleField,w=r.rawFields,k=[];if(w=((0,b.mf)(w)?w(t,e):w)||[],e==="color")k=(0,P.pr)([c||i],w);else if(e==="shape")k=(0,P.pr)([p||i],w);else if(e==="size")k=(0,P.pr)([g||i],w);else{k=(0,P.pr)([i,u,c,p,g,_],w);var L=["x","y","color","shape","size","style"].indexOf(e),R=k[L];k.splice(L,1),k.unshift(R)}var U=(0,b.jj)(k.filter(function(Q){return!!Q})),G=t==="line"&&[i,u].includes(U.join("*"))?"":U.join("*");return{mappingFields:U,tileMappingField:G}}function Uh(r,e){if(!!e)return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var u={};return r.forEach(function(c,p){u[c]=t[p]}),delete u.undefined,e(u)}}function Fl(r){var e=r.chart,t=r.options,i=t.type,u=t.args,c=t.mapping,p=t.xField,g=t.yField,_=t.colorField,w=t.shapeField,k=t.sizeField,L=t.tooltipFields,R=t.label,U=t.state,G=t.customInfo;if(!c)return r;var Q=c.color,pt=c.shape,vt=c.size,Vt=c.style,le=c.tooltip,he=e[i](u).position(p+"*"+g);if((0,b.HD)(Q))_?he.color(_,Q):he.color(Q);else if((0,b.mf)(Q)){var Ne=vf(t,"color"),Er=Ne.mappingFields,Fr=Ne.tileMappingField;he.color(Fr,Uh(Er,Q))}else _&&he.color(_,Q);if((0,b.HD)(pt))w?he.shape(w,[pt]):he.shape(pt);else if((0,b.mf)(pt)){var zr=vf(t,"shape"),Er=zr.mappingFields,Fr=zr.tileMappingField;he.shape(Fr,Uh(Er,pt))}else w&&he.shape(w,pt);if((0,b.hj)(vt))k?he.size(k,vt):he.size(vt);else if((0,b.mf)(vt)){var pn=vf(t,"size"),Er=pn.mappingFields,Fr=pn.tileMappingField;he.size(Fr,Uh(Er,vt))}else k&&he.size(k,vt);if((0,b.mf)(Vt)){var nn=vf(t,"style"),Er=nn.mappingFields,Fr=nn.tileMappingField;he.style(Fr,Uh(Er,Vt))}else(0,b.Kn)(Vt)&&he.style(Vt);if(L===!1?he.tooltip(!1):(0,b.xb)(L)||he.tooltip(L.join("*"),Uh(L,le)),R===!1)he.label(!1);else if(R){var Pn=R.callback,Si=R.fields,ha=(0,P._T)(R,["callback","fields"]);he.label({fields:Si||[g],callback:Pn,cfg:Os(ha)})}return U&&he.state(U),G&&he.customInfo(G),[p,g].filter(function(wa){return wa!==_}).forEach(function(wa){e.legend(wa,!1)}),(0,P.pi)((0,P.pi)({},r),{ext:{geometry:he}})}function Gv(r){var e=r.options,t=e.area,i=e.xField,u=e.yField,c=e.seriesField,p=e.smooth,g=e.tooltip,_=e.useDeferredLabel,w=zh(g,[i,u,c]),k=w.fields,L=w.formatter;return t?Fl(hn({},r,{options:{type:"area",colorField:c,tooltipFields:k,mapping:(0,P.pi)({shape:p?"smooth":"area",tooltip:L},t),args:{useDeferredLabel:_}}})):r}function _x(r){var e=r.options,t=e.edge,i=e.xField,u=e.yField,c=e.seriesField,p=e.tooltip,g=e.useDeferredLabel,_=zh(p,[i,u,c]),w=_.fields,k=_.formatter;return t?Fl(hn({},r,{options:{type:"edge",colorField:c,tooltipFields:w,mapping:(0,P.pi)({tooltip:k},t),args:{useDeferredLabel:g}}})):r}function LS(r){var e=r.chart,t=r.options,i=r.ext,u=t.seriesField,c=t.isGroup,p=t.isStack,g=t.marginRatio,_=t.widthRatio,w=t.groupField,k=t.theme,L=[];if(u&&(c&&L.push({type:"dodge",dodgeBy:w||u,marginRatio:g}),p&&L.push({type:"stack",marginRatio:g})),L.length&&(i==null?void 0:i.geometry)){var R=i==null?void 0:i.geometry;R.adjust(L)}return(0,b.UM)(_)||e.theme(hn({},(0,b.Kn)(k)?k:gv(k),{columnWidthRatio:_})),r}function ac(r){var e=r.options,t=e.xField,i=e.yField,u=e.interval,c=e.seriesField,p=e.tooltip,g=e.minColumnWidth,_=e.maxColumnWidth,w=e.columnBackground,k=e.dodgePadding,L=e.intervalPadding,R=e.useDeferredLabel,U=zh(p,[t,i,c]),G=U.fields,Q=U.formatter,pt=(u?Fl(hn({},r,{options:{type:"interval",colorField:c,tooltipFields:G,mapping:(0,P.pi)({tooltip:Q},u),args:{dodgePadding:k,intervalPadding:L,minColumnWidth:g,maxColumnWidth:_,background:w,useDeferredLabel:R}}})):r).ext;return LS((0,P.pi)((0,P.pi)({},r),{ext:pt}))}function C0(r){var e=r.options,t=e.line,i=e.stepType,u=e.xField,c=e.yField,p=e.seriesField,g=e.smooth,_=e.connectNulls,w=e.tooltip,k=e.useDeferredLabel,L=zh(w,[u,c,p]),R=L.fields,U=L.formatter;return t?Fl(hn({},r,{options:{type:"line",colorField:p,tooltipFields:R,mapping:(0,b.b$)({shape:i||(g?"smooth":"line"),tooltip:U},t),args:{connectNulls:_,useDeferredLabel:k}}})):r}function Bf(r){var e=r.options,t=e.point,i=e.xField,u=e.yField,c=e.seriesField,p=e.sizeField,g=e.shapeField,_=e.tooltip,w=e.useDeferredLabel,k=zh(_,[i,u,c,p,g]),L=k.fields,R=k.formatter;return t?Fl(hn({},r,{options:{type:"point",colorField:c,shapeField:g,tooltipFields:L,mapping:(0,P.pi)({tooltip:R},t),args:{useDeferredLabel:w}}})):r}function gg(r){var e=r.options,t=e.polygon,i=e.xField,u=e.yField,c=e.seriesField,p=e.tooltip,g=e.useDeferredLabel,_=zh(p,[i,u,c]),w=_.fields,k=_.formatter;return t?Fl(hn({},r,{options:{type:"polygon",colorField:c,tooltipFields:w,mapping:(0,P.pi)({tooltip:k},t),args:{useDeferredLabel:g}}})):r}function mg(r){var e=r.options,t=e.schema,i=e.xField,u=e.yField,c=e.seriesField,p=e.tooltip,g=e.useDeferredLabel,_=zh(p,[i,u,c]),w=_.fields,k=_.formatter;return t?Fl(hn({},r,{options:{type:"schema",colorField:c,tooltipFields:w,mapping:(0,P.pi)({tooltip:k},t),args:{useDeferredLabel:g}}})):r}function A0(r){var e=r.options,t=e.violin,i=e.xField,u=e.yField,c=e.seriesField,p=e.sizeField,g=e.tooltip,_=zh(g,[i,u,c,p]),w=_.fields,k=_.formatter;return t?Fl(hn({},r,{options:{type:"violin",colorField:c,tooltipFields:w,mapping:(0,P.pi)({tooltip:k},t)}})):r}var PS=ot(18587),xx="data-chart-source-type",OS=["padding","appendPadding","renderer","pixelRatio","syncViewPadding","supportCSSTransform","limitInPlot"],Ha=function(r){(0,P.ZT)(e,r);function e(t,i){var u=r.call(this)||this;return u.container=typeof t=="string"?document.getElementById(t):t,u.options=hn({},u.getDefaultOptions(),i),u.createG2(),u.bindEvents(),u}return e.getDefaultOptions=function(){return{renderer:"canvas",xAxis:{nice:!0,label:{autoRotate:!1,autoHide:{type:"equidistance",cfg:{minGap:6}}}},yAxis:{nice:!0,label:{autoHide:!0,autoRotate:!1}},animation:!0}},e.prototype.createG2=function(){var t=this.options,i=t.width,u=t.height,c=t.defaultInteractions;this.chart=new Fn((0,P.pi)((0,P.pi)((0,P.pi)((0,P.pi)({container:this.container,autoFit:!1},this.getChartSize(i,u)),{localRefresh:!1}),fs(this.options,OS)),{defaultInteractions:c})),this.container.setAttribute(xx,"G2Plot")},e.prototype.getChartSize=function(t,i){var u=ax(this.container);return{width:t||u.width||400,height:i||u.height||400}},e.prototype.bindEvents=function(){var t=this;this.chart&&this.chart.on("*",function(i){i!=null&&i.type&&t.emit(i.type,i)})},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.render=function(){this.chart.clear(),this.chart.options={data:[],animate:!0},this.chart.views=[],this.execAdaptor(),this.chart.render(),this.bindSizeSensor()},e.prototype.update=function(t){this.updateOption(t),this.render()},e.prototype.updateOption=function(t){this.options=hn({},this.options,t)},e.prototype.setState=function(t,i,u){u===void 0&&(u=!0);var c=Bh(this.chart);(0,b.S6)(c,function(p){i(p.getData())&&p.setState(t,u)})},e.prototype.getStates=function(){var t=Bh(this.chart),i=[];return(0,b.S6)(t,function(u){var c=u.getData(),p=u.getStates();(0,b.S6)(p,function(g){i.push({data:c,state:g,geometry:u.geometry,element:u})})}),i},e.prototype.changeData=function(t){this.update({data:t})},e.prototype.changeSize=function(t,i){this.chart.changeSize(t,i)},e.prototype.addAnnotations=function(t,i){i=i||this.chart;var u=(0,P.pr)(t),c=i.getController("annotation"),p=c.getComponents().map(function(w){return w.extra});c.clear(!0);for(var g=function(w){var k=p[w],L=u.findIndex(function(R){return R.id&&R.id===k.id});L!==-1&&(k=hn({},k,u[L]),u.splice(L,1)),c.annotation(k)},_=0;_<p.length;_++)g(_);u.forEach(function(w){return c.annotation(w)}),i.render(!0)},e.prototype.removeAnnotations=function(t){var i=this.chart.getController("annotation"),u=i.getComponents().map(function(g){return g.extra});i.clear(!0);for(var c=function(g){var _=u[g];t.find(function(w){return w.id&&w.id===_.id})||i.annotation(_)},p=0;p<u.length;p++)c(p);this.chart.render(!0)},e.prototype.destroy=function(){this.unbindSizeSensor(),this.chart.destroy(),this.off(),this.container.removeAttribute(xx)},e.prototype.execAdaptor=function(){var t=this.getSchemaAdaptor(),i=this.options,u=i.padding,c=i.appendPadding;this.chart.padding=u,this.chart.appendPadding=c,t({chart:this.chart,options:this.options})},e.prototype.triggerResize=function(){this.chart.forceFit()},e.prototype.bindSizeSensor=function(){var t=this;if(!this.unbind){var i=this.options.autoFit,u=i===void 0?!0:i;u&&(this.unbind=(0,PS.ak)(this.container,function(){var c=ax(t.container),p=c.width,g=c.height;(p!==t.chart.width||g!==t.chart.height)&&t.triggerResize()}))}},e.prototype.unbindSizeSensor=function(){this.unbind&&(this.unbind(),this.unbind=void 0)},e}(er.Z);function FS(r,e,t,i){var u=(0,b.u4)(r,function(c,p){var g=p[t],_=c.has(g)?c.get(g):0,w=p[e];return _=b0(w)?_+w:_,c.set(g,_),c},new Map);return(0,b.UI)(r,function(c){var p,g=c[e],_=c[t],w=b0(g)&&u.get(_)!==0?g/u.get(_):0;return(0,P.pi)((0,P.pi)({},c),(p={},p[i]=w,p))})}function HO(r,e,t,i){var u=(0,b.u4)(r,function(c,p){var g=(0,b.u4)(t,function(k,L){return""+k+p[L]},""),_=c.has(g)?c.get(g):0,w=p[e];return _=b0(w)?_+w:_,c.set(g,_),c},new Map);return(0,b.UI)(r,function(c){var p,g=c[e],_=(0,b.u4)(t,function(k,L){return""+k+c[L]},""),w=b0(g)&&u.get(_)!==0?g/u.get(_):0;return(0,P.pi)((0,P.pi)({},c),(p={},p[i]=w,p))})}function yg(r,e,t,i,u){return u?FS(r,e,t,i):r}function _g(r){var e=r.chart,t=r.options,i=t.data,u=t.color,c=t.lineStyle,p=t.lineShape,g=t.point,_=t.area,w=t.seriesField,k=g==null?void 0:g.state,L=_==null?void 0:_.state;e.data(i);var R=hn({},r,{options:{shapeField:w,line:{color:u,style:c,shape:p},point:g&&(0,P.pi)({color:u,shape:"circle"},g),area:_&&(0,P.pi)({color:u},_),label:void 0}}),U=hn({},R,{options:{tooltip:!1,state:k}}),G=hn({},R,{options:{tooltip:!1,state:L}});return C0(R),Bf(U),Gv(G),r}function Py(r){var e,t,i=r.options,u=i.xAxis,c=i.yAxis,p=i.xField,g=i.yField,_=i.data;return Ga(Zs((e={},e[p]=u,e[g]=c,e),(t={},t[p]={type:"cat"},t[g]=ix(_,g),t)))(r)}function _5(r){var e=r.chart,t=r.options,i=t.reflect;if(i){var u=i;(0,b.kJ)(u)||(u=[u]);var c=u.map(function(p){return["reflect",p]});e.coordinate({type:"rect",actions:c})}return r}function xg(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?e.axis(p,!1):e.axis(p,u),r}function RS(r){var e=r.chart,t=r.options,i=t.legend,u=t.seriesField;return i&&u?e.legend(u,i):i===!1&&e.legend(!1),r}function x5(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=Ec(e,"line");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[u],callback:p,cfg:(0,P.pi)({layout:[{type:"limit-in-plot"},{type:"path-adjust-position"},{type:"point-adjust-position"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Os(g))})}return r}function b5(r){var e=r.chart,t=r.options,i=t.isStack;return i&&(0,b.S6)(e.geometries,function(u){u.adjust("stack")}),r}function E5(r){return Ga(_g,Py,b5,Bo,_5,xg,RS,hl,x5,Vu,ad,Xs,ms,Ys(),Df)(r)}function Oy(r){var e=r.chart,t=r.options,i=t.data,u=t.areaStyle,c=t.color,p=t.point,g=t.line,_=t.isPercent,w=t.xField,k=t.yField,L=t.tooltip,R=t.seriesField,U=t.startOnZero,G=p==null?void 0:p.state,Q=yg(i,k,w,k,_);e.data(Q);var pt=_?(0,P.pi)({formatter:function(he){return{name:he[R]||he[w],value:(Number(he[k])*100).toFixed(2)+"%"}}},L):L,vt=hn({},r,{options:{area:{color:c,style:u},point:p&&(0,P.pi)({color:c},p),tooltip:pt,label:void 0,args:{startOnZero:U}}}),Vt={chart:e,options:hn({line:{size:2}},(0,b.CE)(t,["state"]),{line:g&&(0,P.pi)({color:c},g),sizeField:R,state:g==null?void 0:g.state,tooltip:!1,label:void 0,args:{startOnZero:U}})},le=hn({},vt,{options:{tooltip:!1,state:G}});return Gv(vt),C0(Vt),Bf(le),r}function Fy(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=Ec(e,"area");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[u],callback:p,cfg:(0,P.pi)({layout:[{type:"limit-in-plot"},{type:"path-adjust-position"},{type:"point-adjust-position"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Os(g))})}return r}function jO(r){var e=r.chart,t=r.options,i=t.isStack,u=t.isPercent,c=t.seriesField;return(u||i)&&c&&(0,b.S6)(e.geometries,function(p){p.adjust("stack")}),r}function DS(r){return Ga(Bo,Nh("areaStyle"),w0("rect"),Oy,Py,jO,xg,RS,hl,Fy,Vu,Ys(),Xs,ms,Df)(r)}var WO=hn({},Ha.getDefaultOptions(),{tooltip:{shared:!0,showMarkers:!0,showCrosshairs:!0,crosshairs:{type:"x"}},isStack:!0,line:{},legend:{position:"top-left",radio:{}}}),S5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="area",t}return e.getDefaultOptions=function(){return WO},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options,u=i.isPercent,c=i.xField,p=i.yField,g=this,_=g.chart,w=g.options;Py({chart:_,options:w}),this.chart.changeData(yg(t,p,c,p,u))},e.prototype.getSchemaAdaptor=function(){return DS},e}(Ha),XO=10,w5=5,Ry={padding:[8,10],text:"reset",textStyle:{default:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"}},buttonStyle:{default:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},active:{fill:"#e6e6e6"}}},YO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.buttonGroup=null,t.buttonCfg=(0,P.pi)({name:"button"},Ry),t}return e.prototype.getButtonCfg=function(){var t=this.context.view,i=(0,b.U2)(t,["interactions","filter-action","cfg","buttonConfig"]);return hn(this.buttonCfg,i,this.cfg)},e.prototype.drawButton=function(){var t=this.getButtonCfg(),i=this.context.view.foregroundGroup.addGroup({name:t.name}),u=this.drawText(i);this.drawBackground(i,u.getBBox()),this.buttonGroup=i},e.prototype.drawText=function(t){var i,u=this.getButtonCfg();return t.addShape({type:"text",name:"button-text",attrs:(0,P.pi)({text:u.text},(i=u.textStyle)===null||i===void 0?void 0:i.default)})},e.prototype.drawBackground=function(t,i){var u,c=this.getButtonCfg(),p=Vv(c.padding),g=t.addShape({type:"rect",name:"button-rect",attrs:(0,P.pi)({x:i.x-p[3],y:i.y-p[0],width:i.width+p[1]+p[3],height:i.height+p[0]+p[2]},(u=c.buttonStyle)===null||u===void 0?void 0:u.default)});return g.toBack(),t.on("mouseenter",function(){var _;g.attr((_=c.buttonStyle)===null||_===void 0?void 0:_.active)}),t.on("mouseleave",function(){var _;g.attr((_=c.buttonStyle)===null||_===void 0?void 0:_.default)}),g},e.prototype.resetPosition=function(){var t=this.context.view,i=t.getCoordinate(),u=i.convert({x:1,y:1}),c=this.buttonGroup,p=c.getBBox(),g=_c.transform(null,[["t",u.x-p.width-XO,u.y+p.height+w5]]);c.setMatrix(g)},e.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},e.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},e.prototype.destroy=function(){var t=this.buttonGroup;t&&t.remove(),r.prototype.destroy.call(this)},e}(oi);Yn("brush-reset-button",YO,{name:"brush-reset-button"}),kn("filter-action",{});function Hv(r){return r.isInPlot()}function T0(r,e,t){var i=t||{},u=i.mask,c=i.isStartEnable,p=e||"rect";switch(r){case"brush":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:c||Hv,action:["brush:start",p+"-mask:start",p+"-mask:show"],arg:[null,{maskStyle:u==null?void 0:u.style}]}],processing:[{trigger:"mousemove",isEnable:Hv,action:[p+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Hv,action:["brush:filter","brush:end",p+"-mask:end",p+"-mask:hide","brush-reset-button:show"]}],rollback:[{trigger:"brush-reset-button:click",action:["brush:reset","brush-reset-button:hide","cursor:crosshair"]}]};case"brush-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mousemove",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mousemove",action:"cursor:default",isEnable:function(g){return c?!c(g):!1}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:c||function(g){return!g.isInShape("mask")},action:[p+"-mask:start",p+"-mask:show"],arg:[{maskStyle:u==null?void 0:u.style}]},{trigger:"mask:dragstart",action:[p+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[p+"-mask:resize"]},{trigger:"mask:drag",action:[p+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[p+"-mask:end"]},{trigger:"mask:dragend",action:[p+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(g){return!g.isInPlot()},action:["element-range-highlight:clear",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",p+"-mask:hide"]}]};case"brush-x":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:c||Hv,action:["brush-x:start",p+"-mask:start",p+"-mask:show"],arg:[null,{maskStyle:u==null?void 0:u.style}]}],processing:[{trigger:"mousemove",isEnable:Hv,action:[p+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Hv,action:["brush-x:filter","brush-x:end",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]};case"brush-x-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:c||function(g){return!g.isInShape("mask")},action:[p+"-mask:start",p+"-mask:show"],arg:[{maskStyle:u==null?void 0:u.style}]},{trigger:"mask:dragstart",action:[p+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[p+"-mask:resize"]},{trigger:"mask:drag",action:[p+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[p+"-mask:end"]},{trigger:"mask:dragend",action:[p+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(g){return!g.isInPlot()},action:["element-range-highlight:clear",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",p+"-mask:hide"]}]};case"brush-y":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:c||Hv,action:["brush-y:start",p+"-mask:start",p+"-mask:show"],arg:[null,{maskStyle:u==null?void 0:u.style}]}],processing:[{trigger:"mousemove",isEnable:Hv,action:[p+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Hv,action:["brush-y:filter","brush-y:end",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-y:reset"]}]};case"brush-y-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:c||function(g){return!g.isInShape("mask")},action:[p+"-mask:start",p+"-mask:show"],arg:[{maskStyle:u==null?void 0:u.style}]},{trigger:"mask:dragstart",action:[p+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[p+"-mask:resize"]},{trigger:"mask:drag",action:[p+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[p+"-mask:end"]},{trigger:"mask:dragend",action:[p+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(g){return!g.isInPlot()},action:["element-range-highlight:clear",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",p+"-mask:hide"]}]};default:return{}}}kn("brush",T0("brush")),kn("brush-highlight",T0("brush-highlight")),kn("brush-x",T0("brush-x","x-rect")),kn("brush-y",T0("brush-y","y-rect")),kn("brush-x-highlight",T0("brush-x-highlight","x-rect")),kn("brush-y-highlight",T0("brush-y-highlight","y-rect"));var BS=["brush","brush-x","brush-y","brush-highlight","brush-x-highlight","brush-y-highlight"];function NS(r){var e=r.options,t=e.brush,i=(0,b.hX)(e.interactions||[],function(u){return BS.indexOf(u.type)===-1});return t!=null&&t.enabled&&(BS.forEach(function(u){var c=!1;switch(t.type){case"x-rect":c=u===(t.action==="highlight"?"brush-x-highlight":"brush-x");break;case"y-rect":c=u===(t.action==="highlight"?"brush-y-highlight":"brush-y");break;default:c=u===(t.action==="highlight"?"brush-highlight":"brush");break}var p={type:u,enable:c};t&&(p.cfg=T0(u,t.type,t)),i.push(p)}),(t==null?void 0:t.action)!=="highlight"&&i.push({type:"filter-action",cfg:{buttonConfig:t.button}})),hn({},r,{options:{interactions:i}})}var M0={hover:"__interval-connected-area-hover__",click:"__interval-connected-area-click__"},bx=function(r,e){return r==="hover"?[{trigger:"interval:mouseenter",action:["element-highlight-by-color:highlight","element-link-by-color:link"],arg:[null,{style:e}]}]:[{trigger:"interval:click",action:["element-highlight-by-color:clear","element-highlight-by-color:highlight","element-link-by-color:clear","element-link-by-color:unlink","element-link-by-color:link"],arg:[null,null,null,null,{style:e}]}]};kn(M0.hover,{start:bx(M0.hover),end:[{trigger:"interval:mouseleave",action:["element-highlight-by-color:reset","element-link-by-color:unlink"]}]}),kn(M0.click,{start:bx(M0.click),end:[{trigger:"document:mousedown",action:["element-highlight-by-color:clear","element-link-by-color:clear"]}]});function C5(r){return r===void 0&&(r=!1),function(e){var t=e.chart,i=e.options,u=i.connectedArea,c=function(){t.removeInteraction(M0.hover),t.removeInteraction(M0.click)};if(!r&&u){var p=u.trigger||"hover";c(),t.interaction(M0[p],{start:bx(p,u.style)})}else c();return e}}function zS(r,e){return!(0,b.hj)(r)||!(0,b.hj)(e)||r===0&&e===0?"-":r===e?"100%":r===0?"\u221E":(100*e/r).toFixed(2)+"%"}function A5(r,e){return hn({size:e?32:80,spacing:e?8:12,offset:e?32:0,arrow:r.arrow!==!1&&{headSize:12,style:{fill:"rgba(0, 0, 0, 0.05)"}},text:r.text!==!1&&{style:{fontSize:12,fill:"rgba(0, 0, 0, 0.85)",textAlign:"center",textBaseline:"middle"},formatter:zS}},r)}function Dy(r,e){return(0,b.UI)(e.getModel().points,function(t){return r.convertPoint(t)})}function T5(r,e,t){var i=r.view,u=r.geometry,c=r.group,p=r.options,g=r.horizontal,_=p.offset,w=p.size,k=p.arrow,L=i.getCoordinate(),R=Dy(L,e)[3],U=Dy(L,t)[0],G=U.y-R.y,Q=U.x-R.x;if(typeof k!="boolean"){var pt=k.headSize,vt=p.spacing,Vt;g?(Q-pt)/2<vt?(vt=Math.max(1,(Q-pt)/2),Vt=[[R.x+vt,R.y-_],[R.x+vt,R.y-_-w],[U.x-vt,U.y-_-w/2]]):Vt=[[R.x+vt,R.y-_],[R.x+vt,R.y-_-w],[U.x-vt-pt,U.y-_-w],[U.x-vt,U.y-_-w/2],[U.x-vt-pt,U.y-_]]:(G-pt)/2<vt?(vt=Math.max(1,(G-pt)/2),Vt=[[R.x+_,R.y+vt],[R.x+_+w,R.y+vt],[U.x+_+w/2,U.y-vt]]):Vt=[[R.x+_,R.y+vt],[R.x+_+w,R.y+vt],[U.x+_+w,U.y-vt-pt],[U.x+_+w/2,U.y-vt],[U.x+_,U.y-vt-pt]],c.addShape("polygon",{id:i.id+"-conversion-tag-arrow-"+u.getElementId(e.getModel().mappingData),name:"conversion-tag-arrow",origin:{element:e,nextElement:t},attrs:(0,P.pi)((0,P.pi)({},k.style||{}),{points:Vt})})}}function M5(r,e,t){var i,u,c,p=r.view,g=r.geometry,_=r.group,w=r.options,k=r.field,L=r.horizontal,R=w.offset,U=w.size;if(typeof w.text!="boolean"){var G=p.getCoordinate(),Q=((i=w.text)===null||i===void 0?void 0:i.formatter)&&((u=w.text)===null||u===void 0?void 0:u.formatter(e.getData()[k],t.getData()[k])),pt=Dy(G,e)[L?3:0],vt=Dy(G,t)[L?0:3],Vt=_.addShape("text",{id:p.id+"-conversion-tag-text-"+g.getElementId(e.getModel().mappingData),name:"conversion-tag-text",origin:{element:e,nextElement:t},attrs:(0,P.pi)((0,P.pi)({},((c=w.text)===null||c===void 0?void 0:c.style)||{}),{text:Q,x:L?(pt.x+vt.x)/2:pt.x+R+U/2,y:L?pt.y-R-U/2:(pt.y+vt.y)/2})});if(L){var le=vt.x-pt.x,he=Vt.getBBox().width;if(he>le){var Ne=he/Q.length,Er=Math.max(1,Math.ceil(le/Ne)-1),Fr=Q.slice(0,Er)+"...";Vt.attr("text",Fr)}}}}function I5(r,e,t){T5(r,e,t),M5(r,e,t)}function k5(r,e,t){return e===void 0&&(e=!0),t===void 0&&(t=!1),function(i){var u=i.options,c=i.chart,p=u.conversionTag,g=u.theme;return p&&!t&&(c.theme(hn({},(0,b.Kn)(g)?g:gv(g),{columnWidthRatio:1/3})),c.annotation().shape({render:function(_,w){var k=_.addGroup({id:c.id+"-conversion-tag-group",name:"conversion-tag-group"}),L=(0,b.sE)(c.geometries,function(G){return G.type==="interval"}),R={view:w,geometry:L,group:k,field:r,horizontal:e,options:A5(p,e)},U=L.elements;(0,b.S6)(U,function(G,Q){Q>0&&I5(R,U[Q-1],G)})}})),i}}function L5(r){var e=r.options,t=e.legend,i=e.seriesField,u=e.isStack;return i?t!==!1&&(t=(0,P.pi)({position:u?"right-top":"top-left"},t)):t=!1,r.options.legend=t,r}function P5(r){var e=r.chart,t=r.options,i=t.data,u=t.columnStyle,c=t.color,p=t.columnWidthRatio,g=t.isPercent,_=t.isGroup,w=t.isStack,k=t.xField,L=t.yField,R=t.seriesField,U=t.groupField,G=t.tooltip,Q=t.shape,pt=g&&_&&w?HO(i,L,[k,U],L):yg(i,L,k,L,g),vt=[];w&&R&&!_?pt.forEach(function(he){var Ne=vt.find(function(Er){return Er[k]===he[k]&&Er[R]===he[R]});Ne?Ne[L]+=he[L]||0:vt.push((0,P.pi)({},he))}):vt=pt,e.data(vt);var Vt=g?(0,P.pi)({formatter:function(he){return{name:_&&w?he[R]+" - "+he[U]:he[R]||he[k],value:(Number(he[L])*100).toFixed(2)+"%"}}},G):G,le=hn({},r,{options:{data:vt,widthRatio:p,tooltip:Vt,interval:{shape:Q,style:u,color:c}}});return ac(le),le}function Ex(r){var e,t,i=r.options,u=i.xAxis,c=i.yAxis,p=i.xField,g=i.yField,_=i.data,w=i.isPercent,k=w?{max:1,min:0,minLimit:0,maxLimit:1}:{};return Ga(Zs((e={},e[p]=u,e[g]=c,e),(t={},t[p]={type:"cat"},t[g]=(0,P.pi)((0,P.pi)({},ix(_,g)),k),t)))(r)}function O5(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?e.axis(p,!1):e.axis(p,u),r}function F5(r){var e=r.chart,t=r.options,i=t.legend,u=t.seriesField;return i&&u?e.legend(u,i):i===!1&&e.legend(!1),r}function R5(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=t.isRange,p=Ec(e,"interval");if(!i)p.label(!1);else{var g=i.callback,_=(0,P._T)(i,["callback"]);p.label({fields:[u],callback:g,cfg:(0,P.pi)({layout:_!=null&&_.position?void 0:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Os(c?(0,P.pi)({content:function(w){var k;return(k=w[u])===null||k===void 0?void 0:k.join("-")}},_):_))})}return r}function D5(r){var e=r.chart,t=r.options,i=t.tooltip,u=t.isGroup,c=t.isStack,p=t.groupField,g=t.data,_=t.xField,w=t.yField,k=t.seriesField;if(i===!1)e.tooltip(!1);else{var L=i;if(u&&c){var R=L.customItems,U=(L==null?void 0:L.formatter)||function(G){return{name:G[k]+" - "+G[p],value:G[w]}};L=(0,P.pi)((0,P.pi)({},L),{customItems:function(G){var Q=[];return(0,b.S6)(G,function(pt){var vt=(0,b.hX)(g,function(Vt){return(0,b.BD)(Vt,fs(pt.data,[_,k]))});vt.forEach(function(Vt){Q.push((0,P.pi)((0,P.pi)((0,P.pi)({},pt),{value:Vt[w],data:Vt,mappingData:{_origin:Vt}}),U(Vt)))})}),R?R(Q):Q}})}e.tooltip(L)}return r}function By(r,e){e===void 0&&(e=!1);var t=r.options,i=t.seriesField;return Ga(L5,Bo,Nh("columnStyle"),S0,w0("rect"),P5,Ex,O5,F5,D5,Vu,ad,R5,NS,Xs,ms,Ys(),k5(t.yField,!e,!!i),C5(!t.isStack),Df)(r)}function B5(r){var e=r.options,t=e.xField,i=e.yField,u=e.xAxis,c=e.yAxis,p={left:"bottom",right:"top",top:"left",bottom:"right"},g=c!==!1?(0,P.pi)({position:p[(c==null?void 0:c.position)||"left"]},c):!1,_=u!==!1?(0,P.pi)({position:p[(u==null?void 0:u.position)||"bottom"]},u):!1;return(0,P.pi)((0,P.pi)({},r),{options:(0,P.pi)((0,P.pi)({},e),{xField:i,yField:t,xAxis:g,yAxis:_})})}function N5(r){var e=r.options,t=e.label;return t&&!t.position&&(t.position="left",t.layout||(t.layout=[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}])),hn({},r,{options:{label:t}})}function z5(r){var e=r.options,t=e.seriesField,i=e.isStack,u=e.legend;return t?u!==!1&&(u=(0,P.pi)({position:i?"top-left":"right-top"},u||{})):u=!1,hn({},r,{options:{legend:u}})}function U5(r){var e=r.options,t=[{type:"transpose"},{type:"reflectY"}].concat(e.coordinate||[]);return hn({},r,{options:{coordinate:t}})}function Z5(r){var e=r.chart,t=r.options,i=t.barStyle,u=t.barWidthRatio,c=t.minBarWidth,p=t.maxBarWidth,g=t.barBackground;return By({chart:e,options:(0,P.pi)((0,P.pi)({},t),{columnStyle:i,columnWidthRatio:u,minColumnWidth:c,maxColumnWidth:p,columnBackground:g})},!0)}function US(r){return Ga(B5,N5,z5,hl,U5,Z5)(r)}var V5=hn({},Ha.getDefaultOptions(),{barWidthRatio:.6,marginRatio:1/32,tooltip:{shared:!0,showMarkers:!1,offset:20},legend:{radio:{}},interactions:[{type:"active-region"}]}),ZS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="bar",t}return e.getDefaultOptions=function(){return V5},e.prototype.changeData=function(t){var i,u;this.updateOption({data:t});var c=this,p=c.chart,g=c.options,_=g.isPercent,w=g.xField,k=g.yField,L=g.xAxis,R=g.yAxis;i=[k,w],w=i[0],k=i[1],u=[R,L],L=u[0],R=u[1];var U=(0,P.pi)((0,P.pi)({},g),{xField:w,yField:k,yAxis:R,xAxis:L});Ex({chart:p,options:U}),p.changeData(yg(t,w,k,w,_))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return US},e}(Ha),G5=hn({},Ha.getDefaultOptions(),{columnWidthRatio:.6,marginRatio:1/32,tooltip:{shared:!0,showMarkers:!1,offset:20},legend:{radio:{}},interactions:[{type:"active-region"}]}),VS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="column",t}return e.getDefaultOptions=function(){return G5},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options,u=i.yField,c=i.xField,p=i.isPercent,g=this,_=g.chart,w=g.options;Ex({chart:_,options:w}),this.chart.changeData(yg(t,u,c,u,p))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return By},e}(Ha),Sx,jv="$$percentage$$",Wv="$$mappingValue$$",Kd="$$conversion$$",Cx="$$totalPercentage$$",cm="$$x$$",bg="$$y$$",Eg={appendPadding:[0,80],minSize:0,maxSize:1,meta:(Sx={},Sx[Wv]={min:0,max:1,nice:!1},Sx),label:{style:{fill:"#fff",fontSize:12}},tooltip:{showTitle:!1,showMarkers:!1,shared:!1},conversionTag:{offsetX:10,offsetY:0,style:{fontSize:12,fill:"rgba(0,0,0,0.45)"}}},Ny="CONVERSION_TAG_NAME";function zy(r,e,t){var i=[],u=t.yField,c=t.maxSize,p=t.minSize,g=(0,b.U2)((0,b.UT)(e,u),[u]),_=(0,b.hj)(c)?c:1,w=(0,b.hj)(p)?p:0;return i=(0,b.UI)(r,function(k,L){var R=(k[u]||0)/g;return k[jv]=R,k[Wv]=(_-w)*R+w,k[Kd]=[(0,b.U2)(r,[L-1,u]),k[u]],k}),i}function Ax(r){return function(e){var t=e.chart,i=e.options,u=i.conversionTag,c=i.filteredData,p=c||t.getOptions().data;if(u){var g=u.formatter;p.forEach(function(_,w){if(!(w<=0||Number.isNaN(_[Wv]))){var k=r(_,w,p,{top:!0,name:Ny,text:{content:(0,b.mf)(g)?g(_,p):g,offsetX:u.offsetX,offsetY:u.offsetY,position:"end",autoRotate:!1,style:(0,P.pi)({textAlign:"start",textBaseline:"middle"},u.style)}});t.annotation().line(k)}})}return e}}function H5(r){var e=r.chart,t=r.options,i=t.data,u=i===void 0?[]:i,c=t.yField,p=t.maxSize,g=t.minSize,_=zy(u,u,{yField:c,maxSize:p,minSize:g});return e.data(_),r}function j5(r){var e=r.chart,t=r.options,i=t.xField,u=t.yField,c=t.color,p=t.tooltip,g=t.label,_=t.shape,w=_===void 0?"funnel":_,k=t.funnelStyle,L=t.state,R=zh(p,[i,u]),U=R.fields,G=R.formatter;Fl({chart:e,options:{type:"interval",xField:i,yField:Wv,colorField:i,tooltipFields:(0,b.kJ)(U)&&U.concat([jv,Kd]),mapping:{shape:w,tooltip:G,color:c,style:k},label:g,state:L}});var Q=Ec(r.chart,"interval");return Q.adjust("symmetric"),r}function W5(r){var e=r.chart,t=r.options,i=t.isTransposed;return e.coordinate({type:"rect",actions:i?[]:[["transpose"],["scale",1,-1]]}),r}function GS(r){var e=r.options,t=r.chart,i=e.maxSize,u=(0,b.U2)(t,["geometries","0","dataArray"],[]),c=(0,b.U2)(t,["options","data","length"]),p=(0,b.UI)(u,function(_){return(0,b.U2)(_,["0","nextPoints","0","x"])*c-.5}),g=function(_,w,k,L){var R=i-(i-_[Wv])/2;return(0,P.pi)((0,P.pi)({},L),{start:[p[w-1]||w-.5,R],end:[p[w-1]||w-.5,R+.05]})};return Ax(g)(r),r}function Tx(r){return Ga(H5,j5,W5,GS)(r)}function X5(r){var e,t=r.chart,i=r.options,u=i.data,c=u===void 0?[]:u,p=i.yField;return t.data(c),t.scale((e={},e[p]={sync:!0},e)),r}function Y5(r){var e=r.chart,t=r.options,i=t.data,u=t.xField,c=t.yField,p=t.color,g=t.compareField,_=t.isTransposed,w=t.tooltip,k=t.maxSize,L=t.minSize,R=t.label,U=t.funnelStyle,G=t.state,Q=t.showFacetTitle;return e.facet("mirror",{fields:[g],transpose:!_,padding:_?0:[32,0,0,0],showTitle:Q,eachView:function(pt,vt){var Vt=_?vt.rowIndex:vt.columnIndex;_||pt.coordinate({type:"rect",actions:[["transpose"],["scale",Vt===0?-1:1,-1]]});var le=zy(vt.data,i,{yField:c,maxSize:k,minSize:L});pt.data(le);var he=zh(w,[u,c,g]),Ne=he.fields,Er=he.formatter,Fr=_?{offset:Vt===0?10:-23,position:Vt===0?"bottom":"top"}:{offset:10,position:"left",style:{textAlign:Vt===0?"end":"start"}};Fl({chart:pt,options:{type:"interval",xField:u,yField:Wv,colorField:u,tooltipFields:(0,b.kJ)(Ne)&&Ne.concat([jv,Kd]),mapping:{shape:"funnel",tooltip:Er,color:p,style:U},label:R===!1?!1:hn({},Fr,R),state:G}})}}),r}function Mx(r){var e=r.chart,t=r.index,i=r.options,u=i.conversionTag,c=i.isTransposed;((0,b.hj)(t)?[e]:e.views).forEach(function(p,g){var _=(0,b.U2)(p,["geometries","0","dataArray"],[]),w=(0,b.U2)(p,["options","data","length"]),k=(0,b.UI)(_,function(R){return(0,b.U2)(R,["0","nextPoints","0","x"])*w-.5}),L=function(R,U,G,Q){var pt=(t||g)===0?-1:1;return hn({},Q,{start:[k[U-1]||U-.5,R[Wv]],end:[k[U-1]||U-.5,R[Wv]+.05],text:c?{style:{textAlign:"start"}}:{offsetX:u!==!1?pt*u.offsetX:0,style:{textAlign:(t||g)===0?"end":"start"}}})};Ax(L)(hn({},{chart:p,options:i}))})}function $5(r){var e=r.chart;return e.once("beforepaint",function(){return Mx(r)}),r}function q5(r){return Ga(X5,Y5,$5)(r)}function K5(r){var e=r.chart,t=r.options,i=t.data,u=i===void 0?[]:i,c=t.yField,p=(0,b.u4)(u,function(w,k){return w+(k[c]||0)},0),g=(0,b.UT)(u,c)[c],_=(0,b.UI)(u,function(w,k){var L=[],R=[];if(w[Cx]=(w[c]||0)/p,k){var U=u[k-1][cm],G=u[k-1][bg];L[0]=U[3],R[0]=G[3],L[1]=U[2],R[1]=G[2]}else L[0]=-.5,R[0]=1,L[1]=.5,R[1]=1;return R[2]=R[1]-w[Cx],L[2]=(R[2]+1)/4,R[3]=R[2],L[3]=-L[2],w[cm]=L,w[bg]=R,w[jv]=(w[c]||0)/g,w[Kd]=[(0,b.U2)(u,[k-1,c]),w[c]],w});return e.data(_),r}function Q5(r){var e=r.chart,t=r.options,i=t.xField,u=t.yField,c=t.color,p=t.tooltip,g=t.label,_=t.funnelStyle,w=t.state,k=zh(p,[i,u]),L=k.fields,R=k.formatter;return Fl({chart:e,options:{type:"polygon",xField:cm,yField:bg,colorField:i,tooltipFields:(0,b.kJ)(L)&&L.concat([jv,Kd]),label:g,state:w,mapping:{tooltip:R,color:c,style:_}}}),r}function J5(r){var e=r.chart,t=r.options,i=t.isTransposed;return e.coordinate({type:"rect",actions:i?[["transpose"],["reflect","x"]]:[]}),r}function tI(r){var e=function(t,i,u,c){return(0,P.pi)((0,P.pi)({},c),{start:[t[cm][1],t[bg][1]],end:[t[cm][1]+.05,t[bg][1]]})};return Ax(e)(r),r}function eI(r){return Ga(K5,Q5,J5,tI)(r)}function rI(r){var e,t=r.chart,i=r.options,u=i.data,c=u===void 0?[]:u,p=i.yField;return t.data(c),t.scale((e={},e[p]={sync:!0},e)),r}function nI(r){var e=r.chart,t=r.options,i=t.seriesField,u=t.isTransposed,c=t.showFacetTitle;return e.facet("rect",{fields:[i],padding:[u?0:32,10,0,10],showTitle:c,eachView:function(p,g){Tx(hn({},r,{chart:p,options:{data:g.data}}))}}),r}function HS(r){return Ga(rI,nI)(r)}var iI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.rendering=!1,t}return e.prototype.change=function(t){var i=this;if(!this.rendering){var u=t.seriesField,c=t.compareField,p=c?Mx:GS,g=this.context.view,_=u||c?g.views:[g];(0,b.UI)(_,function(w,k){var L=w.getController("annotation"),R=(0,b.hX)((0,b.U2)(L,["option"],[]),function(G){var Q=G.name;return Q!==Ny});L.clear(!0),(0,b.S6)(R,function(G){typeof G=="object"&&w.annotation()[G.type](G)});var U=(0,b.U2)(w,["filteredData"],w.getOptions().data);p({chart:w,index:k,options:(0,P.pi)((0,P.pi)({},t),{filteredData:zy(U,U,t)})}),w.filterData(U),i.rendering=!0,w.render(!0)})}this.rendering=!1},e}(oi),jS="funnel-conversion-tag",Ix="funnel-afterrender",WS={trigger:"afterrender",action:jS+":change"};Yn(jS,iI),kn(Ix,{start:[WS]});function aI(r){var e=r.options,t=e.compareField,i=e.xField,u=e.yField,c=e.locale,p=e.funnelStyle,g=e.data,_=yx(c),w={label:t?{fields:[i,u,t,jv,Kd],formatter:function(L){return""+L[u]}}:{fields:[i,u,jv,Kd],offset:0,position:"middle",formatter:function(L){return L[i]+" "+L[u]}},tooltip:{title:i,formatter:function(L){return{name:L[i],value:L[u]}}},conversionTag:{formatter:function(L){return _.get(["conversionTag","label"])+": "+zS.apply(void 0,L[Kd])}}},k;return(t||p)&&(k=function(L){return hn({},t&&{lineWidth:1,stroke:"#fff"},(0,b.mf)(p)?p(L):p)}),hn({options:w},r,{options:{funnelStyle:k,data:(0,b.d9)(g)}})}function oI(r){var e=r.options,t=e.compareField,i=e.dynamicHeight,u=e.seriesField;return u?HS(r):t?q5(r):i?eI(r):Tx(r)}function sI(r){var e,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return Ga(Zs((e={},e[c]=i,e[p]=u,e)))(r)}function uI(r){var e=r.chart;return e.axis(!1),r}function lI(r){var e=r.chart,t=r.options,i=t.legend;return i===!1?e.legend(!1):e.legend(i),r}function cI(r){var e=r.chart,t=r.options,i=t.interactions,u=t.dynamicHeight;return(0,b.S6)(i,function(c){c.enable===!1?e.removeInteraction(c.type):e.interaction(c.type,c.cfg||{})}),u?e.removeInteraction(Ix):e.interaction(Ix,{start:[(0,P.pi)((0,P.pi)({},WS),{arg:t})]}),r}function XS(r){return Ga(aI,oI,sI,uI,hl,cI,lI,ms,Bo,Ys())(r)}var fI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="funnel",t}return e.getDefaultOptions=function(){return Eg},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return XS},e.prototype.setState=function(t,i,u){u===void 0&&(u=!0);var c=Bh(this.chart);(0,b.S6)(c,function(p){i(p.getData())&&p.setState(t,u)})},e.prototype.getStates=function(){var t=Bh(this.chart),i=[];return(0,b.S6)(t,function(u){var c=u.getData(),p=u.getStates();(0,b.S6)(p,function(g){i.push({data:c,state:g,geometry:u.geometry,element:u})})}),i},e.CONVERSATION_FIELD=Kd,e.PERCENT_FIELD=jv,e.TOTAL_PERCENT_FIELD=Cx,e}(Ha),Uy,kx="range",YS="type",Qd="percent",hI="#f0f0f0",Sg="indicator-view",$S="range-view",pI={percent:0,range:{ticks:[]},innerRadius:.9,radius:.95,startAngle:-7/6*Math.PI,endAngle:1/6*Math.PI,syncViewPadding:!0,axis:{line:null,label:{offset:-24,style:{textAlign:"center",textBaseline:"middle"}},subTickLine:{length:-8},tickLine:{length:-12},grid:null},indicator:{pointer:{style:{lineWidth:5,lineCap:"round"}},pin:{style:{r:9.75,lineWidth:4.5,fill:"#fff"}}},statistic:{title:!1},meta:(Uy={},Uy[kx]={sync:"v"},Uy[Qd]={sync:"v",tickCount:5,tickInterval:.2},Uy),animation:!1};function dI(r,e){return r.map(function(t,i){var u;return u={},u[kx]=t-(r[i-1]||0),u[YS]=""+i,u[Qd]=e,u})}function qS(r){var e;return[(e={},e[Qd]=(0,b.uZ)(r,0,1),e)]}function KS(r,e){var t=(0,b.U2)(e,["ticks"],[]),i=(0,b.dp)(t)?(0,b.jj)(t):[0,(0,b.uZ)(r,0,1),1];return i[0]||i.shift(),dI(i,r)}function vI(r){var e=r.chart,t=r.options,i=t.percent,u=t.range,c=t.radius,p=t.innerRadius,g=t.startAngle,_=t.endAngle,w=t.axis,k=t.indicator,L=t.gaugeStyle,R=t.type,U=t.meter,G=u.color,Q=u.width;if(k){var pt=qS(i),vt=e.createView({id:Sg});vt.data(pt),vt.point().position(Qd+"*1").shape(k.shape||"gauge-indicator").customInfo({defaultColor:e.getTheme().defaultColor,indicator:k}),vt.coordinate("polar",{startAngle:g,endAngle:_,radius:p*c}),vt.axis(Qd,w),vt.scale(Qd,fs(w,Rf))}var Vt=KS(i,t.range),le=e.createView({id:$S});le.data(Vt);var he=(0,b.HD)(G)?[G,hI]:G,Ne=ac({chart:le,options:{xField:"1",yField:kx,seriesField:YS,rawFields:[Qd],isStack:!0,interval:{color:he,style:L,shape:R==="meter"?"meter-gauge":null},args:{zIndexReversed:!0,sortZIndex:!0},minColumnWidth:Q,maxColumnWidth:Q}}).ext,Er=Ne.geometry;return Er.customInfo({meter:U}),le.coordinate("polar",{innerRadius:p,radius:c,startAngle:g,endAngle:_}).transpose(),r}function gI(r){var e;return Ga(Zs((e={range:{min:0,max:1,maxLimit:1,minLimit:0}},e[Qd]={},e)))(r)}function QS(r,e){var t=r.chart,i=r.options,u=i.statistic,c=i.percent;if(t.getController("annotation").clear(!0),u){var p=u.content,g=void 0;p&&(g=hn({},{content:(c*100).toFixed(2)+"%",style:{opacity:.75,fontSize:"30px",lineHeight:1,textAlign:"center",color:"rgba(44,53,66,0.85)"}},p)),g5(t,{statistic:(0,P.pi)((0,P.pi)({},u),{content:g})},{percent:c})}return e&&t.render(!0),r}function mI(r){var e=r.chart,t=r.options,i=t.tooltip;return i?e.tooltip(hn({showTitle:!1,showMarkers:!1,containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',domStyles:{"g2-tooltip":{padding:"4px 8px",fontSize:"10px"}},customContent:function(u,c){var p=(0,b.U2)(c,[0,"data",Qd],0);return(p*100).toFixed(2)+"%"}},i)):e.tooltip(!1),r}function yI(r){var e=r.chart;return e.legend(!1),r}function JS(r){return Ga(Bo,ms,vI,gI,mI,QS,Xs,Ys(),yI)(r)}va("point","gauge-indicator",{draw:function(r,e){var t=r.customInfo,i=t.indicator,u=t.defaultColor,c=i,p=c.pointer,g=c.pin,_=e.addGroup(),w=this.parsePoint({x:0,y:0});return p&&_.addShape("line",{name:"pointer",attrs:(0,P.pi)({x1:w.x,y1:w.y,x2:r.x,y2:r.y,stroke:u},p.style)}),g&&_.addShape("circle",{name:"pin",attrs:(0,P.pi)({x:w.x,y:w.y,stroke:u},g.style)}),_}}),va("interval","meter-gauge",{draw:function(r,e){var t=r.customInfo.meter,i=t===void 0?{}:t,u=i.steps,c=u===void 0?50:u,p=i.stepRatio,g=p===void 0?.5:p;c=c<1?1:c,g=(0,b.uZ)(g,0,1);var _=this.coordinate,w=_.startAngle,k=_.endAngle,L=0;if(g>0&&g<1){var R=k-w;L=R/c/(g/(1-g)+1-1/c)}for(var U=L/(1-g)*g,G=e.addGroup(),Q=this.coordinate.getCenter(),pt=this.coordinate.getRadius(),vt=_c.getAngle(r,this.coordinate),Vt=vt.startAngle,le=vt.endAngle,he=Vt;he<le;){var Ne=void 0,Er=(he-w)%(U+L);Er<U?Ne=he+(U-Er):(he+=U+L-Er,Ne=he+U);var Fr=_c.getSectorPath(Q.x,Q.y,pt,he,Math.min(Ne,le),pt*this.coordinate.innerRadius);G.addShape("path",{name:"meter-gauge",attrs:{path:Fr,fill:r.color,stroke:r.color,lineWidth:.5}}),he=Ne+L}return G}});var _I=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="gauge",t}return e.getDefaultOptions=function(){return pI},e.prototype.changeData=function(t){this.chart.emit(Mt.BEFORE_CHANGE_DATA,pe.fromData(this.chart,Mt.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t});var i=this.chart.views.find(function(c){return c.id===Sg});i&&i.data(qS(t));var u=this.chart.views.find(function(c){return c.id===$S});u&&u.data(KS(t,this.options.range)),QS({chart:this.chart,options:this.options},!0),this.chart.emit(Mt.AFTER_CHANGE_DATA,pe.fromData(this.chart,Mt.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return JS},e}(Ha);function tw(r,e,t){if(t===1)return[0,e];var i=Math.floor(r/e);return[e*i,e*(i+1)]}function xI(r){return Math.ceil(Math.log(r.length)/Math.LN2)+1}function Lx(r,e,t,i,u){var c=(0,b.d9)(r);(0,b.MR)(c,e);var p=(0,b.I)(c,e),g=(0,b.rx)(p),_=g.max-g.min,w=t;if(!t&&i&&(w=i>1?_/(i-1):g.max),!t&&!i){var k=xI(p);w=_/k}var L={},R=(0,b.vM)(c,u);(0,b.xb)(R)?(0,b.S6)(c,function(G){var Q=G[e],pt=tw(Q,w,i),vt=pt[0]+"-"+pt[1];(0,b.wH)(L,vt)||(L[vt]={range:pt,count:0}),L[vt].count+=1}):Object.keys(R).forEach(function(G){(0,b.S6)(R[G],function(Q){var pt=Q[e],vt=tw(pt,w,i),Vt=vt[0]+"-"+vt[1],le=Vt+"-"+G;(0,b.wH)(L,le)||(L[le]={range:vt,count:0},L[le][u]=G),L[le].count+=1})});var U=[];return(0,b.S6)(L,function(G){U.push(G)}),U}var Zy="range",fm="count",ew=hn({},Ha.getDefaultOptions(),{columnStyle:{stroke:"#FFFFFF"},tooltip:{shared:!0,showMarkers:!1},interactions:[{type:"active-region"}]});function bI(r){var e=r.chart,t=r.options,i=t.data,u=t.binField,c=t.binNumber,p=t.binWidth,g=t.color,_=t.stackField,w=t.legend,k=t.columnStyle,L=Lx(i,u,p,c,_);e.data(L);var R=hn({},r,{options:{xField:Zy,yField:fm,seriesField:_,isStack:!0,interval:{color:g,style:k}}});return ac(R),w&&_?e.legend(_,w):e.legend(!1),r}function Px(r){var e,t=r.options,i=t.xAxis,u=t.yAxis;return Ga(Zs((e={},e[Zy]=i,e[fm]=u,e)))(r)}function rw(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis;return i===!1?e.axis(Zy,!1):e.axis(Zy,i),u===!1?e.axis(fm,!1):e.axis(fm,u),r}function EI(r){var e=r.chart,t=r.options,i=t.label,u=Ec(e,"interval");if(!i)u.label(!1);else{var c=i.callback,p=(0,P._T)(i,["callback"]);u.label({fields:[fm],callback:c,cfg:Os(p)})}return r}function nw(r){return Ga(Bo,Nh("columnStyle"),bI,Px,rw,S0,EI,hl,Xs,ms)(r)}var SI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="histogram",t}return e.getDefaultOptions=function(){return ew},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options,u=i.binField,c=i.binNumber,p=i.binWidth,g=i.stackField;this.chart.changeData(Lx(t,u,p,c,g))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return nw},e}(Ha),wI=hn({},Ha.getDefaultOptions(),{tooltip:{shared:!0,showMarkers:!0,showCrosshairs:!0,crosshairs:{type:"x"}},legend:{position:"top-left",radio:{}},isStack:!1}),CI=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.active=function(){var t=this.getView(),i=this.context.event;if(i.data){var u=i.data.items,c=t.geometries.filter(function(p){return p.type==="point"});(0,b.S6)(c,function(p){(0,b.S6)(p.elements,function(g){var _=(0,b.cx)(u,function(w){return w.data===g.data})!==-1;g.setState("active",_)})})}},e.prototype.reset=function(){var t=this.getView(),i=t.geometries.filter(function(u){return u.type==="point"});(0,b.S6)(i,function(u){(0,b.S6)(u.elements,function(c){c.setState("active",!1)})})},e.prototype.getView=function(){return this.context.view},e}(oi);Yn("marker-active",CI),kn("marker-active",{start:[{trigger:"tooltip:show",action:"marker-active:active"}],end:[{trigger:"tooltip:hide",action:"marker-active:reset"}]});var AI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="line",t}return e.getDefaultOptions=function(){return wI},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,u=i.chart,c=i.options;Py({chart:u,options:c}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return E5},e}(Ha),iw=hn({},Ha.getDefaultOptions(),{legend:{position:"right",radio:{}},tooltip:{shared:!1,showTitle:!1,showMarkers:!1},label:{layout:{type:"limit-in-plot",cfg:{action:"ellipsis"}}},pieStyle:{stroke:"white",lineWidth:1},statistic:{title:{style:{fontWeight:300,color:"#4B535E",textAlign:"center",fontSize:"20px",lineHeight:1}},content:{style:{fontWeight:"bold",color:"rgba(44,53,66,0.85)",textAlign:"center",fontSize:"32px",lineHeight:1}}},theme:{components:{annotation:{text:{animate:!1}}}}}),TI=[1,0,0,0,1,0,0,0,1];function Ox(r,e){var t=e?(0,P.pr)(e):(0,P.pr)(TI);return _c.transform(t,r)}var aw=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getActiveElements=function(){var t=_c.getDelegationObject(this.context);if(t){var i=this.context.view,u=t.component,c=t.item,p=u.get("field");if(p){var g=i.geometries[0].elements;return g.filter(function(_){return _.getModel().data[p]===c.value})}}return[]},e.prototype.getActiveElementLabels=function(){var t=this.context.view,i=this.getActiveElements(),u=t.geometries[0].labelsContainer.getChildren();return u.filter(function(c){return i.find(function(p){return(0,b.Xy)(p.getData(),c.get("data"))})})},e.prototype.transfrom=function(t){t===void 0&&(t=7.5);var i=this.getActiveElements(),u=this.getActiveElementLabels();i.forEach(function(c,p){var g=u[p],_=c.geometry.coordinate;if(_.isPolar&&_.isTransposed){var w=_c.getAngle(c.getModel(),_),k=w.startAngle,L=w.endAngle,R=(k+L)/2,U=t,G=U*Math.cos(R),Q=U*Math.sin(R);c.shape.setMatrix(Ox([["t",G,Q]])),g.setMatrix(Ox([["t",G,Q]]))}})},e.prototype.active=function(){this.transfrom()},e.prototype.reset=function(){this.transfrom(0)},e}(oi);function MI(r){var e=r.event,t,i=e.target;return i&&(t=i.get("element")),t}var II=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getAnnotations=function(t){var i=t||this.context.view;return i.getController("annotation").option},e.prototype.getInitialAnnotation=function(){return this.initialAnnotation},e.prototype.init=function(){var t=this,i=this.context.view;i.removeInteraction("tooltip"),i.on("afterchangesize",function(){var u=t.getAnnotations(i);t.initialAnnotation=u})},e.prototype.change=function(t){var i=this.context,u=i.view,c=i.event;this.initialAnnotation||(this.initialAnnotation=this.getAnnotations());var p=(0,b.U2)(c,["data","data"]);if(c.type.match("legend-item")){var g=_c.getDelegationObject(this.context),_=u.getGroupedFields()[0];if(g&&_){var w=g.item;p=u.getData().find(function(U){return U[_]===w.value})}}if(p){var k=(0,b.U2)(t,"annotations",[]),L=(0,b.U2)(t,"statistic",{});u.getController("annotation").clear(!0),(0,b.S6)(k,function(U){typeof U=="object"&&u.annotation()[U.type](U)}),Iy(u,{statistic:L,plotType:"pie"},p),u.render(!0)}var R=MI(this.context);R&&R.shape.toFront()},e.prototype.reset=function(){var t=this.context.view,i=t.getController("annotation");i.clear(!0);var u=this.getInitialAnnotation();(0,b.S6)(u,function(c){t.annotation()[c.type](c)}),t.render(!0)},e}(oi),ow="pie-statistic";Yn(ow,II),kn("pie-statistic-active",{start:[{trigger:"element:mouseenter",action:"pie-statistic:change"}],end:[{trigger:"element:mouseleave",action:"pie-statistic:reset"}]}),Yn("pie-legend",aw),kn("pie-legend-active",{start:[{trigger:"legend-item:mouseenter",action:"pie-legend:active"}],end:[{trigger:"legend-item:mouseleave",action:"pie-legend:reset"}]});function kI(r,e){var t=null;return(0,b.S6)(r,function(i){typeof i[e]=="number"&&(t+=i[e])}),t}function sw(r,e){var t;switch(r){case"inner":return t="-30%",(0,b.HD)(e)&&e.endsWith("%")?parseFloat(e)*.01>0?t:e:e<0?e:t;case"outer":return t=12,(0,b.HD)(e)&&e.endsWith("%")?parseFloat(e)*.01<0?t:e:e>0?e:t;default:return e}}function hm(r,e){return(0,b.yW)(pg(r,e),function(t){return t[e]===0})}function LI(r){var e=r.chart,t=r.options,i=t.data,u=t.angleField,c=t.colorField,p=t.color,g=t.pieStyle,_=t.shape,w=pg(i,u);if(hm(w,u)){var k="$$percentage$$";w=w.map(function(R){var U;return(0,P.pi)((0,P.pi)({},R),(U={},U[k]=1/w.length,U))}),e.data(w);var L=hn({},r,{options:{xField:"1",yField:k,seriesField:c,isStack:!0,interval:{color:p,shape:_,style:g},args:{zIndexReversed:!0,sortZIndex:!0}}});ac(L)}else{e.data(w);var L=hn({},r,{options:{xField:"1",yField:u,seriesField:c,isStack:!0,interval:{color:p,shape:_,style:g},args:{zIndexReversed:!0,sortZIndex:!0}}});ac(L)}return r}function PI(r){var e,t=r.chart,i=r.options,u=i.meta,c=i.colorField,p=hn({},u);return t.scale(p,(e={},e[c]={type:"cat"},e)),r}function OI(r){var e=r.chart,t=r.options,i=t.radius,u=t.innerRadius,c=t.startAngle,p=t.endAngle;return e.coordinate({type:"theta",cfg:{radius:i,innerRadius:u,startAngle:c,endAngle:p}}),r}function FI(r){var e=r.chart,t=r.options,i=t.label,u=t.colorField,c=t.angleField,p=e.geometries[0];if(!i)p.label(!1);else{var g=i.callback,_=(0,P._T)(i,["callback"]),w=Os(_);if(w.content){var k=w.content;w.content=function(G,Q,pt){var vt=G[u],Vt=G[c],le=e.getScaleByField(c),he=le==null?void 0:le.scale(Vt);return(0,b.mf)(k)?k((0,P.pi)((0,P.pi)({},G),{percent:he}),Q,pt):(0,b.HD)(k)?wS(k,{value:Vt,name:vt,percentage:(0,b.hj)(he)&&!(0,b.UM)(Vt)?(he*100).toFixed(2)+"%":null}):k}}var L={inner:"",outer:"pie-outer",spider:"pie-spider"},R=w.type?L[w.type]:"pie-outer",U=w.layout?(0,b.kJ)(w.layout)?w.layout:[w.layout]:[];w.layout=(R?[{type:R}]:[]).concat(U),p.label({fields:u?[c,u]:[c],callback:g,cfg:(0,P.pi)((0,P.pi)({},w),{offset:sw(w.type,w.offset),type:"pie"})})}return r}function uw(r){var e=r.innerRadius,t=r.statistic,i=r.angleField,u=r.colorField,c=r.meta,p=r.locale,g=yx(p);if(e&&t){var _=hn({},iw.statistic,t),w=_.title,k=_.content;return w!==!1&&(w=hn({},{formatter:function(L){var R=L?L[u]:(0,b.UM)(w.content)?g.get(["statistic","total"]):w.content,U=(0,b.U2)(c,[u,"formatter"])||function(G){return G};return U(R)}},w)),k!==!1&&(k=hn({},{formatter:function(L,R){var U=L?L[i]:kI(R,i),G=(0,b.U2)(c,[i,"formatter"])||function(Q){return Q};return L||(0,b.UM)(k.content)?G(U):k.content}},k)),hn({},{statistic:{title:w,content:k}},r)}return r}function lw(r){var e=r.chart,t=r.options,i=uw(t),u=i.innerRadius,c=i.statistic;return e.getController("annotation").clear(!0),Ga(Ys())(r),u&&c&&Iy(e,{statistic:c,plotType:"pie"}),r}function RI(r){var e=r.chart,t=r.options,i=t.tooltip,u=t.colorField,c=t.angleField,p=t.data;if(i===!1)e.tooltip(i);else if(e.tooltip(hn({},i,{shared:!1})),hm(p,c)){var g=(0,b.U2)(i,"fields"),_=(0,b.U2)(i,"formatter");(0,b.xb)((0,b.U2)(i,"fields"))&&(g=[u,c],_=_||function(w){return{name:w[u],value:(0,b.BB)(w[c])}}),e.geometries[0].tooltip(g.join("*"),Uh(g,_))}return r}function DI(r){var e=r.chart,t=r.options,i=uw(t),u=i.interactions,c=i.statistic,p=i.annotations;return(0,b.S6)(u,function(g){var _,w;if(g.enable===!1)e.removeInteraction(g.type);else if(g.type==="pie-statistic-active"){var k=[];!((_=g.cfg)===null||_===void 0)&&_.start||(k=[{trigger:"element:mouseenter",action:ow+":change",arg:{statistic:c,annotations:p}}]),(0,b.S6)((w=g.cfg)===null||w===void 0?void 0:w.start,function(L){k.push((0,P.pi)((0,P.pi)({},L),{arg:{statistic:c,annotations:p}}))}),e.interaction(g.type,hn({},g.cfg,{start:k}))}else e.interaction(g.type,g.cfg||{})}),r}function cw(r){return Ga(Nh("pieStyle"),LI,PI,Bo,OI,vg,RI,FI,S0,lw,DI,ms)(r)}var Fx=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="pie",t}return e.getDefaultOptions=function(){return iw},e.prototype.changeData=function(t){this.chart.emit(Mt.BEFORE_CHANGE_DATA,pe.fromData(this.chart,Mt.BEFORE_CHANGE_DATA,null));var i=this.options,u=this.options.angleField,c=pg(i.data,u),p=pg(t,u);hm(c,u)||hm(p,u)?this.update({data:t}):(this.updateOption({data:t}),this.chart.data(p),lw({chart:this.chart,options:this.options}),this.chart.render(!0)),this.chart.emit(Mt.AFTER_CHANGE_DATA,pe.fromData(this.chart,Mt.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return cw},e}(Ha),fw=["#FAAD14","#E8EDF3"],BI={percent:.2,color:fw,animation:{}};function Rx(r){var e=(0,b.uZ)(b0(r)?r:0,0,1);return[{current:""+e,type:"current",percent:e},{current:""+e,type:"target",percent:1}]}function Dx(r){var e=r.chart,t=r.options,i=t.percent,u=t.progressStyle,c=t.color,p=t.barWidthRatio;e.data(Rx(i));var g=hn({},r,{options:{xField:"current",yField:"percent",seriesField:"type",widthRatio:p,interval:{style:u,color:(0,b.HD)(c)?[c,fw[1]]:c},args:{zIndexReversed:!0,sortZIndex:!0}}});return ac(g),e.tooltip(!1),e.axis(!1),e.legend(!1),r}function NI(r){var e=r.chart;return e.coordinate("rect").transpose(),r}function hw(r){return Ga(Dx,Zs({}),NI,ms,Bo,Ys())(r)}var pw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="process",t}return e.getDefaultOptions=function(){return BI},e.prototype.changeData=function(t){this.updateOption({percent:t}),this.chart.changeData(Rx(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return hw},e}(Ha);function dw(r){var e=r.chart,t=r.options,i=t.innerRadius,u=t.radius;return e.coordinate("theta",{innerRadius:i,radius:u}),r}function vw(r,e){var t=r.chart,i=r.options,u=i.innerRadius,c=i.statistic,p=i.percent,g=i.meta;if(t.getController("annotation").clear(!0),u&&c){var _=(0,b.U2)(g,["percent","formatter"])||function(k){return(k*100).toFixed(2)+"%"},w=c.content;w&&(w=hn({},w,{content:(0,b.UM)(w.content)?_(p):w.content})),Iy(t,{statistic:(0,P.pi)((0,P.pi)({},c),{content:w}),plotType:"ring-progress"},{percent:p})}return e&&t.render(!0),r}function Bx(r){return Ga(Dx,Zs({}),dw,vw,ms,Bo,Ys())(r)}var gw={percent:.2,innerRadius:.8,radius:.98,color:["#FAAD14","#E8EDF3"],statistic:{title:!1,content:{style:{fontSize:"14px",fontWeight:300,fill:"#4D4D4D",textAlign:"center",textBaseline:"middle"}}},animation:{}},mw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="ring-process",t}return e.getDefaultOptions=function(){return gw},e.prototype.changeData=function(t){this.chart.emit(Mt.BEFORE_CHANGE_DATA,pe.fromData(this.chart,Mt.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t}),this.chart.data(Rx(t)),vw({chart:this.chart,options:this.options},!0),this.chart.emit(Mt.AFTER_CHANGE_DATA,pe.fromData(this.chart,Mt.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Bx},e}(Ha),Xv=ot(56645),zI={exp:Xv.regressionExp,linear:Xv.regressionLinear,loess:Xv.regressionLoess,log:Xv.regressionLog,poly:Xv.regressionPoly,pow:Xv.regressionPow,quad:Xv.regressionQuad};function UI(r,e){var t=10,i={regionStyle:[{position:{start:[r,"max"],end:["max",e]},style:{fill:"#d8d0c0",opacity:.4}},{position:{start:["min","max"],end:[r,e]},style:{fill:"#a3dda1",opacity:.4}},{position:{start:["min",e],end:[r,"min"]},style:{fill:"#d8d0c0",opacity:.4}},{position:{start:[r,e],end:["max","min"]},style:{fill:"#a3dda1",opacity:.4}}],lineStyle:{stroke:"#9ba29a",lineWidth:1},labelStyle:[{position:["max",e],offsetX:-t,offsetY:-t,style:{textAlign:"right",textBaseline:"bottom",fontSize:14,fill:"#ccc"}},{position:["min",e],offsetX:t,offsetY:-t,style:{textAlign:"left",textBaseline:"bottom",fontSize:14,fill:"#ccc"}},{position:["min",e],offsetX:t,offsetY:t,style:{textAlign:"left",textBaseline:"top",fontSize:14,fill:"#ccc"}},{position:["max",e],offsetX:-t,offsetY:t,style:{textAlign:"right",textBaseline:"top",fontSize:14,fill:"#ccc"}}]};return i}var yw=function(r,e){var t=e.view,i=e.options,u=i.xField,c=i.yField,p=t.getScaleByField(u),g=t.getScaleByField(c),_=r.map(function(w){return t.getCoordinate().convert({x:p.scale(w[0]),y:g.scale(w[1])})});return v5(_,!1)},_w=function(r){var e=r.options,t=e.xField,i=e.yField,u=e.data,c=e.regressionLine,p=c.type,g=p===void 0?"linear":p,_=c.algorithm,w;if(_)w=(0,b.kJ)(_)?_:_(u);else{var k=zI[g]().x(function(L){return L[t]}).y(function(L){return L[i]});w=k(u)}return yw(w,r)},ZI=function(r){var e,t=r.meta,i=t===void 0?{}:t,u=r.xField,c=r.yField,p=r.data,g=p[0][u],_=p[0][c],w=g>0,k=_>0;function L(R,U){var G=(0,b.U2)(i,[R]);function Q(vt){return(0,b.U2)(G,vt)}var pt={};return U==="x"?((0,b.hj)(g)&&((0,b.hj)(Q("min"))||(pt.min=w?0:g*2),(0,b.hj)(Q("max"))||(pt.max=w?g*2:0)),pt):((0,b.hj)(_)&&((0,b.hj)(Q("min"))||(pt.min=k?0:_*2),(0,b.hj)(Q("max"))||(pt.max=k?_*2:0)),pt)}return(0,P.pi)((0,P.pi)({},i),(e={},e[u]=(0,P.pi)((0,P.pi)({},i[u]),L(u,"x")),e[c]=(0,P.pi)((0,P.pi)({},i[c]),L(c,"y")),e))};function xw(r){var e=r.data,t=e===void 0?[]:e,i=r.xField,u=r.yField;if(t.length){for(var c=!0,p=!0,g=t[0],_=void 0,w=1;w<t.length&&(_=t[w],g[i]!==_[i]&&(c=!1),g[u]!==_[u]&&(p=!1),!(!c&&!p));w++)g=_;var k=[];c&&k.push(i),p&&k.push(u);var L=fs(ZI(r),k);return hn({},r,{meta:L})}return r}function bw(r){var e=r.chart,t=r.options,i=t.data,u=t.type,c=t.color,p=t.shape,g=t.pointStyle,_=t.shapeField,w=t.colorField,k=t.xField,L=t.yField,R=t.sizeField,U=t.size,G=t.tooltip;R&&(U||(U=[2,8]),(0,b.hj)(U)&&(U=[U,U])),G&&!G.fields&&(G=(0,P.pi)((0,P.pi)({},G),{fields:[k,L,w,R,_]})),e.data(i),Bf(hn({},r,{options:{seriesField:w,point:{color:c,shape:p,size:U,style:g},tooltip:G}}));var Q=Ec(e,"point");return u&&Q.adjust(u),r}function Vy(r){var e,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField,g=xw(t);return Ga(Zs((e={},e[c]=i,e[p]=u,e)))(hn({},r,{options:g}))}function VI(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return e.axis(c,i),e.axis(p,u),r}function Ew(r){var e=r.chart,t=r.options,i=t.legend,u=t.colorField,c=t.shapeField,p=t.sizeField,g=t.shapeLegend,_=t.sizeLegend,w=i!==!1;return u&&e.legend(u,w?i:!1),c&&(g?e.legend(c,g):e.legend(c,g===!1?!1:i)),p&&e.legend(p,_||!1),!w&&!g&&!_&&e.legend(!1),r}function Sw(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=Ec(e,"point");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[u],callback:p,cfg:Os(g)})}return r}function ww(r){var e=r.options,t=e.quadrant,i=[];if(t){var u=t.xBaseline,c=u===void 0?0:u,p=t.yBaseline,g=p===void 0?0:p,_=t.labels,w=t.regionStyle,k=t.lineStyle,L=UI(c,g),R=new Array(4).join(",").split(",");R.forEach(function(U,G){i.push((0,P.pi)((0,P.pi)({type:"region",top:!1},L.regionStyle[G].position),{style:hn({},L.regionStyle[G].style,w==null?void 0:w[G])}),(0,P.pi)({type:"text",top:!0},hn({},L.labelStyle[G],_==null?void 0:_[G])))}),i.push({type:"line",top:!1,start:["min",g],end:["max",g],style:hn({},L.lineStyle,k)},{type:"line",top:!1,start:[c,"min"],end:[c,"max"],style:hn({},L.lineStyle,k)})}return Ga(Ys(i))(r)}function Cw(r){var e=r.options,t=r.chart,i=e.regressionLine;if(i){var u=i.style,c=i.top,p=c===void 0?!1:c,g={stroke:"#9ba29a",lineWidth:2,opacity:.5};t.annotation().shape({top:p,render:function(_,w){var k=_.addGroup({id:t.id+"-regression-line",name:"regression-line-group"}),L=_w({view:w,options:e});k.addShape("path",{name:"regression-line",attrs:(0,P.pi)((0,P.pi)({path:L},g),u)})}})}return r}function GI(r){var e=r.chart,t=r.options,i=t.tooltip;return i?e.tooltip(i):i===!1&&e.tooltip(!1),r}function Aw(r){return Ga(bw,Vy,VI,Ew,GI,Sw,NS,Vu,ad,Xs,ww,ms,Bo,Cw)(r)}var Tw=hn({},Ha.getDefaultOptions(),{size:4,tooltip:{showTitle:!1,showMarkers:!1,showCrosshairs:!0,crosshairs:{type:"xy"}}});kn("drag-move",{start:[{trigger:"plot:mousedown",action:"scale-translate:start"}],processing:[{trigger:"plot:mousemove",action:"scale-translate:translate",throttle:{wait:100,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseup",action:"scale-translate:end"}]});var HI=function(r){(0,P.ZT)(e,r);function e(t,i){var u=r.call(this,t,i)||this;return u.type="scatter",u.on(Mt.BEFORE_RENDER,function(c){var p,g,_=u,w=_.options,k=_.chart;if(((p=c.data)===null||p===void 0?void 0:p.source)===Bc.FILTER){var L=u.chart.filterData(u.chart.getData());Vy({chart:k,options:(0,P.pi)((0,P.pi)({},w),{data:L})})}((g=c.data)===null||g===void 0?void 0:g.source)===Bc.RESET&&Vy({chart:k,options:w})}),u}return e.getDefaultOptions=function(){return Tw},e.prototype.changeData=function(t){this.updateOption(xw(hn({},this.options,{data:t})));var i=this,u=i.options,c=i.chart;Vy({chart:c,options:u}),this.chart.changeData(t)},e.prototype.getSchemaAdaptor=function(){return Aw},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ha),pm="$$stock-range$$",dm="trend",Nx="up",zx="down",Mw={showMarkers:!1,showCrosshairs:!0,shared:!0,crosshairs:{type:"xy",follow:!0,text:function(r,e,t){var i;if(r==="x"){var u=t[0];i=u?u.title:e}else i=e;return{position:r==="y"?"start":"end",content:i,style:{fill:"#dfdfdf"}}},textBackground:{padding:[2,4],style:{fill:"#666"}}}},Iw=hn({},Ha.getDefaultOptions(),{tooltip:Mw,interactions:[{type:"tooltip"}],legend:{position:"top-left"},risingFill:"#ef5350",fallingFill:"#26a69a"});function kw(r,e){return(0,b.UI)(r,function(t){var i=t&&(0,P.pi)({},t);if((0,b.kJ)(e)&&i){var u=e[0],c=e[1],p=e[2],g=e[3];i[dm]=i[u]<=i[c]?Nx:zx,i[pm]=[i[u],i[c],i[p],i[g]]}return i})}function jI(r){var e=r.chart,t=r.options,i=t.yField,u=t.data,c=t.risingFill,p=t.fallingFill,g=t.tooltip,_=t.stockStyle;e.data(kw(u,i));var w=g;return w!==!1&&(w=hn({},{fields:i},w)),mg(hn({},r,{options:{schema:{shape:"candle",color:[c,p],style:_},yField:pm,seriesField:dm,rawFields:i,tooltip:w}})),r}function WI(r){var e,t,i=r.chart,u=r.options,c=u.meta,p=u.xAxis,g=u.yAxis,_=u.xField,w=(e={},e[_]={type:"timeCat",tickCount:6},e[dm]={values:[Nx,zx]},e),k=hn(w,c,(t={},t[_]=fs(p,Rf),t[pm]=fs(g,Rf),t));return i.scale(k),r}function XI(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?e.axis(pm,!1):e.axis(pm,u),r}function YI(r){var e=r.chart,t=r.options,i=t.tooltip;return i!==!1?e.tooltip(i):e.tooltip(!1),r}function $I(r){var e=r.chart,t=r.options,i=t.legend;return i?e.legend(dm,i):i===!1&&e.legend(!1),r}function Lw(r){Ga(Bo,jI,WI,XI,YI,$I,Xs,ms,Ys(),Vu)(r)}var qI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="stock",t}return e.getDefaultOptions=function(){return Iw},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Lw},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options.yField;this.chart.changeData(kw(t,i))},e}(Ha);function I0(r){return(0,b.UI)(r||[],function(e,t){return{x:""+t,y:e}})}var vm="x",k0="y",Pw={showTitle:!1,shared:!0,showMarkers:!1,customContent:function(r,e){return""+(0,b.U2)(e,[0,"data","y"],0)},containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',itemTpl:"<span>{value}</span>",domStyles:{"g2-tooltip":{padding:"2px 4px",fontSize:"10px"}},showCrosshairs:!0,crosshairs:{type:"x"}},KI={appendPadding:2,tooltip:(0,P.pi)({},Pw),animation:{}};function Gy(r){var e=r.chart,t=r.options,i=t.data,u=t.color,c=t.areaStyle,p=t.point,g=t.line,_=p==null?void 0:p.state,w=I0(i);e.data(w);var k=hn({},r,{options:{xField:vm,yField:k0,area:{color:u,style:c},line:g,point:p}}),L=hn({},k,{options:{tooltip:!1}}),R=hn({},k,{options:{tooltip:!1,state:_}});return Gv(k),C0(L),Bf(R),e.axis(!1),e.legend(!1),r}function wg(r){var e,t,i=r.options,u=i.xAxis,c=i.yAxis,p=i.data,g=I0(p);return Ga(Zs((e={},e[vm]=u,e[k0]=c,e),(t={},t[vm]={type:"cat"},t[k0]=ix(g,k0),t)))(r)}function Ow(r){return Ga(Nh("areaStyle"),Gy,wg,hl,Bo,ms,Ys())(r)}var QI={appendPadding:2,tooltip:(0,P.pi)({},Pw),color:"l(90) 0:#E5EDFE 1:#ffffff",areaStyle:{fillOpacity:.6},line:{size:1,color:"#5B8FF9"},animation:{}},JI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="tiny-area",t}return e.getDefaultOptions=function(){return QI},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,u=i.chart,c=i.options;wg({chart:u,options:c}),u.changeData(I0(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Ow},e}(Ha);function tk(r){var e=r.chart,t=r.options,i=t.data,u=t.color,c=t.columnStyle,p=t.columnWidthRatio,g=I0(i);e.data(g);var _=hn({},r,{options:{xField:vm,yField:k0,widthRatio:p,interval:{style:c,color:u}}});return ac(_),e.axis(!1),e.legend(!1),e.interaction("element-active"),r}function Fw(r){return Ga(Bo,Nh("columnStyle"),tk,wg,hl,ms,Ys())(r)}var ek={showTitle:!1,shared:!0,showMarkers:!1,customContent:function(r,e){return""+(0,b.U2)(e,[0,"data","y"],0)},containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',itemTpl:"<span>{value}</span>",domStyles:{"g2-tooltip":{padding:"2px 4px",fontSize:"10px"}}},rk={appendPadding:2,tooltip:(0,P.pi)({},ek),animation:{}},nk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="tiny-column",t}return e.getDefaultOptions=function(){return rk},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,u=i.chart,c=i.options;wg({chart:u,options:c}),u.changeData(I0(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Fw},e}(Ha);function ik(r){var e=r.chart,t=r.options,i=t.data,u=t.color,c=t.lineStyle,p=t.point,g=p==null?void 0:p.state,_=I0(i);e.data(_);var w=hn({},r,{options:{xField:vm,yField:k0,line:{color:u,style:c},point:p}}),k=hn({},w,{options:{tooltip:!1,state:g}});return C0(w),Bf(k),e.axis(!1),e.legend(!1),r}function Rw(r){return Ga(ik,wg,Bo,hl,ms,Ys())(r)}var ak=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="tiny-line",t}return e.getDefaultOptions=function(){return KI},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,u=i.chart,c=i.options;wg({chart:u,options:c}),u.changeData(I0(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Rw},e}(Ha),ok={line:E5,pie:cw,column:By,bar:US,area:DS,gauge:JS,"tiny-line":Rw,"tiny-column":Fw,"tiny-area":Ow,"ring-progress":Bx,progress:hw,scatter:Aw,histogram:nw,funnel:XS,stock:Lw},sk={line:AI,pie:Fx,column:VS,bar:ZS,area:S5,gauge:_I,"tiny-line":ak,"tiny-column":nk,"tiny-area":JI,"ring-progress":mw,progress:pw,scatter:HI,histogram:SI,funnel:fI,stock:qI},uk={pie:{label:!1},column:{tooltip:{showMarkers:!1}},bar:{tooltip:{showMarkers:!1}}};function Ux(r,e,t){var i=sk[r];if(!i){console.error("could not find "+r+" plot");return}var u=ok[r];u({chart:e,options:hn({},i.getDefaultOptions(),(0,b.U2)(uk,r,{}),t)})}function lk(r){var e=r.chart,t=r.options,i=t.views,u=t.legend;return(0,b.S6)(i,function(c){var p=c.region,g=c.data,_=c.meta,w=c.axes,k=c.coordinate,L=c.interactions,R=c.annotations,U=c.tooltip,G=c.geometries,Q=e.createView({region:p});Q.data(g);var pt={};w&&(0,b.S6)(w,function(vt,Vt){pt[Vt]=fs(vt,Rf)}),pt=hn({},_,pt),Q.scale(pt),w?(0,b.S6)(w,function(vt,Vt){Q.axis(Vt,vt)}):Q.axis(!1),Q.coordinate(k),(0,b.S6)(G,function(vt){var Vt=Fl({chart:Q,options:vt}).ext,le=vt.adjust;le&&Vt.geometry.adjust(le)}),(0,b.S6)(L,function(vt){vt.enable===!1?Q.removeInteraction(vt.type):Q.interaction(vt.type,vt.cfg)}),(0,b.S6)(R,function(vt){Q.annotation()[vt.type]((0,P.pi)({},vt))}),typeof c.animation=="boolean"?Q.animate(!1):(Q.animate(!0),(0,b.S6)(Q.geometries,function(vt){vt.animate(c.animation)})),U&&(Q.interaction("tooltip"),Q.tooltip(U))}),u?(0,b.S6)(u,function(c,p){e.legend(p,c)}):e.legend(!1),e.tooltip(t.tooltip),r}function ck(r){var e=r.chart,t=r.options,i=t.plots,u=t.data,c=u===void 0?[]:u;return(0,b.S6)(i,function(p){var g=p.type,_=p.region,w=p.options,k=w===void 0?{}:w,L=p.top,R=k.tooltip;if(L){Ux(g,e,(0,P.pi)((0,P.pi)({},k),{data:c}));return}var U=e.createView((0,P.pi)({region:_},fs(k,OS)));R&&U.interaction("tooltip"),Ux(g,U,(0,P.pi)({data:c},k))}),r}function fk(r){var e=r.chart,t=r.options;return e.option("slider",t.slider),r}function hk(r){return Ga(ms,lk,ck,Xs,ms,Bo,hl,fk,Ys())(r)}function pk(r,e){var t=r.getModel(),i=t.data,u;return(0,b.kJ)(i)?u=i[0][e]:u=i[e],u}function dk(r){var e=Zv(r);(0,b.S6)(e,function(t){t.hasState("active")&&t.setState("active",!1),t.hasState("selected")&&t.setState("selected",!1),t.hasState("inactive")&&t.setState("inactive",!1)})}var vk=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getAssociationItems=function(t,i){var u,c=this.context.event,p=i||{},g=p.linkField,_=p.dim,w=[];if(!((u=c.data)===null||u===void 0)&&u.data){var k=c.data.data;(0,b.S6)(t,function(L){var R,U,G=g;if(_==="x"?G=L.getXScale().field:_==="y"?G=(R=L.getYScales().find(function(pt){return pt.field===G}))===null||R===void 0?void 0:R.field:G||(G=(U=L.getGroupScales()[0])===null||U===void 0?void 0:U.field),!!G){var Q=(0,b.UI)(Zv(L),function(pt){var vt=!1,Vt=!1,le=(0,b.kJ)(k)?(0,b.U2)(k[0],G):(0,b.U2)(k,G);return pk(pt,G)===le?vt=!0:Vt=!0,{element:pt,view:L,active:vt,inactive:Vt}});w.push.apply(w,Q)}})}return w},e.prototype.showTooltip=function(t){var i=fx(this.context.view),u=this.getAssociationItems(i,t);(0,b.S6)(u,function(c){if(c.active){var p=c.element.shape.getCanvasBBox();c.view.showTooltip({x:p.minX+p.width/2,y:p.minY+p.height/2})}})},e.prototype.hideTooltip=function(){var t=fx(this.context.view);(0,b.S6)(t,function(i){i.hideTooltip()})},e.prototype.active=function(t){var i=um(this.context.view),u=this.getAssociationItems(i,t);(0,b.S6)(u,function(c){var p=c.active,g=c.element;p&&g.setState("active",!0)})},e.prototype.selected=function(t){var i=um(this.context.view),u=this.getAssociationItems(i,t);(0,b.S6)(u,function(c){var p=c.active,g=c.element;p&&g.setState("selected",!0)})},e.prototype.highlight=function(t){var i=um(this.context.view),u=this.getAssociationItems(i,t);(0,b.S6)(u,function(c){var p=c.inactive,g=c.element;p&&g.setState("inactive",!0)})},e.prototype.reset=function(){var t=um(this.context.view);(0,b.S6)(t,function(i){dk(i)})},e}(oi);Yn("association",vk),kn("association-active",{start:[{trigger:"element:mouseenter",action:"association:active"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]}),kn("association-selected",{start:[{trigger:"element:mouseenter",action:"association:selected"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]}),kn("association-highlight",{start:[{trigger:"element:mouseenter",action:"association:highlight"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]}),kn("association-tooltip",{start:[{trigger:"element:mousemove",action:"association:showTooltip"}],end:[{trigger:"element:mouseleave",action:"association:hideTooltip"}]});var gk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="mix",t}return e.prototype.getSchemaAdaptor=function(){return hk},e}(Ha),Cg;(function(r){r.DEV="DEV",r.BETA="BETA",r.STABLE="STABLE"})(Cg||(Cg={}));function mk(r,e){console.warn(r===Cg.DEV?"Plot '"+e+"' is in DEV stage, just give us issues.":r===Cg.BETA?"Plot '"+e+"' is in BETA stage, DO NOT use it in production env.":r===Cg.STABLE?"Plot '"+e+`' is in STABLE stage, import it by "import { `+e+` } from '@antv/g2plot'".`:"invalid Stage type.")}var $O=function(){function r(){}return Object.defineProperty(r,"MultiView",{get:function(){return mk(Cg.STABLE,"MultiView"),gk},enumerable:!1,configurable:!0}),r}(),od="first-axes-view",sd="second-axes-view",L0="series-field-key";function Dw(r,e,t,i,u){var c=[];e.forEach(function(L){i.forEach(function(R){var U,G=(U={},U[r]=R[r],U[t]=L,U[L]=R[L],U);c.push(G)})});var p=Object.values((0,b.vM)(c,t)),g=p[0],_=g===void 0?[]:g,w=p[1],k=w===void 0?[]:w;return u?[_.reverse(),k.reverse()]:[_,k]}function Jd(r){return r!=="vertical"}function yk(r,e,t){var i=e[0],u=e[1],c=i.autoPadding,p=u.autoPadding,g=r.__axisPosition,_=g.layout,w=g.position;if(Jd(_)&&w==="top"&&(i.autoPadding=t.instance(c.top,0,c.bottom,c.left),u.autoPadding=t.instance(p.top,c.left,p.bottom,0)),Jd(_)&&w==="bottom"&&(i.autoPadding=t.instance(c.top,c.right/2+5,c.bottom,c.left),u.autoPadding=t.instance(p.top,p.right,p.bottom,c.right/2+5)),!Jd(_)&&w==="bottom"){var k=c.left>=p.left?c.left:p.left;i.autoPadding=t.instance(c.top,c.right,c.bottom/2+5,k),u.autoPadding=t.instance(c.bottom/2+5,p.right,p.bottom,k)}if(!Jd(_)&&w==="top"){var k=c.left>=p.left?c.left:p.left;i.autoPadding=t.instance(c.top,c.right,0,k),u.autoPadding=t.instance(0,p.right,c.top,k)}}function _k(r){var e=r.chart,t=r.options,i=t.data,u=t.xField,c=t.yField,p=t.color,g=t.barStyle,_=t.widthRatio,w=t.legend,k=t.layout,L=Dw(u,c,L0,i,Jd(k));w?e.legend(L0,w):w===!1&&e.legend(!1);var R,U,G=L[0],Q=L[1];Jd(k)?(R=e.createView({region:{start:{x:0,y:0},end:{x:.5,y:1}},id:od}),R.coordinate().transpose().reflect("x"),U=e.createView({region:{start:{x:.5,y:0},end:{x:1,y:1}},id:sd}),U.coordinate().transpose(),R.data(G),U.data(Q)):(R=e.createView({region:{start:{x:0,y:0},end:{x:1,y:.5}},id:od}),U=e.createView({region:{start:{x:0,y:.5},end:{x:1,y:1}},id:sd}),U.coordinate().reflect("y"),R.data(G),U.data(Q));var pt=hn({},r,{chart:R,options:{widthRatio:_,xField:u,yField:c[0],seriesField:L0,interval:{color:p,style:g}}});ac(pt);var vt=hn({},r,{chart:U,options:{xField:u,yField:c[1],seriesField:L0,widthRatio:_,interval:{color:p,style:g}}});return ac(vt),r}function xk(r){var e,t,i,u=r.options,c=r.chart,p=u.xAxis,g=u.yAxis,_=u.xField,w=u.yField,k=yo(c,od),L=yo(c,sd),R={};return(0,b.XP)((u==null?void 0:u.meta)||{}).map(function(U){(0,b.U2)(u==null?void 0:u.meta,[U,"alias"])&&(R[U]=u.meta[U].alias)}),c.scale((e={},e[L0]={sync:!0,formatter:function(U){return(0,b.U2)(R,U,U)}},e)),Zs((t={},t[_]=p,t[w[0]]=g[w[0]],t))(hn({},r,{chart:k})),Zs((i={},i[_]=p,i[w[1]]=g[w[1]],i))(hn({},r,{chart:L})),r}function bk(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField,g=t.layout,_=yo(e,od),w=yo(e,sd);return(i==null?void 0:i.position)==="bottom"?w.axis(c,(0,P.pi)((0,P.pi)({},i),{label:{formatter:function(){return""}}})):w.axis(c,!1),i===!1?_.axis(c,!1):_.axis(c,(0,P.pi)({position:Jd(g)?"top":"bottom"},i)),u===!1?(_.axis(p[0],!1),w.axis(p[1],!1)):(_.axis(p[0],u[p[0]]),w.axis(p[1],u[p[1]])),e.__axisPosition={position:_.getOptions().axes[c].position,layout:g},r}function Ek(r){var e=r.chart;return Xs(hn({},r,{chart:yo(e,od)})),Xs(hn({},r,{chart:yo(e,sd)})),r}function Zx(r){var e=r.chart,t=r.options,i=t.yField,u=t.yAxis;return Df(hn({},r,{chart:yo(e,od),options:{yAxis:u[i[0]]}})),Df(hn({},r,{chart:yo(e,sd),options:{yAxis:u[i[1]]}})),r}function Sk(r){var e=r.chart;return Bo(hn({},r,{chart:yo(e,od)})),Bo(hn({},r,{chart:yo(e,sd)})),Bo(r),r}function wk(r){var e=r.chart;return ms(hn({},r,{chart:yo(e,od)})),ms(hn({},r,{chart:yo(e,sd)})),r}function Ck(r){var e=this,t,i,u=r.chart,c=r.options,p=c.label,g=c.yField,_=c.layout,w=yo(u,od),k=yo(u,sd),L=Ec(w,"interval"),R=Ec(k,"interval");if(!p)L.label(!1),R.label(!1);else{var U=p.callback,G=(0,P._T)(p,["callback"]);G.position||(G.position="middle"),G.offset===void 0&&(G.offset=2);var Q=(0,P.pi)({},G);if(Jd(_)){var pt=((t=Q.style)===null||t===void 0?void 0:t.textAlign)||(G.position==="middle"?"center":"left");G.style=hn({},G.style,{textAlign:pt});var vt={left:"right",right:"left",center:"center"};Q.style=hn({},Q.style,{textAlign:vt[pt]})}else{var Vt={top:"bottom",bottom:"top",middle:"middle"};typeof G.position=="string"?G.position=Vt[G.position]:typeof G.position=="function"&&(G.position=function(){for(var Ne=[],Er=0;Er<arguments.length;Er++)Ne[Er]=arguments[Er];return Vt[G.position.apply(e,Ne)]});var le=((i=Q.style)===null||i===void 0?void 0:i.textBaseline)||"bottom";Q.style=hn({},Q.style,{textBaseline:le});var he={top:"bottom",bottom:"top",middle:"middle"};G.style=hn({},G.style,{textBaseline:he[le]})}L.label({fields:[g[0]],callback:U,cfg:Os(Q)}),R.label({fields:[g[1]],callback:U,cfg:Os(G)})}return r}function Ak(r){return Ga(_k,xk,bk,Zx,Sk,Ck,hl,Ek,wk)(r)}var qO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="bidirectional-bar",t}return e.getDefaultOptions=function(){return hn({},r.getDefaultOptions.call(this),{syncViewPadding:yk})},e.prototype.changeData=function(t){t===void 0&&(t=[]),this.chart.emit(Mt.BEFORE_CHANGE_DATA,pe.fromData(this.chart,Mt.BEFORE_CHANGE_DATA,null)),this.updateOption({data:t});var i=this.options,u=i.xField,c=i.yField,p=i.layout,g=Dw(u,c,L0,t,Jd(p)),_=g[0],w=g[1],k=yo(this.chart,od),L=yo(this.chart,sd);k.data(_),L.data(w),this.chart.render(!0),this.chart.emit(Mt.AFTER_CHANGE_DATA,pe.fromData(this.chart,Mt.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Ak},e.SERIES_FIELD_KEY=L0,e}(Ha),Vx,Ag="$$range$$",Tk="low-q1-median-q3-high",Mk="$$y_outliers$$",Hy="outliers_view",Bw=hn({},Ha.getDefaultOptions(),{meta:(Vx={},Vx[Ag]={min:0,alias:Tk},Vx),interactions:[{type:"active-region"}],tooltip:{showMarkers:!1,shared:!0},boxStyle:{lineWidth:1}}),Gx=function(r,e){var t=r;if(Array.isArray(e)){var i=e[0],u=e[1],c=e[2],p=e[3],g=e[4];t=(0,b.UI)(r,function(_){return _[Ag]=[_[i],_[u],_[c],_[p],_[g]],_})}return t};function Nw(r){var e=r.chart,t=r.options,i=t.xField,u=t.yField,c=t.groupField,p=t.color,g=t.tooltip,_=t.boxStyle;e.data(Gx(t.data,u));var w=(0,b.kJ)(u)?Ag:u,k=u?(0,b.kJ)(u)?u:[u]:[],L=g;L!==!1&&(L=hn({},{fields:(0,b.kJ)(u)?u:[]},L));var R=mg(hn({},r,{options:{xField:i,yField:w,seriesField:c,tooltip:L,rawFields:k,label:!1,schema:{shape:"box",color:p,style:_}}})).ext;return c&&R.geometry.adjust("dodge"),r}function zw(r){var e=r.chart,t=r.options,i=t.xField,u=t.data,c=t.outliersField,p=t.outliersStyle,g=t.padding,_=t.label;if(!c)return r;var w=e.createView({padding:g,id:Hy}),k=u.reduce(function(L,R){var U=R[c];return U.forEach(function(G){var Q;return L.push((0,P.pi)((0,P.pi)({},R),(Q={},Q[c]=G,Q)))}),L},[]);return w.data(k),Bf({chart:w,options:{xField:i,yField:c,point:{shape:"circle",style:p},label:_}}),w.axis(!1),r}function jy(r){var e,t,i=r.chart,u=r.options,c=u.meta,p=u.xAxis,g=u.yAxis,_=u.xField,w=u.yField,k=u.outliersField,L=Array.isArray(w)?Ag:w,R={};if(k){var U=Mk;R=(e={},e[k]={sync:U,nice:!0},e[L]={sync:U,nice:!0},e)}var G=hn(R,c,(t={},t[_]=fs(p,Rf),t[L]=fs(g,Rf),t));return i.scale(G),r}function Uw(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField,g=Array.isArray(p)?Ag:p;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?e.axis(Ag,!1):e.axis(g,u),r}function Zw(r){var e=r.chart,t=r.options,i=t.legend,u=t.groupField;return u?i?e.legend(u,i):e.legend(u,{position:"bottom"}):e.legend(!1),r}function Ik(r){return Ga(Nw,zw,jy,Uw,Zw,hl,Ys(),Xs,ms,Bo)(r)}var kk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="box",t}return e.getDefaultOptions=function(){return Bw},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options.yField,u=this.chart.views.find(function(c){return c.id===Hy});u&&u.data(t),this.chart.changeData(Gx(t,i))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Ik},e}(Ha);function Hx(r,e,t){return r.length>1?e+"_"+t:""+e}function Vw(r){var e=r.data,t=r.xField,i=r.measureField,u=r.rangeField,c=r.targetField,p=r.layout,g=[],_=[];e.forEach(function(L,R){var U=[L[u]].flat();U.sort(function(pt,vt){return pt-vt}),U.forEach(function(pt,vt){var Vt,le=vt===0?pt:U[vt]-U[vt-1];g.push((Vt={rKey:u+"_"+vt},Vt[t]=t?L[t]:String(R),Vt[u]=le,Vt))});var G=[L[i]].flat();G.forEach(function(pt,vt){var Vt;g.push((Vt={mKey:Hx(G,i,vt)},Vt[t]=t?L[t]:String(R),Vt[i]=pt,Vt))});var Q=[L[c]].flat();Q.forEach(function(pt,vt){var Vt;g.push((Vt={tKey:Hx(Q,c,vt)},Vt[t]=t?L[t]:String(R),Vt[c]=pt,Vt))}),_.push(L[u],L[i],L[c])});var w=Math.min.apply(Math,_.flat(1/0)),k=Math.max.apply(Math,_.flat(1/0));return w=w>0?0:w,p==="vertical"&&g.reverse(),{min:w,max:k,ds:g}}function jx(r){var e=r.chart,t=r.options,i=t.bulletStyle,u=t.targetField,c=t.rangeField,p=t.measureField,g=t.xField,_=t.color,w=t.layout,k=t.size,L=t.label,R=Vw(t),U=R.min,G=R.max,Q=R.ds;e.data(Q);var pt=hn({},r,{options:{xField:g,yField:c,seriesField:"rKey",isStack:!0,label:(0,b.U2)(L,"range"),interval:{color:(0,b.U2)(_,"range"),style:(0,b.U2)(i,"range"),size:(0,b.U2)(k,"range")}}});ac(pt),e.geometries[0].tooltip(!1);var vt=hn({},r,{options:{xField:g,yField:p,seriesField:"mKey",isStack:!0,label:(0,b.U2)(L,"measure"),interval:{color:(0,b.U2)(_,"measure"),style:(0,b.U2)(i,"measure"),size:(0,b.U2)(k,"measure")}}});ac(vt);var Vt=hn({},r,{options:{xField:g,yField:u,seriesField:"tKey",label:(0,b.U2)(L,"target"),point:{color:(0,b.U2)(_,"target"),style:(0,b.U2)(i,"target"),size:(0,b.mf)((0,b.U2)(k,"target"))?function(le){return(0,b.U2)(k,"target")(le)/2}:(0,b.U2)(k,"target")/2,shape:w==="horizontal"?"line":"hyphen"}}});return Bf(Vt),w==="horizontal"&&e.coordinate().transpose(),(0,P.pi)((0,P.pi)({},r),{ext:{data:{min:U,max:G}}})}function Wx(r){var e,t,i=r.options,u=r.ext,c=i.xAxis,p=i.yAxis,g=i.targetField,_=i.rangeField,w=i.measureField,k=i.xField,L=u.data;return Ga(Zs((e={},e[k]=c,e[w]=p,e),(t={},t[w]={min:L==null?void 0:L.min,max:L==null?void 0:L.max,sync:!0},t[g]={sync:""+w},t[_]={sync:""+w},t)))(r)}function Lk(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.measureField,g=t.rangeField,_=t.targetField;return e.axis(""+g,!1),e.axis(""+_,!1),i===!1?e.axis(""+c,!1):e.axis(""+c,i),u===!1?e.axis(""+p,!1):e.axis(""+p,u),r}function Gw(r){var e=r.chart,t=r.options,i=t.legend;return e.removeInteraction("legend-filter"),e.legend(i),e.legend("rKey",!1),e.legend("mKey",!1),e.legend("tKey",!1),r}function Pk(r){var e=r.chart,t=r.options,i=t.label,u=t.measureField,c=t.targetField,p=t.rangeField,g=e.geometries,_=g[0],w=g[1],k=g[2];return(0,b.U2)(i,"range")?_.label(""+p,(0,P.pi)({layout:[{type:"limit-in-plot"}]},Os(i.range))):_.label(!1),(0,b.U2)(i,"measure")?w.label(""+u,(0,P.pi)({layout:[{type:"limit-in-plot"}]},Os(i.measure))):w.label(!1),(0,b.U2)(i,"target")?k.label(""+c,(0,P.pi)({layout:[{type:"limit-in-plot"}]},Os(i.target))):k.label(!1),r}function KO(r){Ga(jx,Wx,Lk,Gw,Bo,Pk,hl,Xs,ms)(r)}var Wy=hn({},Ha.getDefaultOptions(),{layout:"horizontal",size:{range:30,measure:20,target:20},xAxis:{tickLine:!1,line:null},bulletStyle:{range:{fillOpacity:.5}},label:{measure:{position:"right"}},tooltip:{showMarkers:!1}}),Ok=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="bullet",t}return e.getDefaultOptions=function(){return Wy},e.prototype.changeData=function(t){this.updateOption({data:t});var i=Vw(this.options),u=i.min,c=i.max,p=i.ds;Wx({options:this.options,ext:{data:{min:u,max:c}},chart:this.chart}),this.chart.changeData(p)},e.prototype.getSchemaAdaptor=function(){return KO},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ha),Hw={y:0,nodeWidthRatio:.05,weight:!1,nodePaddingRatio:.1,id:function(r){return r.id},source:function(r){return r.source},target:function(r){return r.target},sourceWeight:function(r){return r.value||1},targetWeight:function(r){return r.value||1},sortBy:null};function QO(r,e,t){(0,b.U5)(r,function(i,u){i.inEdges=e.filter(function(c){return""+t.target(c)==""+u}),i.outEdges=e.filter(function(c){return""+t.source(c)==""+u}),i.edges=i.outEdges.concat(i.inEdges),i.frequency=i.edges.length,i.value=0,i.inEdges.forEach(function(c){i.value+=t.targetWeight(c)}),i.outEdges.forEach(function(c){i.value+=t.sourceWeight(c)})})}function JO(r,e){var t={weight:function(u,c){return c.value-u.value},frequency:function(u,c){return c.frequency-u.frequency},id:function(u,c){return(""+e.id(u)).localeCompare(""+e.id(c))}},i=t[e.sortBy];!i&&(0,b.mf)(e.sortBy)&&(i=e.sortBy),i&&r.sort(i)}function Xx(r,e){var t=r.length;if(!t)throw new TypeError("Invalid nodes: it's empty!");if(e.weight){var i=e.nodePaddingRatio;if(i<0||i>=1)throw new TypeError("Invalid nodePaddingRatio: it must be in range [0, 1)!");var u=i/(2*t),c=e.nodeWidthRatio;if(c<=0||c>=1)throw new TypeError("Invalid nodeWidthRatio: it must be in range (0, 1)!");var p=0;r.forEach(function(_){p+=_.value}),r.forEach(function(_){_.weight=_.value/p,_.width=_.weight*(1-i),_.height=c}),r.forEach(function(_,w){for(var k=0,L=w-1;L>=0;L--)k+=r[L].width+2*u;var R=_.minX=u+k,U=_.maxX=_.minX+_.width,G=_.minY=e.y-c/2,Q=_.maxY=G+c;_.x=[R,U,U,R],_.y=[G,G,Q,Q]})}else{var g=1/t;r.forEach(function(_,w){_.x=(w+.5)*g,_.y=e.y})}return r}function Yx(r,e,t){if(t.weight){var i={};(0,b.U5)(r,function(u,c){i[c]=u.value}),e.forEach(function(u){var c=t.source(u),p=t.target(u),g=r[c],_=r[p];if(g&&_){var w=i[c],k=t.sourceWeight(u),L=g.minX+(g.value-w)/g.value*g.width,R=L+k/g.value*g.width;i[c]-=k;var U=i[p],G=t.targetWeight(u),Q=_.minX+(_.value-U)/_.value*_.width,pt=Q+G/_.value*_.width;i[p]-=G;var vt=t.y;u.x=[L,R,Q,pt],u.y=[vt,vt,vt,vt],u.source=g,u.target=_}})}else e.forEach(function(u){var c=r[t.source(u)],p=r[t.target(u)];c&&p&&(u.x=[c.x,p.x],u.y=[c.y,p.y],u.source=c,u.target=p)});return e}function $x(r){return(0,b.f0)({},Hw,r)}function jw(r,e){var t=$x(r),i={},u=e.nodes,c=e.links;u.forEach(function(_){var w=t.id(_);i[w]=_}),QO(i,c,t),JO(u,t);var p=Xx(u,t),g=Yx(i,c,t);return{nodes:p,links:g}}var gm="x",Xy="y",Fk="name",Rk="source",Dk={nodeStyle:{opacity:1,fillOpacity:1,lineWidth:1},edgeStyle:{opacity:.5,lineWidth:2},label:{fields:["x","name"],callback:function(r,e){var t=(r[0]+r[1])/2,i=t>.5?-4:4;return{offsetX:i,content:e}},labelEmit:!0,style:{fill:"#8c8c8c"}},tooltip:{showTitle:!1,showMarkers:!1,fields:["source","target","value","isNode"],showContent:function(r){return!(0,b.U2)(r,[0,"data","isNode"])},formatter:function(r){var e=r.source,t=r.target,i=r.value;return{name:e+" -> "+t,value:i}}},interactions:[{type:"element-active"}],weight:!0,nodePaddingRatio:.1,nodeWidthRatio:.05};function Bk(r){var e=r.options,t=e.data,i=e.sourceField,u=e.targetField,c=e.weightField,p=e.nodePaddingRatio,g=e.nodeWidthRatio,_=e.rawFields,w=_===void 0?[]:_,k=xS(t,i,u,c),L=jw({weight:!0,nodePaddingRatio:p,nodeWidthRatio:g},k),R=L.nodes,U=L.links,G=R.map(function(pt){return(0,P.pi)((0,P.pi)({},fs(pt,(0,P.pr)(["id","x","y","name"],w))),{isNode:!0})}),Q=U.map(function(pt){return(0,P.pi)((0,P.pi)({source:pt.source.name,target:pt.target.name,name:pt.source.name||pt.target.name},fs(pt,(0,P.pr)(["x","y","value"],w))),{isNode:!1})});return(0,P.pi)((0,P.pi)({},r),{ext:(0,P.pi)((0,P.pi)({},r.ext),{chordData:{nodesData:G,edgesData:Q}})})}function Ww(r){var e,t=r.chart;return t.scale((e={x:{sync:!0,nice:!0},y:{sync:!0,nice:!0,max:1}},e[Fk]={sync:"color"},e[Rk]={sync:"color"},e)),r}function Nk(r){var e=r.chart;return e.axis(!1),r}function zk(r){var e=r.chart;return e.legend(!1),r}function qx(r){var e=r.chart,t=r.options,i=t.tooltip;return e.tooltip(i),r}function Xw(r){var e=r.chart;return e.coordinate("polar").reflect("y"),r}function Uk(r){var e=r.chart,t=r.options,i=r.ext.chordData.nodesData,u=t.nodeStyle,c=t.label,p=t.tooltip,g=e.createView();return g.data(i),gg({chart:g,options:{xField:gm,yField:Xy,seriesField:Fk,polygon:{style:u},label:c,tooltip:p}}),r}function tF(r){var e=r.chart,t=r.options,i=r.ext.chordData.edgesData,u=t.edgeStyle,c=t.tooltip,p=e.createView();p.data(i);var g={xField:gm,yField:Xy,seriesField:Rk,edge:{style:u,shape:"arc"},tooltip:c};return _x({chart:p,options:g}),r}function Zk(r){var e=r.chart,t=r.options,i=t.animation;return E0(e,i,ox(e)),r}function Yw(r){return Ga(Bo,Bk,Xw,Ww,Nk,zk,qx,tF,Uk,Xs,S0,Zk)(r)}var Vk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="chord",t}return e.getDefaultOptions=function(){return Dk},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Yw},e}(Ha),$w=["x","y","r","name","value","path","depth"],Gk={colorField:"name",autoFit:!0,pointStyle:{lineWidth:0,stroke:"#fff"},legend:!1,hierarchyConfig:{size:[1,1],padding:0},label:{fields:["name"],layout:{type:"limit-in-shape"}},tooltip:{showMarkers:!1,showTitle:!1},drilldown:{enabled:!1}},Hk=4,Zh=0,mm=5,Kx="drilldown-bread-crumb",Qx={position:"top-left",dividerText:"/",textStyle:{fontSize:12,fill:"rgba(0, 0, 0, 0.65)",cursor:"pointer"},activeTextStyle:{fill:"#87B5FF"}},Yy="hierarchy-data-transform-params",jk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.name="drill-down",t.historyCache=[],t.breadCrumbGroup=null,t.breadCrumbCfg=Qx,t}return e.prototype.click=function(){var t=(0,b.U2)(this.context,["event","data","data"]);if(!t)return!1;this.drill(t),this.drawBreadCrumb()},e.prototype.resetPosition=function(){if(!!this.breadCrumbGroup){var t=this.context.view.getCoordinate(),i=this.breadCrumbGroup,u=i.getBBox(),c=this.getButtonCfg().position,p={x:t.start.x,y:t.end.y-(u.height+mm*2)};t.isPolar&&(p={x:0,y:0}),c==="bottom-left"&&(p={x:t.start.x,y:t.start.y});var g=_c.transform(null,[["t",p.x+Zh,p.y+u.height+mm]]);i.setMatrix(g)}},e.prototype.back=function(){(0,b.dp)(this.historyCache)&&this.backTo(this.historyCache.slice(0,-1))},e.prototype.reset=function(){this.historyCache[0]&&this.backTo(this.historyCache.slice(0,1)),this.historyCache=[],this.hideCrumbGroup()},e.prototype.drill=function(t){var i=this.context.view,u=(0,b.U2)(i,["interactions","drill-down","cfg","transformData"],function(w){return w}),c=u((0,P.pi)({data:t.data},t[Yy]));i.changeData(c);for(var p=[],g=t;g;){var _=g.data;p.unshift({id:_.name+"_"+g.height+"_"+g.depth,name:_.name,children:u((0,P.pi)({data:_},t[Yy]))}),g=g.parent}this.historyCache=(this.historyCache||[]).slice(0,-1).concat(p)},e.prototype.backTo=function(t){if(!(!t||t.length<=0)){var i=this.context.view,u=(0,b.Z$)(t).children;i.changeData(u),t.length>1?(this.historyCache=t,this.drawBreadCrumb()):(this.historyCache=[],this.hideCrumbGroup())}},e.prototype.getButtonCfg=function(){var t=this.context.view,i=(0,b.U2)(t,["interactions","drill-down","cfg","drillDownConfig"]);return hn(this.breadCrumbCfg,i==null?void 0:i.breadCrumb,this.cfg)},e.prototype.drawBreadCrumb=function(){this.drawBreadCrumbGroup(),this.resetPosition(),this.breadCrumbGroup.show()},e.prototype.drawBreadCrumbGroup=function(){var t=this,i=this.getButtonCfg(),u=this.historyCache;this.breadCrumbGroup?this.breadCrumbGroup.clear():this.breadCrumbGroup=this.context.view.foregroundGroup.addGroup({name:Kx});var c=0;u.forEach(function(p,g){var _=t.breadCrumbGroup.addShape({type:"text",id:p.id,name:Kx+"_"+p.name+"_text",attrs:(0,P.pi)((0,P.pi)({text:g===0&&!(0,b.UM)(i.rootText)?i.rootText:p.name},i.textStyle),{x:c,y:0})}),w=_.getBBox();if(c+=w.width+Hk,_.on("click",function(R){var U,G=R.target.get("id");if(G!==((U=(0,b.Z$)(u))===null||U===void 0?void 0:U.id)){var Q=u.slice(0,u.findIndex(function(pt){return pt.id===G})+1);t.backTo(Q)}}),_.on("mouseenter",function(R){var U,G=R.target.get("id");G!==((U=(0,b.Z$)(u))===null||U===void 0?void 0:U.id)?_.attr(i.activeTextStyle):_.attr({cursor:"default"})}),_.on("mouseleave",function(){_.attr(i.textStyle)}),g<u.length-1){var k=t.breadCrumbGroup.addShape({type:"text",name:i.name+"_"+p.name+"_divider",attrs:(0,P.pi)((0,P.pi)({text:i.dividerText},i.textStyle),{x:c,y:0})}),L=k.getBBox();c+=L.width+Hk}})},e.prototype.hideCrumbGroup=function(){this.breadCrumbGroup&&this.breadCrumbGroup.hide()},e.prototype.destroy=function(){this.breadCrumbGroup&&this.breadCrumbGroup.remove(),r.prototype.destroy.call(this)},e}(oi);function Wk(r){return ue()(r)==="object"&&"length"in r?r:Array.from(r)}function qw(r){for(var e=r.length,t,i;e;)i=Math.random()*e--|0,t=r[e],r[e]=r[i],r[i]=t;return r}function Jx(r){for(var e=0,t=(r=qw(Array.from(r))).length,i=[],u,c;e<t;)u=r[e],c&&Kw(c,u)?++e:(c=Jw(i=$y(i,u)),e=0);return c}function $y(r,e){var t,i;if(Qw(e,r))return[e];for(t=0;t<r.length;++t)if(ud(e,r[t])&&Qw(Tp(r[t],e),r))return[r[t],e];for(t=0;t<r.length-1;++t)for(i=t+1;i<r.length;++i)if(ud(Tp(r[t],r[i]),e)&&ud(Tp(r[t],e),r[i])&&ud(Tp(r[i],e),r[t])&&Qw(tv(r[t],r[i],e),r))return[r[t],r[i],e];throw new Error}function ud(r,e){var t=r.r-e.r,i=e.x-r.x,u=e.y-r.y;return t<0||t*t<i*i+u*u}function Kw(r,e){var t=r.r-e.r+Math.max(r.r,e.r,1)*1e-9,i=e.x-r.x,u=e.y-r.y;return t>0&&t*t>i*i+u*u}function Qw(r,e){for(var t=0;t<e.length;++t)if(!Kw(r,e[t]))return!1;return!0}function Jw(r){switch(r.length){case 1:return tC(r[0]);case 2:return Tp(r[0],r[1]);case 3:return tv(r[0],r[1],r[2])}}function tC(r){return{x:r.x,y:r.y,r:r.r}}function Tp(r,e){var t=r.x,i=r.y,u=r.r,c=e.x,p=e.y,g=e.r,_=c-t,w=p-i,k=g-u,L=Math.sqrt(_*_+w*w);return{x:(t+c+_/L*k)/2,y:(i+p+w/L*k)/2,r:(L+u+g)/2}}function tv(r,e,t){var i=r.x,u=r.y,c=r.r,p=e.x,g=e.y,_=e.r,w=t.x,k=t.y,L=t.r,R=i-p,U=i-w,G=u-g,Q=u-k,pt=_-c,vt=L-c,Vt=i*i+u*u-c*c,le=Vt-p*p-g*g+_*_,he=Vt-w*w-k*k+L*L,Ne=U*G-R*Q,Er=(G*he-Q*le)/(Ne*2)-i,Fr=(Q*pt-G*vt)/Ne,zr=(U*le-R*he)/(Ne*2)-u,pn=(R*vt-U*pt)/Ne,nn=Fr*Fr+pn*pn-1,Pn=2*(c+Er*Fr+zr*pn),Si=Er*Er+zr*zr-c*c,ha=-(nn?(Pn+Math.sqrt(Pn*Pn-4*nn*Si))/(2*nn):Si/Pn);return{x:i+Er+Fr*ha,y:u+zr+pn*ha,r:ha}}function tb(r,e,t){var i=r.x-e.x,u,c,p=r.y-e.y,g,_,w=i*i+p*p;w?(c=e.r+t.r,c*=c,_=r.r+t.r,_*=_,c>_?(u=(w+_-c)/(2*w),g=Math.sqrt(Math.max(0,_/w-u*u)),t.x=r.x-u*i-g*p,t.y=r.y-u*p+g*i):(u=(w+c-_)/(2*w),g=Math.sqrt(Math.max(0,c/w-u*u)),t.x=e.x+u*i-g*p,t.y=e.y+u*p+g*i)):(t.x=e.x+t.r,t.y=e.y)}function eb(r,e){var t=r.r+e.r-1e-6,i=e.x-r.x,u=e.y-r.y;return t>0&&t*t>i*i+u*u}function ym(r){var e=r._,t=r.next._,i=e.r+t.r,u=(e.x*t.r+t.x*e.r)/i,c=(e.y*t.r+t.y*e.r)/i;return u*u+c*c}function _m(r){this._=r,this.next=null,this.previous=null}function rb(r){if(!(u=(r=Wk(r)).length))return 0;var e,t,i,u,c,p,g,_,w,k,L;if(e=r[0],e.x=0,e.y=0,!(u>1))return e.r;if(t=r[1],e.x=-t.r,t.x=e.r,t.y=0,!(u>2))return e.r+t.r;tb(t,e,i=r[2]),e=new _m(e),t=new _m(t),i=new _m(i),e.next=i.previous=t,t.next=e.previous=i,i.next=t.previous=e;t:for(g=3;g<u;++g){tb(e._,t._,i=r[g]),i=new _m(i),_=t.next,w=e.previous,k=t._.r,L=e._.r;do if(k<=L){if(eb(_._,i._)){t=_,e.next=t,t.previous=e,--g;continue t}k+=_._.r,_=_.next}else{if(eb(w._,i._)){e=w,e.next=t,t.previous=e,--g;continue t}L+=w._.r,w=w.previous}while(_!==w.next);for(i.previous=e,i.next=t,e.next=t.previous=t=i,c=ym(e);(i=i.next)!==t;)(p=ym(i))<c&&(e=i,c=p);t=e.next}for(e=[t._],i=t;(i=i.next)!==t;)e.push(i._);for(i=Jx(e),g=0;g<u;++g)e=r[g],e.x-=i.x,e.y-=i.y;return i.r}function eF(r){return rb(r),r}function rF(r){return r==null?null:xm(r)}function xm(r){if(typeof r!="function")throw new Error;return r}function P0(){return 0}function ev(r){return function(){return r}}function Xk(r){return Math.sqrt(r.value)}function qy(){var r=null,e=1,t=1,i=P0;function u(c){return c.x=e/2,c.y=t/2,r?c.eachBefore(Ky(r)).eachAfter(nb(i,.5)).eachBefore(eC(1)):c.eachBefore(Ky(Xk)).eachAfter(nb(P0,1)).eachAfter(nb(i,c.r/Math.min(e,t))).eachBefore(eC(Math.min(e,t)/(2*c.r))),c}return u.radius=function(c){return arguments.length?(r=rF(c),u):r},u.size=function(c){return arguments.length?(e=+c[0],t=+c[1],u):[e,t]},u.padding=function(c){return arguments.length?(i=typeof c=="function"?c:ev(+c),u):i},u}function Ky(r){return function(e){e.children||(e.r=Math.max(0,+r(e)||0))}}function nb(r,e){return function(t){if(i=t.children){var i,u,c=i.length,p=r(t)*e||0,g;if(p)for(u=0;u<c;++u)i[u].r+=p;if(g=rb(i),p)for(u=0;u<c;++u)i[u].r-=p;t.r=g+p}}}function eC(r){return function(e){var t=e.parent;e.r*=r,t&&(e.x=t.x+r*e.x,e.y=t.y+r*e.y)}}var Yk=ot(12812),$k=ot.n(Yk);function qk(r){var e=0,t=r.children,i=t&&t.length;if(!i)e=1;else for(;--i>=0;)e+=t[i].value;r.value=e}function ib(){return this.eachAfter(qk)}var Kk=ot(99399),rC=ot.n(Kk);function Qk(r,e){var t=-1,i=rC()(this),u;try{for(i.s();!(u=i.n()).done;){var c=u.value;r.call(e,c,++t,this)}}catch(p){i.e(p)}finally{i.f()}return this}function nC(r,e){for(var t=this,i=[t],u,c,p=-1;t=i.pop();)if(r.call(e,t,++p,this),u=t.children)for(c=u.length-1;c>=0;--c)i.push(u[c]);return this}function Nc(r,e){for(var t=this,i=[t],u=[],c,p,g,_=-1;t=i.pop();)if(u.push(t),c=t.children)for(p=0,g=c.length;p<g;++p)i.push(c[p]);for(;t=u.pop();)r.call(e,t,++_,this);return this}function ab(r,e){var t=-1,i=rC()(this),u;try{for(i.s();!(u=i.n()).done;){var c=u.value;if(r.call(e,c,++t,this))return c}}catch(p){i.e(p)}finally{i.f()}}function iC(r){return this.eachAfter(function(e){for(var t=+r(e.data)||0,i=e.children,u=i&&i.length;--u>=0;)t+=i[u].value;e.value=t})}function Jk(r){return this.eachBefore(function(e){e.children&&e.children.sort(r)})}function t4(r){for(var e=this,t=Qy(e,r),i=[e];e!==t;)e=e.parent,i.push(e);for(var u=i.length;r!==t;)i.splice(u,0,r),r=r.parent;return i}function Qy(r,e){if(r===e)return r;var t=r.ancestors(),i=e.ancestors(),u=null;for(r=t.pop(),e=i.pop();r===e;)u=r,r=t.pop(),e=i.pop();return u}function ob(){for(var r=this,e=[r];r=r.parent;)e.push(r);return e}function aC(){return Array.from(this)}function e4(){var r=[];return this.eachBefore(function(e){e.children||r.push(e)}),r}function Jy(){var r=this,e=[];return r.each(function(t){t!==r&&e.push({source:t.parent,target:t})}),e}var sb=ot(97983),oC=ot.n(sb),t_=oC()().mark(O0);function O0(){var r,e,t,i,u,c;return oC()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:r=this,t=[r];case 1:e=t.reverse(),t=[];case 2:if(!(r=e.pop())){g.next=8;break}return g.next=5,r;case 5:if(i=r.children)for(u=0,c=i.length;u<c;++u)t.push(i[u]);g.next=2;break;case 8:if(t.length){g.next=1;break}case 9:case"end":return g.stop()}},t_,this)}function Tg(r,e){r instanceof Map?(r=[void 0,r],e===void 0&&(e=i4)):e===void 0&&(e=n4);for(var t=new F0(r),i,u=[t],c,p,g,_;i=u.pop();)if((p=e(i.data))&&(_=(p=Array.from(p)).length))for(i.children=p,g=_-1;g>=0;--g)u.push(c=p[g]=new F0(p[g])),c.parent=i,c.depth=i.depth+1;return t.eachBefore(uC)}function r4(){return Tg(this).eachBefore(sC)}function n4(r){return r.children}function i4(r){return Array.isArray(r)?r[1]:null}function sC(r){r.data.value!==void 0&&(r.value=r.data.value),r.data=r.data.data}function uC(r){var e=0;do r.height=e;while((r=r.parent)&&r.height<++e)}function F0(r){this.data=r,this.depth=this.height=0,this.parent=null}F0.prototype=Tg.prototype=$k()({constructor:F0,count:ib,each:Qk,eachAfter:Nc,eachBefore:nC,find:ab,sum:iC,sort:Jk,path:t4,ancestors:ob,descendants:aC,leaves:e4,links:Jy,copy:r4},Symbol.iterator,O0);var ub="nodeIndex",lb="childNodeCount",e_="nodeAncestor",r_="Invalid field: it must be a string!";function cb(r,e){var t=r.field,i=r.fields;if((0,b.HD)(t))return t;if((0,b.kJ)(t))return console.warn(r_),t[0];if(console.warn(r_+" will try to get fields instead."),(0,b.HD)(i))return i;if((0,b.kJ)(i)&&i.length)return i[0];if(e)return e;throw new TypeError(r_)}function Mg(r){var e=[];if(r&&r.each){var t,i;r.each(function(u){var c,p;u.parent!==t?(t=u.parent,i=0):i+=1;var g=(0,b.hX)((((c=u.ancestors)===null||c===void 0?void 0:c.call(u))||[]).map(function(_){return e.find(function(w){return w.name===_.name})||_}),function(_){var w=_.depth;return w>0&&w<u.depth});u[e_]=g,u[lb]=((p=u.children)===null||p===void 0?void 0:p.length)||0,u[ub]=i,e.push(u)})}else r&&r.eachNode&&r.eachNode(function(u){e.push(u)});return e}var fb={field:"value",as:["x","y","r"],sort:function(r,e){return e.value-r.value}};function lC(r,e){e=(0,b.f0)({},fb,e);var t=e.as;if(!(0,b.kJ)(t)||t.length!==3)throw new TypeError('Invalid as: it must be an array with 3 strings (e.g. [ "x", "y", "r" ])!');var i;try{i=cb(e)}catch(w){console.warn(w)}var u=function(w){return qy().size(e.size).padding(e.padding)(Tg(w).sum(function(k){return k[i]}).sort(e.sort))},c=u(r),p=t[0],g=t[1],_=t[2];return c.each(function(w){w[p]=w.x,w[g]=w.y,w[_]=w.r}),Mg(c)}function cC(r){var e=r.data,t=r.hierarchyConfig,i=r.rawFields,u=i===void 0?[]:i,c=r.enableDrillDown,p=lC(e,(0,P.pi)((0,P.pi)({},t),{field:"value",as:["x","y","r"]})),g=[];return p.forEach(function(_){for(var w,k=_.data.name,L=(0,P.pi)({},_);L.depth>1;)k=((w=L.parent.data)===null||w===void 0?void 0:w.name)+" / "+k,L=L.parent;if(c&&_.depth>2)return null;var R=hn({},_.data,(0,P.pi)((0,P.pi)((0,P.pi)({},fs(_.data,u)),{path:k}),_));R.ext=t,R[Yy]={hierarchyConfig:t,rawFields:u,enableDrillDown:c},g.push(R)}),g}function fC(r,e,t){var i=ux([r,e]),u=i[0],c=i[1],p=i[2],g=i[3],_=t.width,w=t.height,k=_-(g+c),L=w-(u+p),R=Math.min(k,L),U=(k-R)/2,G=(L-R)/2,Q=u+G,pt=c+U,vt=p+G,Vt=g+U,le=[Q,pt,vt,Vt],he=R<0?0:R;return{finalPadding:le,finalSize:he}}function a4(r){var e=r.chart,t=Math.min(e.viewBBox.width,e.viewBBox.height);return hn({options:{size:function(i){var u=i.r;return u*t}}},r)}function o4(r){var e=r.options,t=r.chart,i=t.viewBBox,u=e.padding,c=e.appendPadding,p=e.drilldown,g=c;if(p!=null&&p.enabled){var _=My(t.appendPadding,(0,b.U2)(p,["breadCrumb","position"]));g=ux([_,c])}var w=fC(u,g,i).finalPadding;return t.padding=w,t.appendPadding=0,r}function bm(r){var e=r.chart,t=r.options,i=e.padding,u=e.appendPadding,c=t.color,p=t.colorField,g=t.pointStyle,_=t.hierarchyConfig,w=t.sizeField,k=t.rawFields,L=k===void 0?[]:k,R=t.drilldown,U=cC({data:t.data,hierarchyConfig:_,enableDrillDown:R==null?void 0:R.enabled,rawFields:L});e.data(U);var G=e.viewBBox,Q=fC(i,u,G).finalSize,pt=function(vt){var Vt=vt.r;return Vt*Q};return w&&(pt=function(vt){return vt[w]*Q}),Bf(hn({},r,{options:{xField:"x",yField:"y",seriesField:p,sizeField:w,rawFields:(0,P.pr)($w,L),point:{color:c,style:g,shape:"circle",size:pt}}})),r}function hC(r){return Ga(Zs({},{x:{min:0,max:1,minLimit:0,maxLimit:1,nice:!0},y:{min:0,max:1,minLimit:0,maxLimit:1,nice:!0}}))(r)}function s4(r){var e=r.chart,t=r.options,i=t.tooltip;if(i===!1)e.tooltip(!1);else{var u=i;(0,b.U2)(i,"fields")||(u=hn({},{customItems:function(c){return c.map(function(p){var g=(0,b.U2)(e.getOptions(),"scales"),_=(0,b.U2)(g,["name","formatter"],function(k){return k}),w=(0,b.U2)(g,["value","formatter"],function(k){return k});return(0,P.pi)((0,P.pi)({},p),{name:_(p.data.name),value:w(p.data.value)})})}},u)),e.tooltip(u)}return r}function pC(r){var e=r.chart;return e.axis(!1),r}function dC(r){var e=r.drilldown,t=r.interactions,i=t===void 0?[]:t;return e!=null&&e.enabled?hn({},r,{interactions:(0,P.pr)(i,[{type:"drill-down",cfg:{drillDownConfig:e,transformData:cC,enableDrillDown:!0}}])}):r}function vC(r){var e=r.chart,t=r.options;return Xs({chart:e,options:dC(t)}),r}function u4(r){return Ga(Nh("pointStyle"),a4,o4,Bo,hC,bm,pC,vg,s4,vC,ms,Ys())(r)}function gC(r){var e=(0,b.U2)(r,["event","data","data"],{});return(0,b.kJ)(e.children)&&e.children.length>0}function mC(r){var e=r.view.getCoordinate(),t=e.innerRadius;if(t){var i=r.event,u=i.x,c=i.y,p=e.center,g=p.x,_=p.y,w=e.getRadius()*t,k=Math.sqrt(Math.pow(g-u,2)+Math.pow(_-c,2));return k<w}return!1}Yn("drill-down-action",jk),kn("drill-down",{showEnable:[{trigger:"element:mouseenter",action:"cursor:pointer",isEnable:gC},{trigger:"element:mouseleave",action:"cursor:default"},{trigger:"element:mouseleave",action:"cursor:pointer",isEnable:mC}],start:[{trigger:"element:click",isEnable:gC,action:["drill-down-action:click"]},{trigger:"afterchangesize",action:["drill-down-action:resetPosition"]},{trigger:"click",isEnable:mC,action:["drill-down-action:back"]}]});var nF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="circle-packing",t}return e.getDefaultOptions=function(){return Gk},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return u4},e.prototype.triggerResize=function(){this.chart.destroyed||(this.chart.forceFit(),this.chart.clear(),this.execAdaptor(),this.chart.render(!0))},e}(Ha),lh="left-axes-view",Nf="right-axes-view",yC={nice:!0,label:{autoHide:!0,autoRotate:!1}},_C=(0,P.pi)((0,P.pi)({},yC),{position:"left"}),xC=(0,P.pi)((0,P.pi)({},yC),{position:"right",grid:null}),R0;(function(r){r.Left="Left",r.Right="Right"})(R0||(R0={}));var D0;(function(r){r.Line="line",r.Column="column"})(D0||(D0={}));function hb(r){return(0,b.U2)(r,"geometry")===D0.Line}function n_(r){return(0,b.U2)(r,"geometry")===D0.Column}function bC(r,e,t){return n_(t)?hn({},{geometry:D0.Column,label:t.label&&t.isRange?{content:function(i){var u;return(u=i[e])===null||u===void 0?void 0:u.join("-")}}:void 0},t):(0,P.pi)({geometry:D0.Line},t)}function EC(r,e){var t=r[0],i=r[1];if((0,b.kJ)(e)){var u=e[0],c=e[1];return[u,c]}var p=(0,b.U2)(e,t),g=(0,b.U2)(e,i);return[p,g]}function SC(r,e){return e===R0.Left?r===!1?!1:hn({},_C,r):e===R0.Right?r===!1?!1:hn({},xC,r):r}function pb(r){var e=r.options,t=r.chart,i=e.geometryOption,u=i.isStack,c=i.color,p=i.seriesField,g=i.groupField,_=i.isGroup,w=["xField","yField"];if(hb(i)){C0(hn({},r,{options:(0,P.pi)((0,P.pi)((0,P.pi)({},fs(e,w)),i),{line:{color:i.color,style:i.lineStyle}})})),Bf(hn({},r,{options:(0,P.pi)((0,P.pi)((0,P.pi)({},fs(e,w)),i),{point:i.point&&(0,P.pi)({color:c,shape:"circle"},i.point)})}));var k=[];_&&k.push({type:"dodge",dodgeBy:g||p,customOffset:0}),u&&k.push({type:"stack"}),k.length&&(0,b.S6)(t.geometries,function(L){L.adjust(k)})}return n_(i)&&By(hn({},r,{options:(0,P.pi)((0,P.pi)((0,P.pi)({},fs(e,w)),i),{widthRatio:i.columnWidthRatio,interval:(0,P.pi)((0,P.pi)({},fs(i,["color"])),{style:i.columnStyle})})})),r}function l4(r){var e=r.view,t=r.geometryOption,i=r.yField,u=r.legend,c=(0,b.U2)(u,"marker"),p=Ec(e,hb(t)?"line":"interval");if(!t.seriesField){var g=(0,b.U2)(e,"options.scales."+i+".alias")||i,_=p.getAttribute("color"),w=e.getTheme().defaultColor;_&&(w=_c.getMappingValue(_,g,(0,b.U2)(_,["values",0],w)));var k=((0,b.mf)(c)?c:!(0,b.xb)(c)&&hn({},{style:{stroke:w,fill:w}},c))||(hb(t)?{symbol:function(R,U,G){return[["M",R-G,U],["L",R+G,U]]},style:{lineWidth:2,r:6,stroke:w}}:{symbol:"square",style:{fill:w}});return[{value:i,name:g,marker:k,isGeometry:!0,viewId:e.id}]}var L=p.getGroupAttributes();return(0,b.u4)(L,function(R,U){var G=_c.getLegendItems(e,p,U,e.getTheme(),c);return R.concat(G)},[])}var db=function(r,e){var t=e[0],i=e[1],u=r.getOptions().data,c=r.getXScale(),p=(0,b.dp)(u);if(!(!c||!p)){var g=!0,_=(0,b.I)(u,c.field),w=g?_:_.reverse(),k=(0,b.dp)(w),L=Math.floor(t*(k-1)),R=Math.floor(i*(k-1));r.filter(c.field,function(U){var G=w.indexOf(U);return G>-1?yu(G,L,R):!0}),r.getRootView().render(!0)}};function wC(r){var e,t=r.options,i=t.geometryOptions,u=i===void 0?[]:i,c=t.xField,p=t.yField,g=(0,b.yW)(u,function(_){var w=_.geometry;return w===D0.Line||w===void 0});return hn({},{options:{geometryOptions:[],meta:(e={},e[c]={type:"cat",sync:!0,range:g?[0,1]:void 0},e),tooltip:{showMarkers:g,showCrosshairs:g,shared:!0,crosshairs:{type:"x"}},interactions:g?[{type:"legend-visible-filter"}]:[{type:"legend-visible-filter"},{type:"active-region"}],legend:{position:"top-left"}}},r,{options:{yAxis:EC(p,t.yAxis),geometryOptions:[bC(c,p[0],u[0]),bC(c,p[1],u[1])],annotations:EC(p,t.annotations)}})}function CC(r){var e,t,i=r.chart,u=r.options,c=u.geometryOptions,p={line:0,column:1},g=[{type:(e=c[0])===null||e===void 0?void 0:e.geometry,id:lh},{type:(t=c[1])===null||t===void 0?void 0:t.geometry,id:Nf}];return g.sort(function(_,w){return-p[_.type]+p[w.type]}).forEach(function(_){return i.createView({id:_.id})}),r}function vb(r){var e=r.chart,t=r.options,i=t.xField,u=t.yField,c=t.geometryOptions,p=t.data,g=t.tooltip,_=[(0,P.pi)((0,P.pi)({},c[0]),{id:lh,data:p[0],yField:u[0]}),(0,P.pi)((0,P.pi)({},c[1]),{id:Nf,data:p[1],yField:u[1]})];return _.forEach(function(w){var k=w.id,L=w.data,R=w.yField,U=n_(w)&&w.isPercent,G=U?FS(L,R,i,R):L,Q=yo(e,k).data(G),pt=U?(0,P.pi)({formatter:function(vt){return{name:vt[w.seriesField]||R,value:(Number(vt[R])*100).toFixed(2)+"%"}}},g):g;pb({chart:Q,options:{xField:i,yField:R,tooltip:pt,geometryOption:w}})}),r}function gb(r){var e,t=r.chart,i=r.options,u=i.geometryOptions,c=((e=t.getTheme())===null||e===void 0?void 0:e.colors10)||[],p=0;return t.once("beforepaint",function(){(0,b.S6)(u,function(g,_){var w=yo(t,_===0?lh:Nf);if(!g.color){var k=w.getGroupScales(),L=(0,b.U2)(k,[0,"values","length"],1),R=c.slice(p,p+L).concat(_===0?[]:c);w.geometries.forEach(function(U){g.seriesField?U.color(g.seriesField,R):U.color(R[0])}),p+=L}}),t.render(!0)}),r}function gf(r){var e,t,i=r.chart,u=r.options,c=u.xAxis,p=u.yAxis,g=u.xField,_=u.yField;return Zs((e={},e[g]=c,e[_[0]]=p[0],e))(hn({},r,{chart:yo(i,lh)})),Zs((t={},t[g]=c,t[_[1]]=p[1],t))(hn({},r,{chart:yo(i,Nf)})),r}function mb(r){var e=r.chart,t=r.options,i=yo(e,lh),u=yo(e,Nf),c=t.xField,p=t.yField,g=t.xAxis,_=t.yAxis;return e.axis(c,!1),e.axis(p[0],!1),e.axis(p[1],!1),i.axis(c,g),i.axis(p[0],SC(_[0],R0.Left)),u.axis(c,!1),u.axis(p[1],SC(_[1],R0.Right)),r}function Ig(r){var e=r.chart,t=r.options,i=t.tooltip,u=yo(e,lh),c=yo(e,Nf);return e.tooltip(i),u.tooltip({shared:!0}),c.tooltip({shared:!0}),r}function iF(r){var e=r.chart;return Xs(hn({},r,{chart:yo(e,lh)})),Xs(hn({},r,{chart:yo(e,Nf)})),r}function AC(r){var e=r.chart,t=r.options,i=t.annotations,u=(0,b.U2)(i,[0]),c=(0,b.U2)(i,[1]);return Ys(u)(hn({},r,{chart:yo(e,lh),options:{annotations:u}})),Ys(c)(hn({},r,{chart:yo(e,Nf),options:{annotations:c}})),r}function c4(r){var e=r.chart;return Bo(hn({},r,{chart:yo(e,lh)})),Bo(hn({},r,{chart:yo(e,Nf)})),Bo(r),r}function aF(r){var e=r.chart;return ms(hn({},r,{chart:yo(e,lh)})),ms(hn({},r,{chart:yo(e,Nf)})),r}function i_(r){var e=r.chart,t=r.options,i=t.yAxis;return Df(hn({},r,{chart:yo(e,lh),options:{yAxis:i[0]}})),Df(hn({},r,{chart:yo(e,Nf),options:{yAxis:i[1]}})),r}function Em(r){var e=r.chart,t=r.options,i=t.legend,u=t.geometryOptions,c=t.yField,p=t.data,g=yo(e,lh),_=yo(e,Nf);if(i===!1)e.legend(!1);else if((0,b.Kn)(i)&&i.custom===!0)e.legend(i);else{var w=(0,b.U2)(u,[0,"legend"],i),k=(0,b.U2)(u,[1,"legend"],i);e.once("beforepaint",function(){var L=p[0].length?l4({view:g,geometryOption:u[0],yField:c[0],legend:w}):[],R=p[1].length?l4({view:_,geometryOption:u[1],yField:c[1],legend:k}):[];e.legend(hn({},i,{custom:!0,items:L.concat(R)}))}),u[0].seriesField&&g.legend(u[0].seriesField,w),u[1].seriesField&&_.legend(u[1].seriesField,k),e.on("legend-item:click",function(L){var R=(0,b.U2)(L,"gEvent.delegateObject",{});if(R&&R.item){var U=R.item,G=U.value,Q=U.isGeometry,pt=U.viewId;if(Q){var vt=(0,b.cx)(c,function(he){return he===G});if(vt>-1){var Vt=(0,b.U2)(yo(e,pt),"geometries");(0,b.S6)(Vt,function(he){he.changeVisible(!R.item.unchecked)})}}else{var le=(0,b.U2)(e.getController("legend"),"option.items",[]);(0,b.S6)(e.views,function(he){var Ne=he.getGroupScales();(0,b.S6)(Ne,function(Er){Er.values&&Er.values.indexOf(G)>-1&&he.filter(Er.field,function(Fr){var zr=(0,b.sE)(le,function(pn){return pn.value===Fr});return!zr.unchecked})}),e.render(!0)})}}})}return r}function TC(r){var e=r.chart,t=r.options,i=t.slider,u=yo(e,lh),c=yo(e,Nf);return i&&(u.option("slider",i),u.on("slider:valuechanged",function(p){var g=p.event,_=g.value,w=g.originValue;(0,b.Xy)(_,w)||db(c,_)}),e.once("afterpaint",function(){if(!(0,b.jn)(i)){var p=i.start,g=i.end;(p||g)&&db(c,[p,g])}})),r}function MC(r){return Ga(wC,CC,c4,vb,gf,mb,i_,Ig,iF,AC,aF,gb,Em,TC)(r)}var f4=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="dual-axes",t}return e.prototype.getDefaultOptions=function(){return hn({},r.prototype.getDefaultOptions.call(this),{yAxis:[],syncViewPadding:!0})},e.prototype.getSchemaAdaptor=function(){return MC},e}(Ha);function B0(r,e){var t=e.data,i=e.coordinate,u=e.interactions,c=e.annotations,p=e.animation,g=e.tooltip,_=e.axes,w=e.meta,k=e.geometries;t&&r.data(t);var L={};_&&(0,b.S6)(_,function(R,U){L[U]=fs(R,Rf)}),L=hn({},w,L),r.scale(L),i&&r.coordinate(i),_===!1?r.axis(!1):(0,b.S6)(_,function(R,U){r.axis(U,R)}),(0,b.S6)(k,function(R){var U=Fl({chart:r,options:R}).ext,G=R.adjust;G&&U.geometry.adjust(G)}),(0,b.S6)(u,function(R){R.enable===!1?r.removeInteraction(R.type):r.interaction(R.type,R.cfg)}),(0,b.S6)(c,function(R){r.annotation()[R.type]((0,P.pi)({},R))}),E0(r,p),g?(r.interaction("tooltip"),r.tooltip(g)):g===!1&&r.removeInteraction("tooltip")}function yb(r){var e=r.chart,t=r.options,i=t.type,u=t.data,c=t.fields,p=t.eachView,g=(0,b.CE)(t,["type","data","fields","eachView","axes","meta","tooltip","coordinate","theme","legend","interactions","annotations"]);return e.data(u),e.facet(i,(0,P.pi)((0,P.pi)({},g),{fields:c,eachView:function(_,w){var k=p(_,w);if(k.geometries)B0(_,k);else{var L=k,R=L.options;R.tooltip&&_.interaction("tooltip"),Ux(L.type,_,R)}}})),r}function a_(r){var e=r.chart,t=r.options,i=t.axes,u=t.meta,c=t.tooltip,p=t.coordinate,g=t.theme,_=t.legend,w=t.interactions,k=t.annotations,L={};return i&&(0,b.S6)(i,function(R,U){L[U]=fs(R,Rf)}),L=hn({},u,L),e.scale(L),e.coordinate(p),i?(0,b.S6)(i,function(R,U){e.axis(U,R)}):e.axis(!1),c?(e.interaction("tooltip"),e.tooltip(c)):c===!1&&e.removeInteraction("tooltip"),e.legend(_),g&&e.theme(g),(0,b.S6)(w,function(R){R.enable===!1?e.removeInteraction(R.type):e.interaction(R.type,R.cfg)}),(0,b.S6)(k,function(R){e.annotation()[R.type]((0,P.pi)({},R))}),r}function h4(r){return Ga(Bo,yb,a_)(r)}var p4={title:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}},rowTitle:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}},columnTitle:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}}},Sm=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="area",t}return e.getDefaultOptions=function(){return p4},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return h4},e}(Ha);function d4(r){var e=r.chart,t=r.options,i=t.data,u=t.type,c=t.xField,p=t.yField,g=t.colorField,_=t.sizeField,w=t.sizeRatio,k=t.shape,L=t.color,R=t.tooltip,U=t.heatmapStyle,G=t.meta;e.data(i);var Q="polygon";u==="density"&&(Q="heatmap");var pt=zh(R,[c,p,g]),vt=pt.fields,Vt=pt.formatter,le=1;return(w||w===0)&&(!k&&!_?console.warn("sizeRatio is not in effect: Must define shape or sizeField first"):w<0||w>1?console.warn("sizeRatio is not in effect: It must be a number in [0,1]"):le=w),Fl(hn({},r,{options:{type:Q,colorField:g,tooltipFields:vt,shapeField:_||"",label:void 0,mapping:{tooltip:Vt,shape:k&&(_?function(he){var Ne=i.map(function(pn){return pn[_]}),Er=(G==null?void 0:G[_])||{},Fr=Er.min,zr=Er.max;return Fr=(0,b.hj)(Fr)?Fr:Math.min.apply(Math,Ne),zr=(0,b.hj)(zr)?zr:Math.max.apply(Math,Ne),[k,((0,b.U2)(he,_)-Fr)/(zr-Fr),le]}:function(){return[k,1,le]}),color:L||g&&e.getTheme().sequenceColors.join("-"),style:U}}})),r}function v4(r){var e,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return Ga(Zs((e={},e[c]=i,e[p]=u,e)))(r)}function oF(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?e.axis(p,!1):e.axis(p,u),r}function sF(r){var e=r.chart,t=r.options,i=t.legend,u=t.colorField,c=t.sizeField,p=t.sizeLegend,g=i!==!1;return u&&e.legend(u,g?i:!1),c&&e.legend(c,p===void 0?i:p),!g&&!p&&e.legend(!1),r}function uF(r){var e=r.chart,t=r.options,i=t.label,u=t.colorField,c=t.type,p=Ec(e,c==="density"?"heatmap":"polygon");if(!i)p.label(!1);else if(u){var g=i.callback,_=(0,P._T)(i,["callback"]);p.label({fields:[u],callback:g,cfg:Os(_)})}return r}function lF(r){var e,t,i=r.chart,u=r.options,c=u.coordinate,p=u.reflect,g=hn({actions:[]},c!=null?c:{type:"rect"});return p&&((t=(e=g.actions)===null||e===void 0?void 0:e.push)===null||t===void 0||t.call(e,["reflect",p])),i.coordinate(g),r}function cF(r){return Ga(Bo,Nh("heatmapStyle"),v4,lF,d4,oF,sF,hl,uF,Ys(),Xs,ms,S0)(r)}var fF=hn({},Ha.getDefaultOptions(),{type:"polygon",legend:!1,coordinate:{type:"rect"},xAxis:{tickLine:null,line:null,grid:{alignTick:!1,line:{style:{lineWidth:1,lineDash:null,stroke:"#f0f0f0"}}}},yAxis:{grid:{alignTick:!1,line:{style:{lineWidth:1,lineDash:null,stroke:"#f0f0f0"}}}}});va("polygon","circle",{draw:function(r,e){var t,i,u=r.x,c=r.y,p=this.parsePoints(r.points),g=Math.abs(p[2].x-p[1].x),_=Math.abs(p[1].y-p[0].y),w=Math.min(g,_)/2,k=Number(r.shape[1]),L=Number(r.shape[2]),R=Math.sqrt(L),U=w*R*Math.sqrt(k),G=((t=r.style)===null||t===void 0?void 0:t.fill)||r.color||((i=r.defaultStyle)===null||i===void 0?void 0:i.fill),Q=e.addShape("circle",{attrs:(0,P.pi)((0,P.pi)((0,P.pi)({x:u,y:c,r:U},r.defaultStyle),r.style),{fill:G})});return Q}}),va("polygon","square",{draw:function(r,e){var t,i,u=r.x,c=r.y,p=this.parsePoints(r.points),g=Math.abs(p[2].x-p[1].x),_=Math.abs(p[1].y-p[0].y),w=Math.min(g,_),k=Number(r.shape[1]),L=Number(r.shape[2]),R=Math.sqrt(L),U=w*R*Math.sqrt(k),G=((t=r.style)===null||t===void 0?void 0:t.fill)||r.color||((i=r.defaultStyle)===null||i===void 0?void 0:i.fill),Q=e.addShape("rect",{attrs:(0,P.pi)((0,P.pi)((0,P.pi)({x:u-U/2,y:c-U/2,width:U,height:U},r.defaultStyle),r.style),{fill:G})});return Q}});var RR=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="heatmap",t}return e.getDefaultOptions=function(){return fF},e.prototype.getSchemaAdaptor=function(){return cF},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ha),IC="liquid";function o_(r){return[{percent:r,type:IC}]}function hF(r){var e=r.chart,t=r.options,i=t.percent,u=t.liquidStyle,c=t.radius,p=t.outline,g=t.wave,_=t.shape,w=t.shapeStyle,k=t.animation;e.scale({percent:{min:0,max:1}}),e.data(o_(i));var L=t.color||e.getTheme().defaultColor,R=hn({},r,{options:{xField:"type",yField:"percent",widthRatio:c,interval:{color:L,style:u,shape:"liquid-fill-gauge"}}}),U=ac(R).ext,G=U.geometry,Q=e.getTheme().background,pt={radius:c,outline:p,wave:g,shape:_,shapeStyle:w,background:Q,animation:k};return G.customInfo(pt),e.legend(!1),e.axis(!1),e.tooltip(!1),r}function _b(r,e){var t=r.chart,i=r.options,u=i.statistic,c=i.percent,p=i.meta;t.getController("annotation").clear(!0);var g=(0,b.U2)(p,["percent","formatter"])||function(w){return(w*100).toFixed(2)+"%"},_=u.content;return _&&(_=hn({},_,{content:(0,b.UM)(_.content)?g(c):_.content})),Iy(t,{statistic:(0,P.pi)((0,P.pi)({},u),{content:_}),plotType:"liquid"},{percent:c}),e&&t.render(!0),r}function g4(r){return Ga(Bo,Nh("liquidStyle"),hF,_b,Zs({}),ms,Xs)(r)}var pF={radius:.9,statistic:{title:!1,content:{style:{opacity:.75,fontSize:"30px",lineHeight:"30px",textAlign:"center"}}},outline:{border:2,distance:0},wave:{count:3,length:192},shape:"circle"},xb=5e3;function kC(r,e,t){return r+(e-r)*t}function dF(r){var e=(0,P.pi)({opacity:1},r.style);return r.color&&!e.fill&&(e.fill=r.color),e}function LC(r){var e={fill:"#fff",fillOpacity:0,lineWidth:4},t=(0,b.CD)({},e,r.style);return r.color&&!t.stroke&&(t.stroke=r.color),(0,b.hj)(r.opacity)&&(t.opacity=t.strokeOpacity=r.opacity),t}function m4(r,e,t,i){return e===0?[[r+1/2*t/Math.PI/2,i/2],[r+1/2*t/Math.PI,i],[r+t/4,i]]:e===1?[[r+1/2*t/Math.PI/2*(Math.PI-2),i],[r+1/2*t/Math.PI/2*(Math.PI-1),i/2],[r+t/4,0]]:e===2?[[r+1/2*t/Math.PI/2,-i/2],[r+1/2*t/Math.PI,-i],[r+t/4,-i]]:[[r+1/2*t/Math.PI/2*(Math.PI-2),-i],[r+1/2*t/Math.PI/2*(Math.PI-1),-i/2],[r+t/4,0]]}function vF(r,e,t,i,u,c,p){for(var g=Math.ceil(2*r/t*4)*4,_=[],w=i;w<-Math.PI*2;)w+=Math.PI*2;for(;w>0;)w-=Math.PI*2;w=w/Math.PI/2*t;var k=c-r+w-r*2;_.push(["M",k,e]);for(var L=0,R=0;R<g;++R){var U=R%4,G=m4(R*t/4,U,t,u);_.push(["C",G[0][0]+k,-G[0][1]+e,G[1][0]+k,-G[1][1]+e,G[2][0]+k,-G[2][1]+e]),R===g-1&&(L=G[2][0])}return _.push(["L",L+k,p+r]),_.push(["L",k,p+r]),_.push(["Z"]),_}function s_(r,e,t,i,u,c,p,g,_,w){for(var k=u.fill,L=u.opacity,R=p.getBBox(),U=R.maxX-R.minX,G=R.maxY-R.minY,Q=0;Q<i;Q++){var pt=i<=1?1:Q/(i-1),vt=c.addShape("path",{name:"waterwave-path",attrs:{path:vF(g,R.minY+G*t,_,0,U/32,r,e),fill:k,opacity:kC(.2,.9,pt)*L}});try{if(w===!1)return;var Vt=Ox([["t",_,0]]);vt.stopAnimate(),vt.animate({matrix:Vt},{duration:kC(.5*xb,xb,pt),repeat:!0})}catch(le){console.warn("off-screen group animate error!")}}}function y4(r,e,t,i){var u=t*2/3,c=Math.max(u,i),p=u/2,g=r,_=p+e-c/2,w=Math.asin(p/((c-p)*.85)),k=Math.sin(w)*p,L=Math.cos(w)*p,R=g-L,U=_+k,G=r,Q=_+p/Math.sin(w);return`
      M `+R+" "+U+`
      A `+p+" "+p+" 0 1 1 "+(R+L*2)+" "+U+`
      Q `+G+" "+Q+" "+r+" "+(e+c/2)+`
      Q `+G+" "+Q+" "+R+" "+U+`
      Z 
    `}function gF(r,e,t,i){var u=t/2,c=i/2;return`
      M `+r+" "+(e-c)+` 
      a `+u+" "+c+" 0 1 0 0 "+c*2+`
      a `+u+" "+c+" 0 1 0 0 "+-c*2+`
      Z
    `}function N0(r,e,t,i){var u=i/2,c=t/2;return`
      M `+r+" "+(e-u)+`
      L `+(r+c)+" "+e+`
      L `+r+" "+(e+u)+`
      L `+(r-c)+" "+e+`
      Z
    `}function PC(r,e,t,i){var u=i/2,c=t/2;return`
      M `+r+" "+(e-u)+`
      L `+(r+c)+" "+(e+u)+`
      L `+(r-c)+" "+(e+u)+`
      Z
    `}function u_(r,e,t,i){var u=.618,c=i/2,p=t/2*u;return`
      M `+(r-p)+" "+(e-c)+`
      L `+(r+p)+" "+(e-c)+`
      L `+(r+p)+" "+(e+c)+`
      L `+(r-p)+" "+(e+c)+`
      Z
    `}var OC={pin:y4,circle:gF,diamond:N0,triangle:PC,rect:u_};va("interval","liquid-fill-gauge",{draw:function(r,e){var t=.5,i=.5,u=r.customInfo,c=u,p=c.radius,g=c.shape,_=c.shapeStyle,w=c.background,k=c.animation,L=u.outline,R=u.wave,U=L.border,G=L.distance,Q=R.count,pt=R.length,vt=(0,b.u4)(r.points,function(ha,wa){return Math.min(ha,wa.x)},1/0),Vt=this.parsePoint({x:t,y:i}),le=this.parsePoint({x:vt,y:i}),he=Vt.x-le.x,Ne=Math.min(he,le.y*p),Er=dF(r),Fr=LC((0,b.CD)({},r,L)),zr=Ne-U/2,pn=typeof g=="function"?g:OC[g]||OC.circle,nn=pn(Vt.x,Vt.y,zr*2,zr*2);_&&e.addShape("path",{name:"shape",attrs:(0,P.pi)({path:nn},_)});var Pn=e.addGroup({name:"waves"}),Si=Pn.setClip({type:"path",attrs:{path:nn}});return s_(Vt.x,Vt.y,1-r.points[1].y,Q,Er,Pn,Si,Ne*2,pt,k),e.addShape("path",{name:"distance",attrs:{path:nn,fill:"transparent",lineWidth:U+G*2,stroke:w==="transparent"?"#fff":w}}),e.addShape("path",{name:"wrap",attrs:(0,b.CD)(Fr,{path:nn,fill:"transparent",lineWidth:U})}),e}});var mF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="liquid",t}return e.getDefaultOptions=function(){return pF},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.changeData=function(t){this.chart.emit(Mt.BEFORE_CHANGE_DATA,pe.fromData(this.chart,Mt.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t}),this.chart.data(o_(t)),_b({chart:this.chart,options:this.options},!0),this.chart.emit(Mt.AFTER_CHANGE_DATA,pe.fromData(this.chart,Mt.AFTER_CHANGE_DATA,null))},e.prototype.getSchemaAdaptor=function(){return g4},e}(Ha);function kg(r){var e=r.chart,t=r.options,i=t.data,u=t.lineStyle,c=t.color,p=t.point,g=t.area;e.data(i);var _=hn({},r,{options:{line:{style:u,color:c},point:p&&(0,P.pi)({color:c},p),area:g&&(0,P.pi)({color:c},g),label:void 0}}),w=hn({},_,{options:{tooltip:!1}}),k=(p==null?void 0:p.state)||t.state,L=hn({},_,{options:{tooltip:!1,state:k}});return C0(_),Bf(L),Gv(w),r}function _4(r){var e,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return Ga(Zs((e={},e[c]=i,e[p]=u,e)))(r)}function x4(r){var e=r.chart,t=r.options,i=t.radius,u=t.startAngle,c=t.endAngle;return e.coordinate("polar",{radius:i,startAngle:u,endAngle:c}),r}function yF(r){var e=r.chart,t=r.options,i=t.xField,u=t.xAxis,c=t.yField,p=t.yAxis;return e.axis(i,u),e.axis(c,p),r}function _F(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=Ec(e,"line");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[u],callback:p,cfg:Os(g)})}return r}function xF(r){return Ga(kg,_4,Bo,x4,yF,vg,hl,_F,Xs,ms,Ys())(r)}var bF=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"name",{get:function(){return"radar-tooltip"},enumerable:!1,configurable:!0}),e.prototype.getTooltipItems=function(t){var i=this.getTooltipCfg(),u=i.shared,c=i.title,p=r.prototype.getTooltipItems.call(this,t);if(p.length>0){var g=this.view.geometries[0],_=g.dataArray,w=p[0].name,k=[];return _.forEach(function(L){L.forEach(function(R){var U=_c.getTooltipItems(R,g),G=U[0];if(!u&&G&&G.name===w){var Q=(0,b.UM)(c)?w:c;k.push((0,P.pi)((0,P.pi)({},G),{name:G.title,title:Q}))}else if(u&&G){var Q=(0,b.UM)(c)?G.name||w:c;k.push((0,P.pi)((0,P.pi)({},G),{name:G.title,title:Q}))}})}),k}return[]},e}(Di);N("radar-tooltip",bF);var EF=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.init=function(){var t=this.context.view;t.removeInteraction("tooltip")},e.prototype.show=function(){var t=this.context.event,i=this.getTooltipController();i.showTooltip({x:t.x,y:t.y})},e.prototype.hide=function(){var t=this.getTooltipController();t.hideTooltip()},e.prototype.getTooltipController=function(){var t=this.context.view;return t.getController("radar-tooltip")},e}(oi);Yn("radar-tooltip",EF),kn("radar-tooltip",{start:[{trigger:"plot:mousemove",action:"radar-tooltip:show"}],end:[{trigger:"plot:mouseleave",action:"radar-tooltip:hide"}]});var DR=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="radar",t}return e.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return hn({},r.prototype.getDefaultOptions.call(this),{xAxis:{label:{offset:15},grid:{line:{type:"line"}}},yAxis:{grid:{line:{type:"circle"}}},legend:{position:"top"},tooltip:{shared:!0,showCrosshairs:!0,showMarkers:!0,crosshairs:{type:"xy",line:{style:{stroke:"#565656",lineDash:[4]}},follow:!0}}})},e.prototype.getSchemaAdaptor=function(){return xF},e}(Ha);function SF(r,e,t){var i=t.map(function(p){return p[e]}).filter(function(p){return p!==void 0}),u=i.length>0?Math.max.apply(Math,i):0,c=Math.abs(r)%360;return c?u*360/c:u}function FC(r,e,t){var i=[];return r.forEach(function(u){var c=i.find(function(p){return p[e]===u[e]});c?c[t]+=u[t]||null:i.push((0,P.pi)({},u))}),i}function RC(r){var e=r.chart,t=r.options,i=t.barStyle,u=t.color,c=t.tooltip,p=t.colorField,g=t.type,_=t.xField,w=t.yField,k=t.data,L=pg(k,w);e.data(L);var R=hn({},r,{options:{tooltip:c,seriesField:p,interval:{style:i,color:u,shape:g==="line"?"line":"intervel"},minColumnWidth:t.minBarWidth,maxColumnWidth:t.maxBarWidth,columnBackground:t.barBackground}});return ac(R),g==="line"&&Bf({chart:e,options:{xField:_,yField:w,seriesField:p,point:{shape:"circle",color:u}}}),r}function b4(r){var e,t=r.options,i=t.yField,u=t.xField,c=t.data,p=t.isStack,g=t.isGroup,_=t.colorField,w=t.maxAngle,k=p&&!g&&_?FC(c,u,i):c,L=pg(k,i);return Ga(Zs((e={},e[i]={min:0,max:SF(w,i,L)},e)))(r)}function bb(r){var e=r.chart,t=r.options,i=t.radius,u=t.innerRadius,c=t.startAngle,p=t.endAngle;return e.coordinate({type:"polar",cfg:{radius:i,innerRadius:u,startAngle:c,endAngle:p}}).transpose(),r}function wm(r){var e=r.chart,t=r.options,i=t.xField,u=t.xAxis;return e.axis(i,u),r}function wF(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=Ec(e,"interval");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[u],callback:p,cfg:(0,P.pi)((0,P.pi)({},Os(g)),{type:"polar"})})}return r}function Eb(r){return Ga(Nh("barStyle"),RC,b4,wm,bb,Xs,ms,Bo,hl,vg,Ys(),wF)(r)}var Sb=hn({},Ha.getDefaultOptions(),{interactions:[{type:"element-active"}],legend:!1,tooltip:{showMarkers:!1},xAxis:{grid:null,tickLine:null,line:null},maxAngle:240}),l_=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="radial-bar",t}return e.getDefaultOptions=function(){return Sb},e.prototype.changeData=function(t){this.updateOption({data:t}),b4({chart:this.chart,options:this.options}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Eb},e}(Ha);function E4(r){var e=r.chart,t=r.options,i=t.data,u=t.sectorStyle,c=t.color;return e.data(i),Ga(ac)(hn({},r,{options:{marginRatio:1,interval:{style:u,color:c}}})),r}function DC(r){var e=r.chart,t=r.options,i=t.label,u=t.xField,c=Ec(e,"interval");if(i===!1)c.label(!1);else if((0,b.Kn)(i)){var p=i.callback,g=i.fields,_=(0,P._T)(i,["callback","fields"]),w=_.offset,k=_.layout;(w===void 0||w>=0)&&(k=k?(0,b.kJ)(k)?k:[k]:[],_.layout=(0,b.hX)(k,function(L){return L.type!=="limit-in-shape"}),_.layout.length||delete _.layout),c.label({fields:g||[u],callback:p,cfg:Os(_)})}else Ap(Cp.WARN,i===null,"the label option must be an Object."),c.label({fields:[u]});return r}function oc(r){var e=r.chart,t=r.options,i=t.legend,u=t.seriesField;return i===!1?e.legend(!1):u&&e.legend(u,i),r}function S4(r){var e=r.chart,t=r.options,i=t.radius,u=t.innerRadius,c=t.startAngle,p=t.endAngle;return e.coordinate({type:"polar",cfg:{radius:i,innerRadius:u,startAngle:c,endAngle:p}}),r}function w4(r){var e,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return Ga(Zs((e={},e[c]=i,e[p]=u,e)))(r)}function Cs(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return i?e.axis(c,i):e.axis(c,!1),u?e.axis(p,u):e.axis(p,!1),r}function C4(r){Ga(Nh("sectorStyle"),E4,w4,DC,S4,Cs,oc,hl,Xs,ms,Bo,Ys(),S0)(r)}var Cm=hn({},Ha.getDefaultOptions(),{xAxis:!1,yAxis:!1,legend:{position:"right",radio:{}},sectorStyle:{stroke:"#fff",lineWidth:1},label:{layout:{type:"limit-in-shape"}},tooltip:{shared:!0,showMarkers:!1},interactions:[{type:"active-region"}]}),c_=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="rose",t}return e.getDefaultOptions=function(){return Cm},e.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return C4},e}(Ha),BC="x",NC="y",zC="name",f_="nodes",h_="edges";function UC(r,e,t){var i=[];return r.forEach(function(u){var c=u[e],p=u[t];i.includes(c)||i.push(c),i.includes(p)||i.push(p)}),i}function ZC(r,e,t,i){var u={};return e.forEach(function(c){u[c]={},e.forEach(function(p){u[c][p]=0})}),r.forEach(function(c){u[c[t]][c[i]]=1}),u}function A4(r,e,t){if(!(0,b.kJ)(r))return[];var i=[],u=UC(r,e,t),c=ZC(r,u,e,t),p={};u.forEach(function(_){p[_]=0});function g(_){p[_]=1,u.forEach(function(w){if(c[_][w]!=0)if(p[w]==1)i.push(_+"_"+w);else{if(p[w]==-1)return;g(w)}}),p[_]=-1}return u.forEach(function(_){p[_]!=-1&&g(_)}),i.length!==0&&console.warn("sankey data contains circle, "+i.length+" records removed.",i),r.filter(function(_){return i.findIndex(function(w){return w===_[e]+"_"+_[t]})<0})}function T4(r){return r.target.depth}function M4(r){return r.depth}function VC(r,e){return e-1-r.height}function wb(r,e){return r.sourceLinks.length?r.depth:e-1}function GC(r){return r.targetLinks.length?r.depth:r.sourceLinks.length?(0,b.F)(r.sourceLinks,T4)-1:0}function p_(r){return function(){return r}}function Cb(r,e){for(var t=0,i=0;i<r.length;i++)t+=e(r[i]);return t}function Ab(r,e){for(var t=-1/0,i=0;i<r.length;i++)t=Math.max(e(r[i]),t);return t}function I4(r,e){for(var t=1/0,i=0;i<r.length;i++)t=Math.min(e(r[i]),t);return t}function HC(r,e){return d_(r.source,e.source)||r.index-e.index}function jC(r,e){return d_(r.target,e.target)||r.index-e.index}function d_(r,e){return r.y0-e.y0}function v_(r){return r.value}function k4(r){return r.index}function L4(r){return r.nodes}function P4(r){return r.links}function Tb(r,e){var t=r.get(e);if(!t)throw new Error("missing: "+e);return t}function WC(r){for(var e=r.nodes,t=0,i=e;t<i.length;t++){for(var u=i[t],c=u.y0,p=c,g=0,_=u.sourceLinks;g<_.length;g++){var w=_[g];w.y0=c+w.width/2,c+=w.width}for(var k=0,L=u.targetLinks;k<L.length;k++){var w=L[k];w.y1=p+w.width/2,p+=w.width}}}function O4(){var r=0,e=0,t=1,i=1,u=24,c=8,p,g=k4,_=wb,w,k,L,R=L4,U=P4,G=6;function Q(Vn){var Bi={nodes:R(Vn),links:U(Vn)};return pt(Bi),vt(Bi),Vt(Bi),le(Bi),Er(Bi),WC(Bi),Bi}Q.update=function(Vn){return WC(Vn),Vn},Q.nodeId=function(Vn){return arguments.length?(g=typeof Vn=="function"?Vn:p_(Vn),Q):g},Q.nodeAlign=function(Vn){return arguments.length?(_=typeof Vn=="function"?Vn:p_(Vn),Q):_},Q.nodeDepth=function(Vn){return arguments.length?(w=Vn,Q):w},Q.nodeSort=function(Vn){return arguments.length?(k=Vn,Q):k},Q.nodeWidth=function(Vn){return arguments.length?(u=+Vn,Q):u},Q.nodePadding=function(Vn){return arguments.length?(c=p=+Vn,Q):c},Q.nodes=function(Vn){return arguments.length?(R=typeof Vn=="function"?Vn:p_(Vn),Q):R},Q.links=function(Vn){return arguments.length?(U=typeof Vn=="function"?Vn:p_(Vn),Q):U},Q.linkSort=function(Vn){return arguments.length?(L=Vn,Q):L},Q.size=function(Vn){return arguments.length?(r=e=0,t=+Vn[0],i=+Vn[1],Q):[t-r,i-e]},Q.extent=function(Vn){return arguments.length?(r=+Vn[0][0],t=+Vn[1][0],e=+Vn[0][1],i=+Vn[1][1],Q):[[r,e],[t,i]]},Q.iterations=function(Vn){return arguments.length?(G=+Vn,Q):G};function pt(Vn){var Bi=Vn.nodes,fa=Vn.links;Bi.forEach(function(Io,hs){Io.index=hs,Io.sourceLinks=[],Io.targetLinks=[]});var Ui=new Map(Bi.map(function(Io){return[g(Io),Io]}));if(fa.forEach(function(Io,hs){Io.index=hs;var tl=Io.source,pl=Io.target;typeof tl!="object"&&(tl=Io.source=Tb(Ui,tl)),typeof pl!="object"&&(pl=Io.target=Tb(Ui,pl)),tl.sourceLinks.push(Io),pl.targetLinks.push(Io)}),L!=null)for(var Ji=0,Fa=Bi;Ji<Fa.length;Ji++){var xo=Fa[Ji],Mo=xo.sourceLinks,ao=xo.targetLinks;Mo.sort(L),ao.sort(L)}}function vt(Vn){for(var Bi=Vn.nodes,fa=0,Ui=Bi;fa<Ui.length;fa++){var Ji=Ui[fa];Ji.value=Ji.fixedValue===void 0?Math.max(Cb(Ji.sourceLinks,v_),Cb(Ji.targetLinks,v_)):Ji.fixedValue}}function Vt(Vn){for(var Bi=Vn.nodes,fa=Bi.length,Ui=new Set(Bi),Ji=new Set,Fa=0;Ui.size;){if(Ui.forEach(function(Io){Io.depth=Fa;for(var hs=0,tl=Io.sourceLinks;hs<tl.length;hs++){var pl=tl[hs].target;Ji.add(pl)}}),++Fa>fa)throw new Error("circular link");Ui=Ji,Ji=new Set}if(w)for(var xo=Math.max(Ab(Bi,function(Io){return Io.depth})+1,0),Mo=void 0,ao=0;ao<Bi.length;ao++)Mo=Bi[ao],Mo.depth=w.call(null,Mo,xo)}function le(Vn){for(var Bi=Vn.nodes,fa=Bi.length,Ui=new Set(Bi),Ji=new Set,Fa=0;Ui.size;){if(Ui.forEach(function(xo){xo.height=Fa;for(var Mo=0,ao=xo.targetLinks;Mo<ao.length;Mo++){var Io=ao[Mo].source;Ji.add(Io)}}),++Fa>fa)throw new Error("circular link");Ui=Ji,Ji=new Set}}function he(Vn){for(var Bi=Vn.nodes,fa=Math.max(Ab(Bi,function(pl){return pl.depth})+1,0),Ui=(t-r-u)/(fa-1),Ji=new Array(fa).fill(0).map(function(){return[]}),Fa=0,xo=Bi;Fa<xo.length;Fa++){var Mo=xo[Fa],ao=Math.max(0,Math.min(fa-1,Math.floor(_.call(null,Mo,fa))));Mo.layer=ao,Mo.x0=r+ao*Ui,Mo.x1=Mo.x0+u,Ji[ao]?Ji[ao].push(Mo):Ji[ao]=[Mo]}if(k)for(var Io=0,hs=Ji;Io<hs.length;Io++){var tl=hs[Io];tl.sort(k)}return Ji}function Ne(Vn){for(var Bi=I4(Vn,function(pd){return(i-e-(pd.length-1)*p)/Cb(pd,v_)}),fa=0,Ui=Vn;fa<Ui.length;fa++){for(var Ji=Ui[fa],Fa=e,xo=0,Mo=Ji;xo<Mo.length;xo++){var ao=Mo[xo];ao.y0=Fa,ao.y1=Fa+ao.value*Bi,Fa=ao.y1+p;for(var Io=0,hs=ao.sourceLinks;Io<hs.length;Io++){var tl=hs[Io];tl.width=tl.value*Bi}}Fa=(i-Fa+p)/(Ji.length+1);for(var pl=0;pl<Ji.length;++pl){var ao=Ji[pl];ao.y0+=Fa*(pl+1),ao.y1+=Fa*(pl+1)}ha(Ji)}}function Er(Vn){var Bi=he(Vn);p=Math.min(c,(i-e)/(Ab(Bi,function(Fa){return Fa.length})-1)),Ne(Bi);for(var fa=0;fa<G;++fa){var Ui=Math.pow(.99,fa),Ji=Math.max(1-Ui,(fa+1)/G);zr(Bi,Ui,Ji),Fr(Bi,Ui,Ji)}}function Fr(Vn,Bi,fa){for(var Ui=1,Ji=Vn.length;Ui<Ji;++Ui){for(var Fa=Vn[Ui],xo=0,Mo=Fa;xo<Mo.length;xo++){for(var ao=Mo[xo],Io=0,hs=0,tl=0,pl=ao.targetLinks;tl<pl.length;tl++){var pd=pl[tl],iv=pd.source,jh=pd.value,Dg=jh*(ao.layer-iv.layer);Io+=wa(iv,ao)*Dg,hs+=Dg}if(hs>0){var Bg=(Io/hs-ao.y0)*Bi;ao.y0+=Bg,ao.y1+=Bg,Si(ao)}}k===void 0&&Fa.sort(d_),Fa.length&&pn(Fa,fa)}}function zr(Vn,Bi,fa){for(var Ui=Vn.length,Ji=Ui-2;Ji>=0;--Ji){for(var Fa=Vn[Ji],xo=0,Mo=Fa;xo<Mo.length;xo++){for(var ao=Mo[xo],Io=0,hs=0,tl=0,pl=ao.sourceLinks;tl<pl.length;tl++){var pd=pl[tl],iv=pd.target,jh=pd.value,Dg=jh*(iv.layer-ao.layer);Io+=_o(ao,iv)*Dg,hs+=Dg}if(hs>0){var Bg=(Io/hs-ao.y0)*Bi;ao.y0+=Bg,ao.y1+=Bg,Si(ao)}}k===void 0&&Fa.sort(d_),Fa.length&&pn(Fa,fa)}}function pn(Vn,Bi){var fa=Vn.length>>1,Ui=Vn[fa];Pn(Vn,Ui.y0-p,fa-1,Bi),nn(Vn,Ui.y1+p,fa+1,Bi),Pn(Vn,i,Vn.length-1,Bi),nn(Vn,e,0,Bi)}function nn(Vn,Bi,fa,Ui){for(;fa<Vn.length;++fa){var Ji=Vn[fa],Fa=(Bi-Ji.y0)*Ui;Fa>1e-6&&(Ji.y0+=Fa,Ji.y1+=Fa),Bi=Ji.y1+p}}function Pn(Vn,Bi,fa,Ui){for(;fa>=0;--fa){var Ji=Vn[fa],Fa=(Ji.y1-Bi)*Ui;Fa>1e-6&&(Ji.y0-=Fa,Ji.y1-=Fa),Bi=Ji.y0-p}}function Si(Vn){var Bi=Vn.sourceLinks,fa=Vn.targetLinks;if(L===void 0){for(var Ui=0,Ji=fa;Ui<Ji.length;Ui++){var Fa=Ji[Ui].source.sourceLinks;Fa.sort(jC)}for(var xo=0,Mo=Bi;xo<Mo.length;xo++){var ao=Mo[xo].target.targetLinks;ao.sort(HC)}}}function ha(Vn){if(L===void 0)for(var Bi=0,fa=Vn;Bi<fa.length;Bi++){var Ui=fa[Bi],Ji=Ui.sourceLinks,Fa=Ui.targetLinks;Ji.sort(jC),Fa.sort(HC)}}function wa(Vn,Bi){for(var fa=Vn.y0-(Vn.sourceLinks.length-1)*p/2,Ui=0,Ji=Vn.sourceLinks;Ui<Ji.length;Ui++){var Fa=Ji[Ui],xo=Fa.target,Mo=Fa.width;if(xo===Bi)break;fa+=Mo+p}for(var ao=0,Io=Bi.targetLinks;ao<Io.length;ao++){var hs=Io[ao],xo=hs.source,Mo=hs.width;if(xo===Vn)break;fa-=Mo}return fa}function _o(Vn,Bi){for(var fa=Bi.y0-(Bi.targetLinks.length-1)*p/2,Ui=0,Ji=Bi.targetLinks;Ui<Ji.length;Ui++){var Fa=Ji[Ui],xo=Fa.source,Mo=Fa.width;if(xo===Vn)break;fa+=Mo+p}for(var ao=0,Io=Vn.sourceLinks;ao<Io.length;ao++){var hs=Io[ao],xo=hs.target,Mo=hs.width;if(xo===Bi)break;fa-=Mo}return fa}return Q}var F4={left:M4,right:VC,center:GC,justify:wb},R4={nodeId:function(r){return r.index},nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodeSort:void 0};function D4(r){var e=(0,b.HD)(r)?F4[r]:(0,b.mf)(r)?r:null;return e||wb}function B4(r){return(0,b.f0)({},R4,r)}function XC(r,e){var t=B4(r),i=t.nodeId,u=t.nodeSort,c=t.nodeAlign,p=t.nodeWidth,g=t.nodePadding,_=t.nodeDepth,w=O4().nodeSort(u).nodeWidth(p).nodePadding(g).nodeDepth(_).nodeAlign(D4(c)).extent([[0,0],[1,1]]).nodeId(i),k=w(e),L=k.nodes.map(function(U){var G=U.x0,Q=U.x1,pt=U.y0,vt=U.y1;return U.x=[G,Q,Q,G],U.y=[pt,pt,vt,vt],U}).filter(function(U){return U.name!==null}),R=k.links.map(function(U){var G=U.source,Q=U.target,pt=G.x1,vt=Q.x0;U.x=[pt,pt,vt,vt];var Vt=U.width/2;return U.y=[U.y0+Vt,U.y0-Vt,U.y1+Vt,U.y1-Vt],U}).filter(function(U){var G=U.source,Q=U.target;return G.name!==null&&Q.name!==null});return{nodes:L,links:R}}function N4(r){return r==="node-link"}function z4(r,e,t){return b0(r)?r/t:e}function U4(r,e,t){return b0(r)?r/t:e}function YC(r,e,t){var i=r.dataType,u=r.data,c=r.sourceField,p=r.targetField,g=r.weightField,_=r.nodeAlign,w=r.nodeSort,k=r.nodePadding,L=r.nodePaddingRatio,R=r.nodeWidth,U=r.nodeWidthRatio,G=r.nodeDepth,Q=r.rawFields,pt=Q===void 0?[]:Q,vt;N4(i)?vt=u:vt=xS(A4(u,c,p),c,p,g,pt);var Vt=XC({nodeAlign:_,nodePadding:U4(k,L,t),nodeWidth:z4(R,U,e),nodeSort:w,nodeDepth:G},vt),le=Vt.nodes,he=Vt.links;return{nodes:le.map(function(Ne){return(0,P.pi)((0,P.pi)({},fs(Ne,(0,P.pr)(["x","y","name"],pt))),{isNode:!0})}),edges:he.map(function(Ne){return(0,P.pi)((0,P.pi)({source:Ne.source.name,target:Ne.target.name,name:Ne.source.name||Ne.target.name},fs(Ne,(0,P.pr)(["x","y","value"],pt))),{isNode:!1})})}}function Z4(r){var e=r.options,t=e.rawFields,i=t===void 0?[]:t;return hn({},{options:{tooltip:{fields:(0,b.jj)((0,P.pr)(["name","source","target","value","isNode"],i))},label:{fields:(0,b.jj)((0,P.pr)(["x","name"],i))}}},r)}function V4(r){var e=r.chart,t=r.options,i=t.color,u=t.nodeStyle,c=t.edgeStyle,p=t.label,g=t.tooltip,_=t.nodeState,w=t.edgeState;e.legend(!1),e.tooltip(g),e.axis(!1),e.coordinate().reflect("y");var k=YC(t,e.width,e.height),L=k.nodes,R=k.edges,U=e.createView({id:h_});U.data(R),_x({chart:U,options:{xField:BC,yField:NC,seriesField:zC,edge:{color:i,style:c,shape:"arc"},tooltip:g,state:w}});var G=e.createView({id:f_});return G.data(L),gg({chart:G,options:{xField:BC,yField:NC,seriesField:zC,polygon:{color:i,style:u},label:p,tooltip:g,state:_}}),e.interaction("element-active"),e.scale({x:{sync:!0,nice:!0,min:0,max:1,minLimit:0,maxLimit:1},y:{sync:!0,nice:!0,min:0,max:1,minLimit:0,maxLimit:1},name:{sync:"color",type:"cat"}}),r}function G4(r){var e=r.chart,t=r.options,i=t.animation,u=(0,P.pr)(e.views[0].geometries,e.views[1].geometries);return E0(e,i,u),r}function H4(r){var e=r.chart,t=r.options,i=t.nodeDraggable,u="sankey-node-draggable";return i?e.interaction(u):e.removeInteraction(u),r}function $C(r){var e=r.chart,t=r.options,i=t.interactions,u=i===void 0?[]:i,c=[].concat(u,t.nodeInteractions||[]),p=[].concat(u,t.edgeInteractions||[]),g=yo(e,f_),_=yo(e,h_);return c.forEach(function(w){(w==null?void 0:w.enable)===!1?g.removeInteraction(w.type):g.interaction(w.type,w.cfg||{})}),p.forEach(function(w){(w==null?void 0:w.enable)===!1?_.removeInteraction(w.type):_.interaction(w.type,w.cfg||{})}),r}function j4(r){return Ga(Z4,V4,$C,H4,G4,Bo)(r)}var W4=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isDragging=!1,t}return e.prototype.isNodeElement=function(){var t=(0,b.U2)(this.context,"event.target");if(t){var i=t.get("element");return i&&i.getModel().data.isNode}return!1},e.prototype.getNodeView=function(){return yo(this.context.view,f_)},e.prototype.getEdgeView=function(){return yo(this.context.view,h_)},e.prototype.getCurrentDatumIdx=function(t){return this.getNodeView().geometries[0].elements.indexOf(t)},e.prototype.start=function(){if(this.isNodeElement()){this.prevPoint={x:(0,b.U2)(this.context,"event.x"),y:(0,b.U2)(this.context,"event.y")};var t=this.context.event.target.get("element"),i=this.getCurrentDatumIdx(t);if(i===-1)return;this.currentElementIdx=i,this.context.isDragging=!0,this.isDragging=!0,this.prevNodeAnimateCfg=this.getNodeView().getOptions().animate,this.prevEdgeAnimateCfg=this.getEdgeView().getOptions().animate,this.getNodeView().animate(!1),this.getEdgeView().animate(!1)}},e.prototype.translate=function(){if(this.isDragging){var t=this.context.view,i={x:(0,b.U2)(this.context,"event.x"),y:(0,b.U2)(this.context,"event.y")},u=i.x-this.prevPoint.x,c=i.y-this.prevPoint.y,p=this.getNodeView(),g=p.geometries[0].elements[this.currentElementIdx];if(g&&g.getModel()){var _=g.getModel().data,w=p.getOptions().data,k=p.getCoordinate(),L={x:u/k.getWidth(),y:c/k.getHeight()},R=(0,P.pi)((0,P.pi)({},_),{x:_.x.map(function(vt){return vt+=L.x}),y:_.y.map(function(vt){return vt+=L.y})}),U=(0,P.pr)(w);U[this.currentElementIdx]=R,p.data(U);var G=_.name,Q=this.getEdgeView(),pt=Q.getOptions().data;pt.forEach(function(vt){vt.source===G&&(vt.x[0]+=L.x,vt.x[1]+=L.x,vt.y[0]+=L.y,vt.y[1]+=L.y),vt.target===G&&(vt.x[2]+=L.x,vt.x[3]+=L.x,vt.y[2]+=L.y,vt.y[3]+=L.y)}),Q.data(pt),this.prevPoint=i,t.render(!0)}}},e.prototype.end=function(){this.isDragging=!1,this.context.isDragging=!1,this.prevPoint=null,this.currentElementIdx=null,this.getNodeView().animate(this.prevNodeAnimateCfg),this.getEdgeView().animate(this.prevEdgeAnimateCfg)},e}(oi);Yn("sankey-node-drag",W4),kn("sankey-node-draggable",{showEnable:[{trigger:"polygon:mouseenter",action:"cursor:pointer"},{trigger:"polygon:mouseleave",action:"cursor:default"}],start:[{trigger:"polygon:mousedown",action:"sankey-node-drag:start"}],processing:[{trigger:"plot:mousemove",action:"sankey-node-drag:translate"},{isEnable:function(r){return r.isDragging},trigger:"plot:mousemove",action:"cursor:move"}],end:[{trigger:"plot:mouseup",action:"sankey-node-drag:end"}]});var CF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="sankey",t}return e.getDefaultOptions=function(){return{appendPadding:8,syncViewPadding:!0,nodeStyle:{opacity:1,fillOpacity:1,lineWidth:1},edgeStyle:{opacity:.3,lineWidth:0},edgeState:{active:{style:{opacity:.8,lineWidth:0}}},label:{formatter:function(t){var i=t.name;return i},callback:function(t){var i=t[1]===1;return{style:{fill:"#545454",textAlign:i?"end":"start"},offsetX:i?-8:8}},layout:[{type:"hide-overlap"}]},tooltip:{showTitle:!1,showMarkers:!1,shared:!1,showContent:function(t){return!(0,b.U2)(t,[0,"data","isNode"])},formatter:function(t){var i=t.source,u=t.target,c=t.value;return{name:i+" -> "+u,value:c}}},nodeWidthRatio:.008,nodePaddingRatio:.01,animation:{appear:{animation:"wave-in"},enter:{animation:"wave-in"}}}},e.prototype.changeData=function(t){this.updateOption({data:t});var i=YC(this.options,this.chart.width,this.chart.height),u=i.nodes,c=i.edges,p=yo(this.chart,f_),g=yo(this.chart,h_);p.changeData(u),g.changeData(c)},e.prototype.getSchemaAdaptor=function(){return j4},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ha),g_="ancestor-node",qC="value",Am="path",X4=[Am,ub,e_,lb,"name","depth","height"],Y4=hn({},Ha.getDefaultOptions(),{innerRadius:0,radius:.85,hierarchyConfig:{field:"value"},tooltip:{shared:!0,showMarkers:!1,offset:20,showTitle:!1},legend:!1,sunburstStyle:{lineWidth:.5,stroke:"#FFF"},drilldown:{enabled:!0}});function KC(r){r.x0=Math.round(r.x0),r.y0=Math.round(r.y0),r.x1=Math.round(r.x1),r.y1=Math.round(r.y1)}function Tm(r,e,t,i,u){for(var c=r.children,p,g=-1,_=c.length,w=r.value&&(i-e)/r.value;++g<_;)p=c[g],p.y0=t,p.y1=u,p.x0=e,p.x1=e+=p.value*w}function Mb(){var r=1,e=1,t=0,i=!1;function u(p){var g=p.height+1;return p.x0=p.y0=t,p.x1=r,p.y1=e/g,p.eachBefore(c(e,g)),i&&p.eachBefore(KC),p}function c(p,g){return function(_){_.children&&Tm(_,_.x0,p*(_.depth+1)/g,_.x1,p*(_.depth+2)/g);var w=_.x0,k=_.y0,L=_.x1-t,R=_.y1-t;L<w&&(w=L=(w+L)/2),R<k&&(k=R=(k+R)/2),_.x0=w,_.y0=k,_.x1=L,_.y1=R}}return u.round=function(p){return arguments.length?(i=!!p,u):i},u.size=function(p){return arguments.length?(r=+p[0],e=+p[1],u):[r,e]},u.padding=function(p){return arguments.length?(t=+p,u):t},u}var $4={field:"value",size:[1,1],round:!1,padding:0,sort:function(r,e){return e.value-r.value},as:["x","y"],ignoreParentValue:!0};function q4(r,e){e=(0,b.f0)({},$4,e);var t=e.as;if(!(0,b.kJ)(t)||t.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');var i;try{i=cb(e)}catch(_){console.warn(_)}var u=function(_){return Mb().size(e.size).round(e.round).padding(e.padding)(Tg(_).sum(function(w){return(0,b.dp)(w.children)?e.ignoreParentValue?0:w[i]-(0,b.u4)(w.children,function(k,L){return k+L[i]},0):w[i]}).sort(e.sort))},c=u(r),p=t[0],g=t[1];return c.each(function(_){var w,k;_[p]=[_.x0,_.x1,_.x1,_.x0],_[g]=[_.y1,_.y1,_.y0,_.y0],_.name=_.name||((w=_.data)===null||w===void 0?void 0:w.name)||((k=_.data)===null||k===void 0?void 0:k.label),_.data.name=_.name,["x0","x1","y0","y1"].forEach(function(L){t.indexOf(L)===-1&&delete _[L]})}),Mg(c)}function K4(r,e){return r.parent===e.parent?1:2}function Q4(r){return r.reduce(J4,0)/r.length}function J4(r,e){return r+e.x}function tL(r){return 1+r.reduce(eL,0)}function eL(r,e){return Math.max(r,e.y)}function rL(r){for(var e;e=r.children;)r=e[0];return r}function QC(r){for(var e;e=r.children;)r=e[e.length-1];return r}function JC(){var r=K4,e=1,t=1,i=!1;function u(c){var p,g=0;c.eachAfter(function(R){var U=R.children;U?(R.x=Q4(U),R.y=tL(U)):(R.x=p?g+=r(R,p):0,R.y=0,p=R)});var _=rL(c),w=QC(c),k=_.x-r(_,w)/2,L=w.x+r(w,_)/2;return c.eachAfter(i?function(R){R.x=(R.x-c.x)*e,R.y=(c.y-R.y)*t}:function(R){R.x=(R.x-k)/(L-k)*e,R.y=(1-(c.y?R.y/c.y:1))*t})}return u.separation=function(c){return arguments.length?(r=c,u):r},u.size=function(c){return arguments.length?(i=!1,e=+c[0],t=+c[1],u):i?null:[e,t]},u.nodeSize=function(c){return arguments.length?(i=!0,e=+c[0],t=+c[1],u):i?[e,t]:null},u}var tA={depth:-1},z0={};function eA(r){return r.id}function nL(r){return r.parentId}function iL(){var r=eA,e=nL;function t(i){var u=Array.from(i),c=u.length,p,g,_,w,k,L,R,U=new Map;for(g=0;g<c;++g)p=u[g],k=u[g]=new F0(p),(L=r(p,g,i))!=null&&(L+="")&&(R=k.id=L,U.set(R,U.has(R)?z0:k)),(L=e(p,g,i))!=null&&(L+="")&&(k.parent=L);for(g=0;g<c;++g)if(k=u[g],L=k.parent){if(w=U.get(L),!w)throw new Error("missing: "+L);if(w===z0)throw new Error("ambiguous: "+L);w.children?w.children.push(k):w.children=[k],k.parent=w}else{if(_)throw new Error("multiple roots");_=k}if(!_)throw new Error("no root");if(_.parent=tA,_.eachBefore(function(G){G.depth=G.parent.depth+1,--c}).eachBefore(uC),_.parent=null,c>0)throw new Error("cycle");return _}return t.id=function(i){return arguments.length?(r=xm(i),t):r},t.parentId=function(i){return arguments.length?(e=xm(i),t):e},t}function aL(r,e){return r.parent===e.parent?1:2}function Ib(r){var e=r.children;return e?e[0]:r.t}function U0(r){var e=r.children;return e?e[e.length-1]:r.t}function Mm(r,e,t){var i=t/(e.i-r.i);e.c-=i,e.s+=t,r.c+=i,e.z+=t,e.m+=t}function Im(r){for(var e=0,t=0,i=r.children,u=i.length,c;--u>=0;)c=i[u],c.z+=e,c.m+=e,e+=c.s+(t+=c.c)}function km(r,e,t){return r.a.parent===e.parent?r.a:t}function m_(r,e){this._=r,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}m_.prototype=Object.create(F0.prototype);function rA(r){for(var e=new m_(r,0),t,i=[e],u,c,p,g;t=i.pop();)if(c=t._.children)for(t.children=new Array(g=c.length),p=g-1;p>=0;--p)i.push(u=t.children[p]=new m_(c[p],p)),u.parent=t;return(e.parent=new m_(null,0)).children=[e],e}function kb(){var r=aL,e=1,t=1,i=null;function u(w){var k=rA(w);if(k.eachAfter(c),k.parent.m=-k.z,k.eachBefore(p),i)w.eachBefore(_);else{var L=w,R=w,U=w;w.eachBefore(function(Vt){Vt.x<L.x&&(L=Vt),Vt.x>R.x&&(R=Vt),Vt.depth>U.depth&&(U=Vt)});var G=L===R?1:r(L,R)/2,Q=G-L.x,pt=e/(R.x+G+Q),vt=t/(U.depth||1);w.eachBefore(function(Vt){Vt.x=(Vt.x+Q)*pt,Vt.y=Vt.depth*vt})}return w}function c(w){var k=w.children,L=w.parent.children,R=w.i?L[w.i-1]:null;if(k){Im(w);var U=(k[0].z+k[k.length-1].z)/2;R?(w.z=R.z+r(w._,R._),w.m=w.z-U):w.z=U}else R&&(w.z=R.z+r(w._,R._));w.parent.A=g(w,R,w.parent.A||L[0])}function p(w){w._.x=w.z+w.parent.m,w.m+=w.parent.m}function g(w,k,L){if(k){for(var R=w,U=w,G=k,Q=R.parent.children[0],pt=R.m,vt=U.m,Vt=G.m,le=Q.m,he;G=U0(G),R=Ib(R),G&&R;)Q=Ib(Q),U=U0(U),U.a=w,he=G.z+Vt-R.z-pt+r(G._,R._),he>0&&(Mm(km(G,w,L),w,he),pt+=he,vt+=he),Vt+=G.m,pt+=R.m,le+=Q.m,vt+=U.m;G&&!U0(U)&&(U.t=G,U.m+=Vt-vt),R&&!Ib(Q)&&(Q.t=R,Q.m+=pt-le,L=w)}return L}function _(w){w.x*=e,w.y=w.depth*t}return u.separation=function(w){return arguments.length?(r=w,u):r},u.size=function(w){return arguments.length?(i=!1,e=+w[0],t=+w[1],u):i?null:[e,t]},u.nodeSize=function(w){return arguments.length?(i=!0,e=+w[0],t=+w[1],u):i?[e,t]:null},u}function y_(r,e,t,i,u){for(var c=r.children,p,g=-1,_=c.length,w=r.value&&(u-t)/r.value;++g<_;)p=c[g],p.x0=e,p.x1=i,p.y0=t,p.y1=t+=p.value*w}var nA=(1+Math.sqrt(5))/2;function Lb(r,e,t,i,u,c){for(var p=[],g=e.children,_,w,k=0,L=0,R=g.length,U,G,Q=e.value,pt,vt,Vt,le,he,Ne,Er;k<R;){U=u-t,G=c-i;do pt=g[L++].value;while(!pt&&L<R);for(vt=Vt=pt,Ne=Math.max(G/U,U/G)/(Q*r),Er=pt*pt*Ne,he=Math.max(Vt/Er,Er/vt);L<R;++L){if(pt+=w=g[L].value,w<vt&&(vt=w),w>Vt&&(Vt=w),Er=pt*pt*Ne,le=Math.max(Vt/Er,Er/vt),le>he){pt-=w;break}he=le}p.push(_={value:pt,dice:U<G,children:g.slice(k,L)}),_.dice?Tm(_,t,i,u,Q?i+=G*pt/Q:c):y_(_,t,i,Q?t+=U*pt/Q:u,c),Q-=pt,k=L}return p}var iA=function r(e){function t(i,u,c,p,g){Lb(e,i,u,c,p,g)}return t.ratio=function(i){return r((i=+i)>1?i:1)},t}(nA);function oL(){var r=iA,e=!1,t=1,i=1,u=[0],c=P0,p=P0,g=P0,_=P0,w=P0;function k(R){return R.x0=R.y0=0,R.x1=t,R.y1=i,R.eachBefore(L),u=[0],e&&R.eachBefore(KC),R}function L(R){var U=u[R.depth],G=R.x0+U,Q=R.y0+U,pt=R.x1-U,vt=R.y1-U;pt<G&&(G=pt=(G+pt)/2),vt<Q&&(Q=vt=(Q+vt)/2),R.x0=G,R.y0=Q,R.x1=pt,R.y1=vt,R.children&&(U=u[R.depth+1]=c(R)/2,G+=w(R)-U,Q+=p(R)-U,pt-=g(R)-U,vt-=_(R)-U,pt<G&&(G=pt=(G+pt)/2),vt<Q&&(Q=vt=(Q+vt)/2),r(R,G,Q,pt,vt))}return k.round=function(R){return arguments.length?(e=!!R,k):e},k.size=function(R){return arguments.length?(t=+R[0],i=+R[1],k):[t,i]},k.tile=function(R){return arguments.length?(r=xm(R),k):r},k.padding=function(R){return arguments.length?k.paddingInner(R).paddingOuter(R):k.paddingInner()},k.paddingInner=function(R){return arguments.length?(c=typeof R=="function"?R:ev(+R),k):c},k.paddingOuter=function(R){return arguments.length?k.paddingTop(R).paddingRight(R).paddingBottom(R).paddingLeft(R):k.paddingTop()},k.paddingTop=function(R){return arguments.length?(p=typeof R=="function"?R:ev(+R),k):p},k.paddingRight=function(R){return arguments.length?(g=typeof R=="function"?R:ev(+R),k):g},k.paddingBottom=function(R){return arguments.length?(_=typeof R=="function"?R:ev(+R),k):_},k.paddingLeft=function(R){return arguments.length?(w=typeof R=="function"?R:ev(+R),k):w},k}function __(r,e,t,i,u){var c=r.children,p,g=c.length,_,w=new Array(g+1);for(w[0]=_=p=0;p<g;++p)w[p+1]=_+=c[p].value;k(0,g,r.value,e,t,i,u);function k(L,R,U,G,Q,pt,vt){if(L>=R-1){var Vt=c[L];Vt.x0=G,Vt.y0=Q,Vt.x1=pt,Vt.y1=vt;return}for(var le=w[L],he=U/2+le,Ne=L+1,Er=R-1;Ne<Er;){var Fr=Ne+Er>>>1;w[Fr]<he?Ne=Fr+1:Er=Fr}he-w[Ne-1]<w[Ne]-he&&L+1<Ne&&--Ne;var zr=w[Ne]-le,pn=U-zr;if(pt-G>vt-Q){var nn=U?(G*pn+pt*zr)/U:pt;k(L,Ne,zr,G,Q,nn,vt),k(Ne,R,pn,nn,Q,pt,vt)}else{var Pn=U?(Q*pn+vt*zr)/U:vt;k(L,Ne,zr,G,Q,pt,Pn),k(Ne,R,pn,G,Pn,pt,vt)}}}function Lm(r,e,t,i,u){(r.depth&1?y_:Tm)(r,e,t,i,u)}var aA=function r(e){function t(i,u,c,p,g){if((_=i._squarify)&&_.ratio===e)for(var _,w,k,L,R=-1,U,G=_.length,Q=i.value;++R<G;){for(w=_[R],k=w.children,L=w.value=0,U=k.length;L<U;++L)w.value+=k[L].value;w.dice?Tm(w,u,c,p,Q?c+=(g-c)*w.value/Q:g):y_(w,u,c,Q?u+=(p-u)*w.value/Q:p,g),Q-=w.value}else i._squarify=_=Lb(e,i,u,c,p,g),_.ratio=e}return t.ratio=function(i){return r((i=+i)>1?i:1)},t}(nA),sL={field:"value",tile:"treemapSquarify",size:[1,1],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,as:["x","y"],sort:function(r,e){return e.value-r.value},ratio:.5*(1+Math.sqrt(5))};function uL(r,e){return r==="treemapSquarify"?Ut[r].ratio(e):Ut[r]}function Pb(r,e){e=(0,b.f0)({},sL,e);var t=e.as;if(!(0,b.kJ)(t)||t.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');var i;try{i=cb(e)}catch(w){console.warn(w)}var u=uL(e.tile,e.ratio),c=function(w){return oL().tile(u).size(e.size).round(e.round).padding(e.padding).paddingInner(e.paddingInner).paddingOuter(e.paddingOuter).paddingTop(e.paddingTop).paddingRight(e.paddingRight).paddingBottom(e.paddingBottom).paddingLeft(e.paddingLeft)(Tg(w).sum(function(k){return e.ignoreParentValue&&k.children?0:k[i]}).sort(e.sort))},p=c(r),g=t[0],_=t[1];return p.each(function(w){w[g]=[w.x0,w.x1,w.x1,w.x0],w[_]=[w.y1,w.y1,w.y0,w.y0],["x0","x1","y0","y1"].forEach(function(k){t.indexOf(k)===-1&&delete w[k]})}),Mg(p)}function lL(r){var e=r.data,t=r.colorField,i=r.rawFields,u=r.hierarchyConfig,c=u===void 0?{}:u,p=c.activeDepth,g={partition:q4,treemap:Pb},_=r.seriesField,w=r.type||"partition",k=g[w](e,(0,P.pi)((0,P.pi)({field:_||"value"},(0,b.CE)(c,["activeDepth"])),{type:"hierarchy."+w,as:["x","y"]})),L=[];return k.forEach(function(R){var U,G,Q,pt,vt,Vt;if(R.depth===0||p>0&&R.depth>p)return null;for(var le=R.data.name,he=(0,P.pi)({},R);he.depth>1;)le=((G=he.parent.data)===null||G===void 0?void 0:G.name)+" / "+le,he=he.parent;var Ne=(0,P.pi)((0,P.pi)((0,P.pi)({},fs(R.data,(0,P.pr)(i||[],[c.field]))),(U={},U[Am]=le,U[g_]=he.data.name,U)),R);_&&(Ne[_]=R.data[_]||((pt=(Q=R.parent)===null||Q===void 0?void 0:Q.data)===null||pt===void 0?void 0:pt[_])),t&&(Ne[t]=R.data[t]||((Vt=(vt=R.parent)===null||vt===void 0?void 0:vt.data)===null||Vt===void 0?void 0:Vt[t])),Ne.ext=c,Ne[Yy]={hierarchyConfig:c,colorField:t,rawFields:i},L.push(Ne)}),L}function cL(r){var e=r.chart,t=r.options,i=t.color,u=t.colorField,c=u===void 0?g_:u,p=t.sunburstStyle,g=t.rawFields,_=g===void 0?[]:g,w=lL(t);e.data(w);var k;return p&&(k=function(L){return hn({},{fillOpacity:Math.pow(.85,L.depth)},(0,b.mf)(p)?p(L):p)}),gg(hn({},r,{options:{xField:"x",yField:"y",seriesField:c,rawFields:(0,b.jj)((0,P.pr)(X4,_)),polygon:{color:i,style:k}}})),r}function x_(r){var e=r.chart;return e.axis(!1),r}function oA(r){var e=r.chart,t=r.options,i=t.label,u=Ec(e,"polygon");if(!i)u.label(!1);else{var c=i.fields,p=c===void 0?["name"]:c,g=i.callback,_=(0,P._T)(i,["fields","callback"]);u.label({fields:p,callback:g,cfg:Os(_)})}return r}function fL(r){var e=r.chart,t=r.options,i=t.innerRadius,u=t.radius,c=t.reflect,p=e.coordinate({type:"polar",cfg:{innerRadius:i,radius:u}});return c&&p.reflect(c),r}function hL(r){var e,t=r.options,i=t.hierarchyConfig,u=t.meta;return Ga(Zs({},(e={},e[qC]=(0,b.U2)(u,(0,b.U2)(i,["field"],"value")),e)))(r)}function sA(r){var e=r.chart,t=r.options,i=t.tooltip;if(i===!1)e.tooltip(!1);else{var u=i;(0,b.U2)(i,"fields")||(u=hn({},{customItems:function(c){return c.map(function(p){var g=(0,b.U2)(e.getOptions(),"scales"),_=(0,b.U2)(g,[Am,"formatter"],function(k){return k}),w=(0,b.U2)(g,[qC,"formatter"],function(k){return k});return(0,P.pi)((0,P.pi)({},p),{name:_(p.data[Am]),value:w(p.data.value)})})}},u)),e.tooltip(u)}return r}function AF(r){var e=r.drilldown,t=r.interactions,i=t===void 0?[]:t;return e!=null&&e.enabled?hn({},r,{interactions:(0,P.pr)(i,[{type:"drill-down",cfg:{drillDownConfig:e,transformData:lL}}])}):r}function uA(r){var e=r.chart,t=r.options,i=t.drilldown;return Xs({chart:e,options:AF(t)}),i!=null&&i.enabled&&(e.appendPadding=My(e.appendPadding,(0,b.U2)(i,["breadCrumb","position"]))),r}function ch(r){return Ga(Bo,Nh("sunburstStyle"),cL,x_,hL,vg,fL,sA,oA,uA,ms,Ys())(r)}var pL=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="sunburst",t}return e.getDefaultOptions=function(){return Y4},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return ch},e.SUNBURST_ANCESTOR_FIELD=g_,e.SUNBURST_PATH_FIELD=Am,e.NODE_ANCESTORS_FIELD=e_,e}(Ha);function Ob(r,e){if(!!(0,b.kJ)(r))return r.find(function(t){return t.type===e})}function lA(r,e){var t=Ob(r,e);return t&&t.enable!==!1}function Fb(r){var e=r.interactions,t=r.drilldown;return(0,b.U2)(t,"enabled")||lA(e,"treemap-drill-down")}function dL(r){var e=r.interactions["drill-down"];if(!!e){var t=e.context.actions.find(function(i){return i.name==="drill-down-action"});t.reset()}}function b_(r){var e=r.data,t=r.colorField,i=r.enableDrillDown,u=r.hierarchyConfig,c=Pb(e,(0,P.pi)((0,P.pi)({},u),{type:"hierarchy.treemap",field:"value",as:["x","y"]})),p=[];return c.forEach(function(g){if(g.depth===0||i&&g.depth!==1||!i&&g.children)return null;var _=g.ancestors().map(function(R){return{data:R.data,height:R.height,value:R.value}}),w=i&&(0,b.kJ)(e.path)?_.concat(e.path.slice(1)):_,k=Object.assign({},g.data,(0,P.pi)({x:g.x,y:g.y,depth:g.depth,value:g.value,path:w},g));if(!g.data[t]&&g.parent){var L=g.ancestors().find(function(R){return R.data[t]});k[t]=L==null?void 0:L.data[t]}else k[t]=g.data[t];k[Yy]={hierarchyConfig:u,colorField:t,enableDrillDown:i},p.push(k)}),p}function cA(r){var e=r.options,t=e.colorField;return hn({options:{rawFields:["value"],tooltip:{fields:["name","value",t,"path"],formatter:function(i){return{name:i.name,value:i.value}}}}},r)}function vL(r){var e=r.chart,t=r.options,i=t.color,u=t.colorField,c=t.rectStyle,p=t.hierarchyConfig,g=t.rawFields,_=b_({data:t.data,colorField:t.colorField,enableDrillDown:Fb(t),hierarchyConfig:p});return e.data(_),gg(hn({},r,{options:{xField:"x",yField:"y",seriesField:u,rawFields:g,polygon:{color:i,style:c}}})),e.coordinate().reflect("y"),r}function gL(r){var e=r.chart;return e.axis(!1),r}function mL(r){var e=r.drilldown,t=r.interactions,i=t===void 0?[]:t,u=Fb(r);return u?hn({},r,{interactions:(0,P.pr)(i,[{type:"drill-down",cfg:{drillDownConfig:e,transformData:b_}}])}):r}function yL(r){var e=r.chart,t=r.options,i=t.interactions,u=t.drilldown;Xs({chart:e,options:mL(t)});var c=Ob(i,"view-zoom");c&&(c.enable!==!1?e.getCanvas().on("mousewheel",function(g){g.preventDefault()}):e.getCanvas().off("mousewheel"));var p=Fb(t);return p&&(e.appendPadding=My(e.appendPadding,(0,b.U2)(u,["breadCrumb","position"]))),r}function _L(r){return Ga(cA,Bo,Nh("rectStyle"),vL,gL,vg,hl,yL,ms,Ys())(r)}var xL={colorField:"name",rectStyle:{lineWidth:1,stroke:"#fff"},hierarchyConfig:{tile:"treemapSquarify"},label:{fields:["name"],layout:{type:"limit-in-shape"}},tooltip:{showMarkers:!1,showTitle:!1},drilldown:{enabled:!1,breadCrumb:{position:"bottom-left",rootText:"\u521D\u59CB",dividerText:"/",textStyle:{fontSize:12,fill:"rgba(0, 0, 0, 0.65)",cursor:"pointer"},activeTextStyle:{fill:"#87B5FF"}}}},E_=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="treemap",t}return e.getDefaultOptions=function(){return xL},e.prototype.changeData=function(t){var i=this.options,u=i.colorField,c=i.interactions,p=i.hierarchyConfig;this.updateOption({data:t});var g=b_({data:t,colorField:u,enableDrillDown:lA(c,"treemap-drill-down"),hierarchyConfig:p});this.chart.changeData(g),dL(this.chart)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return _L},e}(Ha),fh="id",Rb="path",bL={appendPadding:[10,0,20,0],blendMode:"multiply",tooltip:{showTitle:!1,showMarkers:!1,fields:["id","size"],formatter:function(r){return{name:r.id,value:r.size}}},legend:{position:"top-left"},label:{style:{textAlign:"center",fill:"#fff"}},interactions:[{type:"legend-filter",enable:!1}],state:{active:{style:{stroke:"#000"}},selected:{style:{stroke:"#000",lineWidth:2}},inactive:{style:{fillOpacity:.3,strokeOpacity:.3}}},defaultInteractions:["tooltip","venn-legend-active"]};function S_(r){if(!!r){var e=r.geometries[0].elements;e.forEach(function(t){t.shape.toFront()})}}var Z0=Ua("element-active"),EL=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){S_(this.context.view)},e.prototype.active=function(){r.prototype.active.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(Z0),SL=Ua("element-highlight"),w_=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){S_(this.context.view)},e.prototype.highlight=function(){r.prototype.highlight.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.clear=function(){r.prototype.clear.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(SL),wL=Ua("element-selected"),CL=Ua("element-single-selected"),AL=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){S_(this.context.view)},e.prototype.selected=function(){r.prototype.selected.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(wL),TL=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){S_(this.context.view)},e.prototype.selected=function(){r.prototype.selected.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(CL);Yn("venn-element-active",EL),Yn("venn-element-highlight",w_),Yn("venn-element-selected",AL),Yn("venn-element-single-selected",TL),kn("venn-element-active",{start:[{trigger:"element:mouseenter",action:"venn-element-active:active"}],end:[{trigger:"element:mouseleave",action:"venn-element-active:reset"}]}),kn("venn-element-highlight",{start:[{trigger:"element:mouseenter",action:"venn-element-highlight:highlight"}],end:[{trigger:"element:mouseleave",action:"venn-element-highlight:reset"}]}),kn("venn-element-selected",{start:[{trigger:"element:click",action:"venn-element-selected:toggle"}],rollback:[{trigger:"dblclick",action:["venn-element-selected:reset"]}]}),kn("venn-element-single-selected",{start:[{trigger:"element:click",action:"venn-element-single-selected:toggle"}],rollback:[{trigger:"dblclick",action:["venn-element-single-selected:reset"]}]}),kn("venn-legend-active",{start:[{trigger:"legend-item:mouseenter",action:["list-active:active","venn-element-active:active"]}],end:[{trigger:"legend-item:mouseleave",action:["list-active:reset","venn-element-active:reset"]}]}),kn("venn-legend-highlight",{start:[{trigger:"legend-item:mouseenter",action:["legend-item-highlight:highlight","venn-element-highlight:highlight"]}],end:[{trigger:"legend-item:mouseleave",action:["legend-item-highlight:reset","venn-element-highlight:reset"]}]});var ML=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getLabelPoint=function(t,i,u){var c=t.data,p=c.x,g=c.y,_=t.customLabelInfo,w=_.offsetX,k=_.offsetY;return{content:t.content[u],x:p+w,y:g+k}},e}(zd);lu("venn",ML);function IL(r){return hn({},r.defaultStyle,{fill:r.color},r.style)}va("schema","venn",{draw:function(r,e){var t=r.data,i=(0,rf.tr)(t[Rb]),u=IL(r),c=e.addGroup({name:"venn-shape"});c.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},u),{path:i}),name:"venn-path"});var p=r.customInfo,g=p.offsetX,_=p.offsetY,w=_c.transform(null,[["t",g,_]]);return c.setMatrix(w),c},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{lineWidth:0,stroke:e,fill:e,r:4}}}});var kL=function(r){return function(e,t){var i=[];return i[0]=r(e[0],t[0]),i[1]=r(e[1],t[1]),i[2]=r(e[2],t[2]),i}},fA={normal:function(r){return r},multiply:function(r,e){return r*e/255},screen:function(r,e){return 255*(1-(1-r/255)*(1-e/255))},overlay:function(r,e){return e<128?2*r*e/255:255*(1-2*(1-r/255)*(1-e/255))},darken:function(r,e){return r>e?e:r},lighten:function(r,e){return r>e?r:e},dodge:function(r,e){return r===255?255:(r=255*(e/255)/(1-r/255),r>255?255:r)},burn:function(r,e){return e===255?255:r===0?0:255*(1-Math.min(1,(1-e/255)/(r/255)))}},LL=function(r){if(!fA[r])throw new Error("unknown blend mode "+r);return fA[r]};function PL(r,e,t){t===void 0&&(t="normal");var i=kL(LL(t))(C_(r),C_(e)),u=C_(r),c=u[0],p=u[1],g=u[2],_=u[3],w=C_(e),k=w[0],L=w[1],R=w[2],U=w[3],G=Number((_+U*(1-_)).toFixed(2)),Q=Math.round((_*(1-U)*(c/255)+_*U*(i[0]/255)+(1-_)*U*(k/255))/G*255),pt=Math.round((_*(1-U)*(p/255)+_*U*(i[1]/255)+(1-_)*U*(L/255))/G*255),vt=Math.round((_*(1-U)*(g/255)+_*U*(i[2]/255)+(1-_)*U*(R/255))/G*255);return"rgba("+Q+", "+pt+", "+vt+", "+G+")"}function C_(r){var e=r.replace("/s+/g",""),t;return typeof e=="string"&&!e.startsWith("rgba")&&!e.startsWith("#")?t=Ya.rgb2arr(Ya.toRGB(e)).concat([1]):(e.startsWith("rgba")&&(t=e.replace("rgba(","").replace(")","").split(",")),e.startsWith("#")&&(t=Ya.rgb2arr(e).concat([1])),t.map(function(i,u){return u===3?Number(i):i|0}))}var ld=ot(87026),hA=1e-10;function Db(r,e){var t=FL(r),i=t.filter(function(Fr){return OL(Fr,r)}),u=0,c=0,p,g=[];if(i.length>1){var _=Nb(i);for(p=0;p<i.length;++p){var w=i[p];w.angle=Math.atan2(w.x-_.x,w.y-_.y)}i.sort(function(Fr,zr){return zr.angle-Fr.angle});var k=i[i.length-1];for(p=0;p<i.length;++p){var L=i[p];c+=(k.x+L.x)*(L.y-k.y);for(var R={x:(L.x+k.x)/2,y:(L.y+k.y)/2},U=null,G=0;G<L.parentIndex.length;++G)if(k.parentIndex.indexOf(L.parentIndex[G])>-1){var Q=r[L.parentIndex[G]],pt=Math.atan2(L.x-Q.x,L.y-Q.y),vt=Math.atan2(k.x-Q.x,k.y-Q.y),Vt=vt-pt;Vt<0&&(Vt+=2*Math.PI);var le=vt-Vt/2,he=Mp(R,{x:Q.x+Q.radius*Math.sin(le),y:Q.y+Q.radius*Math.cos(le)});he>Q.radius*2&&(he=Q.radius*2),(U===null||U.width>he)&&(U={circle:Q,width:he,p1:L,p2:k})}U!==null&&(g.push(U),u+=Bb(U.circle.radius,U.width),k=L)}}else{var Ne=r[0];for(p=1;p<r.length;++p)r[p].radius<Ne.radius&&(Ne=r[p]);var Er=!1;for(p=0;p<r.length;++p)if(Mp(r[p],Ne)>Math.abs(Ne.radius-r[p].radius)){Er=!0;break}Er?u=c=0:(u=Ne.radius*Ne.radius*Math.PI,g.push({circle:Ne,p1:{x:Ne.x,y:Ne.y+Ne.radius},p2:{x:Ne.x-hA,y:Ne.y+Ne.radius},width:Ne.radius*2}))}return c/=2,e&&(e.area=u+c,e.arcArea=u,e.polygonArea=c,e.arcs=g,e.innerPoints=i,e.intersectionPoints=t),u+c}function OL(r,e){for(var t=0;t<e.length;++t)if(Mp(r,e[t])>e[t].radius+hA)return!1;return!0}function FL(r){for(var e=[],t=0;t<r.length;++t)for(var i=t+1;i<r.length;++i)for(var u=dA(r[t],r[i]),c=0;c<u.length;++c){var p=u[c];p.parentIndex=[t,i],e.push(p)}return e}function Bb(r,e){return r*r*Math.acos(1-e/r)-(r-e)*Math.sqrt(e*(2*r-e))}function Mp(r,e){return Math.sqrt((r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y))}function pA(r,e,t){if(t>=r+e)return 0;if(t<=Math.abs(r-e))return Math.PI*Math.min(r,e)*Math.min(r,e);var i=r-(t*t-e*e+r*r)/(2*t),u=e-(t*t-r*r+e*e)/(2*t);return Bb(r,i)+Bb(e,u)}function dA(r,e){var t=Mp(r,e),i=r.radius,u=e.radius;if(t>=i+u||t<=Math.abs(i-u))return[];var c=(i*i-u*u+t*t)/(2*t),p=Math.sqrt(i*i-c*c),g=r.x+c*(e.x-r.x)/t,_=r.y+c*(e.y-r.y)/t,w=-(e.y-r.y)*(p/t),k=-(e.x-r.x)*(p/t);return[{x:g+w,y:_-k},{x:g-w,y:_+k}]}function Nb(r){for(var e={x:0,y:0},t=0;t<r.length;++t)e.x+=r[t].x,e.y+=r[t].y;return e.x/=r.length,e.y/=r.length,e}function zb(r,e,t){var i=e[0].radius-Mp(e[0],r),u,c;for(u=1;u<e.length;++u)c=e[u].radius-Mp(e[u],r),c<=i&&(i=c);for(u=0;u<t.length;++u)c=Mp(t[u],r)-t[u].radius,c<=i&&(i=c);return i}function vA(r,e){var t=[],i;for(i=0;i<r.length;++i){var u=r[i];t.push({x:u.x,y:u.y}),t.push({x:u.x+u.radius/2,y:u.y}),t.push({x:u.x-u.radius/2,y:u.y}),t.push({x:u.x,y:u.y+u.radius/2}),t.push({x:u.x,y:u.y-u.radius/2})}var c=t[0],p=zb(t[0],r,e);for(i=1;i<t.length;++i){var g=zb(t[i],r,e);g>=p&&(c=t[i],p=g)}var _=(0,ld.nelderMead)(function(R){return-1*zb({x:R[0],y:R[1]},r,e)},[c.x,c.y],{maxIterations:500,minErrorDelta:1e-10}).x,w={x:_[0],y:_[1]},k=!0;for(i=0;i<r.length;++i)if(Mp(w,r[i])>r[i].radius){k=!1;break}for(i=0;i<e.length;++i)if(Mp(w,e[i])<e[i].radius){k=!1;break}if(!k)if(r.length==1)w={x:r[0].x,y:r[0].y};else{var L={};Db(r,L),L.arcs.length===0?w={x:0,y:-1e3,disjoint:!0}:L.arcs.length==1?w={x:L.arcs[0].circle.x,y:L.arcs[0].circle.y}:e.length?w=vA(r,[]):w=Nb(L.arcs.map(function(R){return R.p1}))}return w}function RL(r){var e={},t=[];for(var i in r)t.push(i),e[i]=[];for(var u=0;u<t.length;u++)for(var c=r[t[u]],p=u+1;p<t.length;++p){var g=r[t[p]],_=Mp(c,g);_+g.radius<=c.radius+1e-10?e[t[p]].push(t[u]):_+c.radius<=g.radius+1e-10&&e[t[u]].push(t[p])}return e}function DL(r,e){for(var t={},i=RL(r),u=0;u<e.length;++u){for(var c=e[u].sets,p={},g={},_=0;_<c.length;++_){p[c[_]]=!0;for(var w=i[c[_]],k=0;k<w.length;++k)g[w[k]]=!0}var L=[],R=[];for(var U in r)U in p?L.push(r[U]):U in g||R.push(r[U]);var G=vA(L,R);t[c]=G,G.disjoint&&e[u].size>0&&console.log("WARNING: area "+c+" not represented on screen")}return t}function BL(r,e,t){var i=[],u=r-t,c=e;return i.push("M",u,c),i.push("A",t,t,0,1,0,u+2*t,c),i.push("A",t,t,0,1,0,u,c),i.join(" ")}function TF(r){var e=r.split(" ");return{x:parseFloat(e[1]),y:parseFloat(e[2]),radius:-parseFloat(e[4])}}function NL(r){var e={};Db(r,e);var t=e.arcs;if(t.length===0)return"M 0 0";if(t.length==1){var i=t[0].circle;return BL(i.x,i.y,i.radius)}else{for(var u=[`
M`,t[0].p2.x,t[0].p2.y],c=0;c<t.length;++c){var p=t[c],g=p.circle.radius,_=p.width>g;u.push(`
A`,g,g,0,_?1:0,1,p.p1.x,p.p1.y)}return u.join(" ")}}function zL(r,e){e=e||{},e.maxIterations=e.maxIterations||500;var t=e.initialLayout||GL,i=e.lossFunction||Pm;r=UL(r);var u=t(r,e),c=[],p=[],g;for(g in u)u.hasOwnProperty(g)&&(c.push(u[g].x),c.push(u[g].y),p.push(g));for(var _=(0,ld.nelderMead)(function(L){for(var R={},U=0;U<p.length;++U){var G=p[U];R[G]={x:L[2*U],y:L[2*U+1],radius:u[G].radius}}return i(R,r)},c,e),w=_.x,k=0;k<p.length;++k)g=p[k],u[g].x=w[2*k],u[g].y=w[2*k+1];return u}var gA=1e-10;function Ub(r,e,t){return Math.min(r,e)*Math.min(r,e)*Math.PI<=t+gA?Math.abs(r-e):(0,ld.bisect)(function(i){return pA(r,e,i)-t},0,r+e)}function UL(r){r=r.slice();var e=[],t={},i,u,c,p;for(i=0;i<r.length;++i){var g=r[i];g.sets.length==1?e.push(g.sets[0]):g.sets.length==2&&(c=g.sets[0],p=g.sets[1],t[[c,p]]=!0,t[[p,c]]=!0)}for(e.sort(function(_,w){return _>w?1:-1}),i=0;i<e.length;++i)for(c=e[i],u=i+1;u<e.length;++u)p=e[u],[c,p]in t||r.push({sets:[c,p],size:0});return r}function ZL(r,e,t){var i=(0,ld.zerosM)(e.length,e.length),u=(0,ld.zerosM)(e.length,e.length);return r.filter(function(c){return c.sets.length==2}).map(function(c){var p=t[c.sets[0]],g=t[c.sets[1]],_=Math.sqrt(e[p].size/Math.PI),w=Math.sqrt(e[g].size/Math.PI),k=Ub(_,w,c.size);i[p][g]=i[g][p]=k;var L=0;c.size+1e-10>=Math.min(e[p].size,e[g].size)?L=1:c.size<=1e-10&&(L=-1),u[p][g]=u[g][p]=L}),{distances:i,constraints:u}}function VL(r,e,t,i){var u=0,c;for(c=0;c<e.length;++c)e[c]=0;for(c=0;c<t.length;++c)for(var p=r[2*c],g=r[2*c+1],_=c+1;_<t.length;++_){var w=r[2*_],k=r[2*_+1],L=t[c][_],R=i[c][_],U=(w-p)*(w-p)+(k-g)*(k-g),G=Math.sqrt(U),Q=U-L*L;R>0&&G<=L||R<0&&G>=L||(u+=2*Q*Q,e[2*c]+=4*Q*(p-w),e[2*c+1]+=4*Q*(g-k),e[2*_]+=4*Q*(w-p),e[2*_+1]+=4*Q*(k-g))}return u}function GL(r,e){var t=jL(r,e),i=e.lossFunction||Pm;if(r.length>=8){var u=HL(r,e),c=i(u,r),p=i(t,r);c+1e-8<p&&(t=u)}return t}function HL(r,e){e=e||{};var t=e.restarts||10,i=[],u={},c;for(c=0;c<r.length;++c){var p=r[c];p.sets.length==1&&(u[p.sets[0]]=i.length,i.push(p))}var g=ZL(r,i,u),_=g.distances,w=g.constraints,k=(0,ld.norm2)(_.map(ld.norm2))/_.length;_=_.map(function(Vt){return Vt.map(function(le){return le/k})});var L=function(Vt,le){return VL(Vt,le,_,w)},R,U;for(c=0;c<t;++c){var G=(0,ld.zeros)(_.length*2).map(Math.random);U=(0,ld.conjugateGradient)(L,G,e),(!R||U.fx<R.fx)&&(R=U)}var Q=R.x,pt={};for(c=0;c<i.length;++c){var vt=i[c];pt[vt.sets[0]]={x:Q[2*c]*k,y:Q[2*c+1]*k,radius:Math.sqrt(vt.size/Math.PI)}}if(e.history)for(c=0;c<e.history.length;++c)(0,ld.scale)(e.history[c].x,k);return pt}function jL(r,e){for(var t=e&&e.lossFunction?e.lossFunction:Pm,i={},u={},c,p=0;p<r.length;++p){var g=r[p];g.sets.length==1&&(c=g.sets[0],i[c]={x:1e10,y:1e10,rowid:Object.keys(i).length,size:g.size,radius:Math.sqrt(g.size/Math.PI)},u[c]=[])}r=r.filter(function(Vn){return Vn.sets.length==2});for(var p=0;p<r.length;++p){var _=r[p],w=_.hasOwnProperty("weight")?_.weight:1,k=_.sets[0],L=_.sets[1];_.size+gA>=Math.min(i[k].size,i[L].size)&&(w=0),u[k].push({set:L,size:_.size,weight:w}),u[L].push({set:k,size:_.size,weight:w})}var R=[];for(c in u)if(u.hasOwnProperty(c)){for(var U=0,p=0;p<u[c].length;++p)U+=u[c][p].size*u[c][p].weight;R.push({set:c,size:U})}function G(Vn,Bi){return Bi.size-Vn.size}R.sort(G);var Q={};function pt(Vn){return Vn.set in Q}function vt(Vn,Bi){i[Bi].x=Vn.x,i[Bi].y=Vn.y,Q[Bi]=!0}vt({x:0,y:0},R[0].set);for(var p=1;p<R.length;++p){var Vt=R[p].set,le=u[Vt].filter(pt);if(c=i[Vt],le.sort(G),le.length===0)throw"ERROR: missing pairwise overlap information";for(var he=[],Ne=0;Ne<le.length;++Ne){var Er=i[le[Ne].set],Fr=Ub(c.radius,Er.radius,le[Ne].size);he.push({x:Er.x+Fr,y:Er.y}),he.push({x:Er.x-Fr,y:Er.y}),he.push({y:Er.y+Fr,x:Er.x}),he.push({y:Er.y-Fr,x:Er.x});for(var zr=Ne+1;zr<le.length;++zr)for(var pn=i[le[zr].set],nn=Ub(c.radius,pn.radius,le[zr].size),Pn=dA({x:Er.x,y:Er.y,radius:Fr},{x:pn.x,y:pn.y,radius:nn}),Si=0;Si<Pn.length;++Si)he.push(Pn[Si])}for(var ha=1e50,wa=he[0],Ne=0;Ne<he.length;++Ne){i[Vt].x=he[Ne].x,i[Vt].y=he[Ne].y;var _o=t(i,r);_o<ha&&(ha=_o,wa=he[Ne])}vt(wa,Vt)}return i}function Pm(r,e){var t=0;function i(k){return k.map(function(L){return r[L]})}for(var u=0;u<e.length;++u){var c=e[u],p=void 0;if(c.sets.length!=1){if(c.sets.length==2){var g=r[c.sets[0]],_=r[c.sets[1]];p=pA(g.radius,_.radius,Mp(g,_))}else p=Db(i(c.sets));var w=c.hasOwnProperty("weight")?c.weight:1;t+=w*(p-c.size)*(p-c.size)}}return t}function WL(r,e,t){t===null?r.sort(function(Q,pt){return pt.radius-Q.radius}):r.sort(t);var i;if(r.length>0){var u=r[0].x,c=r[0].y;for(i=0;i<r.length;++i)r[i].x-=u,r[i].y-=c}if(r.length==2){var p=distance(r[0],r[1]);p<Math.abs(r[1].radius-r[0].radius)&&(r[1].x=r[0].x+r[0].radius-r[1].radius-1e-10,r[1].y=r[0].y)}if(r.length>1){var g=Math.atan2(r[1].x,r[1].y)-e,_=void 0,w=void 0,k=Math.cos(g),L=Math.sin(g);for(i=0;i<r.length;++i)_=r[i].x,w=r[i].y,r[i].x=k*_-L*w,r[i].y=L*_+k*w}if(r.length>2){for(var R=Math.atan2(r[2].x,r[2].y)-e;R<0;)R+=2*Math.PI;for(;R>2*Math.PI;)R-=2*Math.PI;if(R>Math.PI){var U=r[1].y/(1e-10+r[1].x);for(i=0;i<r.length;++i){var G=(r[i].x+U*r[i].y)/(1+U*U);r[i].x=2*G-r[i].x,r[i].y=2*G*U-r[i].y}}}}function XL(r){r.map(function(w){w.parent=w});function e(w){return w.parent!==w&&(w.parent=e(w.parent)),w.parent}function t(w,k){var L=e(w),R=e(k);L.parent=R}for(var i=0;i<r.length;++i)for(var u=i+1;u<r.length;++u){var c=r[i].radius+r[u].radius;distance(r[i],r[u])+1e-10<c&&t(r[u],r[i])}for(var p={},g,i=0;i<r.length;++i)g=e(r[i]).parent.setid,g in p||(p[g]=[]),p[g].push(r[i]);r.map(function(w){delete w.parent});var _=[];for(g in p)p.hasOwnProperty(g)&&_.push(p[g]);return _}function Zb(r){var e=function(t){var i=Math.max.apply(null,r.map(function(c){return c[t]+c.radius})),u=Math.min.apply(null,r.map(function(c){return c[t]-c.radius}));return{max:i,min:u}};return{xRange:e("x"),yRange:e("y")}}function MF(r,e,t){e===null&&(e=Math.PI/2);var i=[],u,c;for(c in r)if(r.hasOwnProperty(c)){var p=r[c];i.push({x:p.x,y:p.y,radius:p.radius,setid:c})}var g=XL(i);for(u=0;u<g.length;++u){WL(g[u],e,t);var _=Zb(g[u]);g[u].size=(_.xRange.max-_.xRange.min)*(_.yRange.max-_.yRange.min),g[u].bounds=_}g.sort(function(G,Q){return Q.size-G.size}),i=g[0];var w=i.bounds,k=(w.xRange.max-w.xRange.min)/50;function L(G,Q,pt){if(!!G){var vt=G.bounds,Vt,le,he;Q?Vt=w.xRange.max-vt.xRange.min+k:(Vt=w.xRange.max-vt.xRange.max,he=(vt.xRange.max-vt.xRange.min)/2-(w.xRange.max-w.xRange.min)/2,he<0&&(Vt+=he)),pt?le=w.yRange.max-vt.yRange.min+k:(le=w.yRange.max-vt.yRange.max,he=(vt.yRange.max-vt.yRange.min)/2-(w.yRange.max-w.yRange.min)/2,he<0&&(le+=he));for(var Ne=0;Ne<G.length;++Ne)G[Ne].x+=Vt,G[Ne].y+=le,i.push(G[Ne])}}for(var R=1;R<g.length;)L(g[R],!0,!1),L(g[R+1],!1,!0),L(g[R+2],!0,!0),R+=3,w=Zb(i);var U={};for(u=0;u<i.length;++u)U[i[u].setid]=i[u];return U}function YL(r,e,t,i){var u=[],c=[];for(var p in r)r.hasOwnProperty(p)&&(c.push(p),u.push(r[p]));e-=2*i,t-=2*i;var g=Zb(u),_=g.xRange,w=g.yRange;if(_.max==_.min||w.max==w.min)return console.log("not scaling solution: zero size detected"),r;for(var k=e/(_.max-_.min),L=t/(w.max-w.min),R=Math.min(L,k),U=(e-(_.max-_.min)*R)/2,G=(t-(w.max-w.min)*R)/2,Q={},pt=0;pt<u.length;++pt){var vt=u[pt];Q[c[pt]]={radius:R*vt.radius,x:i+U+(vt.x-_.min)*R,y:i+G+(vt.y-w.min)*R}}return Q}var $L=(0,b.HP)(function(r,e,t,i){var u=new Map,c=r.length;return e.forEach(function(p,g){if(p[i].length===1)u.set(p[fh],r[(g+c)%c]);else{var _=p[i].map(function(w){return u.get(w)});u.set(p[fh],_.slice(1).reduce(function(w,k){return PL(w,k,t)},_[0]))}}),u},function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return JSON.stringify(r)});function qL(r,e,t,i){i===void 0&&(i=0);var u=r.data,c=r.setsField,p=r.sizeField;if(u.length===0)return Ap(Cp.WARN,!1,"warn: %s","\u6570\u636E\u4E0D\u80FD\u4E3A\u7A7A"),[];var g=u.map(function(L){var R;return(0,P.pi)((0,P.pi)({},L),(R={sets:L[c]||[],size:L[p]},R[Rb]="",R[fh]="",R))});g.sort(function(L,R){return L.sets.length-R.sets.length});var _=zL(g),w=YL(_,e,t,i),k=DL(w,g);return g.forEach(function(L){var R=L.sets,U=R.join(",");L[fh]=U;var G=R.map(function(vt){return w[vt]}),Q=NL(G);/[zZ]$/.test(Q)||(Q+=" Z"),L[Rb]=Q;var pt=k[U]||{x:0,y:0};(0,b.f0)(L,pt)}),g}function KL(r,e){for(var t=0;t<e.length;t++)if(!r.includes(e[t]))return!1;return!0}var QL=40;function mA(r,e,t){var i=r.chart,u=r.options,c=u.blendMode,p=u.setsField,g=i.getTheme(),_=g.colors10,w=g.colors20,k=t;(0,b.kJ)(k)||(k=e.filter(function(R){return R[p].length===1}).length<=10?_:w);var L=$L(k,e,c,p);return function(R){return L.get(R)||k[0]}}function JL(r,e){var t=r.options,i=t.color;if(typeof i!="function"){var u=typeof i=="string"?[i]:i,c=mA(r,e,u);return function(p){return c(p[fh])}}return i}function tP(r){var e=r.chart,t=r.options,i=t.legend,u=t.appendPadding,c=t.padding,p=Vv(u);return i!==!1&&(p=My(u,(0,b.U2)(i,"position"),QL)),e.appendPadding=ux([p,c]),r}function eP(r){var e=r.options,t=e.data;t||(Ap(Cp.WARN,!1,"warn: %s","\u6570\u636E\u4E0D\u80FD\u4E3A\u7A7A"),t=[]);var i=t.filter(function(c){return c.sets.length===1}).map(function(c){return c.sets[0]}),u=t.filter(function(c){var p=c.sets;return KL(i,p)});return(0,b.Xy)(u,t)||Ap(Cp.WARN,!1,"warn: %s","\u4EA4\u96C6\u4E2D\u4E0D\u80FD\u51FA\u73B0\u4E0D\u5B58\u5728\u7684\u96C6\u5408, \u8BF7\u8F93\u5165\u5408\u6CD5\u6570\u636E"),(0,b.b$)({},r,{options:{data:u}})}function rP(r){var e=r.chart,t=r.options,i=t.pointStyle,u=t.setsField,c=t.sizeField,p=Vv(e.appendPadding),g=p[0],_=p[1],w=p[2],k=p[3],L={offsetX:k,offsetY:g},R=e.viewBBox,U=R.width,G=R.height,Q=qL(t,Math.max(U-(_+k),0),Math.max(G-(g+w),0),0);e.data(Q);var pt=mg(hn({},r,{options:{xField:"x",yField:"y",sizeField:c,seriesField:fh,rawFields:[u,c],schema:{shape:"venn",style:i}}})).ext,vt=pt.geometry;vt.customInfo(L);var Vt=JL(r,Q);return typeof Vt=="function"&&vt.color(fh,function(le){var he=Q.find(function(Er){return Er[fh]===le}),Ne=mA(r,Q)(le);return Vt(he,Ne)}),r}function nP(r){var e=r.chart,t=r.options,i=t.label,u=Vv(e.appendPadding),c=u[0],p=u[3],g={offsetX:p,offsetY:c},_=Ec(e,"schema");if(!i)_.label(!1);else{var w=i.callback,k=(0,P._T)(i,["callback"]);_.label({fields:["id"],callback:w,cfg:(0,b.b$)({},Os(k),{type:"venn",customLabelInfo:g})})}return r}function iP(r){var e=r.chart,t=r.options,i=t.legend,u=t.sizeField;return e.legend(fh,i),e.legend(u,!1),r}function aP(r){var e=r.chart;return e.axis(!1),r}function yA(r){var e=r.options,t=r.chart,i=e.interactions;if(i){var u={"legend-active":"venn-legend-active","legend-highlight":"venn-legend-highlight"};Xs(hn({},r,{options:{interactions:i.map(function(c){return(0,P.pi)((0,P.pi)({},c),{type:u[c.type]||c.type})})}}))}return t.removeInteraction("legend-active"),t.removeInteraction("legend-highlight"),r}function _A(r){return Ga(tP,Bo,eP,rP,nP,Zs({}),iP,aP,hl,yA,ms)(r)}var oP=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="venn",t}return e.getDefaultOptions=function(){return bL},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return _A},e.prototype.triggerResize=function(){this.chart.destroyed||(this.chart.forceFit(),this.chart.clear(),this.execAdaptor(),this.chart.render(!0))},e}(Ha),Vh="x",Yv="violinY",xA="violinSize",bA="minMax",Vb="quantile",Gb="median",Hb="violin_view",EA="min_max_view",sP="quantile_view",uP="median_view",lP=hn({},Ha.getDefaultOptions(),{syncViewPadding:!0,kde:{type:"triangular",sampleSize:32,width:3},violinStyle:{lineWidth:1,fillOpacity:.3,strokeOpacity:.75},xAxis:{grid:{line:null},tickLine:{alignTick:!1}},yAxis:{grid:{line:{style:{lineWidth:.5,lineDash:[4,4]}}}},legend:{position:"top-left"},tooltip:{showMarkers:!1}}),cP=ot(53843),fP=ot.n(cP);function jb(r,e){var t=r.length*e;if(r.length===0)throw new Error("quantile requires at least one data point.");if(e<0||e>1)throw new Error("quantiles must be between 0 and 1");return e===1?r[r.length-1]:e===0?r[0]:t%1!==0?r[Math.ceil(t)-1]:r.length%2===0?(r[t-1]+r[t])/2:r[t]}function Lg(r,e,t){var i=r[e];r[e]=r[t],r[t]=i}function A_(r,e,t,i){for(t=t||0,i=i||r.length-1;i>t;){if(i-t>600){var u=i-t+1,c=e-t+1,p=Math.log(u),g=.5*Math.exp(2*p/3),_=.5*Math.sqrt(p*g*(u-g)/u);c-u/2<0&&(_*=-1);var w=Math.max(t,Math.floor(e-c*g/u+_)),k=Math.min(i,Math.floor(e+(u-c)*g/u+_));A_(r,e,w,k)}var L=r[e],R=t,U=i;for(Lg(r,t,e),r[i]>L&&Lg(r,t,i);R<U;){for(Lg(r,R,U),R++,U--;r[R]<L;)R++;for(;r[U]>L;)U--}r[t]===L?Lg(r,t,U):(U++,Lg(r,U,i)),U<=e&&(t=U+1),e<=U&&(i=U-1)}}function Pg(r,e){var t=r.slice();if(Array.isArray(e)){T_(t,e);for(var i=[],u=0;u<e.length;u++)i[u]=jb(t,e[u]);return i}else{var c=SA(t.length,e);return Wb(t,c,0,t.length-1),jb(t,e)}}function Wb(r,e,t,i){e%1===0?A_(r,e,t,i):(e=Math.floor(e),A_(r,e,t,i),A_(r,e+1,e+1,i))}function T_(r,e){for(var t=[0],i=0;i<e.length;i++)t.push(SA(r.length,e[i]));t.push(r.length-1),t.sort(hP);for(var u=[0,t.length-1];u.length;){var c=Math.ceil(u.pop()),p=Math.floor(u.pop());if(!(c-p<=1)){var g=Math.floor((p+c)/2);Wb(r,t[g],Math.floor(t[p]),Math.ceil(t[c])),u.push(p,g,g,c)}}}function hP(r,e){return r-e}function SA(r,e){var t=r*e;return e===1?r-1:e===0?0:t%1!==0?Math.ceil(t)-1:r%2===0?t-.5:t}var wA=function(r){return{low:(0,b.VV)(r),high:(0,b.Fp)(r),q1:Pg(r,.25),q3:Pg(r,.75),median:Pg(r,[.5]),minMax:[(0,b.VV)(r),(0,b.Fp)(r)],quantile:[Pg(r,.25),Pg(r,.75)]}},pP=function(r,e){var t=fP().create(r,e);return{violinSize:t.map(function(i){return i.y}),violinY:t.map(function(i){return i.x})}},Xb=function(r){var e=r.xField,t=r.yField,i=r.seriesField,u=r.data,c=r.kde,p={min:c.min,max:c.max,size:c.sampleSize,width:c.width};if(!i){var g=(0,b.vM)(u,e);return Object.keys(g).map(function(k){var L=g[k],R=L.map(function(U){return U[t]});return(0,P.pi)((0,P.pi)({x:k},pP(R,p)),wA(R))})}var _=[],w=(0,b.vM)(u,i);return Object.keys(w).forEach(function(k){var L=(0,b.vM)(w[k],e);return Object.keys(L).forEach(function(R){var U,G=L[R],Q=G.map(function(pt){return pt[t]});_.push((0,P.pi)((0,P.pi)((U={x:R},U[i]=k,U),pP(Q,p)),wA(Q)))})}),_},Om=["low","high","q1","q3","median"],M_=[{type:"dodge",marginRatio:1/32}];function CA(r){var e=r.chart,t=r.options;return e.data(Xb(t)),r}function AA(r){var e=r.chart,t=r.options,i=t.seriesField,u=t.color,c=t.shape,p=c===void 0?"violin":c,g=t.violinStyle,_=t.tooltip,w=t.state,k=e.createView({id:Hb});return A0({chart:k,options:{xField:Vh,yField:Yv,seriesField:i||Vh,sizeField:xA,tooltip:(0,P.pi)({fields:Om},_),violin:{style:g,color:u,shape:p},state:w}}),k.geometries[0].adjust(M_),r}function TA(r){var e=r.chart,t=r.options,i=t.seriesField,u=t.color,c=t.tooltip,p=t.box;if(p===!1)return r;var g=e.createView({id:EA});ac({chart:g,options:{xField:Vh,yField:bA,seriesField:i||Vh,tooltip:(0,P.pi)({fields:Om},c),state:typeof p=="object"?p.state:{},interval:{color:u,size:1,style:{lineWidth:0}}}}),g.geometries[0].adjust(M_);var _=e.createView({id:sP});ac({chart:_,options:{xField:Vh,yField:Vb,seriesField:i||Vh,tooltip:(0,P.pi)({fields:Om},c),state:typeof p=="object"?p.state:{},interval:{color:u,size:8,style:{fillOpacity:1}}}}),_.geometries[0].adjust(M_);var w=e.createView({id:uP});return Bf({chart:w,options:{xField:Vh,yField:Gb,seriesField:i||Vh,tooltip:(0,P.pi)({fields:Om},c),state:typeof p=="object"?p.state:{},point:{color:u,size:1,style:{fill:"white",lineWidth:0}}}}),w.geometries[0].adjust(M_),_.axis(!1),g.axis(!1),w.axis(!1),w.legend(!1),g.legend(!1),_.legend(!1),r}function MA(r){var e,t=r.chart,i=r.options,u=i.meta,c=i.xAxis,p=i.yAxis,g={},_=hn(g,u,(e={},e[Vh]=(0,P.pi)((0,P.pi)({sync:!0},fs(c,Rf)),{type:"cat"}),e[Yv]=(0,P.pi)({sync:!0},fs(p,Rf)),e[bA]=(0,P.pi)({sync:Yv},fs(p,Rf)),e[Vb]=(0,P.pi)({sync:Yv},fs(p,Rf)),e[Gb]=(0,P.pi)({sync:Yv},fs(p,Rf)),e));return t.scale(_),r}function IA(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=yo(e,Hb);return i===!1?c.axis(Vh,!1):c.axis(Vh,i),u===!1?c.axis(Yv,!1):c.axis(Yv,u),e.axis(!1),r}function kA(r){var e=r.chart,t=r.options,i=t.legend,u=t.seriesField,c=t.shape;if(i===!1)e.legend(!1);else{var p=u||Vh,g=(0,b.CE)(i,["selected"]);(!c||!c.startsWith("hollow"))&&((0,b.U2)(g,["marker","style","lineWidth"])||(0,b.t8)(g,["marker","style","lineWidth"],0)),e.legend(p,g),(0,b.U2)(i,"selected")&&(0,b.S6)(e.views,function(_){return _.legend(p,i)})}return r}function Og(r){var e=r.chart,t=yo(e,Hb);return Ys()((0,P.pi)((0,P.pi)({},r),{chart:t})),r}function LA(r){var e=r.chart,t=r.options,i=t.animation;return(0,b.S6)(e.views,function(u){E0(u,i)}),r}function PA(r){return Ga(Bo,CA,AA,TA,MA,hl,IA,kA,Xs,Og,LA)(r)}var dP=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="violin",t}return e.getDefaultOptions=function(){return lP},e.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(Xb(this.options))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return PA},e}(Ha),hh="$$yField$$",I_="$$diffField$$",k_="$$absoluteField$$",L_="$$isTotal$$",vP={label:{},leaderLine:{style:{lineWidth:1,stroke:"#8c8c8c",lineDash:[4,2]}},total:{style:{fill:"rgba(0, 0, 0, 0.25)"}},interactions:[{type:"element-active"}],risingFill:"#f4664a",fallingFill:"#30bf78",waterfallStyle:{fill:"rgba(0, 0, 0, 0.25)"},yAxis:{grid:{line:{style:{lineDash:[4,2]}}}}};function OA(r){for(var e=[],t=0;t<r.length;t++){var i=r[t];if(i){var u=t===0?"M":"L";e.push([u,i.x,i.y])}}var c=r[0];return e.push(["L",c.x,c.y]),e.push(["z"]),e}function FA(r){return hn({},r.defaultStyle,r.style,{fill:r.color})}va("interval","waterfall",{draw:function(r,e){var t=r.customInfo,i=r.points,u=r.nextPoints,c=e.addGroup(),p=this.parsePath(OA(i)),g=FA(r);c.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},g),{path:p})});var _=(0,b.U2)(t,"leaderLine");if(_&&u){var w=[["M",i[2].x,i[2].y],["L",u[0].x,u[0].y]];i[2].y===u[1].y&&(w[1]=["L",u[1].x,u[1].y]),w=this.parsePath(w),c.addShape("path",{attrs:(0,P.pi)({path:w},_.style||{})})}return c}});function gP(r,e,t,i,u){var c,p=[];if((0,b.u4)(r,function(_,w){var k;Ap(Cp.WARN,(0,b.hj)(w[t]),w[t]+" is not a valid number");var L=(0,b.o8)(w[t])?null:w[t];return p.push((0,P.pi)((0,P.pi)({},w),(k={},k[i]=[_,_+L],k))),_+L},0),p.length&&u){var g=(0,b.U2)(p,[[r.length-1],i,[1]]);p.push((c={},c[e]=u.label,c[t]=g,c[i]=[0,g],c))}return p}function RA(r,e,t,i){var u=gP(r,e,t,hh,i);return u.map(function(c,p){var g;return(0,b.Kn)(c)?(0,P.pi)((0,P.pi)({},c),(g={},g[k_]=c[hh][1],g[I_]=c[hh][1]-c[hh][0],g[L_]=p===r.length,g)):c})}function mP(r){var e=r.options,t=e.locale,i=e.total,u=yx(t).get(["waterfall","total"]);return i&&typeof i.label!="string"&&u&&(r.options.total.label=u),r}function yP(r){var e=r.chart,t=r.options,i=t.data,u=t.xField,c=t.yField,p=t.total,g=t.leaderLine,_=t.columnWidthRatio,w=t.waterfallStyle,k=t.risingFill,L=t.fallingFill,R=t.color;e.data(RA(i,u,c,p));var U=R||function(vt){return(0,b.U2)(vt,[L_])?(0,b.U2)(p,["style","fill"],""):(0,b.U2)(vt,[hh,1])-(0,b.U2)(vt,[hh,0])>0?k:L},G=hn({},r,{options:{xField:u,yField:hh,seriesField:u,rawFields:[c,I_,L_,hh],widthRatio:_,interval:{style:w,shape:"waterfall",color:U}}}),Q=ac(G).ext,pt=Q.geometry;return pt.customInfo({leaderLine:g}),r}function rv(r){var e,t,i=r.options,u=i.xAxis,c=i.yAxis,p=i.xField,g=i.yField,_=i.meta,w=hn({},{alias:g},(0,b.U2)(_,g));return Ga(Zs((e={},e[p]=u,e[g]=c,e[hh]=c,e),hn({},_,(t={},t[hh]=w,t[I_]=w,t[k_]=w,t))))(r)}function Fm(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?(e.axis(p,!1),e.axis(hh,!1)):(e.axis(p,u),e.axis(hh,u)),r}function nv(r){var e=r.chart,t=r.options,i=t.legend,u=t.total,c=t.risingFill,p=t.fallingFill,g=t.locale,_=yx(g);if(i===!1)e.legend(!1);else{var w=[{name:_.get(["general","increase"]),value:"increase",marker:{symbol:"square",style:{r:5,fill:c}}},{name:_.get(["general","decrease"]),value:"decrease",marker:{symbol:"square",style:{r:5,fill:p}}}];u&&w.push({name:u.label||"",value:"total",marker:{symbol:"square",style:hn({},{r:5},(0,b.U2)(u,"style"))}}),e.legend(hn({},{custom:!0,position:"top",items:w},i)),e.removeInteraction("legend-filter")}return r}function Gh(r){var e=r.chart,t=r.options,i=t.label,u=t.labelMode,c=t.xField,p=Ec(e,"interval");if(!i)p.label(!1);else{var g=i.callback,_=(0,P._T)(i,["callback"]);p.label({fields:u==="absolute"?[k_,c]:[I_,c],callback:g,cfg:Os(_)})}return r}function Rm(r){var e=r.chart,t=r.options,i=t.tooltip,u=t.xField,c=t.yField;if(i!==!1){e.tooltip((0,P.pi)({showCrosshairs:!1,showMarkers:!1,shared:!0,fields:[c]},i));var p=e.geometries[0];i!=null&&i.formatter?p.tooltip(u+"*"+c,i.formatter):p.tooltip(c)}else e.tooltip(!1);return r}function $v(r){return Ga(mP,Bo,yP,rv,Fm,nv,Rm,Gh,S0,Xs,ms,Ys())(r)}var P_=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="waterfall",t}return e.getDefaultOptions=function(){return vP},e.prototype.changeData=function(t){var i=this.options,u=i.xField,c=i.yField,p=i.total;this.updateOption({data:t}),this.chart.changeData(RA(t,u,c,p))},e.prototype.getSchemaAdaptor=function(){return $v},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ha),Fg="color",cd=hn({},Ha.getDefaultOptions(),{timeInterval:2e3,legend:!1,tooltip:{showTitle:!1,showMarkers:!1,showCrosshairs:!1,fields:["text","value",Fg],formatter:function(r){return{name:r.text,value:r.value}}},wordStyle:{fontFamily:"Verdana",fontWeight:"normal",padding:1,fontSize:[12,60],rotation:[0,90],rotationSteps:2,rotateRatio:.5}}),V0={font:function(){return"serif"},padding:1,size:[500,500],spiral:"archimedean",timeInterval:3e3};function Sc(r,e){return e=(0,b.f0)({},V0,e),fd(r,e)}function fd(r,e){var t=wP();["font","fontSize","fontWeight","padding","rotate","size","spiral","timeInterval","random"].forEach(function(_){(0,b.UM)(e[_])||t[_](e[_])}),t.words(r),e.imageMask&&t.createMask(e.imageMask);var i=t.start(),u=i._tags;u.forEach(function(_){_.x+=e.size[0]/2,_.y+=e.size[1]/2});var c=e.size,p=c[0],g=c[1];return u.push({text:"",value:0,x:0,y:0,opacity:0}),u.push({text:"",value:0,x:p,y:g,opacity:0}),u}var Hh=Math.PI/180,qv=1<<11>>5,O_=1<<11;function DA(r){return r.text}function Yb(){return"serif"}function BA(){return"normal"}function _P(r){return r.value}function NA(){return~~(Math.random()*2)*90}function zA(){return 1}function xP(r,e,t,i){if(!e.sprite){var u=r.context,c=r.ratio;u.clearRect(0,0,(qv<<5)/c,O_/c);var p=0,g=0,_=0,w=t.length;for(--i;++i<w;){e=t[i],u.save(),u.font=e.style+" "+e.weight+" "+~~((e.size+1)/c)+"px "+e.font;var k=u.measureText(e.text+"m").width*c,L=e.size<<1;if(e.rotate){var R=Math.sin(e.rotate*Hh),U=Math.cos(e.rotate*Hh),G=k*U,Q=k*R,pt=L*U,vt=L*R;k=Math.max(Math.abs(G+vt),Math.abs(G-vt))+31>>5<<5,L=~~Math.max(Math.abs(Q+pt),Math.abs(Q-pt))}else k=k+31>>5<<5;if(L>_&&(_=L),p+k>=qv<<5&&(p=0,g+=_,_=0),g+L>=O_)break;u.translate((p+(k>>1))/c,(g+(L>>1))/c),e.rotate&&u.rotate(e.rotate*Hh),u.fillText(e.text,0,0),e.padding&&(u.lineWidth=2*e.padding,u.strokeText(e.text,0,0)),u.restore(),e.width=k,e.height=L,e.xoff=p,e.yoff=g,e.x1=k>>1,e.y1=L>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,p+=k}for(var Vt=u.getImageData(0,0,(qv<<5)/c,O_/c).data,le=[];--i>=0;)if(e=t[i],!!e.hasText){for(var k=e.width,he=k>>5,L=e.y1-e.y0,Ne=0;Ne<L*he;Ne++)le[Ne]=0;if(p=e.xoff,p==null)return;g=e.yoff;for(var Er=0,Fr=-1,zr=0;zr<L;zr++){for(var Ne=0;Ne<k;Ne++){var pn=he*zr+(Ne>>5),nn=Vt[(g+zr)*(qv<<5)+(p+Ne)<<2]?1<<31-Ne%32:0;le[pn]|=nn,Er|=nn}Er?Fr=zr:(e.y0++,L--,zr--,g++)}e.y1=e.y0+Fr,e.sprite=le.slice(0,(e.y1-e.y0)*he)}}}function bP(r,e,t){t>>=5;for(var i=r.sprite,u=r.width>>5,c=r.x-(u<<4),p=c&127,g=32-p,_=r.y1-r.y0,w=(r.y+r.y0)*t+(c>>5),k,L=0;L<_;L++){k=0;for(var R=0;R<=u;R++)if((k<<g|(R<u?(k=i[L*u+R])>>>p:0))&e[w+R])return!0;w+=t}return!1}function UA(r,e){var t=r[0],i=r[1];e.x+e.x0<t.x&&(t.x=e.x+e.x0),e.y+e.y0<t.y&&(t.y=e.y+e.y0),e.x+e.x1>i.x&&(i.x=e.x+e.x1),e.y+e.y1>i.y&&(i.y=e.y+e.y1)}function F_(r,e){return r.x+r.x1>e[0].x&&r.x+r.x0<e[1].x&&r.y+r.y1>e[0].y&&r.y+r.y0<e[1].y}function ZA(r){var e=r[0]/r[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function Rg(r){var e=4,t=e*r[0]/r[1],i=0,u=0;return function(c){var p=c<0?-1:1;switch(Math.sqrt(1+4*p*c)-p&3){case 0:i+=t;break;case 1:u+=e;break;case 2:i-=t;break;default:u-=e;break}return[i,u]}}function VA(r){for(var e=[],t=-1;++t<r;)e[t]=0;return e}function EP(){return document.createElement("canvas")}function hd(r){return(0,b.mf)(r)?r:function(){return r}}var SP={archimedean:ZA,rectangular:Rg};function wP(){var r=[256,256],e=Yb,t=_P,i=BA,u=NA,c=zA,p=ZA,g=Math.random,_=[],w=1/0,k=DA,L=BA,R=EP,U={};U.start=function(){var pt=r[0],vt=r[1],Vt=G(R()),le=U.board?U.board:VA((r[0]>>5)*r[1]),he=_.length,Ne=[],Er=_.map(function(nn,Pn,Si){return nn.text=k.call(this,nn,Pn,Si),nn.font=e.call(this,nn,Pn,Si),nn.style=L.call(this,nn,Pn,Si),nn.weight=i.call(this,nn,Pn,Si),nn.rotate=u.call(this,nn,Pn,Si),nn.size=~~t.call(this,nn,Pn,Si),nn.padding=c.call(this,nn,Pn,Si),nn}).sort(function(nn,Pn){return Pn.size-nn.size}),Fr=-1,zr=U.board?[{x:0,y:0},{x:pt,y:vt}]:null;pn();function pn(){for(var nn=Date.now();Date.now()-nn<w&&++Fr<he;){var Pn=Er[Fr];Pn.x=pt*(g()+.5)>>1,Pn.y=vt*(g()+.5)>>1,xP(Vt,Pn,Er,Fr),Pn.hasText&&Q(le,Pn,zr)&&(Ne.push(Pn),zr?U.hasImage||UA(zr,Pn):zr=[{x:Pn.x+Pn.x0,y:Pn.y+Pn.y0},{x:Pn.x+Pn.x1,y:Pn.y+Pn.y1}],Pn.x-=r[0]>>1,Pn.y-=r[1]>>1)}U._tags=Ne,U._bounds=zr}return U};function G(pt){pt.width=pt.height=1;var vt=Math.sqrt(pt.getContext("2d").getImageData(0,0,1,1).data.length>>2);pt.width=(qv<<5)/vt,pt.height=O_/vt;var Vt=pt.getContext("2d");return Vt.fillStyle=Vt.strokeStyle="red",Vt.textAlign="center",{context:Vt,ratio:vt}}function Q(pt,vt,Vt){for(var le=vt.x,he=vt.y,Ne=Math.sqrt(r[0]*r[0]+r[1]*r[1]),Er=p(r),Fr=g()<.5?1:-1,zr,pn=-Fr,nn,Pn;(zr=Er(pn+=Fr))&&(nn=~~zr[0],Pn=~~zr[1],!(Math.min(Math.abs(nn),Math.abs(Pn))>=Ne));)if(vt.x=le+nn,vt.y=he+Pn,!(vt.x+vt.x0<0||vt.y+vt.y0<0||vt.x+vt.x1>r[0]||vt.y+vt.y1>r[1])&&(!Vt||!bP(vt,pt,r[0]))&&(!Vt||F_(vt,Vt))){for(var Si=vt.sprite,ha=vt.width>>5,wa=r[0]>>5,_o=vt.x-(ha<<4),Vn=_o&127,Bi=32-Vn,fa=vt.y1-vt.y0,Ui=void 0,Ji=(vt.y+vt.y0)*wa+(_o>>5),Fa=0;Fa<fa;Fa++){Ui=0;for(var xo=0;xo<=ha;xo++)pt[Ji+xo]|=Ui<<Bi|(xo<ha?(Ui=Si[Fa*ha+xo])>>>Vn:0);Ji+=wa}return delete vt.sprite,!0}return!1}return U.createMask=function(pt){var vt=document.createElement("canvas"),Vt=r[0],le=r[1];if(!(!Vt||!le)){var he=Vt>>5,Ne=VA((Vt>>5)*le);vt.width=Vt,vt.height=le;var Er=vt.getContext("2d");Er.drawImage(pt,0,0,pt.width,pt.height,0,0,Vt,le);for(var Fr=Er.getImageData(0,0,Vt,le).data,zr=0;zr<le;zr++)for(var pn=0;pn<Vt;pn++){var nn=he*zr+(pn>>5),Pn=zr*Vt+pn<<2,Si=Fr[Pn]>=250&&Fr[Pn+1]>=250&&Fr[Pn+2]>=250,ha=Si?1<<31-pn%32:0;Ne[nn]|=ha}U.board=Ne,U.hasImage=!0}},U.timeInterval=function(pt){w=pt==null?1/0:pt},U.words=function(pt){_=pt},U.size=function(pt){r=[+pt[0],+pt[1]]},U.font=function(pt){e=hd(pt)},U.fontWeight=function(pt){i=hd(pt)},U.rotate=function(pt){u=hd(pt)},U.spiral=function(pt){p=SP[pt]||pt},U.fontSize=function(pt){t=hd(pt)},U.padding=function(pt){c=hd(pt)},U.random=function(pt){g=hd(pt)},U}function GA(r){var e=r.options,t=r.chart,i=t,u=i.width,c=i.height,p=i.padding,g=i.appendPadding,_=i.ele,w=e.data,k=e.imageMask,L=e.wordField,R=e.weightField,U=e.colorField,G=e.wordStyle,Q=e.timeInterval,pt=e.random,vt=e.spiral,Vt=e.autoFit,le=Vt===void 0?!0:Vt,he=e.placementStrategy;if(!w||!w.length)return[];var Ne=G.fontFamily,Er=G.fontWeight,Fr=G.padding,zr=G.fontSize,pn=TP(w,R),nn=[IP(pn),WA(pn)],Pn=w.map(function(wa){return{text:wa[L],value:wa[R],color:wa[U],datum:wa}}),Si={imageMask:k,font:Ne,fontSize:AP(zr,nn),fontWeight:Er,size:HA({width:u,height:c,padding:p,appendPadding:g,autoFit:le,container:_}),padding:Fr,timeInterval:Q,random:pt,spiral:vt,rotate:$b(e)};if((0,b.mf)(he)){var ha=Pn.map(function(wa,_o,Vn){return(0,P.pi)((0,P.pi)((0,P.pi)({},wa),{hasText:!!wa.text,font:hd(Si.font)(wa,_o,Vn),weight:hd(Si.fontWeight)(wa,_o,Vn),rotate:hd(Si.rotate)(wa,_o,Vn),size:hd(Si.fontSize)(wa,_o,Vn),style:"normal"}),he.call(t,wa,_o,Vn))});return ha.push({text:"",value:0,x:0,y:0,opacity:0}),ha.push({text:"",value:0,x:Si.size[0],y:Si.size[1],opacity:0}),ha}return Sc(Pn,Si)}function HA(r){var e=r.width,t=r.height,i=r.container,u=r.autoFit,c=r.padding,p=r.appendPadding;if(u){var g=ax(i);e=g.width,t=g.height}e=e||400,t=t||400;var _=jA({padding:c,appendPadding:p}),w=_[0],k=_[1],L=_[2],R=_[3],U=[e-(R+k),t-(w+L)];return U}function jA(r){var e=Vv(r.padding),t=Vv(r.appendPadding),i=e[0]+t[0],u=e[1]+t[1],c=e[2]+t[2],p=e[3]+t[3];return[i,u,c,p]}function CP(r){return new Promise(function(e,t){if(r instanceof HTMLImageElement){e(r);return}if((0,b.HD)(r)){var i=new Image;i.crossOrigin="anonymous",i.src=r,i.onload=function(){e(i)},i.onerror=function(){Ap(Cp.ERROR,!1,"image %s load failed !!!",r),t()};return}Ap(Cp.WARN,r===void 0,"The type of imageMask option must be String or HTMLImageElement."),t()})}function AP(r,e){if((0,b.mf)(r))return r;if((0,b.kJ)(r)){var t=r[0],i=r[1];if(!e)return function(){return(i+t)/2};var u=e[0],c=e[1];return c===u?function(){return(i+t)/2}:function(g){var _=g.value;return(i-t)/(c-u)*(_-u)+t}}return function(){return r}}function TP(r,e){return r.map(function(t){return t[e]}).filter(function(t){return typeof t=="number"&&!isNaN(t)})}function $b(r){var e=MP(r),t=e.rotation,i=e.rotationSteps;if(!(0,b.kJ)(t))return t;var u=t[0],c=t[1],p=i===1?0:(c-u)/(i-1);return function(){return c===u?c:Math.floor(Math.random()*i)*p}}function MP(r){var e=r.wordStyle.rotationSteps;return e<1&&(Ap(Cp.WARN,!1,"The rotationSteps option must be greater than or equal to 1."),e=1),{rotation:r.wordStyle.rotation,rotationSteps:e}}function IP(r){return Math.min.apply(Math,r)}function WA(r){return Math.max.apply(Math,r)}function qb(r){var e=r.chart,t=r.options,i=t.colorField,u=t.color,c=GA(r);e.data(c);var p=hn({},r,{options:{xField:"x",yField:"y",seriesField:i&&Fg,rawFields:(0,b.mf)(u)&&(0,P.pr)((0,b.U2)(t,"rawFields",[]),["datum"]),point:{color:u,shape:"word-cloud"}}}),g=Bf(p).ext;return g.geometry.label(!1),e.coordinate().reflect("y"),e.axis(!1),r}function XA(r){return Ga(Zs({x:{nice:!1},y:{nice:!1}}))(r)}function YA(r){var e=r.chart,t=r.options,i=t.legend,u=t.colorField;return i===!1?e.legend(!1):u&&e.legend(Fg,i),r}function kP(r){Ga(qb,XA,hl,YA,Xs,ms,Bo,S0)(r)}va("point","word-cloud",{draw:function(r,e){var t=r.x,i=r.y,u=e.addShape("text",{attrs:(0,P.pi)((0,P.pi)({},$A(r)),{x:t,y:i})}),c=r.data.rotate;return typeof c=="number"&&_c.rotate(u,c*Math.PI/180),u}});function $A(r){return{fontSize:r.data.size,text:r.data.text,textAlign:"center",fontFamily:r.data.font,fontWeight:r.data.weight,fill:r.color||r.defaultStyle.stroke,textBaseline:"alphabetic"}}var LP=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="word-cloud",t}return e.getDefaultOptions=function(){return cd},e.prototype.changeData=function(t){this.updateOption({data:t}),this.options.imageMask?this.render():this.chart.changeData(GA({chart:this.chart,options:this.options}))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.render=function(){var t=this;return new Promise(function(i){var u=t.options.imageMask;if(!u){r.prototype.render.call(t),i();return}var c=function(p){t.options=(0,P.pi)((0,P.pi)({},t.options),{imageMask:p||null}),r.prototype.render.call(t),i()};CP(u).then(c).catch(c)})},e.prototype.getSchemaAdaptor=function(){return kP},e.prototype.triggerResize=function(){var t=this;this.chart.destroyed||(this.execAdaptor(),window.setTimeout(function(){r.prototype.triggerResize.call(t)}))},e}(Ha),PP=function(r){(0,P.ZT)(e,r);function e(t,i,u,c){var p=r.call(this,t,hn({},c,i))||this;return p.type="g2-plot",p.defaultOptions=c,p.adaptor=u,p}return e.prototype.getDefaultOptions=function(){return this.defaultOptions},e.prototype.getSchemaAdaptor=function(){return this.adaptor},e}(Ha),R_="2.4.23";wo("en-US",GO),wo("zh-CN",kS);var Kb={scale:Zs,legend:vg,tooltip:hl,annotation:Ys,interaction:Xs,theme:Bo,animation:ms}},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(gn){try{let tt=function(){K||(K=!0,I())},be=function(){try{xt.documentElement.doScroll("left")}catch(it){return void setTimeout(be,50)}tt()};var ht=tt,lt=be,ot=(ot=document.getElementsByTagName("script"))[ot.length-1],Ot=ot.getAttribute("data-injectcss"),ot=ot.getAttribute("data-disable-injectsvg");if(!ot){var kt,bt,I,xt,K,ut=function(st,Ut){Ut.parentNode.insertBefore(st,Ut)};if(Ot&&!gn.__iconfont__svg__cssinject__){gn.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(it){console&&console.log(it)}}kt=function(){var st,Ut=document.createElement("div");Ut.innerHTML=gn._iconfont_svg_string_3580659,(Ut=Ut.getElementsByTagName("svg")[0])&&(Ut.setAttribute("aria-hidden","true"),Ut.style.position="absolute",Ut.style.width=0,Ut.style.height=0,Ut.style.overflow="hidden",Ut=Ut,(st=document.body).firstChild?ut(Ut,st.firstChild):st.appendChild(Ut))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(kt,0):(bt=function(){document.removeEventListener("DOMContentLoaded",bt,!1),kt()},document.addEventListener("DOMContentLoaded",bt,!1)):document.attachEvent&&(I=kt,xt=gn.document,K=!1,be(),xt.onreadystatechange=function(){xt.readyState=="complete"&&(xt.onreadystatechange=null,tt())})}}catch(tt){}}(window)},3876:function(gn,Ot){"use strict";var ot;ot={value:!0},ot=ot=Ot.Tf=Ot.Bc=Ot.jp=Ot.fL=Ot.O6=Ot.rC=void 0,Ot.rC="l7plot-legend l7plot-legend__category",Ot.O6="l7plot-legend__title",Ot.fL="l7plot-legend__category-list",Ot.jp="l7plot-legend__list-item",Ot.Bc="l7plot-legend__category-marker",Ot.Tf="l7plot-legend__category-value",ot='<div class="'.concat(Ot.rC,`">
  <div class="`).concat(Ot.O6,`"></div>
  <ul class="`).concat(Ot.fL,`"></ul>
</div>`),ot='<li class="'.concat(Ot.jp,`" data-index={index}>
  <span class="`).concat(Ot.Bc,`" style="background:{color}"></span>
  <span class="`).concat(Ot.Tf,`">{value}</span>
</li>`)},56992:function(gn,Ot){"use strict";var ot;ot={value:!0},ot=ot=Ot.VI=Ot.bl=Ot.el=Ot.I8=Ot.O6=Ot.rC=void 0,Ot.rC="l7plot-legend l7plot-legend__continue",Ot.O6="l7plot-legend__title",Ot.I8="l7plot-legend__ribbon-container",Ot.el="l7plot-legend__ribbon",Ot.bl="l7plot-legend__gradient-bar",Ot.VI="l7plot-legend__value-range",ot='<div class="'.concat(Ot.rC,`">
  <div class="`).concat(Ot.O6,`"></div>
  <div class="`).concat(Ot.I8,`"></div>
</div>`),ot='<div class="'.concat(Ot.el,`">
  <span class="`).concat(Ot.VI,`">{min}</span>
  <div class="`).concat(Ot.bl,`" style="background-image: {backgroundImage}"></div>
  <span class="`).concat(Ot.VI,`">{max}</span>
</div>`)},77972:function(gn,Ot){"use strict";var ot;ot={value:!0},ot=ot=Ot.Tf=Ot.bX=Ot.jp=Ot.fL=Ot.O6=Ot.rC=void 0,Ot.rC="l7plot-tooltip",Ot.O6="l7plot-tooltip__title",Ot.fL="l7plot-tooltip__list",Ot.jp="l7plot-tooltip__list-item",Ot.bX="l7plot-tooltip__name",Ot.Tf="l7plot-tooltip__value",ot='<div class="'.concat(Ot.rC,`">
  <div class="`).concat(Ot.O6,`"></div>
  <ul class="`).concat(Ot.fL,`"></ul>
</div>`),ot='<li class="'.concat(Ot.jp,`" data-index={index}>
  <span class="`).concat(Ot.bX,`">{name}</span>
  <span class="`).concat(Ot.Tf,`">{value}</span>
</li>`)},31506:function(gn,Ot,ot){"use strict";ot.d(Ot,{Dg:function(){return tt},lh:function(){return K},m$:function(){return I},vs:function(){return ht},zu:function(){return xt}});var kt=ot(35600),bt=ot(31437);function I(it,st,Ut){var P=[0,0,0,0,0,0,0,0,0];return kt.vc(P,Ut),kt.Jp(it,P,st)}function xt(it,st,Ut){var P=[0,0,0,0,0,0,0,0,0];return kt.Us(P,Ut),kt.Jp(it,P,st)}function K(it,st,Ut){var P=[0,0,0,0,0,0,0,0,0];return kt.xJ(P,Ut),kt.Jp(it,P,st)}function ut(it,st,Ut){return kt.Jp(it,Ut,st)}function ht(it,st){for(var Ut=it?[].concat(it):[1,0,0,0,1,0,0,0,1],P=0,b=st.length;P<b;P++){var W=st[P];switch(W[0]){case"t":I(Ut,Ut,[W[1],W[2]]);break;case"s":K(Ut,Ut,[W[1],W[2]]);break;case"r":xt(Ut,Ut,W[1]);break;case"m":ut(Ut,Ut,W[1]);break;default:break}}return Ut}function lt(it,st){return it[0]*st[1]-st[0]*it[1]}function tt(it,st,Ut){var P=bt.EU(it,st),b=lt(it,st)>=0;return Ut?b?Math.PI*2-P:P:b?P:Math.PI*2-P}function be(it,st,Ut){return Ut?(it[0]=st[1],it[1]=-1*st[0]):(it[0]=-1*st[1],it[1]=st[0]),it}},39499:function(gn,Ot,ot){"use strict";ot.d(Ot,{e9:function(){return tt},Wq:function(){return J},tr:function(){return W},wb:function(){return Te},zx:function(){return $t}});var kt=ot(45098),bt=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,I=/[^\s\,]+/ig;function xt(gt){var jt=gt||[];if((0,kt.kJ)(jt))return jt;if((0,kt.HD)(jt))return jt=jt.match(bt),(0,kt.S6)(jt,function(ve,Gt){if(ve=ve.match(I),ve[0].length>1){var Ae=ve[0].charAt(0);ve.splice(1,0,ve[0].substr(1)),ve[0]=Ae}(0,kt.S6)(ve,function(He,qe){isNaN(He)||(ve[qe]=+He)}),jt[Gt]=ve}),jt}var K=xt,ut=ot(31437);function ht(gt,jt,ve,Gt){var Ae=[],He=!!Gt,qe,hr,tr,Br,Lr,Zr,Tn;if(He){tr=Gt[0],Br=Gt[1];for(var rn=0,Nn=gt.length;rn<Nn;rn+=1){var zn=gt[rn];tr=ut.VV([0,0],tr,zn),Br=ut.Fp([0,0],Br,zn)}}for(var rn=0,jn=gt.length;rn<jn;rn+=1){var zn=gt[rn];if(rn===0&&!ve)Tn=zn;else if(rn===jn-1&&!ve)Zr=zn,Ae.push(Tn),Ae.push(Zr);else{var Sn=[rn?rn-1:jn-1,rn-1][ve?0:1];qe=gt[Sn],hr=gt[ve?(rn+1)%jn:rn+1];var Wn=[0,0];Wn=ut.lu(Wn,hr,qe),Wn=ut.bA(Wn,Wn,jt);var Rt=ut.TE(zn,qe),Wt=ut.TE(zn,hr),oe=Rt+Wt;oe!==0&&(Rt/=oe,Wt/=oe);var Se=ut.bA([0,0],Wn,-Rt),ze=ut.bA([0,0],Wn,Wt);Zr=ut.IH([0,0],zn,Se),Lr=ut.IH([0,0],zn,ze),Lr=ut.VV([0,0],Lr,ut.Fp([0,0],hr,zn)),Lr=ut.Fp([0,0],Lr,ut.VV([0,0],hr,zn)),Se=ut.lu([0,0],Lr,zn),Se=ut.bA([0,0],Se,-Rt/Wt),Zr=ut.IH([0,0],zn,Se),Zr=ut.VV([0,0],Zr,ut.Fp([0,0],qe,zn)),Zr=ut.Fp([0,0],Zr,ut.VV([0,0],qe,zn)),ze=ut.lu([0,0],zn,Zr),ze=ut.bA([0,0],ze,Wt/Rt),Lr=ut.IH([0,0],zn,ze),He&&(Zr=ut.Fp([0,0],Zr,tr),Zr=ut.VV([0,0],Zr,Br),Lr=ut.Fp([0,0],Lr,tr),Lr=ut.VV([0,0],Lr,Br)),Ae.push(Tn),Ae.push(Zr),Tn=Lr}}return ve&&Ae.push(Ae.shift()),Ae}function lt(gt,jt,ve){jt===void 0&&(jt=!1),ve===void 0&&(ve=[[0,0],[1,1]]);for(var Gt=!!jt,Ae=[],He=0,qe=gt.length;He<qe;He+=2)Ae.push([gt[He],gt[He+1]]);for(var hr=ht(Ae,.4,Gt,ve),tr=Ae.length,Br=[],Lr,Zr,Tn,He=0;He<tr-1;He+=1)Lr=hr[He*2],Zr=hr[He*2+1],Tn=Ae[He+1],Br.push(["C",Lr[0],Lr[1],Zr[0],Zr[1],Tn[0],Tn[1]]);return Gt&&(Lr=hr[tr],Zr=hr[tr+1],Tn=Ae[0],Br.push(["C",Lr[0],Lr[1],Zr[0],Zr[1],Tn[0],Tn[1]])),Br}var tt=lt;function be(gt,jt,ve){var Gt=null,Ae=ve;return jt<Ae&&(Ae=jt,Gt="add"),gt<Ae&&(Ae=gt,Gt="del"),{type:Gt,min:Ae}}var it=function(gt,jt){var ve=gt.length,Gt=jt.length,Ae,He,qe=0;if(ve===0||Gt===0)return null;for(var hr=[],tr=0;tr<=ve;tr++)hr[tr]=[],hr[tr][0]={min:tr};for(var Br=0;Br<=Gt;Br++)hr[0][Br]={min:Br};for(var tr=1;tr<=ve;tr++){Ae=gt[tr-1];for(var Br=1;Br<=Gt;Br++){He=jt[Br-1],isEqual(Ae,He)?qe=0:qe=1;var Lr=hr[tr-1][Br].min+1,Zr=hr[tr][Br-1].min+1,Tn=hr[tr-1][Br-1].min+qe;hr[tr][Br]=be(Lr,Zr,Tn)}}return hr};function st(gt,jt){var ve=it(gt,jt),Gt=gt.length,Ae=jt.length,He=[],qe=1,hr=1;if(ve[Gt][Ae]!==Gt){for(var tr=1;tr<=Gt;tr++){var Br=ve[tr][tr].min;hr=tr;for(var Lr=qe;Lr<=Ae;Lr++)ve[tr][Lr].min<Br&&(Br=ve[tr][Lr].min,hr=Lr);qe=hr,ve[tr][qe].type&&He.push({index:tr-1,type:ve[tr][qe].type})}for(var tr=He.length-1;tr>=0;tr--)qe=He[tr].index,He[tr].type==="add"?gt.splice(qe,0,[].concat(gt[qe])):gt.splice(qe,1)}if(Gt=gt.length,Gt<Ae)for(var tr=0;tr<Ae-Gt;tr++)gt[Gt-1][0]==="z"||gt[Gt-1][0]==="Z"?gt.splice(Gt-2,0,gt[Gt-2]):gt.push(gt[Gt-1]);return gt}var Ut=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,P=new RegExp("([a-z])["+Ut+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Ut+"]*,?["+Ut+"]*)+)","ig"),b=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Ut+"]*,?["+Ut+"]*","ig");function W(gt){if(!gt)return null;if((0,kt.kJ)(gt))return gt;var jt={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},ve=[];return String(gt).replace(P,function(Gt,Ae,He){var qe=[],hr=Ae.toLowerCase();if(He.replace(b,function(tr,Br){Br&&qe.push(+Br)}),hr==="m"&&qe.length>2&&(ve.push([Ae].concat(qe.splice(0,2))),hr="l",Ae=Ae==="m"?"l":"L"),hr==="o"&&qe.length===1&&ve.push([Ae,qe[0]]),hr==="r")ve.push([Ae].concat(qe));else for(;qe.length>=jt[hr]&&(ve.push([Ae].concat(qe.splice(0,jt[hr]))),!!jt[hr]););return""}),ve}var fe=/[a-z]/;function Ee(gt,jt){return[jt[0]+(jt[0]-gt[0]),jt[1]+(jt[1]-gt[1])]}function Te(gt){var jt=W(gt);if(!jt||!jt.length)return[["M",0,0]];for(var ve=!1,Gt=0;Gt<jt.length;Gt++){var Ae=jt[Gt][0];if(fe.test(Ae)||["V","H","T","S"].indexOf(Ae)>=0){ve=!0;break}}if(!ve)return jt;var He=[],qe=0,hr=0,tr=0,Br=0,Lr=0,Zr,Tn,rn=jt[0];(rn[0]==="M"||rn[0]==="m")&&(qe=+rn[1],hr=+rn[2],tr=qe,Br=hr,Lr++,He[0]=["M",qe,hr]);for(var Gt=Lr,Nn=jt.length;Gt<Nn;Gt++){var zn=jt[Gt],jn=He[Gt-1],Sn=[],Ae=zn[0],Wn=Ae.toUpperCase();if(Ae!==Wn)switch(Sn[0]=Wn,Wn){case"A":Sn[1]=zn[1],Sn[2]=zn[2],Sn[3]=zn[3],Sn[4]=zn[4],Sn[5]=zn[5],Sn[6]=+zn[6]+qe,Sn[7]=+zn[7]+hr;break;case"V":Sn[1]=+zn[1]+hr;break;case"H":Sn[1]=+zn[1]+qe;break;case"M":tr=+zn[1]+qe,Br=+zn[2]+hr,Sn[1]=tr,Sn[2]=Br;break;default:for(var Rt=1,Wt=zn.length;Rt<Wt;Rt++)Sn[Rt]=+zn[Rt]+(Rt%2?qe:hr)}else Sn=jt[Gt];switch(Wn){case"Z":qe=+tr,hr=+Br;break;case"H":qe=Sn[1],Sn=["L",qe,hr];break;case"V":hr=Sn[1],Sn=["L",qe,hr];break;case"T":qe=Sn[1],hr=Sn[2];var oe=Ee([jn[1],jn[2]],[jn[3],jn[4]]);Sn=["Q",oe[0],oe[1],qe,hr];break;case"S":qe=Sn[Sn.length-2],hr=Sn[Sn.length-1];var Se=jn.length,ze=Ee([jn[Se-4],jn[Se-3]],[jn[Se-2],jn[Se-1]]);Sn=["C",ze[0],ze[1],Sn[1],Sn[2],qe,hr];break;case"M":tr=Sn[Sn.length-2],Br=Sn[Sn.length-1];break;default:qe=Sn[Sn.length-2],hr=Sn[Sn.length-1]}He.push(Sn)}return He}var Mt=Math.PI*2,et=function(gt,jt,ve,Gt,Ae,He,qe){var hr=gt.x,tr=gt.y;hr*=jt,tr*=ve;var Br=Gt*hr-Ae*tr,Lr=Ae*hr+Gt*tr;return{x:Br+He,y:Lr+qe}},Dt=function(gt,jt){var ve=jt===1.5707963267948966?.551915024494:jt===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(jt/4),Gt=Math.cos(gt),Ae=Math.sin(gt),He=Math.cos(gt+jt),qe=Math.sin(gt+jt);return[{x:Gt-Ae*ve,y:Ae+Gt*ve},{x:He+qe*ve,y:qe-He*ve},{x:He,y:qe}]},we=function(gt,jt,ve,Gt){var Ae=gt*Gt-jt*ve<0?-1:1,He=gt*ve+jt*Gt;return He>1&&(He=1),He<-1&&(He=-1),Ae*Math.acos(He)},_e=function(gt,jt,ve,Gt,Ae,He,qe,hr,tr,Br,Lr,Zr){var Tn=Math.pow(Ae,2),rn=Math.pow(He,2),Nn=Math.pow(Lr,2),zn=Math.pow(Zr,2),jn=Tn*rn-Tn*zn-rn*Nn;jn<0&&(jn=0),jn/=Tn*zn+rn*Nn,jn=Math.sqrt(jn)*(qe===hr?-1:1);var Sn=jn*Ae/He*Zr,Wn=jn*-He/Ae*Lr,Rt=Br*Sn-tr*Wn+(gt+ve)/2,Wt=tr*Sn+Br*Wn+(jt+Gt)/2,oe=(Lr-Sn)/Ae,Se=(Zr-Wn)/He,ze=(-Lr-Sn)/Ae,fr=(-Zr-Wn)/He,wr=we(1,0,oe,Se),Le=we(oe,Se,ze,fr);return hr===0&&Le>0&&(Le-=Mt),hr===1&&Le<0&&(Le+=Mt),[Rt,Wt,wr,Le]},ge=function(gt){var jt=gt.px,ve=gt.py,Gt=gt.cx,Ae=gt.cy,He=gt.rx,qe=gt.ry,hr=gt.xAxisRotation,tr=hr===void 0?0:hr,Br=gt.largeArcFlag,Lr=Br===void 0?0:Br,Zr=gt.sweepFlag,Tn=Zr===void 0?0:Zr,rn=[];if(He===0||qe===0)return[{x1:0,y1:0,x2:0,y2:0,x:Gt,y:Ae}];var Nn=Math.sin(tr*Mt/360),zn=Math.cos(tr*Mt/360),jn=zn*(jt-Gt)/2+Nn*(ve-Ae)/2,Sn=-Nn*(jt-Gt)/2+zn*(ve-Ae)/2;if(jn===0&&Sn===0)return[{x1:0,y1:0,x2:0,y2:0,x:Gt,y:Ae}];He=Math.abs(He),qe=Math.abs(qe);var Wn=Math.pow(jn,2)/Math.pow(He,2)+Math.pow(Sn,2)/Math.pow(qe,2);Wn>1&&(He*=Math.sqrt(Wn),qe*=Math.sqrt(Wn));var Rt=_e(jt,ve,Gt,Ae,He,qe,Lr,Tn,Nn,zn,jn,Sn),Wt=Rt[0],oe=Rt[1],Se=Rt[2],ze=Rt[3],fr=Math.abs(ze)/(Mt/4);Math.abs(1-fr)<1e-7&&(fr=1);var wr=Math.max(Math.ceil(fr),1);ze/=wr;for(var Le=0;Le<wr;Le++)rn.push(Dt(Se,ze)),Se+=ze;return rn.map(function(ur){var Wr=et(ur[0],He,qe,zn,Nn,Wt,oe),wn=Wr.x,qr=Wr.y,Qr=et(ur[1],He,qe,zn,Nn,Wt,oe),Mn=Qr.x,bi=Qr.y,wi=et(ur[2],He,qe,zn,Nn,Wt,oe),Kr=wi.x,ai=wi.y;return{x1:wn,y1:qr,x2:Mn,y2:bi,x:Kr,y:ai}})};function te(gt,jt,ve,Gt,Ae,He,qe,hr,tr){var Br=ge({px:gt,py:jt,cx:hr,cy:tr,rx:ve,ry:Gt,xAxisRotation:Ae,largeArcFlag:He,sweepFlag:qe});return Br.reduce(function(Lr,Zr){var Tn=Zr.x1,rn=Zr.y1,Nn=Zr.x2,zn=Zr.y2,jn=Zr.x,Sn=Zr.y;return Lr.push(Tn,rn,Nn,zn,jn,Sn),Lr},[])}function xe(gt,jt){"TQ".indexOf(gt[0])<0&&(jt.qx=null,jt.qy=null);var ve=gt.slice(1),Gt=ve[0],Ae=ve[1];switch(gt[0]){case"M":return jt.x=Gt,jt.y=Ae,gt;case"A":return["C"].concat(arcToCubic.apply(0,[jt.x1,jt.y1].concat(gt.slice(1))));case"Q":return jt.qx=Gt,jt.qy=Ae,["C"].concat(quadToCubic.apply(0,[jt.x1,jt.y1].concat(gt.slice(1))));case"L":return["C"].concat(lineToCubic(jt.x1,jt.y1,gt[1],gt[2]));case"H":return["C"].concat(lineToCubic(jt.x1,jt.y1,gt[1],jt.y1));case"V":return["C"].concat(lineToCubic(jt.x1,jt.y1,jt.x1,gt[1]));case"Z":return["C"].concat(lineToCubic(jt.x1,jt.y1,jt.x,jt.y));default:}return gt}function Ye(gt,jt){jt===void 0&&(jt=!1);for(var ve=path2Absolute(gt),Gt={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},Ae=[],He="",qe=ve.length,hr,tr,Br=[],Lr=0;Lr<qe;Lr+=1)ve[Lr]&&(He=ve[Lr][0]),Ae[Lr]=He,ve[Lr]=segmentToCubic(ve[Lr],Gt),Lt(ve,Ae,Lr),qe=ve.length,He==="Z"&&Br.push(Lr),hr=ve[Lr],tr=hr.length,Gt.x1=+hr[tr-2],Gt.y1=+hr[tr-1],Gt.x2=+hr[tr-4]||Gt.x1,Gt.y2=+hr[tr-3]||Gt.y1;return jt?[ve,Br]:ve}function Lt(gt,jt,ve){if(gt[ve].length>7){gt[ve].shift();for(var Gt=gt[ve],Ae=ve;Gt.length;)jt[ve]="A",gt.splice(Ae+=1,0,["C"].concat(Gt.splice(0,6)));gt.splice(ve,1)}}var Qt=function(gt,jt,ve,Gt,Ae){var He=-3*jt+9*ve-9*Gt+3*Ae,qe=gt*He+6*jt-12*ve+6*Gt;return gt*qe-3*jt+3*ve},ct=function(gt,jt,ve,Gt,Ae,He,qe,hr,tr){tr===null&&(tr=1),tr=tr>1?1:tr<0?0:tr;for(var Br=tr/2,Lr=12,Zr=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],Tn=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],rn=0,Nn=0;Nn<Lr;Nn++){var zn=Br*Zr[Nn]+Br,jn=Qt(zn,gt,ve,Ae,qe),Sn=Qt(zn,jt,Gt,He,hr),Wn=jn*jn+Sn*Sn;rn+=Tn[Nn]*Math.sqrt(Wn)}return Br*rn},Ct=function(gt,jt,ve,Gt,Ae,He,qe,hr){for(var tr=[],Br=[[],[]],Lr,Zr,Tn,rn,Nn=0;Nn<2;++Nn){if(Nn===0?(Zr=6*gt-12*ve+6*Ae,Lr=-3*gt+9*ve-9*Ae+3*qe,Tn=3*ve-3*gt):(Zr=6*jt-12*Gt+6*He,Lr=-3*jt+9*Gt-9*He+3*hr,Tn=3*Gt-3*jt),Math.abs(Lr)<1e-12){if(Math.abs(Zr)<1e-12)continue;rn=-Tn/Zr,rn>0&&rn<1&&tr.push(rn);continue}var zn=Zr*Zr-4*Tn*Lr,jn=Math.sqrt(zn);if(!(zn<0)){var Sn=(-Zr+jn)/(2*Lr);Sn>0&&Sn<1&&tr.push(Sn);var Wn=(-Zr-jn)/(2*Lr);Wn>0&&Wn<1&&tr.push(Wn)}}for(var Rt=tr.length,Wt=Rt,oe;Rt--;)rn=tr[Rt],oe=1-rn,Br[0][Rt]=oe*oe*oe*gt+3*oe*oe*rn*ve+3*oe*rn*rn*Ae+rn*rn*rn*qe,Br[1][Rt]=oe*oe*oe*jt+3*oe*oe*rn*Gt+3*oe*rn*rn*He+rn*rn*rn*hr;return Br[0][Wt]=gt,Br[1][Wt]=jt,Br[0][Wt+1]=qe,Br[1][Wt+1]=hr,Br[0].length=Br[1].length=Wt+2,{min:{x:Math.min.apply(0,Br[0]),y:Math.min.apply(0,Br[1])},max:{x:Math.max.apply(0,Br[0]),y:Math.max.apply(0,Br[1])}}},Y=function(gt,jt,ve,Gt,Ae,He,qe,hr){if(!(Math.max(gt,ve)<Math.min(Ae,qe)||Math.min(gt,ve)>Math.max(Ae,qe)||Math.max(jt,Gt)<Math.min(He,hr)||Math.min(jt,Gt)>Math.max(He,hr))){var tr=(gt*Gt-jt*ve)*(Ae-qe)-(gt-ve)*(Ae*hr-He*qe),Br=(gt*Gt-jt*ve)*(He-hr)-(jt-Gt)*(Ae*hr-He*qe),Lr=(gt-ve)*(He-hr)-(jt-Gt)*(Ae-qe);if(!!Lr){var Zr=tr/Lr,Tn=Br/Lr,rn=+Zr.toFixed(2),Nn=+Tn.toFixed(2);if(!(rn<+Math.min(gt,ve).toFixed(2)||rn>+Math.max(gt,ve).toFixed(2)||rn<+Math.min(Ae,qe).toFixed(2)||rn>+Math.max(Ae,qe).toFixed(2)||Nn<+Math.min(jt,Gt).toFixed(2)||Nn>+Math.max(jt,Gt).toFixed(2)||Nn<+Math.min(He,hr).toFixed(2)||Nn>+Math.max(He,hr).toFixed(2)))return{x:Zr,y:Tn}}}},yt=function(gt,jt,ve){return jt>=gt.x&&jt<=gt.x+gt.width&&ve>=gt.y&&ve<=gt.y+gt.height},Xt=function(gt,jt,ve,Gt){return gt===null&&(gt=jt=ve=Gt=0),jt===null&&(jt=gt.y,ve=gt.width,Gt=gt.height,gt=gt.x),{x:gt,y:jt,width:ve,w:ve,height:Gt,h:Gt,x2:gt+ve,y2:jt+Gt,cx:gt+ve/2,cy:jt+Gt/2,r1:Math.min(ve,Gt)/2,r2:Math.max(ve,Gt)/2,r0:Math.sqrt(ve*ve+Gt*Gt)/2,path:rectPath(gt,jt,ve,Gt),vb:[gt,jt,ve,Gt].join(" ")}},ie=function(gt,jt){return gt=Xt(gt),jt=Xt(jt),yt(jt,gt.x,gt.y)||yt(jt,gt.x2,gt.y)||yt(jt,gt.x,gt.y2)||yt(jt,gt.x2,gt.y2)||yt(gt,jt.x,jt.y)||yt(gt,jt.x2,jt.y)||yt(gt,jt.x,jt.y2)||yt(gt,jt.x2,jt.y2)||(gt.x<jt.x2&&gt.x>jt.x||jt.x<gt.x2&&jt.x>gt.x)&&(gt.y<jt.y2&&gt.y>jt.y||jt.y<gt.y2&&jt.y>gt.y)},Ce=function(gt,jt,ve,Gt,Ae,He,qe,hr){isArray(gt)||(gt=[gt,jt,ve,Gt,Ae,He,qe,hr]);var tr=Ct.apply(null,gt);return Xt(tr.min.x,tr.min.y,tr.max.x-tr.min.x,tr.max.y-tr.min.y)},er=function(gt,jt,ve,Gt,Ae,He,qe,hr,tr){var Br=1-tr,Lr=Math.pow(Br,3),Zr=Math.pow(Br,2),Tn=tr*tr,rn=Tn*tr,Nn=Lr*gt+Zr*3*tr*ve+Br*3*tr*tr*Ae+rn*qe,zn=Lr*jt+Zr*3*tr*Gt+Br*3*tr*tr*He+rn*hr,jn=gt+2*tr*(ve-gt)+Tn*(Ae-2*ve+gt),Sn=jt+2*tr*(Gt-jt)+Tn*(He-2*Gt+jt),Wn=ve+2*tr*(Ae-ve)+Tn*(qe-2*Ae+ve),Rt=Gt+2*tr*(He-Gt)+Tn*(hr-2*He+Gt),Wt=Br*gt+tr*ve,oe=Br*jt+tr*Gt,Se=Br*Ae+tr*qe,ze=Br*He+tr*hr,fr=90-Math.atan2(jn-Wn,Sn-Rt)*180/Math.PI;return{x:Nn,y:zn,m:{x:jn,y:Sn},n:{x:Wn,y:Rt},start:{x:Wt,y:oe},end:{x:Se,y:ze},alpha:fr}},Ht=function(gt,jt,ve){var Gt=Ce(gt),Ae=Ce(jt);if(!ie(Gt,Ae))return ve?0:[];for(var He=ct.apply(0,gt),qe=ct.apply(0,jt),hr=~~(He/8),tr=~~(qe/8),Br=[],Lr=[],Zr={},Tn=ve?0:[],rn=0;rn<hr+1;rn++){var Nn=er.apply(0,gt.concat(rn/hr));Br.push({x:Nn.x,y:Nn.y,t:rn/hr})}for(var rn=0;rn<tr+1;rn++){var Nn=er.apply(0,jt.concat(rn/tr));Lr.push({x:Nn.x,y:Nn.y,t:rn/tr})}for(var rn=0;rn<hr;rn++)for(var zn=0;zn<tr;zn++){var jn=Br[rn],Sn=Br[rn+1],Wn=Lr[zn],Rt=Lr[zn+1],Wt=Math.abs(Sn.x-jn.x)<.001?"y":"x",oe=Math.abs(Rt.x-Wn.x)<.001?"y":"x",Se=Y(jn.x,jn.y,Sn.x,Sn.y,Wn.x,Wn.y,Rt.x,Rt.y);if(Se){if(Zr[Se.x.toFixed(4)]===Se.y.toFixed(4))continue;Zr[Se.x.toFixed(4)]=Se.y.toFixed(4);var ze=jn.t+Math.abs((Se[Wt]-jn[Wt])/(Sn[Wt]-jn[Wt]))*(Sn.t-jn.t),fr=Wn.t+Math.abs((Se[oe]-Wn[oe])/(Rt[oe]-Wn[oe]))*(Rt.t-Wn.t);ze>=0&&ze<=1&&fr>=0&&fr<=1&&(ve?Tn++:Tn.push({x:Se.x,y:Se.y,t1:ze,t2:fr}))}}return Tn},ne=function(gt,jt,ve){gt=path2Curve(gt),jt=path2Curve(jt);for(var Gt,Ae,He,qe,hr,tr,Br,Lr,Zr,Tn,rn=ve?0:[],Nn=0,zn=gt.length;Nn<zn;Nn++){var jn=gt[Nn];if(jn[0]==="M")Gt=hr=jn[1],Ae=tr=jn[2];else{jn[0]==="C"?(Zr=[Gt,Ae].concat(jn.slice(1)),Gt=Zr[6],Ae=Zr[7]):(Zr=[Gt,Ae,Gt,Ae,hr,tr,hr,tr],Gt=hr,Ae=tr);for(var Sn=0,Wn=jt.length;Sn<Wn;Sn++){var Rt=jt[Sn];if(Rt[0]==="M")He=Br=Rt[1],qe=Lr=Rt[2];else{Rt[0]==="C"?(Tn=[He,qe].concat(Rt.slice(1)),He=Tn[6],qe=Tn[7]):(Tn=[He,qe,He,qe,Br,Lr,Br,Lr],He=Br,qe=Lr);var Wt=Ht(Zr,Tn,ve);if(ve)rn+=Wt;else{for(var oe=0,Se=Wt.length;oe<Se;oe++)Wt[oe].segment1=Nn,Wt[oe].segment2=Sn,Wt[oe].bez1=Zr,Wt[oe].bez2=Tn;rn=rn.concat(Wt)}}}}}return rn};function Me(gt,jt){return ne(gt,jt)}function ae(gt){return Math.sqrt(gt[0]*gt[0]+gt[1]*gt[1])}function Je(gt,jt){return ae(gt)*ae(jt)?(gt[0]*jt[0]+gt[1]*jt[1])/(ae(gt)*ae(jt)):1}function or(gt,jt){return(gt[0]*jt[1]<gt[1]*jt[0]?-1:1)*Math.acos(Je(gt,jt))}function re(gt,jt){return gt[0]===jt[0]&&gt[1]===jt[1]}function Jt(gt,jt){var ve=jt[1],Gt=jt[2],Ae=(0,kt.wQ)((0,kt.c$)(jt[3]),Math.PI*2),He=jt[4],qe=jt[5],hr=gt[0],tr=gt[1],Br=jt[6],Lr=jt[7],Zr=Math.cos(Ae)*(hr-Br)/2+Math.sin(Ae)*(tr-Lr)/2,Tn=-1*Math.sin(Ae)*(hr-Br)/2+Math.cos(Ae)*(tr-Lr)/2,rn=Zr*Zr/(ve*ve)+Tn*Tn/(Gt*Gt);rn>1&&(ve*=Math.sqrt(rn),Gt*=Math.sqrt(rn));var Nn=ve*ve*(Tn*Tn)+Gt*Gt*(Zr*Zr),zn=Nn?Math.sqrt((ve*ve*(Gt*Gt)-Nn)/Nn):1;He===qe&&(zn*=-1),isNaN(zn)&&(zn=0);var jn=Gt?zn*ve*Tn/Gt:0,Sn=ve?zn*-Gt*Zr/ve:0,Wn=(hr+Br)/2+Math.cos(Ae)*jn-Math.sin(Ae)*Sn,Rt=(tr+Lr)/2+Math.sin(Ae)*jn+Math.cos(Ae)*Sn,Wt=[(Zr-jn)/ve,(Tn-Sn)/Gt],oe=[(-1*Zr-jn)/ve,(-1*Tn-Sn)/Gt],Se=or([1,0],Wt),ze=or(Wt,oe);return Je(Wt,oe)<=-1&&(ze=Math.PI),Je(Wt,oe)>=1&&(ze=0),qe===0&&ze>0&&(ze=ze-2*Math.PI),qe===1&&ze<0&&(ze=ze+2*Math.PI),{cx:Wn,cy:Rt,rx:re(gt,[Br,Lr])?0:ve,ry:re(gt,[Br,Lr])?0:Gt,startAngle:Se,endAngle:Se+ze,xRotation:Ae,arcFlag:He,sweepFlag:qe}}function Et(gt,jt){return[jt[0]+(jt[0]-gt[0]),jt[1]+(jt[1]-gt[1])]}function $t(gt){gt=K(gt);for(var jt=[],ve=null,Gt=null,Ae=null,He=0,qe=gt.length,hr=0;hr<qe;hr++){var tr=gt[hr];Gt=gt[hr+1];var Br=tr[0],Lr={command:Br,prePoint:ve,params:tr,startTangent:null,endTangent:null};switch(Br){case"M":Ae=[tr[1],tr[2]],He=hr;break;case"A":var Zr=Jt(ve,tr);Lr.arcParams=Zr;break;default:break}if(Br==="Z")ve=Ae,Gt=gt[He+1];else{var Tn=tr.length;ve=[tr[Tn-2],tr[Tn-1]]}Gt&&Gt[0]==="Z"&&(Gt=gt[He],jt[He]&&(jt[He].prePoint=ve)),Lr.currentPoint=ve,jt[He]&&re(ve,jt[He].currentPoint)&&(jt[He].prePoint=Lr.prePoint);var rn=Gt?[Gt[Gt.length-2],Gt[Gt.length-1]]:null;Lr.nextPoint=rn;var Nn=Lr.prePoint;if(["L","H","V"].includes(Br))Lr.startTangent=[Nn[0]-ve[0],Nn[1]-ve[1]],Lr.endTangent=[ve[0]-Nn[0],ve[1]-Nn[1]];else if(Br==="Q"){var zn=[tr[1],tr[2]];Lr.startTangent=[Nn[0]-zn[0],Nn[1]-zn[1]],Lr.endTangent=[ve[0]-zn[0],ve[1]-zn[1]]}else if(Br==="T"){var jn=jt[hr-1],zn=Et(jn.currentPoint,Nn);jn.command==="Q"?(Lr.command="Q",Lr.startTangent=[Nn[0]-zn[0],Nn[1]-zn[1]],Lr.endTangent=[ve[0]-zn[0],ve[1]-zn[1]]):(Lr.command="TL",Lr.startTangent=[Nn[0]-ve[0],Nn[1]-ve[1]],Lr.endTangent=[ve[0]-Nn[0],ve[1]-Nn[1]])}else if(Br==="C"){var Sn=[tr[1],tr[2]],Wn=[tr[3],tr[4]];Lr.startTangent=[Nn[0]-Sn[0],Nn[1]-Sn[1]],Lr.endTangent=[ve[0]-Wn[0],ve[1]-Wn[1]],Lr.startTangent[0]===0&&Lr.startTangent[1]===0&&(Lr.startTangent=[Sn[0]-Wn[0],Sn[1]-Wn[1]]),Lr.endTangent[0]===0&&Lr.endTangent[1]===0&&(Lr.endTangent=[Wn[0]-Sn[0],Wn[1]-Sn[1]])}else if(Br==="S"){var jn=jt[hr-1],Sn=Et(jn.currentPoint,Nn),Wn=[tr[1],tr[2]];jn.command==="C"?(Lr.command="C",Lr.startTangent=[Nn[0]-Sn[0],Nn[1]-Sn[1]],Lr.endTangent=[ve[0]-Wn[0],ve[1]-Wn[1]]):(Lr.command="SQ",Lr.startTangent=[Nn[0]-Wn[0],Nn[1]-Wn[1]],Lr.endTangent=[ve[0]-Wn[0],ve[1]-Wn[1]])}else if(Br==="A"){var Rt=.001,Wt=Lr.arcParams||{},oe=Wt.cx,Se=oe===void 0?0:oe,ze=Wt.cy,fr=ze===void 0?0:ze,wr=Wt.rx,Le=wr===void 0?0:wr,ur=Wt.ry,Wr=ur===void 0?0:ur,wn=Wt.sweepFlag,qr=wn===void 0?0:wn,Qr=Wt.startAngle,Mn=Qr===void 0?0:Qr,bi=Wt.endAngle,wi=bi===void 0?0:bi;qr===0&&(Rt*=-1);var Kr=Le*Math.cos(Mn-Rt)+Se,ai=Wr*Math.sin(Mn-Rt)+fr;Lr.startTangent=[Kr-Ae[0],ai-Ae[1]];var li=Le*Math.cos(Mn+wi+Rt)+Se,hi=Wr*Math.sin(Mn+wi-Rt)+fr;Lr.endTangent=[Nn[0]-li,Nn[1]-hi]}jt.push(Lr)}return jt}var Yt=1e-6;function St(gt){return Math.abs(gt)<Yt?0:gt<0?-1:1}function At(gt,jt,ve){return(ve[0]-gt[0])*(jt[1]-gt[1])===(jt[0]-gt[0])*(ve[1]-gt[1])&&Math.min(gt[0],jt[0])<=ve[0]&&ve[0]<=Math.max(gt[0],jt[0])&&Math.min(gt[1],jt[1])<=ve[1]&&ve[1]<=Math.max(gt[1],jt[1])}function ue(gt,jt,ve){var Gt=!1,Ae=gt.length;if(Ae<=2)return!1;for(var He=0;He<Ae;He++){var qe=gt[He],hr=gt[(He+1)%Ae];if(At(qe,hr,[jt,ve]))return!0;St(qe[1]-ve)>0!=St(hr[1]-ve)>0&&St(jt-(ve-qe[1])*(qe[0]-hr[0])/(qe[1]-hr[1])-qe[0])<0&&(Gt=!Gt)}return Gt}var Pe=function(gt,jt,ve){return gt>=jt&&gt<=ve};function je(gt,jt,ve,Gt){var Ae=.001,He={x:ve.x-gt.x,y:ve.y-gt.y},qe={x:jt.x-gt.x,y:jt.y-gt.y},hr={x:Gt.x-ve.x,y:Gt.y-ve.y},tr=qe.x*hr.y-qe.y*hr.x,Br=tr*tr,Lr=qe.x*qe.x+qe.y*qe.y,Zr=hr.x*hr.x+hr.y*hr.y,Tn=null;if(Br>Ae*Lr*Zr){var rn=(He.x*hr.y-He.y*hr.x)/tr,Nn=(He.x*qe.y-He.y*qe.x)/tr;Pe(rn,0,1)&&Pe(Nn,0,1)&&(Tn={x:gt.x+rn*qe.x,y:gt.y+rn*qe.y})}return Tn}function Nt(gt){for(var jt=[],ve=gt.length,Gt=0;Gt<ve-1;Gt++){var Ae=gt[Gt],He=gt[Gt+1];jt.push({from:{x:Ae[0],y:Ae[1]},to:{x:He[0],y:He[1]}})}if(jt.length>1){var qe=gt[0],hr=gt[ve-1];jt.push({from:{x:hr[0],y:hr[1]},to:{x:qe[0],y:qe[1]}})}return jt}function wt(gt,jt){var ve=!1;return(0,kt.S6)(gt,function(Gt){if(je(Gt.from,Gt.to,jt.from,jt.to))return ve=!0,!1}),ve}function Tt(gt){var jt=gt.map(function(Gt){return Gt[0]}),ve=gt.map(function(Gt){return Gt[1]});return{minX:Math.min.apply(null,jt),maxX:Math.max.apply(null,jt),minY:Math.min.apply(null,ve),maxY:Math.max.apply(null,ve)}}function Ft(gt,jt){return!(jt.minX>gt.maxX||jt.maxX<gt.minX||jt.minY>gt.maxY||jt.maxY<gt.minY)}function J(gt,jt){if(gt.length<2||jt.length<2)return!1;var ve=Tt(gt),Gt=Tt(jt);if(!Ft(ve,Gt))return!1;var Ae=!1;if((0,kt.S6)(jt,function(tr){if(ue(gt,tr[0],tr[1]))return Ae=!0,!1}),Ae||((0,kt.S6)(gt,function(tr){if(ue(jt,tr[0],tr[1]))return Ae=!0,!1}),Ae))return!0;var He=Nt(gt),qe=Nt(jt),hr=!1;return(0,kt.S6)(qe,function(tr){if(wt(He,tr))return hr=!0,!1}),hr}},45098:function(gn,Ot,ot){"use strict";ot.d(Ot,{Ct:function(){return Yl},f0:function(){return Vr},uZ:function(){return Rt},VS:function(){return Hs},d9:function(){return Ou},FX:function(){return xt},Ds:function(){return nu},b$:function(){return Uc},e5:function(){return lt},S6:function(){return Ee},yW:function(){return He},hX:function(){return ut},sE:function(){return Ye},cx:function(){return Qt},Wx:function(){return Ct},ri:function(){return oe},xH:function(){return yt},U5:function(){return vo},U2:function(){return Ln},Lo:function(){return Vc},rx:function(){return ne},ru:function(){return Tn},vM:function(){return Lr},Ms:function(){return Zr},wH:function(){return to},YM:function(){return Ft},q9:function(){return xt},cq:function(){return sc},kJ:function(){return b},jn:function(){return ns},J_:function(){return Go},kK:function(){return Ho},xb:function(){return uc},Xy:function(){return X},mf:function(){return st},BD:function(){return Dt},UM:function(){return P},Ft:function(){return Wu},hj:function(){return ze},vQ:function(){return bi},Kn:function(){return W},PO:function(){return te},HD:function(){return Pe},P9:function(){return it},o8:function(){return Ma},XP:function(){return Mt},Z$:function(){return J},vl:function(){return ye},UI:function(){return se},Q8:function(){return Sr},Fp:function(){return Ce},UT:function(){return hi},HP:function(){return dl},VV:function(){return er},F:function(){return ra},CD:function(){return Vr},wQ:function(){return Ba},ZT:function(){return gs},CE:function(){return ba},ei:function(){return Pa},u4:function(){return St},Od:function(){return ue},U7:function(){return qo},t8:function(){return Gn},dp:function(){return xu},G:function(){return hr},MR:function(){return Nt},ng:function(){return Mr},P2:function(){return uo},qo:function(){return Ca},c$:function(){return Vo},BB:function(){return bo},jj:function(){return wt},EL:function(){return qa},jC:function(){return In},VO:function(){return ju},I:function(){return Tt}});var kt=function(me){return me!==null&&typeof me!="function"&&isFinite(me.length)},bt=kt,I=function(me,ir){return bt(me)?me.indexOf(ir)>-1:!1},xt=I,K=function(me,ir){if(!bt(me))return me;for(var Or=[],$r=0;$r<me.length;$r++){var xn=me[$r];ir(xn,$r)&&Or.push(xn)}return Or},ut=K,ht=function(me,ir){return ir===void 0&&(ir=[]),ut(me,function(Or){return!xt(ir,Or)})},lt=ht,tt={}.toString,be=function(me,ir){return tt.call(me)==="[object "+ir+"]"},it=be,st=function(me){return it(me,"Function")},Ut=function(me){return me==null},P=Ut,b=function(me){return Array.isArray?Array.isArray(me):it(me,"Array")},W=function(me){var ir=typeof me;return me!==null&&ir==="object"||ir==="function"};function fe(me,ir){if(!!me){var Or;if(b(me))for(var $r=0,xn=me.length;$r<xn&&(Or=ir(me[$r],$r),Or!==!1);$r++);else if(W(me)){for(var _i in me)if(me.hasOwnProperty(_i)&&(Or=ir(me[_i],_i),Or===!1))break}}}var Ee=fe,Te=Object.keys?function(me){return Object.keys(me)}:function(me){var ir=[];return Ee(me,function(Or,$r){st(me)&&$r==="prototype"||ir.push($r)}),ir},Mt=Te;function et(me,ir){var Or=Mt(ir),$r=Or.length;if(P(me))return!$r;for(var xn=0;xn<$r;xn+=1){var _i=Or[xn];if(ir[_i]!==me[_i]||!(_i in me))return!1}return!0}var Dt=et,we=function(me){return typeof me=="object"&&me!==null},_e=we,ge=function(me){if(!_e(me)||!it(me,"Object"))return!1;if(Object.getPrototypeOf(me)===null)return!0;for(var ir=me;Object.getPrototypeOf(ir)!==null;)ir=Object.getPrototypeOf(ir);return Object.getPrototypeOf(me)===ir},te=ge;function xe(me,ir){if(!b(me))return null;var Or;if(st(ir)&&(Or=ir),te(ir)&&(Or=function(xn){return Dt(xn,ir)}),Or){for(var $r=0;$r<me.length;$r+=1)if(Or(me[$r]))return me[$r]}return null}var Ye=xe;function Lt(me,ir,Or){Or===void 0&&(Or=0);for(var $r=Or;$r<me.length;$r++)if(ir(me[$r],$r))return $r;return-1}var Qt=Lt,ct=function(me,ir){for(var Or=null,$r=0;$r<me.length;$r++){var xn=me[$r],_i=xn[ir];if(!P(_i)){b(_i)?Or=_i[0]:Or=_i;break}}return Or},Ct=ct,Y=function(me){if(!b(me))return[];for(var ir=[],Or=0;Or<me.length;Or++)ir=ir.concat(me[Or]);return ir},yt=Y,Xt=function(me,ir){if(ir===void 0&&(ir=[]),!isArray(me))ir.push(me);else for(var Or=0;Or<me.length;Or+=1)Xt(me[Or],ir);return ir},ie=null,Ce=function(me){if(!!b(me))return me.reduce(function(ir,Or){return Math.max(ir,Or)},me[0])},er=function(me){if(!!b(me))return me.reduce(function(ir,Or){return Math.min(ir,Or)},me[0])},Ht=function(me){var ir=me.filter(function(qi){return!isNaN(qi)});if(!ir.length)return{min:0,max:0};if(b(me[0])){for(var Or=[],$r=0;$r<me.length;$r++)Or=Or.concat(me[$r]);ir=Or}var xn=Ce(ir),_i=er(ir);return{min:_i,max:xn}},ne=Ht,Me=Array.prototype,ae=Me.splice,Je=Me.indexOf,or=function(me){for(var ir=[],Or=1;Or<arguments.length;Or++)ir[Or-1]=arguments[Or];for(var $r=0;$r<ir.length;$r++)for(var xn=ir[$r],_i=-1;(_i=Je.call(me,xn))>-1;)ae.call(me,_i,1);return me},re=null,Jt=Array.prototype.splice,Et=function(ir,Or){if(!bt(ir))return[];for(var $r=ir?Or.length:0,xn=$r-1;$r--;){var _i=void 0,qi=Or[$r];($r===xn||qi!==_i)&&(_i=qi,Jt.call(ir,qi,1))}return ir},$t=Et,Yt=function(me,ir,Or){if(!b(me)&&!te(me))return me;var $r=Or;return Ee(me,function(xn,_i){$r=ir($r,xn,_i)}),$r},St=Yt,At=function(me,ir){var Or=[];if(!bt(me))return Or;for(var $r=-1,xn=[],_i=me.length;++$r<_i;){var qi=me[$r];ir(qi,$r,me)&&(Or.push(qi),xn.push($r))}return $t(me,xn),Or},ue=At,Pe=function(me){return it(me,"String")};function je(me,ir){var Or;if(st(ir))Or=function(xn,_i){return ir(xn)-ir(_i)};else{var $r=[];Pe(ir)?$r.push(ir):b(ir)&&($r=ir),Or=function(xn,_i){for(var qi=0;qi<$r.length;qi+=1){var Ia=$r[qi];if(xn[Ia]>_i[Ia])return 1;if(xn[Ia]<_i[Ia])return-1}return 0}}return me.sort(Or),me}var Nt=je;function wt(me,ir){ir===void 0&&(ir=new Map);var Or=[];if(Array.isArray(me))for(var $r=0,xn=me.length;$r<xn;$r++){var _i=me[$r];ir.has(_i)||(Or.push(_i),ir.set(_i,!0))}return Or}var Tt=function(me,ir){for(var Or=[],$r={},xn=0;xn<me.length;xn++){var _i=me[xn],qi=_i[ir];if(!P(qi)){b(qi)||(qi=[qi]);for(var Ia=0;Ia<qi.length;Ia++){var du=qi[Ia];$r[du]||(Or.push(du),$r[du]=!0)}}}return Or};function Ft(me){if(bt(me))return me[0]}function J(me){if(bt(me)){var ir=me;return ir[ir.length-1]}}function gt(me,ir){return isArray(me)||isString(me)?me[0]===ir:!1}var jt=null;function ve(me,ir){return isArray(me)||isString(me)?me[me.length-1]===ir:!1}var Gt=null,Ae=function(me,ir){for(var Or=0;Or<me.length;Or++)if(!ir(me[Or],Or))return!1;return!0},He=Ae,qe=function(me,ir){for(var Or=0;Or<me.length;Or++)if(ir(me[Or],Or))return!0;return!1},hr=qe,tr=Object.prototype.hasOwnProperty;function Br(me,ir){if(!ir||!b(me))return{};for(var Or={},$r=st(ir)?ir:function(Ia){return Ia[ir]},xn,_i=0;_i<me.length;_i++){var qi=me[_i];xn=$r(qi),tr.call(Or,xn)?Or[xn].push(qi):Or[xn]=[qi]}return Or}var Lr=Br;function Zr(me,ir){if(!ir)return{0:me};if(!st(ir)){var Or=b(ir)?ir:ir.replace(/\s+/g,"").split("*");ir=function($r){for(var xn="_",_i=0,qi=Or.length;_i<qi;_i++)xn+=$r[Or[_i]]&&$r[Or[_i]].toString();return xn}}return Lr(me,ir)}var Tn=function(me,ir){if(!ir)return[me];var Or=Zr(me,ir),$r=[];for(var xn in Or)$r.push(Or[xn]);return $r},rn={};function Nn(me){var ir=rn[me];if(!ir){for(var Or=me.toString(16),$r=Or.length;$r<6;$r++)Or="0"+Or;ir="#"+Or,rn[me]=ir}return ir}var zn=null;function jn(me){var ir=0,Or=0,$r=0,xn=0;return isArray(me)?me.length===1?ir=Or=$r=xn=me[0]:me.length===2?(ir=$r=me[0],Or=xn=me[1]):me.length===3?(ir=me[0],Or=xn=me[1],$r=me[2]):(ir=me[0],Or=me[1],$r=me[2],xn=me[3]):ir=Or=$r=xn=me,{r1:ir,r2:Or,r3:$r,r4:xn}}var Sn=null,Wn=function(me,ir,Or){return me<ir?ir:me>Or?Or:me},Rt=Wn,Wt=function(me,ir){var Or=ir.toString(),$r=Or.indexOf(".");if($r===-1)return Math.round(me);var xn=Or.substr($r+1).length;return xn>20&&(xn=20),parseFloat(me.toFixed(xn))},oe=Wt,Se=function(me){return it(me,"Number")},ze=Se,fr=function(me){return isNumber(me)&&me%1!==0},wr=null,Le=function(me){return isNumber(me)&&me%2===0},ur=null,Wr=Number.isInteger?Number.isInteger:function(me){return ze(me)&&me%1===0},wn=null,qr=function(me){return isNumber(me)&&me<0},Qr=null,Mn=1e-5;function bi(me,ir,Or){return Or===void 0&&(Or=Mn),Math.abs(me-ir)<Or}var wi=function(me){return isNumber(me)&&me%2!==0},Kr=null,ai=function(me){return isNumber(me)&&me>0},li=null,hi=function(me,ir){if(!!b(me)){for(var Or,$r=-1/0,xn=0;xn<me.length;xn++){var _i=me[xn],qi=st(ir)?ir(_i):_i[ir];qi>$r&&(Or=_i,$r=qi)}return Or}},ra=function(me,ir){if(!!b(me)){for(var Or,$r=1/0,xn=0;xn<me.length;xn++){var _i=me[xn],qi=st(ir)?ir(_i):_i[ir];qi<$r&&(Or=_i,$r=qi)}return Or}},Ci=function(me,ir){return(me%ir+ir)%ir},Ba=Ci,po=180/Math.PI,za=function(me){return po*me},Xa=null,Ta=parseInt,ga=Math.PI/180,no=function(me){return ga*me},Vo=no,vo=Ee,ja=function(me,ir){return me.hasOwnProperty(ir)},to=ja,Uo=Object.values?function(me){return Object.values(me)}:function(me){var ir=[];return Ee(me,function(Or,$r){st(me)&&$r==="prototype"||ir.push(Or)}),ir},ju=Uo,Wo=function(me,ir){return contains(values(me),ir)},bo=function(me){return P(me)?"":me.toString()},nr=function(me){return bo(me).toLowerCase()},ye=nr;function Ge(me,ir){return!me||!ir?me:me.replace(/\\?\{([^{}]+)\}/g,function(Or,$r){return Or.charAt(0)==="\\"?Or.slice(1):ir[$r]===void 0?"":ir[$r]})}var Mr=Ge,tn=function(me){var ir=bo(me);return ir.charAt(0).toUpperCase()+ir.substring(1)},In=tn,Un={}.toString,Cn=function(me){return Un.call(me).replace(/^\[object /,"").replace(/]$/,"")},ta=Cn,Wa=function(me){return isType(me,"Arguments")},es=null,ko=function(me){return it(me,"Boolean")},ns=ko,Ya=function(me){return it(me,"Date")},Go=Ya,pu=function(me){return isType(me,"Error")},ys=null;function Rl(me){return isNumber(me)&&isFinite(me)}var mf=function(me){return me===null},Wu=mf,Ie=Object.prototype,We=function(me){var ir=me&&me.constructor,Or=typeof ir=="function"&&ir.prototype||Ie;return me===Or},Tr=We,un=function(me){return isType(me,"RegExp")},si=null,ji=function(me){return me===void 0},Ma=ji,ds=function(me){return me instanceof Element||me instanceof HTMLDocument},Ho=ds;function qo(me){var ir=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(Or){return setTimeout(Or,16)};return ir(me)}function Hs(me){var ir=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;ir(me)}var Xu=function(){for(var me=[],ir=0;ir<arguments.length;ir++)me[ir]=arguments[ir];for(var Or=me[0],$r=1;$r<me.length;$r++){var xn=me[$r];isFunction(xn)&&(xn=xn.prototype),mix(Or.prototype,xn)}},_s=null,vs=function(me){if(typeof me!="object"||me===null)return me;var ir;if(b(me)){ir=[];for(var Or=0,$r=me.length;Or<$r;Or++)typeof me[Or]=="object"&&me[Or]!=null?ir[Or]=vs(me[Or]):ir[Or]=me[Or]}else{ir={};for(var xn in me)typeof me[xn]=="object"&&me[xn]!=null?ir[xn]=vs(me[xn]):ir[xn]=me[xn]}return ir},Ou=vs;function rl(me,ir,Or){var $r;return function(){var xn=this,_i=arguments,qi=function(){$r=null,Or||me.apply(xn,_i)},Ia=Or&&!$r;clearTimeout($r),$r=setTimeout(qi,ir),Ia&&me.apply(xn,_i)}}var nu=rl,dl=function(me,ir){if(!st(me))throw new TypeError("Expected a function");var Or=function(){for(var $r=[],xn=0;xn<arguments.length;xn++)$r[xn]=arguments[xn];var _i=ir?ir.apply(this,$r):$r[0],qi=Or.cache;if(qi.has(_i))return qi.get(_i);var Ia=me.apply(this,$r);return qi.set(_i,Ia),Ia};return Or.cache=new Map,Or},Fu=5;function Fo(me,ir,Or,$r){Or=Or||0,$r=$r||Fu;for(var xn in ir)if(ir.hasOwnProperty(xn)){var _i=ir[xn];_i!==null&&te(_i)?(te(me[xn])||(me[xn]={}),Or<$r?Fo(me[xn],_i,Or+1,$r):me[xn]=ir[xn]):b(_i)?(me[xn]=[],me[xn]=me[xn].concat(_i)):_i!==void 0&&(me[xn]=_i)}}var rs=function(me){for(var ir=[],Or=1;Or<arguments.length;Or++)ir[Or-1]=arguments[Or];for(var $r=0;$r<ir.length;$r+=1)Fo(me,ir[$r]);return me},Uc=rs,_u=function(me,ir,Or,$r){isFunction(ir)||(Or=ir,ir=me,me=function(){});var xn=Object.create?function(qi,Ia){return Object.create(qi,{constructor:{value:Ia}})}:function(qi,Ia){function du(){}du.prototype=qi;var qs=new du;return qs.constructor=Ia,qs},_i=xn(ir.prototype,me);return me.prototype=mix(_i,me.prototype),me.superclass=xn(ir.prototype,ir),mix(_i,Or),mix(me,$r),me},Zc=null,Co=function(me,ir){if(!bt(me))return-1;var Or=Array.prototype.indexOf;if(Or)return Or.call(me,ir);for(var $r=-1,xn=0;xn<me.length;xn++)if(me[xn]===ir){$r=xn;break}return $r},sc=Co,Xl=Object.prototype.hasOwnProperty;function nl(me){if(P(me))return!0;if(bt(me))return!me.length;var ir=ta(me);if(ir==="Map"||ir==="Set")return!me.size;if(Tr(me))return!Object.keys(me).length;for(var Or in me)if(Xl.call(me,Or))return!1;return!0}var uc=nl,D=function(me,ir){if(me===ir)return!0;if(!me||!ir||Pe(me)||Pe(ir))return!1;if(bt(me)||bt(ir)){if(me.length!==ir.length)return!1;for(var Or=!0,$r=0;$r<me.length&&(Or=D(me[$r],ir[$r]),!!Or);$r++);return Or}if(_e(me)||_e(ir)){var xn=Object.keys(me),_i=Object.keys(ir);if(xn.length!==_i.length)return!1;for(var Or=!0,$r=0;$r<xn.length&&(Or=D(me[xn[$r]],ir[xn[$r]]),!!Or);$r++);return Or}return!1},X=D,_t=function(me,ir,Or){return isFunction(Or)?!!Or(me,ir):isEqual(me,ir)},rt=function(me,ir){if(!bt(me))return me;for(var Or=[],$r=0;$r<me.length;$r++){var xn=me[$r];Or.push(ir(xn,$r))}return Or},se=rt,Ze=function(me){return me},Sr=function(me,ir){ir===void 0&&(ir=Ze);var Or={};return W(me)&&!P(me)&&Object.keys(me).forEach(function($r){Or[$r]=ir(me[$r],$r)}),Or};function jr(me,ir){for(var Or in ir)ir.hasOwnProperty(Or)&&Or!=="constructor"&&ir[Or]!==void 0&&(me[Or]=ir[Or])}function Vr(me,ir,Or,$r){return ir&&jr(me,ir),Or&&jr(me,Or),$r&&jr(me,$r),me}var Ln=function(me,ir,Or){for(var $r=0,xn=Pe(ir)?ir.split("."):ir;me&&$r<xn.length;)me=me[xn[$r++]];return me===void 0||$r<xn.length?Or:me},Gn=function(me,ir,Or){var $r=me,xn=Pe(ir)?ir.split("."):ir;return xn.forEach(function(_i,qi){qi<xn.length-1?(W($r[_i])||($r[_i]=ze(xn[qi+1])?[]:{}),$r=$r[_i]):$r[_i]=Or}),me},$i=Object.prototype.hasOwnProperty,Pa=function(me,ir){if(me===null||!te(me))return{};var Or={};return Ee(ir,function($r){$i.call(me,$r)&&(Or[$r]=me[$r])}),Or},ba=function(me,ir){return St(me,function(Or,$r,xn){return ir.includes(xn)||(Or[xn]=$r),Or},{})},uo=function(me,ir,Or){var $r,xn,_i,qi,Ia=0;Or||(Or={});var du=function(){Ia=Or.leading===!1?0:Date.now(),$r=null,qi=me.apply(xn,_i),$r||(xn=_i=null)},qs=function(){var $a=Date.now();!Ia&&Or.leading===!1&&(Ia=$a);var Dl=ir-($a-Ia);return xn=this,_i=arguments,Dl<=0||Dl>ir?($r&&(clearTimeout($r),$r=null),Ia=$a,qi=me.apply(xn,_i),$r||(xn=_i=null)):!$r&&Or.trailing!==!1&&($r=setTimeout(du,Dl)),qi};return qs.cancel=function(){clearTimeout($r),Ia=0,$r=xn=_i=null},qs},Ca=function(me){return bt(me)?Array.prototype.slice.call(me):[]},Ao={},qa=function(me){return me=me||"g",Ao[me]?Ao[me]+=1:Ao[me]=1,me+Ao[me]},gs=function(){};function xu(me){return P(me)?0:bt(me)?me.length:Object.keys(me).length}var il=ot(70655),bu,iu=dl(function(me,ir){ir===void 0&&(ir={});var Or=ir.fontSize,$r=ir.fontFamily,xn=ir.fontWeight,_i=ir.fontStyle,qi=ir.fontVariant;return bu||(bu=document.createElement("canvas").getContext("2d")),bu.font=[_i,qi,xn,Or+"px",$r].join(" "),bu.measureText(Pe(me)?me:"").width},function(me,ir){return ir===void 0&&(ir={}),(0,il.pr)([me],ju(ir)).join("")}),Vc=function(me,ir,Or,$r){$r===void 0&&($r="...");var xn=16,_i=iu($r,Or),qi=Pe(me)?me:bo(me),Ia=ir,du=[],qs,$a;if(iu(me,Or)<=ir)return me;for(;qs=qi.substr(0,xn),$a=iu(qs,Or),!($a+_i>Ia&&$a>Ia);)if(du.push(qs),Ia-=$a,qi=qi.substr(xn),!qi)return du.join("");for(;qs=qi.substr(0,1),$a=iu(qs,Or),!($a+_i>Ia);)if(du.push(qs),Ia-=$a,qi=qi.substr(1),!qi)return du.join("");return""+du.join("")+$r},$s=function(){function me(){this.map={}}return me.prototype.has=function(ir){return this.map[ir]!==void 0},me.prototype.get=function(ir,Or){var $r=this.map[ir];return $r===void 0?Or:$r},me.prototype.set=function(ir,Or){this.map[ir]=Or},me.prototype.clear=function(){this.map={}},me.prototype.delete=function(ir){delete this.map[ir]},me.prototype.size=function(){return Object.keys(this.map).length},me}(),Yl=$s},38163:function(gn){gn.exports=Ot;function Ot(bt,I){var xt=bt&&bt.type,K;if(xt==="FeatureCollection")for(K=0;K<bt.features.length;K++)Ot(bt.features[K],I);else if(xt==="GeometryCollection")for(K=0;K<bt.geometries.length;K++)Ot(bt.geometries[K],I);else if(xt==="Feature")Ot(bt.geometry,I);else if(xt==="Polygon")ot(bt.coordinates,I);else if(xt==="MultiPolygon")for(K=0;K<bt.coordinates.length;K++)ot(bt.coordinates[K],I);return bt}function ot(bt,I){if(bt.length!==0){kt(bt[0],I);for(var xt=1;xt<bt.length;xt++)kt(bt[xt],!I)}}function kt(bt,I){for(var xt=0,K=0,ut=0,ht=bt.length,lt=ht-1;ut<ht;lt=ut++){var tt=(bt[ut][0]-bt[lt][0])*(bt[lt][1]+bt[ut][1]),be=xt+tt;K+=Math.abs(xt)>=Math.abs(tt)?xt-be+tt:tt-be+xt,xt=be}xt+K>=0!=!!I&&bt.reverse()}},75550:function(gn){"use strict";gn.exports=Ot;function Ot(ot,kt){this.x=ot,this.y=kt}Ot.prototype={clone:function(){return new Ot(this.x,this.y)},add:function(ot){return this.clone()._add(ot)},sub:function(ot){return this.clone()._sub(ot)},multByPoint:function(ot){return this.clone()._multByPoint(ot)},divByPoint:function(ot){return this.clone()._divByPoint(ot)},mult:function(ot){return this.clone()._mult(ot)},div:function(ot){return this.clone()._div(ot)},rotate:function(ot){return this.clone()._rotate(ot)},rotateAround:function(ot,kt){return this.clone()._rotateAround(ot,kt)},matMult:function(ot){return this.clone()._matMult(ot)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(ot){return this.x===ot.x&&this.y===ot.y},dist:function(ot){return Math.sqrt(this.distSqr(ot))},distSqr:function(ot){var kt=ot.x-this.x,bt=ot.y-this.y;return kt*kt+bt*bt},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(ot){return Math.atan2(this.y-ot.y,this.x-ot.x)},angleWith:function(ot){return this.angleWithSep(ot.x,ot.y)},angleWithSep:function(ot,kt){return Math.atan2(this.x*kt-this.y*ot,this.x*ot+this.y*kt)},_matMult:function(ot){var kt=ot[0]*this.x+ot[1]*this.y,bt=ot[2]*this.x+ot[3]*this.y;return this.x=kt,this.y=bt,this},_add:function(ot){return this.x+=ot.x,this.y+=ot.y,this},_sub:function(ot){return this.x-=ot.x,this.y-=ot.y,this},_mult:function(ot){return this.x*=ot,this.y*=ot,this},_div:function(ot){return this.x/=ot,this.y/=ot,this},_multByPoint:function(ot){return this.x*=ot.x,this.y*=ot.y,this},_divByPoint:function(ot){return this.x/=ot.x,this.y/=ot.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var ot=this.y;return this.y=this.x,this.x=-ot,this},_rotate:function(ot){var kt=Math.cos(ot),bt=Math.sin(ot),I=kt*this.x-bt*this.y,xt=bt*this.x+kt*this.y;return this.x=I,this.y=xt,this},_rotateAround:function(ot,kt){var bt=Math.cos(ot),I=Math.sin(ot),xt=kt.x+bt*(this.x-kt.x)-I*(this.y-kt.y),K=kt.y+I*(this.x-kt.x)+bt*(this.y-kt.y);return this.x=xt,this.y=K,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ot.convert=function(ot){return ot instanceof Ot?ot:Array.isArray(ot)?new Ot(ot[0],ot[1]):ot}},38929:function(gn,Ot,ot){gn.exports.VectorTile=ot(22779),ot(66024),ot(59701)},22779:function(gn,Ot,ot){"use strict";var kt=ot(59701);gn.exports=bt;function bt(xt,K){this.layers=xt.readFields(I,{},K)}function I(xt,K,ut){if(xt===3){var ht=new kt(ut,ut.readVarint()+ut.pos);ht.length&&(K[ht.name]=ht)}}},66024:function(gn,Ot,ot){"use strict";var kt=ot(75550);gn.exports=bt;function bt(ht,lt,tt,be,it){this.properties={},this.extent=tt,this.type=0,this._pbf=ht,this._geometry=-1,this._keys=be,this._values=it,ht.readFields(I,this,lt)}function I(ht,lt,tt){ht==1?lt.id=tt.readVarint():ht==2?xt(tt,lt):ht==3?lt.type=tt.readVarint():ht==4&&(lt._geometry=tt.pos)}function xt(ht,lt){for(var tt=ht.readVarint()+ht.pos;ht.pos<tt;){var be=lt._keys[ht.readVarint()],it=lt._values[ht.readVarint()];lt.properties[be]=it}}bt.types=["Unknown","Point","LineString","Polygon"],bt.prototype.loadGeometry=function(){var ht=this._pbf;ht.pos=this._geometry;for(var lt=ht.readVarint()+ht.pos,tt=1,be=0,it=0,st=0,Ut=[],P;ht.pos<lt;){if(be<=0){var b=ht.readVarint();tt=b&7,be=b>>3}if(be--,tt===1||tt===2)it+=ht.readSVarint(),st+=ht.readSVarint(),tt===1&&(P&&Ut.push(P),P=[]),P.push(new kt(it,st));else if(tt===7)P&&P.push(P[0].clone());else throw new Error("unknown command "+tt)}return P&&Ut.push(P),Ut},bt.prototype.bbox=function(){var ht=this._pbf;ht.pos=this._geometry;for(var lt=ht.readVarint()+ht.pos,tt=1,be=0,it=0,st=0,Ut=1/0,P=-1/0,b=1/0,W=-1/0;ht.pos<lt;){if(be<=0){var fe=ht.readVarint();tt=fe&7,be=fe>>3}if(be--,tt===1||tt===2)it+=ht.readSVarint(),st+=ht.readSVarint(),it<Ut&&(Ut=it),it>P&&(P=it),st<b&&(b=st),st>W&&(W=st);else if(tt!==7)throw new Error("unknown command "+tt)}return[Ut,b,P,W]},bt.prototype.toGeoJSON=function(ht,lt,tt){var be=this.extent*Math.pow(2,tt),it=this.extent*ht,st=this.extent*lt,Ut=this.loadGeometry(),P=bt.types[this.type],b,W;function fe(Mt){for(var et=0;et<Mt.length;et++){var Dt=Mt[et],we=180-(Dt.y+st)*360/be;Mt[et]=[(Dt.x+it)*360/be-180,360/Math.PI*Math.atan(Math.exp(we*Math.PI/180))-90]}}switch(this.type){case 1:var Ee=[];for(b=0;b<Ut.length;b++)Ee[b]=Ut[b][0];Ut=Ee,fe(Ut);break;case 2:for(b=0;b<Ut.length;b++)fe(Ut[b]);break;case 3:for(Ut=K(Ut),b=0;b<Ut.length;b++)for(W=0;W<Ut[b].length;W++)fe(Ut[b][W]);break}Ut.length===1?Ut=Ut[0]:P="Multi"+P;var Te={type:"Feature",geometry:{type:P,coordinates:Ut},properties:this.properties};return"id"in this&&(Te.id=this.id),Te};function K(ht){var lt=ht.length;if(lt<=1)return[ht];for(var tt=[],be,it,st=0;st<lt;st++){var Ut=ut(ht[st]);Ut!==0&&(it===void 0&&(it=Ut<0),it===Ut<0?(be&&tt.push(be),be=[ht[st]]):be.push(ht[st]))}return be&&tt.push(be),tt}function ut(ht){for(var lt=0,tt=0,be=ht.length,it=be-1,st,Ut;tt<be;it=tt++)st=ht[tt],Ut=ht[it],lt+=(Ut.x-st.x)*(st.y+Ut.y);return lt}},59701:function(gn,Ot,ot){"use strict";var kt=ot(66024);gn.exports=bt;function bt(K,ut){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=K,this._keys=[],this._values=[],this._features=[],K.readFields(I,this,ut),this.length=this._features.length}function I(K,ut,ht){K===15?ut.version=ht.readVarint():K===1?ut.name=ht.readString():K===5?ut.extent=ht.readVarint():K===2?ut._features.push(ht.pos):K===3?ut._keys.push(ht.readString()):K===4&&ut._values.push(xt(ht))}function xt(K){for(var ut=null,ht=K.readVarint()+K.pos;K.pos<ht;){var lt=K.readVarint()>>3;ut=lt===1?K.readString():lt===2?K.readFloat():lt===3?K.readDouble():lt===4?K.readVarint64():lt===5?K.readVarint():lt===6?K.readSVarint():lt===7?K.readBoolean():null}return ut}bt.prototype.feature=function(K){if(K<0||K>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[K];var ut=this._pbf.readVarint()+this._pbf.pos;return new kt(this._pbf,ut,this.extent,this._keys,this._values)}},56645:function(gn,Ot){(function(ot,kt){kt(Ot)})(this,function(ot){"use strict";function kt(xe,Ye){return bt(xe)||I(xe,Ye)||xt()}function bt(xe){if(Array.isArray(xe))return xe}function I(xe,Ye){var Lt=[],Qt=!0,ct=!1,Ct=void 0;try{for(var Y=xe[Symbol.iterator](),yt;!(Qt=(yt=Y.next()).done)&&(Lt.push(yt.value),!(Ye&&Lt.length===Ye));Qt=!0);}catch(Xt){ct=!0,Ct=Xt}finally{try{!Qt&&Y.return!=null&&Y.return()}finally{if(ct)throw Ct}}return Lt}function xt(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function K(xe,Ye,Lt,Qt){xe=xe.filter(function(Me,ae){var Je=Ye(Me,ae),or=Lt(Me,ae);return Je!=null&&isFinite(Je)&&or!=null&&isFinite(or)}),Qt&&xe.sort(function(Me,ae){return Ye(Me)-Ye(ae)});for(var ct=xe.length,Ct=new Float64Array(ct),Y=new Float64Array(ct),yt=0,Xt=0,ie,Ce,er,Ht=0;Ht<ct;)er=xe[Ht],Ct[Ht]=ie=+Ye(er,Ht,xe),Y[Ht]=Ce=+Lt(er,Ht,xe),++Ht,yt+=(ie-yt)/Ht,Xt+=(Ce-Xt)/Ht;for(var ne=0;ne<ct;++ne)Ct[ne]-=yt,Y[ne]-=Xt;return[Ct,Y,yt,Xt]}function ut(xe,Ye,Lt,Qt){for(var ct=0,Ct=0,Y=xe.length;Ct<Y;Ct++){var yt=xe[Ct],Xt=+Ye(yt,Ct,xe),ie=+Lt(yt,Ct,xe);Xt!=null&&isFinite(Xt)&&ie!=null&&isFinite(ie)&&Qt(Xt,ie,ct++)}}function ht(xe,Ye,Lt,Qt,ct){var Ct=0,Y=0;return ut(xe,Ye,Lt,function(yt,Xt){var ie=Xt-ct(yt),Ce=Xt-Qt;Ct+=ie*ie,Y+=Ce*Ce}),1-Ct/Y}function lt(xe){return Math.atan2(xe[1][1]-xe[0][1],xe[1][0]-xe[0][0])*180/Math.PI}function tt(xe){return[(xe[0][0]+xe[1][0])/2,(xe[0][1]+xe[1][1])/2]}function be(xe,Ye,Lt){for(var Qt=Math.log(Ye-xe)*Math.LOG10E+1|0,ct=1*Math.pow(10,-Qt/2-1),Ct=1e4,Y=[Xt(xe),Xt(Ye)],yt=0;ie(Y)&&yt<Ct;);return Y;function Xt(Ce){return[Ce,Lt(Ce)]}function ie(Ce){yt++;for(var er=Ce.length,Ht=!1,ne=0;ne<er-1;ne++){var Me=Ce[ne],ae=Ce[ne+1],Je=tt([Me,ae]),or=Xt(Je[0]),re=lt([Me,Je]),Jt=lt([Me,or]),Et=Math.abs(re-Jt);Et>ct&&(Ce.splice(ne+1,0,or),Ht=!0)}return Ht}}function it(xe,Ye,Lt,Qt){var ct=Qt-xe*xe,Ct=Math.abs(ct)<1e-24?0:(Lt-xe*Ye)/ct,Y=Ye-Ct*xe;return[Y,Ct]}function st(){var xe=function(Ct){return Ct[0]},Ye=function(Ct){return Ct[1]},Lt;function Qt(ct){var Ct=0,Y=0,yt=0,Xt=0,ie=0,Ce=0,er=Lt?+Lt[0]:1/0,Ht=Lt?+Lt[1]:-1/0;ut(ct,xe,Ye,function(Jt,Et){var $t=Math.log(Et),Yt=Jt*Et;++Ct,Y+=(Et-Y)/Ct,Xt+=(Yt-Xt)/Ct,Ce+=(Jt*Yt-Ce)/Ct,yt+=(Et*$t-yt)/Ct,ie+=(Yt*$t-ie)/Ct,Lt||(Jt<er&&(er=Jt),Jt>Ht&&(Ht=Jt))});var ne=it(Xt/Y,yt/Y,ie/Y,Ce/Y),Me=kt(ne,2),ae=Me[0],Je=Me[1];ae=Math.exp(ae);var or=function(Et){return ae*Math.exp(Je*Et)},re=be(er,Ht,or);return re.a=ae,re.b=Je,re.predict=or,re.rSquared=ht(ct,xe,Ye,Y,or),re}return Qt.domain=function(ct){return arguments.length?(Lt=ct,Qt):Lt},Qt.x=function(ct){return arguments.length?(xe=ct,Qt):xe},Qt.y=function(ct){return arguments.length?(Ye=ct,Qt):Ye},Qt}function Ut(){var xe=function(Ct){return Ct[0]},Ye=function(Ct){return Ct[1]},Lt;function Qt(ct){var Ct=0,Y=0,yt=0,Xt=0,ie=0,Ce=Lt?+Lt[0]:1/0,er=Lt?+Lt[1]:-1/0;ut(ct,xe,Ye,function(re,Jt){++Ct,Y+=(re-Y)/Ct,yt+=(Jt-yt)/Ct,Xt+=(re*Jt-Xt)/Ct,ie+=(re*re-ie)/Ct,Lt||(re<Ce&&(Ce=re),re>er&&(er=re))});var Ht=it(Y,yt,Xt,ie),ne=kt(Ht,2),Me=ne[0],ae=ne[1],Je=function(Jt){return ae*Jt+Me},or=[[Ce,Je(Ce)],[er,Je(er)]];return or.a=ae,or.b=Me,or.predict=Je,or.rSquared=ht(ct,xe,Ye,yt,Je),or}return Qt.domain=function(ct){return arguments.length?(Lt=ct,Qt):Lt},Qt.x=function(ct){return arguments.length?(xe=ct,Qt):xe},Qt.y=function(ct){return arguments.length?(Ye=ct,Qt):Ye},Qt}function P(xe){xe.sort(function(Lt,Qt){return Lt-Qt});var Ye=xe.length/2;return Ye%1===0?(xe[Ye-1]+xe[Ye])/2:xe[Math.floor(Ye)]}var b=2,W=1e-12;function fe(){var xe=function(Ct){return Ct[0]},Ye=function(Ct){return Ct[1]},Lt=.3;function Qt(ct){for(var Ct=K(ct,xe,Ye,!0),Y=kt(Ct,4),yt=Y[0],Xt=Y[1],ie=Y[2],Ce=Y[3],er=yt.length,Ht=Math.max(2,~~(Lt*er)),ne=new Float64Array(er),Me=new Float64Array(er),ae=new Float64Array(er).fill(1),Je=-1;++Je<=b;){for(var or=[0,Ht-1],re=0;re<er;++re){for(var Jt=yt[re],Et=or[0],$t=or[1],Yt=Jt-yt[Et]>yt[$t]-Jt?Et:$t,St=0,At=0,ue=0,Pe=0,je=0,Nt=1/Math.abs(yt[Yt]-Jt||1),wt=Et;wt<=$t;++wt){var Tt=yt[wt],Ft=Xt[wt],J=Ee(Math.abs(Jt-Tt)*Nt)*ae[wt],gt=Tt*J;St+=J,At+=gt,ue+=Ft*J,Pe+=Ft*gt,je+=Tt*gt}var jt=it(At/St,ue/St,Pe/St,je/St),ve=kt(jt,2),Gt=ve[0],Ae=ve[1];ne[re]=Gt+Ae*Jt,Me[re]=Math.abs(Xt[re]-ne[re]),Te(yt,re+1,or)}if(Je===b)break;var He=P(Me);if(Math.abs(He)<W)break;for(var qe=0,hr,tr;qe<er;++qe)hr=Me[qe]/(6*He),ae[qe]=hr>=1?W:(tr=1-hr*hr)*tr}return Mt(yt,ne,ie,Ce)}return Qt.bandwidth=function(ct){return arguments.length?(Lt=ct,Qt):Lt},Qt.x=function(ct){return arguments.length?(xe=ct,Qt):xe},Qt.y=function(ct){return arguments.length?(Ye=ct,Qt):Ye},Qt}function Ee(xe){return(xe=1-xe*xe*xe)*xe*xe}function Te(xe,Ye,Lt){var Qt=xe[Ye],ct=Lt[0],Ct=Lt[1]+1;if(!(Ct>=xe.length))for(;Ye>ct&&xe[Ct]-Qt<=Qt-xe[ct];)Lt[0]=++ct,Lt[1]=Ct,++Ct}function Mt(xe,Ye,Lt,Qt){for(var ct=xe.length,Ct=[],Y=0,yt=0,Xt=[],ie;Y<ct;++Y)ie=xe[Y]+Lt,Xt[0]===ie?Xt[1]+=(Ye[Y]-Xt[1])/++yt:(yt=0,Xt[1]+=Qt,Xt=[ie,Ye[Y]],Ct.push(Xt));return Xt[1]+=Qt,Ct}function et(){var xe=function(Y){return Y[0]},Ye=function(Y){return Y[1]},Lt=Math.E,Qt;function ct(Ct){var Y=0,yt=0,Xt=0,ie=0,Ce=0,er=Qt?+Qt[0]:1/0,Ht=Qt?+Qt[1]:-1/0,ne=Math.log(Lt);ut(Ct,xe,Ye,function(Et,$t){var Yt=Math.log(Et)/ne;++Y,yt+=(Yt-yt)/Y,Xt+=($t-Xt)/Y,ie+=(Yt*$t-ie)/Y,Ce+=(Yt*Yt-Ce)/Y,Qt||(Et<er&&(er=Et),Et>Ht&&(Ht=Et))});var Me=it(yt,Xt,ie,Ce),ae=kt(Me,2),Je=ae[0],or=ae[1],re=function($t){return or*Math.log($t)/ne+Je},Jt=be(er,Ht,re);return Jt.a=or,Jt.b=Je,Jt.predict=re,Jt.rSquared=ht(Ct,xe,Ye,Xt,re),Jt}return ct.domain=function(Ct){return arguments.length?(Qt=Ct,ct):Qt},ct.x=function(Ct){return arguments.length?(xe=Ct,ct):xe},ct.y=function(Ct){return arguments.length?(Ye=Ct,ct):Ye},ct.base=function(Ct){return arguments.length?(Lt=Ct,ct):Lt},ct}function Dt(){var xe=function(Ct){return Ct[0]},Ye=function(Ct){return Ct[1]},Lt;function Qt(ct){var Ct=K(ct,xe,Ye),Y=kt(Ct,4),yt=Y[0],Xt=Y[1],ie=Y[2],Ce=Y[3],er=yt.length,Ht=0,ne=0,Me=0,ae=0,Je=0,or,re,Jt,Et;for(or=0;or<er;)re=yt[or],Jt=Xt[or++],Et=re*re,Ht+=(Et-Ht)/or,ne+=(Et*re-ne)/or,Me+=(Et*Et-Me)/or,ae+=(re*Jt-ae)/or,Je+=(Et*Jt-Je)/or;var $t=0,Yt=0,St=Lt?+Lt[0]:1/0,At=Lt?+Lt[1]:-1/0;ut(ct,xe,Ye,function(J,gt){Yt++,$t+=(gt-$t)/Yt,Lt||(J<St&&(St=J),J>At&&(At=J))});var ue=Me-Ht*Ht,Pe=Ht*ue-ne*ne,je=(Je*Ht-ae*ne)/Pe,Nt=(ae*ue-Je*ne)/Pe,wt=-je*Ht,Tt=function(gt){return gt=gt-ie,je*gt*gt+Nt*gt+wt+Ce},Ft=be(St,At,Tt);return Ft.a=je,Ft.b=Nt-2*je*ie,Ft.c=wt-Nt*ie+je*ie*ie+Ce,Ft.predict=Tt,Ft.rSquared=ht(ct,xe,Ye,$t,Tt),Ft}return Qt.domain=function(ct){return arguments.length?(Lt=ct,Qt):Lt},Qt.x=function(ct){return arguments.length?(xe=ct,Qt):xe},Qt.y=function(ct){return arguments.length?(Ye=ct,Qt):Ye},Qt}function we(){var xe=function(Y){return Y[0]},Ye=function(Y){return Y[1]},Lt=3,Qt;function ct(Ct){if(Lt===1){var Y=Ut().x(xe).y(Ye).domain(Qt)(Ct);return Y.coefficients=[Y.b,Y.a],delete Y.a,delete Y.b,Y}if(Lt===2){var yt=Dt().x(xe).y(Ye).domain(Qt)(Ct);return yt.coefficients=[yt.c,yt.b,yt.a],delete yt.a,delete yt.b,delete yt.c,yt}var Xt=K(Ct,xe,Ye),ie=kt(Xt,4),Ce=ie[0],er=ie[1],Ht=ie[2],ne=ie[3],Me=Ce.length,ae=[],Je=[],or=Lt+1,re=0,Jt=0,Et=Qt?+Qt[0]:1/0,$t=Qt?+Qt[1]:-1/0;ut(Ct,xe,Ye,function(Tt,Ft){++Jt,re+=(Ft-re)/Jt,Qt||(Tt<Et&&(Et=Tt),Tt>$t&&($t=Tt))});var Yt,St,At,ue,Pe;for(Yt=0;Yt<or;++Yt){for(At=0,ue=0;At<Me;++At)ue+=Math.pow(Ce[At],Yt)*er[At];for(ae.push(ue),Pe=new Float64Array(or),St=0;St<or;++St){for(At=0,ue=0;At<Me;++At)ue+=Math.pow(Ce[At],Yt+St);Pe[St]=ue}Je.push(Pe)}Je.push(ae);var je=ge(Je),Nt=function(Ft){Ft-=Ht;var J=ne+je[0]+je[1]*Ft+je[2]*Ft*Ft;for(Yt=3;Yt<or;++Yt)J+=je[Yt]*Math.pow(Ft,Yt);return J},wt=be(Et,$t,Nt);return wt.coefficients=_e(or,je,-Ht,ne),wt.predict=Nt,wt.rSquared=ht(Ct,xe,Ye,re,Nt),wt}return ct.domain=function(Ct){return arguments.length?(Qt=Ct,ct):Qt},ct.x=function(Ct){return arguments.length?(xe=Ct,ct):xe},ct.y=function(Ct){return arguments.length?(Ye=Ct,ct):Ye},ct.order=function(Ct){return arguments.length?(Lt=Ct,ct):Lt},ct}function _e(xe,Ye,Lt,Qt){var ct=Array(xe),Ct,Y,yt,Xt;for(Ct=0;Ct<xe;++Ct)ct[Ct]=0;for(Ct=xe-1;Ct>=0;--Ct)for(yt=Ye[Ct],Xt=1,ct[Ct]+=yt,Y=1;Y<=Ct;++Y)Xt*=(Ct+1-Y)/Y,ct[Ct-Y]+=yt*Math.pow(Lt,Y)*Xt;return ct[0]+=Qt,ct}function ge(xe){var Ye=xe.length-1,Lt=[],Qt,ct,Ct,Y,yt;for(Qt=0;Qt<Ye;++Qt){for(Y=Qt,ct=Qt+1;ct<Ye;++ct)Math.abs(xe[Qt][ct])>Math.abs(xe[Qt][Y])&&(Y=ct);for(Ct=Qt;Ct<Ye+1;++Ct)yt=xe[Ct][Qt],xe[Ct][Qt]=xe[Ct][Y],xe[Ct][Y]=yt;for(ct=Qt+1;ct<Ye;++ct)for(Ct=Ye;Ct>=Qt;Ct--)xe[Ct][ct]-=xe[Ct][Qt]*xe[Qt][ct]/xe[Qt][Qt]}for(ct=Ye-1;ct>=0;--ct){for(yt=0,Ct=ct+1;Ct<Ye;++Ct)yt+=xe[Ct][ct]*Lt[Ct];Lt[ct]=(xe[Ye][ct]-yt)/xe[ct][ct]}return Lt}function te(){var xe=function(Ct){return Ct[0]},Ye=function(Ct){return Ct[1]},Lt;function Qt(ct){var Ct=0,Y=0,yt=0,Xt=0,ie=0,Ce=0,er=Lt?+Lt[0]:1/0,Ht=Lt?+Lt[1]:-1/0;ut(ct,xe,Ye,function(Jt,Et){var $t=Math.log(Jt),Yt=Math.log(Et);++Ct,Y+=($t-Y)/Ct,yt+=(Yt-yt)/Ct,Xt+=($t*Yt-Xt)/Ct,ie+=($t*$t-ie)/Ct,Ce+=(Et-Ce)/Ct,Lt||(Jt<er&&(er=Jt),Jt>Ht&&(Ht=Jt))});var ne=it(Y,yt,Xt,ie),Me=kt(ne,2),ae=Me[0],Je=Me[1];ae=Math.exp(ae);var or=function(Et){return ae*Math.pow(Et,Je)},re=be(er,Ht,or);return re.a=ae,re.b=Je,re.predict=or,re.rSquared=ht(ct,xe,Ye,Ce,or),re}return Qt.domain=function(ct){return arguments.length?(Lt=ct,Qt):Lt},Qt.x=function(ct){return arguments.length?(xe=ct,Qt):xe},Qt.y=function(ct){return arguments.length?(Ye=ct,Qt):Ye},Qt}ot.regressionExp=st,ot.regressionLinear=Ut,ot.regressionLoess=fe,ot.regressionLog=et,ot.regressionPoly=we,ot.regressionPow=te,ot.regressionQuad=Dt,Object.defineProperty(ot,"__esModule",{value:!0})})},43631:function(gn,Ot,ot){"use strict";ot.d(Ot,{qY:function(){return Ut}});var kt=ot(34155),bt=function(Mt,et,Dt){if(Dt||arguments.length===2)for(var we=0,_e=et.length,ge;we<_e;we++)(ge||!(we in et))&&(ge||(ge=Array.prototype.slice.call(et,0,we)),ge[we]=et[we]);return Mt.concat(ge||Array.prototype.slice.call(et))},I=function(){function Mt(et,Dt,we){this.name=et,this.version=Dt,this.os=we,this.type="browser"}return Mt}(),xt=function(){function Mt(et){this.version=et,this.type="node",this.name="node",this.os=kt.platform}return Mt}(),K=function(){function Mt(et,Dt,we,_e){this.name=et,this.version=Dt,this.os=we,this.bot=_e,this.type="bot-device"}return Mt}(),ut=function(){function Mt(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return Mt}(),ht=function(){function Mt(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return Mt}(),lt=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,tt=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,be=3,it=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",lt]],st=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Ut(Mt){return Mt?W(Mt):typeof document=="undefined"&&typeof navigator!="undefined"&&navigator.product==="ReactNative"?new ht:typeof navigator!="undefined"?W(navigator.userAgent):Ee()}function P(Mt){return Mt!==""&&it.reduce(function(et,Dt){var we=Dt[0],_e=Dt[1];if(et)return et;var ge=_e.exec(Mt);return!!ge&&[we,ge]},!1)}function b(Mt){var et=P(Mt);return et?et[0]:null}function W(Mt){var et=P(Mt);if(!et)return null;var Dt=et[0],we=et[1];if(Dt==="searchbot")return new ut;var _e=we[1]&&we[1].split(".").join("_").split("_").slice(0,3);_e?_e.length<be&&(_e=bt(bt([],_e,!0),Te(be-_e.length),!0)):_e=[];var ge=_e.join("."),te=fe(Mt),xe=tt.exec(Mt);return xe&&xe[1]?new K(Dt,ge,te,xe[1]):new I(Dt,ge,te)}function fe(Mt){for(var et=0,Dt=st.length;et<Dt;et++){var we=st[et],_e=we[0],ge=we[1],te=ge.exec(Mt);if(te)return _e}return null}function Ee(){var Mt=typeof kt!="undefined"&&kt.version;return Mt?new xt(kt.version.slice(1)):null}function Te(Mt){for(var et=[],Dt=0;Dt<Mt;Dt++)et.push("0");return et}},9187:function(gn){"use strict";gn.exports=Ot,gn.exports.default=Ot;function Ot(ct,Ct,Y){Y=Y||2;var yt=Ct&&Ct.length,Xt=yt?Ct[0]*Y:ct.length,ie=ot(ct,0,Xt,Y,!0),Ce=[];if(!ie||ie.next===ie.prev)return Ce;var er,Ht,ne,Me,ae,Je,or;if(yt&&(ie=ht(ct,Ct,ie,Y)),ct.length>80*Y){er=ne=ct[0],Ht=Me=ct[1];for(var re=Y;re<Xt;re+=Y)ae=ct[re],Je=ct[re+1],ae<er&&(er=ae),Je<Ht&&(Ht=Je),ae>ne&&(ne=ae),Je>Me&&(Me=Je);or=Math.max(ne-er,Me-Ht),or=or!==0?32767/or:0}return bt(ie,Ce,Y,er,Ht,or,0),Ce}function ot(ct,Ct,Y,yt,Xt){var ie,Ce;if(Xt===Qt(ct,Ct,Y,yt)>0)for(ie=Ct;ie<Y;ie+=yt)Ce=xe(ie,ct[ie],ct[ie+1],Ce);else for(ie=Y-yt;ie>=Ct;ie-=yt)Ce=xe(ie,ct[ie],ct[ie+1],Ce);return Ce&&Te(Ce,Ce.next)&&(Ye(Ce),Ce=Ce.next),Ce}function kt(ct,Ct){if(!ct)return ct;Ct||(Ct=ct);var Y=ct,yt;do if(yt=!1,!Y.steiner&&(Te(Y,Y.next)||Ee(Y.prev,Y,Y.next)===0)){if(Ye(Y),Y=Ct=Y.prev,Y===Y.next)break;yt=!0}else Y=Y.next;while(yt||Y!==Ct);return Ct}function bt(ct,Ct,Y,yt,Xt,ie,Ce){if(!!ct){!Ce&&ie&&st(ct,yt,Xt,ie);for(var er=ct,Ht,ne;ct.prev!==ct.next;){if(Ht=ct.prev,ne=ct.next,ie?xt(ct,yt,Xt,ie):I(ct)){Ct.push(Ht.i/Y|0),Ct.push(ct.i/Y|0),Ct.push(ne.i/Y|0),Ye(ct),ct=ne.next,er=ne.next;continue}if(ct=ne,ct===er){Ce?Ce===1?(ct=K(kt(ct),Ct,Y),bt(ct,Ct,Y,yt,Xt,ie,2)):Ce===2&&ut(ct,Ct,Y,yt,Xt,ie):bt(kt(ct),Ct,Y,yt,Xt,ie,1);break}}}}function I(ct){var Ct=ct.prev,Y=ct,yt=ct.next;if(Ee(Ct,Y,yt)>=0)return!1;for(var Xt=Ct.x,ie=Y.x,Ce=yt.x,er=Ct.y,Ht=Y.y,ne=yt.y,Me=Xt<ie?Xt<Ce?Xt:Ce:ie<Ce?ie:Ce,ae=er<Ht?er<ne?er:ne:Ht<ne?Ht:ne,Je=Xt>ie?Xt>Ce?Xt:Ce:ie>Ce?ie:Ce,or=er>Ht?er>ne?er:ne:Ht>ne?Ht:ne,re=yt.next;re!==Ct;){if(re.x>=Me&&re.x<=Je&&re.y>=ae&&re.y<=or&&W(Xt,er,ie,Ht,Ce,ne,re.x,re.y)&&Ee(re.prev,re,re.next)>=0)return!1;re=re.next}return!0}function xt(ct,Ct,Y,yt){var Xt=ct.prev,ie=ct,Ce=ct.next;if(Ee(Xt,ie,Ce)>=0)return!1;for(var er=Xt.x,Ht=ie.x,ne=Ce.x,Me=Xt.y,ae=ie.y,Je=Ce.y,or=er<Ht?er<ne?er:ne:Ht<ne?Ht:ne,re=Me<ae?Me<Je?Me:Je:ae<Je?ae:Je,Jt=er>Ht?er>ne?er:ne:Ht>ne?Ht:ne,Et=Me>ae?Me>Je?Me:Je:ae>Je?ae:Je,$t=P(or,re,Ct,Y,yt),Yt=P(Jt,Et,Ct,Y,yt),St=ct.prevZ,At=ct.nextZ;St&&St.z>=$t&&At&&At.z<=Yt;){if(St.x>=or&&St.x<=Jt&&St.y>=re&&St.y<=Et&&St!==Xt&&St!==Ce&&W(er,Me,Ht,ae,ne,Je,St.x,St.y)&&Ee(St.prev,St,St.next)>=0||(St=St.prevZ,At.x>=or&&At.x<=Jt&&At.y>=re&&At.y<=Et&&At!==Xt&&At!==Ce&&W(er,Me,Ht,ae,ne,Je,At.x,At.y)&&Ee(At.prev,At,At.next)>=0))return!1;At=At.nextZ}for(;St&&St.z>=$t;){if(St.x>=or&&St.x<=Jt&&St.y>=re&&St.y<=Et&&St!==Xt&&St!==Ce&&W(er,Me,Ht,ae,ne,Je,St.x,St.y)&&Ee(St.prev,St,St.next)>=0)return!1;St=St.prevZ}for(;At&&At.z<=Yt;){if(At.x>=or&&At.x<=Jt&&At.y>=re&&At.y<=Et&&At!==Xt&&At!==Ce&&W(er,Me,Ht,ae,ne,Je,At.x,At.y)&&Ee(At.prev,At,At.next)>=0)return!1;At=At.nextZ}return!0}function K(ct,Ct,Y){var yt=ct;do{var Xt=yt.prev,ie=yt.next.next;!Te(Xt,ie)&&Mt(Xt,yt,yt.next,ie)&&_e(Xt,ie)&&_e(ie,Xt)&&(Ct.push(Xt.i/Y|0),Ct.push(yt.i/Y|0),Ct.push(ie.i/Y|0),Ye(yt),Ye(yt.next),yt=ct=ie),yt=yt.next}while(yt!==ct);return kt(yt)}function ut(ct,Ct,Y,yt,Xt,ie){var Ce=ct;do{for(var er=Ce.next.next;er!==Ce.prev;){if(Ce.i!==er.i&&fe(Ce,er)){var Ht=te(Ce,er);Ce=kt(Ce,Ce.next),Ht=kt(Ht,Ht.next),bt(Ce,Ct,Y,yt,Xt,ie,0),bt(Ht,Ct,Y,yt,Xt,ie,0);return}er=er.next}Ce=Ce.next}while(Ce!==ct)}function ht(ct,Ct,Y,yt){var Xt=[],ie,Ce,er,Ht,ne;for(ie=0,Ce=Ct.length;ie<Ce;ie++)er=Ct[ie]*yt,Ht=ie<Ce-1?Ct[ie+1]*yt:ct.length,ne=ot(ct,er,Ht,yt,!1),ne===ne.next&&(ne.steiner=!0),Xt.push(b(ne));for(Xt.sort(lt),ie=0;ie<Xt.length;ie++)Y=tt(Xt[ie],Y);return Y}function lt(ct,Ct){return ct.x-Ct.x}function tt(ct,Ct){var Y=be(ct,Ct);if(!Y)return Ct;var yt=te(Y,ct);return kt(yt,yt.next),kt(Y,Y.next)}function be(ct,Ct){var Y=Ct,yt=ct.x,Xt=ct.y,ie=-1/0,Ce;do{if(Xt<=Y.y&&Xt>=Y.next.y&&Y.next.y!==Y.y){var er=Y.x+(Xt-Y.y)*(Y.next.x-Y.x)/(Y.next.y-Y.y);if(er<=yt&&er>ie&&(ie=er,Ce=Y.x<Y.next.x?Y:Y.next,er===yt))return Ce}Y=Y.next}while(Y!==Ct);if(!Ce)return null;var Ht=Ce,ne=Ce.x,Me=Ce.y,ae=1/0,Je;Y=Ce;do yt>=Y.x&&Y.x>=ne&&yt!==Y.x&&W(Xt<Me?yt:ie,Xt,ne,Me,Xt<Me?ie:yt,Xt,Y.x,Y.y)&&(Je=Math.abs(Xt-Y.y)/(yt-Y.x),_e(Y,ct)&&(Je<ae||Je===ae&&(Y.x>Ce.x||Y.x===Ce.x&&it(Ce,Y)))&&(Ce=Y,ae=Je)),Y=Y.next;while(Y!==Ht);return Ce}function it(ct,Ct){return Ee(ct.prev,ct,Ct.prev)<0&&Ee(Ct.next,ct,ct.next)<0}function st(ct,Ct,Y,yt){var Xt=ct;do Xt.z===0&&(Xt.z=P(Xt.x,Xt.y,Ct,Y,yt)),Xt.prevZ=Xt.prev,Xt.nextZ=Xt.next,Xt=Xt.next;while(Xt!==ct);Xt.prevZ.nextZ=null,Xt.prevZ=null,Ut(Xt)}function Ut(ct){var Ct,Y,yt,Xt,ie,Ce,er,Ht,ne=1;do{for(Y=ct,ct=null,ie=null,Ce=0;Y;){for(Ce++,yt=Y,er=0,Ct=0;Ct<ne&&(er++,yt=yt.nextZ,!!yt);Ct++);for(Ht=ne;er>0||Ht>0&&yt;)er!==0&&(Ht===0||!yt||Y.z<=yt.z)?(Xt=Y,Y=Y.nextZ,er--):(Xt=yt,yt=yt.nextZ,Ht--),ie?ie.nextZ=Xt:ct=Xt,Xt.prevZ=ie,ie=Xt;Y=yt}ie.nextZ=null,ne*=2}while(Ce>1);return ct}function P(ct,Ct,Y,yt,Xt){return ct=(ct-Y)*Xt|0,Ct=(Ct-yt)*Xt|0,ct=(ct|ct<<8)&16711935,ct=(ct|ct<<4)&252645135,ct=(ct|ct<<2)&858993459,ct=(ct|ct<<1)&1431655765,Ct=(Ct|Ct<<8)&16711935,Ct=(Ct|Ct<<4)&252645135,Ct=(Ct|Ct<<2)&858993459,Ct=(Ct|Ct<<1)&1431655765,ct|Ct<<1}function b(ct){var Ct=ct,Y=ct;do(Ct.x<Y.x||Ct.x===Y.x&&Ct.y<Y.y)&&(Y=Ct),Ct=Ct.next;while(Ct!==ct);return Y}function W(ct,Ct,Y,yt,Xt,ie,Ce,er){return(Xt-Ce)*(Ct-er)>=(ct-Ce)*(ie-er)&&(ct-Ce)*(yt-er)>=(Y-Ce)*(Ct-er)&&(Y-Ce)*(ie-er)>=(Xt-Ce)*(yt-er)}function fe(ct,Ct){return ct.next.i!==Ct.i&&ct.prev.i!==Ct.i&&!we(ct,Ct)&&(_e(ct,Ct)&&_e(Ct,ct)&&ge(ct,Ct)&&(Ee(ct.prev,ct,Ct.prev)||Ee(ct,Ct.prev,Ct))||Te(ct,Ct)&&Ee(ct.prev,ct,ct.next)>0&&Ee(Ct.prev,Ct,Ct.next)>0)}function Ee(ct,Ct,Y){return(Ct.y-ct.y)*(Y.x-Ct.x)-(Ct.x-ct.x)*(Y.y-Ct.y)}function Te(ct,Ct){return ct.x===Ct.x&&ct.y===Ct.y}function Mt(ct,Ct,Y,yt){var Xt=Dt(Ee(ct,Ct,Y)),ie=Dt(Ee(ct,Ct,yt)),Ce=Dt(Ee(Y,yt,ct)),er=Dt(Ee(Y,yt,Ct));return!!(Xt!==ie&&Ce!==er||Xt===0&&et(ct,Y,Ct)||ie===0&&et(ct,yt,Ct)||Ce===0&&et(Y,ct,yt)||er===0&&et(Y,Ct,yt))}function et(ct,Ct,Y){return Ct.x<=Math.max(ct.x,Y.x)&&Ct.x>=Math.min(ct.x,Y.x)&&Ct.y<=Math.max(ct.y,Y.y)&&Ct.y>=Math.min(ct.y,Y.y)}function Dt(ct){return ct>0?1:ct<0?-1:0}function we(ct,Ct){var Y=ct;do{if(Y.i!==ct.i&&Y.next.i!==ct.i&&Y.i!==Ct.i&&Y.next.i!==Ct.i&&Mt(Y,Y.next,ct,Ct))return!0;Y=Y.next}while(Y!==ct);return!1}function _e(ct,Ct){return Ee(ct.prev,ct,ct.next)<0?Ee(ct,Ct,ct.next)>=0&&Ee(ct,ct.prev,Ct)>=0:Ee(ct,Ct,ct.prev)<0||Ee(ct,ct.next,Ct)<0}function ge(ct,Ct){var Y=ct,yt=!1,Xt=(ct.x+Ct.x)/2,ie=(ct.y+Ct.y)/2;do Y.y>ie!=Y.next.y>ie&&Y.next.y!==Y.y&&Xt<(Y.next.x-Y.x)*(ie-Y.y)/(Y.next.y-Y.y)+Y.x&&(yt=!yt),Y=Y.next;while(Y!==ct);return yt}function te(ct,Ct){var Y=new Lt(ct.i,ct.x,ct.y),yt=new Lt(Ct.i,Ct.x,Ct.y),Xt=ct.next,ie=Ct.prev;return ct.next=Ct,Ct.prev=ct,Y.next=Xt,Xt.prev=Y,yt.next=Y,Y.prev=yt,ie.next=yt,yt.prev=ie,yt}function xe(ct,Ct,Y,yt){var Xt=new Lt(ct,Ct,Y);return yt?(Xt.next=yt.next,Xt.prev=yt,yt.next.prev=Xt,yt.next=Xt):(Xt.prev=Xt,Xt.next=Xt),Xt}function Ye(ct){ct.next.prev=ct.prev,ct.prev.next=ct.next,ct.prevZ&&(ct.prevZ.nextZ=ct.nextZ),ct.nextZ&&(ct.nextZ.prevZ=ct.prevZ)}function Lt(ct,Ct,Y){this.i=ct,this.x=Ct,this.y=Y,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ot.deviation=function(ct,Ct,Y,yt){var Xt=Ct&&Ct.length,ie=Xt?Ct[0]*Y:ct.length,Ce=Math.abs(Qt(ct,0,ie,Y));if(Xt)for(var er=0,Ht=Ct.length;er<Ht;er++){var ne=Ct[er]*Y,Me=er<Ht-1?Ct[er+1]*Y:ct.length;Ce-=Math.abs(Qt(ct,ne,Me,Y))}var ae=0;for(er=0;er<yt.length;er+=3){var Je=yt[er]*Y,or=yt[er+1]*Y,re=yt[er+2]*Y;ae+=Math.abs((ct[Je]-ct[re])*(ct[or+1]-ct[Je+1])-(ct[Je]-ct[or])*(ct[re+1]-ct[Je+1]))}return Ce===0&&ae===0?0:Math.abs((ae-Ce)/Ce)};function Qt(ct,Ct,Y,yt){for(var Xt=0,ie=Ct,Ce=Y-yt;ie<Y;ie+=yt)Xt+=(ct[Ce]-ct[ie])*(ct[ie+1]+ct[Ce+1]),Ce=ie;return Xt}Ot.flatten=function(ct){for(var Ct=ct[0][0].length,Y={vertices:[],holes:[],dimensions:Ct},yt=0,Xt=0;Xt<ct.length;Xt++){for(var ie=0;ie<ct[Xt].length;ie++)for(var Ce=0;Ce<Ct;Ce++)Y.vertices.push(ct[Xt][ie][Ce]);Xt>0&&(yt+=ct[Xt-1].length,Y.holes.push(yt))}return Y}},67709:function(gn){function Ot(kt){var bt=kt.target||kt.srcElement;bt.__resizeRAF__&&cancelAnimationFrame(bt.__resizeRAF__),bt.__resizeRAF__=requestAnimationFrame(function(){var I=bt.__resizeTrigger__,xt=I&&I.__resizeListeners__;xt&&xt.forEach(function(K){K.call(I,kt)})})}var ot=function(bt,I){var xt=this,K=xt.document,ut,ht=K.attachEvent;typeof navigator!="undefined"&&(ut=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function lt(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",Ot)}if(!bt.__resizeListeners__)if(bt.__resizeListeners__=[],ht)bt.__resizeTrigger__=bt,bt.attachEvent("onresize",Ot);else{getComputedStyle(bt).position==="static"&&(bt.style.position="relative");var tt=bt.__resizeTrigger__=K.createElement("object");tt.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),tt.setAttribute("class","resize-sensor"),tt.setAttribute("tabindex","-1"),tt.setAttribute("title",""),tt.__resizeElement__=bt,tt.onload=lt,tt.type="text/html",ut&&bt.appendChild(tt),tt.data="about:blank",ut||bt.appendChild(tt)}bt.__resizeListeners__.push(I)};gn.exports=typeof window=="undefined"?ot:ot.bind(window),gn.exports.unbind=function(kt,bt){var I=document.attachEvent,xt=kt.__resizeListeners__||[];if(bt){var K=xt.indexOf(bt);K!==-1&&xt.splice(K,1)}else xt=kt.__resizeListeners__=[];if(!xt.length){if(I)kt.detachEvent("onresize",Ot);else if(kt.__resizeTrigger__){var ut=kt.__resizeTrigger__.contentDocument,ht=ut&&ut.defaultView;ht&&(ht.removeEventListener("resize",Ot),delete ht.__resizeTrigger__),kt.__resizeTrigger__=!kt.removeChild(kt.__resizeTrigger__)}delete kt.__resizeListeners__}}},26729:function(gn){"use strict";var Ot=Object.prototype.hasOwnProperty,ot="~";function kt(){}Object.create&&(kt.prototype=Object.create(null),new kt().__proto__||(ot=!1));function bt(ut,ht,lt){this.fn=ut,this.context=ht,this.once=lt||!1}function I(ut,ht,lt,tt,be){if(typeof lt!="function")throw new TypeError("The listener must be a function");var it=new bt(lt,tt||ut,be),st=ot?ot+ht:ht;return ut._events[st]?ut._events[st].fn?ut._events[st]=[ut._events[st],it]:ut._events[st].push(it):(ut._events[st]=it,ut._eventsCount++),ut}function xt(ut,ht){--ut._eventsCount===0?ut._events=new kt:delete ut._events[ht]}function K(){this._events=new kt,this._eventsCount=0}K.prototype.eventNames=function(){var ht=[],lt,tt;if(this._eventsCount===0)return ht;for(tt in lt=this._events)Ot.call(lt,tt)&&ht.push(ot?tt.slice(1):tt);return Object.getOwnPropertySymbols?ht.concat(Object.getOwnPropertySymbols(lt)):ht},K.prototype.listeners=function(ht){var lt=ot?ot+ht:ht,tt=this._events[lt];if(!tt)return[];if(tt.fn)return[tt.fn];for(var be=0,it=tt.length,st=new Array(it);be<it;be++)st[be]=tt[be].fn;return st},K.prototype.listenerCount=function(ht){var lt=ot?ot+ht:ht,tt=this._events[lt];return tt?tt.fn?1:tt.length:0},K.prototype.emit=function(ht,lt,tt,be,it,st){var Ut=ot?ot+ht:ht;if(!this._events[Ut])return!1;var P=this._events[Ut],b=arguments.length,W,fe;if(P.fn){switch(P.once&&this.removeListener(ht,P.fn,void 0,!0),b){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,lt),!0;case 3:return P.fn.call(P.context,lt,tt),!0;case 4:return P.fn.call(P.context,lt,tt,be),!0;case 5:return P.fn.call(P.context,lt,tt,be,it),!0;case 6:return P.fn.call(P.context,lt,tt,be,it,st),!0}for(fe=1,W=new Array(b-1);fe<b;fe++)W[fe-1]=arguments[fe];P.fn.apply(P.context,W)}else{var Ee=P.length,Te;for(fe=0;fe<Ee;fe++)switch(P[fe].once&&this.removeListener(ht,P[fe].fn,void 0,!0),b){case 1:P[fe].fn.call(P[fe].context);break;case 2:P[fe].fn.call(P[fe].context,lt);break;case 3:P[fe].fn.call(P[fe].context,lt,tt);break;case 4:P[fe].fn.call(P[fe].context,lt,tt,be);break;default:if(!W)for(Te=1,W=new Array(b-1);Te<b;Te++)W[Te-1]=arguments[Te];P[fe].fn.apply(P[fe].context,W)}}return!0},K.prototype.on=function(ht,lt,tt){return I(this,ht,lt,tt,!1)},K.prototype.once=function(ht,lt,tt){return I(this,ht,lt,tt,!0)},K.prototype.removeListener=function(ht,lt,tt,be){var it=ot?ot+ht:ht;if(!this._events[it])return this;if(!lt)return xt(this,it),this;var st=this._events[it];if(st.fn)st.fn===lt&&(!be||st.once)&&(!tt||st.context===tt)&&xt(this,it);else{for(var Ut=0,P=[],b=st.length;Ut<b;Ut++)(st[Ut].fn!==lt||be&&!st[Ut].once||tt&&st[Ut].context!==tt)&&P.push(st[Ut]);P.length?this._events[it]=P.length===1?P[0]:P:xt(this,it)}return this},K.prototype.removeAllListeners=function(ht){var lt;return ht?(lt=ot?ot+ht:ht,this._events[lt]&&xt(this,lt)):(this._events=new kt,this._eventsCount=0),this},K.prototype.off=K.prototype.removeListener,K.prototype.addListener=K.prototype.on,K.prefixed=ot,K.EventEmitter=K,gn.exports=K},87026:function(gn,Ot){(function(ot,kt){kt(Ot)})(this,function(ot){"use strict";function kt(Ut,P,b,W){W=W||{};var fe=W.maxIterations||100,Ee=W.tolerance||1e-10,Te=Ut(P),Mt=Ut(b),et=b-P;if(Te*Mt>0)throw"Initial bisect points must have opposite signs";if(Te===0)return P;if(Mt===0)return b;for(var Dt=0;Dt<fe;++Dt){et/=2;var we=P+et,_e=Ut(we);if(_e*Te>=0&&(P=we),Math.abs(et)<Ee||_e===0)return we}return P+et}function bt(Ut){for(var P=new Array(Ut),b=0;b<Ut;++b)P[b]=0;return P}function I(Ut,P){return bt(Ut).map(function(){return bt(P)})}function xt(Ut,P){for(var b=0,W=0;W<Ut.length;++W)b+=Ut[W]*P[W];return b}function K(Ut){return Math.sqrt(xt(Ut,Ut))}function ut(Ut,P,b){for(var W=0;W<P.length;++W)Ut[W]=P[W]*b}function ht(Ut,P,b,W,fe){for(var Ee=0;Ee<Ut.length;++Ee)Ut[Ee]=P*b[Ee]+W*fe[Ee]}function lt(Ut,P,b){b=b||{};var W=b.maxIterations||P.length*200,fe=b.nonZeroDelta||1.05,Ee=b.zeroDelta||.001,Te=b.minErrorDelta||1e-6,Mt=b.minErrorDelta||1e-5,et=b.rho!==void 0?b.rho:1,Dt=b.chi!==void 0?b.chi:2,we=b.psi!==void 0?b.psi:-.5,_e=b.sigma!==void 0?b.sigma:.5,ge,te=P.length,xe=new Array(te+1);xe[0]=P,xe[0].fx=Ut(P),xe[0].id=0;for(var Ye=0;Ye<te;++Ye){var Lt=P.slice();Lt[Ye]=Lt[Ye]?Lt[Ye]*fe:Ee,xe[Ye+1]=Lt,xe[Ye+1].fx=Ut(Lt),xe[Ye+1].id=Ye+1}function Qt(Me){for(var ae=0;ae<Me.length;ae++)xe[te][ae]=Me[ae];xe[te].fx=Me.fx}for(var ct=function(Me,ae){return Me.fx-ae.fx},Ct=P.slice(),Y=P.slice(),yt=P.slice(),Xt=P.slice(),ie=0;ie<W;++ie){if(xe.sort(ct),b.history){var Ce=xe.map(function(Me){var ae=Me.slice();return ae.fx=Me.fx,ae.id=Me.id,ae});Ce.sort(function(Me,ae){return Me.id-ae.id}),b.history.push({x:xe[0].slice(),fx:xe[0].fx,simplex:Ce})}for(ge=0,Ye=0;Ye<te;++Ye)ge=Math.max(ge,Math.abs(xe[0][Ye]-xe[1][Ye]));if(Math.abs(xe[0].fx-xe[te].fx)<Te&&ge<Mt)break;for(Ye=0;Ye<te;++Ye){Ct[Ye]=0;for(var er=0;er<te;++er)Ct[Ye]+=xe[er][Ye];Ct[Ye]/=te}var Ht=xe[te];if(ht(Y,1+et,Ct,-et,Ht),Y.fx=Ut(Y),Y.fx<xe[0].fx)ht(Xt,1+Dt,Ct,-Dt,Ht),Xt.fx=Ut(Xt),Xt.fx<Y.fx?Qt(Xt):Qt(Y);else if(Y.fx>=xe[te-1].fx){var ne=!1;if(Y.fx>Ht.fx?(ht(yt,1+we,Ct,-we,Ht),yt.fx=Ut(yt),yt.fx<Ht.fx?Qt(yt):ne=!0):(ht(yt,1-we*et,Ct,we*et,Ht),yt.fx=Ut(yt),yt.fx<Y.fx?Qt(yt):ne=!0),ne){if(_e>=1)break;for(Ye=1;Ye<xe.length;++Ye)ht(xe[Ye],1-_e,xe[0],_e,xe[Ye]),xe[Ye].fx=Ut(xe[Ye])}}else Qt(Y)}return xe.sort(ct),{fx:xe[0].fx,x:xe[0]}}function tt(Ut,P,b,W,fe,Ee,Te){var Mt=b.fx,et=xt(b.fxprime,P),Dt=Mt,we=Mt,_e=et,ge=0;fe=fe||1,Ee=Ee||1e-6,Te=Te||.1;function te(Ye,Lt,Qt){for(var ct=0;ct<16;++ct)if(fe=(Ye+Lt)/2,ht(W.x,1,b.x,fe,P),Dt=W.fx=Ut(W.x,W.fxprime),_e=xt(W.fxprime,P),Dt>Mt+Ee*fe*et||Dt>=Qt)Lt=fe;else{if(Math.abs(_e)<=-Te*et)return fe;_e*(Lt-Ye)>=0&&(Lt=Ye),Ye=fe,Qt=Dt}return 0}for(var xe=0;xe<10;++xe){if(ht(W.x,1,b.x,fe,P),Dt=W.fx=Ut(W.x,W.fxprime),_e=xt(W.fxprime,P),Dt>Mt+Ee*fe*et||xe&&Dt>=we)return te(ge,fe,we);if(Math.abs(_e)<=-Te*et)return fe;if(_e>=0)return te(fe,ge,Dt);we=Dt,ge=fe,fe*=2}return fe}function be(Ut,P,b){var W={x:P.slice(),fx:0,fxprime:P.slice()},fe={x:P.slice(),fx:0,fxprime:P.slice()},Ee=P.slice(),Te,Mt,et=1,Dt;b=b||{},Dt=b.maxIterations||P.length*20,W.fx=Ut(W.x,W.fxprime),Te=W.fxprime.slice(),ut(Te,W.fxprime,-1);for(var we=0;we<Dt;++we){if(et=tt(Ut,Te,W,fe,et),b.history&&b.history.push({x:W.x.slice(),fx:W.fx,fxprime:W.fxprime.slice(),alpha:et}),!et)ut(Te,W.fxprime,-1);else{ht(Ee,1,fe.fxprime,-1,W.fxprime);var _e=xt(W.fxprime,W.fxprime),ge=Math.max(0,xt(Ee,fe.fxprime)/_e);ht(Te,ge,Te,-1,fe.fxprime),Mt=W,W=fe,fe=Mt}if(K(W.fxprime)<=1e-5)break}return b.history&&b.history.push({x:W.x.slice(),fx:W.fx,fxprime:W.fxprime.slice(),alpha:et}),W}function it(Ut,P,b){b=b||{};for(var W=b.maxIterations||P.length*100,fe=b.learnRate||.001,Ee={x:P.slice(),fx:0,fxprime:P.slice()},Te=0;Te<W&&(Ee.fx=Ut(Ee.x,Ee.fxprime),b.history&&b.history.push({x:Ee.x.slice(),fx:Ee.fx,fxprime:Ee.fxprime.slice()}),ht(Ee.x,1,Ee.x,-fe,Ee.fxprime),!(K(Ee.fxprime)<=1e-5));++Te);return Ee}function st(Ut,P,b){b=b||{};var W={x:P.slice(),fx:0,fxprime:P.slice()},fe={x:P.slice(),fx:0,fxprime:P.slice()},Ee=b.maxIterations||P.length*100,Te=b.learnRate||1,Mt=P.slice(),et=b.c1||.001,Dt=b.c2||.1,we,_e=[];if(b.history){var ge=Ut;Ut=function(xe,Ye){return _e.push(xe.slice()),ge(xe,Ye)}}W.fx=Ut(W.x,W.fxprime);for(var te=0;te<Ee&&(ut(Mt,W.fxprime,-1),Te=tt(Ut,Mt,W,fe,Te,et,Dt),b.history&&(b.history.push({x:W.x.slice(),fx:W.fx,fxprime:W.fxprime.slice(),functionCalls:_e,learnRate:Te,alpha:Te}),_e=[]),we=W,W=fe,fe=we,!(Te===0||K(W.fxprime)<1e-5));++te);return W}ot.bisect=kt,ot.nelderMead=lt,ot.conjugateGradient=be,ot.gradientDescent=it,ot.gradientDescentLineSearch=st,ot.zeros=bt,ot.zerosM=I,ot.norm2=K,ot.weightedSum=ht,ot.scale=ut})},49685:function(gn,Ot,ot){"use strict";ot.d(Ot,{FD:function(){return I},Ib:function(){return kt},WT:function(){return bt}});var kt=1e-6,bt=typeof Float32Array!="undefined"?Float32Array:Array,I=Math.random;function xt(lt){bt=lt}var K=Math.PI/180;function ut(lt){return lt*K}function ht(lt,tt){return Math.abs(lt-tt)<=kt*Math.max(1,Math.abs(lt),Math.abs(tt))}Math.hypot||(Math.hypot=function(){for(var lt=0,tt=arguments.length;tt--;)lt+=arguments[tt]*arguments[tt];return Math.sqrt(lt)})},35600:function(gn,Ot,ot){"use strict";ot.d(Ot,{Jp:function(){return st},U_:function(){return tt},Us:function(){return fe},vc:function(){return W},xJ:function(){return Ee}});function kt(){var Y=new glMatrix.ARRAY_TYPE(9);return glMatrix.ARRAY_TYPE!=Float32Array&&(Y[1]=0,Y[2]=0,Y[3]=0,Y[5]=0,Y[6]=0,Y[7]=0),Y[0]=1,Y[4]=1,Y[8]=1,Y}function bt(Y,yt){return Y[0]=yt[0],Y[1]=yt[1],Y[2]=yt[2],Y[3]=yt[4],Y[4]=yt[5],Y[5]=yt[6],Y[6]=yt[8],Y[7]=yt[9],Y[8]=yt[10],Y}function I(Y){var yt=new glMatrix.ARRAY_TYPE(9);return yt[0]=Y[0],yt[1]=Y[1],yt[2]=Y[2],yt[3]=Y[3],yt[4]=Y[4],yt[5]=Y[5],yt[6]=Y[6],yt[7]=Y[7],yt[8]=Y[8],yt}function xt(Y,yt){return Y[0]=yt[0],Y[1]=yt[1],Y[2]=yt[2],Y[3]=yt[3],Y[4]=yt[4],Y[5]=yt[5],Y[6]=yt[6],Y[7]=yt[7],Y[8]=yt[8],Y}function K(Y,yt,Xt,ie,Ce,er,Ht,ne,Me){var ae=new glMatrix.ARRAY_TYPE(9);return ae[0]=Y,ae[1]=yt,ae[2]=Xt,ae[3]=ie,ae[4]=Ce,ae[5]=er,ae[6]=Ht,ae[7]=ne,ae[8]=Me,ae}function ut(Y,yt,Xt,ie,Ce,er,Ht,ne,Me,ae){return Y[0]=yt,Y[1]=Xt,Y[2]=ie,Y[3]=Ce,Y[4]=er,Y[5]=Ht,Y[6]=ne,Y[7]=Me,Y[8]=ae,Y}function ht(Y){return Y[0]=1,Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=1,Y[5]=0,Y[6]=0,Y[7]=0,Y[8]=1,Y}function lt(Y,yt){if(Y===yt){var Xt=yt[1],ie=yt[2],Ce=yt[5];Y[1]=yt[3],Y[2]=yt[6],Y[3]=Xt,Y[5]=yt[7],Y[6]=ie,Y[7]=Ce}else Y[0]=yt[0],Y[1]=yt[3],Y[2]=yt[6],Y[3]=yt[1],Y[4]=yt[4],Y[5]=yt[7],Y[6]=yt[2],Y[7]=yt[5],Y[8]=yt[8];return Y}function tt(Y,yt){var Xt=yt[0],ie=yt[1],Ce=yt[2],er=yt[3],Ht=yt[4],ne=yt[5],Me=yt[6],ae=yt[7],Je=yt[8],or=Je*Ht-ne*ae,re=-Je*er+ne*Me,Jt=ae*er-Ht*Me,Et=Xt*or+ie*re+Ce*Jt;return Et?(Et=1/Et,Y[0]=or*Et,Y[1]=(-Je*ie+Ce*ae)*Et,Y[2]=(ne*ie-Ce*Ht)*Et,Y[3]=re*Et,Y[4]=(Je*Xt-Ce*Me)*Et,Y[5]=(-ne*Xt+Ce*er)*Et,Y[6]=Jt*Et,Y[7]=(-ae*Xt+ie*Me)*Et,Y[8]=(Ht*Xt-ie*er)*Et,Y):null}function be(Y,yt){var Xt=yt[0],ie=yt[1],Ce=yt[2],er=yt[3],Ht=yt[4],ne=yt[5],Me=yt[6],ae=yt[7],Je=yt[8];return Y[0]=Ht*Je-ne*ae,Y[1]=Ce*ae-ie*Je,Y[2]=ie*ne-Ce*Ht,Y[3]=ne*Me-er*Je,Y[4]=Xt*Je-Ce*Me,Y[5]=Ce*er-Xt*ne,Y[6]=er*ae-Ht*Me,Y[7]=ie*Me-Xt*ae,Y[8]=Xt*Ht-ie*er,Y}function it(Y){var yt=Y[0],Xt=Y[1],ie=Y[2],Ce=Y[3],er=Y[4],Ht=Y[5],ne=Y[6],Me=Y[7],ae=Y[8];return yt*(ae*er-Ht*Me)+Xt*(-ae*Ce+Ht*ne)+ie*(Me*Ce-er*ne)}function st(Y,yt,Xt){var ie=yt[0],Ce=yt[1],er=yt[2],Ht=yt[3],ne=yt[4],Me=yt[5],ae=yt[6],Je=yt[7],or=yt[8],re=Xt[0],Jt=Xt[1],Et=Xt[2],$t=Xt[3],Yt=Xt[4],St=Xt[5],At=Xt[6],ue=Xt[7],Pe=Xt[8];return Y[0]=re*ie+Jt*Ht+Et*ae,Y[1]=re*Ce+Jt*ne+Et*Je,Y[2]=re*er+Jt*Me+Et*or,Y[3]=$t*ie+Yt*Ht+St*ae,Y[4]=$t*Ce+Yt*ne+St*Je,Y[5]=$t*er+Yt*Me+St*or,Y[6]=At*ie+ue*Ht+Pe*ae,Y[7]=At*Ce+ue*ne+Pe*Je,Y[8]=At*er+ue*Me+Pe*or,Y}function Ut(Y,yt,Xt){var ie=yt[0],Ce=yt[1],er=yt[2],Ht=yt[3],ne=yt[4],Me=yt[5],ae=yt[6],Je=yt[7],or=yt[8],re=Xt[0],Jt=Xt[1];return Y[0]=ie,Y[1]=Ce,Y[2]=er,Y[3]=Ht,Y[4]=ne,Y[5]=Me,Y[6]=re*ie+Jt*Ht+ae,Y[7]=re*Ce+Jt*ne+Je,Y[8]=re*er+Jt*Me+or,Y}function P(Y,yt,Xt){var ie=yt[0],Ce=yt[1],er=yt[2],Ht=yt[3],ne=yt[4],Me=yt[5],ae=yt[6],Je=yt[7],or=yt[8],re=Math.sin(Xt),Jt=Math.cos(Xt);return Y[0]=Jt*ie+re*Ht,Y[1]=Jt*Ce+re*ne,Y[2]=Jt*er+re*Me,Y[3]=Jt*Ht-re*ie,Y[4]=Jt*ne-re*Ce,Y[5]=Jt*Me-re*er,Y[6]=ae,Y[7]=Je,Y[8]=or,Y}function b(Y,yt,Xt){var ie=Xt[0],Ce=Xt[1];return Y[0]=ie*yt[0],Y[1]=ie*yt[1],Y[2]=ie*yt[2],Y[3]=Ce*yt[3],Y[4]=Ce*yt[4],Y[5]=Ce*yt[5],Y[6]=yt[6],Y[7]=yt[7],Y[8]=yt[8],Y}function W(Y,yt){return Y[0]=1,Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=1,Y[5]=0,Y[6]=yt[0],Y[7]=yt[1],Y[8]=1,Y}function fe(Y,yt){var Xt=Math.sin(yt),ie=Math.cos(yt);return Y[0]=ie,Y[1]=Xt,Y[2]=0,Y[3]=-Xt,Y[4]=ie,Y[5]=0,Y[6]=0,Y[7]=0,Y[8]=1,Y}function Ee(Y,yt){return Y[0]=yt[0],Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=yt[1],Y[5]=0,Y[6]=0,Y[7]=0,Y[8]=1,Y}function Te(Y,yt){return Y[0]=yt[0],Y[1]=yt[1],Y[2]=0,Y[3]=yt[2],Y[4]=yt[3],Y[5]=0,Y[6]=yt[4],Y[7]=yt[5],Y[8]=1,Y}function Mt(Y,yt){var Xt=yt[0],ie=yt[1],Ce=yt[2],er=yt[3],Ht=Xt+Xt,ne=ie+ie,Me=Ce+Ce,ae=Xt*Ht,Je=ie*Ht,or=ie*ne,re=Ce*Ht,Jt=Ce*ne,Et=Ce*Me,$t=er*Ht,Yt=er*ne,St=er*Me;return Y[0]=1-or-Et,Y[3]=Je-St,Y[6]=re+Yt,Y[1]=Je+St,Y[4]=1-ae-Et,Y[7]=Jt-$t,Y[2]=re-Yt,Y[5]=Jt+$t,Y[8]=1-ae-or,Y}function et(Y,yt){var Xt=yt[0],ie=yt[1],Ce=yt[2],er=yt[3],Ht=yt[4],ne=yt[5],Me=yt[6],ae=yt[7],Je=yt[8],or=yt[9],re=yt[10],Jt=yt[11],Et=yt[12],$t=yt[13],Yt=yt[14],St=yt[15],At=Xt*ne-ie*Ht,ue=Xt*Me-Ce*Ht,Pe=Xt*ae-er*Ht,je=ie*Me-Ce*ne,Nt=ie*ae-er*ne,wt=Ce*ae-er*Me,Tt=Je*$t-or*Et,Ft=Je*Yt-re*Et,J=Je*St-Jt*Et,gt=or*Yt-re*$t,jt=or*St-Jt*$t,ve=re*St-Jt*Yt,Gt=At*ve-ue*jt+Pe*gt+je*J-Nt*Ft+wt*Tt;return Gt?(Gt=1/Gt,Y[0]=(ne*ve-Me*jt+ae*gt)*Gt,Y[1]=(Me*J-Ht*ve-ae*Ft)*Gt,Y[2]=(Ht*jt-ne*J+ae*Tt)*Gt,Y[3]=(Ce*jt-ie*ve-er*gt)*Gt,Y[4]=(Xt*ve-Ce*J+er*Ft)*Gt,Y[5]=(ie*J-Xt*jt-er*Tt)*Gt,Y[6]=($t*wt-Yt*Nt+St*je)*Gt,Y[7]=(Yt*Pe-Et*wt-St*ue)*Gt,Y[8]=(Et*Nt-$t*Pe+St*At)*Gt,Y):null}function Dt(Y,yt,Xt){return Y[0]=2/yt,Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=-2/Xt,Y[5]=0,Y[6]=-1,Y[7]=1,Y[8]=1,Y}function we(Y){return"mat3("+Y[0]+", "+Y[1]+", "+Y[2]+", "+Y[3]+", "+Y[4]+", "+Y[5]+", "+Y[6]+", "+Y[7]+", "+Y[8]+")"}function _e(Y){return Math.hypot(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5],Y[6],Y[7],Y[8])}function ge(Y,yt,Xt){return Y[0]=yt[0]+Xt[0],Y[1]=yt[1]+Xt[1],Y[2]=yt[2]+Xt[2],Y[3]=yt[3]+Xt[3],Y[4]=yt[4]+Xt[4],Y[5]=yt[5]+Xt[5],Y[6]=yt[6]+Xt[6],Y[7]=yt[7]+Xt[7],Y[8]=yt[8]+Xt[8],Y}function te(Y,yt,Xt){return Y[0]=yt[0]-Xt[0],Y[1]=yt[1]-Xt[1],Y[2]=yt[2]-Xt[2],Y[3]=yt[3]-Xt[3],Y[4]=yt[4]-Xt[4],Y[5]=yt[5]-Xt[5],Y[6]=yt[6]-Xt[6],Y[7]=yt[7]-Xt[7],Y[8]=yt[8]-Xt[8],Y}function xe(Y,yt,Xt){return Y[0]=yt[0]*Xt,Y[1]=yt[1]*Xt,Y[2]=yt[2]*Xt,Y[3]=yt[3]*Xt,Y[4]=yt[4]*Xt,Y[5]=yt[5]*Xt,Y[6]=yt[6]*Xt,Y[7]=yt[7]*Xt,Y[8]=yt[8]*Xt,Y}function Ye(Y,yt,Xt,ie){return Y[0]=yt[0]+Xt[0]*ie,Y[1]=yt[1]+Xt[1]*ie,Y[2]=yt[2]+Xt[2]*ie,Y[3]=yt[3]+Xt[3]*ie,Y[4]=yt[4]+Xt[4]*ie,Y[5]=yt[5]+Xt[5]*ie,Y[6]=yt[6]+Xt[6]*ie,Y[7]=yt[7]+Xt[7]*ie,Y[8]=yt[8]+Xt[8]*ie,Y}function Lt(Y,yt){return Y[0]===yt[0]&&Y[1]===yt[1]&&Y[2]===yt[2]&&Y[3]===yt[3]&&Y[4]===yt[4]&&Y[5]===yt[5]&&Y[6]===yt[6]&&Y[7]===yt[7]&&Y[8]===yt[8]}function Qt(Y,yt){var Xt=Y[0],ie=Y[1],Ce=Y[2],er=Y[3],Ht=Y[4],ne=Y[5],Me=Y[6],ae=Y[7],Je=Y[8],or=yt[0],re=yt[1],Jt=yt[2],Et=yt[3],$t=yt[4],Yt=yt[5],St=yt[6],At=yt[7],ue=yt[8];return Math.abs(Xt-or)<=glMatrix.EPSILON*Math.max(1,Math.abs(Xt),Math.abs(or))&&Math.abs(ie-re)<=glMatrix.EPSILON*Math.max(1,Math.abs(ie),Math.abs(re))&&Math.abs(Ce-Jt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Ce),Math.abs(Jt))&&Math.abs(er-Et)<=glMatrix.EPSILON*Math.max(1,Math.abs(er),Math.abs(Et))&&Math.abs(Ht-$t)<=glMatrix.EPSILON*Math.max(1,Math.abs(Ht),Math.abs($t))&&Math.abs(ne-Yt)<=glMatrix.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Yt))&&Math.abs(Me-St)<=glMatrix.EPSILON*Math.max(1,Math.abs(Me),Math.abs(St))&&Math.abs(ae-At)<=glMatrix.EPSILON*Math.max(1,Math.abs(ae),Math.abs(At))&&Math.abs(Je-ue)<=glMatrix.EPSILON*Math.max(1,Math.abs(Je),Math.abs(ue))}var ct=null,Ct=null},31437:function(gn,Ot,ot){"use strict";ot.d(Ot,{$X:function(){return lt},AK:function(){return ge},EU:function(){return yt},Fp:function(){return P},Fv:function(){return _e},I6:function(){return Ce},IH:function(){return ht},JG:function(){return K},TE:function(){return Ee},Ue:function(){return bt},VV:function(){return Ut},al:function(){return xt},bA:function(){return W},kE:function(){return Mt},kK:function(){return ct},lu:function(){return ne},t7:function(){return xe},t8:function(){return ut},tk:function(){return Dt}});var kt=ot(49685);function bt(){var Et=new kt.WT(2);return kt.WT!=Float32Array&&(Et[0]=0,Et[1]=0),Et}function I(Et){var $t=new glMatrix.ARRAY_TYPE(2);return $t[0]=Et[0],$t[1]=Et[1],$t}function xt(Et,$t){var Yt=new kt.WT(2);return Yt[0]=Et,Yt[1]=$t,Yt}function K(Et,$t){return Et[0]=$t[0],Et[1]=$t[1],Et}function ut(Et,$t,Yt){return Et[0]=$t,Et[1]=Yt,Et}function ht(Et,$t,Yt){return Et[0]=$t[0]+Yt[0],Et[1]=$t[1]+Yt[1],Et}function lt(Et,$t,Yt){return Et[0]=$t[0]-Yt[0],Et[1]=$t[1]-Yt[1],Et}function tt(Et,$t,Yt){return Et[0]=$t[0]*Yt[0],Et[1]=$t[1]*Yt[1],Et}function be(Et,$t,Yt){return Et[0]=$t[0]/Yt[0],Et[1]=$t[1]/Yt[1],Et}function it(Et,$t){return Et[0]=Math.ceil($t[0]),Et[1]=Math.ceil($t[1]),Et}function st(Et,$t){return Et[0]=Math.floor($t[0]),Et[1]=Math.floor($t[1]),Et}function Ut(Et,$t,Yt){return Et[0]=Math.min($t[0],Yt[0]),Et[1]=Math.min($t[1],Yt[1]),Et}function P(Et,$t,Yt){return Et[0]=Math.max($t[0],Yt[0]),Et[1]=Math.max($t[1],Yt[1]),Et}function b(Et,$t){return Et[0]=Math.round($t[0]),Et[1]=Math.round($t[1]),Et}function W(Et,$t,Yt){return Et[0]=$t[0]*Yt,Et[1]=$t[1]*Yt,Et}function fe(Et,$t,Yt,St){return Et[0]=$t[0]+Yt[0]*St,Et[1]=$t[1]+Yt[1]*St,Et}function Ee(Et,$t){var Yt=$t[0]-Et[0],St=$t[1]-Et[1];return Math.hypot(Yt,St)}function Te(Et,$t){var Yt=$t[0]-Et[0],St=$t[1]-Et[1];return Yt*Yt+St*St}function Mt(Et){var $t=Et[0],Yt=Et[1];return Math.hypot($t,Yt)}function et(Et){var $t=Et[0],Yt=Et[1];return $t*$t+Yt*Yt}function Dt(Et,$t){return Et[0]=-$t[0],Et[1]=-$t[1],Et}function we(Et,$t){return Et[0]=1/$t[0],Et[1]=1/$t[1],Et}function _e(Et,$t){var Yt=$t[0],St=$t[1],At=Yt*Yt+St*St;return At>0&&(At=1/Math.sqrt(At)),Et[0]=$t[0]*At,Et[1]=$t[1]*At,Et}function ge(Et,$t){return Et[0]*$t[0]+Et[1]*$t[1]}function te(Et,$t,Yt){var St=$t[0]*Yt[1]-$t[1]*Yt[0];return Et[0]=Et[1]=0,Et[2]=St,Et}function xe(Et,$t,Yt,St){var At=$t[0],ue=$t[1];return Et[0]=At+St*(Yt[0]-At),Et[1]=ue+St*(Yt[1]-ue),Et}function Ye(Et,$t){$t=$t||1;var Yt=glMatrix.RANDOM()*2*Math.PI;return Et[0]=Math.cos(Yt)*$t,Et[1]=Math.sin(Yt)*$t,Et}function Lt(Et,$t,Yt){var St=$t[0],At=$t[1];return Et[0]=Yt[0]*St+Yt[2]*At,Et[1]=Yt[1]*St+Yt[3]*At,Et}function Qt(Et,$t,Yt){var St=$t[0],At=$t[1];return Et[0]=Yt[0]*St+Yt[2]*At+Yt[4],Et[1]=Yt[1]*St+Yt[3]*At+Yt[5],Et}function ct(Et,$t,Yt){var St=$t[0],At=$t[1];return Et[0]=Yt[0]*St+Yt[3]*At+Yt[6],Et[1]=Yt[1]*St+Yt[4]*At+Yt[7],Et}function Ct(Et,$t,Yt){var St=$t[0],At=$t[1];return Et[0]=Yt[0]*St+Yt[4]*At+Yt[12],Et[1]=Yt[1]*St+Yt[5]*At+Yt[13],Et}function Y(Et,$t,Yt,St){var At=$t[0]-Yt[0],ue=$t[1]-Yt[1],Pe=Math.sin(St),je=Math.cos(St);return Et[0]=At*je-ue*Pe+Yt[0],Et[1]=At*Pe+ue*je+Yt[1],Et}function yt(Et,$t){var Yt=Et[0],St=Et[1],At=$t[0],ue=$t[1],Pe=Math.sqrt(Yt*Yt+St*St)*Math.sqrt(At*At+ue*ue),je=Pe&&(Yt*At+St*ue)/Pe;return Math.acos(Math.min(Math.max(je,-1),1))}function Xt(Et){return Et[0]=0,Et[1]=0,Et}function ie(Et){return"vec2("+Et[0]+", "+Et[1]+")"}function Ce(Et,$t){return Et[0]===$t[0]&&Et[1]===$t[1]}function er(Et,$t){var Yt=Et[0],St=Et[1],At=$t[0],ue=$t[1];return Math.abs(Yt-At)<=glMatrix.EPSILON*Math.max(1,Math.abs(Yt),Math.abs(At))&&Math.abs(St-ue)<=glMatrix.EPSILON*Math.max(1,Math.abs(St),Math.abs(ue))}var Ht=null,ne=lt,Me=null,ae=null,Je=null,or=null,re=null,Jt=function(){var Et=bt();return function($t,Yt,St,At,ue,Pe){var je,Nt;for(Yt||(Yt=2),St||(St=0),At?Nt=Math.min(At*Yt+St,$t.length):Nt=$t.length,je=St;je<Nt;je+=Yt)Et[0]=$t[je],Et[1]=$t[je+1],ue(Et,Et,Pe),$t[je]=Et[0],$t[je+1]=Et[1];return $t}}()},77160:function(gn,Ot,ot){"use strict";ot.r(Ot),ot.d(Ot,{add:function(){return lt},angle:function(){return Ce},bezier:function(){return Lt},ceil:function(){return st},clone:function(){return I},copy:function(){return ut},create:function(){return bt},cross:function(){return te},dist:function(){return re},distance:function(){return Te},div:function(){return or},divide:function(){return it},dot:function(){return ge},equals:function(){return Me},exactEquals:function(){return ne},floor:function(){return Ut},forEach:function(){return Yt},fromValues:function(){return K},hermite:function(){return Ye},inverse:function(){return we},len:function(){return Et},length:function(){return xt},lerp:function(){return xe},max:function(){return b},min:function(){return P},mul:function(){return Je},multiply:function(){return be},negate:function(){return Dt},normalize:function(){return _e},random:function(){return Qt},rotateX:function(){return yt},rotateY:function(){return Xt},rotateZ:function(){return ie},round:function(){return W},scale:function(){return fe},scaleAndAdd:function(){return Ee},set:function(){return ht},sqrDist:function(){return Jt},sqrLen:function(){return $t},squaredDistance:function(){return Mt},squaredLength:function(){return et},str:function(){return Ht},sub:function(){return ae},subtract:function(){return tt},transformMat3:function(){return Ct},transformMat4:function(){return ct},transformQuat:function(){return Y},zero:function(){return er}});var kt=ot(49685);function bt(){var St=new kt.WT(3);return kt.WT!=Float32Array&&(St[0]=0,St[1]=0,St[2]=0),St}function I(St){var At=new kt.WT(3);return At[0]=St[0],At[1]=St[1],At[2]=St[2],At}function xt(St){var At=St[0],ue=St[1],Pe=St[2];return Math.hypot(At,ue,Pe)}function K(St,At,ue){var Pe=new kt.WT(3);return Pe[0]=St,Pe[1]=At,Pe[2]=ue,Pe}function ut(St,At){return St[0]=At[0],St[1]=At[1],St[2]=At[2],St}function ht(St,At,ue,Pe){return St[0]=At,St[1]=ue,St[2]=Pe,St}function lt(St,At,ue){return St[0]=At[0]+ue[0],St[1]=At[1]+ue[1],St[2]=At[2]+ue[2],St}function tt(St,At,ue){return St[0]=At[0]-ue[0],St[1]=At[1]-ue[1],St[2]=At[2]-ue[2],St}function be(St,At,ue){return St[0]=At[0]*ue[0],St[1]=At[1]*ue[1],St[2]=At[2]*ue[2],St}function it(St,At,ue){return St[0]=At[0]/ue[0],St[1]=At[1]/ue[1],St[2]=At[2]/ue[2],St}function st(St,At){return St[0]=Math.ceil(At[0]),St[1]=Math.ceil(At[1]),St[2]=Math.ceil(At[2]),St}function Ut(St,At){return St[0]=Math.floor(At[0]),St[1]=Math.floor(At[1]),St[2]=Math.floor(At[2]),St}function P(St,At,ue){return St[0]=Math.min(At[0],ue[0]),St[1]=Math.min(At[1],ue[1]),St[2]=Math.min(At[2],ue[2]),St}function b(St,At,ue){return St[0]=Math.max(At[0],ue[0]),St[1]=Math.max(At[1],ue[1]),St[2]=Math.max(At[2],ue[2]),St}function W(St,At){return St[0]=Math.round(At[0]),St[1]=Math.round(At[1]),St[2]=Math.round(At[2]),St}function fe(St,At,ue){return St[0]=At[0]*ue,St[1]=At[1]*ue,St[2]=At[2]*ue,St}function Ee(St,At,ue,Pe){return St[0]=At[0]+ue[0]*Pe,St[1]=At[1]+ue[1]*Pe,St[2]=At[2]+ue[2]*Pe,St}function Te(St,At){var ue=At[0]-St[0],Pe=At[1]-St[1],je=At[2]-St[2];return Math.hypot(ue,Pe,je)}function Mt(St,At){var ue=At[0]-St[0],Pe=At[1]-St[1],je=At[2]-St[2];return ue*ue+Pe*Pe+je*je}function et(St){var At=St[0],ue=St[1],Pe=St[2];return At*At+ue*ue+Pe*Pe}function Dt(St,At){return St[0]=-At[0],St[1]=-At[1],St[2]=-At[2],St}function we(St,At){return St[0]=1/At[0],St[1]=1/At[1],St[2]=1/At[2],St}function _e(St,At){var ue=At[0],Pe=At[1],je=At[2],Nt=ue*ue+Pe*Pe+je*je;return Nt>0&&(Nt=1/Math.sqrt(Nt)),St[0]=At[0]*Nt,St[1]=At[1]*Nt,St[2]=At[2]*Nt,St}function ge(St,At){return St[0]*At[0]+St[1]*At[1]+St[2]*At[2]}function te(St,At,ue){var Pe=At[0],je=At[1],Nt=At[2],wt=ue[0],Tt=ue[1],Ft=ue[2];return St[0]=je*Ft-Nt*Tt,St[1]=Nt*wt-Pe*Ft,St[2]=Pe*Tt-je*wt,St}function xe(St,At,ue,Pe){var je=At[0],Nt=At[1],wt=At[2];return St[0]=je+Pe*(ue[0]-je),St[1]=Nt+Pe*(ue[1]-Nt),St[2]=wt+Pe*(ue[2]-wt),St}function Ye(St,At,ue,Pe,je,Nt){var wt=Nt*Nt,Tt=wt*(2*Nt-3)+1,Ft=wt*(Nt-2)+Nt,J=wt*(Nt-1),gt=wt*(3-2*Nt);return St[0]=At[0]*Tt+ue[0]*Ft+Pe[0]*J+je[0]*gt,St[1]=At[1]*Tt+ue[1]*Ft+Pe[1]*J+je[1]*gt,St[2]=At[2]*Tt+ue[2]*Ft+Pe[2]*J+je[2]*gt,St}function Lt(St,At,ue,Pe,je,Nt){var wt=1-Nt,Tt=wt*wt,Ft=Nt*Nt,J=Tt*wt,gt=3*Nt*Tt,jt=3*Ft*wt,ve=Ft*Nt;return St[0]=At[0]*J+ue[0]*gt+Pe[0]*jt+je[0]*ve,St[1]=At[1]*J+ue[1]*gt+Pe[1]*jt+je[1]*ve,St[2]=At[2]*J+ue[2]*gt+Pe[2]*jt+je[2]*ve,St}function Qt(St,At){At=At||1;var ue=kt.FD()*2*Math.PI,Pe=kt.FD()*2-1,je=Math.sqrt(1-Pe*Pe)*At;return St[0]=Math.cos(ue)*je,St[1]=Math.sin(ue)*je,St[2]=Pe*At,St}function ct(St,At,ue){var Pe=At[0],je=At[1],Nt=At[2],wt=ue[3]*Pe+ue[7]*je+ue[11]*Nt+ue[15];return wt=wt||1,St[0]=(ue[0]*Pe+ue[4]*je+ue[8]*Nt+ue[12])/wt,St[1]=(ue[1]*Pe+ue[5]*je+ue[9]*Nt+ue[13])/wt,St[2]=(ue[2]*Pe+ue[6]*je+ue[10]*Nt+ue[14])/wt,St}function Ct(St,At,ue){var Pe=At[0],je=At[1],Nt=At[2];return St[0]=Pe*ue[0]+je*ue[3]+Nt*ue[6],St[1]=Pe*ue[1]+je*ue[4]+Nt*ue[7],St[2]=Pe*ue[2]+je*ue[5]+Nt*ue[8],St}function Y(St,At,ue){var Pe=ue[0],je=ue[1],Nt=ue[2],wt=ue[3],Tt=At[0],Ft=At[1],J=At[2],gt=je*J-Nt*Ft,jt=Nt*Tt-Pe*J,ve=Pe*Ft-je*Tt,Gt=je*ve-Nt*jt,Ae=Nt*gt-Pe*ve,He=Pe*jt-je*gt,qe=wt*2;return gt*=qe,jt*=qe,ve*=qe,Gt*=2,Ae*=2,He*=2,St[0]=Tt+gt+Gt,St[1]=Ft+jt+Ae,St[2]=J+ve+He,St}function yt(St,At,ue,Pe){var je=[],Nt=[];return je[0]=At[0]-ue[0],je[1]=At[1]-ue[1],je[2]=At[2]-ue[2],Nt[0]=je[0],Nt[1]=je[1]*Math.cos(Pe)-je[2]*Math.sin(Pe),Nt[2]=je[1]*Math.sin(Pe)+je[2]*Math.cos(Pe),St[0]=Nt[0]+ue[0],St[1]=Nt[1]+ue[1],St[2]=Nt[2]+ue[2],St}function Xt(St,At,ue,Pe){var je=[],Nt=[];return je[0]=At[0]-ue[0],je[1]=At[1]-ue[1],je[2]=At[2]-ue[2],Nt[0]=je[2]*Math.sin(Pe)+je[0]*Math.cos(Pe),Nt[1]=je[1],Nt[2]=je[2]*Math.cos(Pe)-je[0]*Math.sin(Pe),St[0]=Nt[0]+ue[0],St[1]=Nt[1]+ue[1],St[2]=Nt[2]+ue[2],St}function ie(St,At,ue,Pe){var je=[],Nt=[];return je[0]=At[0]-ue[0],je[1]=At[1]-ue[1],je[2]=At[2]-ue[2],Nt[0]=je[0]*Math.cos(Pe)-je[1]*Math.sin(Pe),Nt[1]=je[0]*Math.sin(Pe)+je[1]*Math.cos(Pe),Nt[2]=je[2],St[0]=Nt[0]+ue[0],St[1]=Nt[1]+ue[1],St[2]=Nt[2]+ue[2],St}function Ce(St,At){var ue=St[0],Pe=St[1],je=St[2],Nt=At[0],wt=At[1],Tt=At[2],Ft=Math.sqrt(ue*ue+Pe*Pe+je*je),J=Math.sqrt(Nt*Nt+wt*wt+Tt*Tt),gt=Ft*J,jt=gt&&ge(St,At)/gt;return Math.acos(Math.min(Math.max(jt,-1),1))}function er(St){return St[0]=0,St[1]=0,St[2]=0,St}function Ht(St){return"vec3("+St[0]+", "+St[1]+", "+St[2]+")"}function ne(St,At){return St[0]===At[0]&&St[1]===At[1]&&St[2]===At[2]}function Me(St,At){var ue=St[0],Pe=St[1],je=St[2],Nt=At[0],wt=At[1],Tt=At[2];return Math.abs(ue-Nt)<=kt.Ib*Math.max(1,Math.abs(ue),Math.abs(Nt))&&Math.abs(Pe-wt)<=kt.Ib*Math.max(1,Math.abs(Pe),Math.abs(wt))&&Math.abs(je-Tt)<=kt.Ib*Math.max(1,Math.abs(je),Math.abs(Tt))}var ae=tt,Je=be,or=it,re=Te,Jt=Mt,Et=xt,$t=et,Yt=function(){var St=bt();return function(At,ue,Pe,je,Nt,wt){var Tt,Ft;for(ue||(ue=3),Pe||(Pe=0),je?Ft=Math.min(je*ue+Pe,At.length):Ft=At.length,Tt=Pe;Tt<Ft;Tt+=ue)St[0]=At[Tt],St[1]=At[Tt+1],St[2]=At[Tt+2],Nt(St,St,wt),At[Tt]=St[0],At[Tt+1]=St[1],At[Tt+2]=St[2];return At}}()},7375:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});var ot=Symbol.for("INJECTION");function kt(ut,ht,lt,tt){function be(){return tt&&!Reflect.hasMetadata(ot,this,ht)&&Reflect.defineMetadata(ot,lt(),this,ht),Reflect.hasMetadata(ot,this,ht)?Reflect.getMetadata(ot,this,ht):lt()}function it(st){Reflect.defineMetadata(ot,st,this,ht)}Object.defineProperty(ut,ht,{configurable:!0,enumerable:!0,get:be,set:it})}function bt(ut,ht){return function(lt){return function(tt,be){var it=function(){return ut.get(lt)};kt(tt,be,it,ht)}}}Ot.makePropertyInjectDecorator=bt;function I(ut,ht){return function(lt,tt){return function(be,it){var st=function(){return ut.getNamed(lt,tt)};kt(be,it,st,ht)}}}Ot.makePropertyInjectNamedDecorator=I;function xt(ut,ht){return function(lt,tt,be){return function(it,st){var Ut=function(){return ut.getTagged(lt,tt,be)};kt(it,st,Ut,ht)}}}Ot.makePropertyInjectTaggedDecorator=xt;function K(ut,ht){return function(lt){return function(tt,be){var it=function(){return ut.getAll(lt)};kt(tt,be,it,ht)}}}Ot.makePropertyMultiInjectDecorator=K},84879:function(gn,Ot,ot){"use strict";var kt;kt={value:!0};var bt=ot(7375);function I(xt,K){K===void 0&&(K=!0);var ut=bt.makePropertyInjectDecorator(xt,K),ht=bt.makePropertyInjectNamedDecorator(xt,K),lt=bt.makePropertyInjectTaggedDecorator(xt,K),tt=bt.makePropertyMultiInjectDecorator(xt,K);return{lazyInject:ut,lazyInjectNamed:ht,lazyInjectTagged:lt,lazyMultiInject:tt}}Ot.Z=I},99934:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.tagProperty=Ot.tagParameter=Ot.decorate=void 0;var kt=ot(16674),bt=ot(6867);function I(tt,be,it,st){var Ut=bt.TAGGED;K(Ut,tt,be,st,it)}Ot.tagParameter=I;function xt(tt,be,it){var st=bt.TAGGED_PROP;K(st,tt.constructor,be,it)}Ot.tagProperty=xt;function K(tt,be,it,st,Ut){var P={},b=typeof Ut=="number",W=Ut!==void 0&&b?Ut.toString():it;if(b&&it!==void 0)throw new Error(kt.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(tt,be)&&(P=Reflect.getMetadata(tt,be));var fe=P[W];if(!Array.isArray(fe))fe=[];else for(var Ee=0,Te=fe;Ee<Te.length;Ee++){var Mt=Te[Ee];if(Mt.key===st.key)throw new Error(kt.DUPLICATED_METADATA+" "+Mt.key.toString())}fe.push(st),P[W]=fe,Reflect.defineMetadata(tt,P,be)}function ut(tt,be){Reflect.decorate(tt,be)}function ht(tt,be){return function(it,st){be(it,st,tt)}}function lt(tt,be,it){typeof it=="number"?ut([ht(it,tt)],be):typeof it=="string"?Reflect.decorate([tt],be,it):ut([tt],be)}Ot.decorate=lt},5744:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.inject=Ot.LazyServiceIdentifer=void 0;var kt=ot(16674),bt=ot(6867),I=ot(47738),xt=ot(99934),K=function(){function ht(lt){this._cb=lt}return ht.prototype.unwrap=function(){return this._cb()},ht}();Ot.LazyServiceIdentifer=K;function ut(ht){return function(lt,tt,be){if(ht===void 0)throw new Error(kt.UNDEFINED_INJECT_ANNOTATION(lt.name));var it=new I.Metadata(bt.INJECT_TAG,ht);typeof be=="number"?xt.tagParameter(lt,tt,be,it):xt.tagProperty(lt,tt,it)}}Ot.inject=ut},64315:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.injectable=void 0;var kt=ot(16674),bt=ot(6867);function I(){return function(xt){if(Reflect.hasOwnMetadata(bt.PARAM_TYPES,xt))throw new Error(kt.DUPLICATED_INJECTABLE_DECORATOR);var K=Reflect.getMetadata(bt.DESIGN_PARAM_TYPES,xt)||[];return Reflect.defineMetadata(bt.PARAM_TYPES,K,xt),xt}}Ot.injectable=I},71693:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.multiInject=void 0;var kt=ot(6867),bt=ot(47738),I=ot(99934);function xt(K){return function(ut,ht,lt){var tt=new bt.Metadata(kt.MULTI_INJECT_TAG,K);typeof lt=="number"?I.tagParameter(ut,ht,lt,tt):I.tagProperty(ut,ht,tt)}}Ot.multiInject=xt},38085:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.named=void 0;var kt=ot(6867),bt=ot(47738),I=ot(99934);function xt(K){return function(ut,ht,lt){var tt=new bt.Metadata(kt.NAMED_TAG,K);typeof lt=="number"?I.tagParameter(ut,ht,lt,tt):I.tagProperty(ut,ht,tt)}}Ot.named=xt},6515:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.optional=void 0;var kt=ot(6867),bt=ot(47738),I=ot(99934);function xt(){return function(K,ut,ht){var lt=new bt.Metadata(kt.OPTIONAL_TAG,!0);typeof ht=="number"?I.tagParameter(K,ut,ht,lt):I.tagProperty(K,ut,lt)}}Ot.optional=xt},7014:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.postConstruct=void 0;var kt=ot(16674),bt=ot(6867),I=ot(47738);function xt(){return function(K,ut,ht){var lt=new I.Metadata(bt.POST_CONSTRUCT,ut);if(Reflect.hasOwnMetadata(bt.POST_CONSTRUCT,K.constructor))throw new Error(kt.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(bt.POST_CONSTRUCT,lt,K.constructor)}}Ot.postConstruct=xt},32052:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.tagged=void 0;var kt=ot(47738),bt=ot(99934);function I(xt,K){return function(ut,ht,lt){var tt=new kt.Metadata(xt,K);typeof lt=="number"?bt.tagParameter(ut,ht,lt,tt):bt.tagProperty(ut,ht,tt)}}Ot.tagged=I},55638:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.targetName=void 0;var kt=ot(6867),bt=ot(47738),I=ot(99934);function xt(K){return function(ut,ht,lt){var tt=new bt.Metadata(kt.NAME_TAG,K);I.tagParameter(ut,ht,lt,tt)}}Ot.targetName=xt},86757:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.unmanaged=void 0;var kt=ot(6867),bt=ot(47738),I=ot(99934);function xt(){return function(K,ut,ht){var lt=new bt.Metadata(kt.UNMANAGED_TAG,!0);I.tagParameter(K,ut,ht,lt)}}Ot.unmanaged=xt},44290:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Binding=void 0;var kt=ot(28421),bt=ot(37791),I=function(){function xt(K,ut){this.id=bt.id(),this.activated=!1,this.serviceIdentifier=K,this.scope=ut,this.type=kt.BindingTypeEnum.Invalid,this.constraint=function(ht){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return xt.prototype.clone=function(){var K=new xt(this.serviceIdentifier,this.scope);return K.activated=K.scope===kt.BindingScopeEnum.Singleton?this.activated:!1,K.implementationType=this.implementationType,K.dynamicValue=this.dynamicValue,K.scope=this.scope,K.type=this.type,K.factory=this.factory,K.provider=this.provider,K.constraint=this.constraint,K.onActivation=this.onActivation,K.cache=this.cache,K},xt}();Ot.Binding=I},23184:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.BindingCount=void 0;var ot={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};Ot.BindingCount=ot},16674:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.STACK_OVERFLOW=Ot.CIRCULAR_DEPENDENCY_IN_FACTORY=Ot.POST_CONSTRUCT_ERROR=Ot.MULTIPLE_POST_CONSTRUCT_METHODS=Ot.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=Ot.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=Ot.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=Ot.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=Ot.ARGUMENTS_LENGTH_MISMATCH=Ot.INVALID_DECORATOR_OPERATION=Ot.INVALID_TO_SELF_VALUE=Ot.INVALID_FUNCTION_BINDING=Ot.INVALID_MIDDLEWARE_RETURN=Ot.NO_MORE_SNAPSHOTS_AVAILABLE=Ot.INVALID_BINDING_TYPE=Ot.NOT_IMPLEMENTED=Ot.CIRCULAR_DEPENDENCY=Ot.UNDEFINED_INJECT_ANNOTATION=Ot.MISSING_INJECT_ANNOTATION=Ot.MISSING_INJECTABLE_ANNOTATION=Ot.NOT_REGISTERED=Ot.CANNOT_UNBIND=Ot.AMBIGUOUS_MATCH=Ot.KEY_NOT_FOUND=Ot.NULL_ARGUMENT=Ot.DUPLICATED_METADATA=Ot.DUPLICATED_INJECTABLE_DECORATOR=void 0,Ot.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",Ot.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",Ot.NULL_ARGUMENT="NULL argument",Ot.KEY_NOT_FOUND="Key Not Found",Ot.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",Ot.CANNOT_UNBIND="Could not unbind serviceIdentifier:",Ot.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",Ot.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",Ot.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var ot=function(xt){return"@inject called with undefined this could mean that the class "+xt+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};Ot.UNDEFINED_INJECT_ANNOTATION=ot,Ot.CIRCULAR_DEPENDENCY="Circular dependency found:",Ot.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",Ot.INVALID_BINDING_TYPE="Invalid binding type:",Ot.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",Ot.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",Ot.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",Ot.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",Ot.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var kt=function(){for(var xt=[],K=0;K<arguments.length;K++)xt[K]=arguments[K];return"The number of constructor arguments in the derived class "+(xt[0]+" must be >= than the number of constructor arguments of its base class.")};Ot.ARGUMENTS_LENGTH_MISMATCH=kt,Ot.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",Ot.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",Ot.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",Ot.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",Ot.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var bt=function(){for(var xt=[],K=0;K<arguments.length;K++)xt[K]=arguments[K];return"@postConstruct error in class "+xt[0]+": "+xt[1]};Ot.POST_CONSTRUCT_ERROR=bt;var I=function(){for(var xt=[],K=0;K<arguments.length;K++)xt[K]=arguments[K];return"It looks like there is a circular dependency "+("in one of the '"+xt[0]+"' bindings. Please investigate bindings with")+("service identifier '"+xt[1]+"'.")};Ot.CIRCULAR_DEPENDENCY_IN_FACTORY=I,Ot.STACK_OVERFLOW="Maximum call stack size exceeded"},28421:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.TargetTypeEnum=Ot.BindingTypeEnum=Ot.BindingScopeEnum=void 0;var ot={Request:"Request",Singleton:"Singleton",Transient:"Transient"};Ot.BindingScopeEnum=ot;var kt={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};Ot.BindingTypeEnum=kt;var bt={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};Ot.TargetTypeEnum=bt},6867:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.NON_CUSTOM_TAG_KEYS=Ot.POST_CONSTRUCT=Ot.DESIGN_PARAM_TYPES=Ot.PARAM_TYPES=Ot.TAGGED_PROP=Ot.TAGGED=Ot.MULTI_INJECT_TAG=Ot.INJECT_TAG=Ot.OPTIONAL_TAG=Ot.UNMANAGED_TAG=Ot.NAME_TAG=Ot.NAMED_TAG=void 0,Ot.NAMED_TAG="named",Ot.NAME_TAG="name",Ot.UNMANAGED_TAG="unmanaged",Ot.OPTIONAL_TAG="optional",Ot.INJECT_TAG="inject",Ot.MULTI_INJECT_TAG="multi_inject",Ot.TAGGED="inversify:tagged",Ot.TAGGED_PROP="inversify:tagged_props",Ot.PARAM_TYPES="inversify:paramtypes",Ot.DESIGN_PARAM_TYPES="design:paramtypes",Ot.POST_CONSTRUCT="post_construct";function ot(){return[Ot.INJECT_TAG,Ot.MULTI_INJECT_TAG,Ot.NAME_TAG,Ot.UNMANAGED_TAG,Ot.NAMED_TAG,Ot.OPTIONAL_TAG]}Ot.NON_CUSTOM_TAG_KEYS=ot()},51389:function(gn,Ot,ot){"use strict";var kt=this&&this.__awaiter||function(fe,Ee,Te,Mt){function et(Dt){return Dt instanceof Te?Dt:new Te(function(we){we(Dt)})}return new(Te||(Te=Promise))(function(Dt,we){function _e(xe){try{te(Mt.next(xe))}catch(Ye){we(Ye)}}function ge(xe){try{te(Mt.throw(xe))}catch(Ye){we(Ye)}}function te(xe){xe.done?Dt(xe.value):et(xe.value).then(_e,ge)}te((Mt=Mt.apply(fe,Ee||[])).next())})},bt=this&&this.__generator||function(fe,Ee){var Te={label:0,sent:function(){if(Dt[0]&1)throw Dt[1];return Dt[1]},trys:[],ops:[]},Mt,et,Dt,we;return we={next:_e(0),throw:_e(1),return:_e(2)},typeof Symbol=="function"&&(we[Symbol.iterator]=function(){return this}),we;function _e(te){return function(xe){return ge([te,xe])}}function ge(te){if(Mt)throw new TypeError("Generator is already executing.");for(;Te;)try{if(Mt=1,et&&(Dt=te[0]&2?et.return:te[0]?et.throw||((Dt=et.return)&&Dt.call(et),0):et.next)&&!(Dt=Dt.call(et,te[1])).done)return Dt;switch(et=0,Dt&&(te=[te[0]&2,Dt.value]),te[0]){case 0:case 1:Dt=te;break;case 4:return Te.label++,{value:te[1],done:!1};case 5:Te.label++,et=te[1],te=[0];continue;case 7:te=Te.ops.pop(),Te.trys.pop();continue;default:if(Dt=Te.trys,!(Dt=Dt.length>0&&Dt[Dt.length-1])&&(te[0]===6||te[0]===2)){Te=0;continue}if(te[0]===3&&(!Dt||te[1]>Dt[0]&&te[1]<Dt[3])){Te.label=te[1];break}if(te[0]===6&&Te.label<Dt[1]){Te.label=Dt[1],Dt=te;break}if(Dt&&Te.label<Dt[2]){Te.label=Dt[2],Te.ops.push(te);break}Dt[2]&&Te.ops.pop(),Te.trys.pop();continue}te=Ee.call(fe,Te)}catch(xe){te=[6,xe],et=0}finally{Mt=Dt=0}if(te[0]&5)throw te[1];return{value:te[0]?te[1]:void 0,done:!0}}},I=this&&this.__spreadArray||function(fe,Ee){for(var Te=0,Mt=Ee.length,et=fe.length;Te<Mt;Te++,et++)fe[et]=Ee[Te];return fe};Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Container=void 0;var xt=ot(44290),K=ot(16674),ut=ot(28421),ht=ot(6867),lt=ot(51377),tt=ot(86311),be=ot(31927),it=ot(51860),st=ot(37791),Ut=ot(55800),P=ot(85700),b=ot(80175),W=function(){function fe(Ee){this._appliedMiddleware=[];var Te=Ee||{};if(typeof Te!="object")throw new Error(""+K.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(Te.defaultScope===void 0)Te.defaultScope=ut.BindingScopeEnum.Transient;else if(Te.defaultScope!==ut.BindingScopeEnum.Singleton&&Te.defaultScope!==ut.BindingScopeEnum.Transient&&Te.defaultScope!==ut.BindingScopeEnum.Request)throw new Error(""+K.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(Te.autoBindInjectable===void 0)Te.autoBindInjectable=!1;else if(typeof Te.autoBindInjectable!="boolean")throw new Error(""+K.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(Te.skipBaseClassChecks===void 0)Te.skipBaseClassChecks=!1;else if(typeof Te.skipBaseClassChecks!="boolean")throw new Error(""+K.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:Te.autoBindInjectable,defaultScope:Te.defaultScope,skipBaseClassChecks:Te.skipBaseClassChecks},this.id=st.id(),this._bindingDictionary=new b.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new lt.MetadataReader}return fe.merge=function(Ee,Te){for(var Mt=[],et=2;et<arguments.length;et++)Mt[et-2]=arguments[et];var Dt=new fe,we=I([Ee,Te],Mt).map(function(te){return tt.getBindingDictionary(te)}),_e=tt.getBindingDictionary(Dt);function ge(te,xe){te.traverse(function(Ye,Lt){Lt.forEach(function(Qt){xe.add(Qt.serviceIdentifier,Qt.clone())})})}return we.forEach(function(te){ge(te,_e)}),Dt},fe.prototype.load=function(){for(var Ee=[],Te=0;Te<arguments.length;Te++)Ee[Te]=arguments[Te];for(var Mt=this._getContainerModuleHelpersFactory(),et=0,Dt=Ee;et<Dt.length;et++){var we=Dt[et],_e=Mt(we.id);we.registry(_e.bindFunction,_e.unbindFunction,_e.isboundFunction,_e.rebindFunction)}},fe.prototype.loadAsync=function(){for(var Ee=[],Te=0;Te<arguments.length;Te++)Ee[Te]=arguments[Te];return kt(this,void 0,void 0,function(){var Mt,et,Dt,we,_e;return bt(this,function(ge){switch(ge.label){case 0:Mt=this._getContainerModuleHelpersFactory(),et=0,Dt=Ee,ge.label=1;case 1:return et<Dt.length?(we=Dt[et],_e=Mt(we.id),[4,we.registry(_e.bindFunction,_e.unbindFunction,_e.isboundFunction,_e.rebindFunction)]):[3,4];case 2:ge.sent(),ge.label=3;case 3:return et++,[3,1];case 4:return[2]}})})},fe.prototype.unload=function(){for(var Ee=this,Te=[],Mt=0;Mt<arguments.length;Mt++)Te[Mt]=arguments[Mt];var et=function(Dt){return function(we){return we.moduleId===Dt}};Te.forEach(function(Dt){var we=et(Dt.id);Ee._bindingDictionary.removeByCondition(we)})},fe.prototype.bind=function(Ee){var Te=this.options.defaultScope||ut.BindingScopeEnum.Transient,Mt=new xt.Binding(Ee,Te);return this._bindingDictionary.add(Ee,Mt),new it.BindingToSyntax(Mt)},fe.prototype.rebind=function(Ee){return this.unbind(Ee),this.bind(Ee)},fe.prototype.unbind=function(Ee){try{this._bindingDictionary.remove(Ee)}catch(Te){throw new Error(K.CANNOT_UNBIND+" "+Ut.getServiceIdentifierAsString(Ee))}},fe.prototype.unbindAll=function(){this._bindingDictionary=new b.Lookup},fe.prototype.isBound=function(Ee){var Te=this._bindingDictionary.hasKey(Ee);return!Te&&this.parent&&(Te=this.parent.isBound(Ee)),Te},fe.prototype.isBoundNamed=function(Ee,Te){return this.isBoundTagged(Ee,ht.NAMED_TAG,Te)},fe.prototype.isBoundTagged=function(Ee,Te,Mt){var et=!1;if(this._bindingDictionary.hasKey(Ee)){var Dt=this._bindingDictionary.get(Ee),we=tt.createMockRequest(this,Ee,Te,Mt);et=Dt.some(function(_e){return _e.constraint(we)})}return!et&&this.parent&&(et=this.parent.isBoundTagged(Ee,Te,Mt)),et},fe.prototype.snapshot=function(){this._snapshots.push(P.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},fe.prototype.restore=function(){var Ee=this._snapshots.pop();if(Ee===void 0)throw new Error(K.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Ee.bindings,this._middleware=Ee.middleware},fe.prototype.createChild=function(Ee){var Te=new fe(Ee||this.options);return Te.parent=this,Te},fe.prototype.applyMiddleware=function(){for(var Ee=[],Te=0;Te<arguments.length;Te++)Ee[Te]=arguments[Te];this._appliedMiddleware=this._appliedMiddleware.concat(Ee);var Mt=this._middleware?this._middleware:this._planAndResolve();this._middleware=Ee.reduce(function(et,Dt){return Dt(et)},Mt)},fe.prototype.applyCustomMetadataReader=function(Ee){this._metadataReader=Ee},fe.prototype.get=function(Ee){return this._get(!1,!1,ut.TargetTypeEnum.Variable,Ee)},fe.prototype.getTagged=function(Ee,Te,Mt){return this._get(!1,!1,ut.TargetTypeEnum.Variable,Ee,Te,Mt)},fe.prototype.getNamed=function(Ee,Te){return this.getTagged(Ee,ht.NAMED_TAG,Te)},fe.prototype.getAll=function(Ee){return this._get(!0,!0,ut.TargetTypeEnum.Variable,Ee)},fe.prototype.getAllTagged=function(Ee,Te,Mt){return this._get(!1,!0,ut.TargetTypeEnum.Variable,Ee,Te,Mt)},fe.prototype.getAllNamed=function(Ee,Te){return this.getAllTagged(Ee,ht.NAMED_TAG,Te)},fe.prototype.resolve=function(Ee){var Te=this.createChild();return Te.bind(Ee).toSelf(),this._appliedMiddleware.forEach(function(Mt){Te.applyMiddleware(Mt)}),Te.get(Ee)},fe.prototype._getContainerModuleHelpersFactory=function(){var Ee=this,Te=function(_e,ge){_e._binding.moduleId=ge},Mt=function(_e){return function(ge){var te=Ee.bind.bind(Ee),xe=te(ge);return Te(xe,_e),xe}},et=function(_e){return function(ge){var te=Ee.unbind.bind(Ee);te(ge)}},Dt=function(_e){return function(ge){var te=Ee.isBound.bind(Ee);return te(ge)}},we=function(_e){return function(ge){var te=Ee.rebind.bind(Ee),xe=te(ge);return Te(xe,_e),xe}};return function(_e){return{bindFunction:Mt(_e),isboundFunction:Dt(_e),rebindFunction:we(_e),unbindFunction:et(_e)}}},fe.prototype._get=function(Ee,Te,Mt,et,Dt,we){var _e=null,ge={avoidConstraints:Ee,contextInterceptor:function(te){return te},isMultiInject:Te,key:Dt,serviceIdentifier:et,targetType:Mt,value:we};if(this._middleware){if(_e=this._middleware(ge),_e==null)throw new Error(K.INVALID_MIDDLEWARE_RETURN)}else _e=this._planAndResolve()(ge);return _e},fe.prototype._planAndResolve=function(){var Ee=this;return function(Te){var Mt=tt.plan(Ee._metadataReader,Ee,Te.isMultiInject,Te.targetType,Te.serviceIdentifier,Te.key,Te.value,Te.avoidConstraints);Mt=Te.contextInterceptor(Mt);var et=be.resolve(Mt);return et}},fe}();Ot.Container=W},33244:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.AsyncContainerModule=Ot.ContainerModule=void 0;var kt=ot(37791),bt=function(){function xt(K){this.id=kt.id(),this.registry=K}return xt}();Ot.ContainerModule=bt;var I=function(){function xt(K){this.id=kt.id(),this.registry=K}return xt}();Ot.AsyncContainerModule=I},85700:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.ContainerSnapshot=void 0;var ot=function(){function kt(){}return kt.of=function(bt,I){var xt=new kt;return xt.bindings=bt,xt.middleware=I,xt},kt}();Ot.ContainerSnapshot=ot},80175:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Lookup=void 0;var kt=ot(16674),bt=function(){function I(){this._map=new Map}return I.prototype.getMap=function(){return this._map},I.prototype.add=function(xt,K){if(xt==null)throw new Error(kt.NULL_ARGUMENT);if(K==null)throw new Error(kt.NULL_ARGUMENT);var ut=this._map.get(xt);ut!==void 0?(ut.push(K),this._map.set(xt,ut)):this._map.set(xt,[K])},I.prototype.get=function(xt){if(xt==null)throw new Error(kt.NULL_ARGUMENT);var K=this._map.get(xt);if(K!==void 0)return K;throw new Error(kt.KEY_NOT_FOUND)},I.prototype.remove=function(xt){if(xt==null)throw new Error(kt.NULL_ARGUMENT);if(!this._map.delete(xt))throw new Error(kt.KEY_NOT_FOUND)},I.prototype.removeByCondition=function(xt){var K=this;this._map.forEach(function(ut,ht){var lt=ut.filter(function(tt){return!xt(tt)});lt.length>0?K._map.set(ht,lt):K._map.delete(ht)})},I.prototype.hasKey=function(xt){if(xt==null)throw new Error(kt.NULL_ARGUMENT);return this._map.has(xt)},I.prototype.clone=function(){var xt=new I;return this._map.forEach(function(K,ut){K.forEach(function(ht){return xt.add(ut,ht.clone())})}),xt},I.prototype.traverse=function(xt){this._map.forEach(function(K,ut){xt(ut,K)})},I}();Ot.Lookup=bt},86700:function(gn,Ot,ot){"use strict";var kt;kt={value:!0},kt=kt=kt=kt=kt=kt=Ot.GW=kt=kt=Ot.zY=kt=kt=kt=kt=kt=Ot.f3=kt=kt=Ot.b2=kt=kt=kt=kt=kt=Ot.W2=kt=void 0;var bt=ot(6867);kt=bt;var I=ot(51389);Object.defineProperty(Ot,"W2",{enumerable:!0,get:function(){return I.Container}});var xt=ot(28421);kt={enumerable:!0,get:function(){return xt.BindingScopeEnum}},kt={enumerable:!0,get:function(){return xt.BindingTypeEnum}},kt={enumerable:!0,get:function(){return xt.TargetTypeEnum}};var K=ot(33244);kt={enumerable:!0,get:function(){return K.AsyncContainerModule}},kt={enumerable:!0,get:function(){return K.ContainerModule}};var ut=ot(64315);Object.defineProperty(Ot,"b2",{enumerable:!0,get:function(){return ut.injectable}});var ht=ot(32052);kt={enumerable:!0,get:function(){return ht.tagged}};var lt=ot(38085);kt={enumerable:!0,get:function(){return lt.named}};var tt=ot(5744);Object.defineProperty(Ot,"f3",{enumerable:!0,get:function(){return tt.inject}}),kt={enumerable:!0,get:function(){return tt.LazyServiceIdentifer}};var be=ot(6515);kt={enumerable:!0,get:function(){return be.optional}};var it=ot(86757);kt={enumerable:!0,get:function(){return it.unmanaged}};var st=ot(71693);kt={enumerable:!0,get:function(){return st.multiInject}};var Ut=ot(55638);kt={enumerable:!0,get:function(){return Ut.targetName}};var P=ot(7014);Object.defineProperty(Ot,"zY",{enumerable:!0,get:function(){return P.postConstruct}});var b=ot(51377);kt={enumerable:!0,get:function(){return b.MetadataReader}};var W=ot(37791);kt={enumerable:!0,get:function(){return W.id}};var fe=ot(99934);Object.defineProperty(Ot,"GW",{enumerable:!0,get:function(){return fe.decorate}});var Ee=ot(80758);kt={enumerable:!0,get:function(){return Ee.traverseAncerstors}},kt={enumerable:!0,get:function(){return Ee.taggedConstraint}},kt={enumerable:!0,get:function(){return Ee.namedConstraint}},kt={enumerable:!0,get:function(){return Ee.typeConstraint}};var Te=ot(55800);kt={enumerable:!0,get:function(){return Te.getServiceIdentifierAsString}};var Mt=ot(70600);kt={enumerable:!0,get:function(){return Mt.multiBindToService}}},95228:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Context=void 0;var kt=ot(37791),bt=function(){function I(xt){this.id=kt.id(),this.container=xt}return I.prototype.addPlan=function(xt){this.plan=xt},I.prototype.setCurrentRequest=function(xt){this.currentRequest=xt},I}();Ot.Context=bt},47738:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Metadata=void 0;var kt=ot(6867),bt=function(){function I(xt,K){this.key=xt,this.value=K}return I.prototype.toString=function(){return this.key===kt.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},I}();Ot.Metadata=bt},51377:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.MetadataReader=void 0;var kt=ot(6867),bt=function(){function I(){}return I.prototype.getConstructorMetadata=function(xt){var K=Reflect.getMetadata(kt.PARAM_TYPES,xt),ut=Reflect.getMetadata(kt.TAGGED,xt);return{compilerGeneratedMetadata:K,userGeneratedMetadata:ut||{}}},I.prototype.getPropertiesMetadata=function(xt){var K=Reflect.getMetadata(kt.TAGGED_PROP,xt)||[];return K},I}();Ot.MetadataReader=bt},55314:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Plan=void 0;var ot=function(){function kt(bt,I){this.parentContext=bt,this.rootRequest=I}return kt}();Ot.Plan=ot},86311:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.getBindingDictionary=Ot.createMockRequest=Ot.plan=void 0;var kt=ot(23184),bt=ot(16674),I=ot(28421),xt=ot(6867),K=ot(85265),ut=ot(55800),ht=ot(95228),lt=ot(47738),tt=ot(55314),be=ot(6e3),it=ot(6748),st=ot(18924);function Ut(et){return et._bindingDictionary}Ot.getBindingDictionary=Ut;function P(et,Dt,we,_e,ge,te){var xe=et?xt.MULTI_INJECT_TAG:xt.INJECT_TAG,Ye=new lt.Metadata(xe,we),Lt=new st.Target(Dt,_e,we,Ye);if(ge!==void 0){var Qt=new lt.Metadata(ge,te);Lt.metadata.push(Qt)}return Lt}function b(et,Dt,we,_e,ge){var te=Ee(we.container,ge.serviceIdentifier),xe=[];return te.length===kt.BindingCount.NoBindingsAvailable&&we.container.options.autoBindInjectable&&typeof ge.serviceIdentifier=="function"&&et.getConstructorMetadata(ge.serviceIdentifier).compilerGeneratedMetadata&&(we.container.bind(ge.serviceIdentifier).toSelf(),te=Ee(we.container,ge.serviceIdentifier)),Dt?xe=te:xe=te.filter(function(Ye){var Lt=new it.Request(Ye.serviceIdentifier,we,_e,Ye,ge);return Ye.constraint(Lt)}),W(ge.serviceIdentifier,xe,ge,we.container),xe}function W(et,Dt,we,_e){switch(Dt.length){case kt.BindingCount.NoBindingsAvailable:if(we.isOptional())return Dt;var ge=ut.getServiceIdentifierAsString(et),te=bt.NOT_REGISTERED;throw te+=ut.listMetadataForTarget(ge,we),te+=ut.listRegisteredBindingsForServiceIdentifier(_e,ge,Ee),new Error(te);case kt.BindingCount.OnlyOneBindingAvailable:if(!we.isArray())return Dt;case kt.BindingCount.MultipleBindingsAvailable:default:if(we.isArray())return Dt;var ge=ut.getServiceIdentifierAsString(et),te=bt.AMBIGUOUS_MATCH+" "+ge;throw te+=ut.listRegisteredBindingsForServiceIdentifier(_e,ge,Ee),new Error(te)}}function fe(et,Dt,we,_e,ge,te){var xe,Ye;if(ge===null){xe=b(et,Dt,_e,null,te),Ye=new it.Request(we,_e,null,xe,te);var Lt=new tt.Plan(_e,Ye);_e.addPlan(Lt)}else xe=b(et,Dt,_e,ge,te),Ye=ge.addChildRequest(te.serviceIdentifier,xe,te);xe.forEach(function(Qt){var ct=null;if(te.isArray())ct=Ye.addChildRequest(Qt.serviceIdentifier,Qt,te);else{if(Qt.cache)return;ct=Ye}if(Qt.type===I.BindingTypeEnum.Instance&&Qt.implementationType!==null){var Ct=be.getDependencies(et,Qt.implementationType);if(!_e.container.options.skipBaseClassChecks){var Y=be.getBaseClassDependencyCount(et,Qt.implementationType);if(Ct.length<Y){var yt=bt.ARGUMENTS_LENGTH_MISMATCH(be.getFunctionName(Qt.implementationType));throw new Error(yt)}}Ct.forEach(function(Xt){fe(et,!1,Xt.serviceIdentifier,_e,ct,Xt)})}})}function Ee(et,Dt){var we=[],_e=Ut(et);return _e.hasKey(Dt)?we=_e.get(Dt):et.parent!==null&&(we=Ee(et.parent,Dt)),we}function Te(et,Dt,we,_e,ge,te,xe,Ye){Ye===void 0&&(Ye=!1);var Lt=new ht.Context(Dt),Qt=P(we,_e,ge,"",te,xe);try{return fe(et,Ye,ge,Lt,null,Qt),Lt}catch(ct){throw K.isStackOverflowExeption(ct)&&Lt.plan&&ut.circularDependencyToException(Lt.plan.rootRequest),ct}}Ot.plan=Te;function Mt(et,Dt,we,_e){var ge=new st.Target(I.TargetTypeEnum.Variable,"",Dt,new lt.Metadata(we,_e)),te=new ht.Context(et),xe=new it.Request(Dt,te,null,[],ge);return xe}Ot.createMockRequest=Mt},88460:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.QueryableString=void 0;var ot=function(){function kt(bt){this.str=bt}return kt.prototype.startsWith=function(bt){return this.str.indexOf(bt)===0},kt.prototype.endsWith=function(bt){var I="",xt=bt.split("").reverse().join("");return I=this.str.split("").reverse().join(""),this.startsWith.call({str:I},xt)},kt.prototype.contains=function(bt){return this.str.indexOf(bt)!==-1},kt.prototype.equals=function(bt){return this.str===bt},kt.prototype.value=function(){return this.str},kt}();Ot.QueryableString=ot},6e3:function(gn,Ot,ot){"use strict";var kt=this&&this.__spreadArray||function(b,W){for(var fe=0,Ee=W.length,Te=b.length;fe<Ee;fe++,Te++)b[Te]=W[fe];return b};Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.getFunctionName=Ot.getBaseClassDependencyCount=Ot.getDependencies=void 0;var bt=ot(5744),I=ot(16674),xt=ot(28421),K=ot(6867),ut=ot(55800);Object.defineProperty(Ot,"getFunctionName",{enumerable:!0,get:function(){return ut.getFunctionName}});var ht=ot(18924);function lt(b,W){var fe=ut.getFunctionName(W),Ee=tt(b,fe,W,!1);return Ee}Ot.getDependencies=lt;function tt(b,W,fe,Ee){var Te=b.getConstructorMetadata(fe),Mt=Te.compilerGeneratedMetadata;if(Mt===void 0){var et=I.MISSING_INJECTABLE_ANNOTATION+" "+W+".";throw new Error(et)}var Dt=Te.userGeneratedMetadata,we=Object.keys(Dt),_e=fe.length===0&&we.length>0,ge=we.length>fe.length,te=_e||ge?we.length:fe.length,xe=it(Ee,W,Mt,Dt,te),Ye=st(b,fe),Lt=kt(kt([],xe),Ye);return Lt}function be(b,W,fe,Ee,Te){var Mt=Te[b.toString()]||[],et=P(Mt),Dt=et.unmanaged!==!0,we=Ee[b],_e=et.inject||et.multiInject;if(we=_e||we,we instanceof bt.LazyServiceIdentifer&&(we=we.unwrap()),Dt){var ge=we===Object,te=we===Function,xe=we===void 0,Ye=ge||te||xe;if(!W&&Ye){var Lt=I.MISSING_INJECT_ANNOTATION+" argument "+b+" in class "+fe+".";throw new Error(Lt)}var Qt=new ht.Target(xt.TargetTypeEnum.ConstructorArgument,et.targetName,we);return Qt.metadata=Mt,Qt}return null}function it(b,W,fe,Ee,Te){for(var Mt=[],et=0;et<Te;et++){var Dt=et,we=be(Dt,b,W,fe,Ee);we!==null&&Mt.push(we)}return Mt}function st(b,W){for(var fe=b.getPropertiesMetadata(W),Ee=[],Te=Object.keys(fe),Mt=0,et=Te;Mt<et.length;Mt++){var Dt=et[Mt],we=fe[Dt],_e=P(fe[Dt]),ge=_e.targetName||Dt,te=_e.inject||_e.multiInject,xe=new ht.Target(xt.TargetTypeEnum.ClassProperty,ge,te);xe.metadata=we,Ee.push(xe)}var Ye=Object.getPrototypeOf(W.prototype).constructor;if(Ye!==Object){var Lt=st(b,Ye);Ee=kt(kt([],Ee),Lt)}return Ee}function Ut(b,W){var fe=Object.getPrototypeOf(W.prototype).constructor;if(fe!==Object){var Ee=ut.getFunctionName(fe),Te=tt(b,Ee,fe,!0),Mt=Te.map(function(we){return we.metadata.filter(function(_e){return _e.key===K.UNMANAGED_TAG})}),et=[].concat.apply([],Mt).length,Dt=Te.length-et;return Dt>0?Dt:Ut(b,fe)}else return 0}Ot.getBaseClassDependencyCount=Ut;function P(b){var W={};return b.forEach(function(fe){W[fe.key.toString()]=fe.value}),{inject:W[K.INJECT_TAG],multiInject:W[K.MULTI_INJECT_TAG],targetName:W[K.NAME_TAG],unmanaged:W[K.UNMANAGED_TAG]}}},6748:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Request=void 0;var kt=ot(37791),bt=function(){function I(xt,K,ut,ht,lt){this.id=kt.id(),this.serviceIdentifier=xt,this.parentContext=K,this.parentRequest=ut,this.target=lt,this.childRequests=[],this.bindings=Array.isArray(ht)?ht:[ht],this.requestScope=ut===null?new Map:null}return I.prototype.addChildRequest=function(xt,K,ut){var ht=new I(xt,this.parentContext,this,K,ut);return this.childRequests.push(ht),ht},I}();Ot.Request=bt},18924:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Target=void 0;var kt=ot(6867),bt=ot(37791),I=ot(47738),xt=ot(88460),K=function(){function ut(ht,lt,tt,be){this.id=bt.id(),this.type=ht,this.serviceIdentifier=tt,this.name=new xt.QueryableString(lt||""),this.metadata=new Array;var it=null;typeof be=="string"?it=new I.Metadata(kt.NAMED_TAG,be):be instanceof I.Metadata&&(it=be),it!==null&&this.metadata.push(it)}return ut.prototype.hasTag=function(ht){for(var lt=0,tt=this.metadata;lt<tt.length;lt++){var be=tt[lt];if(be.key===ht)return!0}return!1},ut.prototype.isArray=function(){return this.hasTag(kt.MULTI_INJECT_TAG)},ut.prototype.matchesArray=function(ht){return this.matchesTag(kt.MULTI_INJECT_TAG)(ht)},ut.prototype.isNamed=function(){return this.hasTag(kt.NAMED_TAG)},ut.prototype.isTagged=function(){return this.metadata.some(function(ht){return kt.NON_CUSTOM_TAG_KEYS.every(function(lt){return ht.key!==lt})})},ut.prototype.isOptional=function(){return this.matchesTag(kt.OPTIONAL_TAG)(!0)},ut.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(ht){return ht.key===kt.NAMED_TAG})[0]:null},ut.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(ht){return kt.NON_CUSTOM_TAG_KEYS.every(function(lt){return ht.key!==lt})}):null},ut.prototype.matchesNamedTag=function(ht){return this.matchesTag(kt.NAMED_TAG)(ht)},ut.prototype.matchesTag=function(ht){var lt=this;return function(tt){for(var be=0,it=lt.metadata;be<it.length;be++){var st=it[be];if(st.key===ht&&st.value===tt)return!0}return!1}},ut}();Ot.Target=K},52279:function(gn,Ot,ot){"use strict";var kt=this&&this.__spreadArray||function(tt,be){for(var it=0,st=be.length,Ut=tt.length;it<st;it++,Ut++)tt[Ut]=be[it];return tt};Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.resolveInstance=void 0;var bt=ot(16674),I=ot(28421),xt=ot(6867);function K(tt,be,it){var st=be.filter(function(P){return P.target!==null&&P.target.type===I.TargetTypeEnum.ClassProperty}),Ut=st.map(it);return st.forEach(function(P,b){var W="";W=P.target.name.value();var fe=Ut[b];tt[W]=fe}),tt}function ut(tt,be){return new(tt.bind.apply(tt,kt([void 0],be)))}function ht(tt,be){if(Reflect.hasMetadata(xt.POST_CONSTRUCT,tt)){var it=Reflect.getMetadata(xt.POST_CONSTRUCT,tt);try{be[it.value]()}catch(st){throw new Error(bt.POST_CONSTRUCT_ERROR(tt.name,st.message))}}}function lt(tt,be,it){var st=null;if(be.length>0){var Ut=be.filter(function(b){return b.target!==null&&b.target.type===I.TargetTypeEnum.ConstructorArgument}),P=Ut.map(it);st=ut(tt,P),st=K(st,be,it)}else st=new tt;return ht(tt,st),st}Ot.resolveInstance=lt},31927:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.resolve=void 0;var kt=ot(16674),bt=ot(28421),I=ot(85265),xt=ot(55800),K=ot(52279),ut=function(tt,be,it){try{return it()}catch(st){throw I.isStackOverflowExeption(st)?new Error(kt.CIRCULAR_DEPENDENCY_IN_FACTORY(tt,be.toString())):st}},ht=function(tt){return function(be){be.parentContext.setCurrentRequest(be);var it=be.bindings,st=be.childRequests,Ut=be.target&&be.target.isArray(),P=!be.parentRequest||!be.parentRequest.target||!be.target||!be.parentRequest.target.matchesArray(be.target.serviceIdentifier);if(Ut&&P)return st.map(function(Mt){var et=ht(tt);return et(Mt)});var b=null;if(be.target.isOptional()&&it.length===0)return;var W=it[0],fe=W.scope===bt.BindingScopeEnum.Singleton,Ee=W.scope===bt.BindingScopeEnum.Request;if(fe&&W.activated)return W.cache;if(Ee&&tt!==null&&tt.has(W.id))return tt.get(W.id);if(W.type===bt.BindingTypeEnum.ConstantValue)b=W.cache,W.activated=!0;else if(W.type===bt.BindingTypeEnum.Function)b=W.cache,W.activated=!0;else if(W.type===bt.BindingTypeEnum.Constructor)b=W.implementationType;else if(W.type===bt.BindingTypeEnum.DynamicValue&&W.dynamicValue!==null)b=ut("toDynamicValue",W.serviceIdentifier,function(){return W.dynamicValue(be.parentContext)});else if(W.type===bt.BindingTypeEnum.Factory&&W.factory!==null)b=ut("toFactory",W.serviceIdentifier,function(){return W.factory(be.parentContext)});else if(W.type===bt.BindingTypeEnum.Provider&&W.provider!==null)b=ut("toProvider",W.serviceIdentifier,function(){return W.provider(be.parentContext)});else if(W.type===bt.BindingTypeEnum.Instance&&W.implementationType!==null)b=K.resolveInstance(W.implementationType,st,ht(tt));else{var Te=xt.getServiceIdentifierAsString(be.serviceIdentifier);throw new Error(kt.INVALID_BINDING_TYPE+" "+Te)}return typeof W.onActivation=="function"&&(b=W.onActivation(be.parentContext,b)),fe&&(W.cache=b,W.activated=!0),Ee&&tt!==null&&!tt.has(W.id)&&tt.set(W.id,b),b}};function lt(tt){var be=ht(tt.plan.rootRequest.requestScope);return be(tt.plan.rootRequest)}Ot.resolve=lt},83366:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.BindingInSyntax=void 0;var kt=ot(28421),bt=ot(71325),I=function(){function xt(K){this._binding=K}return xt.prototype.inRequestScope=function(){return this._binding.scope=kt.BindingScopeEnum.Request,new bt.BindingWhenOnSyntax(this._binding)},xt.prototype.inSingletonScope=function(){return this._binding.scope=kt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},xt.prototype.inTransientScope=function(){return this._binding.scope=kt.BindingScopeEnum.Transient,new bt.BindingWhenOnSyntax(this._binding)},xt}();Ot.BindingInSyntax=I},99812:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.BindingInWhenOnSyntax=void 0;var kt=ot(83366),bt=ot(51811),I=ot(98370),xt=function(){function K(ut){this._binding=ut,this._bindingWhenSyntax=new I.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new bt.BindingOnSyntax(this._binding),this._bindingInSyntax=new kt.BindingInSyntax(ut)}return K.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},K.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},K.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},K.prototype.when=function(ut){return this._bindingWhenSyntax.when(ut)},K.prototype.whenTargetNamed=function(ut){return this._bindingWhenSyntax.whenTargetNamed(ut)},K.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},K.prototype.whenTargetTagged=function(ut,ht){return this._bindingWhenSyntax.whenTargetTagged(ut,ht)},K.prototype.whenInjectedInto=function(ut){return this._bindingWhenSyntax.whenInjectedInto(ut)},K.prototype.whenParentNamed=function(ut){return this._bindingWhenSyntax.whenParentNamed(ut)},K.prototype.whenParentTagged=function(ut,ht){return this._bindingWhenSyntax.whenParentTagged(ut,ht)},K.prototype.whenAnyAncestorIs=function(ut){return this._bindingWhenSyntax.whenAnyAncestorIs(ut)},K.prototype.whenNoAncestorIs=function(ut){return this._bindingWhenSyntax.whenNoAncestorIs(ut)},K.prototype.whenAnyAncestorNamed=function(ut){return this._bindingWhenSyntax.whenAnyAncestorNamed(ut)},K.prototype.whenAnyAncestorTagged=function(ut,ht){return this._bindingWhenSyntax.whenAnyAncestorTagged(ut,ht)},K.prototype.whenNoAncestorNamed=function(ut){return this._bindingWhenSyntax.whenNoAncestorNamed(ut)},K.prototype.whenNoAncestorTagged=function(ut,ht){return this._bindingWhenSyntax.whenNoAncestorTagged(ut,ht)},K.prototype.whenAnyAncestorMatches=function(ut){return this._bindingWhenSyntax.whenAnyAncestorMatches(ut)},K.prototype.whenNoAncestorMatches=function(ut){return this._bindingWhenSyntax.whenNoAncestorMatches(ut)},K.prototype.onActivation=function(ut){return this._bindingOnSyntax.onActivation(ut)},K}();Ot.BindingInWhenOnSyntax=xt},51811:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.BindingOnSyntax=void 0;var kt=ot(98370),bt=function(){function I(xt){this._binding=xt}return I.prototype.onActivation=function(xt){return this._binding.onActivation=xt,new kt.BindingWhenSyntax(this._binding)},I}();Ot.BindingOnSyntax=bt},51860:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.BindingToSyntax=void 0;var kt=ot(16674),bt=ot(28421),I=ot(99812),xt=ot(71325),K=function(){function ut(ht){this._binding=ht}return ut.prototype.to=function(ht){return this._binding.type=bt.BindingTypeEnum.Instance,this._binding.implementationType=ht,new I.BindingInWhenOnSyntax(this._binding)},ut.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+kt.INVALID_TO_SELF_VALUE);var ht=this._binding.serviceIdentifier;return this.to(ht)},ut.prototype.toConstantValue=function(ht){return this._binding.type=bt.BindingTypeEnum.ConstantValue,this._binding.cache=ht,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=bt.BindingScopeEnum.Singleton,new xt.BindingWhenOnSyntax(this._binding)},ut.prototype.toDynamicValue=function(ht){return this._binding.type=bt.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=ht,this._binding.implementationType=null,new I.BindingInWhenOnSyntax(this._binding)},ut.prototype.toConstructor=function(ht){return this._binding.type=bt.BindingTypeEnum.Constructor,this._binding.implementationType=ht,this._binding.scope=bt.BindingScopeEnum.Singleton,new xt.BindingWhenOnSyntax(this._binding)},ut.prototype.toFactory=function(ht){return this._binding.type=bt.BindingTypeEnum.Factory,this._binding.factory=ht,this._binding.scope=bt.BindingScopeEnum.Singleton,new xt.BindingWhenOnSyntax(this._binding)},ut.prototype.toFunction=function(ht){if(typeof ht!="function")throw new Error(kt.INVALID_FUNCTION_BINDING);var lt=this.toConstantValue(ht);return this._binding.type=bt.BindingTypeEnum.Function,this._binding.scope=bt.BindingScopeEnum.Singleton,lt},ut.prototype.toAutoFactory=function(ht){return this._binding.type=bt.BindingTypeEnum.Factory,this._binding.factory=function(lt){var tt=function(){return lt.container.get(ht)};return tt},this._binding.scope=bt.BindingScopeEnum.Singleton,new xt.BindingWhenOnSyntax(this._binding)},ut.prototype.toProvider=function(ht){return this._binding.type=bt.BindingTypeEnum.Provider,this._binding.provider=ht,this._binding.scope=bt.BindingScopeEnum.Singleton,new xt.BindingWhenOnSyntax(this._binding)},ut.prototype.toService=function(ht){this.toDynamicValue(function(lt){return lt.container.get(ht)})},ut}();Ot.BindingToSyntax=K},71325:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.BindingWhenOnSyntax=void 0;var kt=ot(51811),bt=ot(98370),I=function(){function xt(K){this._binding=K,this._bindingWhenSyntax=new bt.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new kt.BindingOnSyntax(this._binding)}return xt.prototype.when=function(K){return this._bindingWhenSyntax.when(K)},xt.prototype.whenTargetNamed=function(K){return this._bindingWhenSyntax.whenTargetNamed(K)},xt.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},xt.prototype.whenTargetTagged=function(K,ut){return this._bindingWhenSyntax.whenTargetTagged(K,ut)},xt.prototype.whenInjectedInto=function(K){return this._bindingWhenSyntax.whenInjectedInto(K)},xt.prototype.whenParentNamed=function(K){return this._bindingWhenSyntax.whenParentNamed(K)},xt.prototype.whenParentTagged=function(K,ut){return this._bindingWhenSyntax.whenParentTagged(K,ut)},xt.prototype.whenAnyAncestorIs=function(K){return this._bindingWhenSyntax.whenAnyAncestorIs(K)},xt.prototype.whenNoAncestorIs=function(K){return this._bindingWhenSyntax.whenNoAncestorIs(K)},xt.prototype.whenAnyAncestorNamed=function(K){return this._bindingWhenSyntax.whenAnyAncestorNamed(K)},xt.prototype.whenAnyAncestorTagged=function(K,ut){return this._bindingWhenSyntax.whenAnyAncestorTagged(K,ut)},xt.prototype.whenNoAncestorNamed=function(K){return this._bindingWhenSyntax.whenNoAncestorNamed(K)},xt.prototype.whenNoAncestorTagged=function(K,ut){return this._bindingWhenSyntax.whenNoAncestorTagged(K,ut)},xt.prototype.whenAnyAncestorMatches=function(K){return this._bindingWhenSyntax.whenAnyAncestorMatches(K)},xt.prototype.whenNoAncestorMatches=function(K){return this._bindingWhenSyntax.whenNoAncestorMatches(K)},xt.prototype.onActivation=function(K){return this._bindingOnSyntax.onActivation(K)},xt}();Ot.BindingWhenOnSyntax=I},98370:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.BindingWhenSyntax=void 0;var kt=ot(51811),bt=ot(80758),I=function(){function xt(K){this._binding=K}return xt.prototype.when=function(K){return this._binding.constraint=K,new kt.BindingOnSyntax(this._binding)},xt.prototype.whenTargetNamed=function(K){return this._binding.constraint=bt.namedConstraint(K),new kt.BindingOnSyntax(this._binding)},xt.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(K){var ut=K.target!==null&&!K.target.isNamed()&&!K.target.isTagged();return ut},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenTargetTagged=function(K,ut){return this._binding.constraint=bt.taggedConstraint(K)(ut),new kt.BindingOnSyntax(this._binding)},xt.prototype.whenInjectedInto=function(K){return this._binding.constraint=function(ut){return bt.typeConstraint(K)(ut.parentRequest)},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenParentNamed=function(K){return this._binding.constraint=function(ut){return bt.namedConstraint(K)(ut.parentRequest)},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenParentTagged=function(K,ut){return this._binding.constraint=function(ht){return bt.taggedConstraint(K)(ut)(ht.parentRequest)},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenAnyAncestorIs=function(K){return this._binding.constraint=function(ut){return bt.traverseAncerstors(ut,bt.typeConstraint(K))},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenNoAncestorIs=function(K){return this._binding.constraint=function(ut){return!bt.traverseAncerstors(ut,bt.typeConstraint(K))},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenAnyAncestorNamed=function(K){return this._binding.constraint=function(ut){return bt.traverseAncerstors(ut,bt.namedConstraint(K))},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenNoAncestorNamed=function(K){return this._binding.constraint=function(ut){return!bt.traverseAncerstors(ut,bt.namedConstraint(K))},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenAnyAncestorTagged=function(K,ut){return this._binding.constraint=function(ht){return bt.traverseAncerstors(ht,bt.taggedConstraint(K)(ut))},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenNoAncestorTagged=function(K,ut){return this._binding.constraint=function(ht){return!bt.traverseAncerstors(ht,bt.taggedConstraint(K)(ut))},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenAnyAncestorMatches=function(K){return this._binding.constraint=function(ut){return bt.traverseAncerstors(ut,K)},new kt.BindingOnSyntax(this._binding)},xt.prototype.whenNoAncestorMatches=function(K){return this._binding.constraint=function(ut){return!bt.traverseAncerstors(ut,K)},new kt.BindingOnSyntax(this._binding)},xt}();Ot.BindingWhenSyntax=I},80758:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.typeConstraint=Ot.namedConstraint=Ot.taggedConstraint=Ot.traverseAncerstors=void 0;var kt=ot(6867),bt=ot(47738),I=function(ht,lt){var tt=ht.parentRequest;return tt!==null?lt(tt)?!0:I(tt,lt):!1};Ot.traverseAncerstors=I;var xt=function(ht){return function(lt){var tt=function(be){return be!==null&&be.target!==null&&be.target.matchesTag(ht)(lt)};return tt.metaData=new bt.Metadata(ht,lt),tt}};Ot.taggedConstraint=xt;var K=xt(kt.NAMED_TAG);Ot.namedConstraint=K;var ut=function(ht){return function(lt){var tt=null;if(lt!==null)if(tt=lt.bindings[0],typeof ht=="string"){var be=tt.serviceIdentifier;return be===ht}else{var it=lt.bindings[0].implementationType;return ht===it}return!1}};Ot.typeConstraint=ut},70600:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.multiBindToService=void 0;var ot=function(kt){return function(bt){return function(){for(var I=[],xt=0;xt<arguments.length;xt++)I[xt]=arguments[xt];return I.forEach(function(K){return kt.bind(K).toService(bt)})}}};Ot.multiBindToService=ot},85265:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.isStackOverflowExeption=void 0;var kt=ot(16674);function bt(I){return I instanceof RangeError||I.message===kt.STACK_OVERFLOW}Ot.isStackOverflowExeption=bt},37791:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.id=void 0;var ot=0;function kt(){return ot++}Ot.id=kt},55800:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.circularDependencyToException=Ot.listMetadataForTarget=Ot.listRegisteredBindingsForServiceIdentifier=Ot.getServiceIdentifierAsString=Ot.getFunctionName=void 0;var kt=ot(16674);function bt(tt){if(typeof tt=="function"){var be=tt;return be.name}else{if(typeof tt=="symbol")return tt.toString();var be=tt;return be}}Ot.getServiceIdentifierAsString=bt;function I(tt,be,it){var st="",Ut=it(tt,be);return Ut.length!==0&&(st=`
Registered bindings:`,Ut.forEach(function(P){var b="Object";P.implementationType!==null&&(b=lt(P.implementationType)),st=st+`
 `+b,P.constraint.metaData&&(st=st+" - "+P.constraint.metaData)})),st}Ot.listRegisteredBindingsForServiceIdentifier=I;function xt(tt,be){return tt.parentRequest===null?!1:tt.parentRequest.serviceIdentifier===be?!0:xt(tt.parentRequest,be)}function K(tt){function be(st,Ut){Ut===void 0&&(Ut=[]);var P=bt(st.serviceIdentifier);return Ut.push(P),st.parentRequest!==null?be(st.parentRequest,Ut):Ut}var it=be(tt);return it.reverse().join(" --> ")}function ut(tt){tt.childRequests.forEach(function(be){if(xt(be,be.serviceIdentifier)){var it=K(be);throw new Error(kt.CIRCULAR_DEPENDENCY+" "+it)}else ut(be)})}Ot.circularDependencyToException=ut;function ht(tt,be){if(be.isTagged()||be.isNamed()){var it="",st=be.getNamedTag(),Ut=be.getCustomTags();return st!==null&&(it+=st.toString()+`
`),Ut!==null&&Ut.forEach(function(P){it+=P.toString()+`
`})," "+tt+`
 `+tt+" - "+it}else return" "+tt}Ot.listMetadataForTarget=ht;function lt(tt){if(tt.name)return tt.name;var be=tt.toString(),it=be.match(/^function\s*([^\s(]+)/);return it?it[1]:"Anonymous function: "+be}Ot.getFunctionName=lt},31745:function(gn){"use strict";gn.exports=ot,gn.exports.default=ot;var Ot=1e20;function ot(K,ut,ht,lt,tt,be){this.fontSize=K||24,this.buffer=ut===void 0?3:ut,this.cutoff=lt||.25,this.fontFamily=tt||"sans-serif",this.fontWeight=be||"normal",this.radius=ht||8;var it=this.size=this.fontSize+this.buffer*2,st=it+this.buffer*2,Ut=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;Ut?this.canvas=my.createOffscreenCanvas(it,it,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=it),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(st*st),this.gridInner=new Float64Array(st*st),this.f=new Float64Array(st),this.z=new Float64Array(st+1),this.v=new Uint16Array(st),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,Ut?this.middle=Math.round(it/2*1):this.middle=Math.round(it/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function kt(K,ut,ht,lt,tt,be,it){be.fill(Ot,0,ut*ht),it.fill(0,0,ut*ht);for(var st=(ut-lt)/2,Ut=0;Ut<tt;Ut++)for(var P=0;P<lt;P++){var b=(Ut+st)*ut+P+st,W=K.data[4*(Ut*lt+P)+3]/255;if(W===1)be[b]=0,it[b]=Ot;else if(W===0)be[b]=Ot,it[b]=0;else{var fe=Math.max(0,.5-W),Ee=Math.max(0,W-.5);be[b]=fe*fe,it[b]=Ee*Ee}}}function bt(K,ut,ht,lt,tt,be,it){for(var st=0;st<ut*ht;st++){var Ut=Math.sqrt(lt[st])-Math.sqrt(tt[st]);K[st]=Math.round(255-255*(Ut/be+it))}}ot.prototype._draw=function(K,ut){var ht=this.ctx.measureText(K),lt=ht.width,tt=2*this.buffer,be,it,st,Ut,P,b,W,fe;ut&&this.useMetrics?(P=Math.floor(ht.actualBoundingBoxAscent),fe=this.buffer+Math.ceil(ht.actualBoundingBoxAscent),b=this.buffer,W=this.buffer,it=Math.min(this.size,Math.ceil(ht.actualBoundingBoxRight-ht.actualBoundingBoxLeft)),Ut=Math.min(this.size-b,Math.ceil(ht.actualBoundingBoxAscent+ht.actualBoundingBoxDescent)),be=it+tt,st=Ut+tt,this.ctx.textBaseline="alphabetic"):(be=it=this.size,st=Ut=this.size,P=19*this.fontSize/24,b=W=0,fe=this.middle,this.ctx.textBaseline="middle");var Ee;it&&Ut&&(this.ctx.clearRect(W,b,it,Ut),this.ctx.fillText(K,this.buffer,fe),Ee=this.ctx.getImageData(W,b,it,Ut));var Te=new Uint8ClampedArray(be*st);return kt(Ee,be,st,it,Ut,this.gridOuter,this.gridInner),I(this.gridOuter,be,st,this.f,this.v,this.z),I(this.gridInner,be,st,this.f,this.v,this.z),bt(Te,be,st,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Te,metrics:{width:it,height:Ut,sdfWidth:be,sdfHeight:st,top:P,left:0,advance:lt}}},ot.prototype.draw=function(K){return this._draw(K,!1).data},ot.prototype.drawWithMetrics=function(K){return this._draw(K,!0)};function I(K,ut,ht,lt,tt,be){for(var it=0;it<ut;it++)xt(K,it,ut,ht,lt,tt,be);for(var st=0;st<ht;st++)xt(K,st*ut,1,ut,lt,tt,be)}function xt(K,ut,ht,lt,tt,be,it){var st,Ut,P,b;for(be[0]=0,it[0]=-Ot,it[1]=Ot,st=0;st<lt;st++)tt[st]=K[ut+st*ht];for(st=1,Ut=0,P=0;st<lt;st++){do b=be[Ut],P=(tt[st]-tt[b]+st*st-b*b)/(st-b)/2;while(P<=it[Ut]&&--Ut>-1);Ut++,be[Ut]=st,it[Ut]=P,it[Ut+1]=Ot}for(st=0,Ut=0;st<lt;st++){for(;it[Ut+1]<st;)Ut++;b=be[Ut],K[ut+st*ht]=tt[b]+(st-b)*(st-b)}}},12380:function(gn,Ot,ot){"use strict";ot.r(Ot),ot.d(Ot,{Function:function(){return nl},Interpreter:function(){return rs},default:function(){return uc},evaluate:function(){return Xl},vm:function(){return kt}});var kt={};ot.r(kt),ot.d(kt,{Script:function(){return sc},compileFunction:function(){return _u},createContext:function(){return Uc},runInContext:function(){return Zc},runInNewContext:function(){return Co}});var bt={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},I="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",xt={5:I,"5module":I+" export import",6:I+" const class extends export import super"},K=/^in(stanceof)?$/,ut="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",ht="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",lt=new RegExp("["+ut+"]"),tt=new RegExp("["+ut+ht+"]");ut=ht=null;var be=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],it=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function st(D,X){for(var _t=65536,rt=0;rt<X.length;rt+=2){if(_t+=X[rt],_t>D)return!1;if(_t+=X[rt+1],_t>=D)return!0}}function Ut(D,X){return D<65?D===36:D<91?!0:D<97?D===95:D<123?!0:D<=65535?D>=170&&lt.test(String.fromCharCode(D)):X===!1?!1:st(D,be)}function P(D,X){return D<48?D===36:D<58?!0:D<65?!1:D<91?!0:D<97?D===95:D<123?!0:D<=65535?D>=170&&tt.test(String.fromCharCode(D)):X===!1?!1:st(D,be)||st(D,it)}var b=function(X,_t){_t===void 0&&(_t={}),this.label=X,this.keyword=_t.keyword,this.beforeExpr=!!_t.beforeExpr,this.startsExpr=!!_t.startsExpr,this.isLoop=!!_t.isLoop,this.isAssign=!!_t.isAssign,this.prefix=!!_t.prefix,this.postfix=!!_t.postfix,this.binop=_t.binop||null,this.updateContext=null};function W(D,X){return new b(D,{beforeExpr:!0,binop:X})}var fe={beforeExpr:!0},Ee={startsExpr:!0},Te={};function Mt(D,X){return X===void 0&&(X={}),X.keyword=D,Te[D]=new b(D,X)}var et={num:new b("num",Ee),regexp:new b("regexp",Ee),string:new b("string",Ee),name:new b("name",Ee),eof:new b("eof"),bracketL:new b("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new b("]"),braceL:new b("{",{beforeExpr:!0,startsExpr:!0}),braceR:new b("}"),parenL:new b("(",{beforeExpr:!0,startsExpr:!0}),parenR:new b(")"),comma:new b(",",fe),semi:new b(";",fe),colon:new b(":",fe),dot:new b("."),question:new b("?",fe),questionDot:new b("?."),arrow:new b("=>",fe),template:new b("template"),invalidTemplate:new b("invalidTemplate"),ellipsis:new b("...",fe),backQuote:new b("`",Ee),dollarBraceL:new b("${",{beforeExpr:!0,startsExpr:!0}),eq:new b("=",{beforeExpr:!0,isAssign:!0}),assign:new b("_=",{beforeExpr:!0,isAssign:!0}),incDec:new b("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new b("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:W("||",1),logicalAND:W("&&",2),bitwiseOR:W("|",3),bitwiseXOR:W("^",4),bitwiseAND:W("&",5),equality:W("==/!=/===/!==",6),relational:W("</>/<=/>=",7),bitShift:W("<</>>/>>>",8),plusMin:new b("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:W("%",10),star:W("*",10),slash:W("/",10),starstar:new b("**",{beforeExpr:!0}),coalesce:W("??",1),_break:Mt("break"),_case:Mt("case",fe),_catch:Mt("catch"),_continue:Mt("continue"),_debugger:Mt("debugger"),_default:Mt("default",fe),_do:Mt("do",{isLoop:!0,beforeExpr:!0}),_else:Mt("else",fe),_finally:Mt("finally"),_for:Mt("for",{isLoop:!0}),_function:Mt("function",Ee),_if:Mt("if"),_return:Mt("return",fe),_switch:Mt("switch"),_throw:Mt("throw",fe),_try:Mt("try"),_var:Mt("var"),_const:Mt("const"),_while:Mt("while",{isLoop:!0}),_with:Mt("with"),_new:Mt("new",{beforeExpr:!0,startsExpr:!0}),_this:Mt("this",Ee),_super:Mt("super",Ee),_class:Mt("class",Ee),_extends:Mt("extends",fe),_export:Mt("export"),_import:Mt("import",Ee),_null:Mt("null",Ee),_true:Mt("true",Ee),_false:Mt("false",Ee),_in:Mt("in",{beforeExpr:!0,binop:7}),_instanceof:Mt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Mt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Mt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Mt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Dt=/\r\n?|\n|\u2028|\u2029/,we=new RegExp(Dt.source,"g");function _e(D,X){return D===10||D===13||!X&&(D===8232||D===8233)}var ge=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,te=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,xe=Object.prototype,Ye=xe.hasOwnProperty,Lt=xe.toString;function Qt(D,X){return Ye.call(D,X)}var ct=Array.isArray||function(D){return Lt.call(D)==="[object Array]"};function Ct(D){return new RegExp("^(?:"+D.replace(/ /g,"|")+")$")}var Y=function(X,_t){this.line=X,this.column=_t};Y.prototype.offset=function(X){return new Y(this.line,this.column+X)};var yt=function(X,_t,rt){this.start=_t,this.end=rt,X.sourceFile!==null&&(this.source=X.sourceFile)};function Xt(D,X){for(var _t=1,rt=0;;){we.lastIndex=rt;var se=we.exec(D);if(se&&se.index<X)++_t,rt=se.index+se[0].length;else return new Y(_t,X-rt)}}var ie={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function Ce(D){var X={};for(var _t in ie)X[_t]=D&&Qt(D,_t)?D[_t]:ie[_t];if(X.ecmaVersion>=2015&&(X.ecmaVersion-=2009),X.allowReserved==null&&(X.allowReserved=X.ecmaVersion<5),ct(X.onToken)){var rt=X.onToken;X.onToken=function(se){return rt.push(se)}}return ct(X.onComment)&&(X.onComment=er(X,X.onComment)),X}function er(D,X){return function(_t,rt,se,Ze,Sr,jr){var Vr={type:_t?"Block":"Line",value:rt,start:se,end:Ze};D.locations&&(Vr.loc=new yt(this,Sr,jr)),D.ranges&&(Vr.range=[se,Ze]),X.push(Vr)}}var Ht=1,ne=2,Me=Ht|ne,ae=4,Je=8,or=16,re=32,Jt=64,Et=128;function $t(D,X){return ne|(D?ae:0)|(X?Je:0)}var Yt=0,St=1,At=2,ue=3,Pe=4,je=5,Nt=function(X,_t,rt){this.options=X=Ce(X),this.sourceFile=X.sourceFile,this.keywords=Ct(xt[X.ecmaVersion>=6?6:X.sourceType==="module"?"5module":5]);var se="";if(X.allowReserved!==!0){for(var Ze=X.ecmaVersion;!(se=bt[Ze]);Ze--);X.sourceType==="module"&&(se+=" await")}this.reservedWords=Ct(se);var Sr=(se?se+" ":"")+bt.strict;this.reservedWordsStrict=Ct(Sr),this.reservedWordsStrictBind=Ct(Sr+" "+bt.strictBind),this.input=String(_t),this.containsEsc=!1,rt?(this.pos=rt,this.lineStart=this.input.lastIndexOf(`
`,rt-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Dt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=et.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=X.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&X.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Ht),this.regexpState=null},wt={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};Nt.prototype.parse=function(){var X=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(X)},wt.inFunction.get=function(){return(this.currentVarScope().flags&ne)>0},wt.inGenerator.get=function(){return(this.currentVarScope().flags&Je)>0},wt.inAsync.get=function(){return(this.currentVarScope().flags&ae)>0},wt.allowSuper.get=function(){return(this.currentThisScope().flags&Jt)>0},wt.allowDirectSuper.get=function(){return(this.currentThisScope().flags&Et)>0},wt.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},Nt.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&ne)>0},Nt.extend=function(){for(var X=[],_t=arguments.length;_t--;)X[_t]=arguments[_t];for(var rt=this,se=0;se<X.length;se++)rt=X[se](rt);return rt},Nt.parse=function(X,_t){return new this(_t,X).parse()},Nt.parseExpressionAt=function(X,_t,rt){var se=new this(rt,X,_t);return se.nextToken(),se.parseExpression()},Nt.tokenizer=function(X,_t){return new this(_t,X)},Object.defineProperties(Nt.prototype,wt);var Tt=Nt.prototype,Ft=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;Tt.strictDirective=function(D){for(;;){te.lastIndex=D,D+=te.exec(this.input)[0].length;var X=Ft.exec(this.input.slice(D));if(!X)return!1;if((X[1]||X[2])==="use strict"){te.lastIndex=D+X[0].length;var _t=te.exec(this.input),rt=_t.index+_t[0].length,se=this.input.charAt(rt);return se===";"||se==="}"||Dt.test(_t[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(se)||se==="!"&&this.input.charAt(rt+1)==="=")}D+=X[0].length,te.lastIndex=D,D+=te.exec(this.input)[0].length,this.input[D]===";"&&D++}},Tt.eat=function(D){return this.type===D?(this.next(),!0):!1},Tt.isContextual=function(D){return this.type===et.name&&this.value===D&&!this.containsEsc},Tt.eatContextual=function(D){return this.isContextual(D)?(this.next(),!0):!1},Tt.expectContextual=function(D){this.eatContextual(D)||this.unexpected()},Tt.canInsertSemicolon=function(){return this.type===et.eof||this.type===et.braceR||Dt.test(this.input.slice(this.lastTokEnd,this.start))},Tt.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},Tt.semicolon=function(){!this.eat(et.semi)&&!this.insertSemicolon()&&this.unexpected()},Tt.afterTrailingComma=function(D,X){if(this.type===D)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),X||this.next(),!0},Tt.expect=function(D){this.eat(D)||this.unexpected()},Tt.unexpected=function(D){this.raise(D!=null?D:this.start,"Unexpected token")};function J(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}Tt.checkPatternErrors=function(D,X){if(!!D){D.trailingComma>-1&&this.raiseRecoverable(D.trailingComma,"Comma is not permitted after the rest element");var _t=X?D.parenthesizedAssign:D.parenthesizedBind;_t>-1&&this.raiseRecoverable(_t,"Parenthesized pattern")}},Tt.checkExpressionErrors=function(D,X){if(!D)return!1;var _t=D.shorthandAssign,rt=D.doubleProto;if(!X)return _t>=0||rt>=0;_t>=0&&this.raise(_t,"Shorthand property assignments are valid only in destructuring patterns"),rt>=0&&this.raiseRecoverable(rt,"Redefinition of __proto__ property")},Tt.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},Tt.isSimpleAssignTarget=function(D){return D.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(D.expression):D.type==="Identifier"||D.type==="MemberExpression"};var gt=Nt.prototype;gt.parseTopLevel=function(D){var X={};for(D.body||(D.body=[]);this.type!==et.eof;){var _t=this.parseStatement(null,!0,X);D.body.push(_t)}if(this.inModule)for(var rt=0,se=Object.keys(this.undefinedExports);rt<se.length;rt+=1){var Ze=se[rt];this.raiseRecoverable(this.undefinedExports[Ze].start,"Export '"+Ze+"' is not defined")}return this.adaptDirectivePrologue(D.body),this.next(),D.sourceType=this.options.sourceType,this.finishNode(D,"Program")};var jt={kind:"loop"},ve={kind:"switch"};gt.isLet=function(D){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;te.lastIndex=this.pos;var X=te.exec(this.input),_t=this.pos+X[0].length,rt=this.input.charCodeAt(_t);if(rt===91)return!0;if(D)return!1;if(rt===123)return!0;if(Ut(rt,!0)){for(var se=_t+1;P(this.input.charCodeAt(se),!0);)++se;var Ze=this.input.slice(_t,se);if(!K.test(Ze))return!0}return!1},gt.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;te.lastIndex=this.pos;var D=te.exec(this.input),X=this.pos+D[0].length;return!Dt.test(this.input.slice(this.pos,X))&&this.input.slice(X,X+8)==="function"&&(X+8===this.input.length||!P(this.input.charAt(X+8)))},gt.parseStatement=function(D,X,_t){var rt=this.type,se=this.startNode(),Ze;switch(this.isLet(D)&&(rt=et._var,Ze="let"),rt){case et._break:case et._continue:return this.parseBreakContinueStatement(se,rt.keyword);case et._debugger:return this.parseDebuggerStatement(se);case et._do:return this.parseDoStatement(se);case et._for:return this.parseForStatement(se);case et._function:return D&&(this.strict||D!=="if"&&D!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(se,!1,!D);case et._class:return D&&this.unexpected(),this.parseClass(se,!0);case et._if:return this.parseIfStatement(se);case et._return:return this.parseReturnStatement(se);case et._switch:return this.parseSwitchStatement(se);case et._throw:return this.parseThrowStatement(se);case et._try:return this.parseTryStatement(se);case et._const:case et._var:return Ze=Ze||this.value,D&&Ze!=="var"&&this.unexpected(),this.parseVarStatement(se,Ze);case et._while:return this.parseWhileStatement(se);case et._with:return this.parseWithStatement(se);case et.braceL:return this.parseBlock(!0,se);case et.semi:return this.parseEmptyStatement(se);case et._export:case et._import:if(this.options.ecmaVersion>10&&rt===et._import){te.lastIndex=this.pos;var Sr=te.exec(this.input),jr=this.pos+Sr[0].length,Vr=this.input.charCodeAt(jr);if(Vr===40||Vr===46)return this.parseExpressionStatement(se,this.parseExpression())}return this.options.allowImportExportEverywhere||(X||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),rt===et._import?this.parseImport(se):this.parseExport(se,_t);default:if(this.isAsyncFunction())return D&&this.unexpected(),this.next(),this.parseFunctionStatement(se,!0,!D);var Ln=this.value,Gn=this.parseExpression();return rt===et.name&&Gn.type==="Identifier"&&this.eat(et.colon)?this.parseLabeledStatement(se,Ln,Gn,D):this.parseExpressionStatement(se,Gn)}},gt.parseBreakContinueStatement=function(D,X){var _t=X==="break";this.next(),this.eat(et.semi)||this.insertSemicolon()?D.label=null:this.type!==et.name?this.unexpected():(D.label=this.parseIdent(),this.semicolon());for(var rt=0;rt<this.labels.length;++rt){var se=this.labels[rt];if((D.label==null||se.name===D.label.name)&&(se.kind!=null&&(_t||se.kind==="loop")||D.label&&_t))break}return rt===this.labels.length&&this.raise(D.start,"Unsyntactic "+X),this.finishNode(D,_t?"BreakStatement":"ContinueStatement")},gt.parseDebuggerStatement=function(D){return this.next(),this.semicolon(),this.finishNode(D,"DebuggerStatement")},gt.parseDoStatement=function(D){return this.next(),this.labels.push(jt),D.body=this.parseStatement("do"),this.labels.pop(),this.expect(et._while),D.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(et.semi):this.semicolon(),this.finishNode(D,"DoWhileStatement")},gt.parseForStatement=function(D){this.next();var X=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(jt),this.enterScope(0),this.expect(et.parenL),this.type===et.semi)return X>-1&&this.unexpected(X),this.parseFor(D,null);var _t=this.isLet();if(this.type===et._var||this.type===et._const||_t){var rt=this.startNode(),se=_t?"let":this.value;return this.next(),this.parseVar(rt,!0,se),this.finishNode(rt,"VariableDeclaration"),(this.type===et._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&rt.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===et._in?X>-1&&this.unexpected(X):D.await=X>-1),this.parseForIn(D,rt)):(X>-1&&this.unexpected(X),this.parseFor(D,rt))}var Ze=new J,Sr=this.parseExpression(!0,Ze);return this.type===et._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===et._in?X>-1&&this.unexpected(X):D.await=X>-1),this.toAssignable(Sr,!1,Ze),this.checkLVal(Sr),this.parseForIn(D,Sr)):(this.checkExpressionErrors(Ze,!0),X>-1&&this.unexpected(X),this.parseFor(D,Sr))},gt.parseFunctionStatement=function(D,X,_t){return this.next(),this.parseFunction(D,Ae|(_t?0:He),!1,X)},gt.parseIfStatement=function(D){return this.next(),D.test=this.parseParenExpression(),D.consequent=this.parseStatement("if"),D.alternate=this.eat(et._else)?this.parseStatement("if"):null,this.finishNode(D,"IfStatement")},gt.parseReturnStatement=function(D){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(et.semi)||this.insertSemicolon()?D.argument=null:(D.argument=this.parseExpression(),this.semicolon()),this.finishNode(D,"ReturnStatement")},gt.parseSwitchStatement=function(D){this.next(),D.discriminant=this.parseParenExpression(),D.cases=[],this.expect(et.braceL),this.labels.push(ve),this.enterScope(0);for(var X,_t=!1;this.type!==et.braceR;)if(this.type===et._case||this.type===et._default){var rt=this.type===et._case;X&&this.finishNode(X,"SwitchCase"),D.cases.push(X=this.startNode()),X.consequent=[],this.next(),rt?X.test=this.parseExpression():(_t&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),_t=!0,X.test=null),this.expect(et.colon)}else X||this.unexpected(),X.consequent.push(this.parseStatement(null));return this.exitScope(),X&&this.finishNode(X,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(D,"SwitchStatement")},gt.parseThrowStatement=function(D){return this.next(),Dt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),D.argument=this.parseExpression(),this.semicolon(),this.finishNode(D,"ThrowStatement")};var Gt=[];gt.parseTryStatement=function(D){if(this.next(),D.block=this.parseBlock(),D.handler=null,this.type===et._catch){var X=this.startNode();if(this.next(),this.eat(et.parenL)){X.param=this.parseBindingAtom();var _t=X.param.type==="Identifier";this.enterScope(_t?re:0),this.checkLVal(X.param,_t?Pe:At),this.expect(et.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),X.param=null,this.enterScope(0);X.body=this.parseBlock(!1),this.exitScope(),D.handler=this.finishNode(X,"CatchClause")}return D.finalizer=this.eat(et._finally)?this.parseBlock():null,!D.handler&&!D.finalizer&&this.raise(D.start,"Missing catch or finally clause"),this.finishNode(D,"TryStatement")},gt.parseVarStatement=function(D,X){return this.next(),this.parseVar(D,!1,X),this.semicolon(),this.finishNode(D,"VariableDeclaration")},gt.parseWhileStatement=function(D){return this.next(),D.test=this.parseParenExpression(),this.labels.push(jt),D.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(D,"WhileStatement")},gt.parseWithStatement=function(D){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),D.object=this.parseParenExpression(),D.body=this.parseStatement("with"),this.finishNode(D,"WithStatement")},gt.parseEmptyStatement=function(D){return this.next(),this.finishNode(D,"EmptyStatement")},gt.parseLabeledStatement=function(D,X,_t,rt){for(var se=0,Ze=this.labels;se<Ze.length;se+=1){var Sr=Ze[se];Sr.name===X&&this.raise(_t.start,"Label '"+X+"' is already declared")}for(var jr=this.type.isLoop?"loop":this.type===et._switch?"switch":null,Vr=this.labels.length-1;Vr>=0;Vr--){var Ln=this.labels[Vr];if(Ln.statementStart===D.start)Ln.statementStart=this.start,Ln.kind=jr;else break}return this.labels.push({name:X,kind:jr,statementStart:this.start}),D.body=this.parseStatement(rt?rt.indexOf("label")===-1?rt+"label":rt:"label"),this.labels.pop(),D.label=_t,this.finishNode(D,"LabeledStatement")},gt.parseExpressionStatement=function(D,X){return D.expression=X,this.semicolon(),this.finishNode(D,"ExpressionStatement")},gt.parseBlock=function(D,X,_t){for(D===void 0&&(D=!0),X===void 0&&(X=this.startNode()),X.body=[],this.expect(et.braceL),D&&this.enterScope(0);this.type!==et.braceR;){var rt=this.parseStatement(null);X.body.push(rt)}return _t&&(this.strict=!1),this.next(),D&&this.exitScope(),this.finishNode(X,"BlockStatement")},gt.parseFor=function(D,X){return D.init=X,this.expect(et.semi),D.test=this.type===et.semi?null:this.parseExpression(),this.expect(et.semi),D.update=this.type===et.parenR?null:this.parseExpression(),this.expect(et.parenR),D.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(D,"ForStatement")},gt.parseForIn=function(D,X){var _t=this.type===et._in;return this.next(),X.type==="VariableDeclaration"&&X.declarations[0].init!=null&&(!_t||this.options.ecmaVersion<8||this.strict||X.kind!=="var"||X.declarations[0].id.type!=="Identifier")?this.raise(X.start,(_t?"for-in":"for-of")+" loop variable declaration may not have an initializer"):X.type==="AssignmentPattern"&&this.raise(X.start,"Invalid left-hand side in for-loop"),D.left=X,D.right=_t?this.parseExpression():this.parseMaybeAssign(),this.expect(et.parenR),D.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(D,_t?"ForInStatement":"ForOfStatement")},gt.parseVar=function(D,X,_t){for(D.declarations=[],D.kind=_t;;){var rt=this.startNode();if(this.parseVarId(rt,_t),this.eat(et.eq)?rt.init=this.parseMaybeAssign(X):_t==="const"&&!(this.type===et._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():rt.id.type!=="Identifier"&&!(X&&(this.type===et._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):rt.init=null,D.declarations.push(this.finishNode(rt,"VariableDeclarator")),!this.eat(et.comma))break}return D},gt.parseVarId=function(D,X){D.id=this.parseBindingAtom(),this.checkLVal(D.id,X==="var"?St:At,!1)};var Ae=1,He=2,qe=4;gt.parseFunction=function(D,X,_t,rt){this.initFunction(D),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!rt)&&(this.type===et.star&&X&He&&this.unexpected(),D.generator=this.eat(et.star)),this.options.ecmaVersion>=8&&(D.async=!!rt),X&Ae&&(D.id=X&qe&&this.type!==et.name?null:this.parseIdent(),D.id&&!(X&He)&&this.checkLVal(D.id,this.strict||D.generator||D.async?this.treatFunctionsAsVar?St:At:ue));var se=this.yieldPos,Ze=this.awaitPos,Sr=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope($t(D.async,D.generator)),X&Ae||(D.id=this.type===et.name?this.parseIdent():null),this.parseFunctionParams(D),this.parseFunctionBody(D,_t,!1),this.yieldPos=se,this.awaitPos=Ze,this.awaitIdentPos=Sr,this.finishNode(D,X&Ae?"FunctionDeclaration":"FunctionExpression")},gt.parseFunctionParams=function(D){this.expect(et.parenL),D.params=this.parseBindingList(et.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},gt.parseClass=function(D,X){this.next();var _t=this.strict;this.strict=!0,this.parseClassId(D,X),this.parseClassSuper(D);var rt=this.startNode(),se=!1;for(rt.body=[],this.expect(et.braceL);this.type!==et.braceR;){var Ze=this.parseClassElement(D.superClass!==null);Ze&&(rt.body.push(Ze),Ze.type==="MethodDefinition"&&Ze.kind==="constructor"&&(se&&this.raise(Ze.start,"Duplicate constructor in the same class"),se=!0))}return this.strict=_t,this.next(),D.body=this.finishNode(rt,"ClassBody"),this.finishNode(D,X?"ClassDeclaration":"ClassExpression")},gt.parseClassElement=function(D){var X=this;if(this.eat(et.semi))return null;var _t=this.startNode(),rt=function(Vr,Ln){Ln===void 0&&(Ln=!1);var Gn=X.start,$i=X.startLoc;return X.eatContextual(Vr)?X.type!==et.parenL&&(!Ln||!X.canInsertSemicolon())?!0:(_t.key&&X.unexpected(),_t.computed=!1,_t.key=X.startNodeAt(Gn,$i),_t.key.name=Vr,X.finishNode(_t.key,"Identifier"),!1):!1};_t.kind="method",_t.static=rt("static");var se=this.eat(et.star),Ze=!1;se||(this.options.ecmaVersion>=8&&rt("async",!0)?(Ze=!0,se=this.options.ecmaVersion>=9&&this.eat(et.star)):rt("get")?_t.kind="get":rt("set")&&(_t.kind="set")),_t.key||this.parsePropertyName(_t);var Sr=_t.key,jr=!1;return!_t.computed&&!_t.static&&(Sr.type==="Identifier"&&Sr.name==="constructor"||Sr.type==="Literal"&&Sr.value==="constructor")?(_t.kind!=="method"&&this.raise(Sr.start,"Constructor can't have get/set modifier"),se&&this.raise(Sr.start,"Constructor can't be a generator"),Ze&&this.raise(Sr.start,"Constructor can't be an async method"),_t.kind="constructor",jr=D):_t.static&&Sr.type==="Identifier"&&Sr.name==="prototype"&&this.raise(Sr.start,"Classes may not have a static property named prototype"),this.parseClassMethod(_t,se,Ze,jr),_t.kind==="get"&&_t.value.params.length!==0&&this.raiseRecoverable(_t.value.start,"getter should have no params"),_t.kind==="set"&&_t.value.params.length!==1&&this.raiseRecoverable(_t.value.start,"setter should have exactly one param"),_t.kind==="set"&&_t.value.params[0].type==="RestElement"&&this.raiseRecoverable(_t.value.params[0].start,"Setter cannot use rest params"),_t},gt.parseClassMethod=function(D,X,_t,rt){return D.value=this.parseMethod(X,_t,rt),this.finishNode(D,"MethodDefinition")},gt.parseClassId=function(D,X){this.type===et.name?(D.id=this.parseIdent(),X&&this.checkLVal(D.id,At,!1)):(X===!0&&this.unexpected(),D.id=null)},gt.parseClassSuper=function(D){D.superClass=this.eat(et._extends)?this.parseExprSubscripts():null},gt.parseExport=function(D,X){if(this.next(),this.eat(et.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(D.exported=this.parseIdent(!0),this.checkExport(X,D.exported.name,this.lastTokStart)):D.exported=null),this.expectContextual("from"),this.type!==et.string&&this.unexpected(),D.source=this.parseExprAtom(),this.semicolon(),this.finishNode(D,"ExportAllDeclaration");if(this.eat(et._default)){this.checkExport(X,"default",this.lastTokStart);var _t;if(this.type===et._function||(_t=this.isAsyncFunction())){var rt=this.startNode();this.next(),_t&&this.next(),D.declaration=this.parseFunction(rt,Ae|qe,!1,_t)}else if(this.type===et._class){var se=this.startNode();D.declaration=this.parseClass(se,"nullableID")}else D.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(D,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())D.declaration=this.parseStatement(null),D.declaration.type==="VariableDeclaration"?this.checkVariableExport(X,D.declaration.declarations):this.checkExport(X,D.declaration.id.name,D.declaration.id.start),D.specifiers=[],D.source=null;else{if(D.declaration=null,D.specifiers=this.parseExportSpecifiers(X),this.eatContextual("from"))this.type!==et.string&&this.unexpected(),D.source=this.parseExprAtom();else{for(var Ze=0,Sr=D.specifiers;Ze<Sr.length;Ze+=1){var jr=Sr[Ze];this.checkUnreserved(jr.local),this.checkLocalExport(jr.local)}D.source=null}this.semicolon()}return this.finishNode(D,"ExportNamedDeclaration")},gt.checkExport=function(D,X,_t){!D||(Qt(D,X)&&this.raiseRecoverable(_t,"Duplicate export '"+X+"'"),D[X]=!0)},gt.checkPatternExport=function(D,X){var _t=X.type;if(_t==="Identifier")this.checkExport(D,X.name,X.start);else if(_t==="ObjectPattern")for(var rt=0,se=X.properties;rt<se.length;rt+=1){var Ze=se[rt];this.checkPatternExport(D,Ze)}else if(_t==="ArrayPattern")for(var Sr=0,jr=X.elements;Sr<jr.length;Sr+=1){var Vr=jr[Sr];Vr&&this.checkPatternExport(D,Vr)}else _t==="Property"?this.checkPatternExport(D,X.value):_t==="AssignmentPattern"?this.checkPatternExport(D,X.left):_t==="RestElement"?this.checkPatternExport(D,X.argument):_t==="ParenthesizedExpression"&&this.checkPatternExport(D,X.expression)},gt.checkVariableExport=function(D,X){if(!!D)for(var _t=0,rt=X;_t<rt.length;_t+=1){var se=rt[_t];this.checkPatternExport(D,se.id)}},gt.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},gt.parseExportSpecifiers=function(D){var X=[],_t=!0;for(this.expect(et.braceL);!this.eat(et.braceR);){if(_t)_t=!1;else if(this.expect(et.comma),this.afterTrailingComma(et.braceR))break;var rt=this.startNode();rt.local=this.parseIdent(!0),rt.exported=this.eatContextual("as")?this.parseIdent(!0):rt.local,this.checkExport(D,rt.exported.name,rt.exported.start),X.push(this.finishNode(rt,"ExportSpecifier"))}return X},gt.parseImport=function(D){return this.next(),this.type===et.string?(D.specifiers=Gt,D.source=this.parseExprAtom()):(D.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),D.source=this.type===et.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(D,"ImportDeclaration")},gt.parseImportSpecifiers=function(){var D=[],X=!0;if(this.type===et.name){var _t=this.startNode();if(_t.local=this.parseIdent(),this.checkLVal(_t.local,At),D.push(this.finishNode(_t,"ImportDefaultSpecifier")),!this.eat(et.comma))return D}if(this.type===et.star){var rt=this.startNode();return this.next(),this.expectContextual("as"),rt.local=this.parseIdent(),this.checkLVal(rt.local,At),D.push(this.finishNode(rt,"ImportNamespaceSpecifier")),D}for(this.expect(et.braceL);!this.eat(et.braceR);){if(X)X=!1;else if(this.expect(et.comma),this.afterTrailingComma(et.braceR))break;var se=this.startNode();se.imported=this.parseIdent(!0),this.eatContextual("as")?se.local=this.parseIdent():(this.checkUnreserved(se.imported),se.local=se.imported),this.checkLVal(se.local,At),D.push(this.finishNode(se,"ImportSpecifier"))}return D},gt.adaptDirectivePrologue=function(D){for(var X=0;X<D.length&&this.isDirectiveCandidate(D[X]);++X)D[X].directive=D[X].expression.raw.slice(1,-1)},gt.isDirectiveCandidate=function(D){return D.type==="ExpressionStatement"&&D.expression.type==="Literal"&&typeof D.expression.value=="string"&&(this.input[D.start]==='"'||this.input[D.start]==="'")};var hr=Nt.prototype;hr.toAssignable=function(D,X,_t){if(this.options.ecmaVersion>=6&&D)switch(D.type){case"Identifier":this.inAsync&&D.name==="await"&&this.raise(D.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":D.type="ObjectPattern",_t&&this.checkPatternErrors(_t,!0);for(var rt=0,se=D.properties;rt<se.length;rt+=1){var Ze=se[rt];this.toAssignable(Ze,X),Ze.type==="RestElement"&&(Ze.argument.type==="ArrayPattern"||Ze.argument.type==="ObjectPattern")&&this.raise(Ze.argument.start,"Unexpected token")}break;case"Property":D.kind!=="init"&&this.raise(D.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(D.value,X);break;case"ArrayExpression":D.type="ArrayPattern",_t&&this.checkPatternErrors(_t,!0),this.toAssignableList(D.elements,X);break;case"SpreadElement":D.type="RestElement",this.toAssignable(D.argument,X),D.argument.type==="AssignmentPattern"&&this.raise(D.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":D.operator!=="="&&this.raise(D.left.end,"Only '=' operator can be used for specifying default value."),D.type="AssignmentPattern",delete D.operator,this.toAssignable(D.left,X);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(D.expression,X,_t);break;case"ChainExpression":this.raiseRecoverable(D.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!X)break;default:this.raise(D.start,"Assigning to rvalue")}else _t&&this.checkPatternErrors(_t,!0);return D},hr.toAssignableList=function(D,X){for(var _t=D.length,rt=0;rt<_t;rt++){var se=D[rt];se&&this.toAssignable(se,X)}if(_t){var Ze=D[_t-1];this.options.ecmaVersion===6&&X&&Ze&&Ze.type==="RestElement"&&Ze.argument.type!=="Identifier"&&this.unexpected(Ze.argument.start)}return D},hr.parseSpread=function(D){var X=this.startNode();return this.next(),X.argument=this.parseMaybeAssign(!1,D),this.finishNode(X,"SpreadElement")},hr.parseRestBinding=function(){var D=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==et.name&&this.unexpected(),D.argument=this.parseBindingAtom(),this.finishNode(D,"RestElement")},hr.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case et.bracketL:var D=this.startNode();return this.next(),D.elements=this.parseBindingList(et.bracketR,!0,!0),this.finishNode(D,"ArrayPattern");case et.braceL:return this.parseObj(!0)}return this.parseIdent()},hr.parseBindingList=function(D,X,_t){for(var rt=[],se=!0;!this.eat(D);)if(se?se=!1:this.expect(et.comma),X&&this.type===et.comma)rt.push(null);else{if(_t&&this.afterTrailingComma(D))break;if(this.type===et.ellipsis){var Ze=this.parseRestBinding();this.parseBindingListItem(Ze),rt.push(Ze),this.type===et.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(D);break}else{var Sr=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(Sr),rt.push(Sr)}}return rt},hr.parseBindingListItem=function(D){return D},hr.parseMaybeDefault=function(D,X,_t){if(_t=_t||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(et.eq))return _t;var rt=this.startNodeAt(D,X);return rt.left=_t,rt.right=this.parseMaybeAssign(),this.finishNode(rt,"AssignmentPattern")},hr.checkLVal=function(D,X,_t){switch(X===void 0&&(X=Yt),D.type){case"Identifier":X===At&&D.name==="let"&&this.raiseRecoverable(D.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(D.name)&&this.raiseRecoverable(D.start,(X?"Binding ":"Assigning to ")+D.name+" in strict mode"),_t&&(Qt(_t,D.name)&&this.raiseRecoverable(D.start,"Argument name clash"),_t[D.name]=!0),X!==Yt&&X!==je&&this.declareName(D.name,X,D.start);break;case"ChainExpression":this.raiseRecoverable(D.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":X&&this.raiseRecoverable(D.start,"Binding member expression");break;case"ObjectPattern":for(var rt=0,se=D.properties;rt<se.length;rt+=1){var Ze=se[rt];this.checkLVal(Ze,X,_t)}break;case"Property":this.checkLVal(D.value,X,_t);break;case"ArrayPattern":for(var Sr=0,jr=D.elements;Sr<jr.length;Sr+=1){var Vr=jr[Sr];Vr&&this.checkLVal(Vr,X,_t)}break;case"AssignmentPattern":this.checkLVal(D.left,X,_t);break;case"RestElement":this.checkLVal(D.argument,X,_t);break;case"ParenthesizedExpression":this.checkLVal(D.expression,X,_t);break;default:this.raise(D.start,(X?"Binding":"Assigning to")+" rvalue")}};var tr=Nt.prototype;tr.checkPropClash=function(D,X,_t){if(!(this.options.ecmaVersion>=9&&D.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(D.computed||D.method||D.shorthand))){var rt=D.key,se;switch(rt.type){case"Identifier":se=rt.name;break;case"Literal":se=String(rt.value);break;default:return}var Ze=D.kind;if(this.options.ecmaVersion>=6){se==="__proto__"&&Ze==="init"&&(X.proto&&(_t?_t.doubleProto<0&&(_t.doubleProto=rt.start):this.raiseRecoverable(rt.start,"Redefinition of __proto__ property")),X.proto=!0);return}se="$"+se;var Sr=X[se];if(Sr){var jr;Ze==="init"?jr=this.strict&&Sr.init||Sr.get||Sr.set:jr=Sr.init||Sr[Ze],jr&&this.raiseRecoverable(rt.start,"Redefinition of property")}else Sr=X[se]={init:!1,get:!1,set:!1};Sr[Ze]=!0}},tr.parseExpression=function(D,X){var _t=this.start,rt=this.startLoc,se=this.parseMaybeAssign(D,X);if(this.type===et.comma){var Ze=this.startNodeAt(_t,rt);for(Ze.expressions=[se];this.eat(et.comma);)Ze.expressions.push(this.parseMaybeAssign(D,X));return this.finishNode(Ze,"SequenceExpression")}return se},tr.parseMaybeAssign=function(D,X,_t){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(D);this.exprAllowed=!1}var rt=!1,se=-1,Ze=-1;X?(se=X.parenthesizedAssign,Ze=X.trailingComma,X.parenthesizedAssign=X.trailingComma=-1):(X=new J,rt=!0);var Sr=this.start,jr=this.startLoc;(this.type===et.parenL||this.type===et.name)&&(this.potentialArrowAt=this.start);var Vr=this.parseMaybeConditional(D,X);if(_t&&(Vr=_t.call(this,Vr,Sr,jr)),this.type.isAssign){var Ln=this.startNodeAt(Sr,jr);return Ln.operator=this.value,Ln.left=this.type===et.eq?this.toAssignable(Vr,!1,X):Vr,rt||(X.parenthesizedAssign=X.trailingComma=X.doubleProto=-1),X.shorthandAssign>=Ln.left.start&&(X.shorthandAssign=-1),this.checkLVal(Vr),this.next(),Ln.right=this.parseMaybeAssign(D),this.finishNode(Ln,"AssignmentExpression")}else rt&&this.checkExpressionErrors(X,!0);return se>-1&&(X.parenthesizedAssign=se),Ze>-1&&(X.trailingComma=Ze),Vr},tr.parseMaybeConditional=function(D,X){var _t=this.start,rt=this.startLoc,se=this.parseExprOps(D,X);if(this.checkExpressionErrors(X))return se;if(this.eat(et.question)){var Ze=this.startNodeAt(_t,rt);return Ze.test=se,Ze.consequent=this.parseMaybeAssign(),this.expect(et.colon),Ze.alternate=this.parseMaybeAssign(D),this.finishNode(Ze,"ConditionalExpression")}return se},tr.parseExprOps=function(D,X){var _t=this.start,rt=this.startLoc,se=this.parseMaybeUnary(X,!1);return this.checkExpressionErrors(X)||se.start===_t&&se.type==="ArrowFunctionExpression"?se:this.parseExprOp(se,_t,rt,-1,D)},tr.parseExprOp=function(D,X,_t,rt,se){var Ze=this.type.binop;if(Ze!=null&&(!se||this.type!==et._in)&&Ze>rt){var Sr=this.type===et.logicalOR||this.type===et.logicalAND,jr=this.type===et.coalesce;jr&&(Ze=et.logicalAND.binop);var Vr=this.value;this.next();var Ln=this.start,Gn=this.startLoc,$i=this.parseExprOp(this.parseMaybeUnary(null,!1),Ln,Gn,Ze,se),Pa=this.buildBinary(X,_t,D,$i,Vr,Sr||jr);return(Sr&&this.type===et.coalesce||jr&&(this.type===et.logicalOR||this.type===et.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(Pa,X,_t,rt,se)}return D},tr.buildBinary=function(D,X,_t,rt,se,Ze){var Sr=this.startNodeAt(D,X);return Sr.left=_t,Sr.operator=se,Sr.right=rt,this.finishNode(Sr,Ze?"LogicalExpression":"BinaryExpression")},tr.parseMaybeUnary=function(D,X){var _t=this.start,rt=this.startLoc,se;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))se=this.parseAwait(),X=!0;else if(this.type.prefix){var Ze=this.startNode(),Sr=this.type===et.incDec;Ze.operator=this.value,Ze.prefix=!0,this.next(),Ze.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(D,!0),Sr?this.checkLVal(Ze.argument):this.strict&&Ze.operator==="delete"&&Ze.argument.type==="Identifier"?this.raiseRecoverable(Ze.start,"Deleting local variable in strict mode"):X=!0,se=this.finishNode(Ze,Sr?"UpdateExpression":"UnaryExpression")}else{if(se=this.parseExprSubscripts(D),this.checkExpressionErrors(D))return se;for(;this.type.postfix&&!this.canInsertSemicolon();){var jr=this.startNodeAt(_t,rt);jr.operator=this.value,jr.prefix=!1,jr.argument=se,this.checkLVal(se),this.next(),se=this.finishNode(jr,"UpdateExpression")}}return!X&&this.eat(et.starstar)?this.buildBinary(_t,rt,se,this.parseMaybeUnary(null,!1),"**",!1):se},tr.parseExprSubscripts=function(D){var X=this.start,_t=this.startLoc,rt=this.parseExprAtom(D);if(rt.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return rt;var se=this.parseSubscripts(rt,X,_t);return D&&se.type==="MemberExpression"&&(D.parenthesizedAssign>=se.start&&(D.parenthesizedAssign=-1),D.parenthesizedBind>=se.start&&(D.parenthesizedBind=-1)),se},tr.parseSubscripts=function(D,X,_t,rt){for(var se=this.options.ecmaVersion>=8&&D.type==="Identifier"&&D.name==="async"&&this.lastTokEnd===D.end&&!this.canInsertSemicolon()&&D.end-D.start===5&&this.potentialArrowAt===D.start,Ze=!1;;){var Sr=this.parseSubscript(D,X,_t,rt,se,Ze);if(Sr.optional&&(Ze=!0),Sr===D||Sr.type==="ArrowFunctionExpression"){if(Ze){var jr=this.startNodeAt(X,_t);jr.expression=Sr,Sr=this.finishNode(jr,"ChainExpression")}return Sr}D=Sr}},tr.parseSubscript=function(D,X,_t,rt,se,Ze){var Sr=this.options.ecmaVersion>=11,jr=Sr&&this.eat(et.questionDot);rt&&jr&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var Vr=this.eat(et.bracketL);if(Vr||jr&&this.type!==et.parenL&&this.type!==et.backQuote||this.eat(et.dot)){var Ln=this.startNodeAt(X,_t);Ln.object=D,Ln.property=Vr?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),Ln.computed=!!Vr,Vr&&this.expect(et.bracketR),Sr&&(Ln.optional=jr),D=this.finishNode(Ln,"MemberExpression")}else if(!rt&&this.eat(et.parenL)){var Gn=new J,$i=this.yieldPos,Pa=this.awaitPos,ba=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var uo=this.parseExprList(et.parenR,this.options.ecmaVersion>=8,!1,Gn);if(se&&!jr&&!this.canInsertSemicolon()&&this.eat(et.arrow))return this.checkPatternErrors(Gn,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=$i,this.awaitPos=Pa,this.awaitIdentPos=ba,this.parseArrowExpression(this.startNodeAt(X,_t),uo,!0);this.checkExpressionErrors(Gn,!0),this.yieldPos=$i||this.yieldPos,this.awaitPos=Pa||this.awaitPos,this.awaitIdentPos=ba||this.awaitIdentPos;var Ca=this.startNodeAt(X,_t);Ca.callee=D,Ca.arguments=uo,Sr&&(Ca.optional=jr),D=this.finishNode(Ca,"CallExpression")}else if(this.type===et.backQuote){(jr||Ze)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var Ao=this.startNodeAt(X,_t);Ao.tag=D,Ao.quasi=this.parseTemplate({isTagged:!0}),D=this.finishNode(Ao,"TaggedTemplateExpression")}return D},tr.parseExprAtom=function(D){this.type===et.slash&&this.readRegexp();var X,_t=this.potentialArrowAt===this.start;switch(this.type){case et._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),X=this.startNode(),this.next(),this.type===et.parenL&&!this.allowDirectSuper&&this.raise(X.start,"super() call outside constructor of a subclass"),this.type!==et.dot&&this.type!==et.bracketL&&this.type!==et.parenL&&this.unexpected(),this.finishNode(X,"Super");case et._this:return X=this.startNode(),this.next(),this.finishNode(X,"ThisExpression");case et.name:var rt=this.start,se=this.startLoc,Ze=this.containsEsc,Sr=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Ze&&Sr.name==="async"&&!this.canInsertSemicolon()&&this.eat(et._function))return this.parseFunction(this.startNodeAt(rt,se),0,!1,!0);if(_t&&!this.canInsertSemicolon()){if(this.eat(et.arrow))return this.parseArrowExpression(this.startNodeAt(rt,se),[Sr],!1);if(this.options.ecmaVersion>=8&&Sr.name==="async"&&this.type===et.name&&!Ze)return Sr=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(et.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(rt,se),[Sr],!0)}return Sr;case et.regexp:var jr=this.value;return X=this.parseLiteral(jr.value),X.regex={pattern:jr.pattern,flags:jr.flags},X;case et.num:case et.string:return this.parseLiteral(this.value);case et._null:case et._true:case et._false:return X=this.startNode(),X.value=this.type===et._null?null:this.type===et._true,X.raw=this.type.keyword,this.next(),this.finishNode(X,"Literal");case et.parenL:var Vr=this.start,Ln=this.parseParenAndDistinguishExpression(_t);return D&&(D.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Ln)&&(D.parenthesizedAssign=Vr),D.parenthesizedBind<0&&(D.parenthesizedBind=Vr)),Ln;case et.bracketL:return X=this.startNode(),this.next(),X.elements=this.parseExprList(et.bracketR,!0,!0,D),this.finishNode(X,"ArrayExpression");case et.braceL:return this.parseObj(!1,D);case et._function:return X=this.startNode(),this.next(),this.parseFunction(X,0);case et._class:return this.parseClass(this.startNode(),!1);case et._new:return this.parseNew();case et.backQuote:return this.parseTemplate();case et._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},tr.parseExprImport=function(){var D=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var X=this.parseIdent(!0);switch(this.type){case et.parenL:return this.parseDynamicImport(D);case et.dot:return D.meta=X,this.parseImportMeta(D);default:this.unexpected()}},tr.parseDynamicImport=function(D){if(this.next(),D.source=this.parseMaybeAssign(),!this.eat(et.parenR)){var X=this.start;this.eat(et.comma)&&this.eat(et.parenR)?this.raiseRecoverable(X,"Trailing comma is not allowed in import()"):this.unexpected(X)}return this.finishNode(D,"ImportExpression")},tr.parseImportMeta=function(D){this.next();var X=this.containsEsc;return D.property=this.parseIdent(!0),D.property.name!=="meta"&&this.raiseRecoverable(D.property.start,"The only valid meta property for import is 'import.meta'"),X&&this.raiseRecoverable(D.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(D.start,"Cannot use 'import.meta' outside a module"),this.finishNode(D,"MetaProperty")},tr.parseLiteral=function(D){var X=this.startNode();return X.value=D,X.raw=this.input.slice(this.start,this.end),X.raw.charCodeAt(X.raw.length-1)===110&&(X.bigint=X.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(X,"Literal")},tr.parseParenExpression=function(){this.expect(et.parenL);var D=this.parseExpression();return this.expect(et.parenR),D},tr.parseParenAndDistinguishExpression=function(D){var X=this.start,_t=this.startLoc,rt,se=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Ze=this.start,Sr=this.startLoc,jr=[],Vr=!0,Ln=!1,Gn=new J,$i=this.yieldPos,Pa=this.awaitPos,ba;for(this.yieldPos=0,this.awaitPos=0;this.type!==et.parenR;)if(Vr?Vr=!1:this.expect(et.comma),se&&this.afterTrailingComma(et.parenR,!0)){Ln=!0;break}else if(this.type===et.ellipsis){ba=this.start,jr.push(this.parseParenItem(this.parseRestBinding())),this.type===et.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else jr.push(this.parseMaybeAssign(!1,Gn,this.parseParenItem));var uo=this.start,Ca=this.startLoc;if(this.expect(et.parenR),D&&!this.canInsertSemicolon()&&this.eat(et.arrow))return this.checkPatternErrors(Gn,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=$i,this.awaitPos=Pa,this.parseParenArrowList(X,_t,jr);(!jr.length||Ln)&&this.unexpected(this.lastTokStart),ba&&this.unexpected(ba),this.checkExpressionErrors(Gn,!0),this.yieldPos=$i||this.yieldPos,this.awaitPos=Pa||this.awaitPos,jr.length>1?(rt=this.startNodeAt(Ze,Sr),rt.expressions=jr,this.finishNodeAt(rt,"SequenceExpression",uo,Ca)):rt=jr[0]}else rt=this.parseParenExpression();if(this.options.preserveParens){var Ao=this.startNodeAt(X,_t);return Ao.expression=rt,this.finishNode(Ao,"ParenthesizedExpression")}else return rt},tr.parseParenItem=function(D){return D},tr.parseParenArrowList=function(D,X,_t){return this.parseArrowExpression(this.startNodeAt(D,X),_t)};var Br=[];tr.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var D=this.startNode(),X=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(et.dot)){D.meta=X;var _t=this.containsEsc;return D.property=this.parseIdent(!0),D.property.name!=="target"&&this.raiseRecoverable(D.property.start,"The only valid meta property for new is 'new.target'"),_t&&this.raiseRecoverable(D.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(D.start,"'new.target' can only be used in functions"),this.finishNode(D,"MetaProperty")}var rt=this.start,se=this.startLoc,Ze=this.type===et._import;return D.callee=this.parseSubscripts(this.parseExprAtom(),rt,se,!0),Ze&&D.callee.type==="ImportExpression"&&this.raise(rt,"Cannot use new with import()"),this.eat(et.parenL)?D.arguments=this.parseExprList(et.parenR,this.options.ecmaVersion>=8,!1):D.arguments=Br,this.finishNode(D,"NewExpression")},tr.parseTemplateElement=function(D){var X=D.isTagged,_t=this.startNode();return this.type===et.invalidTemplate?(X||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),_t.value={raw:this.value,cooked:null}):_t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),_t.tail=this.type===et.backQuote,this.finishNode(_t,"TemplateElement")},tr.parseTemplate=function(D){D===void 0&&(D={});var X=D.isTagged;X===void 0&&(X=!1);var _t=this.startNode();this.next(),_t.expressions=[];var rt=this.parseTemplateElement({isTagged:X});for(_t.quasis=[rt];!rt.tail;)this.type===et.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(et.dollarBraceL),_t.expressions.push(this.parseExpression()),this.expect(et.braceR),_t.quasis.push(rt=this.parseTemplateElement({isTagged:X}));return this.next(),this.finishNode(_t,"TemplateLiteral")},tr.isAsyncProp=function(D){return!D.computed&&D.key.type==="Identifier"&&D.key.name==="async"&&(this.type===et.name||this.type===et.num||this.type===et.string||this.type===et.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===et.star)&&!Dt.test(this.input.slice(this.lastTokEnd,this.start))},tr.parseObj=function(D,X){var _t=this.startNode(),rt=!0,se={};for(_t.properties=[],this.next();!this.eat(et.braceR);){if(rt)rt=!1;else if(this.expect(et.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(et.braceR))break;var Ze=this.parseProperty(D,X);D||this.checkPropClash(Ze,se,X),_t.properties.push(Ze)}return this.finishNode(_t,D?"ObjectPattern":"ObjectExpression")},tr.parseProperty=function(D,X){var _t=this.startNode(),rt,se,Ze,Sr;if(this.options.ecmaVersion>=9&&this.eat(et.ellipsis))return D?(_t.argument=this.parseIdent(!1),this.type===et.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(_t,"RestElement")):(this.type===et.parenL&&X&&(X.parenthesizedAssign<0&&(X.parenthesizedAssign=this.start),X.parenthesizedBind<0&&(X.parenthesizedBind=this.start)),_t.argument=this.parseMaybeAssign(!1,X),this.type===et.comma&&X&&X.trailingComma<0&&(X.trailingComma=this.start),this.finishNode(_t,"SpreadElement"));this.options.ecmaVersion>=6&&(_t.method=!1,_t.shorthand=!1,(D||X)&&(Ze=this.start,Sr=this.startLoc),D||(rt=this.eat(et.star)));var jr=this.containsEsc;return this.parsePropertyName(_t),!D&&!jr&&this.options.ecmaVersion>=8&&!rt&&this.isAsyncProp(_t)?(se=!0,rt=this.options.ecmaVersion>=9&&this.eat(et.star),this.parsePropertyName(_t,X)):se=!1,this.parsePropertyValue(_t,D,rt,se,Ze,Sr,X,jr),this.finishNode(_t,"Property")},tr.parsePropertyValue=function(D,X,_t,rt,se,Ze,Sr,jr){if((_t||rt)&&this.type===et.colon&&this.unexpected(),this.eat(et.colon))D.value=X?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Sr),D.kind="init";else if(this.options.ecmaVersion>=6&&this.type===et.parenL)X&&this.unexpected(),D.kind="init",D.method=!0,D.value=this.parseMethod(_t,rt);else if(!X&&!jr&&this.options.ecmaVersion>=5&&!D.computed&&D.key.type==="Identifier"&&(D.key.name==="get"||D.key.name==="set")&&this.type!==et.comma&&this.type!==et.braceR&&this.type!==et.eq){(_t||rt)&&this.unexpected(),D.kind=D.key.name,this.parsePropertyName(D),D.value=this.parseMethod(!1);var Vr=D.kind==="get"?0:1;if(D.value.params.length!==Vr){var Ln=D.value.start;D.kind==="get"?this.raiseRecoverable(Ln,"getter should have no params"):this.raiseRecoverable(Ln,"setter should have exactly one param")}else D.kind==="set"&&D.value.params[0].type==="RestElement"&&this.raiseRecoverable(D.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!D.computed&&D.key.type==="Identifier"?((_t||rt)&&this.unexpected(),this.checkUnreserved(D.key),D.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=se),D.kind="init",X?D.value=this.parseMaybeDefault(se,Ze,D.key):this.type===et.eq&&Sr?(Sr.shorthandAssign<0&&(Sr.shorthandAssign=this.start),D.value=this.parseMaybeDefault(se,Ze,D.key)):D.value=D.key,D.shorthand=!0):this.unexpected()},tr.parsePropertyName=function(D){if(this.options.ecmaVersion>=6){if(this.eat(et.bracketL))return D.computed=!0,D.key=this.parseMaybeAssign(),this.expect(et.bracketR),D.key;D.computed=!1}return D.key=this.type===et.num||this.type===et.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},tr.initFunction=function(D){D.id=null,this.options.ecmaVersion>=6&&(D.generator=D.expression=!1),this.options.ecmaVersion>=8&&(D.async=!1)},tr.parseMethod=function(D,X,_t){var rt=this.startNode(),se=this.yieldPos,Ze=this.awaitPos,Sr=this.awaitIdentPos;return this.initFunction(rt),this.options.ecmaVersion>=6&&(rt.generator=D),this.options.ecmaVersion>=8&&(rt.async=!!X),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope($t(X,rt.generator)|Jt|(_t?Et:0)),this.expect(et.parenL),rt.params=this.parseBindingList(et.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(rt,!1,!0),this.yieldPos=se,this.awaitPos=Ze,this.awaitIdentPos=Sr,this.finishNode(rt,"FunctionExpression")},tr.parseArrowExpression=function(D,X,_t){var rt=this.yieldPos,se=this.awaitPos,Ze=this.awaitIdentPos;return this.enterScope($t(_t,!1)|or),this.initFunction(D),this.options.ecmaVersion>=8&&(D.async=!!_t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,D.params=this.toAssignableList(X,!0),this.parseFunctionBody(D,!0,!1),this.yieldPos=rt,this.awaitPos=se,this.awaitIdentPos=Ze,this.finishNode(D,"ArrowFunctionExpression")},tr.parseFunctionBody=function(D,X,_t){var rt=X&&this.type!==et.braceL,se=this.strict,Ze=!1;if(rt)D.body=this.parseMaybeAssign(),D.expression=!0,this.checkParams(D,!1);else{var Sr=this.options.ecmaVersion>=7&&!this.isSimpleParamList(D.params);(!se||Sr)&&(Ze=this.strictDirective(this.end),Ze&&Sr&&this.raiseRecoverable(D.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var jr=this.labels;this.labels=[],Ze&&(this.strict=!0),this.checkParams(D,!se&&!Ze&&!X&&!_t&&this.isSimpleParamList(D.params)),this.strict&&D.id&&this.checkLVal(D.id,je),D.body=this.parseBlock(!1,void 0,Ze&&!se),D.expression=!1,this.adaptDirectivePrologue(D.body.body),this.labels=jr}this.exitScope()},tr.isSimpleParamList=function(D){for(var X=0,_t=D;X<_t.length;X+=1){var rt=_t[X];if(rt.type!=="Identifier")return!1}return!0},tr.checkParams=function(D,X){for(var _t={},rt=0,se=D.params;rt<se.length;rt+=1){var Ze=se[rt];this.checkLVal(Ze,St,X?null:_t)}},tr.parseExprList=function(D,X,_t,rt){for(var se=[],Ze=!0;!this.eat(D);){if(Ze)Ze=!1;else if(this.expect(et.comma),X&&this.afterTrailingComma(D))break;var Sr=void 0;_t&&this.type===et.comma?Sr=null:this.type===et.ellipsis?(Sr=this.parseSpread(rt),rt&&this.type===et.comma&&rt.trailingComma<0&&(rt.trailingComma=this.start)):Sr=this.parseMaybeAssign(!1,rt),se.push(Sr)}return se},tr.checkUnreserved=function(D){var X=D.start,_t=D.end,rt=D.name;if(this.inGenerator&&rt==="yield"&&this.raiseRecoverable(X,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&rt==="await"&&this.raiseRecoverable(X,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(rt)&&this.raise(X,"Unexpected keyword '"+rt+"'"),!(this.options.ecmaVersion<6&&this.input.slice(X,_t).indexOf("\\")!==-1)){var se=this.strict?this.reservedWordsStrict:this.reservedWords;se.test(rt)&&(!this.inAsync&&rt==="await"&&this.raiseRecoverable(X,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(X,"The keyword '"+rt+"' is reserved"))}},tr.parseIdent=function(D,X){var _t=this.startNode();return this.type===et.name?_t.name=this.value:this.type.keyword?(_t.name=this.type.keyword,(_t.name==="class"||_t.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!D),this.finishNode(_t,"Identifier"),D||(this.checkUnreserved(_t),_t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=_t.start)),_t},tr.parseYield=function(D){this.yieldPos||(this.yieldPos=this.start);var X=this.startNode();return this.next(),this.type===et.semi||this.canInsertSemicolon()||this.type!==et.star&&!this.type.startsExpr?(X.delegate=!1,X.argument=null):(X.delegate=this.eat(et.star),X.argument=this.parseMaybeAssign(D)),this.finishNode(X,"YieldExpression")},tr.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var D=this.startNode();return this.next(),D.argument=this.parseMaybeUnary(null,!1),this.finishNode(D,"AwaitExpression")};var Lr=Nt.prototype;Lr.raise=function(D,X){var _t=Xt(this.input,D);X+=" ("+_t.line+":"+_t.column+")";var rt=new SyntaxError(X);throw rt.pos=D,rt.loc=_t,rt.raisedAt=this.pos,rt},Lr.raiseRecoverable=Lr.raise,Lr.curPosition=function(){if(this.options.locations)return new Y(this.curLine,this.pos-this.lineStart)};var Zr=Nt.prototype,Tn=function(X){this.flags=X,this.var=[],this.lexical=[],this.functions=[]};Zr.enterScope=function(D){this.scopeStack.push(new Tn(D))},Zr.exitScope=function(){this.scopeStack.pop()},Zr.treatFunctionsAsVarInScope=function(D){return D.flags&ne||!this.inModule&&D.flags&Ht},Zr.declareName=function(D,X,_t){var rt=!1;if(X===At){var se=this.currentScope();rt=se.lexical.indexOf(D)>-1||se.functions.indexOf(D)>-1||se.var.indexOf(D)>-1,se.lexical.push(D),this.inModule&&se.flags&Ht&&delete this.undefinedExports[D]}else if(X===Pe){var Ze=this.currentScope();Ze.lexical.push(D)}else if(X===ue){var Sr=this.currentScope();this.treatFunctionsAsVar?rt=Sr.lexical.indexOf(D)>-1:rt=Sr.lexical.indexOf(D)>-1||Sr.var.indexOf(D)>-1,Sr.functions.push(D)}else for(var jr=this.scopeStack.length-1;jr>=0;--jr){var Vr=this.scopeStack[jr];if(Vr.lexical.indexOf(D)>-1&&!(Vr.flags&re&&Vr.lexical[0]===D)||!this.treatFunctionsAsVarInScope(Vr)&&Vr.functions.indexOf(D)>-1){rt=!0;break}if(Vr.var.push(D),this.inModule&&Vr.flags&Ht&&delete this.undefinedExports[D],Vr.flags&Me)break}rt&&this.raiseRecoverable(_t,"Identifier '"+D+"' has already been declared")},Zr.checkLocalExport=function(D){this.scopeStack[0].lexical.indexOf(D.name)===-1&&this.scopeStack[0].var.indexOf(D.name)===-1&&(this.undefinedExports[D.name]=D)},Zr.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},Zr.currentVarScope=function(){for(var D=this.scopeStack.length-1;;D--){var X=this.scopeStack[D];if(X.flags&Me)return X}},Zr.currentThisScope=function(){for(var D=this.scopeStack.length-1;;D--){var X=this.scopeStack[D];if(X.flags&Me&&!(X.flags&or))return X}};var rn=function(X,_t,rt){this.type="",this.start=_t,this.end=0,X.options.locations&&(this.loc=new yt(X,rt)),X.options.directSourceFile&&(this.sourceFile=X.options.directSourceFile),X.options.ranges&&(this.range=[_t,0])},Nn=Nt.prototype;Nn.startNode=function(){return new rn(this,this.start,this.startLoc)},Nn.startNodeAt=function(D,X){return new rn(this,D,X)};function zn(D,X,_t,rt){return D.type=X,D.end=_t,this.options.locations&&(D.loc.end=rt),this.options.ranges&&(D.range[1]=_t),D}Nn.finishNode=function(D,X){return zn.call(this,D,X,this.lastTokEnd,this.lastTokEndLoc)},Nn.finishNodeAt=function(D,X,_t,rt){return zn.call(this,D,X,_t,rt)};var jn=function(X,_t,rt,se,Ze){this.token=X,this.isExpr=!!_t,this.preserveSpace=!!rt,this.override=se,this.generator=!!Ze},Sn={b_stat:new jn("{",!1),b_expr:new jn("{",!0),b_tmpl:new jn("${",!1),p_stat:new jn("(",!1),p_expr:new jn("(",!0),q_tmpl:new jn("`",!0,!0,function(D){return D.tryReadTemplateToken()}),f_stat:new jn("function",!1),f_expr:new jn("function",!0),f_expr_gen:new jn("function",!0,!1,null,!0),f_gen:new jn("function",!1,!1,null,!0)},Wn=Nt.prototype;Wn.initialContext=function(){return[Sn.b_stat]},Wn.braceIsBlock=function(D){var X=this.curContext();return X===Sn.f_expr||X===Sn.f_stat?!0:D===et.colon&&(X===Sn.b_stat||X===Sn.b_expr)?!X.isExpr:D===et._return||D===et.name&&this.exprAllowed?Dt.test(this.input.slice(this.lastTokEnd,this.start)):D===et._else||D===et.semi||D===et.eof||D===et.parenR||D===et.arrow?!0:D===et.braceL?X===Sn.b_stat:D===et._var||D===et._const||D===et.name?!1:!this.exprAllowed},Wn.inGeneratorContext=function(){for(var D=this.context.length-1;D>=1;D--){var X=this.context[D];if(X.token==="function")return X.generator}return!1},Wn.updateContext=function(D){var X,_t=this.type;_t.keyword&&D===et.dot?this.exprAllowed=!1:(X=_t.updateContext)?X.call(this,D):this.exprAllowed=_t.beforeExpr},et.parenR.updateContext=et.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var D=this.context.pop();D===Sn.b_stat&&this.curContext().token==="function"&&(D=this.context.pop()),this.exprAllowed=!D.isExpr},et.braceL.updateContext=function(D){this.context.push(this.braceIsBlock(D)?Sn.b_stat:Sn.b_expr),this.exprAllowed=!0},et.dollarBraceL.updateContext=function(){this.context.push(Sn.b_tmpl),this.exprAllowed=!0},et.parenL.updateContext=function(D){var X=D===et._if||D===et._for||D===et._with||D===et._while;this.context.push(X?Sn.p_stat:Sn.p_expr),this.exprAllowed=!0},et.incDec.updateContext=function(){},et._function.updateContext=et._class.updateContext=function(D){D.beforeExpr&&D!==et.semi&&D!==et._else&&!(D===et._return&&Dt.test(this.input.slice(this.lastTokEnd,this.start)))&&!((D===et.colon||D===et.braceL)&&this.curContext()===Sn.b_stat)?this.context.push(Sn.f_expr):this.context.push(Sn.f_stat),this.exprAllowed=!1},et.backQuote.updateContext=function(){this.curContext()===Sn.q_tmpl?this.context.pop():this.context.push(Sn.q_tmpl),this.exprAllowed=!1},et.star.updateContext=function(D){if(D===et._function){var X=this.context.length-1;this.context[X]===Sn.f_expr?this.context[X]=Sn.f_expr_gen:this.context[X]=Sn.f_gen}this.exprAllowed=!0},et.name.updateContext=function(D){var X=!1;this.options.ecmaVersion>=6&&D!==et.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(X=!0),this.exprAllowed=X};var Rt="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Wt=Rt+" Extended_Pictographic",oe=Wt,Se={9:Rt,10:Wt,11:oe},ze="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",fr="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",wr=fr+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",Le=wr+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",ur={9:fr,10:wr,11:Le},Wr={};function wn(D){var X=Wr[D]={binary:Ct(Se[D]+" "+ze),nonBinary:{General_Category:Ct(ze),Script:Ct(ur[D])}};X.nonBinary.Script_Extensions=X.nonBinary.Script,X.nonBinary.gc=X.nonBinary.General_Category,X.nonBinary.sc=X.nonBinary.Script,X.nonBinary.scx=X.nonBinary.Script_Extensions}wn(9),wn(10),wn(11);var qr=Nt.prototype,Qr=function(X){this.parser=X,this.validFlags="gim"+(X.options.ecmaVersion>=6?"uy":"")+(X.options.ecmaVersion>=9?"s":""),this.unicodeProperties=Wr[X.options.ecmaVersion>=11?11:X.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};Qr.prototype.reset=function(X,_t,rt){var se=rt.indexOf("u")!==-1;this.start=X|0,this.source=_t+"",this.flags=rt,this.switchU=se&&this.parser.options.ecmaVersion>=6,this.switchN=se&&this.parser.options.ecmaVersion>=9},Qr.prototype.raise=function(X){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+X)},Qr.prototype.at=function(X,_t){_t===void 0&&(_t=!1);var rt=this.source,se=rt.length;if(X>=se)return-1;var Ze=rt.charCodeAt(X);if(!(_t||this.switchU)||Ze<=55295||Ze>=57344||X+1>=se)return Ze;var Sr=rt.charCodeAt(X+1);return Sr>=56320&&Sr<=57343?(Ze<<10)+Sr-56613888:Ze},Qr.prototype.nextIndex=function(X,_t){_t===void 0&&(_t=!1);var rt=this.source,se=rt.length;if(X>=se)return se;var Ze=rt.charCodeAt(X),Sr;return!(_t||this.switchU)||Ze<=55295||Ze>=57344||X+1>=se||(Sr=rt.charCodeAt(X+1))<56320||Sr>57343?X+1:X+2},Qr.prototype.current=function(X){return X===void 0&&(X=!1),this.at(this.pos,X)},Qr.prototype.lookahead=function(X){return X===void 0&&(X=!1),this.at(this.nextIndex(this.pos,X),X)},Qr.prototype.advance=function(X){X===void 0&&(X=!1),this.pos=this.nextIndex(this.pos,X)},Qr.prototype.eat=function(X,_t){return _t===void 0&&(_t=!1),this.current(_t)===X?(this.advance(_t),!0):!1};function Mn(D){return D<=65535?String.fromCharCode(D):(D-=65536,String.fromCharCode((D>>10)+55296,(D&1023)+56320))}qr.validateRegExpFlags=function(D){for(var X=D.validFlags,_t=D.flags,rt=0;rt<_t.length;rt++){var se=_t.charAt(rt);X.indexOf(se)===-1&&this.raise(D.start,"Invalid regular expression flag"),_t.indexOf(se,rt+1)>-1&&this.raise(D.start,"Duplicate regular expression flag")}},qr.validateRegExpPattern=function(D){this.regexp_pattern(D),!D.switchN&&this.options.ecmaVersion>=9&&D.groupNames.length>0&&(D.switchN=!0,this.regexp_pattern(D))},qr.regexp_pattern=function(D){D.pos=0,D.lastIntValue=0,D.lastStringValue="",D.lastAssertionIsQuantifiable=!1,D.numCapturingParens=0,D.maxBackReference=0,D.groupNames.length=0,D.backReferenceNames.length=0,this.regexp_disjunction(D),D.pos!==D.source.length&&(D.eat(41)&&D.raise("Unmatched ')'"),(D.eat(93)||D.eat(125))&&D.raise("Lone quantifier brackets")),D.maxBackReference>D.numCapturingParens&&D.raise("Invalid escape");for(var X=0,_t=D.backReferenceNames;X<_t.length;X+=1){var rt=_t[X];D.groupNames.indexOf(rt)===-1&&D.raise("Invalid named capture referenced")}},qr.regexp_disjunction=function(D){for(this.regexp_alternative(D);D.eat(124);)this.regexp_alternative(D);this.regexp_eatQuantifier(D,!0)&&D.raise("Nothing to repeat"),D.eat(123)&&D.raise("Lone quantifier brackets")},qr.regexp_alternative=function(D){for(;D.pos<D.source.length&&this.regexp_eatTerm(D););},qr.regexp_eatTerm=function(D){return this.regexp_eatAssertion(D)?(D.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(D)&&D.switchU&&D.raise("Invalid quantifier"),!0):(D.switchU?this.regexp_eatAtom(D):this.regexp_eatExtendedAtom(D))?(this.regexp_eatQuantifier(D),!0):!1},qr.regexp_eatAssertion=function(D){var X=D.pos;if(D.lastAssertionIsQuantifiable=!1,D.eat(94)||D.eat(36))return!0;if(D.eat(92)){if(D.eat(66)||D.eat(98))return!0;D.pos=X}if(D.eat(40)&&D.eat(63)){var _t=!1;if(this.options.ecmaVersion>=9&&(_t=D.eat(60)),D.eat(61)||D.eat(33))return this.regexp_disjunction(D),D.eat(41)||D.raise("Unterminated group"),D.lastAssertionIsQuantifiable=!_t,!0}return D.pos=X,!1},qr.regexp_eatQuantifier=function(D,X){return X===void 0&&(X=!1),this.regexp_eatQuantifierPrefix(D,X)?(D.eat(63),!0):!1},qr.regexp_eatQuantifierPrefix=function(D,X){return D.eat(42)||D.eat(43)||D.eat(63)||this.regexp_eatBracedQuantifier(D,X)},qr.regexp_eatBracedQuantifier=function(D,X){var _t=D.pos;if(D.eat(123)){var rt=0,se=-1;if(this.regexp_eatDecimalDigits(D)&&(rt=D.lastIntValue,D.eat(44)&&this.regexp_eatDecimalDigits(D)&&(se=D.lastIntValue),D.eat(125)))return se!==-1&&se<rt&&!X&&D.raise("numbers out of order in {} quantifier"),!0;D.switchU&&!X&&D.raise("Incomplete quantifier"),D.pos=_t}return!1},qr.regexp_eatAtom=function(D){return this.regexp_eatPatternCharacters(D)||D.eat(46)||this.regexp_eatReverseSolidusAtomEscape(D)||this.regexp_eatCharacterClass(D)||this.regexp_eatUncapturingGroup(D)||this.regexp_eatCapturingGroup(D)},qr.regexp_eatReverseSolidusAtomEscape=function(D){var X=D.pos;if(D.eat(92)){if(this.regexp_eatAtomEscape(D))return!0;D.pos=X}return!1},qr.regexp_eatUncapturingGroup=function(D){var X=D.pos;if(D.eat(40)){if(D.eat(63)&&D.eat(58)){if(this.regexp_disjunction(D),D.eat(41))return!0;D.raise("Unterminated group")}D.pos=X}return!1},qr.regexp_eatCapturingGroup=function(D){if(D.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(D):D.current()===63&&D.raise("Invalid group"),this.regexp_disjunction(D),D.eat(41))return D.numCapturingParens+=1,!0;D.raise("Unterminated group")}return!1},qr.regexp_eatExtendedAtom=function(D){return D.eat(46)||this.regexp_eatReverseSolidusAtomEscape(D)||this.regexp_eatCharacterClass(D)||this.regexp_eatUncapturingGroup(D)||this.regexp_eatCapturingGroup(D)||this.regexp_eatInvalidBracedQuantifier(D)||this.regexp_eatExtendedPatternCharacter(D)},qr.regexp_eatInvalidBracedQuantifier=function(D){return this.regexp_eatBracedQuantifier(D,!0)&&D.raise("Nothing to repeat"),!1},qr.regexp_eatSyntaxCharacter=function(D){var X=D.current();return bi(X)?(D.lastIntValue=X,D.advance(),!0):!1};function bi(D){return D===36||D>=40&&D<=43||D===46||D===63||D>=91&&D<=94||D>=123&&D<=125}qr.regexp_eatPatternCharacters=function(D){for(var X=D.pos,_t=0;(_t=D.current())!==-1&&!bi(_t);)D.advance();return D.pos!==X},qr.regexp_eatExtendedPatternCharacter=function(D){var X=D.current();return X!==-1&&X!==36&&!(X>=40&&X<=43)&&X!==46&&X!==63&&X!==91&&X!==94&&X!==124?(D.advance(),!0):!1},qr.regexp_groupSpecifier=function(D){if(D.eat(63)){if(this.regexp_eatGroupName(D)){D.groupNames.indexOf(D.lastStringValue)!==-1&&D.raise("Duplicate capture group name"),D.groupNames.push(D.lastStringValue);return}D.raise("Invalid group")}},qr.regexp_eatGroupName=function(D){if(D.lastStringValue="",D.eat(60)){if(this.regexp_eatRegExpIdentifierName(D)&&D.eat(62))return!0;D.raise("Invalid capture group name")}return!1},qr.regexp_eatRegExpIdentifierName=function(D){if(D.lastStringValue="",this.regexp_eatRegExpIdentifierStart(D)){for(D.lastStringValue+=Mn(D.lastIntValue);this.regexp_eatRegExpIdentifierPart(D);)D.lastStringValue+=Mn(D.lastIntValue);return!0}return!1},qr.regexp_eatRegExpIdentifierStart=function(D){var X=D.pos,_t=this.options.ecmaVersion>=11,rt=D.current(_t);return D.advance(_t),rt===92&&this.regexp_eatRegExpUnicodeEscapeSequence(D,_t)&&(rt=D.lastIntValue),wi(rt)?(D.lastIntValue=rt,!0):(D.pos=X,!1)};function wi(D){return Ut(D,!0)||D===36||D===95}qr.regexp_eatRegExpIdentifierPart=function(D){var X=D.pos,_t=this.options.ecmaVersion>=11,rt=D.current(_t);return D.advance(_t),rt===92&&this.regexp_eatRegExpUnicodeEscapeSequence(D,_t)&&(rt=D.lastIntValue),Kr(rt)?(D.lastIntValue=rt,!0):(D.pos=X,!1)};function Kr(D){return P(D,!0)||D===36||D===95||D===8204||D===8205}qr.regexp_eatAtomEscape=function(D){return this.regexp_eatBackReference(D)||this.regexp_eatCharacterClassEscape(D)||this.regexp_eatCharacterEscape(D)||D.switchN&&this.regexp_eatKGroupName(D)?!0:(D.switchU&&(D.current()===99&&D.raise("Invalid unicode escape"),D.raise("Invalid escape")),!1)},qr.regexp_eatBackReference=function(D){var X=D.pos;if(this.regexp_eatDecimalEscape(D)){var _t=D.lastIntValue;if(D.switchU)return _t>D.maxBackReference&&(D.maxBackReference=_t),!0;if(_t<=D.numCapturingParens)return!0;D.pos=X}return!1},qr.regexp_eatKGroupName=function(D){if(D.eat(107)){if(this.regexp_eatGroupName(D))return D.backReferenceNames.push(D.lastStringValue),!0;D.raise("Invalid named reference")}return!1},qr.regexp_eatCharacterEscape=function(D){return this.regexp_eatControlEscape(D)||this.regexp_eatCControlLetter(D)||this.regexp_eatZero(D)||this.regexp_eatHexEscapeSequence(D)||this.regexp_eatRegExpUnicodeEscapeSequence(D,!1)||!D.switchU&&this.regexp_eatLegacyOctalEscapeSequence(D)||this.regexp_eatIdentityEscape(D)},qr.regexp_eatCControlLetter=function(D){var X=D.pos;if(D.eat(99)){if(this.regexp_eatControlLetter(D))return!0;D.pos=X}return!1},qr.regexp_eatZero=function(D){return D.current()===48&&!Ba(D.lookahead())?(D.lastIntValue=0,D.advance(),!0):!1},qr.regexp_eatControlEscape=function(D){var X=D.current();return X===116?(D.lastIntValue=9,D.advance(),!0):X===110?(D.lastIntValue=10,D.advance(),!0):X===118?(D.lastIntValue=11,D.advance(),!0):X===102?(D.lastIntValue=12,D.advance(),!0):X===114?(D.lastIntValue=13,D.advance(),!0):!1},qr.regexp_eatControlLetter=function(D){var X=D.current();return ai(X)?(D.lastIntValue=X%32,D.advance(),!0):!1};function ai(D){return D>=65&&D<=90||D>=97&&D<=122}qr.regexp_eatRegExpUnicodeEscapeSequence=function(D,X){X===void 0&&(X=!1);var _t=D.pos,rt=X||D.switchU;if(D.eat(117)){if(this.regexp_eatFixedHexDigits(D,4)){var se=D.lastIntValue;if(rt&&se>=55296&&se<=56319){var Ze=D.pos;if(D.eat(92)&&D.eat(117)&&this.regexp_eatFixedHexDigits(D,4)){var Sr=D.lastIntValue;if(Sr>=56320&&Sr<=57343)return D.lastIntValue=(se-55296)*1024+(Sr-56320)+65536,!0}D.pos=Ze,D.lastIntValue=se}return!0}if(rt&&D.eat(123)&&this.regexp_eatHexDigits(D)&&D.eat(125)&&li(D.lastIntValue))return!0;rt&&D.raise("Invalid unicode escape"),D.pos=_t}return!1};function li(D){return D>=0&&D<=1114111}qr.regexp_eatIdentityEscape=function(D){if(D.switchU)return this.regexp_eatSyntaxCharacter(D)?!0:D.eat(47)?(D.lastIntValue=47,!0):!1;var X=D.current();return X!==99&&(!D.switchN||X!==107)?(D.lastIntValue=X,D.advance(),!0):!1},qr.regexp_eatDecimalEscape=function(D){D.lastIntValue=0;var X=D.current();if(X>=49&&X<=57){do D.lastIntValue=10*D.lastIntValue+(X-48),D.advance();while((X=D.current())>=48&&X<=57);return!0}return!1},qr.regexp_eatCharacterClassEscape=function(D){var X=D.current();if(hi(X))return D.lastIntValue=-1,D.advance(),!0;if(D.switchU&&this.options.ecmaVersion>=9&&(X===80||X===112)){if(D.lastIntValue=-1,D.advance(),D.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(D)&&D.eat(125))return!0;D.raise("Invalid property name")}return!1};function hi(D){return D===100||D===68||D===115||D===83||D===119||D===87}qr.regexp_eatUnicodePropertyValueExpression=function(D){var X=D.pos;if(this.regexp_eatUnicodePropertyName(D)&&D.eat(61)){var _t=D.lastStringValue;if(this.regexp_eatUnicodePropertyValue(D)){var rt=D.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(D,_t,rt),!0}}if(D.pos=X,this.regexp_eatLoneUnicodePropertyNameOrValue(D)){var se=D.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(D,se),!0}return!1},qr.regexp_validateUnicodePropertyNameAndValue=function(D,X,_t){Qt(D.unicodeProperties.nonBinary,X)||D.raise("Invalid property name"),D.unicodeProperties.nonBinary[X].test(_t)||D.raise("Invalid property value")},qr.regexp_validateUnicodePropertyNameOrValue=function(D,X){D.unicodeProperties.binary.test(X)||D.raise("Invalid property name")},qr.regexp_eatUnicodePropertyName=function(D){var X=0;for(D.lastStringValue="";ra(X=D.current());)D.lastStringValue+=Mn(X),D.advance();return D.lastStringValue!==""};function ra(D){return ai(D)||D===95}qr.regexp_eatUnicodePropertyValue=function(D){var X=0;for(D.lastStringValue="";Ci(X=D.current());)D.lastStringValue+=Mn(X),D.advance();return D.lastStringValue!==""};function Ci(D){return ra(D)||Ba(D)}qr.regexp_eatLoneUnicodePropertyNameOrValue=function(D){return this.regexp_eatUnicodePropertyValue(D)},qr.regexp_eatCharacterClass=function(D){if(D.eat(91)){if(D.eat(94),this.regexp_classRanges(D),D.eat(93))return!0;D.raise("Unterminated character class")}return!1},qr.regexp_classRanges=function(D){for(;this.regexp_eatClassAtom(D);){var X=D.lastIntValue;if(D.eat(45)&&this.regexp_eatClassAtom(D)){var _t=D.lastIntValue;D.switchU&&(X===-1||_t===-1)&&D.raise("Invalid character class"),X!==-1&&_t!==-1&&X>_t&&D.raise("Range out of order in character class")}}},qr.regexp_eatClassAtom=function(D){var X=D.pos;if(D.eat(92)){if(this.regexp_eatClassEscape(D))return!0;if(D.switchU){var _t=D.current();(_t===99||Xa(_t))&&D.raise("Invalid class escape"),D.raise("Invalid escape")}D.pos=X}var rt=D.current();return rt!==93?(D.lastIntValue=rt,D.advance(),!0):!1},qr.regexp_eatClassEscape=function(D){var X=D.pos;if(D.eat(98))return D.lastIntValue=8,!0;if(D.switchU&&D.eat(45))return D.lastIntValue=45,!0;if(!D.switchU&&D.eat(99)){if(this.regexp_eatClassControlLetter(D))return!0;D.pos=X}return this.regexp_eatCharacterClassEscape(D)||this.regexp_eatCharacterEscape(D)},qr.regexp_eatClassControlLetter=function(D){var X=D.current();return Ba(X)||X===95?(D.lastIntValue=X%32,D.advance(),!0):!1},qr.regexp_eatHexEscapeSequence=function(D){var X=D.pos;if(D.eat(120)){if(this.regexp_eatFixedHexDigits(D,2))return!0;D.switchU&&D.raise("Invalid escape"),D.pos=X}return!1},qr.regexp_eatDecimalDigits=function(D){var X=D.pos,_t=0;for(D.lastIntValue=0;Ba(_t=D.current());)D.lastIntValue=10*D.lastIntValue+(_t-48),D.advance();return D.pos!==X};function Ba(D){return D>=48&&D<=57}qr.regexp_eatHexDigits=function(D){var X=D.pos,_t=0;for(D.lastIntValue=0;po(_t=D.current());)D.lastIntValue=16*D.lastIntValue+za(_t),D.advance();return D.pos!==X};function po(D){return D>=48&&D<=57||D>=65&&D<=70||D>=97&&D<=102}function za(D){return D>=65&&D<=70?10+(D-65):D>=97&&D<=102?10+(D-97):D-48}qr.regexp_eatLegacyOctalEscapeSequence=function(D){if(this.regexp_eatOctalDigit(D)){var X=D.lastIntValue;if(this.regexp_eatOctalDigit(D)){var _t=D.lastIntValue;X<=3&&this.regexp_eatOctalDigit(D)?D.lastIntValue=X*64+_t*8+D.lastIntValue:D.lastIntValue=X*8+_t}else D.lastIntValue=X;return!0}return!1},qr.regexp_eatOctalDigit=function(D){var X=D.current();return Xa(X)?(D.lastIntValue=X-48,D.advance(),!0):(D.lastIntValue=0,!1)};function Xa(D){return D>=48&&D<=55}qr.regexp_eatFixedHexDigits=function(D,X){var _t=D.pos;D.lastIntValue=0;for(var rt=0;rt<X;++rt){var se=D.current();if(!po(se))return D.pos=_t,!1;D.lastIntValue=16*D.lastIntValue+za(se),D.advance()}return!0};var Ta=function(X){this.type=X.type,this.value=X.value,this.start=X.start,this.end=X.end,X.options.locations&&(this.loc=new yt(X,X.startLoc,X.endLoc)),X.options.ranges&&(this.range=[X.start,X.end])},ga=Nt.prototype;ga.next=function(D){!D&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Ta(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},ga.getToken=function(){return this.next(),new Ta(this)},typeof Symbol!="undefined"&&(ga[Symbol.iterator]=function(){var D=this;return{next:function(){var X=D.getToken();return{done:X.type===et.eof,value:X}}}}),ga.curContext=function(){return this.context[this.context.length-1]},ga.nextToken=function(){var D=this.curContext();if((!D||!D.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(et.eof);if(D.override)return D.override(this);this.readToken(this.fullCharCodeAtPos())},ga.readToken=function(D){return Ut(D,this.options.ecmaVersion>=6)||D===92?this.readWord():this.getTokenFromCode(D)},ga.fullCharCodeAtPos=function(){var D=this.input.charCodeAt(this.pos);if(D<=55295||D>=57344)return D;var X=this.input.charCodeAt(this.pos+1);return(D<<10)+X-56613888},ga.skipBlockComment=function(){var D=this.options.onComment&&this.curPosition(),X=this.pos,_t=this.input.indexOf("*/",this.pos+=2);if(_t===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=_t+2,this.options.locations){we.lastIndex=X;for(var rt;(rt=we.exec(this.input))&&rt.index<this.pos;)++this.curLine,this.lineStart=rt.index+rt[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(X+2,_t),X,this.pos,D,this.curPosition())},ga.skipLineComment=function(D){for(var X=this.pos,_t=this.options.onComment&&this.curPosition(),rt=this.input.charCodeAt(this.pos+=D);this.pos<this.input.length&&!_e(rt);)rt=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(X+D,this.pos),X,this.pos,_t,this.curPosition())},ga.skipSpace=function(){t:for(;this.pos<this.input.length;){var D=this.input.charCodeAt(this.pos);switch(D){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(D>8&&D<14||D>=5760&&ge.test(String.fromCharCode(D)))++this.pos;else break t}}},ga.finishToken=function(D,X){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var _t=this.type;this.type=D,this.value=X,this.updateContext(_t)},ga.readToken_dot=function(){var D=this.input.charCodeAt(this.pos+1);if(D>=48&&D<=57)return this.readNumber(!0);var X=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&D===46&&X===46?(this.pos+=3,this.finishToken(et.ellipsis)):(++this.pos,this.finishToken(et.dot))},ga.readToken_slash=function(){var D=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):D===61?this.finishOp(et.assign,2):this.finishOp(et.slash,1)},ga.readToken_mult_modulo_exp=function(D){var X=this.input.charCodeAt(this.pos+1),_t=1,rt=D===42?et.star:et.modulo;return this.options.ecmaVersion>=7&&D===42&&X===42&&(++_t,rt=et.starstar,X=this.input.charCodeAt(this.pos+2)),X===61?this.finishOp(et.assign,_t+1):this.finishOp(rt,_t)},ga.readToken_pipe_amp=function(D){var X=this.input.charCodeAt(this.pos+1);if(X===D){if(this.options.ecmaVersion>=12){var _t=this.input.charCodeAt(this.pos+2);if(_t===61)return this.finishOp(et.assign,3)}return this.finishOp(D===124?et.logicalOR:et.logicalAND,2)}return X===61?this.finishOp(et.assign,2):this.finishOp(D===124?et.bitwiseOR:et.bitwiseAND,1)},ga.readToken_caret=function(){var D=this.input.charCodeAt(this.pos+1);return D===61?this.finishOp(et.assign,2):this.finishOp(et.bitwiseXOR,1)},ga.readToken_plus_min=function(D){var X=this.input.charCodeAt(this.pos+1);return X===D?X===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Dt.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(et.incDec,2):X===61?this.finishOp(et.assign,2):this.finishOp(et.plusMin,1)},ga.readToken_lt_gt=function(D){var X=this.input.charCodeAt(this.pos+1),_t=1;return X===D?(_t=D===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+_t)===61?this.finishOp(et.assign,_t+1):this.finishOp(et.bitShift,_t)):X===33&&D===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(X===61&&(_t=2),this.finishOp(et.relational,_t))},ga.readToken_eq_excl=function(D){var X=this.input.charCodeAt(this.pos+1);return X===61?this.finishOp(et.equality,this.input.charCodeAt(this.pos+2)===61?3:2):D===61&&X===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(et.arrow)):this.finishOp(D===61?et.eq:et.prefix,1)},ga.readToken_question=function(){var D=this.options.ecmaVersion;if(D>=11){var X=this.input.charCodeAt(this.pos+1);if(X===46){var _t=this.input.charCodeAt(this.pos+2);if(_t<48||_t>57)return this.finishOp(et.questionDot,2)}if(X===63){if(D>=12){var rt=this.input.charCodeAt(this.pos+2);if(rt===61)return this.finishOp(et.assign,3)}return this.finishOp(et.coalesce,2)}}return this.finishOp(et.question,1)},ga.getTokenFromCode=function(D){switch(D){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(et.parenL);case 41:return++this.pos,this.finishToken(et.parenR);case 59:return++this.pos,this.finishToken(et.semi);case 44:return++this.pos,this.finishToken(et.comma);case 91:return++this.pos,this.finishToken(et.bracketL);case 93:return++this.pos,this.finishToken(et.bracketR);case 123:return++this.pos,this.finishToken(et.braceL);case 125:return++this.pos,this.finishToken(et.braceR);case 58:return++this.pos,this.finishToken(et.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(et.backQuote);case 48:var X=this.input.charCodeAt(this.pos+1);if(X===120||X===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(X===111||X===79)return this.readRadixNumber(8);if(X===98||X===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(D);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(D);case 124:case 38:return this.readToken_pipe_amp(D);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(D);case 60:case 62:return this.readToken_lt_gt(D);case 61:case 33:return this.readToken_eq_excl(D);case 63:return this.readToken_question();case 126:return this.finishOp(et.prefix,1)}this.raise(this.pos,"Unexpected character '"+vo(D)+"'")},ga.finishOp=function(D,X){var _t=this.input.slice(this.pos,this.pos+X);return this.pos+=X,this.finishToken(D,_t)},ga.readRegexp=function(){for(var D,X,_t=this.pos;;){this.pos>=this.input.length&&this.raise(_t,"Unterminated regular expression");var rt=this.input.charAt(this.pos);if(Dt.test(rt)&&this.raise(_t,"Unterminated regular expression"),D)D=!1;else{if(rt==="[")X=!0;else if(rt==="]"&&X)X=!1;else if(rt==="/"&&!X)break;D=rt==="\\"}++this.pos}var se=this.input.slice(_t,this.pos);++this.pos;var Ze=this.pos,Sr=this.readWord1();this.containsEsc&&this.unexpected(Ze);var jr=this.regexpState||(this.regexpState=new Qr(this));jr.reset(_t,se,Sr),this.validateRegExpFlags(jr),this.validateRegExpPattern(jr);var Vr=null;try{Vr=new RegExp(se,Sr)}catch(Ln){}return this.finishToken(et.regexp,{pattern:se,flags:Sr,value:Vr})},ga.readInt=function(D,X,_t){for(var rt=this.options.ecmaVersion>=12&&X===void 0,se=_t&&this.input.charCodeAt(this.pos)===48,Ze=this.pos,Sr=0,jr=0,Vr=0,Ln=X==null?1/0:X;Vr<Ln;++Vr,++this.pos){var Gn=this.input.charCodeAt(this.pos),$i=void 0;if(rt&&Gn===95){se&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),jr===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),Vr===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),jr=Gn;continue}if(Gn>=97?$i=Gn-97+10:Gn>=65?$i=Gn-65+10:Gn>=48&&Gn<=57?$i=Gn-48:$i=1/0,$i>=D)break;jr=Gn,Sr=Sr*D+$i}return rt&&jr===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Ze||X!=null&&this.pos-Ze!==X?null:Sr};function no(D,X){return X?parseInt(D,8):parseFloat(D.replace(/_/g,""))}function Vo(D){return typeof BigInt!="function"?null:BigInt(D.replace(/_/g,""))}ga.readRadixNumber=function(D){var X=this.pos;this.pos+=2;var _t=this.readInt(D);return _t==null&&this.raise(this.start+2,"Expected number in radix "+D),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(_t=Vo(this.input.slice(X,this.pos)),++this.pos):Ut(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(et.num,_t)},ga.readNumber=function(D){var X=this.pos;!D&&this.readInt(10,void 0,!0)===null&&this.raise(X,"Invalid number");var _t=this.pos-X>=2&&this.input.charCodeAt(X)===48;_t&&this.strict&&this.raise(X,"Invalid number");var rt=this.input.charCodeAt(this.pos);if(!_t&&!D&&this.options.ecmaVersion>=11&&rt===110){var se=Vo(this.input.slice(X,this.pos));return++this.pos,Ut(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(et.num,se)}_t&&/[89]/.test(this.input.slice(X,this.pos))&&(_t=!1),rt===46&&!_t&&(++this.pos,this.readInt(10),rt=this.input.charCodeAt(this.pos)),(rt===69||rt===101)&&!_t&&(rt=this.input.charCodeAt(++this.pos),(rt===43||rt===45)&&++this.pos,this.readInt(10)===null&&this.raise(X,"Invalid number")),Ut(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Ze=no(this.input.slice(X,this.pos),_t);return this.finishToken(et.num,Ze)},ga.readCodePoint=function(){var D=this.input.charCodeAt(this.pos),X;if(D===123){this.options.ecmaVersion<6&&this.unexpected();var _t=++this.pos;X=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,X>1114111&&this.invalidStringToken(_t,"Code point out of bounds")}else X=this.readHexChar(4);return X};function vo(D){return D<=65535?String.fromCharCode(D):(D-=65536,String.fromCharCode((D>>10)+55296,(D&1023)+56320))}ga.readString=function(D){for(var X="",_t=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var rt=this.input.charCodeAt(this.pos);if(rt===D)break;rt===92?(X+=this.input.slice(_t,this.pos),X+=this.readEscapedChar(!1),_t=this.pos):(_e(rt,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return X+=this.input.slice(_t,this.pos++),this.finishToken(et.string,X)};var ja={};ga.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(D){if(D===ja)this.readInvalidTemplateToken();else throw D}this.inTemplateElement=!1},ga.invalidStringToken=function(D,X){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw ja;this.raise(D,X)},ga.readTmplToken=function(){for(var D="",X=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var _t=this.input.charCodeAt(this.pos);if(_t===96||_t===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===et.template||this.type===et.invalidTemplate)?_t===36?(this.pos+=2,this.finishToken(et.dollarBraceL)):(++this.pos,this.finishToken(et.backQuote)):(D+=this.input.slice(X,this.pos),this.finishToken(et.template,D));if(_t===92)D+=this.input.slice(X,this.pos),D+=this.readEscapedChar(!0),X=this.pos;else if(_e(_t)){switch(D+=this.input.slice(X,this.pos),++this.pos,_t){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:D+=`
`;break;default:D+=String.fromCharCode(_t);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),X=this.pos}else++this.pos}},ga.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(et.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},ga.readEscapedChar=function(D){var X=this.input.charCodeAt(++this.pos);switch(++this.pos,X){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return vo(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(D){var _t=this.pos-1;return this.invalidStringToken(_t,"Invalid escape sequence in template string"),null}default:if(X>=48&&X<=55){var rt=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],se=parseInt(rt,8);return se>255&&(rt=rt.slice(0,-1),se=parseInt(rt,8)),this.pos+=rt.length-1,X=this.input.charCodeAt(this.pos),(rt!=="0"||X===56||X===57)&&(this.strict||D)&&this.invalidStringToken(this.pos-1-rt.length,D?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(se)}return _e(X)?"":String.fromCharCode(X)}},ga.readHexChar=function(D){var X=this.pos,_t=this.readInt(16,D);return _t===null&&this.invalidStringToken(X,"Bad character escape sequence"),_t},ga.readWord1=function(){this.containsEsc=!1;for(var D="",X=!0,_t=this.pos,rt=this.options.ecmaVersion>=6;this.pos<this.input.length;){var se=this.fullCharCodeAtPos();if(P(se,rt))this.pos+=se<=65535?1:2;else if(se===92){this.containsEsc=!0,D+=this.input.slice(_t,this.pos);var Ze=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Sr=this.readCodePoint();(X?Ut:P)(Sr,rt)||this.invalidStringToken(Ze,"Invalid Unicode escape"),D+=vo(Sr),_t=this.pos}else break;X=!1}return D+this.input.slice(_t,this.pos)},ga.readWord=function(){var D=this.readWord1(),X=et.name;return this.keywords.test(D)&&(X=Te[D]),this.finishToken(X,D)};var to="7.4.1";Nt.acorn={Parser:Nt,version:to,defaultOptions:ie,Position:Y,SourceLocation:yt,getLineInfo:Xt,Node:rn,TokenType:b,tokTypes:et,keywordTypes:Te,TokContext:jn,tokContexts:Sn,isIdentifierChar:P,isIdentifierStart:Ut,Token:Ta,isNewLine:_e,lineBreak:Dt,lineBreakG:we,nonASCIIwhitespace:ge};function Uo(D,X){return Nt.parse(D,X)}function ju(D,X,_t){return Nt.parseExpressionAt(D,X,_t)}function Wo(D,X){return Nt.tokenizer(D,X)}function bo(D,X){D.prototype=Object.create(X.prototype),D.prototype.constructor=D,D.__proto__=X}function nr(D){var X=typeof Map=="function"?new Map:void 0;return nr=function(rt){if(rt===null||!Mr(rt))return rt;if(typeof rt!="function")throw new TypeError("Super expression must either be null or a function");if(typeof X!="undefined"){if(X.has(rt))return X.get(rt);X.set(rt,se)}function se(){return Ge(rt,arguments,In(this).constructor)}return se.prototype=Object.create(rt.prototype,{constructor:{value:se,enumerable:!1,writable:!0,configurable:!0}}),tn(se,rt)},nr(D)}function ye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(D){return!1}}function Ge(D,X,_t){return ye()?Ge=Reflect.construct:Ge=function(se,Ze,Sr){var jr=[null];jr.push.apply(jr,Ze);var Vr=Function.bind.apply(se,jr),Ln=new Vr;return Sr&&tn(Ln,Sr.prototype),Ln},Ge.apply(null,arguments)}function Mr(D){return Function.toString.call(D).indexOf("[native code]")!==-1}function tn(D,X){return tn=Object.setPrototypeOf||function(rt,se){return rt.__proto__=se,rt},tn(D,X)}function In(D){return In=Object.setPrototypeOf?Object.getPrototypeOf:function(_t){return _t.__proto__||Object.getPrototypeOf(_t)},In(D)}var Un=function(D){bo(X,D);function X(){return D.apply(this,arguments)||this}return X}(nr(Error)),Cn=function(D){bo(X,D);function X(){return D.apply(this,arguments)||this}return X}(nr(SyntaxError)),ta=function(D){bo(X,D);function X(){return D.apply(this,arguments)||this}return X}(nr(ReferenceError)),Wa=function(D){bo(X,D);function X(){return D.apply(this,arguments)||this}return X}(nr(TypeError)),es=function(D){bo(X,D);function X(){return D.apply(this,arguments)||this}return X}(Un),ko=function(D){bo(X,D);function X(){return D.apply(this,arguments)||this}return X}(Cn),ns=function(D){bo(X,D);function X(){return D.apply(this,arguments)||this}return X}(ta),Ya={UnknownError:[3001,"%0",es],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",es],NodeTypeSyntaxError:[1001,"Unknown node type: %0",ns],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",ns],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",ns],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",ns],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",ns],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",ns],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",ns],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",ns],ParamTypeSyntaxError:[1009,"Unknown param type: %0",ns],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",ns],FunctionUndefinedReferenceError:[2001,"%0 is not a function",ta],VariableUndefinedReferenceError:[2002,"%0 is not defined",ta],IsNotConstructor:[2003,"%0 is not a constructor",Wa]};function Go(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(D){return!1}}function pu(D,X,_t){return Go()?pu=Reflect.construct:pu=function(se,Ze,Sr){var jr=[null];jr.push.apply(jr,Ze);var Vr=Function.bind.apply(se,jr),Ln=new Vr;return Sr&&ys(Ln,Sr.prototype),Ln},pu.apply(null,arguments)}function ys(D,X){return ys=Object.setPrototypeOf||function(rt,se){return rt.__proto__=se,rt},ys(D,X)}var Rl="0.0.3";function mf(D,X){Object.defineProperty(D,"name",{value:X,writable:!1,enumerable:!1,configurable:!0})}var Wu=Object.prototype.hasOwnProperty,Ie=Symbol("Break"),We=Symbol("Continue"),Tr=Symbol("DefaultCase"),un=Symbol("EmptyStatementReturn"),si=Symbol("WithScopeName"),ji=Symbol("SuperScopeName"),Ma=Symbol("RootScopeName"),ds=Symbol("GlobalScopeName");function Ho(D){return typeof D=="function"}var qo=function(){function D(_t){this.interpreter=_t}var X=D.prototype;return X.generator=function(){var rt=this.interpreter;function se(){return this.getCurrentScope()}function Ze(){return this.getGlobalScope()}function Sr(){return this.getCurrentContext()}return{getOptions:rt.getOptions.bind(rt),getCurrentScope:se.bind(rt),getGlobalScope:Ze.bind(rt),getCurrentContext:Sr.bind(rt),getExecStartTime:rt.getExecStartTime.bind(rt)}},D}();function Hs(D,X,_t){if(_t===void 0&&(_t=!0),!(D instanceof qo))throw new Error("Illegal call");if(typeof X!="string")return X;if(!!X){var rt=D.generator(),se=rt.getOptions(),Ze={timeout:se.timeout,_initEnv:function(){_t||this.setCurrentContext(rt.getCurrentContext()),this.execStartTime=rt.getExecStartTime(),this.execEndTime=this.execStartTime}},Sr=_t?rt.getGlobalScope():rt.getCurrentScope(),jr=new rs(Sr,Ze);return jr.evaluate(X)}}Object.defineProperty(Hs,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function Xu(D){if(!(D instanceof qo))throw new Error("Illegal call");for(var X=D.generator(),_t=arguments.length,rt=new Array(_t>1?_t-1:0),se=1;se<_t;se++)rt[se-1]=arguments[se];var Ze=rt.pop(),Sr=new rs(X.getGlobalScope(),X.getOptions()),jr=`
		    (function anonymous(`+rt.join(",")+`){
		        `+Ze+`
		    });
		    `;return Sr.evaluate(jr)}Object.defineProperty(Xu,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var _s=function(X){this.value=X},vs=function(X){this.value=X},Ou=function(X){this.value=X},rl=function(X,_t,rt){_t===void 0&&(_t=null),this.name=rt,this.parent=_t,this.data=X,this.labelStack=[]};function nu(){}function dl(D,X){return D===void 0&&(D=null),new rl(Object.create(null),D,X)}function Fu(D){return Object.create(D)}var Fo={NaN:NaN,Infinity:1/0,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:Hs,Function:Xu};typeof JSON!="undefined"&&(Fo.JSON=JSON),typeof Promise!="undefined"&&(Fo.Promise=Promise),typeof Set!="undefined"&&(Fo.Set=Set),typeof Map!="undefined"&&(Fo.Map=Map),typeof Symbol!="undefined"&&(Fo.Symbol=Symbol),typeof Proxy!="undefined"&&(Fo.Proxy=Proxy),typeof WeakMap!="undefined"&&(Fo.WeakMap=WeakMap),typeof WeakSet!="undefined"&&(Fo.WeakSet=WeakSet),typeof Reflect!="undefined"&&(Fo.Reflect=Reflect);var rs=function(){function D(_t,rt){_t===void 0&&(_t=D.global),rt===void 0&&(rt={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:rt.ecmaVersion||D.ecmaVersion,timeout:rt.timeout||0,rootContext:rt.rootContext,globalContextInFunction:rt.globalContextInFunction===void 0?D.globalContextInFunction:rt.globalContextInFunction,_initEnv:rt._initEnv},this.context=_t||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var X=D.prototype;return X.initEnvironment=function(rt){var se;if(rt instanceof rl)se=rt;else{var Ze=null,Sr=this.createSuperScope(rt);this.options.rootContext&&(Ze=new rl(Fu(this.options.rootContext),Sr,Ma)),se=new rl(rt,Ze||Sr,ds)}this.globalScope=se,this.currentScope=this.globalScope,this.globalContext=se.data,this.currentContext=se.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var jr=this.options._initEnv;jr&&jr.call(this)},X.getExecStartTime=function(){return this.execStartTime},X.getExecutionTime=function(){return this.execEndTime-this.execStartTime},X.setExecTimeout=function(rt){rt===void 0&&(rt=0),this.options.timeout=rt},X.getOptions=function(){return this.options},X.getGlobalScope=function(){return this.globalScope},X.getCurrentScope=function(){return this.currentScope},X.getCurrentContext=function(){return this.currentContext},X.isInterruptThrow=function(rt){return rt instanceof es||rt instanceof ns||rt instanceof ko},X.createSuperScope=function(rt){var se=Object.assign({},Fo),Ze=Object.keys(se);return Ze.forEach(function(Sr){Sr in rt&&delete se[Sr]}),new rl(se,null,ji)},X.setCurrentContext=function(rt){this.currentContext=rt},X.setCurrentScope=function(rt){this.currentScope=rt},X.evaluate=function(rt){rt===void 0&&(rt="");var se;if(!!rt)return se=Uo(rt,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||D.ecmaVersion}),this.evaluateNode(se,rt)},X.appendCode=function(rt){return this.evaluate(rt)},X.evaluateNode=function(rt,se){var Ze=this;se===void 0&&(se=""),this.value=void 0,this.source=se,this.sourceList.push(se),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var Sr=this.getCurrentScope(),jr=this.getCurrentContext(),Vr=Sr.labelStack.concat([]),Ln=this.callStack.concat([]),Gn=function(){Ze.setCurrentScope(Sr),Ze.setCurrentContext(jr),Sr.labelStack=Vr,Ze.callStack=Ln};try{var $i=this.createClosure(rt);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),$i()}catch(Pa){throw Pa}finally{Gn(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},X.createErrorMessage=function(rt,se,Ze){var Sr=rt[1].replace("%0",String(se));return Ze!==null&&(Sr+=this.getNodePosition(Ze||this.lastExecNode)),Sr},X.createError=function(rt,se){return new se(rt)},X.createThrowError=function(rt,se){return this.createError(rt,se)},X.createInternalThrowError=function(rt,se,Ze){return this.createError(this.createErrorMessage(rt,se,Ze),rt[2])},X.checkTimeout=function(){if(!this.isRunning)return!1;var rt=this.options.timeout||0,se=Date.now();return se-this.execStartTime>rt},X.getNodePosition=function(rt){if(rt){var se="";return rt.loc?" ["+rt.loc.start.line+":"+rt.loc.start.column+"]"+se:""}return""},X.createClosure=function(rt){var se=this,Ze;switch(rt.type){case"BinaryExpression":Ze=this.binaryExpressionHandler(rt);break;case"LogicalExpression":Ze=this.logicalExpressionHandler(rt);break;case"UnaryExpression":Ze=this.unaryExpressionHandler(rt);break;case"UpdateExpression":Ze=this.updateExpressionHandler(rt);break;case"ObjectExpression":Ze=this.objectExpressionHandler(rt);break;case"ArrayExpression":Ze=this.arrayExpressionHandler(rt);break;case"CallExpression":Ze=this.callExpressionHandler(rt);break;case"NewExpression":Ze=this.newExpressionHandler(rt);break;case"MemberExpression":Ze=this.memberExpressionHandler(rt);break;case"ThisExpression":Ze=this.thisExpressionHandler(rt);break;case"SequenceExpression":Ze=this.sequenceExpressionHandler(rt);break;case"Literal":Ze=this.literalHandler(rt);break;case"Identifier":Ze=this.identifierHandler(rt);break;case"AssignmentExpression":Ze=this.assignmentExpressionHandler(rt);break;case"FunctionDeclaration":Ze=this.functionDeclarationHandler(rt);break;case"VariableDeclaration":Ze=this.variableDeclarationHandler(rt);break;case"BlockStatement":case"Program":Ze=this.programHandler(rt);break;case"ExpressionStatement":Ze=this.expressionStatementHandler(rt);break;case"EmptyStatement":Ze=this.emptyStatementHandler(rt);break;case"ReturnStatement":Ze=this.returnStatementHandler(rt);break;case"FunctionExpression":Ze=this.functionExpressionHandler(rt);break;case"IfStatement":Ze=this.ifStatementHandler(rt);break;case"ConditionalExpression":Ze=this.conditionalExpressionHandler(rt);break;case"ForStatement":Ze=this.forStatementHandler(rt);break;case"WhileStatement":Ze=this.whileStatementHandler(rt);break;case"DoWhileStatement":Ze=this.doWhileStatementHandler(rt);break;case"ForInStatement":Ze=this.forInStatementHandler(rt);break;case"WithStatement":Ze=this.withStatementHandler(rt);break;case"ThrowStatement":Ze=this.throwStatementHandler(rt);break;case"TryStatement":Ze=this.tryStatementHandler(rt);break;case"ContinueStatement":Ze=this.continueStatementHandler(rt);break;case"BreakStatement":Ze=this.breakStatementHandler(rt);break;case"SwitchStatement":Ze=this.switchStatementHandler(rt);break;case"LabeledStatement":Ze=this.labeledStatementHandler(rt);break;case"DebuggerStatement":Ze=this.debuggerStatementHandler(rt);break;default:throw this.createInternalThrowError(Ya.NodeTypeSyntaxError,rt.type,rt)}return function(){var Sr=se.options.timeout;if(Sr&&Sr>0&&se.checkTimeout())throw se.createInternalThrowError(Ya.ExecutionTimeOutError,Sr,null);return se.lastExecNode=rt,Ze.apply(void 0,arguments)}},X.binaryExpressionHandler=function(rt){var se=this,Ze=this.createClosure(rt.left),Sr=this.createClosure(rt.right);return function(){var jr=Ze(),Vr=Sr();switch(rt.operator){case"==":return jr==Vr;case"!=":return jr!=Vr;case"===":return jr===Vr;case"!==":return jr!==Vr;case"<":return jr<Vr;case"<=":return jr<=Vr;case">":return jr>Vr;case">=":return jr>=Vr;case"<<":return jr<<Vr;case">>":return jr>>Vr;case">>>":return jr>>>Vr;case"+":return jr+Vr;case"-":return jr-Vr;case"*":return jr*Vr;case"**":return Math.pow(jr,Vr);case"/":return jr/Vr;case"%":return jr%Vr;case"|":return jr|Vr;case"^":return jr^Vr;case"&":return jr&Vr;case"in":return jr in Vr;case"instanceof":return jr instanceof Vr;default:throw se.createInternalThrowError(Ya.BinaryOperatorSyntaxError,rt.operator,rt)}}},X.logicalExpressionHandler=function(rt){var se=this,Ze=this.createClosure(rt.left),Sr=this.createClosure(rt.right);return function(){switch(rt.operator){case"||":return Ze()||Sr();case"&&":return Ze()&&Sr();default:throw se.createInternalThrowError(Ya.LogicalOperatorSyntaxError,rt.operator,rt)}}},X.unaryExpressionHandler=function(rt){var se=this;switch(rt.operator){case"delete":var Ze=this.createObjectGetter(rt.argument),Sr=this.createNameGetter(rt.argument);return function(){var Gn=Ze(),$i=Sr();return delete Gn[$i]};default:var jr;if(rt.operator==="typeof"&&rt.argument.type==="Identifier"){var Vr=this.createObjectGetter(rt.argument),Ln=this.createNameGetter(rt.argument);jr=function(){return Vr()[Ln()]}}else jr=this.createClosure(rt.argument);return function(){var Gn=jr();switch(rt.operator){case"-":return-Gn;case"+":return+Gn;case"!":return!Gn;case"~":return~Gn;case"void":return;case"typeof":return typeof Gn;default:throw se.createInternalThrowError(Ya.UnaryOperatorSyntaxError,rt.operator,rt)}}}},X.updateExpressionHandler=function(rt){var se=this,Ze=this.createObjectGetter(rt.argument),Sr=this.createNameGetter(rt.argument);return function(){var jr=Ze(),Vr=Sr();switch(se.assertVariable(jr,Vr,rt),rt.operator){case"++":return rt.prefix?++jr[Vr]:jr[Vr]++;case"--":return rt.prefix?--jr[Vr]:jr[Vr]--;default:throw se.createInternalThrowError(Ya.UpdateOperatorSyntaxError,rt.operator,rt)}}},X.objectExpressionHandler=function(rt){var se=this,Ze=[];function Sr(Vr){return Vr.type==="Identifier"?Vr.name:Vr.type==="Literal"?Vr.value:this.throwError(Ya.ObjectStructureSyntaxError,Vr.type,Vr)}var jr=Object.create(null);return rt.properties.forEach(function(Vr){var Ln=Vr.kind,Gn=Sr(Vr.key);(!jr[Gn]||Ln==="init")&&(jr[Gn]={}),jr[Gn][Ln]=se.createClosure(Vr.value),Ze.push({key:Gn,property:Vr})}),function(){for(var Vr={},Ln=Ze.length,Gn=0;Gn<Ln;Gn++){var $i=Ze[Gn],Pa=$i.key,ba=jr[Pa],uo=ba.init?ba.init():void 0,Ca=ba.get?ba.get():function(){},Ao=ba.set?ba.set():function(il){};if("set"in ba||"get"in ba){var qa={configurable:!0,enumerable:!0,get:Ca,set:Ao};Object.defineProperty(Vr,Pa,qa)}else{var gs=$i.property,xu=gs.kind;gs.key.type==="Identifier"&&gs.value.type==="FunctionExpression"&&xu==="init"&&!gs.value.id&&mf(uo,gs.key.name),Vr[Pa]=uo}}return Vr}},X.arrayExpressionHandler=function(rt){var se=this,Ze=rt.elements.map(function(Sr){return Sr&&se.createClosure(Sr)});return function(){for(var Sr=Ze.length,jr=Array(Sr),Vr=0;Vr<Sr;Vr++){var Ln=Ze[Vr];Ln&&(jr[Vr]=Ln())}return jr}},X.safeObjectGet=function(rt,se,Ze){return rt[se]},X.createCallFunctionGetter=function(rt){var se=this;switch(rt.type){case"MemberExpression":var Ze=this.createClosure(rt.object),Sr=this.createMemberKeyGetter(rt),jr=this.source;return function(){var Ln=Ze(),Gn=Sr(),$i=se.safeObjectGet(Ln,Gn,rt);if(!$i||!Ho($i)){var Pa=jr.slice(rt.start,rt.end);throw se.createInternalThrowError(Ya.FunctionUndefinedReferenceError,Pa,rt)}return $i.__IS_EVAL_FUNC?function(ba){return $i(new qo(se),ba,!0)}:$i.__IS_FUNCTION_FUNC?function(){for(var ba=arguments.length,uo=new Array(ba),Ca=0;Ca<ba;Ca++)uo[Ca]=arguments[Ca];return $i.apply(void 0,[new qo(se)].concat(uo))}:$i.bind(Ln)};default:var Vr=this.createClosure(rt);return function(){var Ln="";rt.type==="Identifier"&&(Ln=rt.name);var Gn=Vr();if(!Gn||!Ho(Gn))throw se.createInternalThrowError(Ya.FunctionUndefinedReferenceError,Ln,rt);if(rt.type==="Identifier"&&Gn.__IS_EVAL_FUNC&&Ln==="eval")return function(ba){var uo=se.getScopeFromName(Ln,se.getCurrentScope()),Ca=uo.name===ji||uo.name===ds||uo.name===Ma;return Gn(new qo(se),ba,!Ca)};if(Gn.__IS_EVAL_FUNC)return function(ba){return Gn(new qo(se),ba,!0)};if(Gn.__IS_FUNCTION_FUNC)return function(){for(var ba=arguments.length,uo=new Array(ba),Ca=0;Ca<ba;Ca++)uo[Ca]=arguments[Ca];return Gn.apply(void 0,[new qo(se)].concat(uo))};var $i=se.options.globalContextInFunction;if(rt.type==="Identifier"){var Pa=se.getIdentifierScope(rt);Pa.name===si&&($i=Pa.data)}return Gn.bind($i)}}},X.callExpressionHandler=function(rt){var se=this,Ze=this.createCallFunctionGetter(rt.callee),Sr=rt.arguments.map(function(jr){return se.createClosure(jr)});return function(){return Ze().apply(void 0,Sr.map(function(jr){return jr()}))}},X.functionExpressionHandler=function(rt){var se=this,Ze=this,Sr=this.source,jr=this.collectDeclVars,Vr=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var Ln=rt.id?rt.id.name:"",Gn=rt.params.length,$i=rt.params.map(function(Ca){return se.createParamNameGetter(Ca)}),Pa=this.createClosure(rt.body),ba=this.collectDeclVars,uo=this.collectDeclFuncs;return this.collectDeclVars=jr,this.collectDeclFuncs=Vr,function(){var Ca=Ze.getCurrentScope(),Ao=function qa(){for(var gs=arguments.length,xu=new Array(gs),il=0;il<gs;il++)xu[il]=arguments[il];Ze.callStack.push(""+Ln);var bu=Ze.getCurrentScope(),iu=dl(Ca,"FunctionScope("+Ln+")");Ze.setCurrentScope(iu),Ze.addDeclarationsToScope(ba,uo,iu),Ln&&(iu.data[Ln]=qa),iu.data.arguments=arguments,$i.forEach(function(Yl,me){iu.data[Yl()]=xu[me]});var Vc=Ze.getCurrentContext();Ze.setCurrentContext(this);var $s=Pa();if(Ze.setCurrentContext(Vc),Ze.setCurrentScope(bu),Ze.callStack.pop(),$s instanceof _s)return $s.value};return mf(Ao,Ln),Object.defineProperty(Ao,"length",{value:Gn,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(Ao,"toString",{value:function(){return Sr.slice(rt.start,rt.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Ao,"valueOf",{value:function(){return Sr.slice(rt.start,rt.end)},writable:!0,configurable:!0,enumerable:!1}),Ao}},X.newExpressionHandler=function(rt){var se=this,Ze=this.source,Sr=this.createClosure(rt.callee),jr=rt.arguments.map(function(Vr){return se.createClosure(Vr)});return function(){var Vr=Sr();if(!Ho(Vr)||Vr.__IS_EVAL_FUNC){var Ln=rt.callee,Gn=Ze.slice(Ln.start,Ln.end);throw se.createInternalThrowError(Ya.IsNotConstructor,Gn,rt)}return Vr.__IS_FUNCTION_FUNC?Vr.apply(void 0,[new qo(se)].concat(jr.map(function($i){return $i()}))):pu(Vr,jr.map(function($i){return $i()}))}},X.memberExpressionHandler=function(rt){var se=this.createClosure(rt.object),Ze=this.createMemberKeyGetter(rt);return function(){var Sr=se(),jr=Ze();return Sr[jr]}},X.thisExpressionHandler=function(rt){var se=this;return function(){return se.getCurrentContext()}},X.sequenceExpressionHandler=function(rt){var se=this,Ze=rt.expressions.map(function(Sr){return se.createClosure(Sr)});return function(){for(var Sr,jr=Ze.length,Vr=0;Vr<jr;Vr++){var Ln=Ze[Vr];Sr=Ln()}return Sr}},X.literalHandler=function(rt){return function(){return rt.regex?new RegExp(rt.regex.pattern,rt.regex.flags):rt.value}},X.identifierHandler=function(rt){var se=this;return function(){var Ze=se.getCurrentScope(),Sr=se.getScopeDataFromName(rt.name,Ze);return se.assertVariable(Sr,rt.name,rt),Sr[rt.name]}},X.getIdentifierScope=function(rt){var se=this.getCurrentScope(),Ze=this.getScopeFromName(rt.name,se);return Ze},X.assignmentExpressionHandler=function(rt){var se=this;rt.left.type==="Identifier"&&rt.right.type==="FunctionExpression"&&!rt.right.id&&(rt.right.id={type:"Identifier",name:rt.left.name});var Ze=this.createObjectGetter(rt.left),Sr=this.createNameGetter(rt.left),jr=this.createClosure(rt.right);return function(){var Vr=Ze(),Ln=Sr(),Gn=jr();switch(rt.operator!=="="&&se.assertVariable(Vr,Ln,rt),rt.operator){case"=":return Vr[Ln]=Gn;case"+=":return Vr[Ln]+=Gn;case"-=":return Vr[Ln]-=Gn;case"*=":return Vr[Ln]*=Gn;case"**=":return Vr[Ln]=Math.pow(Vr[Ln],Gn);case"/=":return Vr[Ln]/=Gn;case"%=":return Vr[Ln]%=Gn;case"<<=":return Vr[Ln]<<=Gn;case">>=":return Vr[Ln]>>=Gn;case">>>=":return Vr[Ln]>>>=Gn;case"&=":return Vr[Ln]&=Gn;case"^=":return Vr[Ln]^=Gn;case"|=":return Vr[Ln]|=Gn;default:throw se.createInternalThrowError(Ya.AssignmentExpressionSyntaxError,rt.type,rt)}}},X.functionDeclarationHandler=function(rt){if(rt.id){var se=this.functionExpressionHandler(rt);Object.defineProperty(se,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(rt.id.name,se)}return function(){return un}},X.getVariableName=function(rt){if(rt.type==="Identifier")return rt.name;throw this.createInternalThrowError(Ya.VariableTypeSyntaxError,rt.type,rt)},X.variableDeclarationHandler=function(rt){for(var se=this,Ze,Sr=[],jr=0;jr<rt.declarations.length;jr++){var Vr=rt.declarations[jr];this.varDeclaration(this.getVariableName(Vr.id)),Vr.init&&Sr.push({type:"AssignmentExpression",operator:"=",left:Vr.id,right:Vr.init})}return Sr.length&&(Ze=this.createClosure({type:"BlockStatement",body:Sr})),function(){if(Ze){var Ln=se.isVarDeclMode;se.isVarDeclMode=!0,Ze(),se.isVarDeclMode=Ln}return un}},X.assertVariable=function(rt,se,Ze){if(rt===this.globalScope.data&&!(se in rt))throw this.createInternalThrowError(Ya.VariableUndefinedReferenceError,se,Ze)},X.programHandler=function(rt){var se=this,Ze=rt.body.map(function(Sr){return se.createClosure(Sr)});return function(){for(var Sr=un,jr=0;jr<Ze.length;jr++){var Vr=Ze[jr],Ln=se.setValue(Vr());if(Ln!==un&&(Sr=Ln,Sr instanceof _s||Sr instanceof vs||Sr instanceof Ou||Sr===Ie||Sr===We))break}return Sr}},X.expressionStatementHandler=function(rt){return this.createClosure(rt.expression)},X.emptyStatementHandler=function(rt){return function(){return un}},X.returnStatementHandler=function(rt){var se=rt.argument?this.createClosure(rt.argument):nu;return function(){return new _s(se())}},X.ifStatementHandler=function(rt){var se=this.createClosure(rt.test),Ze=this.createClosure(rt.consequent),Sr=rt.alternate?this.createClosure(rt.alternate):function(){return un};return function(){return se()?Ze():Sr()}},X.conditionalExpressionHandler=function(rt){return this.ifStatementHandler(rt)},X.forStatementHandler=function(rt){var se=this,Ze=nu,Sr=rt.test?this.createClosure(rt.test):function(){return!0},jr=nu,Vr=this.createClosure(rt.body);return rt.type==="ForStatement"&&(Ze=rt.init?this.createClosure(rt.init):Ze,jr=rt.update?this.createClosure(rt.update):nu),function(Ln){var Gn,$i=un,Pa=rt.type==="DoWhileStatement";for(Ln&&Ln.type==="LabeledStatement"&&(Gn=Ln.label.name),Ze();Pa||Sr();jr()){Pa=!1;var ba=se.setValue(Vr());if(!(ba===un||ba===We)){if(ba===Ie)break;if($i=ba,$i instanceof Ou&&$i.value===Gn){$i=un;continue}if($i instanceof _s||$i instanceof vs||$i instanceof Ou)break}}return $i}},X.whileStatementHandler=function(rt){return this.forStatementHandler(rt)},X.doWhileStatementHandler=function(rt){return this.forStatementHandler(rt)},X.forInStatementHandler=function(rt){var se=this,Ze=rt.left,Sr=this.createClosure(rt.right),jr=this.createClosure(rt.body);return rt.left.type==="VariableDeclaration"&&(this.createClosure(rt.left)(),Ze=rt.left.declarations[0].id),function(Vr){var Ln,Gn=un,$i;Vr&&Vr.type==="LabeledStatement"&&(Ln=Vr.label.name);var Pa=Sr();for($i in Pa){se.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:Ze,right:{type:"Literal",value:$i}})();var ba=se.setValue(jr());if(!(ba===un||ba===We)){if(ba===Ie)break;if(Gn=ba,Gn instanceof Ou&&Gn.value===Ln){Gn=un;continue}if(Gn instanceof _s||Gn instanceof vs||Gn instanceof Ou)break}}return Gn}},X.withStatementHandler=function(rt){var se=this,Ze=this.createClosure(rt.object),Sr=this.createClosure(rt.body);return function(){var jr=Ze(),Vr=se.getCurrentScope(),Ln=new rl(jr,Vr,si);se.setCurrentScope(Ln);var Gn=se.setValue(Sr());return se.setCurrentScope(Vr),Gn}},X.throwStatementHandler=function(rt){var se=this,Ze=this.createClosure(rt.argument);return function(){throw se.setValue(void 0),Ze()}},X.tryStatementHandler=function(rt){var se=this,Ze=this.createClosure(rt.block),Sr=rt.handler?this.catchClauseHandler(rt.handler):null,jr=rt.finalizer?this.createClosure(rt.finalizer):null;return function(){var Vr=se.getCurrentScope(),Ln=se.getCurrentContext(),Gn=Vr.labelStack.concat([]),$i=se.callStack.concat([]),Pa=un,ba,uo,Ca=function(){se.setCurrentScope(Vr),se.setCurrentContext(Ln),Vr.labelStack=Gn,se.callStack=$i};try{Pa=se.setValue(Ze()),Pa instanceof _s&&(ba=Pa)}catch(Ao){if(Ca(),se.isInterruptThrow(Ao))throw Ao;if(Sr)try{Pa=se.setValue(Sr(Ao)),Pa instanceof _s&&(ba=Pa)}catch(qa){if(Ca(),se.isInterruptThrow(qa))throw qa;uo=qa}}if(jr)try{Pa=jr(),Pa instanceof _s&&(ba=Pa)}catch(Ao){if(Ca(),se.isInterruptThrow(Ao))throw Ao;uo=Ao}if(uo)throw uo;return ba||Pa}},X.catchClauseHandler=function(rt){var se=this,Ze=this.createParamNameGetter(rt.param),Sr=this.createClosure(rt.body);return function(jr){var Vr,Ln=se.getCurrentScope(),Gn=Ln.data,$i=Ze(),Pa=Wu.call(Gn,$i),ba=Gn[$i];return Gn[$i]=jr,Vr=Sr(),Pa?Gn[$i]=ba:delete Gn[$i],Vr}},X.continueStatementHandler=function(rt){return function(){return rt.label?new Ou(rt.label.name):We}},X.breakStatementHandler=function(rt){return function(){return rt.label?new vs(rt.label.name):Ie}},X.switchStatementHandler=function(rt){var se=this,Ze=this.createClosure(rt.discriminant),Sr=rt.cases.map(function(jr){return se.switchCaseHandler(jr)});return function(){for(var jr=Ze(),Vr=!1,Ln,Gn,$i,Pa=0;Pa<Sr.length;Pa++){var ba=Sr[Pa](),uo=ba.testClosure();if(uo===Tr){$i=ba;continue}if(Vr||uo===jr){if(Vr=!0,Gn=se.setValue(ba.bodyClosure()),Gn===un)continue;if(Gn===Ie||(Ln=Gn,Ln instanceof _s||Ln instanceof vs||Ln instanceof Ou||Ln===We))break}}if(!Vr&&$i){Gn=se.setValue($i.bodyClosure());var Ca=Gn===un||Gn===Ie||Gn===We;Ca||(Ln=Gn)}return Ln}},X.switchCaseHandler=function(rt){var se=rt.test?this.createClosure(rt.test):function(){return Tr},Ze=this.createClosure({type:"BlockStatement",body:rt.consequent});return function(){return{testClosure:se,bodyClosure:Ze}}},X.labeledStatementHandler=function(rt){var se=this,Ze=rt.label.name,Sr=this.createClosure(rt.body);return function(){var jr,Vr=se.getCurrentScope();return Vr.labelStack.push(Ze),jr=Sr(rt),jr instanceof vs&&jr.value===Ze&&(jr=un),Vr.labelStack.pop(),jr}},X.debuggerStatementHandler=function(rt){return function(){debugger;return un}},X.createParamNameGetter=function(rt){if(rt.type==="Identifier")return function(){return rt.name};throw this.createInternalThrowError(Ya.ParamTypeSyntaxError,rt.type,rt)},X.createObjectKeyGetter=function(rt){var se;return rt.type==="Identifier"?se=function(){return rt.name}:se=this.createClosure(rt),function(){return se()}},X.createMemberKeyGetter=function(rt){return rt.computed?this.createClosure(rt.property):this.createObjectKeyGetter(rt.property)},X.createObjectGetter=function(rt){var se=this;switch(rt.type){case"Identifier":return function(){return se.getScopeDataFromName(rt.name,se.getCurrentScope())};case"MemberExpression":return this.createClosure(rt.object);default:throw this.createInternalThrowError(Ya.AssignmentTypeSyntaxError,rt.type,rt)}},X.createNameGetter=function(rt){switch(rt.type){case"Identifier":return function(){return rt.name};case"MemberExpression":return this.createMemberKeyGetter(rt);default:throw this.createInternalThrowError(Ya.AssignmentTypeSyntaxError,rt.type,rt)}},X.varDeclaration=function(rt){var se=this.collectDeclVars;se[rt]=void 0},X.funcDeclaration=function(rt,se){var Ze=this.collectDeclFuncs;Ze[rt]=se},X.addDeclarationsToScope=function(rt,se,Ze){var Sr=Ze.data;for(var jr in se){var Vr=se[jr];Sr[jr]=Vr&&Vr()}for(var Ln in rt)Ln in Sr||(Sr[Ln]=void 0)},X.getScopeValue=function(rt,se){var Ze=this.getScopeFromName(rt,se);return Ze.data[rt]},X.getScopeDataFromName=function(rt,se){return this.getScopeFromName(rt,se).data},X.getScopeFromName=function(rt,se){var Ze=se;do if(rt in Ze.data)return Ze;while(Ze=Ze.parent);return this.globalScope},X.setValue=function(rt){var se=this.callStack.length;return this.isVarDeclMode||se||rt===un||rt===Ie||rt===We||rt instanceof vs||rt instanceof Ou||(this.value=rt instanceof _s?rt.value:rt),rt},X.getValue=function(){return this.value},D}();rs.version=Rl,rs.eval=Hs,rs.Function=Xu,rs.ecmaVersion=5,rs.globalContextInFunction=void 0,rs.global=Object.create(null);function Uc(D){return D===void 0&&(D=Object.create(null)),D}function _u(D,X,_t){X===void 0&&(X=[]),_t===void 0&&(_t={});var rt=_t.parsingContext,se=_t.timeout===void 0?0:_t.timeout,Ze=`
    (function anonymous(`+X.join(",")+`){
         `+D+`
    });
    `,Sr=new rs(rt,{ecmaVersion:_t.ecmaVersion,timeout:se,rootContext:_t.rootContext,globalContextInFunction:_t.globalContextInFunction});return Sr.evaluate(Ze)}function Zc(D,X,_t){var rt=new rs(X,_t);return rt.evaluate(D)}var Co=Zc,sc=function(){function D(_t){this._code=_t}var X=D.prototype;return X.runInContext=function(rt){return Zc(this._code,rt)},X.runInNewContext=function(rt){return Zc(this._code,rt)},D}(),Xl=function(D,X,_t){return Zc(D,X,_t)};function nl(){for(var D=arguments.length,X=new Array(D),_t=0;_t<D;_t++)X[_t]=arguments[_t];var rt=X.pop();return _u(rt||"",X)}var uc=Xl},20396:function(gn,Ot,ot){var kt;(function(bt,I,xt,K){"use strict";var ut=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ht=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),lt=ut||ht,tt=["","webkit","Moz","MS","ms","o"],be=lt?"":I.createElement("div"),it="function",st=Math.round,Ut=Math.abs,P=Date.now;function b(Ie,We,Tr){return setTimeout(we(Ie,Tr),We)}function W(Ie,We,Tr){return Array.isArray(Ie)?(fe(Ie,Tr[We],Tr),!0):!1}function fe(Ie,We,Tr){var un;if(!!Ie)if(Ie.forEach)Ie.forEach(We,Tr);else if(Ie.length!==K)for(un=0;un<Ie.length;)We.call(Tr,Ie[un],un,Ie),un++;else for(un in Ie)Ie.hasOwnProperty(un)&&We.call(Tr,Ie[un],un,Ie)}function Ee(Ie,We,Tr){var un="DEPRECATED METHOD: "+We+`
`+Tr+` AT 
`;return function(){var si=new Error("get-stack-trace"),ji=si&&si.stack?si.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ma=bt.console&&(bt.console.warn||bt.console.log);return Ma&&Ma.call(bt.console,un,ji),Ie.apply(this,arguments)}}var Te;typeof Object.assign!="function"?Te=function(We){if(We===K||We===null)throw new TypeError("Cannot convert undefined or null to object");for(var Tr=Object(We),un=1;un<arguments.length;un++){var si=arguments[un];if(si!==K&&si!==null)for(var ji in si)si.hasOwnProperty(ji)&&(Tr[ji]=si[ji])}return Tr}:Te=Object.assign;var Mt=Ee(function(We,Tr,un){for(var si=Object.keys(Tr),ji=0;ji<si.length;)(!un||un&&We[si[ji]]===K)&&(We[si[ji]]=Tr[si[ji]]),ji++;return We},"extend","Use `assign`."),et=Ee(function(We,Tr){return Mt(We,Tr,!0)},"merge","Use `assign`.");function Dt(Ie,We,Tr){var un=We.prototype,si;si=Ie.prototype=Object.create(un),si.constructor=Ie,si._super=un,Tr&&Te(si,Tr)}function we(Ie,We){return function(){return Ie.apply(We,arguments)}}function _e(Ie,We){return typeof Ie==it?Ie.apply(We&&We[0]||K,We):Ie}function ge(Ie,We){return Ie===K?We:Ie}function te(Ie,We,Tr){fe(Qt(We),function(un){Ie.addEventListener(un,Tr,!1)})}function xe(Ie,We,Tr){fe(Qt(We),function(un){Ie.removeEventListener(un,Tr,!1)})}function Ye(Ie,We){for(;Ie;){if(Ie==We)return!0;Ie=Ie.parentNode}return!1}function Lt(Ie,We){return Ie.indexOf(We)>-1}function Qt(Ie){return Ie.trim().split(/\s+/g)}function ct(Ie,We,Tr){if(Ie.indexOf&&!Tr)return Ie.indexOf(We);for(var un=0;un<Ie.length;){if(Tr&&Ie[un][Tr]==We||!Tr&&Ie[un]===We)return un;un++}return-1}function Ct(Ie){return Array.prototype.slice.call(Ie,0)}function Y(Ie,We,Tr){for(var un=[],si=[],ji=0;ji<Ie.length;){var Ma=We?Ie[ji][We]:Ie[ji];ct(si,Ma)<0&&un.push(Ie[ji]),si[ji]=Ma,ji++}return Tr&&(We?un=un.sort(function(Ho,qo){return Ho[We]>qo[We]}):un=un.sort()),un}function yt(Ie,We){for(var Tr,un,si=We[0].toUpperCase()+We.slice(1),ji=0;ji<tt.length;){if(Tr=tt[ji],un=Tr?Tr+si:We,un in Ie)return un;ji++}return K}var Xt=1;function ie(){return Xt++}function Ce(Ie){var We=Ie.ownerDocument||Ie;return We.defaultView||We.parentWindow||bt}var er=/mobile|tablet|ip(ad|hone|od)|android/i,Ht="ontouchstart"in bt,ne=yt(bt,"PointerEvent")!==K,Me=Ht&&er.test(navigator.userAgent),ae="touch",Je="pen",or="mouse",re="kinect",Jt=25,Et=1,$t=2,Yt=4,St=8,At=1,ue=2,Pe=4,je=8,Nt=16,wt=ue|Pe,Tt=je|Nt,Ft=wt|Tt,J=["x","y"],gt=["clientX","clientY"];function jt(Ie,We){var Tr=this;this.manager=Ie,this.callback=We,this.element=Ie.element,this.target=Ie.options.inputTarget,this.domHandler=function(un){_e(Ie.options.enable,[Ie])&&Tr.handler(un)},this.init()}jt.prototype={handler:function(){},init:function(){this.evEl&&te(this.element,this.evEl,this.domHandler),this.evTarget&&te(this.target,this.evTarget,this.domHandler),this.evWin&&te(Ce(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&xe(this.element,this.evEl,this.domHandler),this.evTarget&&xe(this.target,this.evTarget,this.domHandler),this.evWin&&xe(Ce(this.element),this.evWin,this.domHandler)}};function ve(Ie){var We,Tr=Ie.options.inputClass;return Tr?We=Tr:ne?We=ze:Me?We=Qr:Ht?We=Kr:We=Wn,new We(Ie,Gt)}function Gt(Ie,We,Tr){var un=Tr.pointers.length,si=Tr.changedPointers.length,ji=We&Et&&un-si===0,Ma=We&(Yt|St)&&un-si===0;Tr.isFirst=!!ji,Tr.isFinal=!!Ma,ji&&(Ie.session={}),Tr.eventType=We,Ae(Ie,Tr),Ie.emit("hammer.input",Tr),Ie.recognize(Tr),Ie.session.prevInput=Tr}function Ae(Ie,We){var Tr=Ie.session,un=We.pointers,si=un.length;Tr.firstInput||(Tr.firstInput=hr(We)),si>1&&!Tr.firstMultiple?Tr.firstMultiple=hr(We):si===1&&(Tr.firstMultiple=!1);var ji=Tr.firstInput,Ma=Tr.firstMultiple,ds=Ma?Ma.center:ji.center,Ho=We.center=tr(un);We.timeStamp=P(),We.deltaTime=We.timeStamp-ji.timeStamp,We.angle=Tn(ds,Ho),We.distance=Zr(ds,Ho),He(Tr,We),We.offsetDirection=Lr(We.deltaX,We.deltaY);var qo=Br(We.deltaTime,We.deltaX,We.deltaY);We.overallVelocityX=qo.x,We.overallVelocityY=qo.y,We.overallVelocity=Ut(qo.x)>Ut(qo.y)?qo.x:qo.y,We.scale=Ma?Nn(Ma.pointers,un):1,We.rotation=Ma?rn(Ma.pointers,un):0,We.maxPointers=Tr.prevInput?We.pointers.length>Tr.prevInput.maxPointers?We.pointers.length:Tr.prevInput.maxPointers:We.pointers.length,qe(Tr,We);var Hs=Ie.element;Ye(We.srcEvent.target,Hs)&&(Hs=We.srcEvent.target),We.target=Hs}function He(Ie,We){var Tr=We.center,un=Ie.offsetDelta||{},si=Ie.prevDelta||{},ji=Ie.prevInput||{};(We.eventType===Et||ji.eventType===Yt)&&(si=Ie.prevDelta={x:ji.deltaX||0,y:ji.deltaY||0},un=Ie.offsetDelta={x:Tr.x,y:Tr.y}),We.deltaX=si.x+(Tr.x-un.x),We.deltaY=si.y+(Tr.y-un.y)}function qe(Ie,We){var Tr=Ie.lastInterval||We,un=We.timeStamp-Tr.timeStamp,si,ji,Ma,ds;if(We.eventType!=St&&(un>Jt||Tr.velocity===K)){var Ho=We.deltaX-Tr.deltaX,qo=We.deltaY-Tr.deltaY,Hs=Br(un,Ho,qo);ji=Hs.x,Ma=Hs.y,si=Ut(Hs.x)>Ut(Hs.y)?Hs.x:Hs.y,ds=Lr(Ho,qo),Ie.lastInterval=We}else si=Tr.velocity,ji=Tr.velocityX,Ma=Tr.velocityY,ds=Tr.direction;We.velocity=si,We.velocityX=ji,We.velocityY=Ma,We.direction=ds}function hr(Ie){for(var We=[],Tr=0;Tr<Ie.pointers.length;)We[Tr]={clientX:st(Ie.pointers[Tr].clientX),clientY:st(Ie.pointers[Tr].clientY)},Tr++;return{timeStamp:P(),pointers:We,center:tr(We),deltaX:Ie.deltaX,deltaY:Ie.deltaY}}function tr(Ie){var We=Ie.length;if(We===1)return{x:st(Ie[0].clientX),y:st(Ie[0].clientY)};for(var Tr=0,un=0,si=0;si<We;)Tr+=Ie[si].clientX,un+=Ie[si].clientY,si++;return{x:st(Tr/We),y:st(un/We)}}function Br(Ie,We,Tr){return{x:We/Ie||0,y:Tr/Ie||0}}function Lr(Ie,We){return Ie===We?At:Ut(Ie)>=Ut(We)?Ie<0?ue:Pe:We<0?je:Nt}function Zr(Ie,We,Tr){Tr||(Tr=J);var un=We[Tr[0]]-Ie[Tr[0]],si=We[Tr[1]]-Ie[Tr[1]];return Math.sqrt(un*un+si*si)}function Tn(Ie,We,Tr){Tr||(Tr=J);var un=We[Tr[0]]-Ie[Tr[0]],si=We[Tr[1]]-Ie[Tr[1]];return Math.atan2(si,un)*180/Math.PI}function rn(Ie,We){return Tn(We[1],We[0],gt)+Tn(Ie[1],Ie[0],gt)}function Nn(Ie,We){return Zr(We[0],We[1],gt)/Zr(Ie[0],Ie[1],gt)}var zn={mousedown:Et,mousemove:$t,mouseup:Yt},jn="mousedown",Sn="mousemove mouseup";function Wn(){this.evEl=jn,this.evWin=Sn,this.pressed=!1,jt.apply(this,arguments)}Dt(Wn,jt,{handler:function(We){var Tr=zn[We.type];Tr&Et&&We.button===0&&(this.pressed=!0),Tr&$t&&We.which!==1&&(Tr=Yt),this.pressed&&(Tr&Yt&&(this.pressed=!1),this.callback(this.manager,Tr,{pointers:[We],changedPointers:[We],pointerType:or,srcEvent:We}))}});var Rt={pointerdown:Et,pointermove:$t,pointerup:Yt,pointercancel:St,pointerout:St},Wt={2:ae,3:Je,4:or,5:re},oe="pointerdown",Se="pointermove pointerup pointercancel";!lt&&bt.MSPointerEvent&&!bt.PointerEvent&&(oe="MSPointerDown",Se="MSPointerMove MSPointerUp MSPointerCancel");function ze(){this.evEl=oe,this.evWin=Se,jt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Dt(ze,jt,{handler:function(We){var Tr=this.store,un=!1,si=We.type.toLowerCase().replace("ms",""),ji=Rt[si],Ma=Wt[We.pointerType]||We.pointerType,ds=Ma==ae,Ho=ct(Tr,We.pointerId,"pointerId");ji&Et&&(We.button===0||ds)?Ho<0&&(Tr.push(We),Ho=Tr.length-1):ji&(Yt|St)&&(un=!0),!(Ho<0)&&(Tr[Ho]=We,this.callback(this.manager,ji,{pointers:Tr,changedPointers:[We],pointerType:Ma,srcEvent:We}),un&&Tr.splice(Ho,1))}});var fr={touchstart:Et,touchmove:$t,touchend:Yt,touchcancel:St},wr="touchstart",Le="touchstart touchmove touchend touchcancel";function ur(){this.evTarget=wr,this.evWin=Le,this.started=!1,jt.apply(this,arguments)}Dt(ur,jt,{handler:function(We){var Tr=fr[We.type];if(Tr===Et&&(this.started=!0),!!this.started){var un=Wr.call(this,We,Tr);Tr&(Yt|St)&&un[0].length-un[1].length===0&&(this.started=!1),this.callback(this.manager,Tr,{pointers:un[0],changedPointers:un[1],pointerType:ae,srcEvent:We})}}});function Wr(Ie,We){var Tr=Ct(Ie.touches),un=Ct(Ie.changedTouches);return We&(Yt|St)&&(Tr=Y(Tr.concat(un),"identifier",!0)),[Tr,un]}var wn={touchstart:Et,touchmove:$t,touchend:Yt,touchcancel:St},qr="touchstart touchmove touchend touchcancel";function Qr(){this.evTarget=qr,this.targetIds={},jt.apply(this,arguments)}Dt(Qr,jt,{handler:function(We){var Tr=wn[We.type],un=Mn.call(this,We,Tr);!un||this.callback(this.manager,Tr,{pointers:un[0],changedPointers:un[1],pointerType:ae,srcEvent:We})}});function Mn(Ie,We){var Tr=Ct(Ie.touches),un=this.targetIds;if(We&(Et|$t)&&Tr.length===1)return un[Tr[0].identifier]=!0,[Tr,Tr];var si,ji,Ma=Ct(Ie.changedTouches),ds=[],Ho=this.target;if(ji=Tr.filter(function(qo){return Ye(qo.target,Ho)}),We===Et)for(si=0;si<ji.length;)un[ji[si].identifier]=!0,si++;for(si=0;si<Ma.length;)un[Ma[si].identifier]&&ds.push(Ma[si]),We&(Yt|St)&&delete un[Ma[si].identifier],si++;if(!!ds.length)return[Y(ji.concat(ds),"identifier",!0),ds]}var bi=2500,wi=25;function Kr(){jt.apply(this,arguments);var Ie=we(this.handler,this);this.touch=new Qr(this.manager,Ie),this.mouse=new Wn(this.manager,Ie),this.primaryTouch=null,this.lastTouches=[]}Dt(Kr,jt,{handler:function(We,Tr,un){var si=un.pointerType==ae,ji=un.pointerType==or;if(!(ji&&un.sourceCapabilities&&un.sourceCapabilities.firesTouchEvents)){if(si)ai.call(this,Tr,un);else if(ji&&hi.call(this,un))return;this.callback(We,Tr,un)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function ai(Ie,We){Ie&Et?(this.primaryTouch=We.changedPointers[0].identifier,li.call(this,We)):Ie&(Yt|St)&&li.call(this,We)}function li(Ie){var We=Ie.changedPointers[0];if(We.identifier===this.primaryTouch){var Tr={x:We.clientX,y:We.clientY};this.lastTouches.push(Tr);var un=this.lastTouches,si=function(){var ji=un.indexOf(Tr);ji>-1&&un.splice(ji,1)};setTimeout(si,bi)}}function hi(Ie){for(var We=Ie.srcEvent.clientX,Tr=Ie.srcEvent.clientY,un=0;un<this.lastTouches.length;un++){var si=this.lastTouches[un],ji=Math.abs(We-si.x),Ma=Math.abs(Tr-si.y);if(ji<=wi&&Ma<=wi)return!0}return!1}var ra=lt?K:yt(be.style,"touchAction"),Ci=ra!==K,Ba="compute",po="auto",za="manipulation",Xa="none",Ta="pan-x",ga="pan-y",no=ja();function Vo(Ie,We){this.manager=Ie,this.set(We)}Vo.prototype={set:function(Ie){Ie==Ba&&(Ie=this.compute()),Ci&&this.manager.element.style&&no[Ie]&&(this.manager.element.style[ra]=Ie),this.actions=Ie.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Ie=[];return fe(this.manager.recognizers,function(We){_e(We.options.enable,[We])&&(Ie=Ie.concat(We.getTouchAction()))}),vo(Ie.join(" "))},preventDefaults:function(Ie){var We=Ie.srcEvent,Tr=Ie.offsetDirection;if(this.manager.session.prevented){We.preventDefault();return}var un=this.actions,si=Lt(un,Xa)&&!no[Xa],ji=Lt(un,ga)&&!no[ga],Ma=Lt(un,Ta)&&!no[Ta];if(si){var ds=Ie.pointers.length===1,Ho=Ie.distance<2,qo=Ie.deltaTime<250;if(ds&&Ho&&qo)return}if(!(Ma&&ji)&&(si||ji&&Tr&wt||Ma&&Tr&Tt))return this.preventSrc(We)},preventSrc:function(Ie){this.manager.session.prevented=!0,Ie.preventDefault()}};function vo(Ie){if(Lt(Ie,Xa))return Xa;var We=Lt(Ie,Ta),Tr=Lt(Ie,ga);return We&&Tr?Xa:We||Tr?We?Ta:ga:Lt(Ie,za)?za:po}function ja(){if(!Ci)return!1;var Ie={};if(lt)return Ie;var We=bt.CSS&&bt.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Tr){Ie[Tr]=We?bt.CSS.supports("touch-action",Tr):!0}),Ie}var to=1,Uo=2,ju=4,Wo=8,bo=Wo,nr=16,ye=32;function Ge(Ie){this.options=Te({},this.defaults,Ie||{}),this.id=ie(),this.manager=null,this.options.enable=ge(this.options.enable,!0),this.state=to,this.simultaneous={},this.requireFail=[]}Ge.prototype={defaults:{},set:function(Ie){return Te(this.options,Ie),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Ie){if(W(Ie,"recognizeWith",this))return this;var We=this.simultaneous;return Ie=In(Ie,this),We[Ie.id]||(We[Ie.id]=Ie,Ie.recognizeWith(this)),this},dropRecognizeWith:function(Ie){return W(Ie,"dropRecognizeWith",this)?this:(Ie=In(Ie,this),delete this.simultaneous[Ie.id],this)},requireFailure:function(Ie){if(W(Ie,"requireFailure",this))return this;var We=this.requireFail;return Ie=In(Ie,this),ct(We,Ie)===-1&&(We.push(Ie),Ie.requireFailure(this)),this},dropRequireFailure:function(Ie){if(W(Ie,"dropRequireFailure",this))return this;Ie=In(Ie,this);var We=ct(this.requireFail,Ie);return We>-1&&this.requireFail.splice(We,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Ie){return!!this.simultaneous[Ie.id]},emit:function(Ie){var We=this,Tr=this.state;function un(si){We.manager.emit(si,Ie)}Tr<Wo&&un(We.options.event+Mr(Tr)),un(We.options.event),Ie.additionalEvent&&un(Ie.additionalEvent),Tr>=Wo&&un(We.options.event+Mr(Tr))},tryEmit:function(Ie){if(this.canEmit())return this.emit(Ie);this.state=ye},canEmit:function(){for(var Ie=0;Ie<this.requireFail.length;){if(!(this.requireFail[Ie].state&(ye|to)))return!1;Ie++}return!0},recognize:function(Ie){var We=Te({},Ie);if(!_e(this.options.enable,[this,We])){this.reset(),this.state=ye;return}this.state&(bo|nr|ye)&&(this.state=to),this.state=this.process(We),this.state&(Uo|ju|Wo|nr)&&this.tryEmit(We)},process:function(Ie){},getTouchAction:function(){},reset:function(){}};function Mr(Ie){return Ie&nr?"cancel":Ie&Wo?"end":Ie&ju?"move":Ie&Uo?"start":""}function tn(Ie){return Ie==Nt?"down":Ie==je?"up":Ie==ue?"left":Ie==Pe?"right":""}function In(Ie,We){var Tr=We.manager;return Tr?Tr.get(Ie):Ie}function Un(){Ge.apply(this,arguments)}Dt(Un,Ge,{defaults:{pointers:1},attrTest:function(Ie){var We=this.options.pointers;return We===0||Ie.pointers.length===We},process:function(Ie){var We=this.state,Tr=Ie.eventType,un=We&(Uo|ju),si=this.attrTest(Ie);return un&&(Tr&St||!si)?We|nr:un||si?Tr&Yt?We|Wo:We&Uo?We|ju:Uo:ye}});function Cn(){Un.apply(this,arguments),this.pX=null,this.pY=null}Dt(Cn,Un,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ft},getTouchAction:function(){var Ie=this.options.direction,We=[];return Ie&wt&&We.push(ga),Ie&Tt&&We.push(Ta),We},directionTest:function(Ie){var We=this.options,Tr=!0,un=Ie.distance,si=Ie.direction,ji=Ie.deltaX,Ma=Ie.deltaY;return si&We.direction||(We.direction&wt?(si=ji===0?At:ji<0?ue:Pe,Tr=ji!=this.pX,un=Math.abs(Ie.deltaX)):(si=Ma===0?At:Ma<0?je:Nt,Tr=Ma!=this.pY,un=Math.abs(Ie.deltaY))),Ie.direction=si,Tr&&un>We.threshold&&si&We.direction},attrTest:function(Ie){return Un.prototype.attrTest.call(this,Ie)&&(this.state&Uo||!(this.state&Uo)&&this.directionTest(Ie))},emit:function(Ie){this.pX=Ie.deltaX,this.pY=Ie.deltaY;var We=tn(Ie.direction);We&&(Ie.additionalEvent=this.options.event+We),this._super.emit.call(this,Ie)}});function ta(){Un.apply(this,arguments)}Dt(ta,Un,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Xa]},attrTest:function(Ie){return this._super.attrTest.call(this,Ie)&&(Math.abs(Ie.scale-1)>this.options.threshold||this.state&Uo)},emit:function(Ie){if(Ie.scale!==1){var We=Ie.scale<1?"in":"out";Ie.additionalEvent=this.options.event+We}this._super.emit.call(this,Ie)}});function Wa(){Ge.apply(this,arguments),this._timer=null,this._input=null}Dt(Wa,Ge,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[po]},process:function(Ie){var We=this.options,Tr=Ie.pointers.length===We.pointers,un=Ie.distance<We.threshold,si=Ie.deltaTime>We.time;if(this._input=Ie,!un||!Tr||Ie.eventType&(Yt|St)&&!si)this.reset();else if(Ie.eventType&Et)this.reset(),this._timer=b(function(){this.state=bo,this.tryEmit()},We.time,this);else if(Ie.eventType&Yt)return bo;return ye},reset:function(){clearTimeout(this._timer)},emit:function(Ie){this.state===bo&&(Ie&&Ie.eventType&Yt?this.manager.emit(this.options.event+"up",Ie):(this._input.timeStamp=P(),this.manager.emit(this.options.event,this._input)))}});function es(){Un.apply(this,arguments)}Dt(es,Un,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Xa]},attrTest:function(Ie){return this._super.attrTest.call(this,Ie)&&(Math.abs(Ie.rotation)>this.options.threshold||this.state&Uo)}});function ko(){Un.apply(this,arguments)}Dt(ko,Un,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:wt|Tt,pointers:1},getTouchAction:function(){return Cn.prototype.getTouchAction.call(this)},attrTest:function(Ie){var We=this.options.direction,Tr;return We&(wt|Tt)?Tr=Ie.overallVelocity:We&wt?Tr=Ie.overallVelocityX:We&Tt&&(Tr=Ie.overallVelocityY),this._super.attrTest.call(this,Ie)&&We&Ie.offsetDirection&&Ie.distance>this.options.threshold&&Ie.maxPointers==this.options.pointers&&Ut(Tr)>this.options.velocity&&Ie.eventType&Yt},emit:function(Ie){var We=tn(Ie.offsetDirection);We&&this.manager.emit(this.options.event+We,Ie),this.manager.emit(this.options.event,Ie)}});function ns(){Ge.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Dt(ns,Ge,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[za]},process:function(Ie){var We=this.options,Tr=Ie.pointers.length===We.pointers,un=Ie.distance<We.threshold,si=Ie.deltaTime<We.time;if(this.reset(),Ie.eventType&Et&&this.count===0)return this.failTimeout();if(un&&si&&Tr){if(Ie.eventType!=Yt)return this.failTimeout();var ji=this.pTime?Ie.timeStamp-this.pTime<We.interval:!0,Ma=!this.pCenter||Zr(this.pCenter,Ie.center)<We.posThreshold;this.pTime=Ie.timeStamp,this.pCenter=Ie.center,!Ma||!ji?this.count=1:this.count+=1,this._input=Ie;var ds=this.count%We.taps;if(ds===0)return this.hasRequireFailures()?(this._timer=b(function(){this.state=bo,this.tryEmit()},We.interval,this),Uo):bo}return ye},failTimeout:function(){return this._timer=b(function(){this.state=ye},this.options.interval,this),ye},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==bo&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Ya(Ie,We){return We=We||{},We.recognizers=ge(We.recognizers,Ya.defaults.preset),new ys(Ie,We)}Ya.VERSION="2.0.7",Ya.defaults={domEvents:!1,touchAction:Ba,enable:!0,inputTarget:null,inputClass:null,preset:[[es,{enable:!1}],[ta,{enable:!1},["rotate"]],[ko,{direction:wt}],[Cn,{direction:wt},["swipe"]],[ns],[ns,{event:"doubletap",taps:2},["tap"]],[Wa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Go=1,pu=2;function ys(Ie,We){this.options=Te({},Ya.defaults,We||{}),this.options.inputTarget=this.options.inputTarget||Ie,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ie,this.input=ve(this),this.touchAction=new Vo(this,this.options.touchAction),Rl(this,!0),fe(this.options.recognizers,function(Tr){var un=this.add(new Tr[0](Tr[1]));Tr[2]&&un.recognizeWith(Tr[2]),Tr[3]&&un.requireFailure(Tr[3])},this)}ys.prototype={set:function(Ie){return Te(this.options,Ie),Ie.touchAction&&this.touchAction.update(),Ie.inputTarget&&(this.input.destroy(),this.input.target=Ie.inputTarget,this.input.init()),this},stop:function(Ie){this.session.stopped=Ie?pu:Go},recognize:function(Ie){var We=this.session;if(!We.stopped){this.touchAction.preventDefaults(Ie);var Tr,un=this.recognizers,si=We.curRecognizer;(!si||si&&si.state&bo)&&(si=We.curRecognizer=null);for(var ji=0;ji<un.length;)Tr=un[ji],We.stopped!==pu&&(!si||Tr==si||Tr.canRecognizeWith(si))?Tr.recognize(Ie):Tr.reset(),!si&&Tr.state&(Uo|ju|Wo)&&(si=We.curRecognizer=Tr),ji++}},get:function(Ie){if(Ie instanceof Ge)return Ie;for(var We=this.recognizers,Tr=0;Tr<We.length;Tr++)if(We[Tr].options.event==Ie)return We[Tr];return null},add:function(Ie){if(W(Ie,"add",this))return this;var We=this.get(Ie.options.event);return We&&this.remove(We),this.recognizers.push(Ie),Ie.manager=this,this.touchAction.update(),Ie},remove:function(Ie){if(W(Ie,"remove",this))return this;if(Ie=this.get(Ie),Ie){var We=this.recognizers,Tr=ct(We,Ie);Tr!==-1&&(We.splice(Tr,1),this.touchAction.update())}return this},on:function(Ie,We){if(Ie!==K&&We!==K){var Tr=this.handlers;return fe(Qt(Ie),function(un){Tr[un]=Tr[un]||[],Tr[un].push(We)}),this}},off:function(Ie,We){if(Ie!==K){var Tr=this.handlers;return fe(Qt(Ie),function(un){We?Tr[un]&&Tr[un].splice(ct(Tr[un],We),1):delete Tr[un]}),this}},emit:function(Ie,We){this.options.domEvents&&mf(Ie,We);var Tr=this.handlers[Ie]&&this.handlers[Ie].slice();if(!(!Tr||!Tr.length)){We.type=Ie,We.preventDefault=function(){We.srcEvent.preventDefault()};for(var un=0;un<Tr.length;)Tr[un](We),un++}},destroy:function(){this.element&&Rl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Rl(Ie,We){var Tr=Ie.element;if(!!Tr.style){var un;fe(Ie.options.cssProps,function(si,ji){un=yt(Tr.style,ji),We?(Ie.oldCssProps[un]=Tr.style[un],Tr.style[un]=si):Tr.style[un]=Ie.oldCssProps[un]||""}),We||(Ie.oldCssProps={})}}function mf(Ie,We){if(!lt){var Tr=I.createEvent("Event");Tr.initEvent(Ie,!0,!0),Tr.gesture=We,We.target.dispatchEvent(Tr)}}if(!lt){Te(Ya,{INPUT_START:Et,INPUT_MOVE:$t,INPUT_END:Yt,INPUT_CANCEL:St,STATE_POSSIBLE:to,STATE_BEGAN:Uo,STATE_CHANGED:ju,STATE_ENDED:Wo,STATE_RECOGNIZED:bo,STATE_CANCELLED:nr,STATE_FAILED:ye,DIRECTION_NONE:At,DIRECTION_LEFT:ue,DIRECTION_RIGHT:Pe,DIRECTION_UP:je,DIRECTION_DOWN:Nt,DIRECTION_HORIZONTAL:wt,DIRECTION_VERTICAL:Tt,DIRECTION_ALL:Ft,Manager:ys,Input:jt,TouchAction:Vo,TouchInput:Qr,MouseInput:Wn,PointerEventInput:ze,TouchMouseInput:Kr,SingleTouchInput:ur,Recognizer:Ge,AttrRecognizer:Un,Tap:ns,Pan:Cn,Swipe:ko,Pinch:ta,Rotate:es,Press:Wa,on:te,off:xe,each:fe,merge:et,extend:Mt,assign:Te,inherit:Dt,bindFn:we,prefixed:yt});var Wu=typeof window!="undefined"?window:typeof self!="undefined"?self:{};Wu.Hammer=Ya,kt=function(){return Ya}.call(Ot,ot,Ot,gn),kt!==K&&(gn.exports=kt)}})(typeof window!="undefined"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")},88307:function(gn,Ot,ot){(function(kt,bt){gn.exports=bt(ot(12380))})(this,function(kt){"use strict";var bt=function(It){return It instanceof Uint8Array||It instanceof Uint16Array||It instanceof Uint32Array||It instanceof Int8Array||It instanceof Int16Array||It instanceof Int32Array||It instanceof Float32Array||It instanceof Float64Array||It instanceof Uint8ClampedArray},I=function(It,Ue){for(var dr=Object.keys(Ue),cn=0;cn<dr.length;++cn)It[dr[cn]]=Ue[dr[cn]];return It},xt=`
`;function K(It){return typeof atob!="undefined"?atob(It):"base64:"+It}function ut(It){var Ue=new Error("(regl) "+It);throw console.error(Ue),Ue}function ht(It,Ue){It||ut(Ue)}function lt(It){return It?": "+It:""}function tt(It,Ue,dr){It in Ue||ut("unknown parameter ("+It+")"+lt(dr)+". possible values: "+Object.keys(Ue).join())}function be(It,Ue){bt(It)||ut("invalid parameter type"+lt(Ue)+". must be a typed array")}function it(It,Ue){switch(Ue){case"number":return typeof It=="number";case"object":return typeof It=="object";case"string":return typeof It=="string";case"boolean":return typeof It=="boolean";case"function":return typeof It=="function";case"undefined":return typeof It=="undefined";case"symbol":return typeof It=="symbol"}}function st(It,Ue,dr){it(It,Ue)||ut("invalid parameter type"+lt(dr)+". expected "+Ue+", got "+typeof It)}function Ut(It,Ue){It>=0&&(It|0)===It||ut("invalid parameter type, ("+It+")"+lt(Ue)+". must be a nonnegative integer")}function P(It,Ue,dr){Ue.indexOf(It)<0&&ut("invalid value"+lt(dr)+". must be one of: "+Ue)}var b=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function W(It){Object.keys(It).forEach(function(Ue){b.indexOf(Ue)<0&&ut('invalid regl constructor argument "'+Ue+'". must be one of '+b)})}function fe(It,Ue){for(It=It+"";It.length<Ue;)It=" "+It;return It}function Ee(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Te(It,Ue){this.number=It,this.line=Ue,this.errors=[]}function Mt(It,Ue,dr){this.file=It,this.line=Ue,this.message=dr}function et(){var It=new Error,Ue=(It.stack||It).toString(),dr=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Ue);if(dr)return dr[1];var cn=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Ue);return cn?cn[1]:"unknown"}function Dt(){var It=new Error,Ue=(It.stack||It).toString(),dr=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Ue);if(dr)return dr[1];var cn=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Ue);return cn?cn[1]:"unknown"}function we(It,Ue){var dr=It.split(`
`),cn=1,On=0,on={unknown:new Ee,0:new Ee};on.unknown.name=on[0].name=Ue||et(),on.unknown.lines.push(new Te(0,""));for(var En=0;En<dr.length;++En){var Dn=dr[En],Hn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Dn);if(Hn)switch(Hn[1]){case"line":var Jn=/(\d+)(\s+\d+)?/.exec(Hn[2]);Jn&&(cn=Jn[1]|0,Jn[2]&&(On=Jn[2]|0,On in on||(on[On]=new Ee)));break;case"define":var ii=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Hn[2]);ii&&(on[On].name=ii[1]?K(ii[2]):ii[2]);break}on[On].lines.push(new Te(cn++,Dn))}return Object.keys(on).forEach(function(ui){var yi=on[ui];yi.lines.forEach(function(qn){yi.index[qn.number]=qn})}),on}function _e(It){var Ue=[];return It.split(`
`).forEach(function(dr){if(!(dr.length<5)){var cn=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(dr);cn?Ue.push(new Mt(cn[1]|0,cn[2]|0,cn[3].trim())):dr.length>0&&Ue.push(new Mt("unknown",0,dr))}}),Ue}function ge(It,Ue){Ue.forEach(function(dr){var cn=It[dr.file];if(cn){var On=cn.index[dr.line];if(On){On.errors.push(dr),cn.hasErrors=!0;return}}It.unknown.hasErrors=!0,It.unknown.lines[0].errors.push(dr)})}function te(It,Ue,dr,cn,On){if(!It.getShaderParameter(Ue,It.COMPILE_STATUS)){var on=It.getShaderInfoLog(Ue),En=cn===It.FRAGMENT_SHADER?"fragment":"vertex";Y(dr,"string",En+" shader source must be a string",On);var Dn=we(dr,On),Hn=_e(on);ge(Dn,Hn),Object.keys(Dn).forEach(function(Jn){var ii=Dn[Jn];if(!ii.hasErrors)return;var ui=[""],yi=[""];function qn(ri,Gr){ui.push(ri),yi.push(Gr||"")}qn("file number "+Jn+": "+ii.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ii.lines.forEach(function(ri){if(ri.errors.length>0){qn(fe(ri.number,4)+"|  ","background-color:yellow; font-weight:bold"),qn(ri.line+xt,"color:red; background-color:yellow; font-weight:bold");var Gr=0;ri.errors.forEach(function(dn){var Xn=dn.message,vi=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Xn);if(vi){var Rn=vi[1];switch(Xn=vi[2],Rn){case"assign":Rn="=";break}Gr=Math.max(ri.line.indexOf(Rn,Gr),0)}else Gr=0;qn(fe("| ",6)),qn(fe("^^^",Gr+3)+xt,"font-weight:bold"),qn(fe("| ",6)),qn(Xn+xt,"font-weight:bold")}),qn(fe("| ",6)+xt)}else qn(fe(ri.number,4)+"|  "),qn(ri.line+xt,"color:red")}),typeof document!="undefined"&&!window.chrome?(yi[0]=ui.join("%c"),console.log.apply(console,yi)):console.log(ui.join(""))}),ht.raise("Error compiling "+En+" shader, "+Dn[0].name)}}function xe(It,Ue,dr,cn,On){if(!It.getProgramParameter(Ue,It.LINK_STATUS)){var on=It.getProgramInfoLog(Ue),En=we(dr,On),Dn=we(cn,On),Hn='Error linking program with vertex shader, "'+Dn[0].name+'", and fragment shader "'+En[0].name+'"';typeof document!="undefined"?console.log("%c"+Hn+xt+"%c"+on,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Hn+xt+on),ht.raise(Hn)}}function Ye(It){It._commandRef=et()}function Lt(It,Ue,dr,cn){Ye(It);function On(Hn){return Hn?cn.id(Hn):0}It._fragId=On(It.static.frag),It._vertId=On(It.static.vert);function on(Hn,Jn){Object.keys(Jn).forEach(function(ii){Hn[cn.id(ii)]=!0})}var En=It._uniformSet={};on(En,Ue.static),on(En,Ue.dynamic);var Dn=It._attributeSet={};on(Dn,dr.static),on(Dn,dr.dynamic),It._hasCount="count"in It.static||"count"in It.dynamic||"elements"in It.static||"elements"in It.dynamic}function Qt(It,Ue){var dr=Dt();ut(It+" in command "+(Ue||et())+(dr==="unknown"?"":" called from "+dr))}function ct(It,Ue,dr){It||Qt(Ue,dr||et())}function Ct(It,Ue,dr,cn){It in Ue||Qt("unknown parameter ("+It+")"+lt(dr)+". possible values: "+Object.keys(Ue).join(),cn||et())}function Y(It,Ue,dr,cn){it(It,Ue)||Qt("invalid parameter type"+lt(dr)+". expected "+Ue+", got "+typeof It,cn||et())}function yt(It){It()}function Xt(It,Ue,dr){It.texture?P(It.texture._texture.internalformat,Ue,"unsupported texture format for attachment"):P(It.renderbuffer._renderbuffer.format,dr,"unsupported renderbuffer format for attachment")}var ie=33071,Ce=9728,er=9984,Ht=9985,ne=9986,Me=9987,ae=5120,Je=5121,or=5122,re=5123,Jt=5124,Et=5125,$t=5126,Yt=32819,St=32820,At=33635,ue=34042,Pe=36193,je={};je[ae]=je[Je]=1,je[or]=je[re]=je[Pe]=je[At]=je[Yt]=je[St]=2,je[Jt]=je[Et]=je[$t]=je[ue]=4;function Nt(It,Ue){return It===St||It===Yt||It===At?2:It===ue?4:je[It]*Ue}function wt(It){return!(It&It-1)&&!!It}function Tt(It,Ue,dr){var cn,On=Ue.width,on=Ue.height,En=Ue.channels;ht(On>0&&On<=dr.maxTextureSize&&on>0&&on<=dr.maxTextureSize,"invalid texture shape"),(It.wrapS!==ie||It.wrapT!==ie)&&ht(wt(On)&&wt(on),"incompatible wrap mode for texture, both width and height must be power of 2"),Ue.mipmask===1?On!==1&&on!==1&&ht(It.minFilter!==er&&It.minFilter!==ne&&It.minFilter!==Ht&&It.minFilter!==Me,"min filter requires mipmap"):(ht(wt(On)&&wt(on),"texture must be a square power of 2 to support mipmapping"),ht(Ue.mipmask===(On<<1)-1,"missing or incomplete mipmap data")),Ue.type===$t&&(dr.extensions.indexOf("oes_texture_float_linear")<0&&ht(It.minFilter===Ce&&It.magFilter===Ce,"filter not supported, must enable oes_texture_float_linear"),ht(!It.genMipmaps,"mipmap generation not supported with float textures"));var Dn=Ue.images;for(cn=0;cn<16;++cn)if(Dn[cn]){var Hn=On>>cn,Jn=on>>cn;ht(Ue.mipmask&1<<cn,"missing mipmap data");var ii=Dn[cn];if(ht(ii.width===Hn&&ii.height===Jn,"invalid shape for mip images"),ht(ii.format===Ue.format&&ii.internalformat===Ue.internalformat&&ii.type===Ue.type,"incompatible type for mip image"),!ii.compressed)if(ii.data){var ui=Math.ceil(Nt(ii.type,En)*Hn/ii.unpackAlignment)*ii.unpackAlignment;ht(ii.data.byteLength===ui*Jn,"invalid data for image, buffer size is inconsistent with image format")}else ii.element||ii.copy}else It.genMipmaps||ht((Ue.mipmask&1<<cn)===0,"extra mipmap data");Ue.compressed&&ht(!It.genMipmaps,"mipmap generation for compressed images not supported")}function Ft(It,Ue,dr,cn){var On=It.width,on=It.height,En=It.channels;ht(On>0&&On<=cn.maxTextureSize&&on>0&&on<=cn.maxTextureSize,"invalid texture shape"),ht(On===on,"cube map must be square"),ht(Ue.wrapS===ie&&Ue.wrapT===ie,"wrap mode not supported by cube map");for(var Dn=0;Dn<dr.length;++Dn){var Hn=dr[Dn];ht(Hn.width===On&&Hn.height===on,"inconsistent cube map face shape"),Ue.genMipmaps&&(ht(!Hn.compressed,"can not generate mipmap for compressed textures"),ht(Hn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Jn=Hn.images,ii=0;ii<16;++ii){var ui=Jn[ii];if(ui){var yi=On>>ii,qn=on>>ii;ht(Hn.mipmask&1<<ii,"missing mipmap data"),ht(ui.width===yi&&ui.height===qn,"invalid shape for mip images"),ht(ui.format===It.format&&ui.internalformat===It.internalformat&&ui.type===It.type,"incompatible type for mip image"),ui.compressed||(ui.data?ht(ui.data.byteLength===yi*qn*Math.max(Nt(ui.type,En),ui.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):ui.element||ui.copy)}}}}var J=I(ht,{optional:yt,raise:ut,commandRaise:Qt,command:ct,parameter:tt,commandParameter:Ct,constructor:W,type:st,commandType:Y,isTypedArray:be,nni:Ut,oneOf:P,shaderError:te,linkError:xe,callSite:Dt,saveCommandRef:Ye,saveDrawInfo:Lt,framebufferFormat:Xt,guessCommand:et,texture2D:Tt,textureCube:Ft}),gt=0,jt=0,ve=5,Gt=6;function Ae(It,Ue){this.id=gt++,this.type=It,this.data=Ue}function He(It){return It.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function qe(It){if(It.length===0)return[];var Ue=It.charAt(0),dr=It.charAt(It.length-1);if(It.length>1&&Ue===dr&&(Ue==='"'||Ue==="'"))return['"'+He(It.substr(1,It.length-2))+'"'];var cn=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(It);if(cn)return qe(It.substr(0,cn.index)).concat(qe(cn[1])).concat(qe(It.substr(cn.index+cn[0].length)));var On=It.split(".");if(On.length===1)return['"'+He(It)+'"'];for(var on=[],En=0;En<On.length;++En)on=on.concat(qe(On[En]));return on}function hr(It){return"["+qe(It).join("][")+"]"}function tr(It,Ue){return new Ae(It,hr(Ue+""))}function Br(It){return typeof It=="function"&&!It._reglType||It instanceof Ae}function Lr(It,Ue){if(typeof It=="function")return new Ae(jt,It);if(typeof It=="number"||typeof It=="boolean")return new Ae(ve,It);if(Array.isArray(It))return new Ae(Gt,It.map(function(dr,cn){return Lr(dr,Ue+"["+cn+"]")}));if(It instanceof Ae)return It;J(!1,"invalid option type in uniform "+Ue)}var Zr={DynamicVariable:Ae,define:tr,isDynamic:Br,unbox:Lr,accessor:hr},Tn={next:typeof requestAnimationFrame=="function"?function(It){return requestAnimationFrame(It)}:function(It){return setTimeout(It,16)},cancel:typeof cancelAnimationFrame=="function"?function(It){return cancelAnimationFrame(It)}:clearTimeout},rn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Nn=rn?function(){return+new Date}:typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function zn(){var It={"":0},Ue=[""];return{id:function(dr){var cn=It[dr];return cn||(cn=It[dr]=Ue.length,Ue.push(dr),cn)},str:function(dr){return Ue[dr]}}}function jn(It,Ue,dr){var cn=document.createElement("canvas");I(cn.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),It.appendChild(cn),It===document.body&&(cn.style.position="absolute",I(It.style,{margin:0,padding:0}));function On(){var Dn=window.innerWidth,Hn=window.innerHeight;if(It!==document.body){var Jn=cn.getBoundingClientRect();Dn=Jn.right-Jn.left,Hn=Jn.bottom-Jn.top}cn.width=dr*Dn,cn.height=dr*Hn}var on;It!==document.body&&typeof ResizeObserver=="function"?(on=new ResizeObserver(function(){setTimeout(On)}),on.observe(It)):window.addEventListener("resize",On,!1);function En(){on?on.disconnect():window.removeEventListener("resize",On),It.removeChild(cn)}return On(),{canvas:cn,onDestroy:En}}function Sn(It,Ue){function dr(cn){try{return It.getContext(cn,Ue)}catch(On){return null}}return dr("webgl")||dr("experimental-webgl")||dr("webgl-experimental")}function Wn(It){return typeof It.nodeName=="string"&&typeof It.appendChild=="function"&&typeof It.getBoundingClientRect=="function"}function Rt(It){return typeof It.drawArrays=="function"||typeof It.drawElements=="function"}function Wt(It){return typeof It=="string"?It.split():(J(Array.isArray(It),"invalid extension array"),It)}function oe(It){return typeof It=="string"?(J(typeof document!="undefined","not supported outside of DOM"),document.querySelector(It)):It}function Se(It){var Ue=It||{},dr,cn,On,on,En={},Dn=[],Hn=[],Jn=typeof window=="undefined"?1:window.devicePixelRatio,ii=!1,ui=function(ri){ri&&J.raise(ri)},yi=function(){};if(typeof Ue=="string"?(J(typeof document!="undefined","selector queries only supported in DOM environments"),dr=document.querySelector(Ue),J(dr,"invalid query string for element")):typeof Ue=="object"?Wn(Ue)?dr=Ue:Rt(Ue)?(on=Ue,On=on.canvas):(J.constructor(Ue),"gl"in Ue?on=Ue.gl:"canvas"in Ue?On=oe(Ue.canvas):"container"in Ue&&(cn=oe(Ue.container)),"attributes"in Ue&&(En=Ue.attributes,J.type(En,"object","invalid context attributes")),"extensions"in Ue&&(Dn=Wt(Ue.extensions)),"optionalExtensions"in Ue&&(Hn=Wt(Ue.optionalExtensions)),"onDone"in Ue&&(J.type(Ue.onDone,"function","invalid or missing onDone callback"),ui=Ue.onDone),"profile"in Ue&&(ii=!!Ue.profile),"pixelRatio"in Ue&&(Jn=+Ue.pixelRatio,J(Jn>0,"invalid pixel ratio"))):J.raise("invalid arguments to regl"),dr&&(dr.nodeName.toLowerCase()==="canvas"?On=dr:cn=dr),!on){if(!On){J(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var qn=jn(cn||document.body,ui,Jn);if(!qn)return null;On=qn.canvas,yi=qn.onDestroy}En.premultipliedAlpha===void 0&&(En.premultipliedAlpha=!0),on=Sn(On,En)}return on?{gl:on,canvas:On,container:cn,extensions:Dn,optionalExtensions:Hn,pixelRatio:Jn,profile:ii,onDone:ui,onDestroy:yi}:(yi(),ui("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ze(It,Ue){var dr={};function cn(Dn){J.type(Dn,"string","extension name must be string");var Hn=Dn.toLowerCase(),Jn;try{Jn=dr[Hn]=On(Dn)}catch(ii){}return!!Jn}function On(Dn){return It.getExtension(Dn)?It.getExtension(Dn):It.getExtension(Dn.toLowerCase())?It.getExtension(Dn.toLowerCase()):null}for(var on=0;on<Ue.extensions.length;++on){var En=Ue.extensions[on];if(!cn(En))return Ue.onDestroy(),Ue.onDone('"'+En+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Ue.optionalExtensions.forEach(cn),{extensions:dr,restore:function(){Object.keys(dr).forEach(function(Dn){if(dr[Dn]&&!cn(Dn))throw new Error("(regl): error restoring extension "+Dn)})}}}function fr(It,Ue){for(var dr=Array(It),cn=0;cn<It;++cn)dr[cn]=Ue(cn);return dr}var wr=5120,Le=5121,ur=5122,Wr=5123,wn=5124,qr=5125,Qr=5126;function Mn(It){for(var Ue=16;Ue<=1<<28;Ue*=16)if(It<=Ue)return Ue;return 0}function bi(It){var Ue,dr;return Ue=(It>65535)<<4,It>>>=Ue,dr=(It>255)<<3,It>>>=dr,Ue|=dr,dr=(It>15)<<2,It>>>=dr,Ue|=dr,dr=(It>3)<<1,It>>>=dr,Ue|=dr,Ue|It>>1}function wi(){var It=fr(8,function(){return[]});function Ue(on){var En=Mn(on),Dn=It[bi(En)>>2];return Dn.length>0?Dn.pop():new ArrayBuffer(En)}function dr(on){It[bi(on.byteLength)>>2].push(on)}function cn(on,En){var Dn=null;switch(on){case wr:Dn=new Int8Array(Ue(En),0,En);break;case Le:Dn=new Uint8Array(Ue(En),0,En);break;case ur:Dn=new Int16Array(Ue(2*En),0,En);break;case Wr:Dn=new Uint16Array(Ue(2*En),0,En);break;case wn:Dn=new Int32Array(Ue(4*En),0,En);break;case qr:Dn=new Uint32Array(Ue(4*En),0,En);break;case Qr:Dn=new Float32Array(Ue(4*En),0,En);break;default:return null}return Dn.length!==En?Dn.subarray(0,En):Dn}function On(on){dr(on.buffer)}return{alloc:Ue,free:dr,allocType:cn,freeType:On}}var Kr=wi();Kr.zero=wi();var ai=3408,li=3410,hi=3411,ra=3412,Ci=3413,Ba=3414,po=3415,za=33901,Xa=33902,Ta=3379,ga=3386,no=34921,Vo=36347,vo=36348,ja=35661,to=35660,Uo=34930,ju=36349,Wo=34076,bo=34024,nr=7936,ye=7937,Ge=7938,Mr=35724,tn=34047,In=36063,Un=34852,Cn=3553,ta=34067,Wa=34069,es=33984,ko=6408,ns=5126,Ya=5121,Go=36160,pu=36053,ys=36064,Rl=16384,mf=function(It,Ue){var dr=1;Ue.ext_texture_filter_anisotropic&&(dr=It.getParameter(tn));var cn=1,On=1;Ue.webgl_draw_buffers&&(cn=It.getParameter(Un),On=It.getParameter(In));var on=!!Ue.oes_texture_float;if(on){var En=It.createTexture();It.bindTexture(Cn,En),It.texImage2D(Cn,0,ko,1,1,0,ko,ns,null);var Dn=It.createFramebuffer();if(It.bindFramebuffer(Go,Dn),It.framebufferTexture2D(Go,ys,Cn,En,0),It.bindTexture(Cn,null),It.checkFramebufferStatus(Go)!==pu)on=!1;else{It.viewport(0,0,1,1),It.clearColor(1,0,0,1),It.clear(Rl);var Hn=Kr.allocType(ns,4);It.readPixels(0,0,1,1,ko,ns,Hn),It.getError()?on=!1:(It.deleteFramebuffer(Dn),It.deleteTexture(En),on=Hn[0]===1),Kr.freeType(Hn)}}var Jn=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ii=!0;if(!Jn){var ui=It.createTexture(),yi=Kr.allocType(Ya,36);It.activeTexture(es),It.bindTexture(ta,ui),It.texImage2D(Wa,0,ko,3,3,0,ko,Ya,yi),Kr.freeType(yi),It.bindTexture(ta,null),It.deleteTexture(ui),ii=!It.getError()}return{colorBits:[It.getParameter(li),It.getParameter(hi),It.getParameter(ra),It.getParameter(Ci)],depthBits:It.getParameter(Ba),stencilBits:It.getParameter(po),subpixelBits:It.getParameter(ai),extensions:Object.keys(Ue).filter(function(qn){return!!Ue[qn]}),maxAnisotropic:dr,maxDrawbuffers:cn,maxColorAttachments:On,pointSizeDims:It.getParameter(za),lineWidthDims:It.getParameter(Xa),maxViewportDims:It.getParameter(ga),maxCombinedTextureUnits:It.getParameter(ja),maxCubeMapSize:It.getParameter(Wo),maxRenderbufferSize:It.getParameter(bo),maxTextureUnits:It.getParameter(Uo),maxTextureSize:It.getParameter(Ta),maxAttributes:It.getParameter(no),maxVertexUniforms:It.getParameter(Vo),maxVertexTextureUnits:It.getParameter(to),maxVaryingVectors:It.getParameter(vo),maxFragmentUniforms:It.getParameter(ju),glsl:It.getParameter(Mr),renderer:It.getParameter(ye),vendor:It.getParameter(nr),version:It.getParameter(Ge),readFloat:on,npotTextureCube:ii}};function Wu(It){return!!It&&typeof It=="object"&&Array.isArray(It.shape)&&Array.isArray(It.stride)&&typeof It.offset=="number"&&It.shape.length===It.stride.length&&(Array.isArray(It.data)||bt(It.data))}var Ie=function(It){return Object.keys(It).map(function(Ue){return It[Ue]})},We={shape:ds,flatten:Ma};function Tr(It,Ue,dr){for(var cn=0;cn<Ue;++cn)dr[cn]=It[cn]}function un(It,Ue,dr,cn){for(var On=0,on=0;on<Ue;++on)for(var En=It[on],Dn=0;Dn<dr;++Dn)cn[On++]=En[Dn]}function si(It,Ue,dr,cn,On,on){for(var En=on,Dn=0;Dn<Ue;++Dn)for(var Hn=It[Dn],Jn=0;Jn<dr;++Jn)for(var ii=Hn[Jn],ui=0;ui<cn;++ui)On[En++]=ii[ui]}function ji(It,Ue,dr,cn,On){for(var on=1,En=dr+1;En<Ue.length;++En)on*=Ue[En];var Dn=Ue[dr];if(Ue.length-dr===4){var Hn=Ue[dr+1],Jn=Ue[dr+2],ii=Ue[dr+3];for(En=0;En<Dn;++En)si(It[En],Hn,Jn,ii,cn,On),On+=on}else for(En=0;En<Dn;++En)ji(It[En],Ue,dr+1,cn,On),On+=on}function Ma(It,Ue,dr,cn){var On=1;if(Ue.length)for(var on=0;on<Ue.length;++on)On*=Ue[on];else On=0;var En=cn||Kr.allocType(dr,On);switch(Ue.length){case 0:break;case 1:Tr(It,Ue[0],En);break;case 2:un(It,Ue[0],Ue[1],En);break;case 3:si(It,Ue[0],Ue[1],Ue[2],En,0);break;default:ji(It,Ue,0,En,0)}return En}function ds(It){for(var Ue=[],dr=It;dr.length;dr=dr[0])Ue.push(dr.length);return Ue}var Ho={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},qo=5120,Hs=5122,Xu=5124,_s=5121,vs=5123,Ou=5125,rl=5126,nu=5126,dl={int8:qo,int16:Hs,int32:Xu,uint8:_s,uint16:vs,uint32:Ou,float:rl,float32:nu},Fu=35048,Fo=35040,rs={dynamic:Fu,stream:Fo,static:35044},Uc=We.flatten,_u=We.shape,Zc=35044,Co=35040,sc=5121,Xl=5126,nl=[];nl[5120]=1,nl[5122]=2,nl[5124]=4,nl[5121]=1,nl[5123]=2,nl[5125]=4,nl[5126]=4;function uc(It){return Ho[Object.prototype.toString.call(It)]|0}function D(It,Ue){for(var dr=0;dr<Ue.length;++dr)It[dr]=Ue[dr]}function X(It,Ue,dr,cn,On,on,En){for(var Dn=0,Hn=0;Hn<dr;++Hn)for(var Jn=0;Jn<cn;++Jn)It[Dn++]=Ue[On*Hn+on*Jn+En]}function _t(It,Ue,dr,cn){var On=0,on={};function En(Gr){this.id=On++,this.buffer=It.createBuffer(),this.type=Gr,this.usage=Zc,this.byteLength=0,this.dimension=1,this.dtype=sc,this.persistentData=null,dr.profile&&(this.stats={size:0})}En.prototype.bind=function(){It.bindBuffer(this.type,this.buffer)},En.prototype.destroy=function(){yi(this)};var Dn=[];function Hn(Gr,dn){var Xn=Dn.pop();return Xn||(Xn=new En(Gr)),Xn.bind(),ui(Xn,dn,Co,0,1,!1),Xn}function Jn(Gr){Dn.push(Gr)}function ii(Gr,dn,Xn){Gr.byteLength=dn.byteLength,It.bufferData(Gr.type,dn,Xn)}function ui(Gr,dn,Xn,vi,Rn,Qn){var Ti;if(Gr.usage=Xn,Array.isArray(dn)){if(Gr.dtype=vi||Xl,dn.length>0){var aa;if(Array.isArray(dn[0])){Ti=_u(dn);for(var _n=1,An=1;An<Ti.length;++An)_n*=Ti[An];Gr.dimension=_n,aa=Uc(dn,Ti,Gr.dtype),ii(Gr,aa,Xn),Qn?Gr.persistentData=aa:Kr.freeType(aa)}else if(typeof dn[0]=="number"){Gr.dimension=Rn;var oi=Kr.allocType(Gr.dtype,dn.length);D(oi,dn),ii(Gr,oi,Xn),Qn?Gr.persistentData=oi:Kr.freeType(oi)}else bt(dn[0])?(Gr.dimension=dn[0].length,Gr.dtype=vi||uc(dn[0])||Xl,aa=Uc(dn,[dn.length,dn[0].length],Gr.dtype),ii(Gr,aa,Xn),Qn?Gr.persistentData=aa:Kr.freeType(aa)):J.raise("invalid buffer data")}}else if(bt(dn))Gr.dtype=vi||uc(dn),Gr.dimension=Rn,ii(Gr,dn,Xn),Qn&&(Gr.persistentData=new Uint8Array(new Uint8Array(dn.buffer)));else if(Wu(dn)){Ti=dn.shape;var Ei=dn.stride,ti=dn.offset,xi=0,Mi=0,Ua=0,Yn=0;Ti.length===1?(xi=Ti[0],Mi=1,Ua=Ei[0],Yn=0):Ti.length===2?(xi=Ti[0],Mi=Ti[1],Ua=Ei[0],Yn=Ei[1]):J.raise("invalid shape"),Gr.dtype=vi||uc(dn.data)||Xl,Gr.dimension=Mi;var Ii=Kr.allocType(Gr.dtype,xi*Mi);X(Ii,dn.data,xi,Mi,Ua,Yn,ti),ii(Gr,Ii,Xn),Qn?Gr.persistentData=Ii:Kr.freeType(Ii)}else dn instanceof ArrayBuffer?(Gr.dtype=sc,Gr.dimension=Rn,ii(Gr,dn,Xn),Qn&&(Gr.persistentData=new Uint8Array(new Uint8Array(dn)))):J.raise("invalid buffer data")}function yi(Gr){Ue.bufferCount--,cn(Gr);var dn=Gr.buffer;J(dn,"buffer must not be deleted already"),It.deleteBuffer(dn),Gr.buffer=null,delete on[Gr.id]}function qn(Gr,dn,Xn,vi){Ue.bufferCount++;var Rn=new En(dn);on[Rn.id]=Rn;function Qn(_n){var An=Zc,oi=null,Ei=0,ti=0,xi=1;return Array.isArray(_n)||bt(_n)||Wu(_n)||_n instanceof ArrayBuffer?oi=_n:typeof _n=="number"?Ei=_n|0:_n&&(J.type(_n,"object","buffer arguments must be an object, a number or an array"),"data"in _n&&(J(oi===null||Array.isArray(oi)||bt(oi)||Wu(oi),"invalid data for buffer"),oi=_n.data),"usage"in _n&&(J.parameter(_n.usage,rs,"invalid buffer usage"),An=rs[_n.usage]),"type"in _n&&(J.parameter(_n.type,dl,"invalid buffer type"),ti=dl[_n.type]),"dimension"in _n&&(J.type(_n.dimension,"number","invalid dimension"),xi=_n.dimension|0),"length"in _n&&(J.nni(Ei,"buffer length must be a nonnegative integer"),Ei=_n.length|0)),Rn.bind(),oi?ui(Rn,oi,An,ti,xi,vi):(Ei&&It.bufferData(Rn.type,Ei,An),Rn.dtype=ti||sc,Rn.usage=An,Rn.dimension=xi,Rn.byteLength=Ei),dr.profile&&(Rn.stats.size=Rn.byteLength*nl[Rn.dtype]),Qn}function Ti(_n,An){J(An+_n.byteLength<=Rn.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+_n.byteLength+" starting from offset "+An+" to a buffer of size "+Rn.byteLength),It.bufferSubData(Rn.type,An,_n)}function aa(_n,An){var oi=(An||0)|0,Ei;if(Rn.bind(),bt(_n)||_n instanceof ArrayBuffer)Ti(_n,oi);else if(Array.isArray(_n)){if(_n.length>0)if(typeof _n[0]=="number"){var ti=Kr.allocType(Rn.dtype,_n.length);D(ti,_n),Ti(ti,oi),Kr.freeType(ti)}else if(Array.isArray(_n[0])||bt(_n[0])){Ei=_u(_n);var xi=Uc(_n,Ei,Rn.dtype);Ti(xi,oi),Kr.freeType(xi)}else J.raise("invalid buffer data")}else if(Wu(_n)){Ei=_n.shape;var Mi=_n.stride,Ua=0,Yn=0,Ii=0,Li=0;Ei.length===1?(Ua=Ei[0],Yn=1,Ii=Mi[0],Li=0):Ei.length===2?(Ua=Ei[0],Yn=Ei[1],Ii=Mi[0],Li=Mi[1]):J.raise("invalid shape");var Sa=Array.isArray(_n.data)?Rn.dtype:uc(_n.data),Da=Kr.allocType(Sa,Ua*Yn);X(Da,_n.data,Ua,Yn,Ii,Li,_n.offset),Ti(Da,oi),Kr.freeType(Da)}else J.raise("invalid data for buffer subdata");return Qn}return Xn||Qn(Gr),Qn._reglType="buffer",Qn._buffer=Rn,Qn.subdata=aa,dr.profile&&(Qn.stats=Rn.stats),Qn.destroy=function(){yi(Rn)},Qn}function ri(){Ie(on).forEach(function(Gr){Gr.buffer=It.createBuffer(),It.bindBuffer(Gr.type,Gr.buffer),It.bufferData(Gr.type,Gr.persistentData||Gr.byteLength,Gr.usage)})}return dr.profile&&(Ue.getTotalBufferSize=function(){var Gr=0;return Object.keys(on).forEach(function(dn){Gr+=on[dn].stats.size}),Gr}),{create:qn,createStream:Hn,destroyStream:Jn,clear:function(){Ie(on).forEach(yi),Dn.forEach(yi)},getBuffer:function(Gr){return Gr&&Gr._buffer instanceof En?Gr._buffer:null},restore:ri,_initBuffer:ui}}var rt=0,se=0,Ze=1,Sr=1,jr=4,Vr=4,Ln={points:rt,point:se,lines:Ze,line:Sr,triangles:jr,triangle:Vr,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Gn=0,$i=1,Pa=4,ba=5120,uo=5121,Ca=5122,Ao=5123,qa=5124,gs=5125,xu=34963,il=35040,bu=35044;function iu(It,Ue,dr,cn){var On={},on=0,En={uint8:uo,uint16:Ao};Ue.oes_element_index_uint&&(En.uint32=gs);function Dn(ri){this.id=on++,On[this.id]=this,this.buffer=ri,this.primType=Pa,this.vertCount=0,this.type=0}Dn.prototype.bind=function(){this.buffer.bind()};var Hn=[];function Jn(ri){var Gr=Hn.pop();return Gr||(Gr=new Dn(dr.create(null,xu,!0,!1)._buffer)),ui(Gr,ri,il,-1,-1,0,0),Gr}function ii(ri){Hn.push(ri)}function ui(ri,Gr,dn,Xn,vi,Rn,Qn){ri.buffer.bind();var Ti;if(Gr){var aa=Qn;!Qn&&(!bt(Gr)||Wu(Gr)&&!bt(Gr.data))&&(aa=Ue.oes_element_index_uint?gs:Ao),dr._initBuffer(ri.buffer,Gr,dn,aa,3)}else It.bufferData(xu,Rn,dn),ri.buffer.dtype=Ti||uo,ri.buffer.usage=dn,ri.buffer.dimension=3,ri.buffer.byteLength=Rn;if(Ti=Qn,!Qn){switch(ri.buffer.dtype){case uo:case ba:Ti=uo;break;case Ao:case Ca:Ti=Ao;break;case gs:case qa:Ti=gs;break;default:J.raise("unsupported type for element array")}ri.buffer.dtype=Ti}ri.type=Ti,J(Ti!==gs||!!Ue.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var _n=vi;_n<0&&(_n=ri.buffer.byteLength,Ti===Ao?_n>>=1:Ti===gs&&(_n>>=2)),ri.vertCount=_n;var An=Xn;if(Xn<0){An=Pa;var oi=ri.buffer.dimension;oi===1&&(An=Gn),oi===2&&(An=$i),oi===3&&(An=Pa)}ri.primType=An}function yi(ri){cn.elementsCount--,J(ri.buffer!==null,"must not double destroy elements"),delete On[ri.id],ri.buffer.destroy(),ri.buffer=null}function qn(ri,Gr){var dn=dr.create(null,xu,!0),Xn=new Dn(dn._buffer);cn.elementsCount++;function vi(Rn){if(!Rn)dn(),Xn.primType=Pa,Xn.vertCount=0,Xn.type=uo;else if(typeof Rn=="number")dn(Rn),Xn.primType=Pa,Xn.vertCount=Rn|0,Xn.type=uo;else{var Qn=null,Ti=bu,aa=-1,_n=-1,An=0,oi=0;Array.isArray(Rn)||bt(Rn)||Wu(Rn)?Qn=Rn:(J.type(Rn,"object","invalid arguments for elements"),"data"in Rn&&(Qn=Rn.data,J(Array.isArray(Qn)||bt(Qn)||Wu(Qn),"invalid data for element buffer")),"usage"in Rn&&(J.parameter(Rn.usage,rs,"invalid element buffer usage"),Ti=rs[Rn.usage]),"primitive"in Rn&&(J.parameter(Rn.primitive,Ln,"invalid element buffer primitive"),aa=Ln[Rn.primitive]),"count"in Rn&&(J(typeof Rn.count=="number"&&Rn.count>=0,"invalid vertex count for elements"),_n=Rn.count|0),"type"in Rn&&(J.parameter(Rn.type,En,"invalid buffer type"),oi=En[Rn.type]),"length"in Rn?An=Rn.length|0:(An=_n,oi===Ao||oi===Ca?An*=2:(oi===gs||oi===qa)&&(An*=4))),ui(Xn,Qn,Ti,aa,_n,An,oi)}return vi}return vi(ri),vi._reglType="elements",vi._elements=Xn,vi.subdata=function(Rn,Qn){return dn.subdata(Rn,Qn),vi},vi.destroy=function(){yi(Xn)},vi}return{create:qn,createStream:Jn,destroyStream:ii,getElements:function(ri){return typeof ri=="function"&&ri._elements instanceof Dn?ri._elements:null},clear:function(){Ie(On).forEach(yi)}}}var Vc=new Float32Array(1),$s=new Uint32Array(Vc.buffer),Yl=5123;function me(It){for(var Ue=Kr.allocType(Yl,It.length),dr=0;dr<It.length;++dr)if(isNaN(It[dr]))Ue[dr]=65535;else if(It[dr]===1/0)Ue[dr]=31744;else if(It[dr]===-1/0)Ue[dr]=64512;else{Vc[0]=It[dr];var cn=$s[0],On=cn>>>31<<15,on=(cn<<1>>>24)-127,En=cn>>13&(1<<10)-1;if(on<-24)Ue[dr]=On;else if(on<-14){var Dn=-14-on;Ue[dr]=On+(En+(1<<10)>>Dn)}else on>15?Ue[dr]=On+31744:Ue[dr]=On+(on+15<<10)+En}return Ue}function ir(It){return Array.isArray(It)||bt(It)}var Or=function(It){return!(It&It-1)&&!!It},$r=34467,xn=3553,_i=34067,qi=34069,Ia=6408,du=6406,qs=6407,$a=6409,Dl=6410,av=32854,yf=32855,vd=36194,ov=32819,sv=32820,dh=33635,zf=34042,Gc=6402,vh=34041,Uf=35904,lc=35906,al=36193,_f=33776,vl=33777,Eu=33778,Yh=33779,Pp=35986,wc=35987,gl=34798,$h=35840,qh=35841,Op=35842,Hc=35843,Kh=36196,$l=5121,Qh=5123,Zf=5125,Tl=5126,gd=10242,md=10243,yd=10497,gh=33071,_d=33648,xf=10240,xs=10241,Jh=9728,Vf=9729,Bl=9984,go=9985,is=9986,Yu=9987,Fp=33170,bf=4352,tp=4353,xd=4354,ep=34046,Rp=3317,rp=37440,Ef=37441,au=37443,Sf=37444,np=33984,As=[Bl,is,go,Yu],Zi=[0,$a,Dl,qs,Ia],as={};as[$a]=as[du]=as[Gc]=1,as[vh]=as[Dl]=2,as[qs]=as[Uf]=3,as[Ia]=as[lc]=4;function wf(It){return"[object "+It+"]"}var Gf=wf("HTMLCanvasElement"),cc=wf("OffscreenCanvas"),ml=wf("CanvasRenderingContext2D"),Dp=wf("ImageBitmap"),Ai=wf("HTMLImageElement"),Hf=wf("HTMLVideoElement"),Cc=Object.keys(Ho).concat([Gf,cc,ml,Dp,Ai,Hf]),Cf=[];Cf[$l]=1,Cf[Tl]=4,Cf[al]=2,Cf[Qh]=2,Cf[Zf]=4;var ma=[];ma[av]=2,ma[yf]=2,ma[vd]=2,ma[vh]=4,ma[_f]=.5,ma[vl]=.5,ma[Eu]=1,ma[Yh]=1,ma[Pp]=.5,ma[wc]=1,ma[gl]=1,ma[$h]=.5,ma[qh]=.25,ma[Op]=.5,ma[Hc]=.25,ma[Kh]=.5;function yl(It){return Array.isArray(It)&&(It.length===0||typeof It[0]=="number")}function jf(It){if(!Array.isArray(It))return!1;var Ue=It.length;return!(Ue===0||!ir(It[0]))}function fc(It){return Object.prototype.toString.call(It)}function _l(It){return fc(It)===Gf}function sa(It){return fc(It)===cc}function Bp(It){return fc(It)===ml}function Np(It){return fc(It)===Dp}function bd(It){return fc(It)===Ai}function Ed(It){return fc(It)===Hf}function Ml(It){var Ue=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Ue&&It&&It.getContext)}function Ko(It){var Ue=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Ue&&It&&"src"in It&&"crossOrigin"in It)}function Ka(It){if(!It)return!1;if(Ml(It)||Ko(It))return!0;var Ue=fc(It);return Cc.indexOf(Ue)>=0?!0:yl(It)||jf(It)||Wu(It)}function xl(It){return Ho[Object.prototype.toString.call(It)]|0}function ql(It,Ue){var dr=Ue.length;switch(It.type){case $l:case Qh:case Zf:case Tl:var cn=Kr.allocType(It.type,dr);cn.set(Ue),It.data=cn;break;case al:It.data=me(Ue);break;default:J.raise("unsupported texture type, must specify a typed array")}}function Ts(It,Ue){return Kr.allocType(It.type===al?Tl:It.type,Ue)}function jc(It,Ue){It.type===al?(It.data=me(Ue),Kr.freeType(Ue)):It.data=Ue}function Nl(It,Ue,dr,cn,On,on){for(var En=It.width,Dn=It.height,Hn=It.channels,Jn=En*Dn*Hn,ii=Ts(It,Jn),ui=0,yi=0;yi<Dn;++yi)for(var qn=0;qn<En;++qn)for(var ri=0;ri<Hn;++ri)ii[ui++]=Ue[dr*qn+cn*yi+On*ri+on];jc(It,ii)}function Su(It,Ue,dr,cn,On,on){var En;if(typeof ma[It]!="undefined"?En=ma[It]:En=as[It]*Cf[Ue],on&&(En*=6),On){for(var Dn=0,Hn=dr;Hn>=1;)Dn+=En*Hn*Hn,Hn/=2;return Dn}else return En*dr*cn}function wu(It,Ue,dr,cn,On,on,En){var Dn={"don't care":bf,"dont care":bf,nice:xd,fast:tp},Hn={repeat:yd,clamp:gh,mirror:_d},Jn={nearest:Jh,linear:Vf},ii=I({mipmap:Yu,"nearest mipmap nearest":Bl,"linear mipmap nearest":go,"nearest mipmap linear":is,"linear mipmap linear":Yu},Jn),ui={none:0,browser:Sf},yi={uint8:$l,rgba4:ov,rgb565:dh,"rgb5 a1":sv},qn={alpha:du,luminance:$a,"luminance alpha":Dl,rgb:qs,rgba:Ia,rgba4:av,"rgb5 a1":yf,rgb565:vd},ri={};Ue.ext_srgb&&(qn.srgb=Uf,qn.srgba=lc),Ue.oes_texture_float&&(yi.float32=yi.float=Tl),Ue.oes_texture_half_float&&(yi.float16=yi["half float"]=al),Ue.webgl_depth_texture&&(I(qn,{depth:Gc,"depth stencil":vh}),I(yi,{uint16:Qh,uint32:Zf,"depth stencil":zf})),Ue.webgl_compressed_texture_s3tc&&I(ri,{"rgb s3tc dxt1":_f,"rgba s3tc dxt1":vl,"rgba s3tc dxt3":Eu,"rgba s3tc dxt5":Yh}),Ue.webgl_compressed_texture_atc&&I(ri,{"rgb atc":Pp,"rgba atc explicit alpha":wc,"rgba atc interpolated alpha":gl}),Ue.webgl_compressed_texture_pvrtc&&I(ri,{"rgb pvrtc 4bppv1":$h,"rgb pvrtc 2bppv1":qh,"rgba pvrtc 4bppv1":Op,"rgba pvrtc 2bppv1":Hc}),Ue.webgl_compressed_texture_etc1&&(ri["rgb etc1"]=Kh);var Gr=Array.prototype.slice.call(It.getParameter($r)||new Uint32Array(0));Object.keys(ri).forEach(function(Ke){var an=ri[Ke];Gr.indexOf(an)>=0&&(qn[Ke]=an)});var dn=Object.keys(qn);dr.textureFormats=dn;var Xn=[];Object.keys(qn).forEach(function(Ke){var an=qn[Ke];Xn[an]=Ke});var vi=[];Object.keys(yi).forEach(function(Ke){var an=yi[Ke];vi[an]=Ke});var Rn=[];Object.keys(Jn).forEach(function(Ke){var an=Jn[Ke];Rn[an]=Ke});var Qn=[];Object.keys(ii).forEach(function(Ke){var an=ii[Ke];Qn[an]=Ke});var Ti=[];Object.keys(Hn).forEach(function(Ke){var an=Hn[Ke];Ti[an]=Ke});var aa=dn.reduce(function(Ke,an){var en=qn[an];return en===$a||en===du||en===$a||en===Dl||en===Gc||en===vh||Ue.ext_srgb&&(en===Uf||en===lc)?Ke[en]=en:en===yf||an.indexOf("rgba")>=0?Ke[en]=Ia:Ke[en]=qs,Ke},{});function _n(){this.internalformat=Ia,this.format=Ia,this.type=$l,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Sf,this.width=0,this.height=0,this.channels=0}function An(Ke,an){Ke.internalformat=an.internalformat,Ke.format=an.format,Ke.type=an.type,Ke.compressed=an.compressed,Ke.premultiplyAlpha=an.premultiplyAlpha,Ke.flipY=an.flipY,Ke.unpackAlignment=an.unpackAlignment,Ke.colorSpace=an.colorSpace,Ke.width=an.width,Ke.height=an.height,Ke.channels=an.channels}function oi(Ke,an){if(!(typeof an!="object"||!an)){if("premultiplyAlpha"in an&&(J.type(an.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Ke.premultiplyAlpha=an.premultiplyAlpha),"flipY"in an&&(J.type(an.flipY,"boolean","invalid texture flip"),Ke.flipY=an.flipY),"alignment"in an&&(J.oneOf(an.alignment,[1,2,4,8],"invalid texture unpack alignment"),Ke.unpackAlignment=an.alignment),"colorSpace"in an&&(J.parameter(an.colorSpace,ui,"invalid colorSpace"),Ke.colorSpace=ui[an.colorSpace]),"type"in an){var en=an.type;J(Ue.oes_texture_float||!(en==="float"||en==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),J(Ue.oes_texture_half_float||!(en==="half float"||en==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),J(Ue.webgl_depth_texture||!(en==="uint16"||en==="uint32"||en==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(en,yi,"invalid texture type"),Ke.type=yi[en]}var Ri=Ke.width,so=Ke.height,$e=Ke.channels,Fe=!1;"shape"in an?(J(Array.isArray(an.shape)&&an.shape.length>=2,"shape must be an array"),Ri=an.shape[0],so=an.shape[1],an.shape.length===3&&($e=an.shape[2],J($e>0&&$e<=4,"invalid number of channels"),Fe=!0),J(Ri>=0&&Ri<=dr.maxTextureSize,"invalid width"),J(so>=0&&so<=dr.maxTextureSize,"invalid height")):("radius"in an&&(Ri=so=an.radius,J(Ri>=0&&Ri<=dr.maxTextureSize,"invalid radius")),"width"in an&&(Ri=an.width,J(Ri>=0&&Ri<=dr.maxTextureSize,"invalid width")),"height"in an&&(so=an.height,J(so>=0&&so<=dr.maxTextureSize,"invalid height")),"channels"in an&&($e=an.channels,J($e>0&&$e<=4,"invalid number of channels"),Fe=!0)),Ke.width=Ri|0,Ke.height=so|0,Ke.channels=$e|0;var yr=!1;if("format"in an){var Xr=an.format;J(Ue.webgl_depth_texture||!(Xr==="depth"||Xr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(Xr,qn,"invalid texture format");var sn=Ke.internalformat=qn[Xr];Ke.format=aa[sn],Xr in yi&&("type"in an||(Ke.type=yi[Xr])),Xr in ri&&(Ke.compressed=!0),yr=!0}!Fe&&yr?Ke.channels=as[Ke.format]:Fe&&!yr?Ke.channels!==Zi[Ke.format]&&(Ke.format=Ke.internalformat=Zi[Ke.channels]):yr&&Fe&&J(Ke.channels===as[Ke.format],"number of channels inconsistent with specified format")}}function Ei(Ke){It.pixelStorei(rp,Ke.flipY),It.pixelStorei(Ef,Ke.premultiplyAlpha),It.pixelStorei(au,Ke.colorSpace),It.pixelStorei(Rp,Ke.unpackAlignment)}function ti(){_n.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function xi(Ke,an){var en=null;if(Ka(an)?en=an:an&&(J.type(an,"object","invalid pixel data type"),oi(Ke,an),"x"in an&&(Ke.xOffset=an.x|0),"y"in an&&(Ke.yOffset=an.y|0),Ka(an.data)&&(en=an.data)),J(!Ke.compressed||en instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),an.copy){J(!en,"can not specify copy and data field for the same texture");var Ri=On.viewportWidth,so=On.viewportHeight;Ke.width=Ke.width||Ri-Ke.xOffset,Ke.height=Ke.height||so-Ke.yOffset,Ke.needsCopy=!0,J(Ke.xOffset>=0&&Ke.xOffset<Ri&&Ke.yOffset>=0&&Ke.yOffset<so&&Ke.width>0&&Ke.width<=Ri&&Ke.height>0&&Ke.height<=so,"copy texture read out of bounds")}else if(!en)Ke.width=Ke.width||1,Ke.height=Ke.height||1,Ke.channels=Ke.channels||4;else if(bt(en))Ke.channels=Ke.channels||4,Ke.data=en,!("type"in an)&&Ke.type===$l&&(Ke.type=xl(en));else if(yl(en))Ke.channels=Ke.channels||4,ql(Ke,en),Ke.alignment=1,Ke.needsFree=!0;else if(Wu(en)){var $e=en.data;!Array.isArray($e)&&Ke.type===$l&&(Ke.type=xl($e));var Fe=en.shape,yr=en.stride,Xr,sn,mr,pr,kr,Ve;Fe.length===3?(mr=Fe[2],Ve=yr[2]):(J(Fe.length===2,"invalid ndarray pixel data, must be 2 or 3D"),mr=1,Ve=1),Xr=Fe[0],sn=Fe[1],pr=yr[0],kr=yr[1],Ke.alignment=1,Ke.width=Xr,Ke.height=sn,Ke.channels=mr,Ke.format=Ke.internalformat=Zi[mr],Ke.needsFree=!0,Nl(Ke,$e,pr,kr,Ve,en.offset)}else if(Ml(en)||_l(en)||sa(en)||Bp(en))Ml(en)||_l(en)||sa(en)?Ke.element=en:Ke.element=en.canvas,Ke.width=Ke.element.width,Ke.height=Ke.element.height,Ke.channels=4;else if(Np(en))Ke.element=en,Ke.width=en.width,Ke.height=en.height,Ke.channels=4;else if(bd(en))Ke.element=en,Ke.width=en.naturalWidth,Ke.height=en.naturalHeight,Ke.channels=4;else if(Ko(en))Ke.element=en,Ke.width=en.width,Ke.height=en.height,Ke.channels=4;else if(Ed(en))Ke.element=en,Ke.width=en.videoWidth,Ke.height=en.videoHeight,Ke.channels=4;else if(jf(en)){var vr=Ke.width||en[0].length,Qe=Ke.height||en.length,Hr=Ke.channels;ir(en[0][0])?Hr=Hr||en[0][0].length:Hr=Hr||1;for(var Jr=We.shape(en),Bn=1,gi=0;gi<Jr.length;++gi)Bn*=Jr[gi];var mi=Ts(Ke,Bn);We.flatten(en,Jr,"",mi),jc(Ke,mi),Ke.alignment=1,Ke.width=vr,Ke.height=Qe,Ke.channels=Hr,Ke.format=Ke.internalformat=Zi[Hr],Ke.needsFree=!0}Ke.type===Tl?J(dr.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Ke.type===al&&J(dr.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Mi(Ke,an,en){var Ri=Ke.element,so=Ke.data,$e=Ke.internalformat,Fe=Ke.format,yr=Ke.type,Xr=Ke.width,sn=Ke.height;Ei(Ke),Ri?It.texImage2D(an,en,Fe,Fe,yr,Ri):Ke.compressed?It.compressedTexImage2D(an,en,$e,Xr,sn,0,so):Ke.needsCopy?(cn(),It.copyTexImage2D(an,en,Fe,Ke.xOffset,Ke.yOffset,Xr,sn,0)):It.texImage2D(an,en,Fe,Xr,sn,0,Fe,yr,so||null)}function Ua(Ke,an,en,Ri,so){var $e=Ke.element,Fe=Ke.data,yr=Ke.internalformat,Xr=Ke.format,sn=Ke.type,mr=Ke.width,pr=Ke.height;Ei(Ke),$e?It.texSubImage2D(an,so,en,Ri,Xr,sn,$e):Ke.compressed?It.compressedTexSubImage2D(an,so,en,Ri,yr,mr,pr,Fe):Ke.needsCopy?(cn(),It.copyTexSubImage2D(an,so,en,Ri,Ke.xOffset,Ke.yOffset,mr,pr)):It.texSubImage2D(an,so,en,Ri,mr,pr,Xr,sn,Fe)}var Yn=[];function Ii(){return Yn.pop()||new ti}function Li(Ke){Ke.needsFree&&Kr.freeType(Ke.data),ti.call(Ke),Yn.push(Ke)}function Sa(){_n.call(this),this.genMipmaps=!1,this.mipmapHint=bf,this.mipmask=0,this.images=Array(16)}function Da(Ke,an,en){var Ri=Ke.images[0]=Ii();Ke.mipmask=1,Ri.width=Ke.width=an,Ri.height=Ke.height=en,Ri.channels=Ke.channels=4}function oo(Ke,an){var en=null;if(Ka(an))en=Ke.images[0]=Ii(),An(en,Ke),xi(en,an),Ke.mipmask=1;else if(oi(Ke,an),Array.isArray(an.mipmap))for(var Ri=an.mipmap,so=0;so<Ri.length;++so)en=Ke.images[so]=Ii(),An(en,Ke),en.width>>=so,en.height>>=so,xi(en,Ri[so]),Ke.mipmask|=1<<so;else en=Ke.images[0]=Ii(),An(en,Ke),xi(en,an),Ke.mipmask=1;An(Ke,Ke.images[0]),Ke.compressed&&(Ke.internalformat===_f||Ke.internalformat===vl||Ke.internalformat===Eu||Ke.internalformat===Yh)&&J(Ke.width%4===0&&Ke.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Is(Ke,an){for(var en=Ke.images,Ri=0;Ri<en.length;++Ri){if(!en[Ri])return;Mi(en[Ri],an,Ri)}}var zs=[];function io(){var Ke=zs.pop()||new Sa;_n.call(Ke),Ke.mipmask=0;for(var an=0;an<16;++an)Ke.images[an]=null;return Ke}function Au(Ke){for(var an=Ke.images,en=0;en<an.length;++en)an[en]&&Li(an[en]),an[en]=null;zs.push(Ke)}function Xo(){this.minFilter=Jh,this.magFilter=Jh,this.wrapS=gh,this.wrapT=gh,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=bf}function Qs(Ke,an){if("min"in an){var en=an.min;J.parameter(en,ii),Ke.minFilter=ii[en],As.indexOf(Ke.minFilter)>=0&&!("faces"in an)&&(Ke.genMipmaps=!0)}if("mag"in an){var Ri=an.mag;J.parameter(Ri,Jn),Ke.magFilter=Jn[Ri]}var so=Ke.wrapS,$e=Ke.wrapT;if("wrap"in an){var Fe=an.wrap;typeof Fe=="string"?(J.parameter(Fe,Hn),so=$e=Hn[Fe]):Array.isArray(Fe)&&(J.parameter(Fe[0],Hn),J.parameter(Fe[1],Hn),so=Hn[Fe[0]],$e=Hn[Fe[1]])}else{if("wrapS"in an){var yr=an.wrapS;J.parameter(yr,Hn),so=Hn[yr]}if("wrapT"in an){var Xr=an.wrapT;J.parameter(Xr,Hn),$e=Hn[Xr]}}if(Ke.wrapS=so,Ke.wrapT=$e,"anisotropic"in an){var sn=an.anisotropic;J(typeof sn=="number"&&sn>=1&&sn<=dr.maxAnisotropic,"aniso samples must be between 1 and "),Ke.anisotropic=an.anisotropic}if("mipmap"in an){var mr=!1;switch(typeof an.mipmap){case"string":J.parameter(an.mipmap,Dn,"invalid mipmap hint"),Ke.mipmapHint=Dn[an.mipmap],Ke.genMipmaps=!0,mr=!0;break;case"boolean":mr=Ke.genMipmaps=an.mipmap;break;case"object":J(Array.isArray(an.mipmap),"invalid mipmap type"),Ke.genMipmaps=!1,mr=!0;break;default:J.raise("invalid mipmap type")}mr&&!("min"in an)&&(Ke.minFilter=Bl)}}function su(Ke,an){It.texParameteri(an,xs,Ke.minFilter),It.texParameteri(an,xf,Ke.magFilter),It.texParameteri(an,gd,Ke.wrapS),It.texParameteri(an,md,Ke.wrapT),Ue.ext_texture_filter_anisotropic&&It.texParameteri(an,ep,Ke.anisotropic),Ke.genMipmaps&&(It.hint(Fp,Ke.mipmapHint),It.generateMipmap(an))}var Tu=0,Js={},zu=dr.maxTextureUnits,Jo=Array(zu).map(function(){return null});function La(Ke){_n.call(this),this.mipmask=0,this.internalformat=Ia,this.id=Tu++,this.refCount=1,this.target=Ke,this.texture=It.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Xo,En.profile&&(this.stats={size:0})}function tu(Ke){It.activeTexture(np),It.bindTexture(Ke.target,Ke.texture)}function fo(){var Ke=Jo[0];Ke?It.bindTexture(Ke.target,Ke.texture):It.bindTexture(xn,null)}function Mu(Ke){var an=Ke.texture;J(an,"must not double destroy texture");var en=Ke.unit,Ri=Ke.target;en>=0&&(It.activeTexture(np+en),It.bindTexture(Ri,null),Jo[en]=null),It.deleteTexture(an),Ke.texture=null,Ke.params=null,Ke.pixels=null,Ke.refCount=0,delete Js[Ke.id],on.textureCount--}I(La.prototype,{bind:function(){var Ke=this;Ke.bindCount+=1;var an=Ke.unit;if(an<0){for(var en=0;en<zu;++en){var Ri=Jo[en];if(Ri){if(Ri.bindCount>0)continue;Ri.unit=-1}Jo[en]=Ke,an=en;break}an>=zu&&J.raise("insufficient number of texture units"),En.profile&&on.maxTextureUnits<an+1&&(on.maxTextureUnits=an+1),Ke.unit=an,It.activeTexture(np+an),It.bindTexture(Ke.target,Ke.texture)}return an},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Mu(this)}});function ya(Ke,an){var en=new La(xn);Js[en.id]=en,on.textureCount++;function Ri(Fe,yr){var Xr=en.texInfo;Xo.call(Xr);var sn=io();return typeof Fe=="number"?typeof yr=="number"?Da(sn,Fe|0,yr|0):Da(sn,Fe|0,Fe|0):Fe?(J.type(Fe,"object","invalid arguments to regl.texture"),Qs(Xr,Fe),oo(sn,Fe)):Da(sn,1,1),Xr.genMipmaps&&(sn.mipmask=(sn.width<<1)-1),en.mipmask=sn.mipmask,An(en,sn),J.texture2D(Xr,sn,dr),en.internalformat=sn.internalformat,Ri.width=sn.width,Ri.height=sn.height,tu(en),Is(sn,xn),su(Xr,xn),fo(),Au(sn),En.profile&&(en.stats.size=Su(en.internalformat,en.type,sn.width,sn.height,Xr.genMipmaps,!1)),Ri.format=Xn[en.internalformat],Ri.type=vi[en.type],Ri.mag=Rn[Xr.magFilter],Ri.min=Qn[Xr.minFilter],Ri.wrapS=Ti[Xr.wrapS],Ri.wrapT=Ti[Xr.wrapT],Ri}function so(Fe,yr,Xr,sn){J(!!Fe,"must specify image data");var mr=yr|0,pr=Xr|0,kr=sn|0,Ve=Ii();return An(Ve,en),Ve.width=0,Ve.height=0,xi(Ve,Fe),Ve.width=Ve.width||(en.width>>kr)-mr,Ve.height=Ve.height||(en.height>>kr)-pr,J(en.type===Ve.type&&en.format===Ve.format&&en.internalformat===Ve.internalformat,"incompatible format for texture.subimage"),J(mr>=0&&pr>=0&&mr+Ve.width<=en.width&&pr+Ve.height<=en.height,"texture.subimage write out of bounds"),J(en.mipmask&1<<kr,"missing mipmap data"),J(Ve.data||Ve.element||Ve.needsCopy,"missing image data"),tu(en),Ua(Ve,xn,mr,pr,kr),fo(),Li(Ve),Ri}function $e(Fe,yr){var Xr=Fe|0,sn=yr|0||Xr;if(Xr===en.width&&sn===en.height)return Ri;Ri.width=en.width=Xr,Ri.height=en.height=sn,tu(en);for(var mr=0;en.mipmask>>mr;++mr){var pr=Xr>>mr,kr=sn>>mr;if(!pr||!kr)break;It.texImage2D(xn,mr,en.format,pr,kr,0,en.format,en.type,null)}return fo(),En.profile&&(en.stats.size=Su(en.internalformat,en.type,Xr,sn,!1,!1)),Ri}return Ri(Ke,an),Ri.subimage=so,Ri.resize=$e,Ri._reglType="texture2d",Ri._texture=en,En.profile&&(Ri.stats=en.stats),Ri.destroy=function(){en.decRef()},Ri}function eo(Ke,an,en,Ri,so,$e){var Fe=new La(_i);Js[Fe.id]=Fe,on.cubeCount++;var yr=new Array(6);function Xr(pr,kr,Ve,vr,Qe,Hr){var Jr,Bn=Fe.texInfo;for(Xo.call(Bn),Jr=0;Jr<6;++Jr)yr[Jr]=io();if(typeof pr=="number"||!pr){var gi=pr|0||1;for(Jr=0;Jr<6;++Jr)Da(yr[Jr],gi,gi)}else if(typeof pr=="object")if(kr)oo(yr[0],pr),oo(yr[1],kr),oo(yr[2],Ve),oo(yr[3],vr),oo(yr[4],Qe),oo(yr[5],Hr);else if(Qs(Bn,pr),oi(Fe,pr),"faces"in pr){var mi=pr.faces;for(J(Array.isArray(mi)&&mi.length===6,"cube faces must be a length 6 array"),Jr=0;Jr<6;++Jr)J(typeof mi[Jr]=="object"&&!!mi[Jr],"invalid input for cube map face"),An(yr[Jr],Fe),oo(yr[Jr],mi[Jr])}else for(Jr=0;Jr<6;++Jr)oo(yr[Jr],pr);else J.raise("invalid arguments to cube map");for(An(Fe,yr[0]),J.optional(function(){dr.npotTextureCube||J(Or(Fe.width)&&Or(Fe.height),"your browser does not support non power or two texture dimensions")}),Bn.genMipmaps?Fe.mipmask=(yr[0].width<<1)-1:Fe.mipmask=yr[0].mipmask,J.textureCube(Fe,Bn,yr,dr),Fe.internalformat=yr[0].internalformat,Xr.width=yr[0].width,Xr.height=yr[0].height,tu(Fe),Jr=0;Jr<6;++Jr)Is(yr[Jr],qi+Jr);for(su(Bn,_i),fo(),En.profile&&(Fe.stats.size=Su(Fe.internalformat,Fe.type,Xr.width,Xr.height,Bn.genMipmaps,!0)),Xr.format=Xn[Fe.internalformat],Xr.type=vi[Fe.type],Xr.mag=Rn[Bn.magFilter],Xr.min=Qn[Bn.minFilter],Xr.wrapS=Ti[Bn.wrapS],Xr.wrapT=Ti[Bn.wrapT],Jr=0;Jr<6;++Jr)Au(yr[Jr]);return Xr}function sn(pr,kr,Ve,vr,Qe){J(!!kr,"must specify image data"),J(typeof pr=="number"&&pr===(pr|0)&&pr>=0&&pr<6,"invalid face");var Hr=Ve|0,Jr=vr|0,Bn=Qe|0,gi=Ii();return An(gi,Fe),gi.width=0,gi.height=0,xi(gi,kr),gi.width=gi.width||(Fe.width>>Bn)-Hr,gi.height=gi.height||(Fe.height>>Bn)-Jr,J(Fe.type===gi.type&&Fe.format===gi.format&&Fe.internalformat===gi.internalformat,"incompatible format for texture.subimage"),J(Hr>=0&&Jr>=0&&Hr+gi.width<=Fe.width&&Jr+gi.height<=Fe.height,"texture.subimage write out of bounds"),J(Fe.mipmask&1<<Bn,"missing mipmap data"),J(gi.data||gi.element||gi.needsCopy,"missing image data"),tu(Fe),Ua(gi,qi+pr,Hr,Jr,Bn),fo(),Li(gi),Xr}function mr(pr){var kr=pr|0;if(kr!==Fe.width){Xr.width=Fe.width=kr,Xr.height=Fe.height=kr,tu(Fe);for(var Ve=0;Ve<6;++Ve)for(var vr=0;Fe.mipmask>>vr;++vr)It.texImage2D(qi+Ve,vr,Fe.format,kr>>vr,kr>>vr,0,Fe.format,Fe.type,null);return fo(),En.profile&&(Fe.stats.size=Su(Fe.internalformat,Fe.type,Xr.width,Xr.height,!1,!0)),Xr}}return Xr(Ke,an,en,Ri,so,$e),Xr.subimage=sn,Xr.resize=mr,Xr._reglType="textureCube",Xr._texture=Fe,En.profile&&(Xr.stats=Fe.stats),Xr.destroy=function(){Fe.decRef()},Xr}function Eo(){for(var Ke=0;Ke<zu;++Ke)It.activeTexture(np+Ke),It.bindTexture(xn,null),Jo[Ke]=null;Ie(Js).forEach(Mu),on.cubeCount=0,on.textureCount=0}En.profile&&(on.getTotalTextureSize=function(){var Ke=0;return Object.keys(Js).forEach(function(an){Ke+=Js[an].stats.size}),Ke});function So(){for(var Ke=0;Ke<zu;++Ke){var an=Jo[Ke];an&&(an.bindCount=0,an.unit=-1,Jo[Ke]=null)}Ie(Js).forEach(function(en){en.texture=It.createTexture(),It.bindTexture(en.target,en.texture);for(var Ri=0;Ri<32;++Ri)if((en.mipmask&1<<Ri)!==0)if(en.target===xn)It.texImage2D(xn,Ri,en.internalformat,en.width>>Ri,en.height>>Ri,0,en.internalformat,en.type,null);else for(var so=0;so<6;++so)It.texImage2D(qi+so,Ri,en.internalformat,en.width>>Ri,en.height>>Ri,0,en.internalformat,en.type,null);su(en.texInfo,en.target)})}function Po(){for(var Ke=0;Ke<zu;++Ke){var an=Jo[Ke];an&&(an.bindCount=0,an.unit=-1,Jo[Ke]=null),It.activeTexture(np+Ke),It.bindTexture(xn,null),It.bindTexture(_i,null)}}return{create2D:ya,createCube:eo,clear:Eo,getTexture:function(Ke){return null},restore:So,refresh:Po}}var Il=36161,Ki=32854,Wi=32855,Af=36194,ol=33189,sl=36168,Ru=34041,bs=35907,Ac=34836,Tc=34842,No=34843,os=[];os[Ki]=2,os[Wi]=2,os[Af]=2,os[ol]=2,os[sl]=1,os[Ru]=4,os[bs]=4,os[Ac]=16,os[Tc]=8,os[No]=6;function ip(It,Ue,dr){return os[It]*Ue*dr}var Wc=function(It,Ue,dr,cn,On){var on={rgba4:Ki,rgb565:Af,"rgb5 a1":Wi,depth:ol,stencil:sl,"depth stencil":Ru};Ue.ext_srgb&&(on.srgba=bs),Ue.ext_color_buffer_half_float&&(on.rgba16f=Tc,on.rgb16f=No),Ue.webgl_color_buffer_float&&(on.rgba32f=Ac);var En=[];Object.keys(on).forEach(function(qn){var ri=on[qn];En[ri]=qn});var Dn=0,Hn={};function Jn(qn){this.id=Dn++,this.refCount=1,this.renderbuffer=qn,this.format=Ki,this.width=0,this.height=0,On.profile&&(this.stats={size:0})}Jn.prototype.decRef=function(){--this.refCount<=0&&ii(this)};function ii(qn){var ri=qn.renderbuffer;J(ri,"must not double destroy renderbuffer"),It.bindRenderbuffer(Il,null),It.deleteRenderbuffer(ri),qn.renderbuffer=null,qn.refCount=0,delete Hn[qn.id],cn.renderbufferCount--}function ui(qn,ri){var Gr=new Jn(It.createRenderbuffer());Hn[Gr.id]=Gr,cn.renderbufferCount++;function dn(vi,Rn){var Qn=0,Ti=0,aa=Ki;if(typeof vi=="object"&&vi){var _n=vi;if("shape"in _n){var An=_n.shape;J(Array.isArray(An)&&An.length>=2,"invalid renderbuffer shape"),Qn=An[0]|0,Ti=An[1]|0}else"radius"in _n&&(Qn=Ti=_n.radius|0),"width"in _n&&(Qn=_n.width|0),"height"in _n&&(Ti=_n.height|0);"format"in _n&&(J.parameter(_n.format,on,"invalid renderbuffer format"),aa=on[_n.format])}else typeof vi=="number"?(Qn=vi|0,typeof Rn=="number"?Ti=Rn|0:Ti=Qn):vi?J.raise("invalid arguments to renderbuffer constructor"):Qn=Ti=1;if(J(Qn>0&&Ti>0&&Qn<=dr.maxRenderbufferSize&&Ti<=dr.maxRenderbufferSize,"invalid renderbuffer size"),!(Qn===Gr.width&&Ti===Gr.height&&aa===Gr.format))return dn.width=Gr.width=Qn,dn.height=Gr.height=Ti,Gr.format=aa,It.bindRenderbuffer(Il,Gr.renderbuffer),It.renderbufferStorage(Il,aa,Qn,Ti),J(It.getError()===0,"invalid render buffer format"),On.profile&&(Gr.stats.size=ip(Gr.format,Gr.width,Gr.height)),dn.format=En[Gr.format],dn}function Xn(vi,Rn){var Qn=vi|0,Ti=Rn|0||Qn;return Qn===Gr.width&&Ti===Gr.height||(J(Qn>0&&Ti>0&&Qn<=dr.maxRenderbufferSize&&Ti<=dr.maxRenderbufferSize,"invalid renderbuffer size"),dn.width=Gr.width=Qn,dn.height=Gr.height=Ti,It.bindRenderbuffer(Il,Gr.renderbuffer),It.renderbufferStorage(Il,Gr.format,Qn,Ti),J(It.getError()===0,"invalid render buffer format"),On.profile&&(Gr.stats.size=ip(Gr.format,Gr.width,Gr.height))),dn}return dn(qn,ri),dn.resize=Xn,dn._reglType="renderbuffer",dn._renderbuffer=Gr,On.profile&&(dn.stats=Gr.stats),dn.destroy=function(){Gr.decRef()},dn}On.profile&&(cn.getTotalRenderbufferSize=function(){var qn=0;return Object.keys(Hn).forEach(function(ri){qn+=Hn[ri].stats.size}),qn});function yi(){Ie(Hn).forEach(function(qn){qn.renderbuffer=It.createRenderbuffer(),It.bindRenderbuffer(Il,qn.renderbuffer),It.renderbufferStorage(Il,qn.format,qn.width,qn.height)}),It.bindRenderbuffer(Il,null)}return{create:ui,clear:function(){Ie(Hn).forEach(ii)},restore:yi}},hc=36160,ul=36161,Fs=3553,Ms=34069,$u=36064,Xc=36096,ll=36128,Wf=33306,Mc=36053,mh=36054,Xf=36055,Sd=36057,Rs=36061,Ic=36193,ap=5121,bl=5126,zl=6407,op=6408,pc=6402,zp=[zl,op],Yc=[];Yc[op]=4,Yc[zl]=3;var x=[];x[ap]=1,x[bl]=4,x[Ic]=2;var C=32854,S=32855,M=36194,z=33189,H=36168,$=34041,ft=35907,zt=34836,ee=34842,Re=34843,De=[C,S,M,ft,ee,Re,zt],ke={};ke[Mc]="complete",ke[mh]="incomplete attachment",ke[Sd]="incomplete dimensions",ke[Xf]="incomplete, missing attachment",ke[Rs]="unsupported";function cr(It,Ue,dr,cn,On,on){var En={cur:null,next:null,dirty:!1,setFBO:null},Dn=["rgba"],Hn=["rgba4","rgb565","rgb5 a1"];Ue.ext_srgb&&Hn.push("srgba"),Ue.ext_color_buffer_half_float&&Hn.push("rgba16f","rgb16f"),Ue.webgl_color_buffer_float&&Hn.push("rgba32f");var Jn=["uint8"];Ue.oes_texture_half_float&&Jn.push("half float","float16"),Ue.oes_texture_float&&Jn.push("float","float32");function ii(ti,xi,Mi){this.target=ti,this.texture=xi,this.renderbuffer=Mi;var Ua=0,Yn=0;xi?(Ua=xi.width,Yn=xi.height):Mi&&(Ua=Mi.width,Yn=Mi.height),this.width=Ua,this.height=Yn}function ui(ti){ti&&(ti.texture&&ti.texture._texture.decRef(),ti.renderbuffer&&ti.renderbuffer._renderbuffer.decRef())}function yi(ti,xi,Mi){if(!!ti)if(ti.texture){var Ua=ti.texture._texture,Yn=Math.max(1,Ua.width),Ii=Math.max(1,Ua.height);J(Yn===xi&&Ii===Mi,"inconsistent width/height for supplied texture"),Ua.refCount+=1}else{var Li=ti.renderbuffer._renderbuffer;J(Li.width===xi&&Li.height===Mi,"inconsistent width/height for renderbuffer"),Li.refCount+=1}}function qn(ti,xi){xi&&(xi.texture?It.framebufferTexture2D(hc,ti,xi.target,xi.texture._texture.texture,0):It.framebufferRenderbuffer(hc,ti,ul,xi.renderbuffer._renderbuffer.renderbuffer))}function ri(ti){var xi=Fs,Mi=null,Ua=null,Yn=ti;typeof ti=="object"&&(Yn=ti.data,"target"in ti&&(xi=ti.target|0)),J.type(Yn,"function","invalid attachment data");var Ii=Yn._reglType;return Ii==="texture2d"?(Mi=Yn,J(xi===Fs)):Ii==="textureCube"?(Mi=Yn,J(xi>=Ms&&xi<Ms+6,"invalid cube map target")):Ii==="renderbuffer"?(Ua=Yn,xi=ul):J.raise("invalid regl object for attachment"),new ii(xi,Mi,Ua)}function Gr(ti,xi,Mi,Ua,Yn){if(Mi){var Ii=cn.create2D({width:ti,height:xi,format:Ua,type:Yn});return Ii._texture.refCount=0,new ii(Fs,Ii,null)}else{var Li=On.create({width:ti,height:xi,format:Ua});return Li._renderbuffer.refCount=0,new ii(ul,null,Li)}}function dn(ti){return ti&&(ti.texture||ti.renderbuffer)}function Xn(ti,xi,Mi){ti&&(ti.texture?ti.texture.resize(xi,Mi):ti.renderbuffer&&ti.renderbuffer.resize(xi,Mi),ti.width=xi,ti.height=Mi)}var vi=0,Rn={};function Qn(){this.id=vi++,Rn[this.id]=this,this.framebuffer=It.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ti(ti){ti.colorAttachments.forEach(ui),ui(ti.depthAttachment),ui(ti.stencilAttachment),ui(ti.depthStencilAttachment)}function aa(ti){var xi=ti.framebuffer;J(xi,"must not double destroy framebuffer"),It.deleteFramebuffer(xi),ti.framebuffer=null,on.framebufferCount--,delete Rn[ti.id]}function _n(ti){var xi;It.bindFramebuffer(hc,ti.framebuffer);var Mi=ti.colorAttachments;for(xi=0;xi<Mi.length;++xi)qn($u+xi,Mi[xi]);for(xi=Mi.length;xi<dr.maxColorAttachments;++xi)It.framebufferTexture2D(hc,$u+xi,Fs,null,0);It.framebufferTexture2D(hc,Wf,Fs,null,0),It.framebufferTexture2D(hc,Xc,Fs,null,0),It.framebufferTexture2D(hc,ll,Fs,null,0),qn(Xc,ti.depthAttachment),qn(ll,ti.stencilAttachment),qn(Wf,ti.depthStencilAttachment);var Ua=It.checkFramebufferStatus(hc);!It.isContextLost()&&Ua!==Mc&&J.raise("framebuffer configuration not supported, status = "+ke[Ua]),It.bindFramebuffer(hc,En.next?En.next.framebuffer:null),En.cur=En.next,It.getError()}function An(ti,xi){var Mi=new Qn;on.framebufferCount++;function Ua(Ii,Li){var Sa;J(En.next!==Mi,"can not update framebuffer which is currently in use");var Da=0,oo=0,Is=!0,zs=!0,io=null,Au=!0,Xo="rgba",Qs="uint8",su=1,Tu=null,Js=null,zu=null,Jo=!1;if(typeof Ii=="number")Da=Ii|0,oo=Li|0||Da;else if(!Ii)Da=oo=1;else{J.type(Ii,"object","invalid arguments for framebuffer");var La=Ii;if("shape"in La){var tu=La.shape;J(Array.isArray(tu)&&tu.length>=2,"invalid shape for framebuffer"),Da=tu[0],oo=tu[1]}else"radius"in La&&(Da=oo=La.radius),"width"in La&&(Da=La.width),"height"in La&&(oo=La.height);("color"in La||"colors"in La)&&(io=La.color||La.colors,Array.isArray(io)&&J(io.length===1||Ue.webgl_draw_buffers,"multiple render targets not supported")),io||("colorCount"in La&&(su=La.colorCount|0,J(su>0,"invalid color buffer count")),"colorTexture"in La&&(Au=!!La.colorTexture,Xo="rgba4"),"colorType"in La&&(Qs=La.colorType,Au?(J(Ue.oes_texture_float||!(Qs==="float"||Qs==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),J(Ue.oes_texture_half_float||!(Qs==="half float"||Qs==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Qs==="half float"||Qs==="float16"?(J(Ue.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Xo="rgba16f"):(Qs==="float"||Qs==="float32")&&(J(Ue.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Xo="rgba32f"),J.oneOf(Qs,Jn,"invalid color type")),"colorFormat"in La&&(Xo=La.colorFormat,Dn.indexOf(Xo)>=0?Au=!0:Hn.indexOf(Xo)>=0?Au=!1:J.optional(function(){Au?J.oneOf(La.colorFormat,Dn,"invalid color format for texture"):J.oneOf(La.colorFormat,Hn,"invalid color format for renderbuffer")}))),("depthTexture"in La||"depthStencilTexture"in La)&&(Jo=!!(La.depthTexture||La.depthStencilTexture),J(!Jo||Ue.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in La&&(typeof La.depth=="boolean"?Is=La.depth:(Tu=La.depth,zs=!1)),"stencil"in La&&(typeof La.stencil=="boolean"?zs=La.stencil:(Js=La.stencil,Is=!1)),"depthStencil"in La&&(typeof La.depthStencil=="boolean"?Is=zs=La.depthStencil:(zu=La.depthStencil,Is=!1,zs=!1))}var fo=null,Mu=null,ya=null,eo=null;if(Array.isArray(io))fo=io.map(ri);else if(io)fo=[ri(io)];else for(fo=new Array(su),Sa=0;Sa<su;++Sa)fo[Sa]=Gr(Da,oo,Au,Xo,Qs);J(Ue.webgl_draw_buffers||fo.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),J(fo.length<=dr.maxColorAttachments,"too many color attachments, not supported"),Da=Da||fo[0].width,oo=oo||fo[0].height,Tu?Mu=ri(Tu):Is&&!zs&&(Mu=Gr(Da,oo,Jo,"depth","uint32")),Js?ya=ri(Js):zs&&!Is&&(ya=Gr(Da,oo,!1,"stencil","uint8")),zu?eo=ri(zu):!Tu&&!Js&&zs&&Is&&(eo=Gr(Da,oo,Jo,"depth stencil","depth stencil")),J(!!Tu+!!Js+!!zu<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Eo=null;for(Sa=0;Sa<fo.length;++Sa)if(yi(fo[Sa],Da,oo),J(!fo[Sa]||fo[Sa].texture&&zp.indexOf(fo[Sa].texture._texture.format)>=0||fo[Sa].renderbuffer&&De.indexOf(fo[Sa].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Sa+" is invalid"),fo[Sa]&&fo[Sa].texture){var So=Yc[fo[Sa].texture._texture.format]*x[fo[Sa].texture._texture.type];Eo===null?Eo=So:J(Eo===So,"all color attachments much have the same number of bits per pixel.")}return yi(Mu,Da,oo),J(!Mu||Mu.texture&&Mu.texture._texture.format===pc||Mu.renderbuffer&&Mu.renderbuffer._renderbuffer.format===z,"invalid depth attachment for framebuffer object"),yi(ya,Da,oo),J(!ya||ya.renderbuffer&&ya.renderbuffer._renderbuffer.format===H,"invalid stencil attachment for framebuffer object"),yi(eo,Da,oo),J(!eo||eo.texture&&eo.texture._texture.format===$||eo.renderbuffer&&eo.renderbuffer._renderbuffer.format===$,"invalid depth-stencil attachment for framebuffer object"),Ti(Mi),Mi.width=Da,Mi.height=oo,Mi.colorAttachments=fo,Mi.depthAttachment=Mu,Mi.stencilAttachment=ya,Mi.depthStencilAttachment=eo,Ua.color=fo.map(dn),Ua.depth=dn(Mu),Ua.stencil=dn(ya),Ua.depthStencil=dn(eo),Ua.width=Mi.width,Ua.height=Mi.height,_n(Mi),Ua}function Yn(Ii,Li){J(En.next!==Mi,"can not resize a framebuffer which is currently in use");var Sa=Math.max(Ii|0,1),Da=Math.max(Li|0||Sa,1);if(Sa===Mi.width&&Da===Mi.height)return Ua;for(var oo=Mi.colorAttachments,Is=0;Is<oo.length;++Is)Xn(oo[Is],Sa,Da);return Xn(Mi.depthAttachment,Sa,Da),Xn(Mi.stencilAttachment,Sa,Da),Xn(Mi.depthStencilAttachment,Sa,Da),Mi.width=Ua.width=Sa,Mi.height=Ua.height=Da,_n(Mi),Ua}return Ua(ti,xi),I(Ua,{resize:Yn,_reglType:"framebuffer",_framebuffer:Mi,destroy:function(){aa(Mi),Ti(Mi)},use:function(Ii){En.setFBO({framebuffer:Ua},Ii)}})}function oi(ti){var xi=Array(6);function Mi(Yn){var Ii;J(xi.indexOf(En.next)<0,"can not update framebuffer which is currently in use");var Li={color:null},Sa=0,Da=null,oo="rgba",Is="uint8",zs=1;if(typeof Yn=="number")Sa=Yn|0;else if(!Yn)Sa=1;else{J.type(Yn,"object","invalid arguments for framebuffer");var io=Yn;if("shape"in io){var Au=io.shape;J(Array.isArray(Au)&&Au.length>=2,"invalid shape for framebuffer"),J(Au[0]===Au[1],"cube framebuffer must be square"),Sa=Au[0]}else"radius"in io&&(Sa=io.radius|0),"width"in io?(Sa=io.width|0,"height"in io&&J(io.height===Sa,"must be square")):"height"in io&&(Sa=io.height|0);("color"in io||"colors"in io)&&(Da=io.color||io.colors,Array.isArray(Da)&&J(Da.length===1||Ue.webgl_draw_buffers,"multiple render targets not supported")),Da||("colorCount"in io&&(zs=io.colorCount|0,J(zs>0,"invalid color buffer count")),"colorType"in io&&(J.oneOf(io.colorType,Jn,"invalid color type"),Is=io.colorType),"colorFormat"in io&&(oo=io.colorFormat,J.oneOf(io.colorFormat,Dn,"invalid color format for texture"))),"depth"in io&&(Li.depth=io.depth),"stencil"in io&&(Li.stencil=io.stencil),"depthStencil"in io&&(Li.depthStencil=io.depthStencil)}var Xo;if(Da)if(Array.isArray(Da))for(Xo=[],Ii=0;Ii<Da.length;++Ii)Xo[Ii]=Da[Ii];else Xo=[Da];else{Xo=Array(zs);var Qs={radius:Sa,format:oo,type:Is};for(Ii=0;Ii<zs;++Ii)Xo[Ii]=cn.createCube(Qs)}for(Li.color=Array(Xo.length),Ii=0;Ii<Xo.length;++Ii){var su=Xo[Ii];J(typeof su=="function"&&su._reglType==="textureCube","invalid cube map"),Sa=Sa||su.width,J(su.width===Sa&&su.height===Sa,"invalid cube map shape"),Li.color[Ii]={target:Ms,data:Xo[Ii]}}for(Ii=0;Ii<6;++Ii){for(var Tu=0;Tu<Xo.length;++Tu)Li.color[Tu].target=Ms+Ii;Ii>0&&(Li.depth=xi[0].depth,Li.stencil=xi[0].stencil,Li.depthStencil=xi[0].depthStencil),xi[Ii]?xi[Ii](Li):xi[Ii]=An(Li)}return I(Mi,{width:Sa,height:Sa,color:Xo})}function Ua(Yn){var Ii,Li=Yn|0;if(J(Li>0&&Li<=dr.maxCubeMapSize,"invalid radius for cube fbo"),Li===Mi.width)return Mi;var Sa=Mi.color;for(Ii=0;Ii<Sa.length;++Ii)Sa[Ii].resize(Li);for(Ii=0;Ii<6;++Ii)xi[Ii].resize(Li);return Mi.width=Mi.height=Li,Mi}return Mi(ti),I(Mi,{faces:xi,resize:Ua,_reglType:"framebufferCube",destroy:function(){xi.forEach(function(Yn){Yn.destroy()})}})}function Ei(){En.cur=null,En.next=null,En.dirty=!0,Ie(Rn).forEach(function(ti){ti.framebuffer=It.createFramebuffer(),_n(ti)})}return I(En,{getFramebuffer:function(ti){if(typeof ti=="function"&&ti._reglType==="framebuffer"){var xi=ti._framebuffer;if(xi instanceof Qn)return xi}return null},create:An,createCube:oi,clear:function(){Ie(Rn).forEach(aa)},restore:Ei})}var ar=5126,br=34962,rr=34963,xr=["attributes","elements","offset","count","primitive","instances"];function Pr(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ar,this.offset=0,this.stride=0,this.divisor=0}function Rr(It,Ue,dr,cn,On,on,En){for(var Dn=dr.maxAttributes,Hn=new Array(Dn),Jn=0;Jn<Dn;++Jn)Hn[Jn]=new Pr;var ii=0,ui={},yi={Record:Pr,scope:{},state:Hn,currentVAO:null,targetVAO:null,restore:ri()?Ti:function(){},createVAO:aa,getVAO:dn,destroyBuffer:qn,setVAO:ri()?Xn:vi,clear:ri()?Rn:function(){}};function qn(_n){for(var An=0;An<Hn.length;++An){var oi=Hn[An];oi.buffer===_n&&(It.disableVertexAttribArray(An),oi.buffer=null)}}function ri(){return Ue.oes_vertex_array_object}function Gr(){return Ue.angle_instanced_arrays}function dn(_n){return typeof _n=="function"&&_n._vao?_n._vao:null}function Xn(_n){if(_n!==yi.currentVAO){var An=ri();_n?An.bindVertexArrayOES(_n.vao):An.bindVertexArrayOES(null),yi.currentVAO=_n}}function vi(_n){if(_n!==yi.currentVAO){if(_n)_n.bindAttrs();else{for(var An=Gr(),oi=0;oi<Hn.length;++oi){var Ei=Hn[oi];Ei.buffer?(It.enableVertexAttribArray(oi),Ei.buffer.bind(),It.vertexAttribPointer(oi,Ei.size,Ei.type,Ei.normalized,Ei.stride,Ei.offfset),An&&Ei.divisor&&An.vertexAttribDivisorANGLE(oi,Ei.divisor)):(It.disableVertexAttribArray(oi),It.vertexAttrib4f(oi,Ei.x,Ei.y,Ei.z,Ei.w))}En.elements?It.bindBuffer(rr,En.elements.buffer.buffer):It.bindBuffer(rr,null)}yi.currentVAO=_n}}function Rn(){Ie(ui).forEach(function(_n){_n.destroy()})}function Qn(){this.id=++ii,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var _n=ri();_n?this.vao=_n.createVertexArrayOES():this.vao=null,ui[this.id]=this,this.buffers=[]}Qn.prototype.bindAttrs=function(){for(var _n=Gr(),An=this.attributes,oi=0;oi<An.length;++oi){var Ei=An[oi];Ei.buffer?(It.enableVertexAttribArray(oi),It.bindBuffer(br,Ei.buffer.buffer),It.vertexAttribPointer(oi,Ei.size,Ei.type,Ei.normalized,Ei.stride,Ei.offset),_n&&Ei.divisor&&_n.vertexAttribDivisorANGLE(oi,Ei.divisor)):(It.disableVertexAttribArray(oi),It.vertexAttrib4f(oi,Ei.x,Ei.y,Ei.z,Ei.w))}for(var ti=An.length;ti<Dn;++ti)It.disableVertexAttribArray(ti);var xi=on.getElements(this.elements);xi?It.bindBuffer(rr,xi.buffer.buffer):It.bindBuffer(rr,null)},Qn.prototype.refresh=function(){var _n=ri();_n&&(_n.bindVertexArrayOES(this.vao),this.bindAttrs(),yi.currentVAO=null,_n.bindVertexArrayOES(null))},Qn.prototype.destroy=function(){if(this.vao){var _n=ri();this===yi.currentVAO&&(yi.currentVAO=null,_n.bindVertexArrayOES(null)),_n.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ui[this.id]&&(delete ui[this.id],cn.vaoCount-=1)};function Ti(){var _n=ri();_n&&Ie(ui).forEach(function(An){An.refresh()})}function aa(_n){var An=new Qn;cn.vaoCount+=1;function oi(Ei){var ti;if(Array.isArray(Ei))ti=Ei,An.elements&&An.ownsElements&&An.elements.destroy(),An.elements=null,An.ownsElements=!1,An.offset=0,An.count=0,An.instances=-1,An.primitive=4;else{if(J(typeof Ei=="object","invalid arguments for create vao"),J("attributes"in Ei,"must specify attributes for vao"),Ei.elements){var xi=Ei.elements;An.ownsElements?typeof xi=="function"&&xi._reglType==="elements"?(An.elements.destroy(),An.ownsElements=!1):(An.elements(xi),An.ownsElements=!1):on.getElements(Ei.elements)?(An.elements=Ei.elements,An.ownsElements=!1):(An.elements=on.create(Ei.elements),An.ownsElements=!0)}else An.elements=null,An.ownsElements=!1;ti=Ei.attributes,An.offset=0,An.count=-1,An.instances=-1,An.primitive=4,An.elements&&(An.count=An.elements._elements.vertCount,An.primitive=An.elements._elements.primType),"offset"in Ei&&(An.offset=Ei.offset|0),"count"in Ei&&(An.count=Ei.count|0),"instances"in Ei&&(An.instances=Ei.instances|0),"primitive"in Ei&&(J(Ei.primitive in Ln,"bad primitive type: "+Ei.primitive),An.primitive=Ln[Ei.primitive]),J.optional(function(){for(var Is=Object.keys(Ei),zs=0;zs<Is.length;++zs)J(xr.indexOf(Is[zs])>=0,'invalid option for vao: "'+Is[zs]+'" valid options are '+xr)}),J(Array.isArray(ti),"attributes must be an array")}J(ti.length<Dn,"too many attributes"),J(ti.length>0,"must specify at least one attribute");var Mi={},Ua=An.attributes;Ua.length=ti.length;for(var Yn=0;Yn<ti.length;++Yn){var Ii=ti[Yn],Li=Ua[Yn]=new Pr,Sa=Ii.data||Ii;if(Array.isArray(Sa)||bt(Sa)||Wu(Sa)){var Da;An.buffers[Yn]&&(Da=An.buffers[Yn],bt(Sa)&&Da._buffer.byteLength>=Sa.byteLength?Da.subdata(Sa):(Da.destroy(),An.buffers[Yn]=null)),An.buffers[Yn]||(Da=An.buffers[Yn]=On.create(Ii,br,!1,!0)),Li.buffer=On.getBuffer(Da),Li.size=Li.buffer.dimension|0,Li.normalized=!1,Li.type=Li.buffer.dtype,Li.offset=0,Li.stride=0,Li.divisor=0,Li.state=1,Mi[Yn]=1}else On.getBuffer(Ii)?(Li.buffer=On.getBuffer(Ii),Li.size=Li.buffer.dimension|0,Li.normalized=!1,Li.type=Li.buffer.dtype,Li.offset=0,Li.stride=0,Li.divisor=0,Li.state=1):On.getBuffer(Ii.buffer)?(Li.buffer=On.getBuffer(Ii.buffer),Li.size=(+Ii.size||Li.buffer.dimension)|0,Li.normalized=!!Ii.normalized||!1,"type"in Ii?(J.parameter(Ii.type,dl,"invalid buffer type"),Li.type=dl[Ii.type]):Li.type=Li.buffer.dtype,Li.offset=(Ii.offset||0)|0,Li.stride=(Ii.stride||0)|0,Li.divisor=(Ii.divisor||0)|0,Li.state=1,J(Li.size>=1&&Li.size<=4,"size must be between 1 and 4"),J(Li.offset>=0,"invalid offset"),J(Li.stride>=0&&Li.stride<=255,"stride must be between 0 and 255"),J(Li.divisor>=0,"divisor must be positive"),J(!Li.divisor||!!Ue.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Ii?(J(Yn>0,"first attribute must not be a constant"),Li.x=+Ii.x||0,Li.y=+Ii.y||0,Li.z=+Ii.z||0,Li.w=+Ii.w||0,Li.state=2):J(!1,"invalid attribute spec for location "+Yn)}for(var oo=0;oo<An.buffers.length;++oo)!Mi[oo]&&An.buffers[oo]&&(An.buffers[oo].destroy(),An.buffers[oo]=null);return An.refresh(),oi}return oi.destroy=function(){for(var Ei=0;Ei<An.buffers.length;++Ei)An.buffers[Ei]&&An.buffers[Ei].destroy();An.buffers.length=0,An.ownsElements&&(An.elements.destroy(),An.elements=null,An.ownsElements=!1),An.destroy()},oi._vao=An,oi._reglType="vao",oi(_n)}return yi}var vn=35632,ln=35633,bn=35718,Zn=35721;function Kn(It,Ue,dr,cn){var On={},on={};function En(Gr,dn,Xn,vi){this.name=Gr,this.id=dn,this.location=Xn,this.info=vi}function Dn(Gr,dn){for(var Xn=0;Xn<Gr.length;++Xn)if(Gr[Xn].id===dn.id){Gr[Xn].location=dn.location;return}Gr.push(dn)}function Hn(Gr,dn,Xn){var vi=Gr===vn?On:on,Rn=vi[dn];if(!Rn){var Qn=Ue.str(dn);Rn=It.createShader(Gr),It.shaderSource(Rn,Qn),It.compileShader(Rn),J.shaderError(It,Rn,Qn,Gr,Xn),vi[dn]=Rn}return Rn}var Jn={},ii=[],ui=0;function yi(Gr,dn){this.id=ui++,this.fragId=Gr,this.vertId=dn,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,cn.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function qn(Gr,dn,Xn){var vi,Rn,Qn=Hn(vn,Gr.fragId),Ti=Hn(ln,Gr.vertId),aa=Gr.program=It.createProgram();if(It.attachShader(aa,Qn),It.attachShader(aa,Ti),Xn)for(vi=0;vi<Xn.length;++vi){var _n=Xn[vi];It.bindAttribLocation(aa,_n[0],_n[1])}It.linkProgram(aa),J.linkError(It,aa,Ue.str(Gr.fragId),Ue.str(Gr.vertId),dn);var An=It.getProgramParameter(aa,bn);cn.profile&&(Gr.stats.uniformsCount=An);var oi=Gr.uniforms;for(vi=0;vi<An;++vi)if(Rn=It.getActiveUniform(aa,vi),Rn)if(Rn.size>1)for(var Ei=0;Ei<Rn.size;++Ei){var ti=Rn.name.replace("[0]","["+Ei+"]");Dn(oi,new En(ti,Ue.id(ti),It.getUniformLocation(aa,ti),Rn))}else Dn(oi,new En(Rn.name,Ue.id(Rn.name),It.getUniformLocation(aa,Rn.name),Rn));var xi=It.getProgramParameter(aa,Zn);cn.profile&&(Gr.stats.attributesCount=xi);var Mi=Gr.attributes;for(vi=0;vi<xi;++vi)Rn=It.getActiveAttrib(aa,vi),Rn&&Dn(Mi,new En(Rn.name,Ue.id(Rn.name),It.getAttribLocation(aa,Rn.name),Rn))}cn.profile&&(dr.getMaxUniformsCount=function(){var Gr=0;return ii.forEach(function(dn){dn.stats.uniformsCount>Gr&&(Gr=dn.stats.uniformsCount)}),Gr},dr.getMaxAttributesCount=function(){var Gr=0;return ii.forEach(function(dn){dn.stats.attributesCount>Gr&&(Gr=dn.stats.attributesCount)}),Gr});function ri(){On={},on={};for(var Gr=0;Gr<ii.length;++Gr)qn(ii[Gr],null,ii[Gr].attributes.map(function(dn){return[dn.location,dn.name]}))}return{clear:function(){var Gr=It.deleteShader.bind(It);Ie(On).forEach(Gr),On={},Ie(on).forEach(Gr),on={},ii.forEach(function(dn){It.deleteProgram(dn.program)}),ii.length=0,Jn={},dr.shaderCount=0},program:function(Gr,dn,Xn,vi){J.command(Gr>=0,"missing vertex shader",Xn),J.command(dn>=0,"missing fragment shader",Xn);var Rn=Jn[dn];Rn||(Rn=Jn[dn]={});var Qn=Rn[Gr];if(Qn&&(Qn.refCount++,!vi))return Qn;var Ti=new yi(dn,Gr);return dr.shaderCount++,qn(Ti,Xn,vi),Qn||(Rn[Gr]=Ti),ii.push(Ti),I(Ti,{destroy:function(){if(Ti.refCount--,Ti.refCount<=0){It.deleteProgram(Ti.program);var aa=ii.indexOf(Ti);ii.splice(aa,1),dr.shaderCount--}Rn[Ti.vertId].refCount<=0&&(It.deleteShader(on[Ti.vertId]),delete on[Ti.vertId],delete Jn[Ti.fragId][Ti.vertId]),Object.keys(Jn[Ti.fragId]).length||(It.deleteShader(On[Ti.fragId]),delete On[Ti.fragId],delete Jn[Ti.fragId])}})},restore:ri,shader:Hn,frag:-1,vert:-1}}var ci=6408,Oi=5121,na=3333,ia=5126;function ua(It,Ue,dr,cn,On,on,En){function Dn(ii){var ui;Ue.next===null?(J(On.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),ui=Oi):(J(Ue.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),ui=Ue.next.colorAttachments[0].texture._texture.type,J.optional(function(){on.oes_texture_float?(J(ui===Oi||ui===ia,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),ui===ia&&J(En.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):J(ui===Oi,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var yi=0,qn=0,ri=cn.framebufferWidth,Gr=cn.framebufferHeight,dn=null;bt(ii)?dn=ii:ii&&(J.type(ii,"object","invalid arguments to regl.read()"),yi=ii.x|0,qn=ii.y|0,J(yi>=0&&yi<cn.framebufferWidth,"invalid x offset for regl.read"),J(qn>=0&&qn<cn.framebufferHeight,"invalid y offset for regl.read"),ri=(ii.width||cn.framebufferWidth-yi)|0,Gr=(ii.height||cn.framebufferHeight-qn)|0,dn=ii.data||null),dn&&(ui===Oi?J(dn instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):ui===ia&&J(dn instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),J(ri>0&&ri+yi<=cn.framebufferWidth,"invalid width for read pixels"),J(Gr>0&&Gr+qn<=cn.framebufferHeight,"invalid height for read pixels"),dr();var Xn=ri*Gr*4;return dn||(ui===Oi?dn=new Uint8Array(Xn):ui===ia&&(dn=dn||new Float32Array(Xn))),J.isTypedArray(dn,"data buffer for regl.read() must be a typedarray"),J(dn.byteLength>=Xn,"data buffer for regl.read() too small"),It.pixelStorei(na,4),It.readPixels(yi,qn,ri,Gr,ci,ui,dn),dn}function Hn(ii){var ui;return Ue.setFBO({framebuffer:ii.framebuffer},function(){ui=Dn(ii)}),ui}function Jn(ii){return!ii||!("framebuffer"in ii)?Dn(ii):Hn(ii)}return Jn}function Qa(It){return Array.prototype.slice.call(It)}function Fi(It){return Qa(It).join("")}function Ra(){var It=0,Ue=[],dr=[];function cn(ui){for(var yi=0;yi<dr.length;++yi)if(dr[yi]===ui)return Ue[yi];var qn="g"+It++;return Ue.push(qn),dr.push(ui),qn}function On(){var ui=[];function yi(){ui.push.apply(ui,Qa(arguments))}var qn=[];function ri(){var Gr="v"+It++;return qn.push(Gr),arguments.length>0&&(ui.push(Gr,"="),ui.push.apply(ui,Qa(arguments)),ui.push(";")),Gr}return I(yi,{def:ri,toString:function(){return Fi([qn.length>0?"var "+qn.join(",")+";":"",Fi(ui)])}})}function on(){var ui=On(),yi=On(),qn=ui.toString,ri=yi.toString;function Gr(dn,Xn){yi(dn,Xn,"=",ui.def(dn,Xn),";")}return I(function(){ui.apply(ui,Qa(arguments))},{def:ui.def,entry:ui,exit:yi,save:Gr,set:function(dn,Xn,vi){Gr(dn,Xn),ui(dn,Xn,"=",vi,";")},toString:function(){return qn()+ri()}})}function En(){var ui=Fi(arguments),yi=on(),qn=on(),ri=yi.toString,Gr=qn.toString;return I(yi,{then:function(){return yi.apply(yi,Qa(arguments)),this},else:function(){return qn.apply(qn,Qa(arguments)),this},toString:function(){var dn=Gr();return dn&&(dn="else{"+dn+"}"),Fi(["if(",ui,"){",ri(),"}",dn])}})}var Dn=On(),Hn={};function Jn(ui,yi){var qn=[];function ri(){var Rn="a"+qn.length;return qn.push(Rn),Rn}yi=yi||0;for(var Gr=0;Gr<yi;++Gr)ri();var dn=on(),Xn=dn.toString,vi=Hn[ui]=I(dn,{arg:ri,toString:function(){return Fi(["function(",qn.join(),"){",Xn(),"}"])}});return vi}function ii(){var ui=['"use strict";',Dn,"return {"];Object.keys(Hn).forEach(function(Gr){ui.push('"',Gr,'":',Hn[Gr].toString(),",")}),ui.push("}");var yi=Fi(ui).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),qn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ri=qn?kt.Function.apply(null,Ue.concat(yi)):Function.apply(null,Ue.concat(yi));return ri.apply(null,dr)}return{global:Dn,link:cn,block:On,proc:Jn,scope:on,cond:En,compile:ii}}var Aa="xyzw".split(""),ka=5121,la=1,Na=2,pa=0,da=1,Ds=2,ss=3,ou=4,Ks=5,ls=6,cs="dither",vu="blend.enable",Du="blend.color",kc="blend.equation",qu="blend.func",Kl="depth.enable",cl="depth.func",yh="depth.range",El="depth.mask",Ql="colorMask",_h="cull.enable",Yf="cull.face",dc="frontFace",xh="lineWidth",Jl="polygonOffset.enable",js="polygonOffset.offset",$c="sample.alpha",Tf="sample.enable",vc="sample.coverage",Lo="stencil.enable",Sl="stencil.mask",Ku="stencil.func",qc="stencil.opFront",Kc="stencil.opBack",$f="scissor.enable",Qc="scissor.box",Bu="viewport",bh="profile",tc="framebuffer",Jc="vert",Eh="frag",kl="elements",Cu="primitive",sp="count",wd="offset",uv="instances",lv="vao",G0="Width",Up="Height",Lc=tc+G0,tf=tc+Up,Sh=Bu+G0,cv=Bu+Up,wl="drawingBuffer",ei=wl+G0,Cd=wl+Up,Gm=[qu,kc,Ku,qc,Kc,vc,Bu,Qc,js],Bs=34962,Mf=34963,Zp=35632,ef=35633,Cl=3553,Pc=34067,Vp=2884,wh=3042,fv=3024,Ns=2960,qf=2929,Ad=3089,gc=32823,hv=32926,Td=32928,pv=5126,Md=35664,Kf=35665,up=35666,Id=5124,Gp=35667,Qf=35668,dv=35669,rf=35670,vv=35671,nf=35672,Hp=35673,Ul=35674,kd=35675,Ld=35676,Pd=35678,jp=35680,af=4,ec=1028,Wp=1029,H0=2304,Qv=2305,If=32775,mc=32776,j0=519,rc=7680,Od=0,Jv=1,of=32774,sf=513,Fd=36160,t0=36064,nc={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Rd=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Ch={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ah={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},e0={frag:Zp,vert:ef},r0={cw:H0,ccw:Qv};function lp(It){return Array.isArray(It)||bt(It)||Wu(It)}function Dd(It){return It.sort(function(Ue,dr){return Ue===Bu?-1:dr===Bu?1:Ue<dr?-1:1})}function Ro(It,Ue,dr,cn){this.thisDep=It,this.contextDep=Ue,this.propDep=dr,this.append=cn}function kf(It){return It&&!(It.thisDep||It.contextDep||It.propDep)}function co(It){return new Ro(!1,!1,!1,It)}function gu(It,Ue){var dr=It.type;if(dr===pa){var cn=It.data.length;return new Ro(!0,cn>=1,cn>=2,Ue)}else if(dr===ou){var On=It.data;return new Ro(On.thisDep,On.contextDep,On.propDep,Ue)}else{if(dr===Ks)return new Ro(!1,!1,!1,Ue);if(dr===ls){for(var on=!1,En=!1,Dn=!1,Hn=0;Hn<It.data.length;++Hn){var Jn=It.data[Hn];if(Jn.type===da)Dn=!0;else if(Jn.type===Ds)En=!0;else if(Jn.type===ss)on=!0;else if(Jn.type===pa){on=!0;var ii=Jn.data;ii>=1&&(En=!0),ii>=2&&(Dn=!0)}else Jn.type===ou&&(on=on||Jn.data.thisDep,En=En||Jn.data.contextDep,Dn=Dn||Jn.data.propDep)}return new Ro(on,En,Dn,Ue)}else return new Ro(dr===ss,dr===Ds,dr===da,Ue)}}var W0=new Ro(!1,!1,!1,function(){});function Xp(It,Ue,dr,cn,On,on,En,Dn,Hn,Jn,ii,ui,yi,qn,ri){var Gr=Jn.Record,dn={add:32774,subtract:32778,"reverse subtract":32779};dr.ext_blend_minmax&&(dn.min=If,dn.max=mc);var Xn=dr.angle_instanced_arrays,vi=dr.webgl_draw_buffers,Rn=dr.oes_vertex_array_object,Qn={dirty:!0,profile:ri.profile},Ti={},aa=[],_n={},An={};function oi($e){return $e.replace(".","_")}function Ei($e,Fe,yr){var Xr=oi($e);aa.push($e),Ti[Xr]=Qn[Xr]=!!yr,_n[Xr]=Fe}function ti($e,Fe,yr){var Xr=oi($e);aa.push($e),Array.isArray(yr)?(Qn[Xr]=yr.slice(),Ti[Xr]=yr.slice()):Qn[Xr]=Ti[Xr]=yr,An[Xr]=Fe}Ei(cs,fv),Ei(vu,wh),ti(Du,"blendColor",[0,0,0,0]),ti(kc,"blendEquationSeparate",[of,of]),ti(qu,"blendFuncSeparate",[Jv,Od,Jv,Od]),Ei(Kl,qf,!0),ti(cl,"depthFunc",sf),ti(yh,"depthRange",[0,1]),ti(El,"depthMask",!0),ti(Ql,Ql,[!0,!0,!0,!0]),Ei(_h,Vp),ti(Yf,"cullFace",Wp),ti(dc,dc,Qv),ti(xh,xh,1),Ei(Jl,gc),ti(js,"polygonOffset",[0,0]),Ei($c,hv),Ei(Tf,Td),ti(vc,"sampleCoverage",[1,!1]),Ei(Lo,Ns),ti(Sl,"stencilMask",-1),ti(Ku,"stencilFunc",[j0,0,-1]),ti(qc,"stencilOpSeparate",[ec,rc,rc,rc]),ti(Kc,"stencilOpSeparate",[Wp,rc,rc,rc]),Ei($f,Ad),ti(Qc,"scissor",[0,0,It.drawingBufferWidth,It.drawingBufferHeight]),ti(Bu,Bu,[0,0,It.drawingBufferWidth,It.drawingBufferHeight]);var xi={gl:It,context:yi,strings:Ue,next:Ti,current:Qn,draw:ui,elements:on,buffer:On,shader:ii,attributes:Jn.state,vao:Jn,uniforms:Hn,framebuffer:Dn,extensions:dr,timer:qn,isBufferArgs:lp},Mi={primTypes:Ln,compareFuncs:Ch,blendFuncs:nc,blendEquations:dn,stencilOps:Ah,glTypes:dl,orientationType:r0};J.optional(function(){xi.isArrayLike=ir}),vi&&(Mi.backBuffer=[Wp],Mi.drawBuffer=fr(cn.maxDrawbuffers,function($e){return $e===0?[0]:fr($e,function(Fe){return t0+Fe})}));var Ua=0;function Yn(){var $e=Ra(),Fe=$e.link,yr=$e.global;$e.id=Ua++,$e.batchId="0";var Xr=Fe(xi),sn=$e.shared={props:"a0"};Object.keys(xi).forEach(function(vr){sn[vr]=yr.def(Xr,".",vr)}),J.optional(function(){$e.CHECK=Fe(J),$e.commandStr=J.guessCommand(),$e.command=Fe($e.commandStr),$e.assert=function(vr,Qe,Hr){vr("if(!(",Qe,"))",this.CHECK,".commandRaise(",Fe(Hr),",",this.command,");")},Mi.invalidBlendCombinations=Rd});var mr=$e.next={},pr=$e.current={};Object.keys(An).forEach(function(vr){Array.isArray(Qn[vr])&&(mr[vr]=yr.def(sn.next,".",vr),pr[vr]=yr.def(sn.current,".",vr))});var kr=$e.constants={};Object.keys(Mi).forEach(function(vr){kr[vr]=yr.def(JSON.stringify(Mi[vr]))}),$e.invoke=function(vr,Qe){switch(Qe.type){case pa:var Hr=["this",sn.context,sn.props,$e.batchId];return vr.def(Fe(Qe.data),".call(",Hr.slice(0,Math.max(Qe.data.length+1,4)),")");case da:return vr.def(sn.props,Qe.data);case Ds:return vr.def(sn.context,Qe.data);case ss:return vr.def("this",Qe.data);case ou:return Qe.data.append($e,vr),Qe.data.ref;case Ks:return Qe.data.toString();case ls:return Qe.data.map(function(Jr){return $e.invoke(vr,Jr)})}},$e.attribCache={};var Ve={};return $e.scopeAttrib=function(vr){var Qe=Ue.id(vr);if(Qe in Ve)return Ve[Qe];var Hr=Jn.scope[Qe];Hr||(Hr=Jn.scope[Qe]=new Gr);var Jr=Ve[Qe]=Fe(Hr);return Jr},$e}function Ii($e){var Fe=$e.static,yr=$e.dynamic,Xr;if(bh in Fe){var sn=!!Fe[bh];Xr=co(function(pr,kr){return sn}),Xr.enable=sn}else if(bh in yr){var mr=yr[bh];Xr=gu(mr,function(pr,kr){return pr.invoke(kr,mr)})}return Xr}function Li($e,Fe){var yr=$e.static,Xr=$e.dynamic;if(tc in yr){var sn=yr[tc];return sn?(sn=Dn.getFramebuffer(sn),J.command(sn,"invalid framebuffer object"),co(function(pr,kr){var Ve=pr.link(sn),vr=pr.shared;kr.set(vr.framebuffer,".next",Ve);var Qe=vr.context;return kr.set(Qe,"."+Lc,Ve+".width"),kr.set(Qe,"."+tf,Ve+".height"),Ve})):co(function(pr,kr){var Ve=pr.shared;kr.set(Ve.framebuffer,".next","null");var vr=Ve.context;return kr.set(vr,"."+Lc,vr+"."+ei),kr.set(vr,"."+tf,vr+"."+Cd),"null"})}else if(tc in Xr){var mr=Xr[tc];return gu(mr,function(pr,kr){var Ve=pr.invoke(kr,mr),vr=pr.shared,Qe=vr.framebuffer,Hr=kr.def(Qe,".getFramebuffer(",Ve,")");J.optional(function(){pr.assert(kr,"!"+Ve+"||"+Hr,"invalid framebuffer object")}),kr.set(Qe,".next",Hr);var Jr=vr.context;return kr.set(Jr,"."+Lc,Hr+"?"+Hr+".width:"+Jr+"."+ei),kr.set(Jr,"."+tf,Hr+"?"+Hr+".height:"+Jr+"."+Cd),Hr})}else return null}function Sa($e,Fe,yr){var Xr=$e.static,sn=$e.dynamic;function mr(Ve){if(Ve in Xr){var vr=Xr[Ve];J.commandType(vr,"object","invalid "+Ve,yr.commandStr);var Qe=!0,Hr=vr.x|0,Jr=vr.y|0,Bn,gi;return"width"in vr?(Bn=vr.width|0,J.command(Bn>=0,"invalid "+Ve,yr.commandStr)):Qe=!1,"height"in vr?(gi=vr.height|0,J.command(gi>=0,"invalid "+Ve,yr.commandStr)):Qe=!1,new Ro(!Qe&&Fe&&Fe.thisDep,!Qe&&Fe&&Fe.contextDep,!Qe&&Fe&&Fe.propDep,function(fi,Xi){var Pi=fi.shared.context,Gi=Bn;"width"in vr||(Gi=Xi.def(Pi,".",Lc,"-",Hr));var kn=gi;return"height"in vr||(kn=Xi.def(Pi,".",tf,"-",Jr)),[Hr,Jr,Gi,kn]})}else if(Ve in sn){var mi=sn[Ve],pi=gu(mi,function(fi,Xi){var Pi=fi.invoke(Xi,mi);J.optional(function(){fi.assert(Xi,Pi+"&&typeof "+Pi+'==="object"',"invalid "+Ve)});var Gi=fi.shared.context,kn=Xi.def(Pi,".x|0"),Ni=Xi.def(Pi,".y|0"),Ea=Xi.def('"width" in ',Pi,"?",Pi,".width|0:","(",Gi,".",Lc,"-",kn,")"),jo=Xi.def('"height" in ',Pi,"?",Pi,".height|0:","(",Gi,".",tf,"-",Ni,")");return J.optional(function(){fi.assert(Xi,Ea+">=0&&"+jo+">=0","invalid "+Ve)}),[kn,Ni,Ea,jo]});return Fe&&(pi.thisDep=pi.thisDep||Fe.thisDep,pi.contextDep=pi.contextDep||Fe.contextDep,pi.propDep=pi.propDep||Fe.propDep),pi}else return Fe?new Ro(Fe.thisDep,Fe.contextDep,Fe.propDep,function(fi,Xi){var Pi=fi.shared.context;return[0,0,Xi.def(Pi,".",Lc),Xi.def(Pi,".",tf)]}):null}var pr=mr(Bu);if(pr){var kr=pr;pr=new Ro(pr.thisDep,pr.contextDep,pr.propDep,function(Ve,vr){var Qe=kr.append(Ve,vr),Hr=Ve.shared.context;return vr.set(Hr,"."+Sh,Qe[2]),vr.set(Hr,"."+cv,Qe[3]),Qe})}return{viewport:pr,scissor_box:mr(Qc)}}function Da($e,Fe){var yr=$e.static,Xr=typeof yr[Eh]=="string"&&typeof yr[Jc]=="string";if(Xr){if(Object.keys(Fe.dynamic).length>0)return null;var sn=Fe.static,mr=Object.keys(sn);if(mr.length>0&&typeof sn[mr[0]]=="number"){for(var pr=[],kr=0;kr<mr.length;++kr)J(typeof sn[mr[kr]]=="number","must specify all vertex attribute locations when using vaos"),pr.push([sn[mr[kr]]|0,mr[kr]]);return pr}}return null}function oo($e,Fe,yr){var Xr=$e.static,sn=$e.dynamic;function mr(Qe){if(Qe in Xr){var Hr=Ue.id(Xr[Qe]);J.optional(function(){ii.shader(e0[Qe],Hr,J.guessCommand())});var Jr=co(function(){return Hr});return Jr.id=Hr,Jr}else if(Qe in sn){var Bn=sn[Qe];return gu(Bn,function(gi,mi){var pi=gi.invoke(mi,Bn),fi=mi.def(gi.shared.strings,".id(",pi,")");return J.optional(function(){mi(gi.shared.shader,".shader(",e0[Qe],",",fi,",",gi.command,");")}),fi})}return null}var pr=mr(Eh),kr=mr(Jc),Ve=null,vr;return kf(pr)&&kf(kr)?(Ve=ii.program(kr.id,pr.id,null,yr),vr=co(function(Qe,Hr){return Qe.link(Ve)})):vr=new Ro(pr&&pr.thisDep||kr&&kr.thisDep,pr&&pr.contextDep||kr&&kr.contextDep,pr&&pr.propDep||kr&&kr.propDep,function(Qe,Hr){var Jr=Qe.shared.shader,Bn;pr?Bn=pr.append(Qe,Hr):Bn=Hr.def(Jr,".",Eh);var gi;kr?gi=kr.append(Qe,Hr):gi=Hr.def(Jr,".",Jc);var mi=Jr+".program("+gi+","+Bn;return J.optional(function(){mi+=","+Qe.command}),Hr.def(mi+")")}),{frag:pr,vert:kr,progVar:vr,program:Ve}}function Is($e,Fe){var yr=$e.static,Xr=$e.dynamic,sn={},mr=!1;function pr(){if(lv in yr){var Xi=yr[lv];return Xi!==null&&Jn.getVAO(Xi)===null&&(Xi=Jn.createVAO(Xi)),mr=!0,sn.vao=Xi,co(function(Gi){var kn=Jn.getVAO(Xi);return kn?Gi.link(kn):"null"})}else if(lv in Xr){mr=!0;var Pi=Xr[lv];return gu(Pi,function(Gi,kn){var Ni=Gi.invoke(kn,Pi);return kn.def(Gi.shared.vao+".getVAO("+Ni+")")})}return null}var kr=pr(),Ve=!1;function vr(){if(kl in yr){var Xi=yr[kl];if(sn.elements=Xi,lp(Xi)){var Pi=sn.elements=on.create(Xi,!0);Xi=on.getElements(Pi),Ve=!0}else Xi&&(Xi=on.getElements(Xi),Ve=!0,J.command(Xi,"invalid elements",Fe.commandStr));var Gi=co(function(Ni,Ea){if(Xi){var jo=Ni.link(Xi);return Ni.ELEMENTS=jo,jo}return Ni.ELEMENTS=null,null});return Gi.value=Xi,Gi}else if(kl in Xr){Ve=!0;var kn=Xr[kl];return gu(kn,function(Ni,Ea){var jo=Ni.shared,Iu=jo.isBufferArgs,_a=jo.elements,mo=Ni.invoke(Ea,kn),Oc=Ea.def("null"),Al=Ea.def(Iu,"(",mo,")"),lf=Ni.cond(Al).then(Oc,"=",_a,".createStream(",mo,");").else(Oc,"=",_a,".getElements(",mo,");");return J.optional(function(){Ni.assert(lf.else,"!"+mo+"||"+Oc,"invalid elements")}),Ea.entry(lf),Ea.exit(Ni.cond(Al).then(_a,".destroyStream(",Oc,");")),Ni.ELEMENTS=Oc,Oc})}else if(mr)return new Ro(kr.thisDep,kr.contextDep,kr.propDep,function(Ni,Ea){return Ea.def(Ni.shared.vao+".currentVAO?"+Ni.shared.elements+".getElements("+Ni.shared.vao+".currentVAO.elements):null")});return null}var Qe=vr();function Hr(){if(Cu in yr){var Xi=yr[Cu];return sn.primitive=Xi,J.commandParameter(Xi,Ln,"invalid primitve",Fe.commandStr),co(function(Gi,kn){return Ln[Xi]})}else if(Cu in Xr){var Pi=Xr[Cu];return gu(Pi,function(Gi,kn){var Ni=Gi.constants.primTypes,Ea=Gi.invoke(kn,Pi);return J.optional(function(){Gi.assert(kn,Ea+" in "+Ni,"invalid primitive, must be one of "+Object.keys(Ln))}),kn.def(Ni,"[",Ea,"]")})}else{if(Ve)return kf(Qe)?Qe.value?co(function(Gi,kn){return kn.def(Gi.ELEMENTS,".primType")}):co(function(){return af}):new Ro(Qe.thisDep,Qe.contextDep,Qe.propDep,function(Gi,kn){var Ni=Gi.ELEMENTS;return kn.def(Ni,"?",Ni,".primType:",af)});if(mr)return new Ro(kr.thisDep,kr.contextDep,kr.propDep,function(Gi,kn){return kn.def(Gi.shared.vao+".currentVAO?"+Gi.shared.vao+".currentVAO.primitive:"+af)})}return null}function Jr(Xi,Pi){if(Xi in yr){var Gi=yr[Xi]|0;return Pi?sn.offset=Gi:sn.instances=Gi,J.command(!Pi||Gi>=0,"invalid "+Xi,Fe.commandStr),co(function(Ni,Ea){return Pi&&(Ni.OFFSET=Gi),Gi})}else if(Xi in Xr){var kn=Xr[Xi];return gu(kn,function(Ni,Ea){var jo=Ni.invoke(Ea,kn);return Pi&&(Ni.OFFSET=jo,J.optional(function(){Ni.assert(Ea,jo+">=0","invalid "+Xi)})),jo})}else if(Pi){if(Ve)return co(function(Ni,Ea){return Ni.OFFSET=0,0});if(mr)return new Ro(kr.thisDep,kr.contextDep,kr.propDep,function(Ni,Ea){return Ea.def(Ni.shared.vao+".currentVAO?"+Ni.shared.vao+".currentVAO.offset:0")})}else if(mr)return new Ro(kr.thisDep,kr.contextDep,kr.propDep,function(Ni,Ea){return Ea.def(Ni.shared.vao+".currentVAO?"+Ni.shared.vao+".currentVAO.instances:-1")});return null}var Bn=Jr(wd,!0);function gi(){if(sp in yr){var Xi=yr[sp]|0;return sn.count=Xi,J.command(typeof Xi=="number"&&Xi>=0,"invalid vertex count",Fe.commandStr),co(function(){return Xi})}else if(sp in Xr){var Pi=Xr[sp];return gu(Pi,function(Ea,jo){var Iu=Ea.invoke(jo,Pi);return J.optional(function(){Ea.assert(jo,"typeof "+Iu+'==="number"&&'+Iu+">=0&&"+Iu+"===("+Iu+"|0)","invalid vertex count")}),Iu})}else if(Ve)if(kf(Qe)){if(Qe)return Bn?new Ro(Bn.thisDep,Bn.contextDep,Bn.propDep,function(Ea,jo){var Iu=jo.def(Ea.ELEMENTS,".vertCount-",Ea.OFFSET);return J.optional(function(){Ea.assert(jo,Iu+">=0","invalid vertex offset/element buffer too small")}),Iu}):co(function(Ea,jo){return jo.def(Ea.ELEMENTS,".vertCount")});var Gi=co(function(){return-1});return J.optional(function(){Gi.MISSING=!0}),Gi}else{var kn=new Ro(Qe.thisDep||Bn.thisDep,Qe.contextDep||Bn.contextDep,Qe.propDep||Bn.propDep,function(Ea,jo){var Iu=Ea.ELEMENTS;return Ea.OFFSET?jo.def(Iu,"?",Iu,".vertCount-",Ea.OFFSET,":-1"):jo.def(Iu,"?",Iu,".vertCount:-1")});return J.optional(function(){kn.DYNAMIC=!0}),kn}else if(mr){var Ni=new Ro(kr.thisDep,kr.contextDep,kr.propDep,function(Ea,jo){return jo.def(Ea.shared.vao,".currentVAO?",Ea.shared.vao,".currentVAO.count:-1")});return Ni}return null}var mi=Hr(),pi=gi(),fi=Jr(uv,!1);return{elements:Qe,primitive:mi,count:pi,instances:fi,offset:Bn,vao:kr,vaoActive:mr,elementsActive:Ve,static:sn}}function zs($e,Fe){var yr=$e.static,Xr=$e.dynamic,sn={};return aa.forEach(function(mr){var pr=oi(mr);function kr(Ve,vr){if(mr in yr){var Qe=Ve(yr[mr]);sn[pr]=co(function(){return Qe})}else if(mr in Xr){var Hr=Xr[mr];sn[pr]=gu(Hr,function(Jr,Bn){return vr(Jr,Bn,Jr.invoke(Bn,Hr))})}}switch(mr){case _h:case vu:case cs:case Lo:case Kl:case $f:case Jl:case $c:case Tf:case El:return kr(function(Ve){return J.commandType(Ve,"boolean",mr,Fe.commandStr),Ve},function(Ve,vr,Qe){return J.optional(function(){Ve.assert(vr,"typeof "+Qe+'==="boolean"',"invalid flag "+mr,Ve.commandStr)}),Qe});case cl:return kr(function(Ve){return J.commandParameter(Ve,Ch,"invalid "+mr,Fe.commandStr),Ch[Ve]},function(Ve,vr,Qe){var Hr=Ve.constants.compareFuncs;return J.optional(function(){Ve.assert(vr,Qe+" in "+Hr,"invalid "+mr+", must be one of "+Object.keys(Ch))}),vr.def(Hr,"[",Qe,"]")});case yh:return kr(function(Ve){return J.command(ir(Ve)&&Ve.length===2&&typeof Ve[0]=="number"&&typeof Ve[1]=="number"&&Ve[0]<=Ve[1],"depth range is 2d array",Fe.commandStr),Ve},function(Ve,vr,Qe){J.optional(function(){Ve.assert(vr,Ve.shared.isArrayLike+"("+Qe+")&&"+Qe+".length===2&&typeof "+Qe+'[0]==="number"&&typeof '+Qe+'[1]==="number"&&'+Qe+"[0]<="+Qe+"[1]","depth range must be a 2d array")});var Hr=vr.def("+",Qe,"[0]"),Jr=vr.def("+",Qe,"[1]");return[Hr,Jr]});case qu:return kr(function(Ve){J.commandType(Ve,"object","blend.func",Fe.commandStr);var vr="srcRGB"in Ve?Ve.srcRGB:Ve.src,Qe="srcAlpha"in Ve?Ve.srcAlpha:Ve.src,Hr="dstRGB"in Ve?Ve.dstRGB:Ve.dst,Jr="dstAlpha"in Ve?Ve.dstAlpha:Ve.dst;return J.commandParameter(vr,nc,pr+".srcRGB",Fe.commandStr),J.commandParameter(Qe,nc,pr+".srcAlpha",Fe.commandStr),J.commandParameter(Hr,nc,pr+".dstRGB",Fe.commandStr),J.commandParameter(Jr,nc,pr+".dstAlpha",Fe.commandStr),J.command(Rd.indexOf(vr+", "+Hr)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+vr+", "+Hr+")",Fe.commandStr),[nc[vr],nc[Hr],nc[Qe],nc[Jr]]},function(Ve,vr,Qe){var Hr=Ve.constants.blendFuncs;J.optional(function(){Ve.assert(vr,Qe+"&&typeof "+Qe+'==="object"',"invalid blend func, must be an object")});function Jr(Pi,Gi){var kn=vr.def('"',Pi,Gi,'" in ',Qe,"?",Qe,".",Pi,Gi,":",Qe,".",Pi);return J.optional(function(){Ve.assert(vr,kn+" in "+Hr,"invalid "+mr+"."+Pi+Gi+", must be one of "+Object.keys(nc))}),kn}var Bn=Jr("src","RGB"),gi=Jr("dst","RGB");J.optional(function(){var Pi=Ve.constants.invalidBlendCombinations;Ve.assert(vr,Pi+".indexOf("+Bn+'+", "+'+gi+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var mi=vr.def(Hr,"[",Bn,"]"),pi=vr.def(Hr,"[",Jr("src","Alpha"),"]"),fi=vr.def(Hr,"[",gi,"]"),Xi=vr.def(Hr,"[",Jr("dst","Alpha"),"]");return[mi,fi,pi,Xi]});case kc:return kr(function(Ve){if(typeof Ve=="string")return J.commandParameter(Ve,dn,"invalid "+mr,Fe.commandStr),[dn[Ve],dn[Ve]];if(typeof Ve=="object")return J.commandParameter(Ve.rgb,dn,mr+".rgb",Fe.commandStr),J.commandParameter(Ve.alpha,dn,mr+".alpha",Fe.commandStr),[dn[Ve.rgb],dn[Ve.alpha]];J.commandRaise("invalid blend.equation",Fe.commandStr)},function(Ve,vr,Qe){var Hr=Ve.constants.blendEquations,Jr=vr.def(),Bn=vr.def(),gi=Ve.cond("typeof ",Qe,'==="string"');return J.optional(function(){function mi(pi,fi,Xi){Ve.assert(pi,Xi+" in "+Hr,"invalid "+fi+", must be one of "+Object.keys(dn))}mi(gi.then,mr,Qe),Ve.assert(gi.else,Qe+"&&typeof "+Qe+'==="object"',"invalid "+mr),mi(gi.else,mr+".rgb",Qe+".rgb"),mi(gi.else,mr+".alpha",Qe+".alpha")}),gi.then(Jr,"=",Bn,"=",Hr,"[",Qe,"];"),gi.else(Jr,"=",Hr,"[",Qe,".rgb];",Bn,"=",Hr,"[",Qe,".alpha];"),vr(gi),[Jr,Bn]});case Du:return kr(function(Ve){return J.command(ir(Ve)&&Ve.length===4,"blend.color must be a 4d array",Fe.commandStr),fr(4,function(vr){return+Ve[vr]})},function(Ve,vr,Qe){return J.optional(function(){Ve.assert(vr,Ve.shared.isArrayLike+"("+Qe+")&&"+Qe+".length===4","blend.color must be a 4d array")}),fr(4,function(Hr){return vr.def("+",Qe,"[",Hr,"]")})});case Sl:return kr(function(Ve){return J.commandType(Ve,"number",pr,Fe.commandStr),Ve|0},function(Ve,vr,Qe){return J.optional(function(){Ve.assert(vr,"typeof "+Qe+'==="number"',"invalid stencil.mask")}),vr.def(Qe,"|0")});case Ku:return kr(function(Ve){J.commandType(Ve,"object",pr,Fe.commandStr);var vr=Ve.cmp||"keep",Qe=Ve.ref||0,Hr="mask"in Ve?Ve.mask:-1;return J.commandParameter(vr,Ch,mr+".cmp",Fe.commandStr),J.commandType(Qe,"number",mr+".ref",Fe.commandStr),J.commandType(Hr,"number",mr+".mask",Fe.commandStr),[Ch[vr],Qe,Hr]},function(Ve,vr,Qe){var Hr=Ve.constants.compareFuncs;J.optional(function(){function mi(){Ve.assert(vr,Array.prototype.join.call(arguments,""),"invalid stencil.func")}mi(Qe+"&&typeof ",Qe,'==="object"'),mi('!("cmp" in ',Qe,")||(",Qe,".cmp in ",Hr,")")});var Jr=vr.def('"cmp" in ',Qe,"?",Hr,"[",Qe,".cmp]",":",rc),Bn=vr.def(Qe,".ref|0"),gi=vr.def('"mask" in ',Qe,"?",Qe,".mask|0:-1");return[Jr,Bn,gi]});case qc:case Kc:return kr(function(Ve){J.commandType(Ve,"object",pr,Fe.commandStr);var vr=Ve.fail||"keep",Qe=Ve.zfail||"keep",Hr=Ve.zpass||"keep";return J.commandParameter(vr,Ah,mr+".fail",Fe.commandStr),J.commandParameter(Qe,Ah,mr+".zfail",Fe.commandStr),J.commandParameter(Hr,Ah,mr+".zpass",Fe.commandStr),[mr===Kc?Wp:ec,Ah[vr],Ah[Qe],Ah[Hr]]},function(Ve,vr,Qe){var Hr=Ve.constants.stencilOps;J.optional(function(){Ve.assert(vr,Qe+"&&typeof "+Qe+'==="object"',"invalid "+mr)});function Jr(Bn){return J.optional(function(){Ve.assert(vr,'!("'+Bn+'" in '+Qe+")||("+Qe+"."+Bn+" in "+Hr+")","invalid "+mr+"."+Bn+", must be one of "+Object.keys(Ah))}),vr.def('"',Bn,'" in ',Qe,"?",Hr,"[",Qe,".",Bn,"]:",rc)}return[mr===Kc?Wp:ec,Jr("fail"),Jr("zfail"),Jr("zpass")]});case js:return kr(function(Ve){J.commandType(Ve,"object",pr,Fe.commandStr);var vr=Ve.factor|0,Qe=Ve.units|0;return J.commandType(vr,"number",pr+".factor",Fe.commandStr),J.commandType(Qe,"number",pr+".units",Fe.commandStr),[vr,Qe]},function(Ve,vr,Qe){J.optional(function(){Ve.assert(vr,Qe+"&&typeof "+Qe+'==="object"',"invalid "+mr)});var Hr=vr.def(Qe,".factor|0"),Jr=vr.def(Qe,".units|0");return[Hr,Jr]});case Yf:return kr(function(Ve){var vr=0;return Ve==="front"?vr=ec:Ve==="back"&&(vr=Wp),J.command(!!vr,pr,Fe.commandStr),vr},function(Ve,vr,Qe){return J.optional(function(){Ve.assert(vr,Qe+'==="front"||'+Qe+'==="back"',"invalid cull.face")}),vr.def(Qe,'==="front"?',ec,":",Wp)});case xh:return kr(function(Ve){return J.command(typeof Ve=="number"&&Ve>=cn.lineWidthDims[0]&&Ve<=cn.lineWidthDims[1],"invalid line width, must be a positive number between "+cn.lineWidthDims[0]+" and "+cn.lineWidthDims[1],Fe.commandStr),Ve},function(Ve,vr,Qe){return J.optional(function(){Ve.assert(vr,"typeof "+Qe+'==="number"&&'+Qe+">="+cn.lineWidthDims[0]+"&&"+Qe+"<="+cn.lineWidthDims[1],"invalid line width")}),Qe});case dc:return kr(function(Ve){return J.commandParameter(Ve,r0,pr,Fe.commandStr),r0[Ve]},function(Ve,vr,Qe){return J.optional(function(){Ve.assert(vr,Qe+'==="cw"||'+Qe+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),vr.def(Qe+'==="cw"?'+H0+":"+Qv)});case Ql:return kr(function(Ve){return J.command(ir(Ve)&&Ve.length===4,"color.mask must be length 4 array",Fe.commandStr),Ve.map(function(vr){return!!vr})},function(Ve,vr,Qe){return J.optional(function(){Ve.assert(vr,Ve.shared.isArrayLike+"("+Qe+")&&"+Qe+".length===4","invalid color.mask")}),fr(4,function(Hr){return"!!"+Qe+"["+Hr+"]"})});case vc:return kr(function(Ve){J.command(typeof Ve=="object"&&Ve,pr,Fe.commandStr);var vr="value"in Ve?Ve.value:1,Qe=!!Ve.invert;return J.command(typeof vr=="number"&&vr>=0&&vr<=1,"sample.coverage.value must be a number between 0 and 1",Fe.commandStr),[vr,Qe]},function(Ve,vr,Qe){J.optional(function(){Ve.assert(vr,Qe+"&&typeof "+Qe+'==="object"',"invalid sample.coverage")});var Hr=vr.def('"value" in ',Qe,"?+",Qe,".value:1"),Jr=vr.def("!!",Qe,".invert");return[Hr,Jr]})}}),sn}function io($e,Fe){var yr=$e.static,Xr=$e.dynamic,sn={};return Object.keys(yr).forEach(function(mr){var pr=yr[mr],kr;if(typeof pr=="number"||typeof pr=="boolean")kr=co(function(){return pr});else if(typeof pr=="function"){var Ve=pr._reglType;Ve==="texture2d"||Ve==="textureCube"?kr=co(function(vr){return vr.link(pr)}):Ve==="framebuffer"||Ve==="framebufferCube"?(J.command(pr.color.length>0,'missing color attachment for framebuffer sent to uniform "'+mr+'"',Fe.commandStr),kr=co(function(vr){return vr.link(pr.color[0])})):J.commandRaise('invalid data for uniform "'+mr+'"',Fe.commandStr)}else ir(pr)?kr=co(function(vr){var Qe=vr.global.def("[",fr(pr.length,function(Hr){return J.command(typeof pr[Hr]=="number"||typeof pr[Hr]=="boolean","invalid uniform "+mr,vr.commandStr),pr[Hr]}),"]");return Qe}):J.commandRaise('invalid or missing data for uniform "'+mr+'"',Fe.commandStr);kr.value=pr,sn[mr]=kr}),Object.keys(Xr).forEach(function(mr){var pr=Xr[mr];sn[mr]=gu(pr,function(kr,Ve){return kr.invoke(Ve,pr)})}),sn}function Au($e,Fe){var yr=$e.static,Xr=$e.dynamic,sn={};return Object.keys(yr).forEach(function(mr){var pr=yr[mr],kr=Ue.id(mr),Ve=new Gr;if(lp(pr))Ve.state=la,Ve.buffer=On.getBuffer(On.create(pr,Bs,!1,!0)),Ve.type=0;else{var vr=On.getBuffer(pr);if(vr)Ve.state=la,Ve.buffer=vr,Ve.type=0;else if(J.command(typeof pr=="object"&&pr,"invalid data for attribute "+mr,Fe.commandStr),"constant"in pr){var Qe=pr.constant;Ve.buffer="null",Ve.state=Na,typeof Qe=="number"?Ve.x=Qe:(J.command(ir(Qe)&&Qe.length>0&&Qe.length<=4,"invalid constant for attribute "+mr,Fe.commandStr),Aa.forEach(function(fi,Xi){Xi<Qe.length&&(Ve[fi]=Qe[Xi])}))}else{lp(pr.buffer)?vr=On.getBuffer(On.create(pr.buffer,Bs,!1,!0)):vr=On.getBuffer(pr.buffer),J.command(!!vr,'missing buffer for attribute "'+mr+'"',Fe.commandStr);var Hr=pr.offset|0;J.command(Hr>=0,'invalid offset for attribute "'+mr+'"',Fe.commandStr);var Jr=pr.stride|0;J.command(Jr>=0&&Jr<256,'invalid stride for attribute "'+mr+'", must be integer betweeen [0, 255]',Fe.commandStr);var Bn=pr.size|0;J.command(!("size"in pr)||Bn>0&&Bn<=4,'invalid size for attribute "'+mr+'", must be 1,2,3,4',Fe.commandStr);var gi=!!pr.normalized,mi=0;"type"in pr&&(J.commandParameter(pr.type,dl,"invalid type for attribute "+mr,Fe.commandStr),mi=dl[pr.type]);var pi=pr.divisor|0;J.optional(function(){"divisor"in pr&&(J.command(pi===0||Xn,'cannot specify divisor for attribute "'+mr+'", instancing not supported',Fe.commandStr),J.command(pi>=0,'invalid divisor for attribute "'+mr+'"',Fe.commandStr));var fi=Fe.commandStr,Xi=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(pr).forEach(function(Pi){J.command(Xi.indexOf(Pi)>=0,'unknown parameter "'+Pi+'" for attribute pointer "'+mr+'" (valid parameters are '+Xi+")",fi)})}),Ve.buffer=vr,Ve.state=la,Ve.size=Bn,Ve.normalized=gi,Ve.type=mi||vr.dtype,Ve.offset=Hr,Ve.stride=Jr,Ve.divisor=pi}}sn[mr]=co(function(fi,Xi){var Pi=fi.attribCache;if(kr in Pi)return Pi[kr];var Gi={isStream:!1};return Object.keys(Ve).forEach(function(kn){Gi[kn]=Ve[kn]}),Ve.buffer&&(Gi.buffer=fi.link(Ve.buffer),Gi.type=Gi.type||Gi.buffer+".dtype"),Pi[kr]=Gi,Gi})}),Object.keys(Xr).forEach(function(mr){var pr=Xr[mr];function kr(Ve,vr){var Qe=Ve.invoke(vr,pr),Hr=Ve.shared,Jr=Ve.constants,Bn=Hr.isBufferArgs,gi=Hr.buffer;J.optional(function(){Ve.assert(vr,Qe+"&&(typeof "+Qe+'==="object"||typeof '+Qe+'==="function")&&('+Bn+"("+Qe+")||"+gi+".getBuffer("+Qe+")||"+gi+".getBuffer("+Qe+".buffer)||"+Bn+"("+Qe+'.buffer)||("constant" in '+Qe+"&&(typeof "+Qe+'.constant==="number"||'+Hr.isArrayLike+"("+Qe+".constant))))",'invalid dynamic attribute "'+mr+'"')});var mi={isStream:vr.def(!1)},pi=new Gr;pi.state=la,Object.keys(pi).forEach(function(Gi){mi[Gi]=vr.def(""+pi[Gi])});var fi=mi.buffer,Xi=mi.type;vr("if(",Bn,"(",Qe,")){",mi.isStream,"=true;",fi,"=",gi,".createStream(",Bs,",",Qe,");",Xi,"=",fi,".dtype;","}else{",fi,"=",gi,".getBuffer(",Qe,");","if(",fi,"){",Xi,"=",fi,".dtype;",'}else if("constant" in ',Qe,"){",mi.state,"=",Na,";","if(typeof "+Qe+'.constant === "number"){',mi[Aa[0]],"=",Qe,".constant;",Aa.slice(1).map(function(Gi){return mi[Gi]}).join("="),"=0;","}else{",Aa.map(function(Gi,kn){return mi[Gi]+"="+Qe+".constant.length>"+kn+"?"+Qe+".constant["+kn+"]:0;"}).join(""),"}}else{","if(",Bn,"(",Qe,".buffer)){",fi,"=",gi,".createStream(",Bs,",",Qe,".buffer);","}else{",fi,"=",gi,".getBuffer(",Qe,".buffer);","}",Xi,'="type" in ',Qe,"?",Jr.glTypes,"[",Qe,".type]:",fi,".dtype;",mi.normalized,"=!!",Qe,".normalized;");function Pi(Gi){vr(mi[Gi],"=",Qe,".",Gi,"|0;")}return Pi("size"),Pi("offset"),Pi("stride"),Pi("divisor"),vr("}}"),vr.exit("if(",mi.isStream,"){",gi,".destroyStream(",fi,");","}"),mi}sn[mr]=gu(pr,kr)}),sn}function Xo($e){var Fe=$e.static,yr=$e.dynamic,Xr={};return Object.keys(Fe).forEach(function(sn){var mr=Fe[sn];Xr[sn]=co(function(pr,kr){return typeof mr=="number"||typeof mr=="boolean"?""+mr:pr.link(mr)})}),Object.keys(yr).forEach(function(sn){var mr=yr[sn];Xr[sn]=gu(mr,function(pr,kr){return pr.invoke(kr,mr)})}),Xr}function Qs($e,Fe,yr,Xr,sn){var mr=$e.static,pr=$e.dynamic;J.optional(function(){var Pi=[tc,Jc,Eh,kl,Cu,wd,sp,uv,bh,lv].concat(aa);function Gi(kn){Object.keys(kn).forEach(function(Ni){J.command(Pi.indexOf(Ni)>=0,'unknown parameter "'+Ni+'"',sn.commandStr)})}Gi(mr),Gi(pr)});var kr=Da($e,Fe),Ve=Li($e,sn),vr=Sa($e,Ve,sn),Qe=Is($e,sn),Hr=zs($e,sn),Jr=oo($e,sn,kr);function Bn(Pi){var Gi=vr[Pi];Gi&&(Hr[Pi]=Gi)}Bn(Bu),Bn(oi(Qc));var gi=Object.keys(Hr).length>0,mi={framebuffer:Ve,draw:Qe,shader:Jr,state:Hr,dirty:gi,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(mi.profile=Ii($e,sn),mi.uniforms=io(yr,sn),mi.drawVAO=mi.scopeVAO=Qe.vao,!mi.drawVAO&&Jr.program&&!kr&&dr.angle_instanced_arrays&&Qe.static.elements){var pi=!0,fi=Jr.program.attributes.map(function(Pi){var Gi=Fe.static[Pi];return pi=pi&&!!Gi,Gi});if(pi&&fi.length>0){var Xi=Jn.getVAO(Jn.createVAO({attributes:fi,elements:Qe.static.elements}));mi.drawVAO=new Ro(null,null,null,function(Pi,Gi){return Pi.link(Xi)}),mi.useVAO=!0}}return kr?mi.useVAO=!0:mi.attributes=Au(Fe,sn),mi.context=Xo(Xr,sn),mi}function su($e,Fe,yr){var Xr=$e.shared,sn=Xr.context,mr=$e.scope();Object.keys(yr).forEach(function(pr){Fe.save(sn,"."+pr);var kr=yr[pr],Ve=kr.append($e,Fe);Array.isArray(Ve)?mr(sn,".",pr,"=[",Ve.join(),"];"):mr(sn,".",pr,"=",Ve,";")}),Fe(mr)}function Tu($e,Fe,yr,Xr){var sn=$e.shared,mr=sn.gl,pr=sn.framebuffer,kr;vi&&(kr=Fe.def(sn.extensions,".webgl_draw_buffers"));var Ve=$e.constants,vr=Ve.drawBuffer,Qe=Ve.backBuffer,Hr;yr?Hr=yr.append($e,Fe):Hr=Fe.def(pr,".next"),Xr||Fe("if(",Hr,"!==",pr,".cur){"),Fe("if(",Hr,"){",mr,".bindFramebuffer(",Fd,",",Hr,".framebuffer);"),vi&&Fe(kr,".drawBuffersWEBGL(",vr,"[",Hr,".colorAttachments.length]);"),Fe("}else{",mr,".bindFramebuffer(",Fd,",null);"),vi&&Fe(kr,".drawBuffersWEBGL(",Qe,");"),Fe("}",pr,".cur=",Hr,";"),Xr||Fe("}")}function Js($e,Fe,yr){var Xr=$e.shared,sn=Xr.gl,mr=$e.current,pr=$e.next,kr=Xr.current,Ve=Xr.next,vr=$e.cond(kr,".dirty");aa.forEach(function(Qe){var Hr=oi(Qe);if(!(Hr in yr.state)){var Jr,Bn;if(Hr in pr){Jr=pr[Hr],Bn=mr[Hr];var gi=fr(Qn[Hr].length,function(pi){return vr.def(Jr,"[",pi,"]")});vr($e.cond(gi.map(function(pi,fi){return pi+"!=="+Bn+"["+fi+"]"}).join("||")).then(sn,".",An[Hr],"(",gi,");",gi.map(function(pi,fi){return Bn+"["+fi+"]="+pi}).join(";"),";"))}else{Jr=vr.def(Ve,".",Hr);var mi=$e.cond(Jr,"!==",kr,".",Hr);vr(mi),Hr in _n?mi($e.cond(Jr).then(sn,".enable(",_n[Hr],");").else(sn,".disable(",_n[Hr],");"),kr,".",Hr,"=",Jr,";"):mi(sn,".",An[Hr],"(",Jr,");",kr,".",Hr,"=",Jr,";")}}}),Object.keys(yr.state).length===0&&vr(kr,".dirty=false;"),Fe(vr)}function zu($e,Fe,yr,Xr){var sn=$e.shared,mr=$e.current,pr=sn.current,kr=sn.gl;Dd(Object.keys(yr)).forEach(function(Ve){var vr=yr[Ve];if(!(Xr&&!Xr(vr))){var Qe=vr.append($e,Fe);if(_n[Ve]){var Hr=_n[Ve];kf(vr)?Qe?Fe(kr,".enable(",Hr,");"):Fe(kr,".disable(",Hr,");"):Fe($e.cond(Qe).then(kr,".enable(",Hr,");").else(kr,".disable(",Hr,");")),Fe(pr,".",Ve,"=",Qe,";")}else if(ir(Qe)){var Jr=mr[Ve];Fe(kr,".",An[Ve],"(",Qe,");",Qe.map(function(Bn,gi){return Jr+"["+gi+"]="+Bn}).join(";"),";")}else Fe(kr,".",An[Ve],"(",Qe,");",pr,".",Ve,"=",Qe,";")}})}function Jo($e,Fe){Xn&&($e.instancing=Fe.def($e.shared.extensions,".angle_instanced_arrays"))}function La($e,Fe,yr,Xr,sn){var mr=$e.shared,pr=$e.stats,kr=mr.current,Ve=mr.timer,vr=yr.profile;function Qe(){var Pi=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return Pi||typeof performance=="undefined"?"Date.now()":"performance.now()"}var Hr,Jr;function Bn(Pi){Hr=Fe.def(),Pi(Hr,"=",Qe(),";"),typeof sn=="string"?Pi(pr,".count+=",sn,";"):Pi(pr,".count++;"),qn&&(Xr?(Jr=Fe.def(),Pi(Jr,"=",Ve,".getNumPendingQueries();")):Pi(Ve,".beginQuery(",pr,");"))}function gi(Pi){Pi(pr,".cpuTime+=",Qe(),"-",Hr,";"),qn&&(Xr?Pi(Ve,".pushScopeStats(",Jr,",",Ve,".getNumPendingQueries(),",pr,");"):Pi(Ve,".endQuery();"))}function mi(Pi){var Gi=Fe.def(kr,".profile");Fe(kr,".profile=",Pi,";"),Fe.exit(kr,".profile=",Gi,";")}var pi;if(vr){if(kf(vr)){vr.enable?(Bn(Fe),gi(Fe.exit),mi("true")):mi("false");return}pi=vr.append($e,Fe),mi(pi)}else pi=Fe.def(kr,".profile");var fi=$e.block();Bn(fi),Fe("if(",pi,"){",fi,"}");var Xi=$e.block();gi(Xi),Fe.exit("if(",pi,"){",Xi,"}")}function tu($e,Fe,yr,Xr,sn){var mr=$e.shared;function pr(Ve){switch(Ve){case Md:case Gp:case vv:return 2;case Kf:case Qf:case nf:return 3;case up:case dv:case Hp:return 4;default:return 1}}function kr(Ve,vr,Qe){var Hr=mr.gl,Jr=Fe.def(Ve,".location"),Bn=Fe.def(mr.attributes,"[",Jr,"]"),gi=Qe.state,mi=Qe.buffer,pi=[Qe.x,Qe.y,Qe.z,Qe.w],fi=["buffer","normalized","offset","stride"];function Xi(){Fe("if(!",Bn,".buffer){",Hr,".enableVertexAttribArray(",Jr,");}");var Gi=Qe.type,kn;if(Qe.size?kn=Fe.def(Qe.size,"||",vr):kn=vr,Fe("if(",Bn,".type!==",Gi,"||",Bn,".size!==",kn,"||",fi.map(function(Ea){return Bn+"."+Ea+"!=="+Qe[Ea]}).join("||"),"){",Hr,".bindBuffer(",Bs,",",mi,".buffer);",Hr,".vertexAttribPointer(",[Jr,kn,Gi,Qe.normalized,Qe.stride,Qe.offset],");",Bn,".type=",Gi,";",Bn,".size=",kn,";",fi.map(function(Ea){return Bn+"."+Ea+"="+Qe[Ea]+";"}).join(""),"}"),Xn){var Ni=Qe.divisor;Fe("if(",Bn,".divisor!==",Ni,"){",$e.instancing,".vertexAttribDivisorANGLE(",[Jr,Ni],");",Bn,".divisor=",Ni,";}")}}function Pi(){Fe("if(",Bn,".buffer){",Hr,".disableVertexAttribArray(",Jr,");",Bn,".buffer=null;","}if(",Aa.map(function(Gi,kn){return Bn+"."+Gi+"!=="+pi[kn]}).join("||"),"){",Hr,".vertexAttrib4f(",Jr,",",pi,");",Aa.map(function(Gi,kn){return Bn+"."+Gi+"="+pi[kn]+";"}).join(""),"}")}gi===la?Xi():gi===Na?Pi():(Fe("if(",gi,"===",la,"){"),Xi(),Fe("}else{"),Pi(),Fe("}"))}Xr.forEach(function(Ve){var vr=Ve.name,Qe=yr.attributes[vr],Hr;if(Qe){if(!sn(Qe))return;Hr=Qe.append($e,Fe)}else{if(!sn(W0))return;var Jr=$e.scopeAttrib(vr);J.optional(function(){$e.assert(Fe,Jr+".state","missing attribute "+vr)}),Hr={},Object.keys(new Gr).forEach(function(Bn){Hr[Bn]=Fe.def(Jr,".",Bn)})}kr($e.link(Ve),pr(Ve.info.type),Hr)})}function fo($e,Fe,yr,Xr,sn,mr){for(var pr=$e.shared,kr=pr.gl,Ve,vr=0;vr<Xr.length;++vr){var Qe=Xr[vr],Hr=Qe.name,Jr=Qe.info.type,Bn=yr.uniforms[Hr],gi=$e.link(Qe),mi=gi+".location",pi;if(Bn){if(!sn(Bn))continue;if(kf(Bn)){var fi=Bn.value;if(J.command(fi!==null&&typeof fi!="undefined",'missing uniform "'+Hr+'"',$e.commandStr),Jr===Pd||Jr===jp){J.command(typeof fi=="function"&&(Jr===Pd&&(fi._reglType==="texture2d"||fi._reglType==="framebuffer")||Jr===jp&&(fi._reglType==="textureCube"||fi._reglType==="framebufferCube")),"invalid texture for uniform "+Hr,$e.commandStr);var Xi=$e.link(fi._texture||fi.color[0]._texture);Fe(kr,".uniform1i(",mi,",",Xi+".bind());"),Fe.exit(Xi,".unbind();")}else if(Jr===Ul||Jr===kd||Jr===Ld){J.optional(function(){J.command(ir(fi),"invalid matrix for uniform "+Hr,$e.commandStr),J.command(Jr===Ul&&fi.length===4||Jr===kd&&fi.length===9||Jr===Ld&&fi.length===16,"invalid length for matrix uniform "+Hr,$e.commandStr)});var Pi=$e.global.def("new Float32Array(["+Array.prototype.slice.call(fi)+"])"),Gi=2;Jr===kd?Gi=3:Jr===Ld&&(Gi=4),Fe(kr,".uniformMatrix",Gi,"fv(",mi,",false,",Pi,");")}else{switch(Jr){case pv:J.commandType(fi,"number","uniform "+Hr,$e.commandStr),Ve="1f";break;case Md:J.command(ir(fi)&&fi.length===2,"uniform "+Hr,$e.commandStr),Ve="2f";break;case Kf:J.command(ir(fi)&&fi.length===3,"uniform "+Hr,$e.commandStr),Ve="3f";break;case up:J.command(ir(fi)&&fi.length===4,"uniform "+Hr,$e.commandStr),Ve="4f";break;case rf:J.commandType(fi,"boolean","uniform "+Hr,$e.commandStr),Ve="1i";break;case Id:J.commandType(fi,"number","uniform "+Hr,$e.commandStr),Ve="1i";break;case vv:J.command(ir(fi)&&fi.length===2,"uniform "+Hr,$e.commandStr),Ve="2i";break;case Gp:J.command(ir(fi)&&fi.length===2,"uniform "+Hr,$e.commandStr),Ve="2i";break;case nf:J.command(ir(fi)&&fi.length===3,"uniform "+Hr,$e.commandStr),Ve="3i";break;case Qf:J.command(ir(fi)&&fi.length===3,"uniform "+Hr,$e.commandStr),Ve="3i";break;case Hp:J.command(ir(fi)&&fi.length===4,"uniform "+Hr,$e.commandStr),Ve="4i";break;case dv:J.command(ir(fi)&&fi.length===4,"uniform "+Hr,$e.commandStr),Ve="4i";break}Fe(kr,".uniform",Ve,"(",mi,",",ir(fi)?Array.prototype.slice.call(fi):fi,");")}continue}else pi=Bn.append($e,Fe)}else{if(!sn(W0))continue;pi=Fe.def(pr.uniforms,"[",Ue.id(Hr),"]")}Jr===Pd?(J(!Array.isArray(pi),"must specify a scalar prop for textures"),Fe("if(",pi,"&&",pi,'._reglType==="framebuffer"){',pi,"=",pi,".color[0];","}")):Jr===jp&&(J(!Array.isArray(pi),"must specify a scalar prop for cube maps"),Fe("if(",pi,"&&",pi,'._reglType==="framebufferCube"){',pi,"=",pi,".color[0];","}")),J.optional(function(){function Al(Ll,rh){$e.assert(Fe,Ll,'bad data or missing for uniform "'+Hr+'".  '+rh)}function lf(Ll){J(!Array.isArray(pi),"must not specify an array type for uniform"),Al("typeof "+pi+'==="'+Ll+'"',"invalid type, expected "+Ll)}function Zl(Ll,rh){Array.isArray(pi)?J(pi.length===Ll,"must have length "+Ll):Al(pr.isArrayLike+"("+pi+")&&"+pi+".length==="+Ll,"invalid vector, should have length "+Ll,$e.commandStr)}function Y0(Ll){J(!Array.isArray(pi),"must not specify a value type"),Al("typeof "+pi+'==="function"&&'+pi+'._reglType==="texture'+(Ll===Cl?"2d":"Cube")+'"',"invalid texture type",$e.commandStr)}switch(Jr){case Id:lf("number");break;case Gp:Zl(2,"number");break;case Qf:Zl(3,"number");break;case dv:Zl(4,"number");break;case pv:lf("number");break;case Md:Zl(2,"number");break;case Kf:Zl(3,"number");break;case up:Zl(4,"number");break;case rf:lf("boolean");break;case vv:Zl(2,"boolean");break;case nf:Zl(3,"boolean");break;case Hp:Zl(4,"boolean");break;case Ul:Zl(4,"number");break;case kd:Zl(9,"number");break;case Ld:Zl(16,"number");break;case Pd:Y0(Cl);break;case jp:Y0(Pc);break}});var kn=1;switch(Jr){case Pd:case jp:var Ni=Fe.def(pi,"._texture");Fe(kr,".uniform1i(",mi,",",Ni,".bind());"),Fe.exit(Ni,".unbind();");continue;case Id:case rf:Ve="1i";break;case Gp:case vv:Ve="2i",kn=2;break;case Qf:case nf:Ve="3i",kn=3;break;case dv:case Hp:Ve="4i",kn=4;break;case pv:Ve="1f";break;case Md:Ve="2f",kn=2;break;case Kf:Ve="3f",kn=3;break;case up:Ve="4f",kn=4;break;case Ul:Ve="Matrix2fv";break;case kd:Ve="Matrix3fv";break;case Ld:Ve="Matrix4fv";break}if(Ve.charAt(0)==="M"){Fe(kr,".uniform",Ve,"(",mi,",");var Ea=Math.pow(Jr-Ul+2,2),jo=$e.global.def("new Float32Array(",Ea,")");Array.isArray(pi)?Fe("false,(",fr(Ea,function(Al){return jo+"["+Al+"]="+pi[Al]}),",",jo,")"):Fe("false,(Array.isArray(",pi,")||",pi," instanceof Float32Array)?",pi,":(",fr(Ea,function(Al){return jo+"["+Al+"]="+pi+"["+Al+"]"}),",",jo,")"),Fe(");")}else if(kn>1){for(var Iu=[],_a=[],mo=0;mo<kn;++mo)Array.isArray(pi)?_a.push(pi[mo]):_a.push(Fe.def(pi+"["+mo+"]")),mr&&Iu.push(Fe.def());mr&&Fe("if(!",$e.batchId,"||",Iu.map(function(Al,lf){return Al+"!=="+_a[lf]}).join("||"),"){",Iu.map(function(Al,lf){return Al+"="+_a[lf]+";"}).join("")),Fe(kr,".uniform",Ve,"(",mi,",",_a.join(","),");"),mr&&Fe("}")}else{if(J(!Array.isArray(pi),"uniform value must not be an array"),mr){var Oc=Fe.def();Fe("if(!",$e.batchId,"||",Oc,"!==",pi,"){",Oc,"=",pi,";")}Fe(kr,".uniform",Ve,"(",mi,",",pi,");"),mr&&Fe("}")}}}function Mu($e,Fe,yr,Xr){var sn=$e.shared,mr=sn.gl,pr=sn.draw,kr=Xr.draw;function Ve(){var kn=kr.elements,Ni,Ea=Fe;return kn?((kn.contextDep&&Xr.contextDynamic||kn.propDep)&&(Ea=yr),Ni=kn.append($e,Ea),kr.elementsActive&&Ea("if("+Ni+")"+mr+".bindBuffer("+Mf+","+Ni+".buffer.buffer);")):(Ni=Ea.def(),Ea(Ni,"=",pr,".",kl,";","if(",Ni,"){",mr,".bindBuffer(",Mf,",",Ni,".buffer.buffer);}","else if(",sn.vao,".currentVAO){",Ni,"=",$e.shared.elements+".getElements("+sn.vao,".currentVAO.elements);",Rn?"":"if("+Ni+")"+mr+".bindBuffer("+Mf+","+Ni+".buffer.buffer);","}")),Ni}function vr(){var kn=kr.count,Ni,Ea=Fe;return kn?((kn.contextDep&&Xr.contextDynamic||kn.propDep)&&(Ea=yr),Ni=kn.append($e,Ea),J.optional(function(){kn.MISSING&&$e.assert(Fe,"false","missing vertex count"),kn.DYNAMIC&&$e.assert(Ea,Ni+">=0","missing vertex count")})):(Ni=Ea.def(pr,".",sp),J.optional(function(){$e.assert(Ea,Ni+">=0","missing vertex count")})),Ni}var Qe=Ve();function Hr(kn){var Ni=kr[kn];return Ni?Ni.contextDep&&Xr.contextDynamic||Ni.propDep?Ni.append($e,yr):Ni.append($e,Fe):Fe.def(pr,".",kn)}var Jr=Hr(Cu),Bn=Hr(wd),gi=vr();if(typeof gi=="number"){if(gi===0)return}else yr("if(",gi,"){"),yr.exit("}");var mi,pi;Xn&&(mi=Hr(uv),pi=$e.instancing);var fi=Qe+".type",Xi=kr.elements&&kf(kr.elements)&&!kr.vaoActive;function Pi(){function kn(){yr(pi,".drawElementsInstancedANGLE(",[Jr,gi,fi,Bn+"<<(("+fi+"-"+ka+")>>1)",mi],");")}function Ni(){yr(pi,".drawArraysInstancedANGLE(",[Jr,Bn,gi,mi],");")}Qe&&Qe!=="null"?Xi?kn():(yr("if(",Qe,"){"),kn(),yr("}else{"),Ni(),yr("}")):Ni()}function Gi(){function kn(){yr(mr+".drawElements("+[Jr,gi,fi,Bn+"<<(("+fi+"-"+ka+")>>1)"]+");")}function Ni(){yr(mr+".drawArrays("+[Jr,Bn,gi]+");")}Qe&&Qe!=="null"?Xi?kn():(yr("if(",Qe,"){"),kn(),yr("}else{"),Ni(),yr("}")):Ni()}Xn&&(typeof mi!="number"||mi>=0)?typeof mi=="string"?(yr("if(",mi,">0){"),Pi(),yr("}else if(",mi,"<0){"),Gi(),yr("}")):Pi():Gi()}function ya($e,Fe,yr,Xr,sn){var mr=Yn(),pr=mr.proc("body",sn);return J.optional(function(){mr.commandStr=Fe.commandStr,mr.command=mr.link(Fe.commandStr)}),Xn&&(mr.instancing=pr.def(mr.shared.extensions,".angle_instanced_arrays")),$e(mr,pr,yr,Xr),mr.compile().body}function eo($e,Fe,yr,Xr){Jo($e,Fe),yr.useVAO?yr.drawVAO?Fe($e.shared.vao,".setVAO(",yr.drawVAO.append($e,Fe),");"):Fe($e.shared.vao,".setVAO(",$e.shared.vao,".targetVAO);"):(Fe($e.shared.vao,".setVAO(null);"),tu($e,Fe,yr,Xr.attributes,function(){return!0})),fo($e,Fe,yr,Xr.uniforms,function(){return!0},!1),Mu($e,Fe,Fe,yr)}function Eo($e,Fe){var yr=$e.proc("draw",1);Jo($e,yr),su($e,yr,Fe.context),Tu($e,yr,Fe.framebuffer),Js($e,yr,Fe),zu($e,yr,Fe.state),La($e,yr,Fe,!1,!0);var Xr=Fe.shader.progVar.append($e,yr);if(yr($e.shared.gl,".useProgram(",Xr,".program);"),Fe.shader.program)eo($e,yr,Fe,Fe.shader.program);else{yr($e.shared.vao,".setVAO(null);");var sn=$e.global.def("{}"),mr=yr.def(Xr,".id"),pr=yr.def(sn,"[",mr,"]");yr($e.cond(pr).then(pr,".call(this,a0);").else(pr,"=",sn,"[",mr,"]=",$e.link(function(kr){return ya(eo,$e,Fe,kr,1)}),"(",Xr,");",pr,".call(this,a0);"))}Object.keys(Fe.state).length>0&&yr($e.shared.current,".dirty=true;"),$e.shared.vao&&yr($e.shared.vao,".setVAO(null);")}function So($e,Fe,yr,Xr){$e.batchId="a1",Jo($e,Fe);function sn(){return!0}tu($e,Fe,yr,Xr.attributes,sn),fo($e,Fe,yr,Xr.uniforms,sn,!1),Mu($e,Fe,Fe,yr)}function Po($e,Fe,yr,Xr){Jo($e,Fe);var sn=yr.contextDep,mr=Fe.def(),pr="a0",kr="a1",Ve=Fe.def();$e.shared.props=Ve,$e.batchId=mr;var vr=$e.scope(),Qe=$e.scope();Fe(vr.entry,"for(",mr,"=0;",mr,"<",kr,";++",mr,"){",Ve,"=",pr,"[",mr,"];",Qe,"}",vr.exit);function Hr(fi){return fi.contextDep&&sn||fi.propDep}function Jr(fi){return!Hr(fi)}if(yr.needsContext&&su($e,Qe,yr.context),yr.needsFramebuffer&&Tu($e,Qe,yr.framebuffer),zu($e,Qe,yr.state,Hr),yr.profile&&Hr(yr.profile)&&La($e,Qe,yr,!1,!0),Xr)yr.useVAO?yr.drawVAO?Hr(yr.drawVAO)?Qe($e.shared.vao,".setVAO(",yr.drawVAO.append($e,Qe),");"):vr($e.shared.vao,".setVAO(",yr.drawVAO.append($e,vr),");"):vr($e.shared.vao,".setVAO(",$e.shared.vao,".targetVAO);"):(vr($e.shared.vao,".setVAO(null);"),tu($e,vr,yr,Xr.attributes,Jr),tu($e,Qe,yr,Xr.attributes,Hr)),fo($e,vr,yr,Xr.uniforms,Jr,!1),fo($e,Qe,yr,Xr.uniforms,Hr,!0),Mu($e,vr,Qe,yr);else{var Bn=$e.global.def("{}"),gi=yr.shader.progVar.append($e,Qe),mi=Qe.def(gi,".id"),pi=Qe.def(Bn,"[",mi,"]");Qe($e.shared.gl,".useProgram(",gi,".program);","if(!",pi,"){",pi,"=",Bn,"[",mi,"]=",$e.link(function(fi){return ya(So,$e,yr,fi,2)}),"(",gi,");}",pi,".call(this,a0[",mr,"],",mr,");")}}function Ke($e,Fe){var yr=$e.proc("batch",2);$e.batchId="0",Jo($e,yr);var Xr=!1,sn=!0;Object.keys(Fe.context).forEach(function(Bn){Xr=Xr||Fe.context[Bn].propDep}),Xr||(su($e,yr,Fe.context),sn=!1);var mr=Fe.framebuffer,pr=!1;mr?(mr.propDep?Xr=pr=!0:mr.contextDep&&Xr&&(pr=!0),pr||Tu($e,yr,mr)):Tu($e,yr,null),Fe.state.viewport&&Fe.state.viewport.propDep&&(Xr=!0);function kr(Bn){return Bn.contextDep&&Xr||Bn.propDep}Js($e,yr,Fe),zu($e,yr,Fe.state,function(Bn){return!kr(Bn)}),(!Fe.profile||!kr(Fe.profile))&&La($e,yr,Fe,!1,"a1"),Fe.contextDep=Xr,Fe.needsContext=sn,Fe.needsFramebuffer=pr;var Ve=Fe.shader.progVar;if(Ve.contextDep&&Xr||Ve.propDep)Po($e,yr,Fe,null);else{var vr=Ve.append($e,yr);if(yr($e.shared.gl,".useProgram(",vr,".program);"),Fe.shader.program)Po($e,yr,Fe,Fe.shader.program);else{yr($e.shared.vao,".setVAO(null);");var Qe=$e.global.def("{}"),Hr=yr.def(vr,".id"),Jr=yr.def(Qe,"[",Hr,"]");yr($e.cond(Jr).then(Jr,".call(this,a0,a1);").else(Jr,"=",Qe,"[",Hr,"]=",$e.link(function(Bn){return ya(Po,$e,Fe,Bn,2)}),"(",vr,");",Jr,".call(this,a0,a1);"))}}Object.keys(Fe.state).length>0&&yr($e.shared.current,".dirty=true;"),$e.shared.vao&&yr($e.shared.vao,".setVAO(null);")}function an($e,Fe){var yr=$e.proc("scope",3);$e.batchId="a2";var Xr=$e.shared,sn=Xr.current;su($e,yr,Fe.context),Fe.framebuffer&&Fe.framebuffer.append($e,yr),Dd(Object.keys(Fe.state)).forEach(function(pr){var kr=Fe.state[pr],Ve=kr.append($e,yr);ir(Ve)?Ve.forEach(function(vr,Qe){yr.set($e.next[pr],"["+Qe+"]",vr)}):yr.set(Xr.next,"."+pr,Ve)}),La($e,yr,Fe,!0,!0),[kl,wd,sp,uv,Cu].forEach(function(pr){var kr=Fe.draw[pr];!kr||yr.set(Xr.draw,"."+pr,""+kr.append($e,yr))}),Object.keys(Fe.uniforms).forEach(function(pr){var kr=Fe.uniforms[pr].append($e,yr);Array.isArray(kr)&&(kr="["+kr.join()+"]"),yr.set(Xr.uniforms,"["+Ue.id(pr)+"]",kr)}),Object.keys(Fe.attributes).forEach(function(pr){var kr=Fe.attributes[pr].append($e,yr),Ve=$e.scopeAttrib(pr);Object.keys(new Gr).forEach(function(vr){yr.set(Ve,"."+vr,kr[vr])})}),Fe.scopeVAO&&yr.set(Xr.vao,".targetVAO",Fe.scopeVAO.append($e,yr));function mr(pr){var kr=Fe.shader[pr];kr&&yr.set(Xr.shader,"."+pr,kr.append($e,yr))}mr(Jc),mr(Eh),Object.keys(Fe.state).length>0&&(yr(sn,".dirty=true;"),yr.exit(sn,".dirty=true;")),yr("a1(",$e.shared.context,",a0,",$e.batchId,");")}function en($e){if(!(typeof $e!="object"||ir($e))){for(var Fe=Object.keys($e),yr=0;yr<Fe.length;++yr)if(Zr.isDynamic($e[Fe[yr]]))return!0;return!1}}function Ri($e,Fe,yr){var Xr=Fe.static[yr];if(!Xr||!en(Xr))return;var sn=$e.global,mr=Object.keys(Xr),pr=!1,kr=!1,Ve=!1,vr=$e.global.def("{}");mr.forEach(function(Hr){var Jr=Xr[Hr];if(Zr.isDynamic(Jr)){typeof Jr=="function"&&(Jr=Xr[Hr]=Zr.unbox(Jr));var Bn=gu(Jr,null);pr=pr||Bn.thisDep,Ve=Ve||Bn.propDep,kr=kr||Bn.contextDep}else{switch(sn(vr,".",Hr,"="),typeof Jr){case"number":sn(Jr);break;case"string":sn('"',Jr,'"');break;case"object":Array.isArray(Jr)&&sn("[",Jr.join(),"]");break;default:sn($e.link(Jr));break}sn(";")}});function Qe(Hr,Jr){mr.forEach(function(Bn){var gi=Xr[Bn];if(!!Zr.isDynamic(gi)){var mi=Hr.invoke(Jr,gi);Jr(vr,".",Bn,"=",mi,";")}})}Fe.dynamic[yr]=new Zr.DynamicVariable(ou,{thisDep:pr,contextDep:kr,propDep:Ve,ref:vr,append:Qe}),delete Fe.static[yr]}function so($e,Fe,yr,Xr,sn){var mr=Yn();mr.stats=mr.link(sn),Object.keys(Fe.static).forEach(function(kr){Ri(mr,Fe,kr)}),Gm.forEach(function(kr){Ri(mr,$e,kr)});var pr=Qs($e,Fe,yr,Xr,mr);return Eo(mr,pr),an(mr,pr),Ke(mr,pr),I(mr.compile(),{destroy:function(){pr.shader.program.destroy()}})}return{next:Ti,current:Qn,procs:function(){var $e=Yn(),Fe=$e.proc("poll"),yr=$e.proc("refresh"),Xr=$e.block();Fe(Xr),yr(Xr);var sn=$e.shared,mr=sn.gl,pr=sn.next,kr=sn.current;Xr(kr,".dirty=false;"),Tu($e,Fe),Tu($e,yr,null,!0);var Ve;Xn&&(Ve=$e.link(Xn)),dr.oes_vertex_array_object&&yr($e.link(dr.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var vr=0;vr<cn.maxAttributes;++vr){var Qe=yr.def(sn.attributes,"[",vr,"]"),Hr=$e.cond(Qe,".buffer");Hr.then(mr,".enableVertexAttribArray(",vr,");",mr,".bindBuffer(",Bs,",",Qe,".buffer.buffer);",mr,".vertexAttribPointer(",vr,",",Qe,".size,",Qe,".type,",Qe,".normalized,",Qe,".stride,",Qe,".offset);").else(mr,".disableVertexAttribArray(",vr,");",mr,".vertexAttrib4f(",vr,",",Qe,".x,",Qe,".y,",Qe,".z,",Qe,".w);",Qe,".buffer=null;"),yr(Hr),Xn&&yr(Ve,".vertexAttribDivisorANGLE(",vr,",",Qe,".divisor);")}return yr($e.shared.vao,".currentVAO=null;",$e.shared.vao,".setVAO(",$e.shared.vao,".targetVAO);"),Object.keys(_n).forEach(function(Jr){var Bn=_n[Jr],gi=Xr.def(pr,".",Jr),mi=$e.block();mi("if(",gi,"){",mr,".enable(",Bn,")}else{",mr,".disable(",Bn,")}",kr,".",Jr,"=",gi,";"),yr(mi),Fe("if(",gi,"!==",kr,".",Jr,"){",mi,"}")}),Object.keys(An).forEach(function(Jr){var Bn=An[Jr],gi=Qn[Jr],mi,pi,fi=$e.block();if(fi(mr,".",Bn,"("),ir(gi)){var Xi=gi.length;mi=$e.global.def(pr,".",Jr),pi=$e.global.def(kr,".",Jr),fi(fr(Xi,function(Pi){return mi+"["+Pi+"]"}),");",fr(Xi,function(Pi){return pi+"["+Pi+"]="+mi+"["+Pi+"];"}).join("")),Fe("if(",fr(Xi,function(Pi){return mi+"["+Pi+"]!=="+pi+"["+Pi+"]"}).join("||"),"){",fi,"}")}else mi=Xr.def(pr,".",Jr),pi=Xr.def(kr,".",Jr),fi(mi,");",kr,".",Jr,"=",mi,";"),Fe("if(",mi,"!==",pi,"){",fi,"}");yr(fi)}),$e.compile()}(),compile:so}}function Bd(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var X0=34918,Yp=34919,n0=35007,ic=function(It,Ue){if(!Ue.ext_disjoint_timer_query)return null;var dr=[];function cn(){return dr.pop()||Ue.ext_disjoint_timer_query.createQueryEXT()}function On(Xn){dr.push(Xn)}var on=[];function En(Xn){var vi=cn();Ue.ext_disjoint_timer_query.beginQueryEXT(n0,vi),on.push(vi),qn(on.length-1,on.length,Xn)}function Dn(){Ue.ext_disjoint_timer_query.endQueryEXT(n0)}function Hn(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Jn=[];function ii(){return Jn.pop()||new Hn}function ui(Xn){Jn.push(Xn)}var yi=[];function qn(Xn,vi,Rn){var Qn=ii();Qn.startQueryIndex=Xn,Qn.endQueryIndex=vi,Qn.sum=0,Qn.stats=Rn,yi.push(Qn)}var ri=[],Gr=[];function dn(){var Xn,vi,Rn=on.length;if(Rn!==0){Gr.length=Math.max(Gr.length,Rn+1),ri.length=Math.max(ri.length,Rn+1),ri[0]=0,Gr[0]=0;var Qn=0;for(Xn=0,vi=0;vi<on.length;++vi){var Ti=on[vi];Ue.ext_disjoint_timer_query.getQueryObjectEXT(Ti,Yp)?(Qn+=Ue.ext_disjoint_timer_query.getQueryObjectEXT(Ti,X0),On(Ti)):on[Xn++]=Ti,ri[vi+1]=Qn,Gr[vi+1]=Xn}for(on.length=Xn,Xn=0,vi=0;vi<yi.length;++vi){var aa=yi[vi],_n=aa.startQueryIndex,An=aa.endQueryIndex;aa.sum+=ri[An]-ri[_n];var oi=Gr[_n],Ei=Gr[An];Ei===oi?(aa.stats.gpuTime+=aa.sum/1e6,ui(aa)):(aa.startQueryIndex=oi,aa.endQueryIndex=Ei,yi[Xn++]=aa)}yi.length=Xn}}return{beginQuery:En,endQuery:Dn,pushScopeStats:qn,update:dn,getNumPendingQueries:function(){return on.length},clear:function(){dr.push.apply(dr,on);for(var Xn=0;Xn<dr.length;Xn++)Ue.ext_disjoint_timer_query.deleteQueryEXT(dr[Xn]);on.length=0,dr.length=0},restore:function(){on.length=0,dr.length=0}}},Th=16384,Nu=256,Ug=1024,Jf=34962,th="webglcontextlost",Qo="webglcontextrestored",$p=1,eh=2,uf=3;function qp(It,Ue){for(var dr=0;dr<It.length;++dr)if(It[dr]===Ue)return dr;return-1}function Hm(It){var Ue=Se(It);if(!Ue)return null;var dr=Ue.gl,cn=dr.getContextAttributes(),On=dr.isContextLost(),on=ze(dr,Ue);if(!on)return null;var En=zn(),Dn=Bd(),Hn=on.extensions,Jn=ic(dr,Hn),ii=Nn(),ui=dr.drawingBufferWidth,yi=dr.drawingBufferHeight,qn={tick:0,time:0,viewportWidth:ui,viewportHeight:yi,framebufferWidth:ui,framebufferHeight:yi,drawingBufferWidth:ui,drawingBufferHeight:yi,pixelRatio:Ue.pixelRatio},ri={},Gr={elements:null,primitive:4,count:-1,offset:0,instances:-1},dn=mf(dr,Hn),Xn=_t(dr,Dn,Ue,Qn),vi=iu(dr,Hn,Xn,Dn),Rn=Rr(dr,Hn,dn,Dn,Xn,vi,Gr);function Qn(ya){return Rn.destroyBuffer(ya)}var Ti=Kn(dr,En,Dn,Ue),aa=wu(dr,Hn,dn,function(){oi.procs.poll()},qn,Dn,Ue),_n=Wc(dr,Hn,dn,Dn,Ue),An=cr(dr,Hn,dn,aa,_n,Dn),oi=Xp(dr,En,Hn,dn,Xn,vi,aa,An,ri,Rn,Ti,Gr,qn,Jn,Ue),Ei=ua(dr,An,oi.procs.poll,qn,cn,Hn,dn),ti=oi.next,xi=dr.canvas,Mi=[],Ua=[],Yn=[],Ii=[Ue.onDestroy],Li=null;function Sa(){if(Mi.length===0){Jn&&Jn.update(),Li=null;return}Li=Tn.next(Sa),Jo();for(var ya=Mi.length-1;ya>=0;--ya){var eo=Mi[ya];eo&&eo(qn,null,0)}dr.flush(),Jn&&Jn.update()}function Da(){!Li&&Mi.length>0&&(Li=Tn.next(Sa))}function oo(){Li&&(Tn.cancel(Sa),Li=null)}function Is(ya){ya.preventDefault(),On=!0,oo(),Ua.forEach(function(eo){eo()})}function zs(ya){dr.getError(),On=!1,on.restore(),Ti.restore(),Xn.restore(),aa.restore(),_n.restore(),An.restore(),Rn.restore(),Jn&&Jn.restore(),oi.procs.refresh(),Da(),Yn.forEach(function(eo){eo()})}var io=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!io&&xi&&(xi.addEventListener(th,Is,!1),xi.addEventListener(Qo,zs,!1));function Au(){Mi.length=0,oo(),!io&&xi&&(xi.removeEventListener(th,Is),xi.removeEventListener(Qo,zs)),Ti.clear(),An.clear(),_n.clear(),Rn.clear(),aa.clear(),vi.clear(),Xn.clear(),Jn&&Jn.clear(),Ii.forEach(function(ya){ya()})}function Xo(ya){J(!!ya,"invalid args to regl({...})"),J.type(ya,"object","invalid args to regl({...})");function eo(mr){var pr=I({},mr);delete pr.uniforms,delete pr.attributes,delete pr.context,delete pr.vao,"stencil"in pr&&pr.stencil.op&&(pr.stencil.opBack=pr.stencil.opFront=pr.stencil.op,delete pr.stencil.op);function kr(Ve){if(Ve in pr){var vr=pr[Ve];delete pr[Ve],Object.keys(vr).forEach(function(Qe){pr[Ve+"."+Qe]=vr[Qe]})}}return kr("blend"),kr("depth"),kr("cull"),kr("stencil"),kr("polygonOffset"),kr("scissor"),kr("sample"),"vao"in mr&&(pr.vao=mr.vao),pr}function Eo(mr,pr){var kr={},Ve={};return Object.keys(mr).forEach(function(vr){var Qe=mr[vr];if(Zr.isDynamic(Qe)){Ve[vr]=Zr.unbox(Qe,vr);return}else if(pr&&Array.isArray(Qe)){for(var Hr=0;Hr<Qe.length;++Hr)if(Zr.isDynamic(Qe[Hr])){Ve[vr]=Zr.unbox(Qe,vr);return}}kr[vr]=Qe}),{dynamic:Ve,static:kr}}var So=Eo(ya.context||{},!0),Po=Eo(ya.uniforms||{},!0),Ke=Eo(ya.attributes||{},!1),an=Eo(eo(ya),!1),en={gpuTime:0,cpuTime:0,count:0},Ri=oi.compile(an,Ke,Po,So,en),so=Ri.draw,$e=Ri.batch,Fe=Ri.scope,yr=[];function Xr(mr){for(;yr.length<mr;)yr.push(null);return yr}function sn(mr,pr){var kr;if(On&&J.raise("context lost"),typeof mr=="function")return Fe.call(this,null,mr,0);if(typeof pr=="function")if(typeof mr=="number")for(kr=0;kr<mr;++kr)Fe.call(this,null,pr,kr);else if(Array.isArray(mr))for(kr=0;kr<mr.length;++kr)Fe.call(this,mr[kr],pr,kr);else return Fe.call(this,mr,pr,0);else if(typeof mr=="number"){if(mr>0)return $e.call(this,Xr(mr|0),mr|0)}else if(Array.isArray(mr)){if(mr.length)return $e.call(this,mr,mr.length)}else return so.call(this,mr)}return I(sn,{stats:en,destroy:function(){Ri.destroy()}})}var Qs=An.setFBO=Xo({framebuffer:Zr.define.call(null,$p,"framebuffer")});function su(ya,eo){var Eo=0;oi.procs.poll();var So=eo.color;So&&(dr.clearColor(+So[0]||0,+So[1]||0,+So[2]||0,+So[3]||0),Eo|=Th),"depth"in eo&&(dr.clearDepth(+eo.depth),Eo|=Nu),"stencil"in eo&&(dr.clearStencil(eo.stencil|0),Eo|=Ug),J(!!Eo,"called regl.clear with no buffer specified"),dr.clear(Eo)}function Tu(ya){if(J(typeof ya=="object"&&ya,"regl.clear() takes an object as input"),"framebuffer"in ya)if(ya.framebuffer&&ya.framebuffer_reglType==="framebufferCube")for(var eo=0;eo<6;++eo)Qs(I({framebuffer:ya.framebuffer.faces[eo]},ya),su);else Qs(ya,su);else su(null,ya)}function Js(ya){J.type(ya,"function","regl.frame() callback must be a function"),Mi.push(ya);function eo(){var Eo=qp(Mi,ya);J(Eo>=0,"cannot cancel a frame twice");function So(){var Po=qp(Mi,So);Mi[Po]=Mi[Mi.length-1],Mi.length-=1,Mi.length<=0&&oo()}Mi[Eo]=So}return Da(),{cancel:eo}}function zu(){var ya=ti.viewport,eo=ti.scissor_box;ya[0]=ya[1]=eo[0]=eo[1]=0,qn.viewportWidth=qn.framebufferWidth=qn.drawingBufferWidth=ya[2]=eo[2]=dr.drawingBufferWidth,qn.viewportHeight=qn.framebufferHeight=qn.drawingBufferHeight=ya[3]=eo[3]=dr.drawingBufferHeight}function Jo(){qn.tick+=1,qn.time=tu(),zu(),oi.procs.poll()}function La(){aa.refresh(),zu(),oi.procs.refresh(),Jn&&Jn.update()}function tu(){return(Nn()-ii)/1e3}La();function fo(ya,eo){J.type(eo,"function","listener callback must be a function");var Eo;switch(ya){case"frame":return Js(eo);case"lost":Eo=Ua;break;case"restore":Eo=Yn;break;case"destroy":Eo=Ii;break;default:J.raise("invalid event, must be one of frame,lost,restore,destroy")}return Eo.push(eo),{cancel:function(){for(var So=0;So<Eo.length;++So)if(Eo[So]===eo){Eo[So]=Eo[Eo.length-1],Eo.pop();return}}}}var Mu=I(Xo,{clear:Tu,prop:Zr.define.bind(null,$p),context:Zr.define.bind(null,eh),this:Zr.define.bind(null,uf),draw:Xo({}),buffer:function(ya){return Xn.create(ya,Jf,!1,!1)},elements:function(ya){return vi.create(ya,!1)},texture:aa.create2D,cube:aa.createCube,renderbuffer:_n.create,framebuffer:An.create,framebufferCube:An.createCube,vao:Rn.createVAO,attributes:cn,frame:Js,on:fo,limits:dn,hasExtension:function(ya){return dn.extensions.indexOf(ya.toLowerCase())>=0},read:Ei,destroy:Au,_gl:dr,_refresh:La,poll:function(){Jo(),Jn&&Jn.update()},now:tu,stats:Dn});return Ue.onDone(null,Mu),Mu}return Hm})},6158:function(gn){(function(Ot,ot){gn.exports=ot()})(this,function(){"use strict";var Ot,ot,kt;function bt(I,xt){if(!Ot)Ot=xt;else if(!ot)ot=xt;else{var K="var sharedChunk = {}; ("+Ot+")(sharedChunk); ("+ot+")(sharedChunk);",ut={};Ot(ut),kt=xt(ut),typeof window!="undefined"&&(kt.workerUrl=window.URL.createObjectURL(new Blob([K],{type:"text/javascript"})))}}return bt(["exports"],function(I){"use strict";function xt(f,d){return f(d={exports:{}},d.exports),d.exports}var K=ut;function ut(f,d,y,T){this.cx=3*f,this.bx=3*(y-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(T-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=T,this.p2x=y,this.p2y=T}ut.prototype.sampleCurveX=function(f){return((this.ax*f+this.bx)*f+this.cx)*f},ut.prototype.sampleCurveY=function(f){return((this.ay*f+this.by)*f+this.cy)*f},ut.prototype.sampleCurveDerivativeX=function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},ut.prototype.solveCurveX=function(f,d){var y,T,O,N,Z;for(d===void 0&&(d=1e-6),O=f,Z=0;Z<8;Z++){if(N=this.sampleCurveX(O)-f,Math.abs(N)<d)return O;var q=this.sampleCurveDerivativeX(O);if(Math.abs(q)<1e-6)break;O-=N/q}if((O=f)<(y=0))return y;if(O>(T=1))return T;for(;y<T;){if(N=this.sampleCurveX(O),Math.abs(N-f)<d)return O;f>N?y=O:T=O,O=.5*(T-y)+y}return O},ut.prototype.solve=function(f,d){return this.sampleCurveY(this.solveCurveX(f,d))};var ht=lt;function lt(f,d){this.x=f,this.y=d}lt.prototype={clone:function(){return new lt(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,d){return this.clone()._rotateAround(f,d)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var d=f.x-this.x,y=f.y-this.y;return d*d+y*y},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,d){return Math.atan2(this.x*d-this.y*f,this.x*f+this.y*d)},_matMult:function(f){var d=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=d,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var d=Math.cos(f),y=Math.sin(f),T=y*this.x+d*this.y;return this.x=d*this.x-y*this.y,this.y=T,this},_rotateAround:function(f,d){var y=Math.cos(f),T=Math.sin(f),O=d.y+T*(this.x-d.x)+y*(this.y-d.y);return this.x=d.x+y*(this.x-d.x)-T*(this.y-d.y),this.y=O,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},lt.convert=function(f){return f instanceof lt?f:Array.isArray(f)?new lt(f[0],f[1]):f};var tt=typeof self!="undefined"?self:{},be=Math.pow(2,53)-1;function it(f,d,y,T){var O=new K(f,d,y,T);return function(N){return O.solve(N)}}var st=it(.25,.1,.25,1);function Ut(f,d,y){return Math.min(y,Math.max(d,f))}function P(f,d,y){var T=y-d,O=((f-d)%T+T)%T+d;return O===d?y:O}function b(f){for(var d=[],y=arguments.length-1;y-- >0;)d[y]=arguments[y+1];for(var T=0,O=d;T<O.length;T+=1){var N=O[T];for(var Z in N)f[Z]=N[Z]}return f}var W=1;function fe(){return W++}function Ee(){return function f(d){return d?(d^16*Math.random()>>d/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,f)}()}function Te(f){return!!f&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(f)}function Mt(f,d){f.forEach(function(y){d[y]&&(d[y]=d[y].bind(d))})}function et(f,d){return f.indexOf(d,f.length-d.length)!==-1}function Dt(f,d,y){var T={};for(var O in f)T[O]=d.call(y||this,f[O],O,f);return T}function we(f,d,y){var T={};for(var O in f)d.call(y||this,f[O],O,f)&&(T[O]=f[O]);return T}function _e(f){return Array.isArray(f)?f.map(_e):typeof f=="object"&&f?Dt(f,_e):f}var ge={};function te(f){ge[f]||(typeof console!="undefined"&&console.warn(f),ge[f]=!0)}function xe(f,d,y){return(y.y-f.y)*(d.x-f.x)>(d.y-f.y)*(y.x-f.x)}function Ye(f){for(var d=0,y=0,T=f.length,O=T-1,N=void 0,Z=void 0;y<T;O=y++)d+=((Z=f[O]).x-(N=f[y]).x)*(N.y+Z.y);return d}function Lt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Qt(f){var d={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(T,O,N,Z){var q=N||Z;return d[O]=!q||q.toLowerCase(),""}),d["max-age"]){var y=parseInt(d["max-age"],10);isNaN(y)?delete d["max-age"]:d["max-age"]=y}return d}var ct=null;function Ct(f){if(ct==null){var d=f.navigator?f.navigator.userAgent:null;ct=!!f.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return ct}function Y(f){try{var d=tt[f];return d.setItem("_mapbox_test_",1),d.removeItem("_mapbox_test_"),!0}catch(y){return!1}}var yt,Xt,ie,Ce,er=tt.performance&&tt.performance.now?tt.performance.now.bind(tt.performance):Date.now.bind(Date),Ht=tt.requestAnimationFrame||tt.mozRequestAnimationFrame||tt.webkitRequestAnimationFrame||tt.msRequestAnimationFrame,ne=tt.cancelAnimationFrame||tt.mozCancelAnimationFrame||tt.webkitCancelAnimationFrame||tt.msCancelAnimationFrame,Me={now:er,frame:function(f){var d=Ht(f);return{cancel:function(){return ne(d)}}},getImageData:function(f,d){d===void 0&&(d=0);var y=tt.document.createElement("canvas"),T=y.getContext("2d");if(!T)throw new Error("failed to create canvas 2d context");return y.width=f.width,y.height=f.height,T.drawImage(f,0,0,f.width,f.height),T.getImageData(-d,-d,f.width+2*d,f.height+2*d)},resolveURL:function(f){return yt||(yt=tt.document.createElement("a")),yt.href=f,yt.href},hardwareConcurrency:tt.navigator&&tt.navigator.hardwareConcurrency||4,get devicePixelRatio(){return tt.devicePixelRatio},get prefersReducedMotion(){return!!tt.matchMedia&&(Xt==null&&(Xt=tt.matchMedia("(prefers-reduced-motion: reduce)")),Xt.matches)}},ae={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Je={supported:!1,testSupport:function(f){!or&&Ce&&(re?Jt(f):ie=f)}},or=!1,re=!1;function Jt(f){var d=f.createTexture();f.bindTexture(f.TEXTURE_2D,d);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Ce),f.isContextLost())return;Je.supported=!0}catch(y){}f.deleteTexture(d),or=!0}tt.document&&((Ce=tt.document.createElement("img")).onload=function(){ie&&Jt(ie),ie=null,re=!0},Ce.onerror=function(){or=!0,ie=null},Ce.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Et="01",$t=function(f,d){this._transformRequestFn=f,this._customAccessToken=d,this._createSkuToken()};function Yt(f){return f.indexOf("mapbox:")===0}$t.prototype._createSkuToken=function(){var f=function(){for(var d="",y=0;y<10;y++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Et,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=f.token,this._skuTokenExpiresAt=f.tokenExpiresAt},$t.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},$t.prototype.transformRequest=function(f,d){return this._transformRequestFn&&this._transformRequestFn(f,d)||{url:f}},$t.prototype.normalizeStyleURL=function(f,d){if(!Yt(f))return f;var y=Pe(f);return y.path="/styles/v1"+y.path,this._makeAPIURL(y,this._customAccessToken||d)},$t.prototype.normalizeGlyphsURL=function(f,d){if(!Yt(f))return f;var y=Pe(f);return y.path="/fonts/v1"+y.path,this._makeAPIURL(y,this._customAccessToken||d)},$t.prototype.normalizeSourceURL=function(f,d){if(!Yt(f))return f;var y=Pe(f);return y.path="/v4/"+y.authority+".json",y.params.push("secure"),this._makeAPIURL(y,this._customAccessToken||d)},$t.prototype.normalizeSpriteURL=function(f,d,y,T){var O=Pe(f);return Yt(f)?(O.path="/styles/v1"+O.path+"/sprite"+d+y,this._makeAPIURL(O,this._customAccessToken||T)):(O.path+=""+d+y,je(O))},$t.prototype.normalizeTileURL=function(f,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),f&&!Yt(f))return f;var y=Pe(f);y.path=y.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Me.devicePixelRatio>=2||d===512?"@2x":"")+(Je.supported?".webp":"$1")),y.path=y.path.replace(/^.+\/v4\//,"/"),y.path="/v4"+y.path;var T=this._customAccessToken||function(O){for(var N=0,Z=O;N<Z.length;N+=1){var q=Z[N].match(/^access_token=(.*)$/);if(q)return q[1]}return null}(y.params)||ae.ACCESS_TOKEN;return ae.REQUIRE_ACCESS_TOKEN&&T&&this._skuToken&&y.params.push("sku="+this._skuToken),this._makeAPIURL(y,T)},$t.prototype.canonicalizeTileURL=function(f,d){var y=Pe(f);if(!y.path.match(/(^\/v4\/)/)||!y.path.match(/\.[\w]+$/))return f;var T="mapbox://tiles/";T+=y.path.replace("/v4/","");var O=y.params;return d&&(O=O.filter(function(N){return!N.match(/^access_token=/)})),O.length&&(T+="?"+O.join("&")),T},$t.prototype.canonicalizeTileset=function(f,d){for(var y=!!d&&Yt(d),T=[],O=0,N=f.tiles||[];O<N.length;O+=1){var Z=N[O];At(Z)?T.push(this.canonicalizeTileURL(Z,y)):T.push(Z)}return T},$t.prototype._makeAPIURL=function(f,d){var y="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",T=Pe(ae.API_URL);if(f.protocol=T.protocol,f.authority=T.authority,f.protocol==="http"){var O=f.params.indexOf("secure");O>=0&&f.params.splice(O,1)}if(T.path!=="/"&&(f.path=""+T.path+f.path),!ae.REQUIRE_ACCESS_TOKEN)return je(f);if(!(d=d||ae.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+y);if(d[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+y);return f.params=f.params.filter(function(N){return N.indexOf("access_token")===-1}),f.params.push("access_token="+d),je(f)};var St=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function At(f){return St.test(f)}var ue=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Pe(f){var d=f.match(ue);if(!d)throw new Error("Unable to parse URL object");return{protocol:d[1],authority:d[2],path:d[3]||"/",params:d[4]?d[4].split("&"):[]}}function je(f){var d=f.params.length?"?"+f.params.join("&"):"";return f.protocol+"://"+f.authority+f.path+d}function Nt(f){if(!f)return null;var d=f.split(".");if(!d||d.length!==3)return null;try{return JSON.parse(decodeURIComponent(tt.atob(d[1]).split("").map(function(y){return"%"+("00"+y.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(y){return null}}var wt=function(f){this.type=f,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};wt.prototype.getStorageKey=function(f){var d,y=Nt(ae.ACCESS_TOKEN);return d=y&&y.u?tt.btoa(encodeURIComponent(y.u).replace(/%([0-9A-F]{2})/g,function(T,O){return String.fromCharCode(Number("0x"+O))})):ae.ACCESS_TOKEN||"",f?"mapbox.eventData."+f+":"+d:"mapbox.eventData:"+d},wt.prototype.fetchEventData=function(){var f=Y("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid");if(f)try{var T=tt.localStorage.getItem(d);T&&(this.eventData=JSON.parse(T));var O=tt.localStorage.getItem(y);O&&(this.anonId=O)}catch(N){te("Unable to read from LocalStorage")}},wt.prototype.saveEventData=function(){var f=Y("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid");if(f)try{tt.localStorage.setItem(y,this.anonId),Object.keys(this.eventData).length>=1&&tt.localStorage.setItem(d,JSON.stringify(this.eventData))}catch(T){te("Unable to write to LocalStorage")}},wt.prototype.processRequests=function(f){},wt.prototype.postEvent=function(f,d,y,T){var O=this;if(ae.EVENTS_URL){var N=Pe(ae.EVENTS_URL);N.params.push("access_token="+(T||ae.ACCESS_TOKEN||""));var Z={event:this.type,created:new Date(f).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:Et,userId:this.anonId},q=d?b(Z,d):Z,dt={url:je(N),headers:{"Content-Type":"text/plain"},body:JSON.stringify([q])};this.pendingRequest=Wn(dt,function(Pt){O.pendingRequest=null,y(Pt),O.saveEventData(),O.processRequests(T)})}},wt.prototype.queueRequest=function(f,d){this.queue.push(f),this.processRequests(d)};var Tt,Ft,J=function(f){function d(){f.call(this,"map.load"),this.success={},this.skuToken=""}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.postMapLoadEvent=function(y,T,O,N){this.skuToken=O,(ae.EVENTS_URL&&N||ae.ACCESS_TOKEN&&Array.isArray(y)&&y.some(function(Z){return Yt(Z)||At(Z)}))&&this.queueRequest({id:T,timestamp:Date.now()},N)},d.prototype.processRequests=function(y){var T=this;if(!this.pendingRequest&&this.queue.length!==0){var O=this.queue.shift(),N=O.id,Z=O.timestamp;N&&this.success[N]||(this.anonId||this.fetchEventData(),Te(this.anonId)||(this.anonId=Ee()),this.postEvent(Z,{skuToken:this.skuToken},function(q){q||N&&(T.success[N]=!0)},y))}},d}(wt),gt=new(function(f){function d(y){f.call(this,"appUserTurnstile"),this._customAccessToken=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.postTurnstileEvent=function(y,T){ae.EVENTS_URL&&ae.ACCESS_TOKEN&&Array.isArray(y)&&y.some(function(O){return Yt(O)||At(O)})&&this.queueRequest(Date.now(),T)},d.prototype.processRequests=function(y){var T=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var O=Nt(ae.ACCESS_TOKEN),N=O?O.u:ae.ACCESS_TOKEN,Z=N!==this.eventData.tokenU;Te(this.anonId)||(this.anonId=Ee(),Z=!0);var q=this.queue.shift();if(this.eventData.lastSuccess){var dt=new Date(this.eventData.lastSuccess),Pt=new Date(q),Zt=(q-this.eventData.lastSuccess)/864e5;Z=Z||Zt>=1||Zt<-1||dt.getDate()!==Pt.getDate()}else Z=!0;if(!Z)return this.processRequests();this.postEvent(q,{"enabled.telemetry":!1},function(qt){qt||(T.eventData.lastSuccess=q,T.eventData.tokenU=N)},y)}},d}(wt)),jt=gt.postTurnstileEvent.bind(gt),ve=new J,Gt=ve.postMapLoadEvent.bind(ve),Ae=500,He=50;function qe(){tt.caches&&!Tt&&(Tt=tt.caches.open("mapbox-tiles"))}function hr(f){var d=f.indexOf("?");return d<0?f:f.slice(0,d)}var tr,Br=1/0;function Lr(){return tr==null&&(tr=tt.OffscreenCanvas&&new tt.OffscreenCanvas(1,1).getContext("2d")&&typeof tt.createImageBitmap=="function"),tr}var Zr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Zr);var Tn=function(f){function d(y,T,O){T===401&&At(O)&&(y+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),f.call(this,y),this.status=T,this.url=O,this.name=this.constructor.name,this.message=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},d}(Error),rn=Lt()?function(){return self.worker&&self.worker.referrer}:function(){return(tt.location.protocol==="blob:"?tt.parent:tt).location.href},Nn,zn,jn=function(f,d){if(!(/^file:/.test(y=f.url)||/^file:/.test(rn())&&!/^\w+:/.test(y))){if(tt.fetch&&tt.Request&&tt.AbortController&&tt.Request.prototype.hasOwnProperty("signal"))return function(T,O){var N,Z=new tt.AbortController,q=new tt.Request(T.url,{method:T.method||"GET",body:T.body,credentials:T.credentials,headers:T.headers,referrer:rn(),signal:Z.signal}),dt=!1,Pt=!1,Zt=(N=q.url).indexOf("sku=")>0&&At(N);T.type==="json"&&q.headers.set("Accept","application/json");var qt=function(Oe,sr,lr){if(!Pt){if(Oe&&Oe.message!=="SecurityError"&&te(Oe),sr&&lr)return pe(sr);var Cr=Date.now();tt.fetch(q).then(function(gr){if(gr.ok){var Ur=Zt?gr.clone():null;return pe(gr,Ur,Cr)}return O(new Tn(gr.statusText,gr.status,T.url))}).catch(function(gr){gr.code!==20&&O(new Error(gr.message))})}},pe=function(Oe,sr,lr){(T.type==="arrayBuffer"?Oe.arrayBuffer():T.type==="json"?Oe.json():Oe.text()).then(function(Cr){Pt||(sr&&lr&&function(gr,Ur,Ar){if(qe(),Tt){var Dr={status:Ur.status,statusText:Ur.statusText,headers:new tt.Headers};Ur.headers.forEach(function(Fn,ni){return Dr.headers.set(ni,Fn)});var mn=Qt(Ur.headers.get("Cache-Control")||"");mn["no-store"]||(mn["max-age"]&&Dr.headers.set("Expires",new Date(Ar+1e3*mn["max-age"]).toUTCString()),new Date(Dr.headers.get("Expires")).getTime()-Ar<42e4||function(Fn,ni){if(Ft===void 0)try{new Response(new ReadableStream),Ft=!0}catch(ki){Ft=!1}Ft?ni(Fn.body):Fn.blob().then(ni)}(Ur,function(Fn){var ni=new tt.Response(Fn,Dr);qe(),Tt&&Tt.then(function(ki){return ki.put(hr(gr.url),ni)}).catch(function(ki){return te(ki.message)})}))}}(q,sr,lr),dt=!0,O(null,Cr,Oe.headers.get("Cache-Control"),Oe.headers.get("Expires")))}).catch(function(Cr){Pt||O(new Error(Cr.message))})};return Zt?function(Oe,sr){if(qe(),!Tt)return sr(null);var lr=hr(Oe.url);Tt.then(function(Cr){Cr.match(lr).then(function(gr){var Ur=function(Ar){if(!Ar)return!1;var Dr=new Date(Ar.headers.get("Expires")||0),mn=Qt(Ar.headers.get("Cache-Control")||"");return Dr>Date.now()&&!mn["no-cache"]}(gr);Cr.delete(lr),Ur&&Cr.put(lr,gr.clone()),sr(null,gr,Ur)}).catch(sr)}).catch(sr)}(q,qt):qt(null,null),{cancel:function(){Pt=!0,dt||Z.abort()}}}(f,d);if(Lt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,d,void 0,!0)}var y;return function(T,O){var N=new tt.XMLHttpRequest;for(var Z in N.open(T.method||"GET",T.url,!0),T.type==="arrayBuffer"&&(N.responseType="arraybuffer"),T.headers)N.setRequestHeader(Z,T.headers[Z]);return T.type==="json"&&(N.responseType="text",N.setRequestHeader("Accept","application/json")),N.withCredentials=T.credentials==="include",N.onerror=function(){O(new Error(N.statusText))},N.onload=function(){if((N.status>=200&&N.status<300||N.status===0)&&N.response!==null){var q=N.response;if(T.type==="json")try{q=JSON.parse(N.response)}catch(dt){return O(dt)}O(null,q,N.getResponseHeader("Cache-Control"),N.getResponseHeader("Expires"))}else O(new Tn(N.statusText,N.status,T.url))},N.send(T.body),{cancel:function(){return N.abort()}}}(f,d)},Sn=function(f,d){return jn(b(f,{type:"arrayBuffer"}),d)},Wn=function(f,d){return jn(b(f,{method:"POST"}),d)},Rt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Nn=[],zn=0;var Wt=function(f,d){if(Je.supported&&(f.headers||(f.headers={}),f.headers.accept="image/webp,*/*"),zn>=ae.MAX_PARALLEL_IMAGE_REQUESTS){var y={requestParameters:f,callback:d,cancelled:!1,cancel:function(){this.cancelled=!0}};return Nn.push(y),y}zn++;var T=!1,O=function(){if(!T)for(T=!0,zn--;Nn.length&&zn<ae.MAX_PARALLEL_IMAGE_REQUESTS;){var Z=Nn.shift();Z.cancelled||(Z.cancel=Wt(Z.requestParameters,Z.callback).cancel)}},N=Sn(f,function(Z,q,dt,Pt){O(),Z?d(Z):q&&(Lr()?function(Zt,qt){var pe=new tt.Blob([new Uint8Array(Zt)],{type:"image/png"});tt.createImageBitmap(pe).then(function(Oe){qt(null,Oe)}).catch(function(Oe){qt(new Error("Could not load image because of "+Oe.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(q,d):function(Zt,qt,pe,Oe){var sr=new tt.Image,lr=tt.URL;sr.onload=function(){qt(null,sr),lr.revokeObjectURL(sr.src),sr.onload=null,tt.requestAnimationFrame(function(){sr.src=Rt})},sr.onerror=function(){return qt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Cr=new tt.Blob([new Uint8Array(Zt)],{type:"image/png"});sr.cacheControl=pe,sr.expires=Oe,sr.src=Zt.byteLength?lr.createObjectURL(Cr):Rt}(q,d,dt,Pt))});return{cancel:function(){N.cancel(),O()}}};function oe(f,d,y){y[f]&&y[f].indexOf(d)!==-1||(y[f]=y[f]||[],y[f].push(d))}function Se(f,d,y){if(y&&y[f]){var T=y[f].indexOf(d);T!==-1&&y[f].splice(T,1)}}var ze=function(f,d){d===void 0&&(d={}),b(this,d),this.type=f},fr=function(f){function d(y,T){T===void 0&&(T={}),f.call(this,"error",b({error:y},T))}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(ze),wr=function(){};wr.prototype.on=function(f,d){return this._listeners=this._listeners||{},oe(f,d,this._listeners),this},wr.prototype.off=function(f,d){return Se(f,d,this._listeners),Se(f,d,this._oneTimeListeners),this},wr.prototype.once=function(f,d){return this._oneTimeListeners=this._oneTimeListeners||{},oe(f,d,this._oneTimeListeners),this},wr.prototype.fire=function(f,d){typeof f=="string"&&(f=new ze(f,d||{}));var y=f.type;if(this.listens(y)){f.target=this;for(var T=0,O=this._listeners&&this._listeners[y]?this._listeners[y].slice():[];T<O.length;T+=1)O[T].call(this,f);for(var N=0,Z=this._oneTimeListeners&&this._oneTimeListeners[y]?this._oneTimeListeners[y].slice():[];N<Z.length;N+=1){var q=Z[N];Se(y,q,this._oneTimeListeners),q.call(this,f)}var dt=this._eventedParent;dt&&(b(f,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),dt.fire(f))}else f instanceof fr&&console.error(f.error);return this},wr.prototype.listens=function(f){return this._listeners&&this._listeners[f]&&this._listeners[f].length>0||this._oneTimeListeners&&this._oneTimeListeners[f]&&this._oneTimeListeners[f].length>0||this._eventedParent&&this._eventedParent.listens(f)},wr.prototype.setEventedParent=function(f,d){return this._eventedParent=f,this._eventedParentData=d,this};var Le={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ur=function(f,d,y,T){this.message=(f?f+": ":"")+y,T&&(this.identifier=T),d!=null&&d.__line__&&(this.line=d.__line__)};function Wr(f){var d=f.value;return d?[new ur(f.key,d,"constants have been deprecated as of v8")]:[]}function wn(f){for(var d=[],y=arguments.length-1;y-- >0;)d[y]=arguments[y+1];for(var T=0,O=d;T<O.length;T+=1){var N=O[T];for(var Z in N)f[Z]=N[Z]}return f}function qr(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function Qr(f){if(Array.isArray(f))return f.map(Qr);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){var d={};for(var y in f)d[y]=Qr(f[y]);return d}return qr(f)}var Mn=function(f){function d(y,T){f.call(this,T),this.message=T,this.key=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(Error),bi=function(f,d){d===void 0&&(d=[]),this.parent=f,this.bindings={};for(var y=0,T=d;y<T.length;y+=1){var O=T[y];this.bindings[O[0]]=O[1]}};bi.prototype.concat=function(f){return new bi(this,f)},bi.prototype.get=function(f){if(this.bindings[f])return this.bindings[f];if(this.parent)return this.parent.get(f);throw new Error(f+" not found in scope.")},bi.prototype.has=function(f){return!!this.bindings[f]||!!this.parent&&this.parent.has(f)};var wi={kind:"null"},Kr={kind:"number"},ai={kind:"string"},li={kind:"boolean"},hi={kind:"color"},ra={kind:"object"},Ci={kind:"value"},Ba={kind:"collator"},po={kind:"formatted"},za={kind:"resolvedImage"};function Xa(f,d){return{kind:"array",itemType:f,N:d}}function Ta(f){if(f.kind==="array"){var d=Ta(f.itemType);return typeof f.N=="number"?"array<"+d+", "+f.N+">":f.itemType.kind==="value"?"array":"array<"+d+">"}return f.kind}var ga=[wi,Kr,ai,li,hi,po,ra,Xa(Ci),za];function no(f,d){if(d.kind==="error")return null;if(f.kind==="array"){if(d.kind==="array"&&(d.N===0&&d.itemType.kind==="value"||!no(f.itemType,d.itemType))&&(typeof f.N!="number"||f.N===d.N))return null}else{if(f.kind===d.kind)return null;if(f.kind==="value"){for(var y=0,T=ga;y<T.length;y+=1)if(!no(T[y],d))return null}}return"Expected "+Ta(f)+" but found "+Ta(d)+" instead."}function Vo(f,d){return d.some(function(y){return y.kind===f.kind})}function vo(f,d){return d.some(function(y){return y==="null"?f===null:y==="array"?Array.isArray(f):y==="object"?f&&!Array.isArray(f)&&typeof f=="object":y===typeof f})}var ja=xt(function(f,d){var y={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function T(q){return(q=Math.round(q))<0?0:q>255?255:q}function O(q){return T(q[q.length-1]==="%"?parseFloat(q)/100*255:parseInt(q))}function N(q){return(dt=q[q.length-1]==="%"?parseFloat(q)/100:parseFloat(q))<0?0:dt>1?1:dt;var dt}function Z(q,dt,Pt){return Pt<0?Pt+=1:Pt>1&&(Pt-=1),6*Pt<1?q+(dt-q)*Pt*6:2*Pt<1?dt:3*Pt<2?q+(dt-q)*(2/3-Pt)*6:q}try{d.parseCSSColor=function(q){var dt,Pt=q.replace(/ /g,"").toLowerCase();if(Pt in y)return y[Pt].slice();if(Pt[0]==="#")return Pt.length===4?(dt=parseInt(Pt.substr(1),16))>=0&&dt<=4095?[(3840&dt)>>4|(3840&dt)>>8,240&dt|(240&dt)>>4,15&dt|(15&dt)<<4,1]:null:Pt.length===7&&(dt=parseInt(Pt.substr(1),16))>=0&&dt<=16777215?[(16711680&dt)>>16,(65280&dt)>>8,255&dt,1]:null;var Zt=Pt.indexOf("("),qt=Pt.indexOf(")");if(Zt!==-1&&qt+1===Pt.length){var pe=Pt.substr(0,Zt),Oe=Pt.substr(Zt+1,qt-(Zt+1)).split(","),sr=1;switch(pe){case"rgba":if(Oe.length!==4)return null;sr=N(Oe.pop());case"rgb":return Oe.length!==3?null:[O(Oe[0]),O(Oe[1]),O(Oe[2]),sr];case"hsla":if(Oe.length!==4)return null;sr=N(Oe.pop());case"hsl":if(Oe.length!==3)return null;var lr=(parseFloat(Oe[0])%360+360)%360/360,Cr=N(Oe[1]),gr=N(Oe[2]),Ur=gr<=.5?gr*(Cr+1):gr+Cr-gr*Cr,Ar=2*gr-Ur;return[T(255*Z(Ar,Ur,lr+1/3)),T(255*Z(Ar,Ur,lr)),T(255*Z(Ar,Ur,lr-1/3)),sr];default:return null}}return null}}catch(q){}}).parseCSSColor,to=function(f,d,y,T){T===void 0&&(T=1),this.r=f,this.g=d,this.b=y,this.a=T};to.parse=function(f){if(f){if(f instanceof to)return f;if(typeof f=="string"){var d=ja(f);if(d)return new to(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3])}}},to.prototype.toString=function(){var f=this.toArray(),d=f[1],y=f[2],T=f[3];return"rgba("+Math.round(f[0])+","+Math.round(d)+","+Math.round(y)+","+T+")"},to.prototype.toArray=function(){var f=this.a;return f===0?[0,0,0,0]:[255*this.r/f,255*this.g/f,255*this.b/f,f]},to.black=new to(0,0,0,1),to.white=new to(1,1,1,1),to.transparent=new to(0,0,0,0),to.red=new to(1,0,0,1);var Uo=function(f,d,y){this.sensitivity=f?d?"variant":"case":d?"accent":"base",this.locale=y,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Uo.prototype.compare=function(f,d){return this.collator.compare(f,d)},Uo.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ju=function(f,d,y,T,O){this.text=f,this.image=d,this.scale=y,this.fontStack=T,this.textColor=O},Wo=function(f){this.sections=f};Wo.fromString=function(f){return new Wo([new ju(f,null,null,null,null)])},Wo.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(f){return f.text.length!==0||f.image&&f.image.name.length!==0})},Wo.factory=function(f){return f instanceof Wo?f:Wo.fromString(f)},Wo.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(f){return f.text}).join("")},Wo.prototype.serialize=function(){for(var f=["format"],d=0,y=this.sections;d<y.length;d+=1){var T=y[d];if(T.image)f.push(["image",T.image.name]);else{f.push(T.text);var O={};T.fontStack&&(O["text-font"]=["literal",T.fontStack.split(",")]),T.scale&&(O["font-scale"]=T.scale),T.textColor&&(O["text-color"]=["rgba"].concat(T.textColor.toArray())),f.push(O)}}return f};var bo=function(f){this.name=f.name,this.available=f.available};function nr(f,d,y,T){return typeof f=="number"&&f>=0&&f<=255&&typeof d=="number"&&d>=0&&d<=255&&typeof y=="number"&&y>=0&&y<=255?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:"Invalid rgba value ["+[f,d,y,T].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof T=="number"?[f,d,y,T]:[f,d,y]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ye(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof to||f instanceof Uo||f instanceof Wo||f instanceof bo)return!0;if(Array.isArray(f)){for(var d=0,y=f;d<y.length;d+=1)if(!ye(y[d]))return!1;return!0}if(typeof f=="object"){for(var T in f)if(!ye(f[T]))return!1;return!0}return!1}function Ge(f){if(f===null)return wi;if(typeof f=="string")return ai;if(typeof f=="boolean")return li;if(typeof f=="number")return Kr;if(f instanceof to)return hi;if(f instanceof Uo)return Ba;if(f instanceof Wo)return po;if(f instanceof bo)return za;if(Array.isArray(f)){for(var d,y=f.length,T=0,O=f;T<O.length;T+=1){var N=Ge(O[T]);if(d){if(d===N)continue;d=Ci;break}d=N}return Xa(d||Ci,y)}return ra}function Mr(f){var d=typeof f;return f===null?"":d==="string"||d==="number"||d==="boolean"?String(f):f instanceof to||f instanceof Wo||f instanceof bo?f.toString():JSON.stringify(f)}bo.prototype.toString=function(){return this.name},bo.fromString=function(f){return f?new bo({name:f,available:!1}):null},bo.prototype.serialize=function(){return["image",this.name]};var tn=function(f,d){this.type=f,this.value=d};tn.parse=function(f,d){if(f.length!==2)return d.error("'literal' expression requires exactly one argument, but found "+(f.length-1)+" instead.");if(!ye(f[1]))return d.error("invalid value");var y=f[1],T=Ge(y),O=d.expectedType;return T.kind!=="array"||T.N!==0||!O||O.kind!=="array"||typeof O.N=="number"&&O.N!==0||(T=O),new tn(T,y)},tn.prototype.evaluate=function(){return this.value},tn.prototype.eachChild=function(){},tn.prototype.outputDefined=function(){return!0},tn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof to?["rgba"].concat(this.value.toArray()):this.value instanceof Wo?this.value.serialize():this.value};var In=function(f){this.name="ExpressionEvaluationError",this.message=f};In.prototype.toJSON=function(){return this.message};var Un={string:ai,number:Kr,boolean:li,object:ra},Cn=function(f,d){this.type=f,this.args=d};Cn.parse=function(f,d){if(f.length<2)return d.error("Expected at least one argument.");var y,T=1,O=f[0];if(O==="array"){var N,Z;if(f.length>2){var q=f[1];if(typeof q!="string"||!(q in Un)||q==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);N=Un[q],T++}else N=Ci;if(f.length>3){if(f[2]!==null&&(typeof f[2]!="number"||f[2]<0||f[2]!==Math.floor(f[2])))return d.error('The length argument to "array" must be a positive integer literal',2);Z=f[2],T++}y=Xa(N,Z)}else y=Un[O];for(var dt=[];T<f.length;T++){var Pt=d.parse(f[T],T,Ci);if(!Pt)return null;dt.push(Pt)}return new Cn(y,dt)},Cn.prototype.evaluate=function(f){for(var d=0;d<this.args.length;d++){var y=this.args[d].evaluate(f);if(!no(this.type,Ge(y)))return y;if(d===this.args.length-1)throw new In("Expected value to be of type "+Ta(this.type)+", but found "+Ta(Ge(y))+" instead.")}return null},Cn.prototype.eachChild=function(f){this.args.forEach(f)},Cn.prototype.outputDefined=function(){return this.args.every(function(f){return f.outputDefined()})},Cn.prototype.serialize=function(){var f=this.type,d=[f.kind];if(f.kind==="array"){var y=f.itemType;if(y.kind==="string"||y.kind==="number"||y.kind==="boolean"){d.push(y.kind);var T=f.N;(typeof T=="number"||this.args.length>1)&&d.push(T)}}return d.concat(this.args.map(function(O){return O.serialize()}))};var ta=function(f){this.type=po,this.sections=f};ta.parse=function(f,d){if(f.length<2)return d.error("Expected at least one argument.");var y=f[1];if(!Array.isArray(y)&&typeof y=="object")return d.error("First argument must be an image or text section.");for(var T=[],O=!1,N=1;N<=f.length-1;++N){var Z=f[N];if(O&&typeof Z=="object"&&!Array.isArray(Z)){O=!1;var q=null;if(Z["font-scale"]&&!(q=d.parse(Z["font-scale"],1,Kr)))return null;var dt=null;if(Z["text-font"]&&!(dt=d.parse(Z["text-font"],1,Xa(ai))))return null;var Pt=null;if(Z["text-color"]&&!(Pt=d.parse(Z["text-color"],1,hi)))return null;var Zt=T[T.length-1];Zt.scale=q,Zt.font=dt,Zt.textColor=Pt}else{var qt=d.parse(f[N],1,Ci);if(!qt)return null;var pe=qt.type.kind;if(pe!=="string"&&pe!=="value"&&pe!=="null"&&pe!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");O=!0,T.push({content:qt,scale:null,font:null,textColor:null})}}return new ta(T)},ta.prototype.evaluate=function(f){return new Wo(this.sections.map(function(d){var y=d.content.evaluate(f);return Ge(y)===za?new ju("",y,null,null,null):new ju(Mr(y),null,d.scale?d.scale.evaluate(f):null,d.font?d.font.evaluate(f).join(","):null,d.textColor?d.textColor.evaluate(f):null)}))},ta.prototype.eachChild=function(f){for(var d=0,y=this.sections;d<y.length;d+=1){var T=y[d];f(T.content),T.scale&&f(T.scale),T.font&&f(T.font),T.textColor&&f(T.textColor)}},ta.prototype.outputDefined=function(){return!1},ta.prototype.serialize=function(){for(var f=["format"],d=0,y=this.sections;d<y.length;d+=1){var T=y[d];f.push(T.content.serialize());var O={};T.scale&&(O["font-scale"]=T.scale.serialize()),T.font&&(O["text-font"]=T.font.serialize()),T.textColor&&(O["text-color"]=T.textColor.serialize()),f.push(O)}return f};var Wa=function(f){this.type=za,this.input=f};Wa.parse=function(f,d){if(f.length!==2)return d.error("Expected two arguments.");var y=d.parse(f[1],1,ai);return y?new Wa(y):d.error("No image name provided.")},Wa.prototype.evaluate=function(f){var d=this.input.evaluate(f),y=bo.fromString(d);return y&&f.availableImages&&(y.available=f.availableImages.indexOf(d)>-1),y},Wa.prototype.eachChild=function(f){f(this.input)},Wa.prototype.outputDefined=function(){return!1},Wa.prototype.serialize=function(){return["image",this.input.serialize()]};var es={"to-boolean":li,"to-color":hi,"to-number":Kr,"to-string":ai},ko=function(f,d){this.type=f,this.args=d};ko.parse=function(f,d){if(f.length<2)return d.error("Expected at least one argument.");var y=f[0];if((y==="to-boolean"||y==="to-string")&&f.length!==2)return d.error("Expected one argument.");for(var T=es[y],O=[],N=1;N<f.length;N++){var Z=d.parse(f[N],N,Ci);if(!Z)return null;O.push(Z)}return new ko(T,O)},ko.prototype.evaluate=function(f){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(f));if(this.type.kind==="color"){for(var d,y,T=0,O=this.args;T<O.length;T+=1){if(y=null,(d=O[T].evaluate(f))instanceof to)return d;if(typeof d=="string"){var N=f.parseColor(d);if(N)return N}else if(Array.isArray(d)&&!(y=d.length<3||d.length>4?"Invalid rbga value "+JSON.stringify(d)+": expected an array containing either three or four numeric values.":nr(d[0],d[1],d[2],d[3])))return new to(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new In(y||"Could not parse color from value '"+(typeof d=="string"?d:String(JSON.stringify(d)))+"'")}if(this.type.kind==="number"){for(var Z=null,q=0,dt=this.args;q<dt.length;q+=1){if((Z=dt[q].evaluate(f))===null)return 0;var Pt=Number(Z);if(!isNaN(Pt))return Pt}throw new In("Could not convert "+JSON.stringify(Z)+" to number.")}return this.type.kind==="formatted"?Wo.fromString(Mr(this.args[0].evaluate(f))):this.type.kind==="resolvedImage"?bo.fromString(Mr(this.args[0].evaluate(f))):Mr(this.args[0].evaluate(f))},ko.prototype.eachChild=function(f){this.args.forEach(f)},ko.prototype.outputDefined=function(){return this.args.every(function(f){return f.outputDefined()})},ko.prototype.serialize=function(){if(this.type.kind==="formatted")return new ta([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Wa(this.args[0]).serialize();var f=["to-"+this.type.kind];return this.eachChild(function(d){f.push(d.serialize())}),f};var ns=["Unknown","Point","LineString","Polygon"],Ya=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ya.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ya.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?ns[this.feature.type]:this.feature.type:null},Ya.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ya.prototype.canonicalID=function(){return this.canonical},Ya.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ya.prototype.parseColor=function(f){var d=this._parseColorCache[f];return d||(d=this._parseColorCache[f]=to.parse(f)),d};var Go=function(f,d,y,T){this.name=f,this.type=d,this._evaluate=y,this.args=T};Go.prototype.evaluate=function(f){return this._evaluate(f,this.args)},Go.prototype.eachChild=function(f){this.args.forEach(f)},Go.prototype.outputDefined=function(){return!1},Go.prototype.serialize=function(){return[this.name].concat(this.args.map(function(f){return f.serialize()}))},Go.parse=function(f,d){var y,T=f[0],O=Go.definitions[T];if(!O)return d.error('Unknown expression "'+T+'". If you wanted a literal array, use ["literal", [...]].',0);for(var N=Array.isArray(O)?O[0]:O.type,Z=Array.isArray(O)?[[O[1],O[2]]]:O.overloads,q=Z.filter(function(ca){var zi=ca[0];return!Array.isArray(zi)||zi.length===f.length-1}),dt=null,Pt=0,Zt=q;Pt<Zt.length;Pt+=1){var qt=Zt[Pt],pe=qt[0],Oe=qt[1];dt=new nu(d.registry,d.path,null,d.scope);for(var sr=[],lr=!1,Cr=1;Cr<f.length;Cr++){var gr=f[Cr],Ur=Array.isArray(pe)?pe[Cr-1]:pe.type,Ar=dt.parse(gr,1+sr.length,Ur);if(!Ar){lr=!0;break}sr.push(Ar)}if(!lr)if(Array.isArray(pe)&&pe.length!==sr.length)dt.error("Expected "+pe.length+" arguments, but found "+sr.length+" instead.");else{for(var Dr=0;Dr<sr.length;Dr++){var mn=Array.isArray(pe)?pe[Dr]:pe.type,Fn=sr[Dr];dt.concat(Dr+1).checkSubtype(mn,Fn.type)}if(dt.errors.length===0)return new Go(T,N,Oe,sr)}}if(q.length===1)(y=d.errors).push.apply(y,dt.errors);else{for(var ni=(q.length?q:Z).map(function(ca){var zi;return zi=ca[0],Array.isArray(zi)?"("+zi.map(Ta).join(", ")+")":"("+Ta(zi.type)+"...)"}).join(" | "),ki=[],oa=1;oa<f.length;oa++){var Di=d.parse(f[oa],1+ki.length);if(!Di)return null;ki.push(Ta(Di.type))}d.error("Expected arguments of type "+ni+", but found ("+ki.join(", ")+") instead.")}return null},Go.register=function(f,d){for(var y in Go.definitions=d,d)f[y]=Go};var pu=function(f,d,y){this.type=Ba,this.locale=y,this.caseSensitive=f,this.diacriticSensitive=d};function ys(f,d){f[0]=Math.min(f[0],d[0]),f[1]=Math.min(f[1],d[1]),f[2]=Math.max(f[2],d[0]),f[3]=Math.max(f[3],d[1])}function Rl(f,d){return!(f[0]<=d[0]||f[2]>=d[2]||f[1]<=d[1]||f[3]>=d[3])}function mf(f,d){var y=(180+f[0])/360,T=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,O=Math.pow(2,d.z);return[Math.round(y*O*8192),Math.round(T*O*8192)]}function Wu(f,d,y){return d[1]>f[1]!=y[1]>f[1]&&f[0]<(y[0]-d[0])*(f[1]-d[1])/(y[1]-d[1])+d[0]}function Ie(f,d){for(var y,T,O,N,Z,q,dt,Pt=!1,Zt=0,qt=d.length;Zt<qt;Zt++)for(var pe=d[Zt],Oe=0,sr=pe.length;Oe<sr-1;Oe++){if((N=(y=f)[0]-(T=pe[Oe])[0])*(dt=y[1]-(O=pe[Oe+1])[1])-(q=y[0]-O[0])*(Z=y[1]-T[1])==0&&N*q<=0&&Z*dt<=0)return!1;Wu(f,pe[Oe],pe[Oe+1])&&(Pt=!Pt)}return Pt}function We(f,d){for(var y=0;y<d.length;y++)if(Ie(f,d[y]))return!0;return!1}function Tr(f,d,y,T){var O=T[0]-y[0],N=T[1]-y[1],Z=(f[0]-y[0])*N-O*(f[1]-y[1]),q=(d[0]-y[0])*N-O*(d[1]-y[1]);return Z>0&&q<0||Z<0&&q>0}function un(f,d,y){for(var T=0,O=y;T<O.length;T+=1)for(var N=O[T],Z=0;Z<N.length-1;++Z)if((qt=[(Zt=N[Z+1])[0]-(Pt=N[Z])[0],Zt[1]-Pt[1]])[0]*(pe=[(dt=d)[0]-(q=f)[0],dt[1]-q[1]])[1]-qt[1]*pe[0]!=0&&Tr(q,dt,Pt,Zt)&&Tr(Pt,Zt,q,dt))return!0;var q,dt,Pt,Zt,qt,pe;return!1}function si(f,d){for(var y=0;y<f.length;++y)if(!Ie(f[y],d))return!1;for(var T=0;T<f.length-1;++T)if(un(f[T],f[T+1],d))return!1;return!0}function ji(f,d){for(var y=0;y<d.length;y++)if(si(f,d[y]))return!0;return!1}function Ma(f,d,y){for(var T=[],O=0;O<f.length;O++){for(var N=[],Z=0;Z<f[O].length;Z++){var q=mf(f[O][Z],y);ys(d,q),N.push(q)}T.push(N)}return T}function ds(f,d,y){for(var T=[],O=0;O<f.length;O++){var N=Ma(f[O],d,y);T.push(N)}return T}function Ho(f,d,y,T){if(f[0]<y[0]||f[0]>y[2]){var O=.5*T,N=f[0]-y[0]>O?-T:y[0]-f[0]>O?T:0;N===0&&(N=f[0]-y[2]>O?-T:y[2]-f[0]>O?T:0),f[0]+=N}ys(d,f)}function qo(f,d,y,T){for(var O=8192*Math.pow(2,T.z),N=[8192*T.x,8192*T.y],Z=[],q=0,dt=f;q<dt.length;q+=1)for(var Pt=0,Zt=dt[q];Pt<Zt.length;Pt+=1){var qt=Zt[Pt],pe=[qt.x+N[0],qt.y+N[1]];Ho(pe,d,y,O),Z.push(pe)}return Z}function Hs(f,d,y,T){for(var O,N=8192*Math.pow(2,T.z),Z=[8192*T.x,8192*T.y],q=[],dt=0,Pt=f;dt<Pt.length;dt+=1){for(var Zt=[],qt=0,pe=Pt[dt];qt<pe.length;qt+=1){var Oe=pe[qt],sr=[Oe.x+Z[0],Oe.y+Z[1]];ys(d,sr),Zt.push(sr)}q.push(Zt)}if(d[2]-d[0]<=N/2){(O=d)[0]=O[1]=1/0,O[2]=O[3]=-1/0;for(var lr=0,Cr=q;lr<Cr.length;lr+=1)for(var gr=0,Ur=Cr[lr];gr<Ur.length;gr+=1)Ho(Ur[gr],d,y,N)}return q}pu.parse=function(f,d){if(f.length!==2)return d.error("Expected one argument.");var y=f[1];if(typeof y!="object"||Array.isArray(y))return d.error("Collator options argument must be an object.");var T=d.parse(y["case-sensitive"]!==void 0&&y["case-sensitive"],1,li);if(!T)return null;var O=d.parse(y["diacritic-sensitive"]!==void 0&&y["diacritic-sensitive"],1,li);if(!O)return null;var N=null;return y.locale&&!(N=d.parse(y.locale,1,ai))?null:new pu(T,O,N)},pu.prototype.evaluate=function(f){return new Uo(this.caseSensitive.evaluate(f),this.diacriticSensitive.evaluate(f),this.locale?this.locale.evaluate(f):null)},pu.prototype.eachChild=function(f){f(this.caseSensitive),f(this.diacriticSensitive),this.locale&&f(this.locale)},pu.prototype.outputDefined=function(){return!1},pu.prototype.serialize=function(){var f={};return f["case-sensitive"]=this.caseSensitive.serialize(),f["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(f.locale=this.locale.serialize()),["collator",f]};var Xu=function(f,d){this.type=li,this.geojson=f,this.geometries=d};function _s(f){if(f instanceof Go&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof Xu)return!1;var d=!0;return f.eachChild(function(y){d&&!_s(y)&&(d=!1)}),d}function vs(f){if(f instanceof Go&&f.name==="feature-state")return!1;var d=!0;return f.eachChild(function(y){d&&!vs(y)&&(d=!1)}),d}function Ou(f,d){if(f instanceof Go&&d.indexOf(f.name)>=0)return!1;var y=!0;return f.eachChild(function(T){y&&!Ou(T,d)&&(y=!1)}),y}Xu.parse=function(f,d){if(f.length!==2)return d.error("'within' expression requires exactly one argument, but found "+(f.length-1)+" instead.");if(ye(f[1])){var y=f[1];if(y.type==="FeatureCollection")for(var T=0;T<y.features.length;++T){var O=y.features[T].geometry.type;if(O==="Polygon"||O==="MultiPolygon")return new Xu(y,y.features[T].geometry)}else if(y.type==="Feature"){var N=y.geometry.type;if(N==="Polygon"||N==="MultiPolygon")return new Xu(y,y.geometry)}else if(y.type==="Polygon"||y.type==="MultiPolygon")return new Xu(y,y)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Xu.prototype.evaluate=function(f){if(f.geometry()!=null&&f.canonicalID()!=null){if(f.geometryType()==="Point")return function(d,y){var T=[1/0,1/0,-1/0,-1/0],O=[1/0,1/0,-1/0,-1/0],N=d.canonicalID();if(y.type==="Polygon"){var Z=Ma(y.coordinates,O,N),q=qo(d.geometry(),T,O,N);if(!Rl(T,O))return!1;for(var dt=0,Pt=q;dt<Pt.length;dt+=1)if(!Ie(Pt[dt],Z))return!1}if(y.type==="MultiPolygon"){var Zt=ds(y.coordinates,O,N),qt=qo(d.geometry(),T,O,N);if(!Rl(T,O))return!1;for(var pe=0,Oe=qt;pe<Oe.length;pe+=1)if(!We(Oe[pe],Zt))return!1}return!0}(f,this.geometries);if(f.geometryType()==="LineString")return function(d,y){var T=[1/0,1/0,-1/0,-1/0],O=[1/0,1/0,-1/0,-1/0],N=d.canonicalID();if(y.type==="Polygon"){var Z=Ma(y.coordinates,O,N),q=Hs(d.geometry(),T,O,N);if(!Rl(T,O))return!1;for(var dt=0,Pt=q;dt<Pt.length;dt+=1)if(!si(Pt[dt],Z))return!1}if(y.type==="MultiPolygon"){var Zt=ds(y.coordinates,O,N),qt=Hs(d.geometry(),T,O,N);if(!Rl(T,O))return!1;for(var pe=0,Oe=qt;pe<Oe.length;pe+=1)if(!ji(Oe[pe],Zt))return!1}return!0}(f,this.geometries)}return!1},Xu.prototype.eachChild=function(){},Xu.prototype.outputDefined=function(){return!0},Xu.prototype.serialize=function(){return["within",this.geojson]};var rl=function(f,d){this.type=d.type,this.name=f,this.boundExpression=d};rl.parse=function(f,d){if(f.length!==2||typeof f[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");var y=f[1];return d.scope.has(y)?new rl(y,d.scope.get(y)):d.error('Unknown variable "'+y+'". Make sure "'+y+'" has been bound in an enclosing "let" expression before using it.',1)},rl.prototype.evaluate=function(f){return this.boundExpression.evaluate(f)},rl.prototype.eachChild=function(){},rl.prototype.outputDefined=function(){return!1},rl.prototype.serialize=function(){return["var",this.name]};var nu=function(f,d,y,T,O){d===void 0&&(d=[]),T===void 0&&(T=new bi),O===void 0&&(O=[]),this.registry=f,this.path=d,this.key=d.map(function(N){return"["+N+"]"}).join(""),this.scope=T,this.errors=O,this.expectedType=y};function dl(f,d){for(var y,T=f.length-1,O=0,N=T,Z=0;O<=N;)if((y=f[Z=Math.floor((O+N)/2)])<=d){if(Z===T||d<f[Z+1])return Z;O=Z+1}else{if(!(y>d))throw new In("Input is not a number.");N=Z-1}return 0}nu.prototype.parse=function(f,d,y,T,O){return O===void 0&&(O={}),d?this.concat(d,y,T)._parse(f,O):this._parse(f,O)},nu.prototype._parse=function(f,d){function y(Pt,Zt,qt){return qt==="assert"?new Cn(Zt,[Pt]):qt==="coerce"?new ko(Zt,[Pt]):Pt}if(f!==null&&typeof f!="string"&&typeof f!="boolean"&&typeof f!="number"||(f=["literal",f]),Array.isArray(f)){if(f.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var T=f[0];if(typeof T!="string")return this.error("Expression name must be a string, but found "+typeof T+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var O=this.registry[T];if(O){var N=O.parse(f,this);if(!N)return null;if(this.expectedType){var Z=this.expectedType,q=N.type;if(Z.kind!=="string"&&Z.kind!=="number"&&Z.kind!=="boolean"&&Z.kind!=="object"&&Z.kind!=="array"||q.kind!=="value")if(Z.kind!=="color"&&Z.kind!=="formatted"&&Z.kind!=="resolvedImage"||q.kind!=="value"&&q.kind!=="string"){if(this.checkSubtype(Z,q))return null}else N=y(N,Z,d.typeAnnotation||"coerce");else N=y(N,Z,d.typeAnnotation||"assert")}if(!(N instanceof tn)&&N.type.kind!=="resolvedImage"&&function Pt(Zt){if(Zt instanceof rl)return Pt(Zt.boundExpression);if(Zt instanceof Go&&Zt.name==="error"||Zt instanceof pu||Zt instanceof Xu)return!1;var qt=Zt instanceof ko||Zt instanceof Cn,pe=!0;return Zt.eachChild(function(Oe){pe=qt?pe&&Pt(Oe):pe&&Oe instanceof tn}),!!pe&&_s(Zt)&&Ou(Zt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(N)){var dt=new Ya;try{N=new tn(N.type,N.evaluate(dt))}catch(Pt){return this.error(Pt.message),null}}return N}return this.error('Unknown expression "'+T+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(f===void 0?"'undefined' value invalid. Use null instead.":typeof f=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof f+" instead.")},nu.prototype.concat=function(f,d,y){var T=typeof f=="number"?this.path.concat(f):this.path,O=y?this.scope.concat(y):this.scope;return new nu(this.registry,T,d||null,O,this.errors)},nu.prototype.error=function(f){for(var d=[],y=arguments.length-1;y-- >0;)d[y]=arguments[y+1];var T=""+this.key+d.map(function(O){return"["+O+"]"}).join("");this.errors.push(new Mn(T,f))},nu.prototype.checkSubtype=function(f,d){var y=no(f,d);return y&&this.error(y),y};var Fu=function(f,d,y){this.type=f,this.input=d,this.labels=[],this.outputs=[];for(var T=0,O=y;T<O.length;T+=1){var N=O[T],Z=N[1];this.labels.push(N[0]),this.outputs.push(Z)}};function Fo(f,d,y){return f*(1-y)+d*y}Fu.parse=function(f,d){if(f.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(f.length-1)+".");if((f.length-1)%2!=0)return d.error("Expected an even number of arguments.");var y=d.parse(f[1],1,Kr);if(!y)return null;var T=[],O=null;d.expectedType&&d.expectedType.kind!=="value"&&(O=d.expectedType);for(var N=1;N<f.length;N+=2){var Z=N===1?-1/0:f[N],q=f[N+1],dt=N,Pt=N+1;if(typeof Z!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',dt);if(T.length&&T[T.length-1][0]>=Z)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',dt);var Zt=d.parse(q,Pt,O);if(!Zt)return null;O=O||Zt.type,T.push([Z,Zt])}return new Fu(O,y,T)},Fu.prototype.evaluate=function(f){var d=this.labels,y=this.outputs;if(d.length===1)return y[0].evaluate(f);var T=this.input.evaluate(f);if(T<=d[0])return y[0].evaluate(f);var O=d.length;return T>=d[O-1]?y[O-1].evaluate(f):y[dl(d,T)].evaluate(f)},Fu.prototype.eachChild=function(f){f(this.input);for(var d=0,y=this.outputs;d<y.length;d+=1)f(y[d])},Fu.prototype.outputDefined=function(){return this.outputs.every(function(f){return f.outputDefined()})},Fu.prototype.serialize=function(){for(var f=["step",this.input.serialize()],d=0;d<this.labels.length;d++)d>0&&f.push(this.labels[d]),f.push(this.outputs[d].serialize());return f};var rs=Object.freeze({__proto__:null,number:Fo,color:function(f,d,y){return new to(Fo(f.r,d.r,y),Fo(f.g,d.g,y),Fo(f.b,d.b,y),Fo(f.a,d.a,y))},array:function(f,d,y){return f.map(function(T,O){return Fo(T,d[O],y)})}}),Uc=6/29*3*(6/29),_u=Math.PI/180,Zc=180/Math.PI;function Co(f){return f>.008856451679035631?Math.pow(f,1/3):f/Uc+4/29}function sc(f){return f>6/29?f*f*f:Uc*(f-4/29)}function Xl(f){return 255*(f<=.0031308?12.92*f:1.055*Math.pow(f,1/2.4)-.055)}function nl(f){return(f/=255)<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function uc(f){var d=nl(f.r),y=nl(f.g),T=nl(f.b),O=Co((.4124564*d+.3575761*y+.1804375*T)/.95047),N=Co((.2126729*d+.7151522*y+.072175*T)/1);return{l:116*N-16,a:500*(O-N),b:200*(N-Co((.0193339*d+.119192*y+.9503041*T)/1.08883)),alpha:f.a}}function D(f){var d=(f.l+16)/116,y=isNaN(f.a)?d:d+f.a/500,T=isNaN(f.b)?d:d-f.b/200;return d=1*sc(d),y=.95047*sc(y),T=1.08883*sc(T),new to(Xl(3.2404542*y-1.5371385*d-.4985314*T),Xl(-.969266*y+1.8760108*d+.041556*T),Xl(.0556434*y-.2040259*d+1.0572252*T),f.alpha)}function X(f,d,y){var T=d-f;return f+y*(T>180||T<-180?T-360*Math.round(T/360):T)}var _t={forward:uc,reverse:D,interpolate:function(f,d,y){return{l:Fo(f.l,d.l,y),a:Fo(f.a,d.a,y),b:Fo(f.b,d.b,y),alpha:Fo(f.alpha,d.alpha,y)}}},rt={forward:function(f){var d=uc(f),y=d.l,T=d.a,O=d.b,N=Math.atan2(O,T)*Zc;return{h:N<0?N+360:N,c:Math.sqrt(T*T+O*O),l:y,alpha:f.a}},reverse:function(f){var d=f.h*_u,y=f.c;return D({l:f.l,a:Math.cos(d)*y,b:Math.sin(d)*y,alpha:f.alpha})},interpolate:function(f,d,y){return{h:X(f.h,d.h,y),c:Fo(f.c,d.c,y),l:Fo(f.l,d.l,y),alpha:Fo(f.alpha,d.alpha,y)}}},se=Object.freeze({__proto__:null,lab:_t,hcl:rt}),Ze=function(f,d,y,T,O){this.type=f,this.operator=d,this.interpolation=y,this.input=T,this.labels=[],this.outputs=[];for(var N=0,Z=O;N<Z.length;N+=1){var q=Z[N],dt=q[1];this.labels.push(q[0]),this.outputs.push(dt)}};function Sr(f,d,y,T){var O=T-y,N=f-y;return O===0?0:d===1?N/O:(Math.pow(d,N)-1)/(Math.pow(d,O)-1)}Ze.interpolationFactor=function(f,d,y,T){var O=0;if(f.name==="exponential")O=Sr(d,f.base,y,T);else if(f.name==="linear")O=Sr(d,1,y,T);else if(f.name==="cubic-bezier"){var N=f.controlPoints;O=new K(N[0],N[1],N[2],N[3]).solve(Sr(d,1,y,T))}return O},Ze.parse=function(f,d){var y=f[0],T=f[1],O=f[2],N=f.slice(3);if(!Array.isArray(T)||T.length===0)return d.error("Expected an interpolation type expression.",1);if(T[0]==="linear")T={name:"linear"};else if(T[0]==="exponential"){var Z=T[1];if(typeof Z!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);T={name:"exponential",base:Z}}else{if(T[0]!=="cubic-bezier")return d.error("Unknown interpolation type "+String(T[0]),1,0);var q=T.slice(1);if(q.length!==4||q.some(function(Cr){return typeof Cr!="number"||Cr<0||Cr>1}))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);T={name:"cubic-bezier",controlPoints:q}}if(f.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(f.length-1)+".");if((f.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(!(O=d.parse(O,2,Kr)))return null;var dt=[],Pt=null;y==="interpolate-hcl"||y==="interpolate-lab"?Pt=hi:d.expectedType&&d.expectedType.kind!=="value"&&(Pt=d.expectedType);for(var Zt=0;Zt<N.length;Zt+=2){var qt=N[Zt],pe=N[Zt+1],Oe=Zt+3,sr=Zt+4;if(typeof qt!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Oe);if(dt.length&&dt[dt.length-1][0]>=qt)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Oe);var lr=d.parse(pe,sr,Pt);if(!lr)return null;Pt=Pt||lr.type,dt.push([qt,lr])}return Pt.kind==="number"||Pt.kind==="color"||Pt.kind==="array"&&Pt.itemType.kind==="number"&&typeof Pt.N=="number"?new Ze(Pt,y,T,O,dt):d.error("Type "+Ta(Pt)+" is not interpolatable.")},Ze.prototype.evaluate=function(f){var d=this.labels,y=this.outputs;if(d.length===1)return y[0].evaluate(f);var T=this.input.evaluate(f);if(T<=d[0])return y[0].evaluate(f);var O=d.length;if(T>=d[O-1])return y[O-1].evaluate(f);var N=dl(d,T),Z=Ze.interpolationFactor(this.interpolation,T,d[N],d[N+1]),q=y[N].evaluate(f),dt=y[N+1].evaluate(f);return this.operator==="interpolate"?rs[this.type.kind.toLowerCase()](q,dt,Z):this.operator==="interpolate-hcl"?rt.reverse(rt.interpolate(rt.forward(q),rt.forward(dt),Z)):_t.reverse(_t.interpolate(_t.forward(q),_t.forward(dt),Z))},Ze.prototype.eachChild=function(f){f(this.input);for(var d=0,y=this.outputs;d<y.length;d+=1)f(y[d])},Ze.prototype.outputDefined=function(){return this.outputs.every(function(f){return f.outputDefined()})},Ze.prototype.serialize=function(){var f;f=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var d=[this.operator,f,this.input.serialize()],y=0;y<this.labels.length;y++)d.push(this.labels[y],this.outputs[y].serialize());return d};var jr=function(f,d){this.type=f,this.args=d};jr.parse=function(f,d){if(f.length<2)return d.error("Expectected at least one argument.");var y=null,T=d.expectedType;T&&T.kind!=="value"&&(y=T);for(var O=[],N=0,Z=f.slice(1);N<Z.length;N+=1){var q=d.parse(Z[N],1+O.length,y,void 0,{typeAnnotation:"omit"});if(!q)return null;y=y||q.type,O.push(q)}var dt=T&&O.some(function(Pt){return no(T,Pt.type)});return new jr(dt?Ci:y,O)},jr.prototype.evaluate=function(f){for(var d,y=null,T=0,O=0,N=this.args;O<N.length&&(T++,(y=N[O].evaluate(f))&&y instanceof bo&&!y.available&&(d||(d=y.name),y=null,T===this.args.length&&(y=d)),y===null);O+=1);return y},jr.prototype.eachChild=function(f){this.args.forEach(f)},jr.prototype.outputDefined=function(){return this.args.every(function(f){return f.outputDefined()})},jr.prototype.serialize=function(){var f=["coalesce"];return this.eachChild(function(d){f.push(d.serialize())}),f};var Vr=function(f,d){this.type=d.type,this.bindings=[].concat(f),this.result=d};Vr.prototype.evaluate=function(f){return this.result.evaluate(f)},Vr.prototype.eachChild=function(f){for(var d=0,y=this.bindings;d<y.length;d+=1)f(y[d][1]);f(this.result)},Vr.parse=function(f,d){if(f.length<4)return d.error("Expected at least 3 arguments, but found "+(f.length-1)+" instead.");for(var y=[],T=1;T<f.length-1;T+=2){var O=f[T];if(typeof O!="string")return d.error("Expected string, but found "+typeof O+" instead.",T);if(/[^a-zA-Z0-9_]/.test(O))return d.error("Variable names must contain only alphanumeric characters or '_'.",T);var N=d.parse(f[T+1],T+1);if(!N)return null;y.push([O,N])}var Z=d.parse(f[f.length-1],f.length-1,d.expectedType,y);return Z?new Vr(y,Z):null},Vr.prototype.outputDefined=function(){return this.result.outputDefined()},Vr.prototype.serialize=function(){for(var f=["let"],d=0,y=this.bindings;d<y.length;d+=1){var T=y[d];f.push(T[0],T[1].serialize())}return f.push(this.result.serialize()),f};var Ln=function(f,d,y){this.type=f,this.index=d,this.input=y};Ln.parse=function(f,d){if(f.length!==3)return d.error("Expected 2 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Kr),T=d.parse(f[2],2,Xa(d.expectedType||Ci));return y&&T?new Ln(T.type.itemType,y,T):null},Ln.prototype.evaluate=function(f){var d=this.index.evaluate(f),y=this.input.evaluate(f);if(d<0)throw new In("Array index out of bounds: "+d+" < 0.");if(d>=y.length)throw new In("Array index out of bounds: "+d+" > "+(y.length-1)+".");if(d!==Math.floor(d))throw new In("Array index must be an integer, but found "+d+" instead.");return y[d]},Ln.prototype.eachChild=function(f){f(this.index),f(this.input)},Ln.prototype.outputDefined=function(){return!1},Ln.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Gn=function(f,d){this.type=li,this.needle=f,this.haystack=d};Gn.parse=function(f,d){if(f.length!==3)return d.error("Expected 2 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Ci),T=d.parse(f[2],2,Ci);return y&&T?Vo(y.type,[li,ai,Kr,wi,Ci])?new Gn(y,T):d.error("Expected first argument to be of type boolean, string, number or null, but found "+Ta(y.type)+" instead"):null},Gn.prototype.evaluate=function(f){var d=this.needle.evaluate(f),y=this.haystack.evaluate(f);if(!y)return!1;if(!vo(d,["boolean","string","number","null"]))throw new In("Expected first argument to be of type boolean, string, number or null, but found "+Ta(Ge(d))+" instead.");if(!vo(y,["string","array"]))throw new In("Expected second argument to be of type array or string, but found "+Ta(Ge(y))+" instead.");return y.indexOf(d)>=0},Gn.prototype.eachChild=function(f){f(this.needle),f(this.haystack)},Gn.prototype.outputDefined=function(){return!0},Gn.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var $i=function(f,d,y){this.type=Kr,this.needle=f,this.haystack=d,this.fromIndex=y};$i.parse=function(f,d){if(f.length<=2||f.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Ci),T=d.parse(f[2],2,Ci);if(!y||!T)return null;if(!Vo(y.type,[li,ai,Kr,wi,Ci]))return d.error("Expected first argument to be of type boolean, string, number or null, but found "+Ta(y.type)+" instead");if(f.length===4){var O=d.parse(f[3],3,Kr);return O?new $i(y,T,O):null}return new $i(y,T)},$i.prototype.evaluate=function(f){var d=this.needle.evaluate(f),y=this.haystack.evaluate(f);if(!vo(d,["boolean","string","number","null"]))throw new In("Expected first argument to be of type boolean, string, number or null, but found "+Ta(Ge(d))+" instead.");if(!vo(y,["string","array"]))throw new In("Expected second argument to be of type array or string, but found "+Ta(Ge(y))+" instead.");if(this.fromIndex){var T=this.fromIndex.evaluate(f);return y.indexOf(d,T)}return y.indexOf(d)},$i.prototype.eachChild=function(f){f(this.needle),f(this.haystack),this.fromIndex&&f(this.fromIndex)},$i.prototype.outputDefined=function(){return!1},$i.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var f=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),f]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Pa=function(f,d,y,T,O,N){this.inputType=f,this.type=d,this.input=y,this.cases=T,this.outputs=O,this.otherwise=N};Pa.parse=function(f,d){if(f.length<5)return d.error("Expected at least 4 arguments, but found only "+(f.length-1)+".");if(f.length%2!=1)return d.error("Expected an even number of arguments.");var y,T;d.expectedType&&d.expectedType.kind!=="value"&&(T=d.expectedType);for(var O={},N=[],Z=2;Z<f.length-1;Z+=2){var q=f[Z],dt=f[Z+1];Array.isArray(q)||(q=[q]);var Pt=d.concat(Z);if(q.length===0)return Pt.error("Expected at least one branch label.");for(var Zt=0,qt=q;Zt<qt.length;Zt+=1){var pe=qt[Zt];if(typeof pe!="number"&&typeof pe!="string")return Pt.error("Branch labels must be numbers or strings.");if(typeof pe=="number"&&Math.abs(pe)>Number.MAX_SAFE_INTEGER)return Pt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof pe=="number"&&Math.floor(pe)!==pe)return Pt.error("Numeric branch labels must be integer values.");if(y){if(Pt.checkSubtype(y,Ge(pe)))return null}else y=Ge(pe);if(O[String(pe)]!==void 0)return Pt.error("Branch labels must be unique.");O[String(pe)]=N.length}var Oe=d.parse(dt,Z,T);if(!Oe)return null;T=T||Oe.type,N.push(Oe)}var sr=d.parse(f[1],1,Ci);if(!sr)return null;var lr=d.parse(f[f.length-1],f.length-1,T);return lr?sr.type.kind!=="value"&&d.concat(1).checkSubtype(y,sr.type)?null:new Pa(y,T,sr,O,N,lr):null},Pa.prototype.evaluate=function(f){var d=this.input.evaluate(f);return(Ge(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(f)},Pa.prototype.eachChild=function(f){f(this.input),this.outputs.forEach(f),f(this.otherwise)},Pa.prototype.outputDefined=function(){return this.outputs.every(function(f){return f.outputDefined()})&&this.otherwise.outputDefined()},Pa.prototype.serialize=function(){for(var f=this,d=["match",this.input.serialize()],y=[],T={},O=0,N=Object.keys(this.cases).sort();O<N.length;O+=1){var Z=N[O];(qt=T[this.cases[Z]])===void 0?(T[this.cases[Z]]=y.length,y.push([this.cases[Z],[Z]])):y[qt][1].push(Z)}for(var q=function(Oe){return f.inputType.kind==="number"?Number(Oe):Oe},dt=0,Pt=y;dt<Pt.length;dt+=1){var Zt=Pt[dt],qt=Zt[0],pe=Zt[1];d.push(pe.length===1?q(pe[0]):pe.map(q)),d.push(this.outputs[outputIndex$1].serialize())}return d.push(this.otherwise.serialize()),d};var ba=function(f,d,y){this.type=f,this.branches=d,this.otherwise=y};ba.parse=function(f,d){if(f.length<4)return d.error("Expected at least 3 arguments, but found only "+(f.length-1)+".");if(f.length%2!=0)return d.error("Expected an odd number of arguments.");var y;d.expectedType&&d.expectedType.kind!=="value"&&(y=d.expectedType);for(var T=[],O=1;O<f.length-1;O+=2){var N=d.parse(f[O],O,li);if(!N)return null;var Z=d.parse(f[O+1],O+1,y);if(!Z)return null;T.push([N,Z]),y=y||Z.type}var q=d.parse(f[f.length-1],f.length-1,y);return q?new ba(y,T,q):null},ba.prototype.evaluate=function(f){for(var d=0,y=this.branches;d<y.length;d+=1){var T=y[d],O=T[1];if(T[0].evaluate(f))return O.evaluate(f)}return this.otherwise.evaluate(f)},ba.prototype.eachChild=function(f){for(var d=0,y=this.branches;d<y.length;d+=1){var T=y[d],O=T[1];f(T[0]),f(O)}f(this.otherwise)},ba.prototype.outputDefined=function(){return this.branches.every(function(f){return f[1].outputDefined()})&&this.otherwise.outputDefined()},ba.prototype.serialize=function(){var f=["case"];return this.eachChild(function(d){f.push(d.serialize())}),f};var uo=function(f,d,y,T){this.type=f,this.input=d,this.beginIndex=y,this.endIndex=T};function Ca(f,d){return f==="=="||f==="!="?d.kind==="boolean"||d.kind==="string"||d.kind==="number"||d.kind==="null"||d.kind==="value":d.kind==="string"||d.kind==="number"||d.kind==="value"}function Ao(f,d,y,T){return T.compare(d,y)===0}function qa(f,d,y){var T=f!=="=="&&f!=="!=";return function(){function O(N,Z,q){this.type=li,this.lhs=N,this.rhs=Z,this.collator=q,this.hasUntypedArgument=N.type.kind==="value"||Z.type.kind==="value"}return O.parse=function(N,Z){if(N.length!==3&&N.length!==4)return Z.error("Expected two or three arguments.");var q=N[0],dt=Z.parse(N[1],1,Ci);if(!dt)return null;if(!Ca(q,dt.type))return Z.concat(1).error('"'+q+`" comparisons are not supported for type '`+Ta(dt.type)+"'.");var Pt=Z.parse(N[2],2,Ci);if(!Pt)return null;if(!Ca(q,Pt.type))return Z.concat(2).error('"'+q+`" comparisons are not supported for type '`+Ta(Pt.type)+"'.");if(dt.type.kind!==Pt.type.kind&&dt.type.kind!=="value"&&Pt.type.kind!=="value")return Z.error("Cannot compare types '"+Ta(dt.type)+"' and '"+Ta(Pt.type)+"'.");T&&(dt.type.kind==="value"&&Pt.type.kind!=="value"?dt=new Cn(Pt.type,[dt]):dt.type.kind!=="value"&&Pt.type.kind==="value"&&(Pt=new Cn(dt.type,[Pt])));var Zt=null;if(N.length===4){if(dt.type.kind!=="string"&&Pt.type.kind!=="string"&&dt.type.kind!=="value"&&Pt.type.kind!=="value")return Z.error("Cannot use collator to compare non-string types.");if(!(Zt=Z.parse(N[3],3,Ba)))return null}return new O(dt,Pt,Zt)},O.prototype.evaluate=function(N){var Z=this.lhs.evaluate(N),q=this.rhs.evaluate(N);if(T&&this.hasUntypedArgument){var dt=Ge(Z),Pt=Ge(q);if(dt.kind!==Pt.kind||dt.kind!=="string"&&dt.kind!=="number")throw new In('Expected arguments for "'+f+'" to be (string, string) or (number, number), but found ('+dt.kind+", "+Pt.kind+") instead.")}if(this.collator&&!T&&this.hasUntypedArgument){var Zt=Ge(Z),qt=Ge(q);if(Zt.kind!=="string"||qt.kind!=="string")return d(N,Z,q)}return this.collator?y(N,Z,q,this.collator.evaluate(N)):d(N,Z,q)},O.prototype.eachChild=function(N){N(this.lhs),N(this.rhs),this.collator&&N(this.collator)},O.prototype.outputDefined=function(){return!0},O.prototype.serialize=function(){var N=[f];return this.eachChild(function(Z){N.push(Z.serialize())}),N},O}()}uo.parse=function(f,d){if(f.length<=2||f.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Ci),T=d.parse(f[2],2,Kr);if(!y||!T)return null;if(!Vo(y.type,[Xa(Ci),ai,Ci]))return d.error("Expected first argument to be of type array or string, but found "+Ta(y.type)+" instead");if(f.length===4){var O=d.parse(f[3],3,Kr);return O?new uo(y.type,y,T,O):null}return new uo(y.type,y,T)},uo.prototype.evaluate=function(f){var d=this.input.evaluate(f),y=this.beginIndex.evaluate(f);if(!vo(d,["string","array"]))throw new In("Expected first argument to be of type array or string, but found "+Ta(Ge(d))+" instead.");if(this.endIndex){var T=this.endIndex.evaluate(f);return d.slice(y,T)}return d.slice(y)},uo.prototype.eachChild=function(f){f(this.input),f(this.beginIndex),this.endIndex&&f(this.endIndex)},uo.prototype.outputDefined=function(){return!1},uo.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var f=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),f]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var gs=qa("==",function(f,d,y){return d===y},Ao),xu=qa("!=",function(f,d,y){return d!==y},function(f,d,y,T){return!Ao(0,d,y,T)}),il=qa("<",function(f,d,y){return d<y},function(f,d,y,T){return T.compare(d,y)<0}),bu=qa(">",function(f,d,y){return d>y},function(f,d,y,T){return T.compare(d,y)>0}),iu=qa("<=",function(f,d,y){return d<=y},function(f,d,y,T){return T.compare(d,y)<=0}),Vc=qa(">=",function(f,d,y){return d>=y},function(f,d,y,T){return T.compare(d,y)>=0}),$s=function(f,d,y,T,O){this.type=ai,this.number=f,this.locale=d,this.currency=y,this.minFractionDigits=T,this.maxFractionDigits=O};$s.parse=function(f,d){if(f.length!==3)return d.error("Expected two arguments.");var y=d.parse(f[1],1,Kr);if(!y)return null;var T=f[2];if(typeof T!="object"||Array.isArray(T))return d.error("NumberFormat options argument must be an object.");var O=null;if(T.locale&&!(O=d.parse(T.locale,1,ai)))return null;var N=null;if(T.currency&&!(N=d.parse(T.currency,1,ai)))return null;var Z=null;if(T["min-fraction-digits"]&&!(Z=d.parse(T["min-fraction-digits"],1,Kr)))return null;var q=null;return T["max-fraction-digits"]&&!(q=d.parse(T["max-fraction-digits"],1,Kr))?null:new $s(y,O,N,Z,q)},$s.prototype.evaluate=function(f){return new Intl.NumberFormat(this.locale?this.locale.evaluate(f):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(f):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(f):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(f):void 0}).format(this.number.evaluate(f))},$s.prototype.eachChild=function(f){f(this.number),this.locale&&f(this.locale),this.currency&&f(this.currency),this.minFractionDigits&&f(this.minFractionDigits),this.maxFractionDigits&&f(this.maxFractionDigits)},$s.prototype.outputDefined=function(){return!1},$s.prototype.serialize=function(){var f={};return this.locale&&(f.locale=this.locale.serialize()),this.currency&&(f.currency=this.currency.serialize()),this.minFractionDigits&&(f["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(f["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),f]};var Yl=function(f){this.type=Kr,this.input=f};Yl.parse=function(f,d){if(f.length!==2)return d.error("Expected 1 argument, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1);return y?y.type.kind!=="array"&&y.type.kind!=="string"&&y.type.kind!=="value"?d.error("Expected argument of type string or array, but found "+Ta(y.type)+" instead."):new Yl(y):null},Yl.prototype.evaluate=function(f){var d=this.input.evaluate(f);if(typeof d=="string"||Array.isArray(d))return d.length;throw new In("Expected value to be of type string or array, but found "+Ta(Ge(d))+" instead.")},Yl.prototype.eachChild=function(f){f(this.input)},Yl.prototype.outputDefined=function(){return!1},Yl.prototype.serialize=function(){var f=["length"];return this.eachChild(function(d){f.push(d.serialize())}),f};var me={"==":gs,"!=":xu,">":bu,"<":il,">=":Vc,"<=":iu,array:Cn,at:Ln,boolean:Cn,case:ba,coalesce:jr,collator:pu,format:ta,image:Wa,in:Gn,"index-of":$i,interpolate:Ze,"interpolate-hcl":Ze,"interpolate-lab":Ze,length:Yl,let:Vr,literal:tn,match:Pa,number:Cn,"number-format":$s,object:Cn,slice:uo,step:Fu,string:Cn,"to-boolean":ko,"to-color":ko,"to-number":ko,"to-string":ko,var:rl,within:Xu};function ir(f,d){var y=d[0],T=d[1],O=d[2],N=d[3];y=y.evaluate(f),T=T.evaluate(f),O=O.evaluate(f);var Z=N?N.evaluate(f):1,q=nr(y,T,O,Z);if(q)throw new In(q);return new to(y/255*Z,T/255*Z,O/255*Z,Z)}function Or(f,d){return f in d}function $r(f,d){var y=d[f];return y===void 0?null:y}function xn(f){return{type:f}}function _i(f){return{result:"success",value:f}}function qi(f){return{result:"error",value:f}}function Ia(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function du(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function qs(f){return!!f.expression&&f.expression.interpolated}function $a(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function Dl(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function av(f){return f}function yf(f,d,y){return f!==void 0?f:d!==void 0?d:y!==void 0?y:void 0}function vd(f,d,y,T,O){return yf(typeof y===O?T[y]:void 0,f.default,d.default)}function ov(f,d,y){if($a(y)!=="number")return yf(f.default,d.default);var T=f.stops.length;if(T===1||y<=f.stops[0][0])return f.stops[0][1];if(y>=f.stops[T-1][0])return f.stops[T-1][1];var O=dl(f.stops.map(function(N){return N[0]}),y);return f.stops[O][1]}function sv(f,d,y){var T=f.base!==void 0?f.base:1;if($a(y)!=="number")return yf(f.default,d.default);var O=f.stops.length;if(O===1||y<=f.stops[0][0])return f.stops[0][1];if(y>=f.stops[O-1][0])return f.stops[O-1][1];var N=dl(f.stops.map(function(qt){return qt[0]}),y),Z=function(qt,pe,Oe,sr){var lr=sr-Oe,Cr=qt-Oe;return lr===0?0:pe===1?Cr/lr:(Math.pow(pe,Cr)-1)/(Math.pow(pe,lr)-1)}(y,T,f.stops[N][0],f.stops[N+1][0]),q=f.stops[N][1],dt=f.stops[N+1][1],Pt=rs[d.type]||av;if(f.colorSpace&&f.colorSpace!=="rgb"){var Zt=se[f.colorSpace];Pt=function(qt,pe){return Zt.reverse(Zt.interpolate(Zt.forward(qt),Zt.forward(pe),Z))}}return typeof q.evaluate=="function"?{evaluate:function(){for(var qt=[],pe=arguments.length;pe--;)qt[pe]=arguments[pe];var Oe=q.evaluate.apply(void 0,qt),sr=dt.evaluate.apply(void 0,qt);if(Oe!==void 0&&sr!==void 0)return Pt(Oe,sr,Z)}}:Pt(q,dt,Z)}function dh(f,d,y){return d.type==="color"?y=to.parse(y):d.type==="formatted"?y=Wo.fromString(y.toString()):d.type==="resolvedImage"?y=bo.fromString(y.toString()):$a(y)===d.type||d.type==="enum"&&d.values[y]||(y=void 0),yf(y,f.default,d.default)}Go.register(me,{error:[{kind:"error"},[ai],function(f,d){throw new In(d[0].evaluate(f))}],typeof:[ai,[Ci],function(f,d){return Ta(Ge(d[0].evaluate(f)))}],"to-rgba":[Xa(Kr,4),[hi],function(f,d){return d[0].evaluate(f).toArray()}],rgb:[hi,[Kr,Kr,Kr],ir],rgba:[hi,[Kr,Kr,Kr,Kr],ir],has:{type:li,overloads:[[[ai],function(f,d){return Or(d[0].evaluate(f),f.properties())}],[[ai,ra],function(f,d){var y=d[1];return Or(d[0].evaluate(f),y.evaluate(f))}]]},get:{type:Ci,overloads:[[[ai],function(f,d){return $r(d[0].evaluate(f),f.properties())}],[[ai,ra],function(f,d){var y=d[1];return $r(d[0].evaluate(f),y.evaluate(f))}]]},"feature-state":[Ci,[ai],function(f,d){return $r(d[0].evaluate(f),f.featureState||{})}],properties:[ra,[],function(f){return f.properties()}],"geometry-type":[ai,[],function(f){return f.geometryType()}],id:[Ci,[],function(f){return f.id()}],zoom:[Kr,[],function(f){return f.globals.zoom}],"heatmap-density":[Kr,[],function(f){return f.globals.heatmapDensity||0}],"line-progress":[Kr,[],function(f){return f.globals.lineProgress||0}],accumulated:[Ci,[],function(f){return f.globals.accumulated===void 0?null:f.globals.accumulated}],"+":[Kr,xn(Kr),function(f,d){for(var y=0,T=0,O=d;T<O.length;T+=1)y+=O[T].evaluate(f);return y}],"*":[Kr,xn(Kr),function(f,d){for(var y=1,T=0,O=d;T<O.length;T+=1)y*=O[T].evaluate(f);return y}],"-":{type:Kr,overloads:[[[Kr,Kr],function(f,d){var y=d[1];return d[0].evaluate(f)-y.evaluate(f)}],[[Kr],function(f,d){return-d[0].evaluate(f)}]]},"/":[Kr,[Kr,Kr],function(f,d){var y=d[1];return d[0].evaluate(f)/y.evaluate(f)}],"%":[Kr,[Kr,Kr],function(f,d){var y=d[1];return d[0].evaluate(f)%y.evaluate(f)}],ln2:[Kr,[],function(){return Math.LN2}],pi:[Kr,[],function(){return Math.PI}],e:[Kr,[],function(){return Math.E}],"^":[Kr,[Kr,Kr],function(f,d){var y=d[1];return Math.pow(d[0].evaluate(f),y.evaluate(f))}],sqrt:[Kr,[Kr],function(f,d){return Math.sqrt(d[0].evaluate(f))}],log10:[Kr,[Kr],function(f,d){return Math.log(d[0].evaluate(f))/Math.LN10}],ln:[Kr,[Kr],function(f,d){return Math.log(d[0].evaluate(f))}],log2:[Kr,[Kr],function(f,d){return Math.log(d[0].evaluate(f))/Math.LN2}],sin:[Kr,[Kr],function(f,d){return Math.sin(d[0].evaluate(f))}],cos:[Kr,[Kr],function(f,d){return Math.cos(d[0].evaluate(f))}],tan:[Kr,[Kr],function(f,d){return Math.tan(d[0].evaluate(f))}],asin:[Kr,[Kr],function(f,d){return Math.asin(d[0].evaluate(f))}],acos:[Kr,[Kr],function(f,d){return Math.acos(d[0].evaluate(f))}],atan:[Kr,[Kr],function(f,d){return Math.atan(d[0].evaluate(f))}],min:[Kr,xn(Kr),function(f,d){return Math.min.apply(Math,d.map(function(y){return y.evaluate(f)}))}],max:[Kr,xn(Kr),function(f,d){return Math.max.apply(Math,d.map(function(y){return y.evaluate(f)}))}],abs:[Kr,[Kr],function(f,d){return Math.abs(d[0].evaluate(f))}],round:[Kr,[Kr],function(f,d){var y=d[0].evaluate(f);return y<0?-Math.round(-y):Math.round(y)}],floor:[Kr,[Kr],function(f,d){return Math.floor(d[0].evaluate(f))}],ceil:[Kr,[Kr],function(f,d){return Math.ceil(d[0].evaluate(f))}],"filter-==":[li,[ai,Ci],function(f,d){var y=d[0],T=d[1];return f.properties()[y.value]===T.value}],"filter-id-==":[li,[Ci],function(f,d){var y=d[0];return f.id()===y.value}],"filter-type-==":[li,[ai],function(f,d){var y=d[0];return f.geometryType()===y.value}],"filter-<":[li,[ai,Ci],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O<N}],"filter-id-<":[li,[Ci],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T<O}],"filter->":[li,[ai,Ci],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O>N}],"filter-id->":[li,[Ci],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T>O}],"filter-<=":[li,[ai,Ci],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O<=N}],"filter-id-<=":[li,[Ci],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T<=O}],"filter->=":[li,[ai,Ci],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O>=N}],"filter-id->=":[li,[Ci],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T>=O}],"filter-has":[li,[Ci],function(f,d){return d[0].value in f.properties()}],"filter-has-id":[li,[],function(f){return f.id()!==null&&f.id()!==void 0}],"filter-type-in":[li,[Xa(ai)],function(f,d){return d[0].value.indexOf(f.geometryType())>=0}],"filter-id-in":[li,[Xa(Ci)],function(f,d){return d[0].value.indexOf(f.id())>=0}],"filter-in-small":[li,[ai,Xa(Ci)],function(f,d){var y=d[0];return d[1].value.indexOf(f.properties()[y.value])>=0}],"filter-in-large":[li,[ai,Xa(Ci)],function(f,d){var y=d[0],T=d[1];return function(O,N,Z,q){for(;Z<=q;){var dt=Z+q>>1;if(N[dt]===O)return!0;N[dt]>O?q=dt-1:Z=dt+1}return!1}(f.properties()[y.value],T.value,0,T.value.length-1)}],all:{type:li,overloads:[[[li,li],function(f,d){var y=d[1];return d[0].evaluate(f)&&y.evaluate(f)}],[xn(li),function(f,d){for(var y=0,T=d;y<T.length;y+=1)if(!T[y].evaluate(f))return!1;return!0}]]},any:{type:li,overloads:[[[li,li],function(f,d){var y=d[1];return d[0].evaluate(f)||y.evaluate(f)}],[xn(li),function(f,d){for(var y=0,T=d;y<T.length;y+=1)if(T[y].evaluate(f))return!0;return!1}]]},"!":[li,[li],function(f,d){return!d[0].evaluate(f)}],"is-supported-script":[li,[ai],function(f,d){var y=f.globals&&f.globals.isSupportedScript;return!y||y(d[0].evaluate(f))}],upcase:[ai,[ai],function(f,d){return d[0].evaluate(f).toUpperCase()}],downcase:[ai,[ai],function(f,d){return d[0].evaluate(f).toLowerCase()}],concat:[ai,xn(Ci),function(f,d){return d.map(function(y){return Mr(y.evaluate(f))}).join("")}],"resolved-locale":[ai,[Ba],function(f,d){return d[0].evaluate(f).resolvedLocale()}]});var zf=function(f,d){this.expression=f,this._warningHistory={},this._evaluator=new Ya,this._defaultValue=d?function(y){return y.type==="color"&&Dl(y.default)?new to(0,0,0,0):y.type==="color"?to.parse(y.default)||null:y.default===void 0?null:y.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null};function Gc(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in me}function vh(f,d){var y=new nu(me,[],d?function(O){var N={color:hi,string:ai,number:Kr,enum:ai,boolean:li,formatted:po,resolvedImage:za};return O.type==="array"?Xa(N[O.value]||Ci,O.length):N[O.type]}(d):void 0),T=y.parse(f,void 0,void 0,void 0,d&&d.type==="string"?{typeAnnotation:"coerce"}:void 0);return T?_i(new zf(T,d)):qi(y.errors)}zf.prototype.evaluateWithoutErrorHandling=function(f,d,y,T,O,N){return this._evaluator.globals=f,this._evaluator.feature=d,this._evaluator.featureState=y,this._evaluator.canonical=T,this._evaluator.availableImages=O||null,this._evaluator.formattedSection=N,this.expression.evaluate(this._evaluator)},zf.prototype.evaluate=function(f,d,y,T,O,N){this._evaluator.globals=f,this._evaluator.feature=d||null,this._evaluator.featureState=y||null,this._evaluator.canonical=T,this._evaluator.availableImages=O||null,this._evaluator.formattedSection=N||null;try{var Z=this.expression.evaluate(this._evaluator);if(Z==null||typeof Z=="number"&&Z!=Z)return this._defaultValue;if(this._enumValues&&!(Z in this._enumValues))throw new In("Expected value to be one of "+Object.keys(this._enumValues).map(function(q){return JSON.stringify(q)}).join(", ")+", but found "+JSON.stringify(Z)+" instead.");return Z}catch(q){return this._warningHistory[q.message]||(this._warningHistory[q.message]=!0,typeof console!="undefined"&&console.warn(q.message)),this._defaultValue}};var Uf=function(f,d){this.kind=f,this._styleExpression=d,this.isStateDependent=f!=="constant"&&!vs(d.expression)};Uf.prototype.evaluateWithoutErrorHandling=function(f,d,y,T,O,N){return this._styleExpression.evaluateWithoutErrorHandling(f,d,y,T,O,N)},Uf.prototype.evaluate=function(f,d,y,T,O,N){return this._styleExpression.evaluate(f,d,y,T,O,N)};var lc=function(f,d,y,T){this.kind=f,this.zoomStops=y,this._styleExpression=d,this.isStateDependent=f!=="camera"&&!vs(d.expression),this.interpolationType=T};function al(f,d){if((f=vh(f,d)).result==="error")return f;var y=f.value.expression,T=_s(y);if(!T&&!Ia(d))return qi([new Mn("","data expressions not supported")]);var O=Ou(y,["zoom"]);if(!O&&!du(d))return qi([new Mn("","zoom expressions not supported")]);var N=function Z(q){var dt=null;if(q instanceof Vr)dt=Z(q.result);else if(q instanceof jr)for(var Pt=0,Zt=q.args;Pt<Zt.length&&!(dt=Z(Zt[Pt]));Pt+=1);else(q instanceof Fu||q instanceof Ze)&&q.input instanceof Go&&q.input.name==="zoom"&&(dt=q);return dt instanceof Mn||q.eachChild(function(qt){var pe=Z(qt);pe instanceof Mn?dt=pe:!dt&&pe?dt=new Mn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):dt&&pe&&dt!==pe&&(dt=new Mn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),dt}(y);return N||O?N instanceof Mn?qi([N]):N instanceof Ze&&!qs(d)?qi([new Mn("",'"interpolate" expressions cannot be used with this property')]):_i(N?new lc(T?"camera":"composite",f.value,N.labels,N instanceof Ze?N.interpolation:void 0):new Uf(T?"constant":"source",f.value)):qi([new Mn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}lc.prototype.evaluateWithoutErrorHandling=function(f,d,y,T,O,N){return this._styleExpression.evaluateWithoutErrorHandling(f,d,y,T,O,N)},lc.prototype.evaluate=function(f,d,y,T,O,N){return this._styleExpression.evaluate(f,d,y,T,O,N)},lc.prototype.interpolationFactor=function(f,d,y){return this.interpolationType?Ze.interpolationFactor(this.interpolationType,f,d,y):0};var _f=function(f,d){this._parameters=f,this._specification=d,wn(this,function y(T,O){var N,Z,q,dt=O.type==="color",Pt=T.stops&&typeof T.stops[0][0]=="object",Zt=Pt||!(Pt||T.property!==void 0),qt=T.type||(qs(O)?"exponential":"interval");if(dt&&((T=wn({},T)).stops&&(T.stops=T.stops.map(function(Di){return[Di[0],to.parse(Di[1])]})),T.default=to.parse(T.default?T.default:O.default)),T.colorSpace&&T.colorSpace!=="rgb"&&!se[T.colorSpace])throw new Error("Unknown color space: "+T.colorSpace);if(qt==="exponential")N=sv;else if(qt==="interval")N=ov;else if(qt==="categorical"){N=vd,Z=Object.create(null);for(var pe=0,Oe=T.stops;pe<Oe.length;pe+=1){var sr=Oe[pe];Z[sr[0]]=sr[1]}q=typeof T.stops[0][0]}else{if(qt!=="identity")throw new Error('Unknown function type "'+qt+'"');N=dh}if(Pt){for(var lr={},Cr=[],gr=0;gr<T.stops.length;gr++){var Ur=T.stops[gr],Ar=Ur[0].zoom;lr[Ar]===void 0&&(lr[Ar]={zoom:Ar,type:T.type,property:T.property,default:T.default,stops:[]},Cr.push(Ar)),lr[Ar].stops.push([Ur[0].value,Ur[1]])}for(var Dr=[],mn=0,Fn=Cr;mn<Fn.length;mn+=1){var ni=Fn[mn];Dr.push([lr[ni].zoom,y(lr[ni],O)])}var ki={name:"linear"};return{kind:"composite",interpolationType:ki,interpolationFactor:Ze.interpolationFactor.bind(void 0,ki),zoomStops:Dr.map(function(Di){return Di[0]}),evaluate:function(Di,ca){var zi=Di.zoom;return sv({stops:Dr,base:T.base},O,zi).evaluate(zi,ca)}}}if(Zt){var oa=qt==="exponential"?{name:"exponential",base:T.base!==void 0?T.base:1}:null;return{kind:"camera",interpolationType:oa,interpolationFactor:Ze.interpolationFactor.bind(void 0,oa),zoomStops:T.stops.map(function(Di){return Di[0]}),evaluate:function(Di){return N(T,O,Di.zoom,Z,q)}}}return{kind:"source",evaluate:function(Di,ca){var zi=ca&&ca.properties?ca.properties[T.property]:void 0;return zi===void 0?yf(T.default,O.default):N(T,O,zi,Z,q)}}}(this._parameters,this._specification))};function vl(f){var d=f.key,y=f.value,T=f.valueSpec||{},O=f.objectElementValidators||{},N=f.style,Z=f.styleSpec,q=[],dt=$a(y);if(dt!=="object")return[new ur(d,y,"object expected, "+dt+" found")];for(var Pt in y){var Zt=Pt.split(".")[0],qt=T[Zt]||T["*"],pe=void 0;if(O[Zt])pe=O[Zt];else if(T[Zt])pe=go;else if(O["*"])pe=O["*"];else{if(!T["*"]){q.push(new ur(d,y[Pt],'unknown property "'+Pt+'"'));continue}pe=go}q=q.concat(pe({key:(d&&d+".")+Pt,value:y[Pt],valueSpec:qt,style:N,styleSpec:Z,object:y,objectKey:Pt},y))}for(var Oe in T)O[Oe]||T[Oe].required&&T[Oe].default===void 0&&y[Oe]===void 0&&q.push(new ur(d,y,'missing required property "'+Oe+'"'));return q}function Eu(f){var d=f.value,y=f.valueSpec,T=f.style,O=f.styleSpec,N=f.key,Z=f.arrayElementValidator||go;if($a(d)!=="array")return[new ur(N,d,"array expected, "+$a(d)+" found")];if(y.length&&d.length!==y.length)return[new ur(N,d,"array length "+y.length+" expected, length "+d.length+" found")];if(y["min-length"]&&d.length<y["min-length"])return[new ur(N,d,"array length at least "+y["min-length"]+" expected, length "+d.length+" found")];var q={type:y.value,values:y.values};O.$version<7&&(q.function=y.function),$a(y.value)==="object"&&(q=y.value);for(var dt=[],Pt=0;Pt<d.length;Pt++)dt=dt.concat(Z({array:d,arrayIndex:Pt,value:d[Pt],valueSpec:q,style:T,styleSpec:O,key:N+"["+Pt+"]"}));return dt}function Yh(f){var d=f.key,y=f.value,T=f.valueSpec,O=$a(y);return O==="number"&&y!=y&&(O="NaN"),O!=="number"?[new ur(d,y,"number expected, "+O+" found")]:"minimum"in T&&y<T.minimum?[new ur(d,y,y+" is less than the minimum value "+T.minimum)]:"maximum"in T&&y>T.maximum?[new ur(d,y,y+" is greater than the maximum value "+T.maximum)]:[]}function Pp(f){var d,y,T,O=f.valueSpec,N=qr(f.value.type),Z={},q=N!=="categorical"&&f.value.property===void 0,dt=!q,Pt=$a(f.value.stops)==="array"&&$a(f.value.stops[0])==="array"&&$a(f.value.stops[0][0])==="object",Zt=vl({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(Oe){if(N==="identity")return[new ur(Oe.key,Oe.value,'identity function may not have a "stops" property')];var sr=[],lr=Oe.value;return sr=sr.concat(Eu({key:Oe.key,value:lr,valueSpec:Oe.valueSpec,style:Oe.style,styleSpec:Oe.styleSpec,arrayElementValidator:qt})),$a(lr)==="array"&&lr.length===0&&sr.push(new ur(Oe.key,lr,"array must have at least one stop")),sr},default:function(Oe){return go({key:Oe.key,value:Oe.value,valueSpec:O,style:Oe.style,styleSpec:Oe.styleSpec})}}});return N==="identity"&&q&&Zt.push(new ur(f.key,f.value,'missing required property "property"')),N==="identity"||f.value.stops||Zt.push(new ur(f.key,f.value,'missing required property "stops"')),N==="exponential"&&f.valueSpec.expression&&!qs(f.valueSpec)&&Zt.push(new ur(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(dt&&!Ia(f.valueSpec)?Zt.push(new ur(f.key,f.value,"property functions not supported")):q&&!du(f.valueSpec)&&Zt.push(new ur(f.key,f.value,"zoom functions not supported"))),N!=="categorical"&&!Pt||f.value.property!==void 0||Zt.push(new ur(f.key,f.value,'"property" property is required')),Zt;function qt(Oe){var sr=[],lr=Oe.value,Cr=Oe.key;if($a(lr)!=="array")return[new ur(Cr,lr,"array expected, "+$a(lr)+" found")];if(lr.length!==2)return[new ur(Cr,lr,"array length 2 expected, length "+lr.length+" found")];if(Pt){if($a(lr[0])!=="object")return[new ur(Cr,lr,"object expected, "+$a(lr[0])+" found")];if(lr[0].zoom===void 0)return[new ur(Cr,lr,"object stop key must have zoom")];if(lr[0].value===void 0)return[new ur(Cr,lr,"object stop key must have value")];if(T&&T>qr(lr[0].zoom))return[new ur(Cr,lr[0].zoom,"stop zoom values must appear in ascending order")];qr(lr[0].zoom)!==T&&(T=qr(lr[0].zoom),y=void 0,Z={}),sr=sr.concat(vl({key:Cr+"[0]",value:lr[0],valueSpec:{zoom:{}},style:Oe.style,styleSpec:Oe.styleSpec,objectElementValidators:{zoom:Yh,value:pe}}))}else sr=sr.concat(pe({key:Cr+"[0]",value:lr[0],valueSpec:{},style:Oe.style,styleSpec:Oe.styleSpec},lr));return Gc(Qr(lr[1]))?sr.concat([new ur(Cr+"[1]",lr[1],"expressions are not allowed in function stops.")]):sr.concat(go({key:Cr+"[1]",value:lr[1],valueSpec:O,style:Oe.style,styleSpec:Oe.styleSpec}))}function pe(Oe,sr){var lr=$a(Oe.value),Cr=qr(Oe.value),gr=Oe.value!==null?Oe.value:sr;if(d){if(lr!==d)return[new ur(Oe.key,gr,lr+" stop domain type must match previous stop domain type "+d)]}else d=lr;if(lr!=="number"&&lr!=="string"&&lr!=="boolean")return[new ur(Oe.key,gr,"stop domain value must be a number, string, or boolean")];if(lr!=="number"&&N!=="categorical"){var Ur="number expected, "+lr+" found";return Ia(O)&&N===void 0&&(Ur+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ur(Oe.key,gr,Ur)]}return N!=="categorical"||lr!=="number"||isFinite(Cr)&&Math.floor(Cr)===Cr?N!=="categorical"&&lr==="number"&&y!==void 0&&Cr<y?[new ur(Oe.key,gr,"stop domain values must appear in ascending order")]:(y=Cr,N==="categorical"&&Cr in Z?[new ur(Oe.key,gr,"stop domain values must be unique")]:(Z[Cr]=!0,[])):[new ur(Oe.key,gr,"integer expected, found "+Cr)]}}function wc(f){var d=(f.expressionContext==="property"?al:vh)(Qr(f.value),f.valueSpec);if(d.result==="error")return d.value.map(function(T){return new ur(""+f.key+T.key,f.value,T.message)});var y=d.value.expression||d.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!y.outputDefined())return[new ur(f.key,f.value,'Invalid data expression for "'+f.propertyKey+'". Output values must be contained as literals within the expression.')];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!vs(y))return[new ur(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!vs(y))return[new ur(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!Ou(y,["zoom","feature-state"]))return[new ur(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!_s(y))return[new ur(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function gl(f){var d=f.key,y=f.value,T=f.valueSpec,O=[];return Array.isArray(T.values)?T.values.indexOf(qr(y))===-1&&O.push(new ur(d,y,"expected one of ["+T.values.join(", ")+"], "+JSON.stringify(y)+" found")):Object.keys(T.values).indexOf(qr(y))===-1&&O.push(new ur(d,y,"expected one of ["+Object.keys(T.values).join(", ")+"], "+JSON.stringify(y)+" found")),O}function $h(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(var d=0,y=f.slice(1);d<y.length;d+=1){var T=y[d];if(!$h(T)&&typeof T!="boolean")return!1}return!0;default:return!0}}_f.deserialize=function(f){return new _f(f._parameters,f._specification)},_f.serialize=function(f){return{_parameters:f._parameters,_specification:f._specification}};var qh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Op(f){if(f==null)return{filter:function(){return!0},needGeometry:!1};$h(f)||(f=Kh(f));var d=vh(f,qh);if(d.result==="error")throw new Error(d.value.map(function(y){return y.key+": "+y.message}).join(", "));return{filter:function(y,T,O){return d.value.evaluate(y,T,{},O)},needGeometry:function y(T){if(!Array.isArray(T))return!1;if(T[0]==="within")return!0;for(var O=1;O<T.length;O++)if(y(T[O]))return!0;return!1}(f)}}function Hc(f,d){return f<d?-1:f>d?1:0}function Kh(f){if(!f)return!0;var d,y=f[0];return f.length<=1?y!=="any":y==="=="?$l(f[1],f[2],"=="):y==="!="?Tl($l(f[1],f[2],"==")):y==="<"||y===">"||y==="<="||y===">="?$l(f[1],f[2],y):y==="any"?(d=f.slice(1),["any"].concat(d.map(Kh))):y==="all"?["all"].concat(f.slice(1).map(Kh)):y==="none"?["all"].concat(f.slice(1).map(Kh).map(Tl)):y==="in"?Qh(f[1],f.slice(2)):y==="!in"?Tl(Qh(f[1],f.slice(2))):y==="has"?Zf(f[1]):y==="!has"?Tl(Zf(f[1])):y!=="within"||f}function $l(f,d,y){switch(f){case"$type":return["filter-type-"+y,d];case"$id":return["filter-id-"+y,d];default:return["filter-"+y,f,d]}}function Qh(f,d){if(d.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",d]];case"$id":return["filter-id-in",["literal",d]];default:return d.length>200&&!d.some(function(y){return typeof y!=typeof d[0]})?["filter-in-large",f,["literal",d.sort(Hc)]]:["filter-in-small",f,["literal",d]]}}function Zf(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Tl(f){return["!",f]}function gd(f){return $h(Qr(f.value))?wc(wn({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function d(y){var T=y.value,O=y.key;if($a(T)!=="array")return[new ur(O,T,"array expected, "+$a(T)+" found")];var N,Z=y.styleSpec,q=[];if(T.length<1)return[new ur(O,T,"filter array must have at least 1 element")];switch(q=q.concat(gl({key:O+"[0]",value:T[0],valueSpec:Z.filter_operator,style:y.style,styleSpec:y.styleSpec})),qr(T[0])){case"<":case"<=":case">":case">=":T.length>=2&&qr(T[1])==="$type"&&q.push(new ur(O,T,'"$type" cannot be use with operator "'+T[0]+'"'));case"==":case"!=":T.length!==3&&q.push(new ur(O,T,'filter array for operator "'+T[0]+'" must have 3 elements'));case"in":case"!in":T.length>=2&&(N=$a(T[1]))!=="string"&&q.push(new ur(O+"[1]",T[1],"string expected, "+N+" found"));for(var dt=2;dt<T.length;dt++)N=$a(T[dt]),qr(T[1])==="$type"?q=q.concat(gl({key:O+"["+dt+"]",value:T[dt],valueSpec:Z.geometry_type,style:y.style,styleSpec:y.styleSpec})):N!=="string"&&N!=="number"&&N!=="boolean"&&q.push(new ur(O+"["+dt+"]",T[dt],"string, number, or boolean expected, "+N+" found"));break;case"any":case"all":case"none":for(var Pt=1;Pt<T.length;Pt++)q=q.concat(d({key:O+"["+Pt+"]",value:T[Pt],style:y.style,styleSpec:y.styleSpec}));break;case"has":case"!has":N=$a(T[1]),T.length!==2?q.push(new ur(O,T,'filter array for "'+T[0]+'" operator must have 2 elements')):N!=="string"&&q.push(new ur(O+"[1]",T[1],"string expected, "+N+" found"));break;case"within":N=$a(T[1]),T.length!==2?q.push(new ur(O,T,'filter array for "'+T[0]+'" operator must have 2 elements')):N!=="object"&&q.push(new ur(O+"[1]",T[1],"object expected, "+N+" found"))}return q}(f)}function md(f,d){var y=f.key,T=f.style,O=f.styleSpec,N=f.value,Z=f.objectKey,q=O[d+"_"+f.layerType];if(!q)return[];var dt=Z.match(/^(.*)-transition$/);if(d==="paint"&&dt&&q[dt[1]]&&q[dt[1]].transition)return go({key:y,value:N,valueSpec:O.transition,style:T,styleSpec:O});var Pt,Zt=f.valueSpec||q[Z];if(!Zt)return[new ur(y,N,'unknown property "'+Z+'"')];if($a(N)==="string"&&Ia(Zt)&&!Zt.tokens&&(Pt=/^{([^}]+)}$/.exec(N)))return[new ur(y,N,'"'+Z+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(Pt[1])+" }`.")];var qt=[];return f.layerType==="symbol"&&(Z==="text-field"&&T&&!T.glyphs&&qt.push(new ur(y,N,'use of "text-field" requires a style "glyphs" property')),Z==="text-font"&&Dl(Qr(N))&&qr(N.type)==="identity"&&qt.push(new ur(y,N,'"text-font" does not support identity functions'))),qt.concat(go({key:f.key,value:N,valueSpec:Zt,style:T,styleSpec:O,expressionContext:"property",propertyType:d,propertyKey:Z}))}function yd(f){return md(f,"paint")}function gh(f){return md(f,"layout")}function _d(f){var d=[],y=f.value,T=f.key,O=f.style,N=f.styleSpec;y.type||y.ref||d.push(new ur(T,y,'either "type" or "ref" is required'));var Z,q=qr(y.type),dt=qr(y.ref);if(y.id)for(var Pt=qr(y.id),Zt=0;Zt<f.arrayIndex;Zt++){var qt=O.layers[Zt];qr(qt.id)===Pt&&d.push(new ur(T,y.id,'duplicate layer id "'+y.id+'", previously used at line '+qt.id.__line__))}if("ref"in y)["type","source","source-layer","filter","layout"].forEach(function(sr){sr in y&&d.push(new ur(T,y[sr],'"'+sr+'" is prohibited for ref layers'))}),O.layers.forEach(function(sr){qr(sr.id)===dt&&(Z=sr)}),Z?Z.ref?d.push(new ur(T,y.ref,"ref cannot reference another ref layer")):q=qr(Z.type):d.push(new ur(T,y.ref,'ref layer "'+dt+'" not found'));else if(q!=="background")if(y.source){var pe=O.sources&&O.sources[y.source],Oe=pe&&qr(pe.type);pe?Oe==="vector"&&q==="raster"?d.push(new ur(T,y.source,'layer "'+y.id+'" requires a raster source')):Oe==="raster"&&q!=="raster"?d.push(new ur(T,y.source,'layer "'+y.id+'" requires a vector source')):Oe!=="vector"||y["source-layer"]?Oe==="raster-dem"&&q!=="hillshade"?d.push(new ur(T,y.source,"raster-dem source can only be used with layer type 'hillshade'.")):q!=="line"||!y.paint||!y.paint["line-gradient"]||Oe==="geojson"&&pe.lineMetrics||d.push(new ur(T,y,'layer "'+y.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):d.push(new ur(T,y,'layer "'+y.id+'" must specify a "source-layer"')):d.push(new ur(T,y.source,'source "'+y.source+'" not found'))}else d.push(new ur(T,y,'missing required property "source"'));return d=d.concat(vl({key:T,value:y,valueSpec:N.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return go({key:T+".type",value:y.type,valueSpec:N.layer.type,style:f.style,styleSpec:f.styleSpec,object:y,objectKey:"type"})},filter:gd,layout:function(sr){return vl({layer:y,key:sr.key,value:sr.value,style:sr.style,styleSpec:sr.styleSpec,objectElementValidators:{"*":function(lr){return gh(wn({layerType:q},lr))}}})},paint:function(sr){return vl({layer:y,key:sr.key,value:sr.value,style:sr.style,styleSpec:sr.styleSpec,objectElementValidators:{"*":function(lr){return yd(wn({layerType:q},lr))}}})}}}))}function xf(f){var d=f.value,y=f.key,T=$a(d);return T!=="string"?[new ur(y,d,"string expected, "+T+" found")]:[]}var xs={promoteId:function(f){var d=f.key,y=f.value;if($a(y)==="string")return xf({key:d,value:y});var T=[];for(var O in y)T.push.apply(T,xf({key:d+"."+O,value:y[O]}));return T}};function Jh(f){var d=f.value,y=f.key,T=f.styleSpec,O=f.style;if(!d.type)return[new ur(y,d,'"type" is required')];var N,Z=qr(d.type);switch(Z){case"vector":case"raster":case"raster-dem":return vl({key:y,value:d,valueSpec:T["source_"+Z.replace("-","_")],style:f.style,styleSpec:T,objectElementValidators:xs});case"geojson":if(N=vl({key:y,value:d,valueSpec:T.source_geojson,style:O,styleSpec:T,objectElementValidators:xs}),d.cluster)for(var q in d.clusterProperties){var dt=d.clusterProperties[q],Pt=dt[0],Zt=typeof Pt=="string"?[Pt,["accumulated"],["get",q]]:Pt;N.push.apply(N,wc({key:y+"."+q+".map",value:dt[1],expressionContext:"cluster-map"})),N.push.apply(N,wc({key:y+"."+q+".reduce",value:Zt,expressionContext:"cluster-reduce"}))}return N;case"video":return vl({key:y,value:d,valueSpec:T.source_video,style:O,styleSpec:T});case"image":return vl({key:y,value:d,valueSpec:T.source_image,style:O,styleSpec:T});case"canvas":return[new ur(y,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return gl({key:y+".type",value:d.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:O,styleSpec:T})}}function Vf(f){var d=f.value,y=f.styleSpec,T=y.light,O=f.style,N=[],Z=$a(d);if(d===void 0)return N;if(Z!=="object")return N.concat([new ur("light",d,"object expected, "+Z+" found")]);for(var q in d){var dt=q.match(/^(.*)-transition$/);N=N.concat(dt&&T[dt[1]]&&T[dt[1]].transition?go({key:q,value:d[q],valueSpec:y.transition,style:O,styleSpec:y}):T[q]?go({key:q,value:d[q],valueSpec:T[q],style:O,styleSpec:y}):[new ur(q,d[q],'unknown property "'+q+'"')])}return N}var Bl={"*":function(){return[]},array:Eu,boolean:function(f){var d=f.value,y=f.key,T=$a(d);return T!=="boolean"?[new ur(y,d,"boolean expected, "+T+" found")]:[]},number:Yh,color:function(f){var d=f.key,y=f.value,T=$a(y);return T!=="string"?[new ur(d,y,"color expected, "+T+" found")]:ja(y)===null?[new ur(d,y,'color expected, "'+y+'" found')]:[]},constants:Wr,enum:gl,filter:gd,function:Pp,layer:_d,object:vl,source:Jh,light:Vf,string:xf,formatted:function(f){return xf(f).length===0?[]:wc(f)},resolvedImage:function(f){return xf(f).length===0?[]:wc(f)}};function go(f){var d=f.value,y=f.valueSpec,T=f.styleSpec;return y.expression&&Dl(qr(d))?Pp(f):y.expression&&Gc(Qr(d))?wc(f):y.type&&Bl[y.type]?Bl[y.type](f):vl(wn({},f,{valueSpec:y.type?T[y.type]:y}))}function is(f){var d=f.value,y=f.key,T=xf(f);return T.length||(d.indexOf("{fontstack}")===-1&&T.push(new ur(y,d,'"glyphs" url must include a "{fontstack}" token')),d.indexOf("{range}")===-1&&T.push(new ur(y,d,'"glyphs" url must include a "{range}" token'))),T}function Yu(f,d){d===void 0&&(d=Le);var y=[];return y=y.concat(go({key:"",value:f,valueSpec:d.$root,styleSpec:d,style:f,objectElementValidators:{glyphs:is,"*":function(){return[]}}})),f.constants&&(y=y.concat(Wr({key:"constants",value:f.constants,style:f,styleSpec:d}))),Fp(y)}function Fp(f){return[].concat(f).sort(function(d,y){return d.line-y.line})}function bf(f){return function(){for(var d=[],y=arguments.length;y--;)d[y]=arguments[y];return Fp(f.apply(this,d))}}Yu.source=bf(Jh),Yu.light=bf(Vf),Yu.layer=bf(_d),Yu.filter=bf(gd),Yu.paintProperty=bf(yd),Yu.layoutProperty=bf(gh);var tp=Yu,xd=tp.light,ep=tp.paintProperty,Rp=tp.layoutProperty;function rp(f,d){var y=!1;if(d&&d.length)for(var T=0,O=d;T<O.length;T+=1)f.fire(new fr(new Error(O[T].message))),y=!0;return y}var Ef=au;function au(f,d,y){var T=this.cells=[];if(f instanceof ArrayBuffer){this.arrayBuffer=f;var O=new Int32Array(this.arrayBuffer);f=O[0],this.d=(d=O[1])+2*(y=O[2]);for(var N=0;N<this.d*this.d;N++){var Z=O[3+N],q=O[3+N+1];T.push(Z===q?null:O.subarray(Z,q))}var dt=O[3+T.length+1];this.keys=O.subarray(O[3+T.length],dt),this.bboxes=O.subarray(dt),this.insert=this._insertReadonly}else{this.d=d+2*y;for(var Pt=0;Pt<this.d*this.d;Pt++)T.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=f,this.padding=y,this.scale=d/f,this.uid=0;var Zt=y/d*f;this.min=-Zt,this.max=f+Zt}au.prototype.insert=function(f,d,y,T,O){this._forEachCell(d,y,T,O,this._insertCell,this.uid++),this.keys.push(f),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(T),this.bboxes.push(O)},au.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},au.prototype._insertCell=function(f,d,y,T,O,N){this.cells[O].push(N)},au.prototype.query=function(f,d,y,T,O){var N=this.min,Z=this.max;if(f<=N&&d<=N&&Z<=y&&Z<=T&&!O)return Array.prototype.slice.call(this.keys);var q=[];return this._forEachCell(f,d,y,T,this._queryCell,q,{},O),q},au.prototype._queryCell=function(f,d,y,T,O,N,Z,q){var dt=this.cells[O];if(dt!==null)for(var Pt=this.keys,Zt=this.bboxes,qt=0;qt<dt.length;qt++){var pe=dt[qt];if(Z[pe]===void 0){var Oe=4*pe;(q?q(Zt[Oe+0],Zt[Oe+1],Zt[Oe+2],Zt[Oe+3]):f<=Zt[Oe+2]&&d<=Zt[Oe+3]&&y>=Zt[Oe+0]&&T>=Zt[Oe+1])?(Z[pe]=!0,N.push(Pt[pe])):Z[pe]=!1}}},au.prototype._forEachCell=function(f,d,y,T,O,N,Z,q){for(var dt=this._convertToCellCoord(f),Pt=this._convertToCellCoord(d),Zt=this._convertToCellCoord(y),qt=this._convertToCellCoord(T),pe=dt;pe<=Zt;pe++)for(var Oe=Pt;Oe<=qt;Oe++){var sr=this.d*Oe+pe;if((!q||q(this._convertFromCellCoord(pe),this._convertFromCellCoord(Oe),this._convertFromCellCoord(pe+1),this._convertFromCellCoord(Oe+1)))&&O.call(this,f,d,y,T,sr,N,Z,q))return}},au.prototype._convertFromCellCoord=function(f){return(f-this.padding)/this.scale},au.prototype._convertToCellCoord=function(f){return Math.max(0,Math.min(this.d-1,Math.floor(f*this.scale)+this.padding))},au.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var f=this.cells,d=3+this.cells.length+1+1,y=0,T=0;T<this.cells.length;T++)y+=this.cells[T].length;var O=new Int32Array(d+y+this.keys.length+this.bboxes.length);O[0]=this.extent,O[1]=this.n,O[2]=this.padding;for(var N=d,Z=0;Z<f.length;Z++){var q=f[Z];O[3+Z]=N,O.set(q,N),N+=q.length}return O[3+f.length]=N,O.set(this.keys,N),O[3+f.length+1]=N+=this.keys.length,O.set(this.bboxes,N),N+=this.bboxes.length,O.buffer};var Sf=tt.ImageData,np=tt.ImageBitmap,As={};function Zi(f,d,y){y===void 0&&(y={}),Object.defineProperty(d,"_classRegistryKey",{value:f,writeable:!1}),As[f]={klass:d,omit:y.omit||[],shallow:y.shallow||[]}}for(var as in Zi("Object",Object),Ef.serialize=function(f,d){var y=f.toArrayBuffer();return d&&d.push(y),{buffer:y}},Ef.deserialize=function(f){return new Ef(f.buffer)},Zi("Grid",Ef),Zi("Color",to),Zi("Error",Error),Zi("ResolvedImage",bo),Zi("StylePropertyFunction",_f),Zi("StyleExpression",zf,{omit:["_evaluator"]}),Zi("ZoomDependentExpression",lc),Zi("ZoomConstantExpression",Uf),Zi("CompoundExpression",Go,{omit:["_evaluate"]}),me)me[as]._classRegistryKey||Zi("Expression_"+as,me[as]);function wf(f){return f&&typeof ArrayBuffer!="undefined"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function Gf(f){return np&&f instanceof np}function cc(f,d){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp)return f;if(wf(f)||Gf(f))return d&&d.push(f),f;if(ArrayBuffer.isView(f)){var y=f;return d&&d.push(y.buffer),y}if(f instanceof Sf)return d&&d.push(f.data.buffer),f;if(Array.isArray(f)){for(var T=[],O=0,N=f;O<N.length;O+=1)T.push(cc(N[O],d));return T}if(typeof f=="object"){var Z=f.constructor,q=Z._classRegistryKey;if(!q)throw new Error("can't serialize object of unregistered class");var dt=Z.serialize?Z.serialize(f,d):{};if(!Z.serialize){for(var Pt in f)if(f.hasOwnProperty(Pt)&&!(As[q].omit.indexOf(Pt)>=0)){var Zt=f[Pt];dt[Pt]=As[q].shallow.indexOf(Pt)>=0?Zt:cc(Zt,d)}f instanceof Error&&(dt.message=f.message)}if(dt.$name)throw new Error("$name property is reserved for worker serialization logic.");return q!=="Object"&&(dt.$name=q),dt}throw new Error("can't serialize object of type "+typeof f)}function ml(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||wf(f)||Gf(f)||ArrayBuffer.isView(f)||f instanceof Sf)return f;if(Array.isArray(f))return f.map(ml);if(typeof f=="object"){var d=f.$name||"Object",y=As[d].klass;if(!y)throw new Error("can't deserialize unregistered class "+d);if(y.deserialize)return y.deserialize(f);for(var T=Object.create(y.prototype),O=0,N=Object.keys(f);O<N.length;O+=1){var Z=N[O];if(Z!=="$name"){var q=f[Z];T[Z]=As[d].shallow.indexOf(Z)>=0?q:ml(q)}}return T}throw new Error("can't deserialize object of type "+typeof f)}var Dp=function(){this.first=!0};Dp.prototype.update=function(f,d){var y=Math.floor(f);return this.first?(this.first=!1,this.lastIntegerZoom=y,this.lastIntegerZoomTime=0,this.lastZoom=f,this.lastFloorZoom=y,!0):(this.lastFloorZoom>y?(this.lastIntegerZoom=y+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<y&&(this.lastIntegerZoom=y,this.lastIntegerZoomTime=d),f!==this.lastZoom&&(this.lastZoom=f,this.lastFloorZoom=y,!0))};var Ai={"Latin-1 Supplement":function(f){return f>=128&&f<=255},Arabic:function(f){return f>=1536&&f<=1791},"Arabic Supplement":function(f){return f>=1872&&f<=1919},"Arabic Extended-A":function(f){return f>=2208&&f<=2303},"Hangul Jamo":function(f){return f>=4352&&f<=4607},"Unified Canadian Aboriginal Syllabics":function(f){return f>=5120&&f<=5759},Khmer:function(f){return f>=6016&&f<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(f){return f>=6320&&f<=6399},"General Punctuation":function(f){return f>=8192&&f<=8303},"Letterlike Symbols":function(f){return f>=8448&&f<=8527},"Number Forms":function(f){return f>=8528&&f<=8591},"Miscellaneous Technical":function(f){return f>=8960&&f<=9215},"Control Pictures":function(f){return f>=9216&&f<=9279},"Optical Character Recognition":function(f){return f>=9280&&f<=9311},"Enclosed Alphanumerics":function(f){return f>=9312&&f<=9471},"Geometric Shapes":function(f){return f>=9632&&f<=9727},"Miscellaneous Symbols":function(f){return f>=9728&&f<=9983},"Miscellaneous Symbols and Arrows":function(f){return f>=11008&&f<=11263},"CJK Radicals Supplement":function(f){return f>=11904&&f<=12031},"Kangxi Radicals":function(f){return f>=12032&&f<=12255},"Ideographic Description Characters":function(f){return f>=12272&&f<=12287},"CJK Symbols and Punctuation":function(f){return f>=12288&&f<=12351},Hiragana:function(f){return f>=12352&&f<=12447},Katakana:function(f){return f>=12448&&f<=12543},Bopomofo:function(f){return f>=12544&&f<=12591},"Hangul Compatibility Jamo":function(f){return f>=12592&&f<=12687},Kanbun:function(f){return f>=12688&&f<=12703},"Bopomofo Extended":function(f){return f>=12704&&f<=12735},"CJK Strokes":function(f){return f>=12736&&f<=12783},"Katakana Phonetic Extensions":function(f){return f>=12784&&f<=12799},"Enclosed CJK Letters and Months":function(f){return f>=12800&&f<=13055},"CJK Compatibility":function(f){return f>=13056&&f<=13311},"CJK Unified Ideographs Extension A":function(f){return f>=13312&&f<=19903},"Yijing Hexagram Symbols":function(f){return f>=19904&&f<=19967},"CJK Unified Ideographs":function(f){return f>=19968&&f<=40959},"Yi Syllables":function(f){return f>=40960&&f<=42127},"Yi Radicals":function(f){return f>=42128&&f<=42191},"Hangul Jamo Extended-A":function(f){return f>=43360&&f<=43391},"Hangul Syllables":function(f){return f>=44032&&f<=55215},"Hangul Jamo Extended-B":function(f){return f>=55216&&f<=55295},"Private Use Area":function(f){return f>=57344&&f<=63743},"CJK Compatibility Ideographs":function(f){return f>=63744&&f<=64255},"Arabic Presentation Forms-A":function(f){return f>=64336&&f<=65023},"Vertical Forms":function(f){return f>=65040&&f<=65055},"CJK Compatibility Forms":function(f){return f>=65072&&f<=65103},"Small Form Variants":function(f){return f>=65104&&f<=65135},"Arabic Presentation Forms-B":function(f){return f>=65136&&f<=65279},"Halfwidth and Fullwidth Forms":function(f){return f>=65280&&f<=65519}};function Hf(f){for(var d=0,y=f;d<y.length;d+=1)if(Cc(y[d].charCodeAt(0)))return!0;return!1}function Cc(f){return!(f!==746&&f!==747&&(f<4352||!(Ai["Bopomofo Extended"](f)||Ai.Bopomofo(f)||Ai["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Ai["CJK Compatibility Ideographs"](f)||Ai["CJK Compatibility"](f)||Ai["CJK Radicals Supplement"](f)||Ai["CJK Strokes"](f)||!(!Ai["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Ai["CJK Unified Ideographs Extension A"](f)||Ai["CJK Unified Ideographs"](f)||Ai["Enclosed CJK Letters and Months"](f)||Ai["Hangul Compatibility Jamo"](f)||Ai["Hangul Jamo Extended-A"](f)||Ai["Hangul Jamo Extended-B"](f)||Ai["Hangul Jamo"](f)||Ai["Hangul Syllables"](f)||Ai.Hiragana(f)||Ai["Ideographic Description Characters"](f)||Ai.Kanbun(f)||Ai["Kangxi Radicals"](f)||Ai["Katakana Phonetic Extensions"](f)||Ai.Katakana(f)&&f!==12540||!(!Ai["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Ai["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Ai["Unified Canadian Aboriginal Syllabics"](f)||Ai["Unified Canadian Aboriginal Syllabics Extended"](f)||Ai["Vertical Forms"](f)||Ai["Yijing Hexagram Symbols"](f)||Ai["Yi Syllables"](f)||Ai["Yi Radicals"](f))))}function Cf(f){return!(Cc(f)||function(d){return!!(Ai["Latin-1 Supplement"](d)&&(d===167||d===169||d===174||d===177||d===188||d===189||d===190||d===215||d===247)||Ai["General Punctuation"](d)&&(d===8214||d===8224||d===8225||d===8240||d===8241||d===8251||d===8252||d===8258||d===8263||d===8264||d===8265||d===8273)||Ai["Letterlike Symbols"](d)||Ai["Number Forms"](d)||Ai["Miscellaneous Technical"](d)&&(d>=8960&&d<=8967||d>=8972&&d<=8991||d>=8996&&d<=9e3||d===9003||d>=9085&&d<=9114||d>=9150&&d<=9165||d===9167||d>=9169&&d<=9179||d>=9186&&d<=9215)||Ai["Control Pictures"](d)&&d!==9251||Ai["Optical Character Recognition"](d)||Ai["Enclosed Alphanumerics"](d)||Ai["Geometric Shapes"](d)||Ai["Miscellaneous Symbols"](d)&&!(d>=9754&&d<=9759)||Ai["Miscellaneous Symbols and Arrows"](d)&&(d>=11026&&d<=11055||d>=11088&&d<=11097||d>=11192&&d<=11243)||Ai["CJK Symbols and Punctuation"](d)||Ai.Katakana(d)||Ai["Private Use Area"](d)||Ai["CJK Compatibility Forms"](d)||Ai["Small Form Variants"](d)||Ai["Halfwidth and Fullwidth Forms"](d)||d===8734||d===8756||d===8757||d>=9984&&d<=10087||d>=10102&&d<=10131||d===65532||d===65533)}(f))}function ma(f){return f>=1424&&f<=2303||Ai["Arabic Presentation Forms-A"](f)||Ai["Arabic Presentation Forms-B"](f)}function yl(f,d){return!(!d&&ma(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Ai.Khmer(f))}function jf(f){for(var d=0,y=f;d<y.length;d+=1)if(ma(y[d].charCodeAt(0)))return!0;return!1}var fc=null,_l="unavailable",sa=null,Bp=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(_l="error"),fc&&fc(f)};function Np(){bd.fire(new ze("pluginStateChange",{pluginStatus:_l,pluginURL:sa}))}var bd=new wr,Ed=function(){return _l},Ml=function(){if(_l!=="deferred"||!sa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_l="loading",Np(),sa&&Sn({url:sa},function(f){f?Bp(f):(_l="loaded",Np())})},Ko={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return _l==="loaded"||Ko.applyArabicShaping!=null},isLoading:function(){return _l==="loading"},setState:function(f){_l=f.pluginStatus,sa=f.pluginURL},isParsed:function(){return Ko.applyArabicShaping!=null&&Ko.processBidirectionalText!=null&&Ko.processStyledBidirectionalText!=null},getPluginURL:function(){return sa}},Ka=function(f,d){this.zoom=f,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Dp,this.transition={})};Ka.prototype.isSupportedScript=function(f){return function(d,y){for(var T=0,O=d;T<O.length;T+=1)if(!yl(O[T].charCodeAt(0),y))return!1;return!0}(f,Ko.isLoaded())},Ka.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Ka.prototype.getCrossfadeParameters=function(){var f=this.zoom,d=f-Math.floor(f),y=this.crossFadingFactor();return f>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*y}:{fromScale:.5,toScale:1,t:1-(1-y)*d}};var xl=function(f,d){this.property=f,this.value=d,this.expression=function(y,T){if(Dl(y))return new _f(y,T);if(Gc(y)){var O=al(y,T);if(O.result==="error")throw new Error(O.value.map(function(Z){return Z.key+": "+Z.message}).join(", "));return O.value}var N=y;return typeof y=="string"&&T.type==="color"&&(N=to.parse(y)),{kind:"constant",evaluate:function(){return N}}}(d===void 0?f.specification.default:d,f.specification)};xl.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},xl.prototype.possiblyEvaluate=function(f,d,y){return this.property.possiblyEvaluate(this,f,d,y)};var ql=function(f){this.property=f,this.value=new xl(f,void 0)};ql.prototype.transitioned=function(f,d){return new jc(this.property,this.value,d,b({},f.transition,this.transition),f.now)},ql.prototype.untransitioned=function(){return new jc(this.property,this.value,null,{},0)};var Ts=function(f){this._properties=f,this._values=Object.create(f.defaultTransitionablePropertyValues)};Ts.prototype.getValue=function(f){return _e(this._values[f].value.value)},Ts.prototype.setValue=function(f,d){this._values.hasOwnProperty(f)||(this._values[f]=new ql(this._values[f].property)),this._values[f].value=new xl(this._values[f].property,d===null?void 0:_e(d))},Ts.prototype.getTransition=function(f){return _e(this._values[f].transition)},Ts.prototype.setTransition=function(f,d){this._values.hasOwnProperty(f)||(this._values[f]=new ql(this._values[f].property)),this._values[f].transition=_e(d)||void 0},Ts.prototype.serialize=function(){for(var f={},d=0,y=Object.keys(this._values);d<y.length;d+=1){var T=y[d],O=this.getValue(T);O!==void 0&&(f[T]=O);var N=this.getTransition(T);N!==void 0&&(f[T+"-transition"]=N)}return f},Ts.prototype.transitioned=function(f,d){for(var y=new Nl(this._properties),T=0,O=Object.keys(this._values);T<O.length;T+=1){var N=O[T];y._values[N]=this._values[N].transitioned(f,d._values[N])}return y},Ts.prototype.untransitioned=function(){for(var f=new Nl(this._properties),d=0,y=Object.keys(this._values);d<y.length;d+=1){var T=y[d];f._values[T]=this._values[T].untransitioned()}return f};var jc=function(f,d,y,T,O){this.property=f,this.value=d,this.begin=O+T.delay||0,this.end=this.begin+T.duration||0,f.specification.transition&&(T.delay||T.duration)&&(this.prior=y)};jc.prototype.possiblyEvaluate=function(f,d,y){var T=f.now||0,O=this.value.possiblyEvaluate(f,d,y),N=this.prior;if(N){if(T>this.end)return this.prior=null,O;if(this.value.isDataDriven())return this.prior=null,O;if(T<this.begin)return N.possiblyEvaluate(f,d,y);var Z=(T-this.begin)/(this.end-this.begin);return this.property.interpolate(N.possiblyEvaluate(f,d,y),O,function(q){if(q<=0)return 0;if(q>=1)return 1;var dt=q*q,Pt=dt*q;return 4*(q<.5?Pt:3*(q-dt)+Pt-.75)}(Z))}return O};var Nl=function(f){this._properties=f,this._values=Object.create(f.defaultTransitioningPropertyValues)};Nl.prototype.possiblyEvaluate=function(f,d,y){for(var T=new Il(this._properties),O=0,N=Object.keys(this._values);O<N.length;O+=1){var Z=N[O];T._values[Z]=this._values[Z].possiblyEvaluate(f,d,y)}return T},Nl.prototype.hasTransition=function(){for(var f=0,d=Object.keys(this._values);f<d.length;f+=1)if(this._values[d[f]].prior)return!0;return!1};var Su=function(f){this._properties=f,this._values=Object.create(f.defaultPropertyValues)};Su.prototype.getValue=function(f){return _e(this._values[f].value)},Su.prototype.setValue=function(f,d){this._values[f]=new xl(this._values[f].property,d===null?void 0:_e(d))},Su.prototype.serialize=function(){for(var f={},d=0,y=Object.keys(this._values);d<y.length;d+=1){var T=y[d],O=this.getValue(T);O!==void 0&&(f[T]=O)}return f},Su.prototype.possiblyEvaluate=function(f,d,y){for(var T=new Il(this._properties),O=0,N=Object.keys(this._values);O<N.length;O+=1){var Z=N[O];T._values[Z]=this._values[Z].possiblyEvaluate(f,d,y)}return T};var wu=function(f,d,y){this.property=f,this.value=d,this.parameters=y};wu.prototype.isConstant=function(){return this.value.kind==="constant"},wu.prototype.constantOr=function(f){return this.value.kind==="constant"?this.value.value:f},wu.prototype.evaluate=function(f,d,y,T){return this.property.evaluate(this.value,this.parameters,f,d,y,T)};var Il=function(f){this._properties=f,this._values=Object.create(f.defaultPossiblyEvaluatedValues)};Il.prototype.get=function(f){return this._values[f]};var Ki=function(f){this.specification=f};Ki.prototype.possiblyEvaluate=function(f,d){return f.expression.evaluate(d)},Ki.prototype.interpolate=function(f,d,y){var T=rs[this.specification.type];return T?T(f,d,y):f};var Wi=function(f,d){this.specification=f,this.overrides=d};Wi.prototype.possiblyEvaluate=function(f,d,y,T){return new wu(this,f.expression.kind==="constant"||f.expression.kind==="camera"?{kind:"constant",value:f.expression.evaluate(d,null,{},y,T)}:f.expression,d)},Wi.prototype.interpolate=function(f,d,y){if(f.value.kind!=="constant"||d.value.kind!=="constant")return f;if(f.value.value===void 0||d.value.value===void 0)return new wu(this,{kind:"constant",value:void 0},f.parameters);var T=rs[this.specification.type];return T?new wu(this,{kind:"constant",value:T(f.value.value,d.value.value,y)},f.parameters):f},Wi.prototype.evaluate=function(f,d,y,T,O,N){return f.kind==="constant"?f.value:f.evaluate(d,y,T,O,N)};var Af=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(y,T,O,N){if(y.value===void 0)return new wu(this,{kind:"constant",value:void 0},T);if(y.expression.kind==="constant"){var Z=y.expression.evaluate(T,null,{},O,N),q=y.property.specification.type==="resolvedImage"&&typeof Z!="string"?Z.name:Z,dt=this._calculate(q,q,q,T);return new wu(this,{kind:"constant",value:dt},T)}if(y.expression.kind==="camera"){var Pt=this._calculate(y.expression.evaluate({zoom:T.zoom-1}),y.expression.evaluate({zoom:T.zoom}),y.expression.evaluate({zoom:T.zoom+1}),T);return new wu(this,{kind:"constant",value:Pt},T)}return new wu(this,y.expression,T)},d.prototype.evaluate=function(y,T,O,N,Z,q){if(y.kind==="source"){var dt=y.evaluate(T,O,N,Z,q);return this._calculate(dt,dt,dt,T)}return y.kind==="composite"?this._calculate(y.evaluate({zoom:Math.floor(T.zoom)-1},O,N),y.evaluate({zoom:Math.floor(T.zoom)},O,N),y.evaluate({zoom:Math.floor(T.zoom)+1},O,N),T):y.value},d.prototype._calculate=function(y,T,O,N){return N.zoom>N.zoomHistory.lastIntegerZoom?{from:y,to:T}:{from:O,to:T}},d.prototype.interpolate=function(y){return y},d}(Wi),ol=function(f){this.specification=f};ol.prototype.possiblyEvaluate=function(f,d,y,T){if(f.value!==void 0){if(f.expression.kind==="constant"){var O=f.expression.evaluate(d,null,{},y,T);return this._calculate(O,O,O,d)}return this._calculate(f.expression.evaluate(new Ka(Math.floor(d.zoom-1),d)),f.expression.evaluate(new Ka(Math.floor(d.zoom),d)),f.expression.evaluate(new Ka(Math.floor(d.zoom+1),d)),d)}},ol.prototype._calculate=function(f,d,y,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:f,to:d}:{from:y,to:d}},ol.prototype.interpolate=function(f){return f};var sl=function(f){this.specification=f};sl.prototype.possiblyEvaluate=function(f,d,y,T){return!!f.expression.evaluate(d,null,{},y,T)},sl.prototype.interpolate=function(){return!1};var Ru=function(f){for(var d in this.properties=f,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],f){var y=f[d];y.specification.overridable&&this.overridableProperties.push(d);var T=this.defaultPropertyValues[d]=new xl(y,void 0),O=this.defaultTransitionablePropertyValues[d]=new ql(y);this.defaultTransitioningPropertyValues[d]=O.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=T.possiblyEvaluate({})}};Zi("DataDrivenProperty",Wi),Zi("DataConstantProperty",Ki),Zi("CrossFadedDataDrivenProperty",Af),Zi("CrossFadedProperty",ol),Zi("ColorRampProperty",sl);var bs=function(f){function d(y,T){if(f.call(this),this.id=y.id,this.type=y.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},y.type!=="custom"&&(this.metadata=(y=y).metadata,this.minzoom=y.minzoom,this.maxzoom=y.maxzoom,y.type!=="background"&&(this.source=y.source,this.sourceLayer=y["source-layer"],this.filter=y.filter),T.layout&&(this._unevaluatedLayout=new Su(T.layout)),T.paint)){for(var O in this._transitionablePaint=new Ts(T.paint),y.paint)this.setPaintProperty(O,y.paint[O],{validate:!1});for(var N in y.layout)this.setLayoutProperty(N,y.layout[N],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Il(T.paint)}}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},d.prototype.getLayoutProperty=function(y){return y==="visibility"?this.visibility:this._unevaluatedLayout.getValue(y)},d.prototype.setLayoutProperty=function(y,T,O){O===void 0&&(O={}),T!=null&&this._validate(Rp,"layers."+this.id+".layout."+y,y,T,O)||(y!=="visibility"?this._unevaluatedLayout.setValue(y,T):this.visibility=T)},d.prototype.getPaintProperty=function(y){return et(y,"-transition")?this._transitionablePaint.getTransition(y.slice(0,-11)):this._transitionablePaint.getValue(y)},d.prototype.setPaintProperty=function(y,T,O){if(O===void 0&&(O={}),T!=null&&this._validate(ep,"layers."+this.id+".paint."+y,y,T,O))return!1;if(et(y,"-transition"))return this._transitionablePaint.setTransition(y.slice(0,-11),T||void 0),!1;var N=this._transitionablePaint._values[y],Z=N.property.specification["property-type"]==="cross-faded-data-driven",q=N.value.isDataDriven(),dt=N.value;this._transitionablePaint.setValue(y,T),this._handleSpecialPaintPropertyUpdate(y);var Pt=this._transitionablePaint._values[y].value;return Pt.isDataDriven()||q||Z||this._handleOverridablePaintPropertyUpdate(y,dt,Pt)},d.prototype._handleSpecialPaintPropertyUpdate=function(y){},d.prototype._handleOverridablePaintPropertyUpdate=function(y,T,O){return!1},d.prototype.isHidden=function(y){return!!(this.minzoom&&y<this.minzoom)||!!(this.maxzoom&&y>=this.maxzoom)||this.visibility==="none"},d.prototype.updateTransitions=function(y){this._transitioningPaint=this._transitionablePaint.transitioned(y,this._transitioningPaint)},d.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},d.prototype.recalculate=function(y,T){y.getCrossfadeParameters&&(this._crossfadeParameters=y.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(y,void 0,T)),this.paint=this._transitioningPaint.possiblyEvaluate(y,void 0,T)},d.prototype.serialize=function(){var y={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(y.layout=y.layout||{},y.layout.visibility=this.visibility),we(y,function(T,O){return!(T===void 0||O==="layout"&&!Object.keys(T).length||O==="paint"&&!Object.keys(T).length)})},d.prototype._validate=function(y,T,O,N,Z){return Z===void 0&&(Z={}),(!Z||Z.validate!==!1)&&rp(this,y.call(tp,{key:T,layerType:this.type,objectKey:O,value:N,styleSpec:Le,style:{glyphs:!0,sprite:!0}}))},d.prototype.is3D=function(){return!1},d.prototype.isTileClipped=function(){return!1},d.prototype.hasOffscreenPass=function(){return!1},d.prototype.resize=function(){},d.prototype.isStateDependent=function(){for(var y in this.paint._values){var T=this.paint.get(y);if(T instanceof wu&&Ia(T.property.specification)&&(T.value.kind==="source"||T.value.kind==="composite")&&T.value.isStateDependent)return!0}return!1},d}(wr),Ac={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Tc=function(f,d){this._structArray=f,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},No=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function os(f,d){d===void 0&&(d=1);var y=0,T=0;return{members:f.map(function(O){var N=Ac[O.type].BYTES_PER_ELEMENT,Z=y=ip(y,Math.max(d,N)),q=O.components||1;return T=Math.max(T,N),y+=N*q,{name:O.name,type:O.type,components:q,offset:Z}}),size:ip(y,Math.max(T,d)),alignment:d}}function ip(f,d){return Math.ceil(f/d)*d}No.serialize=function(f,d){return f._trim(),d&&(f.isTransferred=!0,d.push(f.arrayBuffer)),{length:f.length,arrayBuffer:f.arrayBuffer}},No.deserialize=function(f){var d=Object.create(this.prototype);return d.arrayBuffer=f.arrayBuffer,d.length=f.length,d.capacity=f.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d},No.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},No.prototype.clear=function(){this.length=0},No.prototype.resize=function(f){this.reserve(f),this.length=f},No.prototype.reserve=function(f){if(f>this.capacity){this.capacity=Math.max(f,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}},No.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Wc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T){var O=this.length;return this.resize(O+1),this.emplace(O,y,T)},d.prototype.emplace=function(y,T,O){var N=2*y;return this.int16[N+0]=T,this.int16[N+1]=O,y},d}(No);Wc.prototype.bytesPerElement=4,Zi("StructArrayLayout2i4",Wc);var hc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N){var Z=this.length;return this.resize(Z+1),this.emplace(Z,y,T,O,N)},d.prototype.emplace=function(y,T,O,N,Z){var q=4*y;return this.int16[q+0]=T,this.int16[q+1]=O,this.int16[q+2]=N,this.int16[q+3]=Z,y},d}(No);hc.prototype.bytesPerElement=8,Zi("StructArrayLayout4i8",hc);var ul=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q){var dt=this.length;return this.resize(dt+1),this.emplace(dt,y,T,O,N,Z,q)},d.prototype.emplace=function(y,T,O,N,Z,q,dt){var Pt=6*y;return this.int16[Pt+0]=T,this.int16[Pt+1]=O,this.int16[Pt+2]=N,this.int16[Pt+3]=Z,this.int16[Pt+4]=q,this.int16[Pt+5]=dt,y},d}(No);ul.prototype.bytesPerElement=12,Zi("StructArrayLayout2i4i12",ul);var Fs=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q){var dt=this.length;return this.resize(dt+1),this.emplace(dt,y,T,O,N,Z,q)},d.prototype.emplace=function(y,T,O,N,Z,q,dt){var Pt=4*y,Zt=8*y;return this.int16[Pt+0]=T,this.int16[Pt+1]=O,this.uint8[Zt+4]=N,this.uint8[Zt+5]=Z,this.uint8[Zt+6]=q,this.uint8[Zt+7]=dt,y},d}(No);Fs.prototype.bytesPerElement=8,Zi("StructArrayLayout2i4ub8",Fs);var Ms=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T){var O=this.length;return this.resize(O+1),this.emplace(O,y,T)},d.prototype.emplace=function(y,T,O){var N=2*y;return this.float32[N+0]=T,this.float32[N+1]=O,y},d}(No);Ms.prototype.bytesPerElement=8,Zi("StructArrayLayout2f8",Ms);var $u=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q,dt,Pt,Zt,qt){var pe=this.length;return this.resize(pe+1),this.emplace(pe,y,T,O,N,Z,q,dt,Pt,Zt,qt)},d.prototype.emplace=function(y,T,O,N,Z,q,dt,Pt,Zt,qt,pe){var Oe=10*y;return this.uint16[Oe+0]=T,this.uint16[Oe+1]=O,this.uint16[Oe+2]=N,this.uint16[Oe+3]=Z,this.uint16[Oe+4]=q,this.uint16[Oe+5]=dt,this.uint16[Oe+6]=Pt,this.uint16[Oe+7]=Zt,this.uint16[Oe+8]=qt,this.uint16[Oe+9]=pe,y},d}(No);$u.prototype.bytesPerElement=20,Zi("StructArrayLayout10ui20",$u);var Xc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe){var sr=this.length;return this.resize(sr+1),this.emplace(sr,y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe)},d.prototype.emplace=function(y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe,sr){var lr=12*y;return this.int16[lr+0]=T,this.int16[lr+1]=O,this.int16[lr+2]=N,this.int16[lr+3]=Z,this.uint16[lr+4]=q,this.uint16[lr+5]=dt,this.uint16[lr+6]=Pt,this.uint16[lr+7]=Zt,this.int16[lr+8]=qt,this.int16[lr+9]=pe,this.int16[lr+10]=Oe,this.int16[lr+11]=sr,y},d}(No);Xc.prototype.bytesPerElement=24,Zi("StructArrayLayout4i4ui4i24",Xc);var ll=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=3*y;return this.float32[Z+0]=T,this.float32[Z+1]=O,this.float32[Z+2]=N,y},d}(No);ll.prototype.bytesPerElement=12,Zi("StructArrayLayout3f12",ll);var Wf=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y){var T=this.length;return this.resize(T+1),this.emplace(T,y)},d.prototype.emplace=function(y,T){return this.uint32[1*y+0]=T,y},d}(No);Wf.prototype.bytesPerElement=4,Zi("StructArrayLayout1ul4",Wf);var Mc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q,dt,Pt,Zt){var qt=this.length;return this.resize(qt+1),this.emplace(qt,y,T,O,N,Z,q,dt,Pt,Zt)},d.prototype.emplace=function(y,T,O,N,Z,q,dt,Pt,Zt,qt){var pe=10*y,Oe=5*y;return this.int16[pe+0]=T,this.int16[pe+1]=O,this.int16[pe+2]=N,this.int16[pe+3]=Z,this.int16[pe+4]=q,this.int16[pe+5]=dt,this.uint32[Oe+3]=Pt,this.uint16[pe+8]=Zt,this.uint16[pe+9]=qt,y},d}(No);Mc.prototype.bytesPerElement=20,Zi("StructArrayLayout6i1ul2ui20",Mc);var mh=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q){var dt=this.length;return this.resize(dt+1),this.emplace(dt,y,T,O,N,Z,q)},d.prototype.emplace=function(y,T,O,N,Z,q,dt){var Pt=6*y;return this.int16[Pt+0]=T,this.int16[Pt+1]=O,this.int16[Pt+2]=N,this.int16[Pt+3]=Z,this.int16[Pt+4]=q,this.int16[Pt+5]=dt,y},d}(No);mh.prototype.bytesPerElement=12,Zi("StructArrayLayout2i2i2i12",mh);var Xf=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z){var q=this.length;return this.resize(q+1),this.emplace(q,y,T,O,N,Z)},d.prototype.emplace=function(y,T,O,N,Z,q){var dt=4*y,Pt=8*y;return this.float32[dt+0]=T,this.float32[dt+1]=O,this.float32[dt+2]=N,this.int16[Pt+6]=Z,this.int16[Pt+7]=q,y},d}(No);Xf.prototype.bytesPerElement=16,Zi("StructArrayLayout2f1f2i16",Xf);var Sd=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N){var Z=this.length;return this.resize(Z+1),this.emplace(Z,y,T,O,N)},d.prototype.emplace=function(y,T,O,N,Z){var q=12*y,dt=3*y;return this.uint8[q+0]=T,this.uint8[q+1]=O,this.float32[dt+1]=N,this.float32[dt+2]=Z,y},d}(No);Sd.prototype.bytesPerElement=12,Zi("StructArrayLayout2ub2f12",Sd);var Rs=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=3*y;return this.uint16[Z+0]=T,this.uint16[Z+1]=O,this.uint16[Z+2]=N,y},d}(No);Rs.prototype.bytesPerElement=6,Zi("StructArrayLayout3ui6",Rs);var Ic=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe,sr,lr,Cr,gr,Ur){var Ar=this.length;return this.resize(Ar+1),this.emplace(Ar,y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe,sr,lr,Cr,gr,Ur)},d.prototype.emplace=function(y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe,sr,lr,Cr,gr,Ur,Ar){var Dr=24*y,mn=12*y,Fn=48*y;return this.int16[Dr+0]=T,this.int16[Dr+1]=O,this.uint16[Dr+2]=N,this.uint16[Dr+3]=Z,this.uint32[mn+2]=q,this.uint32[mn+3]=dt,this.uint32[mn+4]=Pt,this.uint16[Dr+10]=Zt,this.uint16[Dr+11]=qt,this.uint16[Dr+12]=pe,this.float32[mn+7]=Oe,this.float32[mn+8]=sr,this.uint8[Fn+36]=lr,this.uint8[Fn+37]=Cr,this.uint8[Fn+38]=gr,this.uint32[mn+10]=Ur,this.int16[Dr+22]=Ar,y},d}(No);Ic.prototype.bytesPerElement=48,Zi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ic);var ap=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe,sr,lr,Cr,gr,Ur,Ar,Dr,mn,Fn,ni,ki,oa,Di,ca,zi,Oa){var xa=this.length;return this.resize(xa+1),this.emplace(xa,y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe,sr,lr,Cr,gr,Ur,Ar,Dr,mn,Fn,ni,ki,oa,Di,ca,zi,Oa)},d.prototype.emplace=function(y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe,sr,lr,Cr,gr,Ur,Ar,Dr,mn,Fn,ni,ki,oa,Di,ca,zi,Oa,xa){var Qi=34*y,lo=17*y;return this.int16[Qi+0]=T,this.int16[Qi+1]=O,this.int16[Qi+2]=N,this.int16[Qi+3]=Z,this.int16[Qi+4]=q,this.int16[Qi+5]=dt,this.int16[Qi+6]=Pt,this.int16[Qi+7]=Zt,this.uint16[Qi+8]=qt,this.uint16[Qi+9]=pe,this.uint16[Qi+10]=Oe,this.uint16[Qi+11]=sr,this.uint16[Qi+12]=lr,this.uint16[Qi+13]=Cr,this.uint16[Qi+14]=gr,this.uint16[Qi+15]=Ur,this.uint16[Qi+16]=Ar,this.uint16[Qi+17]=Dr,this.uint16[Qi+18]=mn,this.uint16[Qi+19]=Fn,this.uint16[Qi+20]=ni,this.uint16[Qi+21]=ki,this.uint16[Qi+22]=oa,this.uint32[lo+12]=Di,this.float32[lo+13]=ca,this.float32[lo+14]=zi,this.float32[lo+15]=Oa,this.float32[lo+16]=xa,y},d}(No);ap.prototype.bytesPerElement=68,Zi("StructArrayLayout8i15ui1ul4f68",ap);var bl=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y){var T=this.length;return this.resize(T+1),this.emplace(T,y)},d.prototype.emplace=function(y,T){return this.float32[1*y+0]=T,y},d}(No);bl.prototype.bytesPerElement=4,Zi("StructArrayLayout1f4",bl);var zl=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=3*y;return this.int16[Z+0]=T,this.int16[Z+1]=O,this.int16[Z+2]=N,y},d}(No);zl.prototype.bytesPerElement=6,Zi("StructArrayLayout3i6",zl);var op=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=4*y;return this.uint32[2*y+0]=T,this.uint16[Z+2]=O,this.uint16[Z+3]=N,y},d}(No);op.prototype.bytesPerElement=8,Zi("StructArrayLayout1ul2ui8",op);var pc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T){var O=this.length;return this.resize(O+1),this.emplace(O,y,T)},d.prototype.emplace=function(y,T,O){var N=2*y;return this.uint16[N+0]=T,this.uint16[N+1]=O,y},d}(No);pc.prototype.bytesPerElement=4,Zi("StructArrayLayout2ui4",pc);var zp=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y){var T=this.length;return this.resize(T+1),this.emplace(T,y)},d.prototype.emplace=function(y,T){return this.uint16[1*y+0]=T,y},d}(No);zp.prototype.bytesPerElement=2,Zi("StructArrayLayout1ui2",zp);var Yc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N){var Z=this.length;return this.resize(Z+1),this.emplace(Z,y,T,O,N)},d.prototype.emplace=function(y,T,O,N,Z){var q=4*y;return this.float32[q+0]=T,this.float32[q+1]=O,this.float32[q+2]=N,this.float32[q+3]=Z,y},d}(No);Yc.prototype.bytesPerElement=16,Zi("StructArrayLayout4f16",Yc);var x=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return y.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},y.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},y.x1.get=function(){return this._structArray.int16[this._pos2+2]},y.y1.get=function(){return this._structArray.int16[this._pos2+3]},y.x2.get=function(){return this._structArray.int16[this._pos2+4]},y.y2.get=function(){return this._structArray.int16[this._pos2+5]},y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},y.anchorPoint.get=function(){return new ht(this.anchorPointX,this.anchorPointY)},Object.defineProperties(d.prototype,y),d}(Tc);x.prototype.size=20;var C=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new x(this,y)},d}(Mc);Zi("CollisionBoxArray",C);var S=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},y.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},y.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},y.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},y.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},y.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},y.segment.get=function(){return this._structArray.uint16[this._pos2+10]},y.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},y.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},y.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},y.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},y.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},y.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},y.placedOrientation.set=function(T){this._structArray.uint8[this._pos1+37]=T},y.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},y.hidden.set=function(T){this._structArray.uint8[this._pos1+38]=T},y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},y.crossTileID.set=function(T){this._structArray.uint32[this._pos4+10]=T},y.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(d.prototype,y),d}(Tc);S.prototype.size=48;var M=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new S(this,y)},d}(Ic);Zi("PlacedSymbolArray",M);var z=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},y.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},y.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},y.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},y.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},y.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},y.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},y.key.get=function(){return this._structArray.uint16[this._pos2+8]},y.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},y.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},y.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},y.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},y.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},y.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},y.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},y.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},y.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},y.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},y.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},y.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},y.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},y.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},y.crossTileID.set=function(T){this._structArray.uint32[this._pos4+12]=T},y.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},y.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},y.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},y.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(d.prototype,y),d}(Tc);z.prototype.size=68;var H=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new z(this,y)},d}(ap);Zi("SymbolInstanceArray",H);var $=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.getoffsetX=function(y){return this.float32[1*y+0]},d}(bl);Zi("GlyphOffsetArray",$);var ft=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.getx=function(y){return this.int16[3*y+0]},d.prototype.gety=function(y){return this.int16[3*y+1]},d.prototype.gettileUnitDistanceFromAnchor=function(y){return this.int16[3*y+2]},d}(zl);Zi("SymbolLineVertexArray",ft);var zt=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(d.prototype,y),d}(Tc);zt.prototype.size=8;var ee=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new zt(this,y)},d}(op);Zi("FeatureIndexArray",ee);var Re=os([{name:"a_pos",components:2,type:"Int16"}],4).members,De=function(f){f===void 0&&(f=[]),this.segments=f};function ke(f,d){return 256*(f=Ut(Math.floor(f),0,255))+Ut(Math.floor(d),0,255)}De.prototype.prepareSegment=function(f,d,y,T){var O=this.segments[this.segments.length-1];return f>De.MAX_VERTEX_ARRAY_LENGTH&&te("Max vertices per segment is "+De.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+f),(!O||O.vertexLength+f>De.MAX_VERTEX_ARRAY_LENGTH||O.sortKey!==T)&&(O={vertexOffset:d.length,primitiveOffset:y.length,vertexLength:0,primitiveLength:0},T!==void 0&&(O.sortKey=T),this.segments.push(O)),O},De.prototype.get=function(){return this.segments},De.prototype.destroy=function(){for(var f=0,d=this.segments;f<d.length;f+=1){var y=d[f];for(var T in y.vaos)y.vaos[T].destroy()}},De.simpleSegment=function(f,d,y,T){return new De([{vertexOffset:f,primitiveOffset:d,vertexLength:y,primitiveLength:T,vaos:{},sortKey:0}])},De.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Zi("SegmentVector",De);var cr=os([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ar=xt(function(f){f.exports=function(d,y){var T,O,N,Z,q,dt,Pt,Zt;for(O=d.length-(T=3&d.length),N=y,q=3432918353,dt=461845907,Zt=0;Zt<O;)Pt=255&d.charCodeAt(Zt)|(255&d.charCodeAt(++Zt))<<8|(255&d.charCodeAt(++Zt))<<16|(255&d.charCodeAt(++Zt))<<24,++Zt,N=27492+(65535&(Z=5*(65535&(N=(N^=Pt=(65535&(Pt=(Pt=(65535&Pt)*q+(((Pt>>>16)*q&65535)<<16)&4294967295)<<15|Pt>>>17))*dt+(((Pt>>>16)*dt&65535)<<16)&4294967295)<<13|N>>>19))+((5*(N>>>16)&65535)<<16)&4294967295))+((58964+(Z>>>16)&65535)<<16);switch(Pt=0,T){case 3:Pt^=(255&d.charCodeAt(Zt+2))<<16;case 2:Pt^=(255&d.charCodeAt(Zt+1))<<8;case 1:N^=Pt=(65535&(Pt=(Pt=(65535&(Pt^=255&d.charCodeAt(Zt)))*q+(((Pt>>>16)*q&65535)<<16)&4294967295)<<15|Pt>>>17))*dt+(((Pt>>>16)*dt&65535)<<16)&4294967295}return N^=d.length,N=2246822507*(65535&(N^=N>>>16))+((2246822507*(N>>>16)&65535)<<16)&4294967295,N=3266489909*(65535&(N^=N>>>13))+((3266489909*(N>>>16)&65535)<<16)&4294967295,(N^=N>>>16)>>>0}}),br=xt(function(f){f.exports=function(d,y){for(var T,O=d.length,N=y^O,Z=0;O>=4;)T=1540483477*(65535&(T=255&d.charCodeAt(Z)|(255&d.charCodeAt(++Z))<<8|(255&d.charCodeAt(++Z))<<16|(255&d.charCodeAt(++Z))<<24))+((1540483477*(T>>>16)&65535)<<16),N=1540483477*(65535&N)+((1540483477*(N>>>16)&65535)<<16)^(T=1540483477*(65535&(T^=T>>>24))+((1540483477*(T>>>16)&65535)<<16)),O-=4,++Z;switch(O){case 3:N^=(255&d.charCodeAt(Z+2))<<16;case 2:N^=(255&d.charCodeAt(Z+1))<<8;case 1:N=1540483477*(65535&(N^=255&d.charCodeAt(Z)))+((1540483477*(N>>>16)&65535)<<16)}return N=1540483477*(65535&(N^=N>>>13))+((1540483477*(N>>>16)&65535)<<16),(N^=N>>>15)>>>0}}),rr=ar,xr=br;rr.murmur3=ar,rr.murmur2=xr;var Pr=function(){this.ids=[],this.positions=[],this.indexed=!1};Pr.prototype.add=function(f,d,y,T){this.ids.push(vn(f)),this.positions.push(d,y,T)},Pr.prototype.getPositions=function(f){for(var d=vn(f),y=0,T=this.ids.length-1;y<T;){var O=y+T>>1;this.ids[O]>=d?T=O:y=O+1}for(var N=[];this.ids[y]===d;)N.push({index:this.positions[3*y],start:this.positions[3*y+1],end:this.positions[3*y+2]}),y++;return N},Pr.serialize=function(f,d){var y=new Float64Array(f.ids),T=new Uint32Array(f.positions);return function O(N,Z,q,dt){for(;q<dt;){for(var Pt=N[q+dt>>1],Zt=q-1,qt=dt+1;;){do Zt++;while(N[Zt]<Pt);do qt--;while(N[qt]>Pt);if(Zt>=qt)break;ln(N,Zt,qt),ln(Z,3*Zt,3*qt),ln(Z,3*Zt+1,3*qt+1),ln(Z,3*Zt+2,3*qt+2)}qt-q<dt-qt?(O(N,Z,q,qt),q=qt+1):(O(N,Z,qt+1,dt),dt=qt)}}(y,T,0,y.length-1),d&&d.push(y.buffer,T.buffer),{ids:y,positions:T}},Pr.deserialize=function(f){var d=new Pr;return d.ids=f.ids,d.positions=f.positions,d.indexed=!0,d};var Rr=Math.pow(2,53)-1;function vn(f){var d=+f;return!isNaN(d)&&d<=Rr?d:rr(String(f))}function ln(f,d,y){var T=f[d];f[d]=f[y],f[y]=T}Zi("FeaturePositionMap",Pr);var bn=function(f,d){this.gl=f.gl,this.location=d},Zn=function(f){function d(y,T){f.call(this,y,T),this.current=0}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){this.current!==y&&(this.current=y,this.gl.uniform1i(this.location,y))},d}(bn),Kn=function(f){function d(y,T){f.call(this,y,T),this.current=0}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){this.current!==y&&(this.current=y,this.gl.uniform1f(this.location,y))},d}(bn),ci=function(f){function d(y,T){f.call(this,y,T),this.current=[0,0]}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y[0]===this.current[0]&&y[1]===this.current[1]||(this.current=y,this.gl.uniform2f(this.location,y[0],y[1]))},d}(bn),Oi=function(f){function d(y,T){f.call(this,y,T),this.current=[0,0,0]}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y[0]===this.current[0]&&y[1]===this.current[1]&&y[2]===this.current[2]||(this.current=y,this.gl.uniform3f(this.location,y[0],y[1],y[2]))},d}(bn),na=function(f){function d(y,T){f.call(this,y,T),this.current=[0,0,0,0]}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y[0]===this.current[0]&&y[1]===this.current[1]&&y[2]===this.current[2]&&y[3]===this.current[3]||(this.current=y,this.gl.uniform4f(this.location,y[0],y[1],y[2],y[3]))},d}(bn),ia=function(f){function d(y,T){f.call(this,y,T),this.current=to.transparent}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y.r===this.current.r&&y.g===this.current.g&&y.b===this.current.b&&y.a===this.current.a||(this.current=y,this.gl.uniform4f(this.location,y.r,y.g,y.b,y.a))},d}(bn),ua=new Float32Array(16),Qa=function(f){function d(y,T){f.call(this,y,T),this.current=ua}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){if(y[12]!==this.current[12]||y[0]!==this.current[0])return this.current=y,void this.gl.uniformMatrix4fv(this.location,!1,y);for(var T=1;T<16;T++)if(y[T]!==this.current[T]){this.current=y,this.gl.uniformMatrix4fv(this.location,!1,y);break}},d}(bn);function Fi(f){return[ke(255*f.r,255*f.g),ke(255*f.b,255*f.a)]}var Ra=function(f,d,y){this.value=f,this.uniformNames=d.map(function(T){return"u_"+T}),this.type=y};Ra.prototype.setUniform=function(f,d,y){f.set(y.constantOr(this.value))},Ra.prototype.getBinding=function(f,d,y){return this.type==="color"?new ia(f,d):new Kn(f,d)};var Aa=function(f,d){this.uniformNames=d.map(function(y){return"u_"+y}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Aa.prototype.setConstantPatternPositions=function(f,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=f.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=f.tlbr},Aa.prototype.setUniform=function(f,d,y,T){var O=T==="u_pattern_to"?this.patternTo:T==="u_pattern_from"?this.patternFrom:T==="u_pixel_ratio_to"?this.pixelRatioTo:T==="u_pixel_ratio_from"?this.pixelRatioFrom:null;O&&f.set(O)},Aa.prototype.getBinding=function(f,d,y){return y.substr(0,9)==="u_pattern"?new na(f,d):new Kn(f,d)};var ka=function(f,d,y,T){this.expression=f,this.type=y,this.maxValue=0,this.paintVertexAttributes=d.map(function(O){return{name:"a_"+O,type:"Float32",components:y==="color"?2:1,offset:0}}),this.paintVertexArray=new T};ka.prototype.populatePaintArray=function(f,d,y,T,O){var N=this.paintVertexArray.length,Z=this.expression.evaluate(new Ka(0),d,{},T,[],O);this.paintVertexArray.resize(f),this._setPaintValue(N,f,Z)},ka.prototype.updatePaintArray=function(f,d,y,T){var O=this.expression.evaluate({zoom:0},y,T);this._setPaintValue(f,d,O)},ka.prototype._setPaintValue=function(f,d,y){if(this.type==="color")for(var T=Fi(y),O=f;O<d;O++)this.paintVertexArray.emplace(O,T[0],T[1]);else{for(var N=f;N<d;N++)this.paintVertexArray.emplace(N,y);this.maxValue=Math.max(this.maxValue,Math.abs(y))}},ka.prototype.upload=function(f){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=f.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ka.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var la=function(f,d,y,T,O,N){this.expression=f,this.uniformNames=d.map(function(Z){return"u_"+Z+"_t"}),this.type=y,this.useIntegerZoom=T,this.zoom=O,this.maxValue=0,this.paintVertexAttributes=d.map(function(Z){return{name:"a_"+Z,type:"Float32",components:y==="color"?4:2,offset:0}}),this.paintVertexArray=new N};la.prototype.populatePaintArray=function(f,d,y,T,O){var N=this.expression.evaluate(new Ka(this.zoom),d,{},T,[],O),Z=this.expression.evaluate(new Ka(this.zoom+1),d,{},T,[],O),q=this.paintVertexArray.length;this.paintVertexArray.resize(f),this._setPaintValue(q,f,N,Z)},la.prototype.updatePaintArray=function(f,d,y,T){var O=this.expression.evaluate({zoom:this.zoom},y,T),N=this.expression.evaluate({zoom:this.zoom+1},y,T);this._setPaintValue(f,d,O,N)},la.prototype._setPaintValue=function(f,d,y,T){if(this.type==="color")for(var O=Fi(y),N=Fi(T),Z=f;Z<d;Z++)this.paintVertexArray.emplace(Z,O[0],O[1],N[0],N[1]);else{for(var q=f;q<d;q++)this.paintVertexArray.emplace(q,y,T);this.maxValue=Math.max(this.maxValue,Math.abs(y),Math.abs(T))}},la.prototype.upload=function(f){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=f.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},la.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},la.prototype.setUniform=function(f,d){var y=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,T=Ut(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);f.set(T)},la.prototype.getBinding=function(f,d,y){return new Kn(f,d)};var Na=function(f,d,y,T,O,N){this.expression=f,this.type=d,this.useIntegerZoom=y,this.zoom=T,this.layerId=N,this.zoomInPaintVertexArray=new O,this.zoomOutPaintVertexArray=new O};Na.prototype.populatePaintArray=function(f,d,y){var T=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(f),this.zoomOutPaintVertexArray.resize(f),this._setPaintValues(T,f,d.patterns&&d.patterns[this.layerId],y)},Na.prototype.updatePaintArray=function(f,d,y,T,O){this._setPaintValues(f,d,y.patterns&&y.patterns[this.layerId],O)},Na.prototype._setPaintValues=function(f,d,y,T){if(T&&y){var O=T[y.min],N=T[y.mid],Z=T[y.max];if(O&&N&&Z)for(var q=f;q<d;q++)this.zoomInPaintVertexArray.emplace(q,N.tl[0],N.tl[1],N.br[0],N.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],N.pixelRatio,O.pixelRatio),this.zoomOutPaintVertexArray.emplace(q,N.tl[0],N.tl[1],N.br[0],N.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],N.pixelRatio,Z.pixelRatio)}},Na.prototype.upload=function(f){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=f.createVertexBuffer(this.zoomInPaintVertexArray,cr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=f.createVertexBuffer(this.zoomOutPaintVertexArray,cr.members,this.expression.isStateDependent))},Na.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var pa=function(f,d,y){this.binders={},this._buffers=[];var T=[];for(var O in f.paint._values)if(y(O)){var N=f.paint.get(O);if(N instanceof wu&&Ia(N.property.specification)){var Z=Ds(O,f.type),q=N.value,dt=N.property.specification.type,Pt=N.property.useIntegerZoom,Zt=N.property.specification["property-type"],qt=Zt==="cross-faded"||Zt==="cross-faded-data-driven";if(q.kind==="constant")this.binders[O]=qt?new Aa(q.value,Z):new Ra(q.value,Z,dt),T.push("/u_"+O);else if(q.kind==="source"||qt){var pe=ss(O,dt,"source");this.binders[O]=qt?new Na(q,dt,Pt,d,pe,f.id):new ka(q,Z,dt,pe),T.push("/a_"+O)}else{var Oe=ss(O,dt,"composite");this.binders[O]=new la(q,Z,dt,Pt,d,Oe),T.push("/z_"+O)}}}this.cacheKey=T.sort().join("")};pa.prototype.getMaxValue=function(f){var d=this.binders[f];return d instanceof ka||d instanceof la?d.maxValue:0},pa.prototype.populatePaintArrays=function(f,d,y,T,O){for(var N in this.binders){var Z=this.binders[N];(Z instanceof ka||Z instanceof la||Z instanceof Na)&&Z.populatePaintArray(f,d,y,T,O)}},pa.prototype.setConstantPatternPositions=function(f,d){for(var y in this.binders){var T=this.binders[y];T instanceof Aa&&T.setConstantPatternPositions(f,d)}},pa.prototype.updatePaintArrays=function(f,d,y,T,O){var N=!1;for(var Z in f)for(var q=0,dt=d.getPositions(Z);q<dt.length;q+=1){var Pt=dt[q],Zt=y.feature(Pt.index);for(var qt in this.binders){var pe=this.binders[qt];if((pe instanceof ka||pe instanceof la||pe instanceof Na)&&pe.expression.isStateDependent===!0){var Oe=T.paint.get(qt);pe.expression=Oe.value,pe.updatePaintArray(Pt.start,Pt.end,Zt,f[Z],O),N=!0}}}return N},pa.prototype.defines=function(){var f=[];for(var d in this.binders){var y=this.binders[d];(y instanceof Ra||y instanceof Aa)&&f.push.apply(f,y.uniformNames.map(function(T){return"#define HAS_UNIFORM_"+T}))}return f},pa.prototype.getBinderAttributes=function(){var f=[];for(var d in this.binders){var y=this.binders[d];if(y instanceof ka||y instanceof la)for(var T=0;T<y.paintVertexAttributes.length;T++)f.push(y.paintVertexAttributes[T].name);else if(y instanceof Na)for(var O=0;O<cr.members.length;O++)f.push(cr.members[O].name)}return f},pa.prototype.getBinderUniforms=function(){var f=[];for(var d in this.binders){var y=this.binders[d];if(y instanceof Ra||y instanceof Aa||y instanceof la)for(var T=0,O=y.uniformNames;T<O.length;T+=1)f.push(O[T])}return f},pa.prototype.getPaintVertexBuffers=function(){return this._buffers},pa.prototype.getUniforms=function(f,d){var y=[];for(var T in this.binders){var O=this.binders[T];if(O instanceof Ra||O instanceof Aa||O instanceof la)for(var N=0,Z=O.uniformNames;N<Z.length;N+=1){var q=Z[N];if(d[q]){var dt=O.getBinding(f,d[q],q);y.push({name:q,property:T,binding:dt})}}}return y},pa.prototype.setUniforms=function(f,d,y,T){for(var O=0,N=d;O<N.length;O+=1){var Z=N[O],q=Z.name,dt=Z.property;this.binders[dt].setUniform(Z.binding,T,y.get(dt),q)}},pa.prototype.updatePaintBuffers=function(f){for(var d in this._buffers=[],this.binders){var y=this.binders[d];if(f&&y instanceof Na){var T=f.fromScale===2?y.zoomInPaintVertexBuffer:y.zoomOutPaintVertexBuffer;T&&this._buffers.push(T)}else(y instanceof ka||y instanceof la)&&y.paintVertexBuffer&&this._buffers.push(y.paintVertexBuffer)}},pa.prototype.upload=function(f){for(var d in this.binders){var y=this.binders[d];(y instanceof ka||y instanceof la||y instanceof Na)&&y.upload(f)}this.updatePaintBuffers()},pa.prototype.destroy=function(){for(var f in this.binders){var d=this.binders[f];(d instanceof ka||d instanceof la||d instanceof Na)&&d.destroy()}};var da=function(f,d,y){y===void 0&&(y=function(){return!0}),this.programConfigurations={};for(var T=0,O=f;T<O.length;T+=1){var N=O[T];this.programConfigurations[N.id]=new pa(N,d,y)}this.needsUpload=!1,this._featureMap=new Pr,this._bufferOffset=0};function Ds(f,d){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(d+"-","").replace(/-/g,"_")]}function ss(f,d,y){var T={color:{source:Ms,composite:Yc},number:{source:bl,composite:Ms}},O=function(N){return{"line-pattern":{source:$u,composite:$u},"fill-pattern":{source:$u,composite:$u},"fill-extrusion-pattern":{source:$u,composite:$u}}[N]}(f);return O&&O[y]||T[d][y]}da.prototype.populatePaintArrays=function(f,d,y,T,O,N){for(var Z in this.programConfigurations)this.programConfigurations[Z].populatePaintArrays(f,d,T,O,N);d.id!==void 0&&this._featureMap.add(d.id,y,this._bufferOffset,f),this._bufferOffset=f,this.needsUpload=!0},da.prototype.updatePaintArrays=function(f,d,y,T){for(var O=0,N=y;O<N.length;O+=1){var Z=N[O];this.needsUpload=this.programConfigurations[Z.id].updatePaintArrays(f,this._featureMap,d,Z,T)||this.needsUpload}},da.prototype.get=function(f){return this.programConfigurations[f]},da.prototype.upload=function(f){if(this.needsUpload){for(var d in this.programConfigurations)this.programConfigurations[d].upload(f);this.needsUpload=!1}},da.prototype.destroy=function(){for(var f in this.programConfigurations)this.programConfigurations[f].destroy()},Zi("ConstantBinder",Ra),Zi("CrossFadedConstantBinder",Aa),Zi("SourceExpressionBinder",ka),Zi("CrossFadedCompositeBinder",Na),Zi("CompositeExpressionBinder",la),Zi("ProgramConfiguration",pa,{omit:["_buffers"]}),Zi("ProgramConfigurationSet",da);var ou=Math.pow(2,14)-1,Ks=-ou-1;function ls(f){for(var d=8192/f.extent,y=f.loadGeometry(),T=0;T<y.length;T++)for(var O=y[T],N=0;N<O.length;N++){var Z=O[N],q=Math.round(Z.x*d),dt=Math.round(Z.y*d);Z.x=Ut(q,Ks,ou),Z.y=Ut(dt,Ks,ou),(q<Z.x||q>Z.x+1||dt<Z.y||dt>Z.y+1)&&te("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return y}function cs(f,d){return{type:f.type,id:f.id,properties:f.properties,geometry:d?ls(f):[]}}function vu(f,d,y,T,O){f.emplaceBack(2*d+(T+1)/2,2*y+(O+1)/2)}var Du=function(f){this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=f.index,this.hasPattern=!1,this.layoutVertexArray=new Wc,this.indexArray=new Rs,this.segments=new De,this.programConfigurations=new da(f.layers,f.zoom),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function kc(f,d){for(var y=0;y<f.length;y++)if(dc(d,f[y]))return!0;for(var T=0;T<d.length;T++)if(dc(f,d[T]))return!0;return!!yh(f,d)}function qu(f,d,y){return!!dc(f,d)||!!Ql(d,f,y)}function Kl(f,d){if(f.length===1)return Yf(d,f[0]);for(var y=0;y<d.length;y++)for(var T=d[y],O=0;O<T.length;O++)if(dc(f,T[O]))return!0;for(var N=0;N<f.length;N++)if(Yf(d,f[N]))return!0;for(var Z=0;Z<d.length;Z++)if(yh(f,d[Z]))return!0;return!1}function cl(f,d,y){if(f.length>1){if(yh(f,d))return!0;for(var T=0;T<d.length;T++)if(Ql(d[T],f,y))return!0}for(var O=0;O<f.length;O++)if(Ql(f[O],d,y))return!0;return!1}function yh(f,d){if(f.length===0||d.length===0)return!1;for(var y=0;y<f.length-1;y++)for(var T=f[y],O=f[y+1],N=0;N<d.length-1;N++)if(El(T,O,d[N],d[N+1]))return!0;return!1}function El(f,d,y,T){return xe(f,y,T)!==xe(d,y,T)&&xe(f,d,y)!==xe(f,d,T)}function Ql(f,d,y){var T=y*y;if(d.length===1)return f.distSqr(d[0])<T;for(var O=1;O<d.length;O++)if(_h(f,d[O-1],d[O])<T)return!0;return!1}function _h(f,d,y){var T=d.distSqr(y);if(T===0)return f.distSqr(d);var O=((f.x-d.x)*(y.x-d.x)+(f.y-d.y)*(y.y-d.y))/T;return f.distSqr(O<0?d:O>1?y:y.sub(d)._mult(O)._add(d))}function Yf(f,d){for(var y,T,O,N=!1,Z=0;Z<f.length;Z++)for(var q=0,dt=(y=f[Z]).length-1;q<y.length;dt=q++)(T=y[q]).y>d.y!=(O=y[dt]).y>d.y&&d.x<(O.x-T.x)*(d.y-T.y)/(O.y-T.y)+T.x&&(N=!N);return N}function dc(f,d){for(var y=!1,T=0,O=f.length-1;T<f.length;O=T++){var N=f[T],Z=f[O];N.y>d.y!=Z.y>d.y&&d.x<(Z.x-N.x)*(d.y-N.y)/(Z.y-N.y)+N.x&&(y=!y)}return y}function xh(f,d,y){var T=y[0],O=y[2];if(f.x<T.x&&d.x<T.x||f.x>O.x&&d.x>O.x||f.y<T.y&&d.y<T.y||f.y>O.y&&d.y>O.y)return!1;var N=xe(f,d,y[0]);return N!==xe(f,d,y[1])||N!==xe(f,d,y[2])||N!==xe(f,d,y[3])}function Jl(f,d,y){var T=d.paint.get(f).value;return T.kind==="constant"?T.value:y.programConfigurations.get(d.id).getMaxValue(f)}function js(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function $c(f,d,y,T,O){if(!d[0]&&!d[1])return f;var N=ht.convert(d)._mult(O);y==="viewport"&&N._rotate(-T);for(var Z=[],q=0;q<f.length;q++)Z.push(f[q].sub(N));return Z}Du.prototype.populate=function(f,d,y){var T=this.layers[0],O=[],N=null;T.type==="circle"&&(N=T.layout.get("circle-sort-key"));for(var Z=0,q=f;Z<q.length;Z+=1){var dt=q[Z],Pt=dt.feature,Zt=dt.id,qt=dt.index,pe=dt.sourceLayerIndex,Oe=this.layers[0]._featureFilter.needGeometry,sr=cs(Pt,Oe);if(this.layers[0]._featureFilter.filter(new Ka(this.zoom),sr,y)){var lr=N?N.evaluate(sr,{},y):void 0,Cr={id:Zt,properties:Pt.properties,type:Pt.type,sourceLayerIndex:pe,index:qt,geometry:Oe?sr.geometry:ls(Pt),patterns:{},sortKey:lr};O.push(Cr)}}N&&O.sort(function(ki,oa){return ki.sortKey-oa.sortKey});for(var gr=0,Ur=O;gr<Ur.length;gr+=1){var Ar=Ur[gr],Dr=Ar.geometry,mn=Ar.index,Fn=Ar.sourceLayerIndex,ni=f[mn].feature;this.addFeature(Ar,Dr,mn,y),d.featureIndex.insert(ni,Dr,mn,Fn,this.index)}},Du.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},Du.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Du.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Du.prototype.upload=function(f){this.uploaded||(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,Re),this.indexBuffer=f.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(f),this.uploaded=!0},Du.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Du.prototype.addFeature=function(f,d,y,T){for(var O=0,N=d;O<N.length;O+=1)for(var Z=0,q=N[O];Z<q.length;Z+=1){var dt=q[Z],Pt=dt.x,Zt=dt.y;if(!(Pt<0||Pt>=8192||Zt<0||Zt>=8192)){var qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,f.sortKey),pe=qt.vertexLength;vu(this.layoutVertexArray,Pt,Zt,-1,-1),vu(this.layoutVertexArray,Pt,Zt,1,-1),vu(this.layoutVertexArray,Pt,Zt,1,1),vu(this.layoutVertexArray,Pt,Zt,-1,1),this.indexArray.emplaceBack(pe,pe+1,pe+2),this.indexArray.emplaceBack(pe,pe+3,pe+2),qt.vertexLength+=4,qt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,{},T)},Zi("CircleBucket",Du,{omit:["layers"]});var Tf=new Ru({"circle-sort-key":new Wi(Le.layout_circle["circle-sort-key"])}),vc={paint:new Ru({"circle-radius":new Wi(Le.paint_circle["circle-radius"]),"circle-color":new Wi(Le.paint_circle["circle-color"]),"circle-blur":new Wi(Le.paint_circle["circle-blur"]),"circle-opacity":new Wi(Le.paint_circle["circle-opacity"]),"circle-translate":new Ki(Le.paint_circle["circle-translate"]),"circle-translate-anchor":new Ki(Le.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ki(Le.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ki(Le.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Wi(Le.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Wi(Le.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Wi(Le.paint_circle["circle-stroke-opacity"])}),layout:Tf},Lo=typeof Float32Array!="undefined"?Float32Array:Array;function Sl(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function Ku(f,d,y){var T=d[0],O=d[1],N=d[2],Z=d[3],q=d[4],dt=d[5],Pt=d[6],Zt=d[7],qt=d[8],pe=d[9],Oe=d[10],sr=d[11],lr=d[12],Cr=d[13],gr=d[14],Ur=d[15],Ar=y[0],Dr=y[1],mn=y[2],Fn=y[3];return f[0]=Ar*T+Dr*q+mn*qt+Fn*lr,f[1]=Ar*O+Dr*dt+mn*pe+Fn*Cr,f[2]=Ar*N+Dr*Pt+mn*Oe+Fn*gr,f[3]=Ar*Z+Dr*Zt+mn*sr+Fn*Ur,f[4]=(Ar=y[4])*T+(Dr=y[5])*q+(mn=y[6])*qt+(Fn=y[7])*lr,f[5]=Ar*O+Dr*dt+mn*pe+Fn*Cr,f[6]=Ar*N+Dr*Pt+mn*Oe+Fn*gr,f[7]=Ar*Z+Dr*Zt+mn*sr+Fn*Ur,f[8]=(Ar=y[8])*T+(Dr=y[9])*q+(mn=y[10])*qt+(Fn=y[11])*lr,f[9]=Ar*O+Dr*dt+mn*pe+Fn*Cr,f[10]=Ar*N+Dr*Pt+mn*Oe+Fn*gr,f[11]=Ar*Z+Dr*Zt+mn*sr+Fn*Ur,f[12]=(Ar=y[12])*T+(Dr=y[13])*q+(mn=y[14])*qt+(Fn=y[15])*lr,f[13]=Ar*O+Dr*dt+mn*pe+Fn*Cr,f[14]=Ar*N+Dr*Pt+mn*Oe+Fn*gr,f[15]=Ar*Z+Dr*Zt+mn*sr+Fn*Ur,f}Math.hypot||(Math.hypot=function(){for(var f=arguments,d=0,y=arguments.length;y--;)d+=f[y]*f[y];return Math.sqrt(d)});var qc,Kc=Ku;function $f(f,d,y){var T=d[0],O=d[1],N=d[2],Z=d[3];return f[0]=y[0]*T+y[4]*O+y[8]*N+y[12]*Z,f[1]=y[1]*T+y[5]*O+y[9]*N+y[13]*Z,f[2]=y[2]*T+y[6]*O+y[10]*N+y[14]*Z,f[3]=y[3]*T+y[7]*O+y[11]*N+y[15]*Z,f}qc=new Lo(3),Lo!=Float32Array&&(qc[0]=0,qc[1]=0,qc[2]=0),function(){var f=new Lo(4);Lo!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0,f[3]=0)}();var Qc=(function(){var f=new Lo(2);Lo!=Float32Array&&(f[0]=0,f[1]=0)}(),function(f){function d(y){f.call(this,y,vc)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.createBucket=function(y){return new Du(y)},d.prototype.queryRadius=function(y){var T=y;return Jl("circle-radius",this,T)+Jl("circle-stroke-width",this,T)+js(this.paint.get("circle-translate"))},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,q,dt,Pt){for(var Zt=$c(y,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),q.angle,dt),qt=this.paint.get("circle-radius").evaluate(T,O)+this.paint.get("circle-stroke-width").evaluate(T,O),pe=this.paint.get("circle-pitch-alignment")==="map",Oe=pe?Zt:function(ni,ki){return ni.map(function(oa){return Bu(oa,ki)})}(Zt,Pt),sr=pe?qt*dt:qt,lr=0,Cr=N;lr<Cr.length;lr+=1)for(var gr=0,Ur=Cr[lr];gr<Ur.length;gr+=1){var Ar=Ur[gr],Dr=pe?Ar:Bu(Ar,Pt),mn=sr,Fn=$f([],[Ar.x,Ar.y,0,1],Pt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?mn*=Fn[3]/q.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(mn*=q.cameraToCenterDistance/Fn[3]),qu(Oe,Dr,mn))return!0}return!1},d}(bs));function Bu(f,d){var y=$f([],[f.x,f.y,0,1],d);return new ht(y[0]/y[3],y[1]/y[3])}var bh=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(Du);function tc(f,d,y,T){var O=d.width,N=d.height;if(T){if(T instanceof Uint8ClampedArray)T=new Uint8Array(T.buffer);else if(T.length!==O*N*y)throw new RangeError("mismatched image size")}else T=new Uint8Array(O*N*y);return f.width=O,f.height=N,f.data=T,f}function Jc(f,d,y){var T=d.width,O=d.height;if(T!==f.width||O!==f.height){var N=tc({},{width:T,height:O},y);Eh(f,N,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,T),height:Math.min(f.height,O)},y),f.width=T,f.height=O,f.data=N.data}}function Eh(f,d,y,T,O,N){if(O.width===0||O.height===0)return d;if(O.width>f.width||O.height>f.height||y.x>f.width-O.width||y.y>f.height-O.height)throw new RangeError("out of range source coordinates for image copy");if(O.width>d.width||O.height>d.height||T.x>d.width-O.width||T.y>d.height-O.height)throw new RangeError("out of range destination coordinates for image copy");for(var Z=f.data,q=d.data,dt=0;dt<O.height;dt++)for(var Pt=((y.y+dt)*f.width+y.x)*N,Zt=((T.y+dt)*d.width+T.x)*N,qt=0;qt<O.width*N;qt++)q[Zt+qt]=Z[Pt+qt];return d}Zi("HeatmapBucket",bh,{omit:["layers"]});var kl=function(f,d){tc(this,f,1,d)};kl.prototype.resize=function(f){Jc(this,f,1)},kl.prototype.clone=function(){return new kl({width:this.width,height:this.height},new Uint8Array(this.data))},kl.copy=function(f,d,y,T,O){Eh(f,d,y,T,O,1)};var Cu=function(f,d){tc(this,f,4,d)};Cu.prototype.resize=function(f){Jc(this,f,4)},Cu.prototype.replace=function(f,d){d?this.data.set(f):this.data=f instanceof Uint8ClampedArray?new Uint8Array(f.buffer):f},Cu.prototype.clone=function(){return new Cu({width:this.width,height:this.height},new Uint8Array(this.data))},Cu.copy=function(f,d,y,T,O){Eh(f,d,y,T,O,4)},Zi("AlphaImage",kl),Zi("RGBAImage",Cu);var sp={paint:new Ru({"heatmap-radius":new Wi(Le.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Wi(Le.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ki(Le.paint_heatmap["heatmap-intensity"]),"heatmap-color":new sl(Le.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ki(Le.paint_heatmap["heatmap-opacity"])})};function wd(f){var d={},y=f.resolution||256,T=f.clips?f.clips.length:1,O=f.image||new Cu({width:y,height:T}),N=function(sr,lr,Cr){d[f.evaluationKey]=Cr;var gr=f.expression.evaluate(d);O.data[sr+lr+0]=Math.floor(255*gr.r/gr.a),O.data[sr+lr+1]=Math.floor(255*gr.g/gr.a),O.data[sr+lr+2]=Math.floor(255*gr.b/gr.a),O.data[sr+lr+3]=Math.floor(255*gr.a)};if(f.clips)for(var Z=0,q=0;Z<T;++Z,q+=4*y)for(var dt=0,Pt=0;dt<y;dt++,Pt+=4){var Zt=dt/(y-1),qt=f.clips[Z];N(q,Pt,qt.start*(1-Zt)+qt.end*Zt)}else for(var pe=0,Oe=0;pe<y;pe++,Oe+=4)N(0,Oe,pe/(y-1));return O}var uv=function(f){function d(y){f.call(this,y,sp),this._updateColorRamp()}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.createBucket=function(y){return new bh(y)},d.prototype._handleSpecialPaintPropertyUpdate=function(y){y==="heatmap-color"&&this._updateColorRamp()},d.prototype._updateColorRamp=function(){this.colorRamp=wd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},d.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},d}(bs),lv={paint:new Ru({"hillshade-illumination-direction":new Ki(Le.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ki(Le.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ki(Le.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ki(Le.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ki(Le.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ki(Le.paint_hillshade["hillshade-accent-color"])})},G0=function(f){function d(y){f.call(this,y,lv)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},d}(bs),Up=os([{name:"a_pos",components:2,type:"Int16"}],4).members,Lc=Sh,tf=Sh;function Sh(f,d,y){y=y||2;var T,O,N,Z,q,dt,Pt,Zt=d&&d.length,qt=Zt?d[0]*y:f.length,pe=cv(f,0,qt,y,!0),Oe=[];if(!pe||pe.next===pe.prev)return Oe;if(Zt&&(pe=function(lr,Cr,gr,Ur){var Ar,Dr,mn,Fn=[];for(Ar=0,Dr=Cr.length;Ar<Dr;Ar++)(mn=cv(lr,Cr[Ar]*Ur,Ar<Dr-1?Cr[Ar+1]*Ur:lr.length,Ur,!1))===mn.next&&(mn.steiner=!0),Fn.push(Vp(mn));for(Fn.sort(Zp),Ar=0;Ar<Fn.length;Ar++)ef(Fn[Ar],gr),gr=wl(gr,gr.next);return gr}(f,d,pe,y)),f.length>80*y){T=N=f[0],O=Z=f[1];for(var sr=y;sr<qt;sr+=y)(q=f[sr])<T&&(T=q),(dt=f[sr+1])<O&&(O=dt),q>N&&(N=q),dt>Z&&(Z=dt);Pt=(Pt=Math.max(N-T,Z-O))!==0?1/Pt:0}return ei(pe,Oe,y,T,O,Pt),Oe}function cv(f,d,y,T,O){var N,Z;if(O===Id(f,d,y,T)>0)for(N=d;N<y;N+=T)Z=Md(N,f[N],f[N+1],Z);else for(N=y-T;N>=d;N-=T)Z=Md(N,f[N],f[N+1],Z);return Z&&qf(Z,Z.next)&&(Kf(Z),Z=Z.next),Z}function wl(f,d){if(!f)return f;d||(d=f);var y,T=f;do if(y=!1,T.steiner||!qf(T,T.next)&&Ns(T.prev,T,T.next)!==0)T=T.next;else{if(Kf(T),(T=d=T.prev)===T.next)break;y=!0}while(y||T!==d);return d}function ei(f,d,y,T,O,N,Z){if(f){!Z&&N&&function(Zt,qt,pe,Oe){var sr=Zt;do sr.z===null&&(sr.z=Pc(sr.x,sr.y,qt,pe,Oe)),sr.prevZ=sr.prev,sr.nextZ=sr.next,sr=sr.next;while(sr!==Zt);sr.prevZ.nextZ=null,sr.prevZ=null,function(lr){var Cr,gr,Ur,Ar,Dr,mn,Fn,ni,ki=1;do{for(gr=lr,lr=null,Dr=null,mn=0;gr;){for(mn++,Ur=gr,Fn=0,Cr=0;Cr<ki&&(Fn++,Ur=Ur.nextZ);Cr++);for(ni=ki;Fn>0||ni>0&&Ur;)Fn!==0&&(ni===0||!Ur||gr.z<=Ur.z)?(Ar=gr,gr=gr.nextZ,Fn--):(Ar=Ur,Ur=Ur.nextZ,ni--),Dr?Dr.nextZ=Ar:lr=Ar,Ar.prevZ=Dr,Dr=Ar;gr=Ur}Dr.nextZ=null,ki*=2}while(mn>1)}(sr)}(f,T,O,N);for(var q,dt,Pt=f;f.prev!==f.next;)if(q=f.prev,dt=f.next,N?Gm(f,T,O,N):Cd(f))d.push(q.i/y),d.push(f.i/y),d.push(dt.i/y),Kf(f),f=dt.next,Pt=dt.next;else if((f=dt)===Pt){Z?Z===1?ei(f=Bs(wl(f),d,y),d,y,T,O,N,2):Z===2&&Mf(f,d,y,T,O,N):ei(wl(f),d,y,T,O,N,1);break}}}function Cd(f){var d=f.prev,y=f,T=f.next;if(Ns(d,y,T)>=0)return!1;for(var O=f.next.next;O!==f.prev;){if(wh(d.x,d.y,y.x,y.y,T.x,T.y,O.x,O.y)&&Ns(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function Gm(f,d,y,T){var O=f.prev,N=f,Z=f.next;if(Ns(O,N,Z)>=0)return!1;for(var q=O.x>N.x?O.x>Z.x?O.x:Z.x:N.x>Z.x?N.x:Z.x,dt=O.y>N.y?O.y>Z.y?O.y:Z.y:N.y>Z.y?N.y:Z.y,Pt=Pc(O.x<N.x?O.x<Z.x?O.x:Z.x:N.x<Z.x?N.x:Z.x,O.y<N.y?O.y<Z.y?O.y:Z.y:N.y<Z.y?N.y:Z.y,d,y,T),Zt=Pc(q,dt,d,y,T),qt=f.prevZ,pe=f.nextZ;qt&&qt.z>=Pt&&pe&&pe.z<=Zt;){if(qt!==f.prev&&qt!==f.next&&wh(O.x,O.y,N.x,N.y,Z.x,Z.y,qt.x,qt.y)&&Ns(qt.prev,qt,qt.next)>=0||(qt=qt.prevZ,pe!==f.prev&&pe!==f.next&&wh(O.x,O.y,N.x,N.y,Z.x,Z.y,pe.x,pe.y)&&Ns(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;qt&&qt.z>=Pt;){if(qt!==f.prev&&qt!==f.next&&wh(O.x,O.y,N.x,N.y,Z.x,Z.y,qt.x,qt.y)&&Ns(qt.prev,qt,qt.next)>=0)return!1;qt=qt.prevZ}for(;pe&&pe.z<=Zt;){if(pe!==f.prev&&pe!==f.next&&wh(O.x,O.y,N.x,N.y,Z.x,Z.y,pe.x,pe.y)&&Ns(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function Bs(f,d,y){var T=f;do{var O=T.prev,N=T.next.next;!qf(O,N)&&Ad(O,T,T.next,N)&&Td(O,N)&&Td(N,O)&&(d.push(O.i/y),d.push(T.i/y),d.push(N.i/y),Kf(T),Kf(T.next),T=f=N),T=T.next}while(T!==f);return wl(T)}function Mf(f,d,y,T,O,N){var Z=f;do{for(var q=Z.next.next;q!==Z.prev;){if(Z.i!==q.i&&fv(Z,q)){var dt=pv(Z,q);return Z=wl(Z,Z.next),dt=wl(dt,dt.next),ei(Z,d,y,T,O,N),void ei(dt,d,y,T,O,N)}q=q.next}Z=Z.next}while(Z!==f)}function Zp(f,d){return f.x-d.x}function ef(f,d){if(d=function(T,O){var N,Z=O,q=T.x,dt=T.y,Pt=-1/0;do{if(dt<=Z.y&&dt>=Z.next.y&&Z.next.y!==Z.y){var Zt=Z.x+(dt-Z.y)*(Z.next.x-Z.x)/(Z.next.y-Z.y);if(Zt<=q&&Zt>Pt){if(Pt=Zt,Zt===q){if(dt===Z.y)return Z;if(dt===Z.next.y)return Z.next}N=Z.x<Z.next.x?Z:Z.next}}Z=Z.next}while(Z!==O);if(!N)return null;if(q===Pt)return N;var qt,pe=N,Oe=N.x,sr=N.y,lr=1/0;Z=N;do q>=Z.x&&Z.x>=Oe&&q!==Z.x&&wh(dt<sr?q:Pt,dt,Oe,sr,dt<sr?Pt:q,dt,Z.x,Z.y)&&(qt=Math.abs(dt-Z.y)/(q-Z.x),Td(Z,T)&&(qt<lr||qt===lr&&(Z.x>N.x||Z.x===N.x&&Cl(N,Z)))&&(N=Z,lr=qt)),Z=Z.next;while(Z!==pe);return N}(f,d)){var y=pv(d,f);wl(d,d.next),wl(y,y.next)}}function Cl(f,d){return Ns(f.prev,f,d.prev)<0&&Ns(d.next,f,f.next)<0}function Pc(f,d,y,T,O){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=32767*(f-y)*O)|f<<8))|f<<4))|f<<2))|f<<1))|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=32767*(d-T)*O)|d<<8))|d<<4))|d<<2))|d<<1))<<1}function Vp(f){var d=f,y=f;do(d.x<y.x||d.x===y.x&&d.y<y.y)&&(y=d),d=d.next;while(d!==f);return y}function wh(f,d,y,T,O,N,Z,q){return(O-Z)*(d-q)-(f-Z)*(N-q)>=0&&(f-Z)*(T-q)-(y-Z)*(d-q)>=0&&(y-Z)*(N-q)-(O-Z)*(T-q)>=0}function fv(f,d){return f.next.i!==d.i&&f.prev.i!==d.i&&!function(y,T){var O=y;do{if(O.i!==y.i&&O.next.i!==y.i&&O.i!==T.i&&O.next.i!==T.i&&Ad(O,O.next,y,T))return!0;O=O.next}while(O!==y);return!1}(f,d)&&(Td(f,d)&&Td(d,f)&&function(y,T){var O=y,N=!1,Z=(y.x+T.x)/2,q=(y.y+T.y)/2;do O.y>q!=O.next.y>q&&O.next.y!==O.y&&Z<(O.next.x-O.x)*(q-O.y)/(O.next.y-O.y)+O.x&&(N=!N),O=O.next;while(O!==y);return N}(f,d)&&(Ns(f.prev,f,d.prev)||Ns(f,d.prev,d))||qf(f,d)&&Ns(f.prev,f,f.next)>0&&Ns(d.prev,d,d.next)>0)}function Ns(f,d,y){return(d.y-f.y)*(y.x-d.x)-(d.x-f.x)*(y.y-d.y)}function qf(f,d){return f.x===d.x&&f.y===d.y}function Ad(f,d,y,T){var O=hv(Ns(f,d,y)),N=hv(Ns(f,d,T)),Z=hv(Ns(y,T,f)),q=hv(Ns(y,T,d));return O!==N&&Z!==q||!(O!==0||!gc(f,y,d))||!(N!==0||!gc(f,T,d))||!(Z!==0||!gc(y,f,T))||!(q!==0||!gc(y,d,T))}function gc(f,d,y){return d.x<=Math.max(f.x,y.x)&&d.x>=Math.min(f.x,y.x)&&d.y<=Math.max(f.y,y.y)&&d.y>=Math.min(f.y,y.y)}function hv(f){return f>0?1:f<0?-1:0}function Td(f,d){return Ns(f.prev,f,f.next)<0?Ns(f,d,f.next)>=0&&Ns(f,f.prev,d)>=0:Ns(f,d,f.prev)<0||Ns(f,f.next,d)<0}function pv(f,d){var y=new up(f.i,f.x,f.y),T=new up(d.i,d.x,d.y),O=f.next,N=d.prev;return f.next=d,d.prev=f,y.next=O,O.prev=y,T.next=y,y.prev=T,N.next=T,T.prev=N,T}function Md(f,d,y,T){var O=new up(f,d,y);return T?(O.next=T.next,O.prev=T,T.next.prev=O,T.next=O):(O.prev=O,O.next=O),O}function Kf(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function up(f,d,y){this.i=f,this.x=d,this.y=y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Id(f,d,y,T){for(var O=0,N=d,Z=y-T;N<y;N+=T)O+=(f[Z]-f[N])*(f[N+1]+f[Z+1]),Z=N;return O}function Gp(f,d,y,T,O){(function N(Z,q,dt,Pt,Zt){for(;Pt>dt;){if(Pt-dt>600){var qt=Pt-dt+1,pe=q-dt+1,Oe=Math.log(qt),sr=.5*Math.exp(2*Oe/3),lr=.5*Math.sqrt(Oe*sr*(qt-sr)/qt)*(pe-qt/2<0?-1:1);N(Z,q,Math.max(dt,Math.floor(q-pe*sr/qt+lr)),Math.min(Pt,Math.floor(q+(qt-pe)*sr/qt+lr)),Zt)}var Cr=Z[q],gr=dt,Ur=Pt;for(Qf(Z,dt,q),Zt(Z[Pt],Cr)>0&&Qf(Z,dt,Pt);gr<Ur;){for(Qf(Z,gr,Ur),gr++,Ur--;Zt(Z[gr],Cr)<0;)gr++;for(;Zt(Z[Ur],Cr)>0;)Ur--}Zt(Z[dt],Cr)===0?Qf(Z,dt,Ur):Qf(Z,++Ur,Pt),Ur<=q&&(dt=Ur+1),q<=Ur&&(Pt=Ur-1)}})(f,d,y||0,T||f.length-1,O||dv)}function Qf(f,d,y){var T=f[d];f[d]=f[y],f[y]=T}function dv(f,d){return f<d?-1:f>d?1:0}function rf(f,d){var y=f.length;if(y<=1)return[f];for(var T,O,N=[],Z=0;Z<y;Z++){var q=Ye(f[Z]);q!==0&&(f[Z].area=Math.abs(q),O===void 0&&(O=q<0),O===q<0?(T&&N.push(T),T=[f[Z]]):T.push(f[Z]))}if(T&&N.push(T),d>1)for(var dt=0;dt<N.length;dt++)N[dt].length<=d||(Gp(N[dt],d,1,N[dt].length-1,vv),N[dt]=N[dt].slice(0,d));return N}function vv(f,d){return d.area-f.area}function nf(f,d,y){for(var T=y.patternDependencies,O=!1,N=0,Z=d;N<Z.length;N+=1){var q=Z[N].paint.get(f+"-pattern");q.isConstant()||(O=!0);var dt=q.constantOr(null);dt&&(O=!0,T[dt.to]=!0,T[dt.from]=!0)}return O}function Hp(f,d,y,T,O){for(var N=O.patternDependencies,Z=0,q=d;Z<q.length;Z+=1){var dt=q[Z],Pt=dt.paint.get(f+"-pattern").value;if(Pt.kind!=="constant"){var Zt=Pt.evaluate({zoom:T-1},y,{},O.availableImages),qt=Pt.evaluate({zoom:T},y,{},O.availableImages),pe=Pt.evaluate({zoom:T+1},y,{},O.availableImages);qt=qt&&qt.name?qt.name:qt,pe=pe&&pe.name?pe.name:pe,N[Zt=Zt&&Zt.name?Zt.name:Zt]=!0,N[qt]=!0,N[pe]=!0,y.patterns[dt.id]={min:Zt,mid:qt,max:pe}}}return y}Sh.deviation=function(f,d,y,T){var O=d&&d.length,N=Math.abs(Id(f,0,O?d[0]*y:f.length,y));if(O)for(var Z=0,q=d.length;Z<q;Z++)N-=Math.abs(Id(f,d[Z]*y,Z<q-1?d[Z+1]*y:f.length,y));var dt=0;for(Z=0;Z<T.length;Z+=3){var Pt=T[Z]*y,Zt=T[Z+1]*y,qt=T[Z+2]*y;dt+=Math.abs((f[Pt]-f[qt])*(f[Zt+1]-f[Pt+1])-(f[Pt]-f[Zt])*(f[qt+1]-f[Pt+1]))}return N===0&&dt===0?0:Math.abs((dt-N)/N)},Sh.flatten=function(f){for(var d=f[0][0].length,y={vertices:[],holes:[],dimensions:d},T=0,O=0;O<f.length;O++){for(var N=0;N<f[O].length;N++)for(var Z=0;Z<d;Z++)y.vertices.push(f[O][N][Z]);O>0&&y.holes.push(T+=f[O-1].length)}return y},Lc.default=tf;var Ul=function(f){this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=f.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Wc,this.indexArray=new Rs,this.indexArray2=new pc,this.programConfigurations=new da(f.layers,f.zoom),this.segments=new De,this.segments2=new De,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};Ul.prototype.populate=function(f,d,y){this.hasPattern=nf("fill",this.layers,d);for(var T=this.layers[0].layout.get("fill-sort-key"),O=[],N=0,Z=f;N<Z.length;N+=1){var q=Z[N],dt=q.feature,Pt=q.id,Zt=q.index,qt=q.sourceLayerIndex,pe=this.layers[0]._featureFilter.needGeometry,Oe=cs(dt,pe);if(this.layers[0]._featureFilter.filter(new Ka(this.zoom),Oe,y)){var sr=T?T.evaluate(Oe,{},y,d.availableImages):void 0,lr={id:Pt,properties:dt.properties,type:dt.type,sourceLayerIndex:qt,index:Zt,geometry:pe?Oe.geometry:ls(dt),patterns:{},sortKey:sr};O.push(lr)}}T&&O.sort(function(ni,ki){return ni.sortKey-ki.sortKey});for(var Cr=0,gr=O;Cr<gr.length;Cr+=1){var Ur=gr[Cr],Ar=Ur.geometry,Dr=Ur.index,mn=Ur.sourceLayerIndex;if(this.hasPattern){var Fn=Hp("fill",this.layers,Ur,this.zoom,d);this.patternFeatures.push(Fn)}else this.addFeature(Ur,Ar,Dr,y,{});d.featureIndex.insert(f[Dr].feature,Ar,Dr,mn,this.index)}},Ul.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},Ul.prototype.addFeatures=function(f,d,y){for(var T=0,O=this.patternFeatures;T<O.length;T+=1){var N=O[T];this.addFeature(N,N.geometry,N.index,d,y)}},Ul.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ul.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ul.prototype.upload=function(f){this.uploaded||(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,Up),this.indexBuffer=f.createIndexBuffer(this.indexArray),this.indexBuffer2=f.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(f),this.uploaded=!0},Ul.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ul.prototype.addFeature=function(f,d,y,T,O){for(var N=0,Z=rf(d,500);N<Z.length;N+=1){for(var q=Z[N],dt=0,Pt=0,Zt=q;Pt<Zt.length;Pt+=1)dt+=Zt[Pt].length;for(var qt=this.segments.prepareSegment(dt,this.layoutVertexArray,this.indexArray),pe=qt.vertexLength,Oe=[],sr=[],lr=0,Cr=q;lr<Cr.length;lr+=1){var gr=Cr[lr];if(gr.length!==0){gr!==q[0]&&sr.push(Oe.length/2);var Ur=this.segments2.prepareSegment(gr.length,this.layoutVertexArray,this.indexArray2),Ar=Ur.vertexLength;this.layoutVertexArray.emplaceBack(gr[0].x,gr[0].y),this.indexArray2.emplaceBack(Ar+gr.length-1,Ar),Oe.push(gr[0].x),Oe.push(gr[0].y);for(var Dr=1;Dr<gr.length;Dr++)this.layoutVertexArray.emplaceBack(gr[Dr].x,gr[Dr].y),this.indexArray2.emplaceBack(Ar+Dr-1,Ar+Dr),Oe.push(gr[Dr].x),Oe.push(gr[Dr].y);Ur.vertexLength+=gr.length,Ur.primitiveLength+=gr.length}}for(var mn=Lc(Oe,sr),Fn=0;Fn<mn.length;Fn+=3)this.indexArray.emplaceBack(pe+mn[Fn],pe+mn[Fn+1],pe+mn[Fn+2]);qt.vertexLength+=dt,qt.primitiveLength+=mn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,O,T)},Zi("FillBucket",Ul,{omit:["layers","patternFeatures"]});var kd=new Ru({"fill-sort-key":new Wi(Le.layout_fill["fill-sort-key"])}),Ld={paint:new Ru({"fill-antialias":new Ki(Le.paint_fill["fill-antialias"]),"fill-opacity":new Wi(Le.paint_fill["fill-opacity"]),"fill-color":new Wi(Le.paint_fill["fill-color"]),"fill-outline-color":new Wi(Le.paint_fill["fill-outline-color"]),"fill-translate":new Ki(Le.paint_fill["fill-translate"]),"fill-translate-anchor":new Ki(Le.paint_fill["fill-translate-anchor"]),"fill-pattern":new Af(Le.paint_fill["fill-pattern"])}),layout:kd},Pd=function(f){function d(y){f.call(this,y,Ld)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.recalculate=function(y,T){f.prototype.recalculate.call(this,y,T);var O=this.paint._values["fill-outline-color"];O.value.kind==="constant"&&O.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},d.prototype.createBucket=function(y){return new Ul(y)},d.prototype.queryRadius=function(){return js(this.paint.get("fill-translate"))},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,q,dt){return Kl($c(y,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),q.angle,dt),N)},d.prototype.isTileClipped=function(){return!0},d}(bs),jp=os([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,af=ec;function ec(f,d,y,T,O){this.properties={},this.extent=y,this.type=0,this._pbf=f,this._geometry=-1,this._keys=T,this._values=O,f.readFields(Wp,this,d)}function Wp(f,d,y){f==1?d.id=y.readVarint():f==2?function(T,O){for(var N=T.readVarint()+T.pos;T.pos<N;){var Z=O._keys[T.readVarint()],q=O._values[T.readVarint()];O.properties[Z]=q}}(y,d):f==3?d.type=y.readVarint():f==4&&(d._geometry=y.pos)}function H0(f){for(var d,y,T=0,O=0,N=f.length,Z=N-1;O<N;Z=O++)T+=((y=f[Z]).x-(d=f[O]).x)*(d.y+y.y);return T}ec.types=["Unknown","Point","LineString","Polygon"],ec.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var d,y=f.readVarint()+f.pos,T=1,O=0,N=0,Z=0,q=[];f.pos<y;){if(O<=0){var dt=f.readVarint();T=7&dt,O=dt>>3}if(O--,T===1||T===2)N+=f.readSVarint(),Z+=f.readSVarint(),T===1&&(d&&q.push(d),d=[]),d.push(new ht(N,Z));else{if(T!==7)throw new Error("unknown command "+T);d&&d.push(d[0].clone())}}return d&&q.push(d),q},ec.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var d=f.readVarint()+f.pos,y=1,T=0,O=0,N=0,Z=1/0,q=-1/0,dt=1/0,Pt=-1/0;f.pos<d;){if(T<=0){var Zt=f.readVarint();y=7&Zt,T=Zt>>3}if(T--,y===1||y===2)(O+=f.readSVarint())<Z&&(Z=O),O>q&&(q=O),(N+=f.readSVarint())<dt&&(dt=N),N>Pt&&(Pt=N);else if(y!==7)throw new Error("unknown command "+y)}return[Z,dt,q,Pt]},ec.prototype.toGeoJSON=function(f,d,y){var T,O,N=this.extent*Math.pow(2,y),Z=this.extent*f,q=this.extent*d,dt=this.loadGeometry(),Pt=ec.types[this.type];function Zt(Oe){for(var sr=0;sr<Oe.length;sr++){var lr=Oe[sr];Oe[sr]=[360*(lr.x+Z)/N-180,360/Math.PI*Math.atan(Math.exp((180-360*(lr.y+q)/N)*Math.PI/180))-90]}}switch(this.type){case 1:var qt=[];for(T=0;T<dt.length;T++)qt[T]=dt[T][0];Zt(dt=qt);break;case 2:for(T=0;T<dt.length;T++)Zt(dt[T]);break;case 3:for(dt=function(Oe){var sr=Oe.length;if(sr<=1)return[Oe];for(var lr,Cr,gr=[],Ur=0;Ur<sr;Ur++){var Ar=H0(Oe[Ur]);Ar!==0&&(Cr===void 0&&(Cr=Ar<0),Cr===Ar<0?(lr&&gr.push(lr),lr=[Oe[Ur]]):lr.push(Oe[Ur]))}return lr&&gr.push(lr),gr}(dt),T=0;T<dt.length;T++)for(O=0;O<dt[T].length;O++)Zt(dt[T][O])}dt.length===1?dt=dt[0]:Pt="Multi"+Pt;var pe={type:"Feature",geometry:{type:Pt,coordinates:dt},properties:this.properties};return"id"in this&&(pe.id=this.id),pe};var Qv=If;function If(f,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(mc,this,d),this.length=this._features.length}function mc(f,d,y){f===15?d.version=y.readVarint():f===1?d.name=y.readString():f===5?d.extent=y.readVarint():f===2?d._features.push(y.pos):f===3?d._keys.push(y.readString()):f===4&&d._values.push(function(T){for(var O=null,N=T.readVarint()+T.pos;T.pos<N;){var Z=T.readVarint()>>3;O=Z===1?T.readString():Z===2?T.readFloat():Z===3?T.readDouble():Z===4?T.readVarint64():Z===5?T.readVarint():Z===6?T.readSVarint():Z===7?T.readBoolean():null}return O}(y))}function j0(f,d,y){if(f===3){var T=new Qv(y,y.readVarint()+y.pos);T.length&&(d[T.name]=T)}}If.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var d=this._pbf.readVarint()+this._pbf.pos;return new af(this._pbf,d,this.extent,this._keys,this._values)};var rc={VectorTile:function(f,d){this.layers=f.readFields(j0,{},d)},VectorTileFeature:af,VectorTileLayer:Qv},Od=rc.VectorTileFeature.types,Jv=Math.pow(2,13);function of(f,d,y,T,O,N,Z,q){f.emplaceBack(d,y,2*Math.floor(T*Jv)+Z,O*Jv*2,N*Jv*2,Math.round(q))}var sf=function(f){this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=f.index,this.hasPattern=!1,this.layoutVertexArray=new ul,this.indexArray=new Rs,this.programConfigurations=new da(f.layers,f.zoom),this.segments=new De,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function Fd(f,d){return f.x===d.x&&(f.x<0||f.x>8192)||f.y===d.y&&(f.y<0||f.y>8192)}sf.prototype.populate=function(f,d,y){this.features=[],this.hasPattern=nf("fill-extrusion",this.layers,d);for(var T=0,O=f;T<O.length;T+=1){var N=O[T],Z=N.feature,q=N.id,dt=N.index,Pt=N.sourceLayerIndex,Zt=this.layers[0]._featureFilter.needGeometry,qt=cs(Z,Zt);if(this.layers[0]._featureFilter.filter(new Ka(this.zoom),qt,y)){var pe={id:q,sourceLayerIndex:Pt,index:dt,geometry:Zt?qt.geometry:ls(Z),properties:Z.properties,type:Z.type,patterns:{}};this.hasPattern?this.features.push(Hp("fill-extrusion",this.layers,pe,this.zoom,d)):this.addFeature(pe,pe.geometry,dt,y,{}),d.featureIndex.insert(Z,pe.geometry,dt,Pt,this.index,!0)}}},sf.prototype.addFeatures=function(f,d,y){for(var T=0,O=this.features;T<O.length;T+=1){var N=O[T];this.addFeature(N,N.geometry,N.index,d,y)}},sf.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},sf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},sf.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},sf.prototype.upload=function(f){this.uploaded||(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,jp),this.indexBuffer=f.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(f),this.uploaded=!0},sf.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},sf.prototype.addFeature=function(f,d,y,T,O){for(var N=0,Z=rf(d,500);N<Z.length;N+=1){for(var q=Z[N],dt=0,Pt=0,Zt=q;Pt<Zt.length;Pt+=1)dt+=Zt[Pt].length;for(var qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),pe=0,Oe=q;pe<Oe.length;pe+=1){var sr=Oe[pe];if(sr.length!==0&&!((lo=sr).every(function(Ja){return Ja.x<0})||lo.every(function(Ja){return Ja.x>8192})||lo.every(function(Ja){return Ja.y<0})||lo.every(function(Ja){return Ja.y>8192})))for(var lr=0,Cr=0;Cr<sr.length;Cr++){var gr=sr[Cr];if(Cr>=1){var Ur=sr[Cr-1];if(!Fd(gr,Ur)){qt.vertexLength+4>De.MAX_VERTEX_ARRAY_LENGTH&&(qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Ar=gr.sub(Ur)._perp()._unit(),Dr=Ur.dist(gr);lr+Dr>32768&&(lr=0),of(this.layoutVertexArray,gr.x,gr.y,Ar.x,Ar.y,0,0,lr),of(this.layoutVertexArray,gr.x,gr.y,Ar.x,Ar.y,0,1,lr),of(this.layoutVertexArray,Ur.x,Ur.y,Ar.x,Ar.y,0,0,lr+=Dr),of(this.layoutVertexArray,Ur.x,Ur.y,Ar.x,Ar.y,0,1,lr);var mn=qt.vertexLength;this.indexArray.emplaceBack(mn,mn+2,mn+1),this.indexArray.emplaceBack(mn+1,mn+2,mn+3),qt.vertexLength+=4,qt.primitiveLength+=2}}}}if(qt.vertexLength+dt>De.MAX_VERTEX_ARRAY_LENGTH&&(qt=this.segments.prepareSegment(dt,this.layoutVertexArray,this.indexArray)),Od[f.type]==="Polygon"){for(var Fn=[],ni=[],ki=qt.vertexLength,oa=0,Di=q;oa<Di.length;oa+=1){var ca=Di[oa];if(ca.length!==0){ca!==q[0]&&ni.push(Fn.length/2);for(var zi=0;zi<ca.length;zi++){var Oa=ca[zi];of(this.layoutVertexArray,Oa.x,Oa.y,0,0,1,1,0),Fn.push(Oa.x),Fn.push(Oa.y)}}}for(var xa=Lc(Fn,ni),Qi=0;Qi<xa.length;Qi+=3)this.indexArray.emplaceBack(ki+xa[Qi],ki+xa[Qi+2],ki+xa[Qi+1]);qt.primitiveLength+=xa.length/3,qt.vertexLength+=dt}}var lo;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,O,T)},Zi("FillExtrusionBucket",sf,{omit:["layers","features"]});var t0={paint:new Ru({"fill-extrusion-opacity":new Ki(Le["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Wi(Le["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ki(Le["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ki(Le["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Af(Le["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Wi(Le["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Wi(Le["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ki(Le["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},nc=function(f){function d(y){f.call(this,y,t0)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.createBucket=function(y){return new sf(y)},d.prototype.queryRadius=function(){return js(this.paint.get("fill-extrusion-translate"))},d.prototype.is3D=function(){return!0},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,q,dt,Pt){var Zt=$c(y,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),q.angle,dt),qt=this.paint.get("fill-extrusion-height").evaluate(T,O),pe=this.paint.get("fill-extrusion-base").evaluate(T,O),Oe=function(lr,Cr,gr,Ur){for(var Ar=[],Dr=0,mn=lr;Dr<mn.length;Dr+=1){var Fn=mn[Dr],ni=[Fn.x,Fn.y,0,1];$f(ni,ni,Cr),Ar.push(new ht(ni[0]/ni[3],ni[1]/ni[3]))}return Ar}(Zt,Pt),sr=function(lr,Cr,gr,Ur){for(var Ar=[],Dr=[],mn=Ur[8]*Cr,Fn=Ur[9]*Cr,ni=Ur[10]*Cr,ki=Ur[11]*Cr,oa=Ur[8]*gr,Di=Ur[9]*gr,ca=Ur[10]*gr,zi=Ur[11]*gr,Oa=0,xa=lr;Oa<xa.length;Oa+=1){for(var Qi=[],lo=[],Ja=0,To=xa[Oa];Ja<To.length;Ja+=1){var ea=To[Ja],Zo=ea.x,Es=ea.y,uu=Ur[0]*Zo+Ur[4]*Es+Ur[12],Ws=Ur[1]*Zo+Ur[5]*Es+Ur[13],ks=Ur[2]*Zo+Ur[6]*Es+Ur[14],eu=Ur[3]*Zo+Ur[7]*Es+Ur[15],Qu=ks+ni,lu=eu+ki,Gl=uu+oa,us=Ws+Di,Hl=ks+ca,mu=eu+zi,cu=new ht((uu+mn)/lu,(Ws+Fn)/lu);cu.z=Qu/lu,Qi.push(cu);var ro=new ht(Gl/mu,us/mu);ro.z=Hl/mu,lo.push(ro)}Ar.push(Qi),Dr.push(lo)}return[Ar,Dr]}(N,pe,qt,Pt);return function(lr,Cr,gr){var Ur=1/0;Kl(gr,Cr)&&(Ur=Ch(gr,Cr[0]));for(var Ar=0;Ar<Cr.length;Ar++)for(var Dr=Cr[Ar],mn=lr[Ar],Fn=0;Fn<Dr.length-1;Fn++){var ni=Dr[Fn],ki=[ni,Dr[Fn+1],mn[Fn+1],mn[Fn],ni];kc(gr,ki)&&(Ur=Math.min(Ur,Ch(gr,ki)))}return Ur!==1/0&&Ur}(sr[0],sr[1],Oe)},d}(bs);function Rd(f,d){return f.x*d.x+f.y*d.y}function Ch(f,d){if(f.length===1){for(var y,T=0,O=d[T++];!y||O.equals(y);)if(!(y=d[T++]))return 1/0;for(;T<d.length;T++){var N=d[T],Z=f[0],q=y.sub(O),dt=N.sub(O),Pt=Z.sub(O),Zt=Rd(q,q),qt=Rd(q,dt),pe=Rd(dt,dt),Oe=Rd(Pt,q),sr=Rd(Pt,dt),lr=Zt*pe-qt*qt,Cr=(pe*Oe-qt*sr)/lr,gr=(Zt*sr-qt*Oe)/lr,Ur=O.z*(1-Cr-gr)+y.z*Cr+N.z*gr;if(isFinite(Ur))return Ur}return 1/0}for(var Ar=1/0,Dr=0,mn=d;Dr<mn.length;Dr+=1)Ar=Math.min(Ar,mn[Dr].z);return Ar}var Ah=os([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,e0=os([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,r0=rc.VectorTileFeature.types,lp=Math.cos(Math.PI/180*37.5),Dd=Math.pow(2,14)/.5,Ro=function(f){var d=this;this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(y){return y.id}),this.index=f.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(y){d.gradients[y.id]={}}),this.layoutVertexArray=new Fs,this.layoutVertexArray2=new Ms,this.indexArray=new Rs,this.programConfigurations=new da(f.layers,f.zoom),this.segments=new De,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(y){return y.isStateDependent()}).map(function(y){return y.id})};Ro.prototype.populate=function(f,d,y){this.hasPattern=nf("line",this.layers,d);for(var T=this.layers[0].layout.get("line-sort-key"),O=[],N=0,Z=f;N<Z.length;N+=1){var q=Z[N],dt=q.feature,Pt=q.id,Zt=q.index,qt=q.sourceLayerIndex,pe=this.layers[0]._featureFilter.needGeometry,Oe=cs(dt,pe);if(this.layers[0]._featureFilter.filter(new Ka(this.zoom),Oe,y)){var sr=T?T.evaluate(Oe,{},y):void 0,lr={id:Pt,properties:dt.properties,type:dt.type,sourceLayerIndex:qt,index:Zt,geometry:pe?Oe.geometry:ls(dt),patterns:{},sortKey:sr};O.push(lr)}}T&&O.sort(function(ni,ki){return ni.sortKey-ki.sortKey});for(var Cr=0,gr=O;Cr<gr.length;Cr+=1){var Ur=gr[Cr],Ar=Ur.geometry,Dr=Ur.index,mn=Ur.sourceLayerIndex;if(this.hasPattern){var Fn=Hp("line",this.layers,Ur,this.zoom,d);this.patternFeatures.push(Fn)}else this.addFeature(Ur,Ar,Dr,y,{});d.featureIndex.insert(f[Dr].feature,Ar,Dr,mn,this.index)}},Ro.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},Ro.prototype.addFeatures=function(f,d,y){for(var T=0,O=this.patternFeatures;T<O.length;T+=1){var N=O[T];this.addFeature(N,N.geometry,N.index,d,y)}},Ro.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ro.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ro.prototype.upload=function(f){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=f.createVertexBuffer(this.layoutVertexArray2,e0)),this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,Ah),this.indexBuffer=f.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(f),this.uploaded=!0},Ro.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ro.prototype.lineFeatureClips=function(f){if(f.properties&&f.properties.hasOwnProperty("mapbox_clip_start")&&f.properties.hasOwnProperty("mapbox_clip_end"))return{start:+f.properties.mapbox_clip_start,end:+f.properties.mapbox_clip_end}},Ro.prototype.addFeature=function(f,d,y,T,O){var N=this.layers[0].layout,Z=N.get("line-join").evaluate(f,{}),q=N.get("line-cap"),dt=N.get("line-miter-limit"),Pt=N.get("line-round-limit");this.lineClips=this.lineFeatureClips(f);for(var Zt=0,qt=d;Zt<qt.length;Zt+=1)this.addLine(qt[Zt],f,Z,q,dt,Pt);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,O,T)},Ro.prototype.addLine=function(f,d,y,T,O,N){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var Z=0;Z<f.length-1;Z++)this.totalDistance+=f[Z].dist(f[Z+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var q=r0[d.type]==="Polygon",dt=f.length;dt>=2&&f[dt-1].equals(f[dt-2]);)dt--;for(var Pt=0;Pt<dt-1&&f[Pt].equals(f[Pt+1]);)Pt++;if(!(dt<(q?3:2))){y==="bevel"&&(O=1.05);var Zt,qt=this.overscaling<=16?122880/(512*this.overscaling):0,pe=this.segments.prepareSegment(10*dt,this.layoutVertexArray,this.indexArray),Oe=void 0,sr=void 0,lr=void 0,Cr=void 0;this.e1=this.e2=-1,q&&(Cr=f[Pt].sub(Zt=f[dt-2])._unit()._perp());for(var gr=Pt;gr<dt;gr++)if(!(sr=gr===dt-1?q?f[Pt+1]:void 0:f[gr+1])||!f[gr].equals(sr)){Cr&&(lr=Cr),Zt&&(Oe=Zt),Zt=f[gr],Cr=sr?sr.sub(Zt)._unit()._perp():lr;var Ur=(lr=lr||Cr).add(Cr);Ur.x===0&&Ur.y===0||Ur._unit();var Ar=lr.x*Cr.x+lr.y*Cr.y,Dr=Ur.x*Cr.x+Ur.y*Cr.y,mn=Dr!==0?1/Dr:1/0,Fn=2*Math.sqrt(2-2*Dr),ni=Dr<lp&&Oe&&sr,ki=lr.x*Cr.y-lr.y*Cr.x>0;if(ni&&gr>Pt){var oa=Zt.dist(Oe);if(oa>2*qt){var Di=Zt.sub(Zt.sub(Oe)._mult(qt/oa)._round());this.updateDistance(Oe,Di),this.addCurrentVertex(Di,lr,0,0,pe),Oe=Di}}var ca=Oe&&sr,zi=ca?y:q?"butt":T;if(ca&&zi==="round"&&(mn<N?zi="miter":mn<=2&&(zi="fakeround")),zi==="miter"&&mn>O&&(zi="bevel"),zi==="bevel"&&(mn>2&&(zi="flipbevel"),mn<O&&(zi="miter")),Oe&&this.updateDistance(Oe,Zt),zi==="miter")Ur._mult(mn),this.addCurrentVertex(Zt,Ur,0,0,pe);else if(zi==="flipbevel"){if(mn>100)Ur=Cr.mult(-1);else{var Oa=mn*lr.add(Cr).mag()/lr.sub(Cr).mag();Ur._perp()._mult(Oa*(ki?-1:1))}this.addCurrentVertex(Zt,Ur,0,0,pe),this.addCurrentVertex(Zt,Ur.mult(-1),0,0,pe)}else if(zi==="bevel"||zi==="fakeround"){var xa=-Math.sqrt(mn*mn-1),Qi=ki?xa:0,lo=ki?0:xa;if(Oe&&this.addCurrentVertex(Zt,lr,Qi,lo,pe),zi==="fakeround")for(var Ja=Math.round(180*Fn/Math.PI/20),To=1;To<Ja;To++){var ea=To/Ja;if(ea!==.5){var Zo=ea-.5;ea+=ea*Zo*(ea-1)*((1.0904+Ar*(Ar*(3.55645-1.43519*Ar)-3.2452))*Zo*Zo+(.848013+Ar*(.215638*Ar-1.06021)))}var Es=Cr.sub(lr)._mult(ea)._add(lr)._unit()._mult(ki?-1:1);this.addHalfVertex(Zt,Es.x,Es.y,!1,ki,0,pe)}sr&&this.addCurrentVertex(Zt,Cr,-Qi,-lo,pe)}else if(zi==="butt")this.addCurrentVertex(Zt,Ur,0,0,pe);else if(zi==="square"){var uu=Oe?1:-1;this.addCurrentVertex(Zt,Ur,uu,uu,pe)}else zi==="round"&&(Oe&&(this.addCurrentVertex(Zt,lr,0,0,pe),this.addCurrentVertex(Zt,lr,1,1,pe,!0)),sr&&(this.addCurrentVertex(Zt,Cr,-1,-1,pe,!0),this.addCurrentVertex(Zt,Cr,0,0,pe)));if(ni&&gr<dt-1){var Ws=Zt.dist(sr);if(Ws>2*qt){var ks=Zt.add(sr.sub(Zt)._mult(qt/Ws)._round());this.updateDistance(Zt,ks),this.addCurrentVertex(ks,Cr,0,0,pe),Zt=ks}}}}},Ro.prototype.addCurrentVertex=function(f,d,y,T,O,N){N===void 0&&(N=!1);var Z=d.y*T-d.x,q=-d.y-d.x*T;this.addHalfVertex(f,d.x+d.y*y,d.y-d.x*y,N,!1,y,O),this.addHalfVertex(f,Z,q,N,!0,-T,O),this.distance>Dd/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(f,d,y,T,O,N))},Ro.prototype.addHalfVertex=function(f,d,y,T,O,N,Z){var q=.5*(this.lineClips?this.scaledDistance*(Dd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((f.x<<1)+(T?1:0),(f.y<<1)+(O?1:0),Math.round(63*d)+128,Math.round(63*y)+128,1+(N===0?0:N<0?-1:1)|(63&q)<<2,q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var dt=Z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,dt),Z.primitiveLength++),O?this.e2=dt:this.e1=dt},Ro.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Ro.prototype.updateDistance=function(f,d){this.distance+=f.dist(d),this.updateScaledDistance()},Zi("LineBucket",Ro,{omit:["layers","patternFeatures"]});var kf=new Ru({"line-cap":new Ki(Le.layout_line["line-cap"]),"line-join":new Wi(Le.layout_line["line-join"]),"line-miter-limit":new Ki(Le.layout_line["line-miter-limit"]),"line-round-limit":new Ki(Le.layout_line["line-round-limit"]),"line-sort-key":new Wi(Le.layout_line["line-sort-key"])}),co={paint:new Ru({"line-opacity":new Wi(Le.paint_line["line-opacity"]),"line-color":new Wi(Le.paint_line["line-color"]),"line-translate":new Ki(Le.paint_line["line-translate"]),"line-translate-anchor":new Ki(Le.paint_line["line-translate-anchor"]),"line-width":new Wi(Le.paint_line["line-width"]),"line-gap-width":new Wi(Le.paint_line["line-gap-width"]),"line-offset":new Wi(Le.paint_line["line-offset"]),"line-blur":new Wi(Le.paint_line["line-blur"]),"line-dasharray":new ol(Le.paint_line["line-dasharray"]),"line-pattern":new Af(Le.paint_line["line-pattern"]),"line-gradient":new sl(Le.paint_line["line-gradient"])}),layout:kf},gu=new(function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(y,T){return T=new Ka(Math.floor(T.zoom),{now:T.now,fadeDuration:T.fadeDuration,zoomHistory:T.zoomHistory,transition:T.transition}),f.prototype.possiblyEvaluate.call(this,y,T)},d.prototype.evaluate=function(y,T,O,N){return T=b({},T,{zoom:Math.floor(T.zoom)}),f.prototype.evaluate.call(this,y,T,O,N)},d}(Wi))(co.paint.properties["line-width"].specification);gu.useIntegerZoom=!0;var W0=function(f){function d(y){f.call(this,y,co),this.gradientVersion=0}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._handleSpecialPaintPropertyUpdate=function(y){y==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Fu,this.gradientVersion=(this.gradientVersion+1)%be)},d.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},d.prototype.recalculate=function(y,T){f.prototype.recalculate.call(this,y,T),this.paint._values["line-floorwidth"]=gu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,y)},d.prototype.createBucket=function(y){return new Ro(y)},d.prototype.queryRadius=function(y){var T=y,O=Xp(Jl("line-width",this,T),Jl("line-gap-width",this,T)),N=Jl("line-offset",this,T);return O/2+Math.abs(N)+js(this.paint.get("line-translate"))},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,q,dt){var Pt=$c(y,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),q.angle,dt),Zt=dt/2*Xp(this.paint.get("line-width").evaluate(T,O),this.paint.get("line-gap-width").evaluate(T,O)),qt=this.paint.get("line-offset").evaluate(T,O);return qt&&(N=function(pe,Oe){for(var sr=[],lr=new ht(0,0),Cr=0;Cr<pe.length;Cr++){for(var gr=pe[Cr],Ur=[],Ar=0;Ar<gr.length;Ar++){var Dr=gr[Ar],mn=gr[Ar+1],Fn=Ar===0?lr:Dr.sub(gr[Ar-1])._unit()._perp(),ni=Ar===gr.length-1?lr:mn.sub(Dr)._unit()._perp(),ki=Fn._add(ni)._unit();ki._mult(1/(ki.x*ni.x+ki.y*ni.y)),Ur.push(ki._mult(Oe)._add(Dr))}sr.push(Ur)}return sr}(N,qt*dt)),function(pe,Oe,sr){for(var lr=0;lr<Oe.length;lr++){var Cr=Oe[lr];if(pe.length>=3){for(var gr=0;gr<Cr.length;gr++)if(dc(pe,Cr[gr]))return!0}if(cl(pe,Cr,sr))return!0}return!1}(Pt,N,Zt)},d.prototype.isTileClipped=function(){return!0},d}(bs);function Xp(f,d){return d>0?d+2*f:f}var Bd=os([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),X0=os([{name:"a_projected_pos",components:3,type:"Float32"}],4),Yp=(os([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),os([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),n0=(os([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),os([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),ic=os([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Th(f,d,y){return f.sections.forEach(function(T){T.text=function(O,N,Z){var q=N.layout.get("text-transform").evaluate(Z,{});return q==="uppercase"?O=O.toLocaleUpperCase():q==="lowercase"&&(O=O.toLocaleLowerCase()),Ko.applyArabicShaping&&(O=Ko.applyArabicShaping(O)),O}(T.text,d,y)}),f}os([{name:"triangle",components:3,type:"Uint16"}]),os([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),os([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),os([{type:"Float32",name:"offsetX"}]),os([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Nu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Ug=function(f,d,y,T,O){var N,Z,q=8*O-T-1,dt=(1<<q)-1,Pt=dt>>1,Zt=-7,qt=y?O-1:0,pe=y?-1:1,Oe=f[d+qt];for(qt+=pe,N=Oe&(1<<-Zt)-1,Oe>>=-Zt,Zt+=q;Zt>0;N=256*N+f[d+qt],qt+=pe,Zt-=8);for(Z=N&(1<<-Zt)-1,N>>=-Zt,Zt+=T;Zt>0;Z=256*Z+f[d+qt],qt+=pe,Zt-=8);if(N===0)N=1-Pt;else{if(N===dt)return Z?NaN:1/0*(Oe?-1:1);Z+=Math.pow(2,T),N-=Pt}return(Oe?-1:1)*Z*Math.pow(2,N-T)},Jf=function(f,d,y,T,O,N){var Z,q,dt,Pt=8*N-O-1,Zt=(1<<Pt)-1,qt=Zt>>1,pe=O===23?Math.pow(2,-24)-Math.pow(2,-77):0,Oe=T?0:N-1,sr=T?1:-1,lr=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(q=isNaN(d)?1:0,Z=Zt):(Z=Math.floor(Math.log(d)/Math.LN2),d*(dt=Math.pow(2,-Z))<1&&(Z--,dt*=2),(d+=Z+qt>=1?pe/dt:pe*Math.pow(2,1-qt))*dt>=2&&(Z++,dt/=2),Z+qt>=Zt?(q=0,Z=Zt):Z+qt>=1?(q=(d*dt-1)*Math.pow(2,O),Z+=qt):(q=d*Math.pow(2,qt-1)*Math.pow(2,O),Z=0));O>=8;f[y+Oe]=255&q,Oe+=sr,q/=256,O-=8);for(Z=Z<<O|q,Pt+=O;Pt>0;f[y+Oe]=255&Z,Oe+=sr,Z/=256,Pt-=8);f[y+Oe-sr]|=128*lr},th=Qo;function Qo(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}Qo.Varint=0,Qo.Fixed64=1,Qo.Bytes=2,Qo.Fixed32=5;var $p=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function eh(f){return f.type===Qo.Bytes?f.readVarint()+f.pos:f.pos+1}function uf(f,d,y){return y?4294967296*d+(f>>>0):4294967296*(d>>>0)+(f>>>0)}function qp(f,d,y){var T=d<=16383?1:d<=2097151?2:d<=268435455?3:Math.floor(Math.log(d)/(7*Math.LN2));y.realloc(T);for(var O=y.pos-1;O>=f;O--)y.buf[O+T]=y.buf[O]}function Hm(f,d){for(var y=0;y<f.length;y++)d.writeVarint(f[y])}function It(f,d){for(var y=0;y<f.length;y++)d.writeSVarint(f[y])}function Ue(f,d){for(var y=0;y<f.length;y++)d.writeFloat(f[y])}function dr(f,d){for(var y=0;y<f.length;y++)d.writeDouble(f[y])}function cn(f,d){for(var y=0;y<f.length;y++)d.writeBoolean(f[y])}function On(f,d){for(var y=0;y<f.length;y++)d.writeFixed32(f[y])}function on(f,d){for(var y=0;y<f.length;y++)d.writeSFixed32(f[y])}function En(f,d){for(var y=0;y<f.length;y++)d.writeFixed64(f[y])}function Dn(f,d){for(var y=0;y<f.length;y++)d.writeSFixed64(f[y])}function Hn(f,d){return(f[d]|f[d+1]<<8|f[d+2]<<16)+16777216*f[d+3]}function Jn(f,d,y){f[y]=d,f[y+1]=d>>>8,f[y+2]=d>>>16,f[y+3]=d>>>24}function ii(f,d){return(f[d]|f[d+1]<<8|f[d+2]<<16)+(f[d+3]<<24)}function ui(f,d,y){f===1&&y.readMessage(yi,d)}function yi(f,d,y){if(f===3){var T=y.readMessage(qn,{}),O=T.width,N=T.height,Z=T.left,q=T.top,dt=T.advance;d.push({id:T.id,bitmap:new kl({width:O+6,height:N+6},T.bitmap),metrics:{width:O,height:N,left:Z,top:q,advance:dt}})}}function qn(f,d,y){f===1?d.id=y.readVarint():f===2?d.bitmap=y.readBytes():f===3?d.width=y.readVarint():f===4?d.height=y.readVarint():f===5?d.left=y.readSVarint():f===6?d.top=y.readSVarint():f===7&&(d.advance=y.readVarint())}function ri(f){for(var d=0,y=0,T=0,O=f;T<O.length;T+=1){var N=O[T];d+=N.w*N.h,y=Math.max(y,N.w)}f.sort(function(lr,Cr){return Cr.h-lr.h});for(var Z=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(d/.95)),y),h:1/0}],q=0,dt=0,Pt=0,Zt=f;Pt<Zt.length;Pt+=1)for(var qt=Zt[Pt],pe=Z.length-1;pe>=0;pe--){var Oe=Z[pe];if(!(qt.w>Oe.w||qt.h>Oe.h)){if(qt.x=Oe.x,qt.y=Oe.y,dt=Math.max(dt,qt.y+qt.h),q=Math.max(q,qt.x+qt.w),qt.w===Oe.w&&qt.h===Oe.h){var sr=Z.pop();pe<Z.length&&(Z[pe]=sr)}else qt.h===Oe.h?(Oe.x+=qt.w,Oe.w-=qt.w):qt.w===Oe.w?(Oe.y+=qt.h,Oe.h-=qt.h):(Z.push({x:Oe.x+qt.w,y:Oe.y,w:Oe.w-qt.w,h:qt.h}),Oe.y+=qt.h,Oe.h-=qt.h);break}}return{w:q,h:dt,fill:d/(q*dt)||0}}Qo.prototype={destroy:function(){this.buf=null},readFields:function(f,d,y){for(y=y||this.length;this.pos<y;){var T=this.readVarint(),O=T>>3,N=this.pos;this.type=7&T,f(O,d,this),this.pos===N&&this.skip(T)}return d},readMessage:function(f,d){return this.readFields(f,d,this.readVarint()+this.pos)},readFixed32:function(){var f=Hn(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=ii(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=Hn(this.buf,this.pos)+4294967296*Hn(this.buf,this.pos+4);return this.pos+=8,f},readSFixed64:function(){var f=Hn(this.buf,this.pos)+4294967296*ii(this.buf,this.pos+4);return this.pos+=8,f},readFloat:function(){var f=Ug(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=Ug(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var d,y,T=this.buf;return d=127&(y=T[this.pos++]),y<128?d:(d|=(127&(y=T[this.pos++]))<<7,y<128?d:(d|=(127&(y=T[this.pos++]))<<14,y<128?d:(d|=(127&(y=T[this.pos++]))<<21,y<128?d:function(O,N,Z){var q,dt,Pt=Z.buf;if(q=(112&(dt=Pt[Z.pos++]))>>4,dt<128||(q|=(127&(dt=Pt[Z.pos++]))<<3,dt<128)||(q|=(127&(dt=Pt[Z.pos++]))<<10,dt<128)||(q|=(127&(dt=Pt[Z.pos++]))<<17,dt<128)||(q|=(127&(dt=Pt[Z.pos++]))<<24,dt<128)||(q|=(1&(dt=Pt[Z.pos++]))<<31,dt<128))return uf(O,q,N);throw new Error("Expected varint not more than 10 bytes")}(d|=(15&(y=T[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var f=this.readVarint()+this.pos,d=this.pos;return this.pos=f,f-d>=12&&$p?function(y,T,O){return $p.decode(y.subarray(T,O))}(this.buf,d,f):function(y,T,O){for(var N="",Z=T;Z<O;){var q,dt,Pt,Zt=y[Z],qt=null,pe=Zt>239?4:Zt>223?3:Zt>191?2:1;if(Z+pe>O)break;pe===1?Zt<128&&(qt=Zt):pe===2?(192&(q=y[Z+1]))==128&&(qt=(31&Zt)<<6|63&q)<=127&&(qt=null):pe===3?(dt=y[Z+2],(192&(q=y[Z+1]))==128&&(192&dt)==128&&((qt=(15&Zt)<<12|(63&q)<<6|63&dt)<=2047||qt>=55296&&qt<=57343)&&(qt=null)):pe===4&&(dt=y[Z+2],Pt=y[Z+3],(192&(q=y[Z+1]))==128&&(192&dt)==128&&(192&Pt)==128&&((qt=(15&Zt)<<18|(63&q)<<12|(63&dt)<<6|63&Pt)<=65535||qt>=1114112)&&(qt=null)),qt===null?(qt=65533,pe=1):qt>65535&&(qt-=65536,N+=String.fromCharCode(qt>>>10&1023|55296),qt=56320|1023&qt),N+=String.fromCharCode(qt),Z+=pe}return N}(this.buf,d,f)},readBytes:function(){var f=this.readVarint()+this.pos,d=this.buf.subarray(this.pos,f);return this.pos=f,d},readPackedVarint:function(f,d){if(this.type!==Qo.Bytes)return f.push(this.readVarint(d));var y=eh(this);for(f=f||[];this.pos<y;)f.push(this.readVarint(d));return f},readPackedSVarint:function(f){if(this.type!==Qo.Bytes)return f.push(this.readSVarint());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==Qo.Bytes)return f.push(this.readBoolean());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==Qo.Bytes)return f.push(this.readFloat());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==Qo.Bytes)return f.push(this.readDouble());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==Qo.Bytes)return f.push(this.readFixed32());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==Qo.Bytes)return f.push(this.readSFixed32());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==Qo.Bytes)return f.push(this.readFixed64());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==Qo.Bytes)return f.push(this.readSFixed64());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readSFixed64());return f},skip:function(f){var d=7&f;if(d===Qo.Varint)for(;this.buf[this.pos++]>127;);else if(d===Qo.Bytes)this.pos=this.readVarint()+this.pos;else if(d===Qo.Fixed32)this.pos+=4;else{if(d!==Qo.Fixed64)throw new Error("Unimplemented type: "+d);this.pos+=8}},writeTag:function(f,d){this.writeVarint(f<<3|d)},realloc:function(f){for(var d=this.length||16;d<this.pos+f;)d*=2;if(d!==this.length){var y=new Uint8Array(d);y.set(this.buf),this.buf=y,this.length=d}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),Jn(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),Jn(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),Jn(this.buf,-1&f,this.pos),Jn(this.buf,Math.floor(f*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),Jn(this.buf,-1&f,this.pos),Jn(this.buf,Math.floor(f*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(d,y){var T,O;if(d>=0?(T=d%4294967296|0,O=d/4294967296|0):(O=~(-d/4294967296),4294967295^(T=~(-d%4294967296))?T=T+1|0:(T=0,O=O+1|0)),d>=18446744073709552e3||d<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");y.realloc(10),function(N,Z,q){q.buf[q.pos++]=127&N|128,N>>>=7,q.buf[q.pos++]=127&N|128,N>>>=7,q.buf[q.pos++]=127&N|128,N>>>=7,q.buf[q.pos++]=127&N|128,q.buf[q.pos]=127&(N>>>=7)}(T,0,y),function(N,Z){var q=(7&N)<<4;Z.buf[Z.pos++]|=q|((N>>>=3)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N)))))}(O,y)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(Boolean(f))},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var d=this.pos;this.pos=function(T,O,N){for(var Z,q,dt=0;dt<O.length;dt++){if((Z=O.charCodeAt(dt))>55295&&Z<57344){if(!q){Z>56319||dt+1===O.length?(T[N++]=239,T[N++]=191,T[N++]=189):q=Z;continue}if(Z<56320){T[N++]=239,T[N++]=191,T[N++]=189,q=Z;continue}Z=q-55296<<10|Z-56320|65536,q=null}else q&&(T[N++]=239,T[N++]=191,T[N++]=189,q=null);Z<128?T[N++]=Z:(Z<2048?T[N++]=Z>>6|192:(Z<65536?T[N++]=Z>>12|224:(T[N++]=Z>>18|240,T[N++]=Z>>12&63|128),T[N++]=Z>>6&63|128),T[N++]=63&Z|128)}return N}(this.buf,f,this.pos);var y=this.pos-d;y>=128&&qp(d,y,this),this.pos=d-1,this.writeVarint(y),this.pos+=y},writeFloat:function(f){this.realloc(4),Jf(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),Jf(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var d=f.length;this.writeVarint(d),this.realloc(d);for(var y=0;y<d;y++)this.buf[this.pos++]=f[y]},writeRawMessage:function(f,d){this.pos++;var y=this.pos;f(d,this);var T=this.pos-y;T>=128&&qp(y,T,this),this.pos=y-1,this.writeVarint(T),this.pos+=T},writeMessage:function(f,d,y){this.writeTag(f,Qo.Bytes),this.writeRawMessage(d,y)},writePackedVarint:function(f,d){d.length&&this.writeMessage(f,Hm,d)},writePackedSVarint:function(f,d){d.length&&this.writeMessage(f,It,d)},writePackedBoolean:function(f,d){d.length&&this.writeMessage(f,cn,d)},writePackedFloat:function(f,d){d.length&&this.writeMessage(f,Ue,d)},writePackedDouble:function(f,d){d.length&&this.writeMessage(f,dr,d)},writePackedFixed32:function(f,d){d.length&&this.writeMessage(f,On,d)},writePackedSFixed32:function(f,d){d.length&&this.writeMessage(f,on,d)},writePackedFixed64:function(f,d){d.length&&this.writeMessage(f,En,d)},writePackedSFixed64:function(f,d){d.length&&this.writeMessage(f,Dn,d)},writeBytesField:function(f,d){this.writeTag(f,Qo.Bytes),this.writeBytes(d)},writeFixed32Field:function(f,d){this.writeTag(f,Qo.Fixed32),this.writeFixed32(d)},writeSFixed32Field:function(f,d){this.writeTag(f,Qo.Fixed32),this.writeSFixed32(d)},writeFixed64Field:function(f,d){this.writeTag(f,Qo.Fixed64),this.writeFixed64(d)},writeSFixed64Field:function(f,d){this.writeTag(f,Qo.Fixed64),this.writeSFixed64(d)},writeVarintField:function(f,d){this.writeTag(f,Qo.Varint),this.writeVarint(d)},writeSVarintField:function(f,d){this.writeTag(f,Qo.Varint),this.writeSVarint(d)},writeStringField:function(f,d){this.writeTag(f,Qo.Bytes),this.writeString(d)},writeFloatField:function(f,d){this.writeTag(f,Qo.Fixed32),this.writeFloat(d)},writeDoubleField:function(f,d){this.writeTag(f,Qo.Fixed64),this.writeDouble(d)},writeBooleanField:function(f,d){this.writeVarintField(f,Boolean(d))}};var Gr=function(f,d){var y=d.pixelRatio,T=d.version,O=d.stretchX,N=d.stretchY,Z=d.content;this.paddedRect=f,this.pixelRatio=y,this.stretchX=O,this.stretchY=N,this.content=Z,this.version=T},dn={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};dn.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},dn.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},dn.tlbr.get=function(){return this.tl.concat(this.br)},dn.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Gr.prototype,dn);var Xn=function(f,d){var y={},T={};this.haveRenderCallbacks=[];var O=[];this.addImages(f,y,O),this.addImages(d,T,O);var N=ri(O),Z=new Cu({width:N.w||1,height:N.h||1});for(var q in f){var dt=f[q],Pt=y[q].paddedRect;Cu.copy(dt.data,Z,{x:0,y:0},{x:Pt.x+1,y:Pt.y+1},dt.data)}for(var Zt in d){var qt=d[Zt],pe=T[Zt].paddedRect,Oe=pe.x+1,sr=pe.y+1,lr=qt.data.width,Cr=qt.data.height;Cu.copy(qt.data,Z,{x:0,y:0},{x:Oe,y:sr},qt.data),Cu.copy(qt.data,Z,{x:0,y:Cr-1},{x:Oe,y:sr-1},{width:lr,height:1}),Cu.copy(qt.data,Z,{x:0,y:0},{x:Oe,y:sr+Cr},{width:lr,height:1}),Cu.copy(qt.data,Z,{x:lr-1,y:0},{x:Oe-1,y:sr},{width:1,height:Cr}),Cu.copy(qt.data,Z,{x:0,y:0},{x:Oe+lr,y:sr},{width:1,height:Cr})}this.image=Z,this.iconPositions=y,this.patternPositions=T};Xn.prototype.addImages=function(f,d,y){for(var T in f){var O=f[T],N={x:0,y:0,w:O.data.width+2,h:O.data.height+2};y.push(N),d[T]=new Gr(N,O),O.hasRenderCallback&&this.haveRenderCallbacks.push(T)}},Xn.prototype.patchUpdatedImages=function(f,d){for(var y in f.dispatchRenderCallbacks(this.haveRenderCallbacks),f.updatedImages)this.patchUpdatedImage(this.iconPositions[y],f.getImage(y),d),this.patchUpdatedImage(this.patternPositions[y],f.getImage(y),d)},Xn.prototype.patchUpdatedImage=function(f,d,y){if(f&&d&&f.version!==d.version){f.version=d.version;var T=f.tl;y.update(d.data,void 0,{x:T[0],y:T[1]})}},Zi("ImagePosition",Gr),Zi("ImageAtlas",Xn);var vi={horizontal:1,vertical:2,horizontalOnly:3},Rn=function(){this.scale=1,this.fontStack="",this.imageName=null};Rn.forText=function(f,d){var y=new Rn;return y.scale=f||1,y.fontStack=d,y},Rn.forImage=function(f){var d=new Rn;return d.imageName=f,d};var Qn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Ti(f,d,y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe,sr,lr){var Cr,gr=Qn.fromFeature(f,O);qt===vi.vertical&&gr.verticalizePunctuation();var Ur=Ko.processBidirectionalText,Ar=Ko.processStyledBidirectionalText;if(Ur&&gr.sections.length===1){Cr=[];for(var Dr=0,mn=Ur(gr.toString(),xi(gr,Pt,N,d,T,Oe,sr));Dr<mn.length;Dr+=1){var Fn=mn[Dr],ni=new Qn;ni.text=Fn,ni.sections=gr.sections;for(var ki=0;ki<Fn.length;ki++)ni.sectionIndex.push(0);Cr.push(ni)}}else if(Ar){Cr=[];for(var oa=0,Di=Ar(gr.text,gr.sectionIndex,xi(gr,Pt,N,d,T,Oe,sr));oa<Di.length;oa+=1){var ca=Di[oa],zi=new Qn;zi.text=ca[0],zi.sectionIndex=ca[1],zi.sections=gr.sections,Cr.push(zi)}}else Cr=function(Qi,lo){for(var Ja=[],To=Qi.text,ea=0,Zo=0,Es=lo;Zo<Es.length;Zo+=1){var uu=Es[Zo];Ja.push(Qi.substring(ea,uu)),ea=uu}return ea<To.length&&Ja.push(Qi.substring(ea,To.length)),Ja}(gr,xi(gr,Pt,N,d,T,Oe,sr));var Oa=[],xa={positionedLines:Oa,text:gr.toString(),top:Zt[1],bottom:Zt[1],left:Zt[0],right:Zt[0],writingMode:qt,iconsInText:!1,verticalizable:!1};return function(Qi,lo,Ja,To,ea,Zo,Es,uu,Ws,ks,eu,Qu){for(var lu=0,Gl=-17,us=0,Hl=0,mu=uu==="right"?1:uu==="left"?0:.5,cu=0,ro=0,va=ea;ro<va.length;ro+=1){var ts=va[ro];ts.trim();var Do=ts.getMaxScale(),jl=24*(Do-1),Uu={positionedGlyphs:[],lineOffset:0};Qi.positionedLines[cu]=Uu;var Ss=Uu.positionedGlyphs,Pu=0;if(ts.length()){for(var fu=0;fu<ts.length();fu++){var Oo=ts.getSection(fu),cf=ts.getSectionIndex(fu),ff=ts.getCharCode(fu),nh=0,ru=null,kh=null,fl=null,Qp=24,Pl=!(Ws===vi.horizontal||!eu&&!Cc(ff)||eu&&(aa[ff]||(yc=ff,Ai.Arabic(yc)||Ai["Arabic Supplement"](yc)||Ai["Arabic Extended-A"](yc)||Ai["Arabic Presentation Forms-A"](yc)||Ai["Arabic Presentation Forms-B"](yc))));if(Oo.imageName){var Lf=To[Oo.imageName];if(!Lf)continue;fl=Oo.imageName,Qi.iconsInText=Qi.iconsInText||!0,kh=Lf.paddedRect;var ih=Lf.displaySize;Oo.scale=24*Oo.scale/Qu,nh=jl+(24-ih[1]*Oo.scale),Qp=(ru={width:ih[0],height:ih[1],left:1,top:-3,advance:Pl?ih[1]:ih[0]}).advance;var Nd=Pl?ih[0]*Oo.scale-24*Do:ih[1]*Oo.scale-24*Do;Nd>0&&Nd>Pu&&(Pu=Nd)}else{var a0=Ja[Oo.fontStack],fp=a0&&a0[ff];if(fp&&fp.rect)kh=fp.rect,ru=fp.metrics;else{var yv=lo[Oo.fontStack],zd=yv&&yv[ff];if(!zd)continue;ru=zd.metrics}nh=24*(Do-Oo.scale)}Pl?(Qi.verticalizable=!0,Ss.push({glyph:ff,imageName:fl,x:lu,y:Gl+nh,vertical:Pl,scale:Oo.scale,fontStack:Oo.fontStack,sectionIndex:cf,metrics:ru,rect:kh}),lu+=Qp*Oo.scale+ks):(Ss.push({glyph:ff,imageName:fl,x:lu,y:Gl+nh,vertical:Pl,scale:Oo.scale,fontStack:Oo.fontStack,sectionIndex:cf,metrics:ru,rect:kh}),lu+=ru.advance*Oo.scale+ks)}Ss.length!==0&&(us=Math.max(lu-ks,us),Ua(Ss,0,Ss.length-1,mu,Pu)),lu=0;var _v=Zo*Do+Pu;Uu.lineOffset=Math.max(Pu,jl),Gl+=_v,Hl=Math.max(_v,Hl),++cu}else Gl+=Zo,++cu}var yc,hp=Gl- -17,Zu=Mi(Es),pp=Zu.horizontalAlign,Jp=Zu.verticalAlign;(function(Ud,Zd,xv,bv,Ev,Sv,td,wv,o0){var Us,Kt=(Zd-xv)*Ev;Us=Sv!==td?-wv*bv- -17:(-bv*o0+.5)*td;for(var dp=0,Cv=Ud;dp<Cv.length;dp+=1)for(var vp=0,Av=Cv[dp].positionedGlyphs;vp<Av.length;vp+=1){var gp=Av[vp];gp.x+=Kt,gp.y+=Us}})(Qi.positionedLines,mu,pp,Jp,us,Hl,Zo,hp,ea.length),Qi.top+=-Jp*hp,Qi.bottom=Qi.top+hp,Qi.left+=-pp*us,Qi.right=Qi.left+us}(xa,d,y,T,Cr,Z,q,dt,qt,Pt,pe,lr),!function(Qi){for(var lo=0,Ja=Qi;lo<Ja.length;lo+=1)if(Ja[lo].positionedGlyphs.length!==0)return!1;return!0}(Oa)&&xa}Qn.fromFeature=function(f,d){for(var y=new Qn,T=0;T<f.sections.length;T++){var O=f.sections[T];O.image?y.addImageSection(O):y.addTextSection(O,d)}return y},Qn.prototype.length=function(){return this.text.length},Qn.prototype.getSection=function(f){return this.sections[this.sectionIndex[f]]},Qn.prototype.getSectionIndex=function(f){return this.sectionIndex[f]},Qn.prototype.getCharCode=function(f){return this.text.charCodeAt(f)},Qn.prototype.verticalizePunctuation=function(){this.text=function(f){for(var d="",y=0;y<f.length;y++){var T=f.charCodeAt(y+1)||null,O=f.charCodeAt(y-1)||null;d+=T&&Cf(T)&&!Nu[f[y+1]]||O&&Cf(O)&&!Nu[f[y-1]]||!Nu[f[y]]?f[y]:Nu[f[y]]}return d}(this.text)},Qn.prototype.trim=function(){for(var f=0,d=0;d<this.text.length&&aa[this.text.charCodeAt(d)];d++)f++;for(var y=this.text.length,T=this.text.length-1;T>=0&&T>=f&&aa[this.text.charCodeAt(T)];T--)y--;this.text=this.text.substring(f,y),this.sectionIndex=this.sectionIndex.slice(f,y)},Qn.prototype.substring=function(f,d){var y=new Qn;return y.text=this.text.substring(f,d),y.sectionIndex=this.sectionIndex.slice(f,d),y.sections=this.sections,y},Qn.prototype.toString=function(){return this.text},Qn.prototype.getMaxScale=function(){var f=this;return this.sectionIndex.reduce(function(d,y){return Math.max(d,f.sections[y].scale)},0)},Qn.prototype.addTextSection=function(f,d){this.text+=f.text,this.sections.push(Rn.forText(f.scale,f.fontStack||d));for(var y=this.sections.length-1,T=0;T<f.text.length;++T)this.sectionIndex.push(y)},Qn.prototype.addImageSection=function(f){var d=f.image?f.image.name:"";if(d.length!==0){var y=this.getNextImageSectionCharCode();y?(this.text+=String.fromCharCode(y),this.sections.push(Rn.forImage(d)),this.sectionIndex.push(this.sections.length-1)):te("Reached maximum number of images 6401")}else te("Can't add FormattedSection with an empty image.")},Qn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var aa={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_n={};function An(f,d,y,T,O,N){if(d.imageName){var Z=T[d.imageName];return Z?Z.displaySize[0]*d.scale*24/N+O:0}var q=y[d.fontStack],dt=q&&q[f];return dt?dt.metrics.advance*d.scale+O:0}function oi(f,d,y,T){var O=Math.pow(f-d,2);return T?f<d?O/2:2*O:O+Math.abs(y)*y}function Ei(f,d,y){var T=0;return f===10&&(T-=1e4),y&&(T+=150),f!==40&&f!==65288||(T+=50),d!==41&&d!==65289||(T+=50),T}function ti(f,d,y,T,O,N){for(var Z=null,q=oi(d,y,O,N),dt=0,Pt=T;dt<Pt.length;dt+=1){var Zt=Pt[dt],qt=oi(d-Zt.x,y,O,N)+Zt.badness;qt<=q&&(Z=Zt,q=qt)}return{index:f,x:d,priorBreak:Z,badness:q}}function xi(f,d,y,T,O,N,Z){if(N!=="point")return[];if(!f)return[];for(var q,dt=[],Pt=function(Cr,gr,Ur,Ar,Dr,mn){for(var Fn=0,ni=0;ni<Cr.length();ni++){var ki=Cr.getSection(ni);Fn+=An(Cr.getCharCode(ni),ki,Ar,Dr,gr,mn)}return Fn/Math.max(1,Math.ceil(Fn/Ur))}(f,d,y,T,O,Z),Zt=f.text.indexOf("\u200B")>=0,qt=0,pe=0;pe<f.length();pe++){var Oe=f.getSection(pe),sr=f.getCharCode(pe);if(aa[sr]||(qt+=An(sr,Oe,T,O,d,Z)),pe<f.length()-1){var lr=!((q=sr)<11904||!(Ai["Bopomofo Extended"](q)||Ai.Bopomofo(q)||Ai["CJK Compatibility Forms"](q)||Ai["CJK Compatibility Ideographs"](q)||Ai["CJK Compatibility"](q)||Ai["CJK Radicals Supplement"](q)||Ai["CJK Strokes"](q)||Ai["CJK Symbols and Punctuation"](q)||Ai["CJK Unified Ideographs Extension A"](q)||Ai["CJK Unified Ideographs"](q)||Ai["Enclosed CJK Letters and Months"](q)||Ai["Halfwidth and Fullwidth Forms"](q)||Ai.Hiragana(q)||Ai["Ideographic Description Characters"](q)||Ai["Kangxi Radicals"](q)||Ai["Katakana Phonetic Extensions"](q)||Ai.Katakana(q)||Ai["Vertical Forms"](q)||Ai["Yi Radicals"](q)||Ai["Yi Syllables"](q)));(_n[sr]||lr||Oe.imageName)&&dt.push(ti(pe+1,qt,Pt,dt,Ei(sr,f.getCharCode(pe+1),lr&&Zt),!1))}}return function Cr(gr){return gr?Cr(gr.priorBreak).concat(gr.index):[]}(ti(f.length(),qt,Pt,dt,0,!0))}function Mi(f){var d=.5,y=.5;switch(f){case"right":case"top-right":case"bottom-right":d=1;break;case"left":case"top-left":case"bottom-left":d=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":y=1;break;case"top":case"top-right":case"top-left":y=0}return{horizontalAlign:d,verticalAlign:y}}function Ua(f,d,y,T,O){if(T||O)for(var N=f[y],Z=(f[y].x+N.metrics.advance*N.scale)*T,q=d;q<=y;q++)f[q].x-=Z,f[q].y+=O}function Yn(f,d,y,T,O,N){var Z,q=f.image;if(q.content){var dt=q.content,Pt=q.pixelRatio||1;Z=[dt[0]/Pt,dt[1]/Pt,q.displaySize[0]-dt[2]/Pt,q.displaySize[1]-dt[3]/Pt]}var Zt,qt,pe,Oe,sr=d.left*N,lr=d.right*N;y==="width"||y==="both"?(Oe=O[0]+sr-T[3],qt=O[0]+lr+T[1]):qt=(Oe=O[0]+(sr+lr-q.displaySize[0])/2)+q.displaySize[0];var Cr=d.top*N,gr=d.bottom*N;return y==="height"||y==="both"?(Zt=O[1]+Cr-T[0],pe=O[1]+gr+T[2]):pe=(Zt=O[1]+(Cr+gr-q.displaySize[1])/2)+q.displaySize[1],{image:q,top:Zt,right:qt,bottom:pe,left:Oe,collisionPadding:Z}}_n[10]=!0,_n[32]=!0,_n[38]=!0,_n[40]=!0,_n[41]=!0,_n[43]=!0,_n[45]=!0,_n[47]=!0,_n[173]=!0,_n[183]=!0,_n[8203]=!0,_n[8208]=!0,_n[8211]=!0,_n[8231]=!0;var Ii=function(f){function d(y,T,O,N){f.call(this,y,T),this.angle=O,N!==void 0&&(this.segment=N)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.clone=function(){return new d(this.x,this.y,this.angle,this.segment)},d}(ht);function Li(f,d){var y=d.expression;if(y.kind==="constant")return{kind:"constant",layoutSize:y.evaluate(new Ka(f+1))};if(y.kind==="source")return{kind:"source"};for(var T=y.zoomStops,O=y.interpolationType,N=0;N<T.length&&T[N]<=f;)N++;for(var Z=N=Math.max(0,N-1);Z<T.length&&T[Z]<f+1;)Z++;Z=Math.min(T.length-1,Z);var q=T[N],dt=T[Z];return y.kind==="composite"?{kind:"composite",minZoom:q,maxZoom:dt,interpolationType:O}:{kind:"camera",minZoom:q,maxZoom:dt,minSize:y.evaluate(new Ka(q)),maxSize:y.evaluate(new Ka(dt)),interpolationType:O}}function Sa(f,d,y){var T=d.uSize,O=y.lowerSize;return f.kind==="source"?O/128:f.kind==="composite"?Fo(O/128,y.upperSize/128,d.uSizeT):T}function Da(f,d){var y=0,T=0;if(f.kind==="constant")T=f.layoutSize;else if(f.kind!=="source"){var O=f.interpolationType,N=O?Ut(Ze.interpolationFactor(O,d,f.minZoom,f.maxZoom),0,1):0;f.kind==="camera"?T=Fo(f.minSize,f.maxSize,N):y=N}return{uSizeT:y,uSize:T}}Zi("Anchor",Ii);var oo=Object.freeze({__proto__:null,getSizeData:Li,evaluateSizeForFeature:Sa,evaluateSizeForZoom:Da,SIZE_PACK_FACTOR:128});function Is(f,d,y,T,O){if(d.segment===void 0)return!0;for(var N=d,Z=d.segment+1,q=0;q>-y/2;){if(--Z<0)return!1;q-=f[Z].dist(N),N=f[Z]}q+=f[Z].dist(f[Z+1]),Z++;for(var dt=[],Pt=0;q<y/2;){var Zt=f[Z],qt=f[Z+1];if(!qt)return!1;var pe=f[Z-1].angleTo(Zt)-Zt.angleTo(qt);for(pe=Math.abs((pe+3*Math.PI)%(2*Math.PI)-Math.PI),dt.push({distance:q,angleDelta:pe}),Pt+=pe;q-dt[0].distance>T;)Pt-=dt.shift().angleDelta;if(Pt>O)return!1;Z++,q+=Zt.dist(qt)}return!0}function zs(f){for(var d=0,y=0;y<f.length-1;y++)d+=f[y].dist(f[y+1]);return d}function io(f,d,y){return f?.6*d*y:0}function Au(f,d){return Math.max(f?f.right-f.left:0,d?d.right-d.left:0)}function Xo(f,d,y,T,O,N){for(var Z=io(y,O,N),q=Au(y,T)*N,dt=0,Pt=zs(f)/2,Zt=0;Zt<f.length-1;Zt++){var qt=f[Zt],pe=f[Zt+1],Oe=qt.dist(pe);if(dt+Oe>Pt){var sr=(Pt-dt)/Oe,lr=Fo(qt.x,pe.x,sr),Cr=Fo(qt.y,pe.y,sr),gr=new Ii(lr,Cr,pe.angleTo(qt),Zt);return gr._round(),!Z||Is(f,gr,q,Z,d)?gr:void 0}dt+=Oe}}function Qs(f,d,y,T,O,N,Z,q,dt){var Pt=io(T,N,Z),Zt=Au(T,O),qt=Zt*Z,pe=f[0].x===0||f[0].x===dt||f[0].y===0||f[0].y===dt;return d-qt<d/4&&(d=qt+d/4),function Oe(sr,lr,Cr,gr,Ur,Ar,Dr,mn,Fn){for(var ni=Ar/2,ki=zs(sr),oa=0,Di=lr-Cr,ca=[],zi=0;zi<sr.length-1;zi++){for(var Oa=sr[zi],xa=sr[zi+1],Qi=Oa.dist(xa),lo=xa.angleTo(Oa);Di+Cr<oa+Qi;){var Ja=((Di+=Cr)-oa)/Qi,To=Fo(Oa.x,xa.x,Ja),ea=Fo(Oa.y,xa.y,Ja);if(To>=0&&To<Fn&&ea>=0&&ea<Fn&&Di-ni>=0&&Di+ni<=ki){var Zo=new Ii(To,ea,lo,zi);Zo._round(),gr&&!Is(sr,Zo,Ar,gr,Ur)||ca.push(Zo)}}oa+=Qi}return mn||ca.length||Dr||(ca=Oe(sr,oa/2,Cr,gr,Ur,Ar,Dr,!0,Fn)),ca}(f,pe?d/2*q%d:(Zt/2+2*N)*Z*q%d,d,Pt,y,qt,pe,!1,dt)}function su(f,d,y,T,O){for(var N=[],Z=0;Z<f.length;Z++)for(var q=f[Z],dt=void 0,Pt=0;Pt<q.length-1;Pt++){var Zt=q[Pt],qt=q[Pt+1];Zt.x<d&&qt.x<d||(Zt.x<d?Zt=new ht(d,Zt.y+(d-Zt.x)/(qt.x-Zt.x)*(qt.y-Zt.y))._round():qt.x<d&&(qt=new ht(d,Zt.y+(d-Zt.x)/(qt.x-Zt.x)*(qt.y-Zt.y))._round()),Zt.y<y&&qt.y<y||(Zt.y<y?Zt=new ht(Zt.x+(y-Zt.y)/(qt.y-Zt.y)*(qt.x-Zt.x),y)._round():qt.y<y&&(qt=new ht(Zt.x+(y-Zt.y)/(qt.y-Zt.y)*(qt.x-Zt.x),y)._round()),Zt.x>=T&&qt.x>=T||(Zt.x>=T?Zt=new ht(T,Zt.y+(T-Zt.x)/(qt.x-Zt.x)*(qt.y-Zt.y))._round():qt.x>=T&&(qt=new ht(T,Zt.y+(T-Zt.x)/(qt.x-Zt.x)*(qt.y-Zt.y))._round()),Zt.y>=O&&qt.y>=O||(Zt.y>=O?Zt=new ht(Zt.x+(O-Zt.y)/(qt.y-Zt.y)*(qt.x-Zt.x),O)._round():qt.y>=O&&(qt=new ht(Zt.x+(O-Zt.y)/(qt.y-Zt.y)*(qt.x-Zt.x),O)._round()),dt&&Zt.equals(dt[dt.length-1])||N.push(dt=[Zt]),dt.push(qt)))))}return N}function Tu(f,d,y,T){var O=[],N=f.image,Z=N.pixelRatio,q=N.paddedRect.w-2,dt=N.paddedRect.h-2,Pt=f.right-f.left,Zt=f.bottom-f.top,qt=N.stretchX||[[0,q]],pe=N.stretchY||[[0,dt]],Oe=function(To,ea){return To+ea[1]-ea[0]},sr=qt.reduce(Oe,0),lr=pe.reduce(Oe,0),Cr=q-sr,gr=dt-lr,Ur=0,Ar=sr,Dr=0,mn=lr,Fn=0,ni=Cr,ki=0,oa=gr;if(N.content&&T){var Di=N.content;Ur=Js(qt,0,Di[0]),Dr=Js(pe,0,Di[1]),Ar=Js(qt,Di[0],Di[2]),mn=Js(pe,Di[1],Di[3]),Fn=Di[0]-Ur,ki=Di[1]-Dr,ni=Di[2]-Di[0]-Ar,oa=Di[3]-Di[1]-mn}var ca=function(To,ea,Zo,Es){var uu=Jo(To.stretch-Ur,Ar,Pt,f.left),Ws=La(To.fixed-Fn,ni,To.stretch,sr),ks=Jo(ea.stretch-Dr,mn,Zt,f.top),eu=La(ea.fixed-ki,oa,ea.stretch,lr),Qu=Jo(Zo.stretch-Ur,Ar,Pt,f.left),lu=La(Zo.fixed-Fn,ni,Zo.stretch,sr),Gl=Jo(Es.stretch-Dr,mn,Zt,f.top),us=La(Es.fixed-ki,oa,Es.stretch,lr),Hl=new ht(uu,ks),mu=new ht(Qu,ks),cu=new ht(Qu,Gl),ro=new ht(uu,Gl),va=new ht(Ws/Z,eu/Z),ts=new ht(lu/Z,us/Z),Do=d*Math.PI/180;if(Do){var jl=Math.sin(Do),Uu=Math.cos(Do),Ss=[Uu,-jl,jl,Uu];Hl._matMult(Ss),mu._matMult(Ss),ro._matMult(Ss),cu._matMult(Ss)}var Pu=To.stretch+To.fixed,fu=ea.stretch+ea.fixed;return{tl:Hl,tr:mu,bl:ro,br:cu,tex:{x:N.paddedRect.x+1+Pu,y:N.paddedRect.y+1+fu,w:Zo.stretch+Zo.fixed-Pu,h:Es.stretch+Es.fixed-fu},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:va,pixelOffsetBR:ts,minFontScaleX:ni/Z/Pt,minFontScaleY:oa/Z/Zt,isSDF:y}};if(T&&(N.stretchX||N.stretchY))for(var zi=zu(qt,Cr,sr),Oa=zu(pe,gr,lr),xa=0;xa<zi.length-1;xa++)for(var Qi=zi[xa],lo=zi[xa+1],Ja=0;Ja<Oa.length-1;Ja++)O.push(ca(Qi,Oa[Ja],lo,Oa[Ja+1]));else O.push(ca({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:q+1},{fixed:0,stretch:dt+1}));return O}function Js(f,d,y){for(var T=0,O=0,N=f;O<N.length;O+=1){var Z=N[O];T+=Math.max(d,Math.min(y,Z[1]))-Math.max(d,Math.min(y,Z[0]))}return T}function zu(f,d,y){for(var T=[{fixed:-1,stretch:0}],O=0,N=f;O<N.length;O+=1){var Z=N[O],q=Z[0],dt=Z[1],Pt=T[T.length-1];T.push({fixed:q-Pt.stretch,stretch:Pt.stretch}),T.push({fixed:q-Pt.stretch,stretch:Pt.stretch+(dt-q)})}return T.push({fixed:d+1,stretch:y}),T}function Jo(f,d,y,T){return f/d*y+T}function La(f,d,y,T){return f-d*y/T}var tu=function(f,d,y,T,O,N,Z,q,dt,Pt){if(this.boxStartIndex=f.length,dt){var Zt=N.top,qt=N.bottom,pe=N.collisionPadding;pe&&(Zt-=pe[1],qt+=pe[3]);var Oe=qt-Zt;Oe>0&&(Oe=Math.max(10,Oe),this.circleDiameter=Oe)}else{var sr=N.top*Z-q,lr=N.bottom*Z+q,Cr=N.left*Z-q,gr=N.right*Z+q,Ur=N.collisionPadding;if(Ur&&(Cr-=Ur[0]*Z,sr-=Ur[1]*Z,gr+=Ur[2]*Z,lr+=Ur[3]*Z),Pt){var Ar=new ht(Cr,sr),Dr=new ht(gr,sr),mn=new ht(Cr,lr),Fn=new ht(gr,lr),ni=Pt*Math.PI/180;Ar._rotate(ni),Dr._rotate(ni),mn._rotate(ni),Fn._rotate(ni),Cr=Math.min(Ar.x,Dr.x,mn.x,Fn.x),gr=Math.max(Ar.x,Dr.x,mn.x,Fn.x),sr=Math.min(Ar.y,Dr.y,mn.y,Fn.y),lr=Math.max(Ar.y,Dr.y,mn.y,Fn.y)}f.emplaceBack(d.x,d.y,Cr,sr,gr,lr,y,T,O)}this.boxEndIndex=f.length},fo=function(f,d){if(f===void 0&&(f=[]),d===void 0&&(d=Mu),this.data=f,this.length=this.data.length,this.compare=d,this.length>0)for(var y=(this.length>>1)-1;y>=0;y--)this._down(y)};function Mu(f,d){return f<d?-1:f>d?1:0}function ya(f,d,y){d===void 0&&(d=1),y===void 0&&(y=!1);for(var T=1/0,O=1/0,N=-1/0,Z=-1/0,q=f[0],dt=0;dt<q.length;dt++){var Pt=q[dt];(!dt||Pt.x<T)&&(T=Pt.x),(!dt||Pt.y<O)&&(O=Pt.y),(!dt||Pt.x>N)&&(N=Pt.x),(!dt||Pt.y>Z)&&(Z=Pt.y)}var Zt=Math.min(N-T,Z-O),qt=Zt/2,pe=new fo([],eo);if(Zt===0)return new ht(T,O);for(var Oe=T;Oe<N;Oe+=Zt)for(var sr=O;sr<Z;sr+=Zt)pe.push(new Eo(Oe+qt,sr+qt,qt,f));for(var lr=function(Ur){for(var Ar=0,Dr=0,mn=0,Fn=Ur[0],ni=0,ki=Fn.length,oa=ki-1;ni<ki;oa=ni++){var Di=Fn[ni],ca=Fn[oa],zi=Di.x*ca.y-ca.x*Di.y;Dr+=(Di.x+ca.x)*zi,mn+=(Di.y+ca.y)*zi,Ar+=3*zi}return new Eo(Dr/Ar,mn/Ar,0,Ur)}(f),Cr=pe.length;pe.length;){var gr=pe.pop();(gr.d>lr.d||!lr.d)&&(lr=gr,y&&console.log("found best %d after %d probes",Math.round(1e4*gr.d)/1e4,Cr)),gr.max-lr.d<=d||(pe.push(new Eo(gr.p.x-(qt=gr.h/2),gr.p.y-qt,qt,f)),pe.push(new Eo(gr.p.x+qt,gr.p.y-qt,qt,f)),pe.push(new Eo(gr.p.x-qt,gr.p.y+qt,qt,f)),pe.push(new Eo(gr.p.x+qt,gr.p.y+qt,qt,f)),Cr+=4)}return y&&(console.log("num probes: "+Cr),console.log("best distance: "+lr.d)),lr.p}function eo(f,d){return d.max-f.max}function Eo(f,d,y,T){this.p=new ht(f,d),this.h=y,this.d=function(O,N){for(var Z=!1,q=1/0,dt=0;dt<N.length;dt++)for(var Pt=N[dt],Zt=0,qt=Pt.length,pe=qt-1;Zt<qt;pe=Zt++){var Oe=Pt[Zt],sr=Pt[pe];Oe.y>O.y!=sr.y>O.y&&O.x<(sr.x-Oe.x)*(O.y-Oe.y)/(sr.y-Oe.y)+Oe.x&&(Z=!Z),q=Math.min(q,_h(O,Oe,sr))}return(Z?1:-1)*Math.sqrt(q)}(this.p,T),this.max=this.d+this.h*Math.SQRT2}fo.prototype.push=function(f){this.data.push(f),this.length++,this._up(this.length-1)},fo.prototype.pop=function(){if(this.length!==0){var f=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),f}},fo.prototype.peek=function(){return this.data[0]},fo.prototype._up=function(f){for(var d=this.data,y=this.compare,T=d[f];f>0;){var O=f-1>>1,N=d[O];if(y(T,N)>=0)break;d[f]=N,f=O}d[f]=T},fo.prototype._down=function(f){for(var d=this.data,y=this.compare,T=this.length>>1,O=d[f];f<T;){var N=1+(f<<1),Z=d[N],q=N+1;if(q<this.length&&y(d[q],Z)<0&&(N=q,Z=d[q]),y(Z,O)>=0)break;d[f]=Z,f=N}d[f]=O};var So=Number.POSITIVE_INFINITY;function Po(f,d){return d[1]!==So?function(y,T,O){var N=0,Z=0;switch(T=Math.abs(T),O=Math.abs(O),y){case"top-right":case"top-left":case"top":Z=O-7;break;case"bottom-right":case"bottom-left":case"bottom":Z=7-O}switch(y){case"top-right":case"bottom-right":case"right":N=-T;break;case"top-left":case"bottom-left":case"left":N=T}return[N,Z]}(f,d[0],d[1]):function(y,T){var O=0,N=0;T<0&&(T=0);var Z=T/Math.sqrt(2);switch(y){case"top-right":case"top-left":N=Z-7;break;case"bottom-right":case"bottom-left":N=7-Z;break;case"bottom":N=7-T;break;case"top":N=T-7}switch(y){case"top-right":case"bottom-right":O=-Z;break;case"top-left":case"bottom-left":O=Z;break;case"left":O=T;break;case"right":O=-T}return[O,N]}(f,d[0])}function Ke(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function an(f,d,y,T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe,sr){var lr=function(Dr,mn,Fn,ni,ki,oa,Di,ca){for(var zi=ni.layout.get("text-rotate").evaluate(oa,{})*Math.PI/180,Oa=[],xa=0,Qi=mn.positionedLines;xa<Qi.length;xa+=1)for(var lo=Qi[xa],Ja=0,To=lo.positionedGlyphs;Ja<To.length;Ja+=1){var ea=To[Ja];if(ea.rect){var Zo=ea.rect||{},Es=4,uu=!0,Ws=1,ks=0,eu=(ki||ca)&&ea.vertical,Qu=ea.metrics.advance*ea.scale/2;if(ca&&mn.verticalizable&&(ks=lo.lineOffset/2-(ea.imageName?-(24-ea.metrics.width*ea.scale)/2:24*(ea.scale-1))),ea.imageName){var lu=Di[ea.imageName];uu=lu.sdf,Es=1/(Ws=lu.pixelRatio)}var Gl=ki?[ea.x+Qu,ea.y]:[0,0],us=ki?[0,0]:[ea.x+Qu+Fn[0],ea.y+Fn[1]-ks],Hl=[0,0];eu&&(Hl=us,us=[0,0]);var mu=(ea.metrics.left-Es)*ea.scale-Qu+us[0],cu=(-ea.metrics.top-Es)*ea.scale+us[1],ro=mu+Zo.w*ea.scale/Ws,va=cu+Zo.h*ea.scale/Ws,ts=new ht(mu,cu),Do=new ht(ro,cu),jl=new ht(mu,va),Uu=new ht(ro,va);if(eu){var Ss=new ht(-Qu,Qu- -17),Pu=-Math.PI/2,fu=12-Qu,Oo=new ht(22-fu,-(ea.imageName?fu:0)),cf=new(Function.prototype.bind.apply(ht,[null].concat(Hl)));ts._rotateAround(Pu,Ss)._add(Oo)._add(cf),Do._rotateAround(Pu,Ss)._add(Oo)._add(cf),jl._rotateAround(Pu,Ss)._add(Oo)._add(cf),Uu._rotateAround(Pu,Ss)._add(Oo)._add(cf)}if(zi){var ff=Math.sin(zi),nh=Math.cos(zi),ru=[nh,-ff,ff,nh];ts._matMult(ru),Do._matMult(ru),jl._matMult(ru),Uu._matMult(ru)}var kh=new ht(0,0),fl=new ht(0,0);Oa.push({tl:ts,tr:Do,bl:jl,br:Uu,tex:Zo,writingMode:mn.writingMode,glyphOffset:Gl,sectionIndex:ea.sectionIndex,isSDF:uu,pixelOffsetTL:kh,pixelOffsetBR:fl,minFontScaleX:0,minFontScaleY:0})}}return Oa}(0,y,q,O,N,Z,T,f.allowVerticalPlacement),Cr=f.textSizeData,gr=null;Cr.kind==="source"?(gr=[128*O.layout.get("text-size").evaluate(Z,{})])[0]>32640&&te(f.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Cr.kind==="composite"&&((gr=[128*Oe.compositeTextSizes[0].evaluate(Z,{},sr),128*Oe.compositeTextSizes[1].evaluate(Z,{},sr)])[0]>32640||gr[1]>32640)&&te(f.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),f.addSymbols(f.text,lr,gr,q,N,Z,Pt,d,dt.lineStartIndex,dt.lineLength,pe,sr);for(var Ur=0,Ar=Zt;Ur<Ar.length;Ur+=1)qt[Ar[Ur]]=f.text.placedSymbolArray.length-1;return 4*lr.length}function en(f){for(var d in f)return f[d];return null}function Ri(f,d,y,T){var O=f.compareText;if(d in O){for(var N=O[d],Z=N.length-1;Z>=0;Z--)if(T.dist(N[Z])<y)return!0}else O[d]=[];return O[d].push(T),!1}var so=rc.VectorTileFeature.types,$e=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Fe(f,d,y,T,O,N,Z,q,dt,Pt,Zt,qt,pe){var Oe=q?Math.min(32640,Math.round(q[0])):0,sr=q?Math.min(32640,Math.round(q[1])):0;f.emplaceBack(d,y,Math.round(32*T),Math.round(32*O),N,Z,(Oe<<1)+(dt?1:0),sr,16*Pt,16*Zt,256*qt,256*pe)}function yr(f,d,y){f.emplaceBack(d.x,d.y,y),f.emplaceBack(d.x,d.y,y),f.emplaceBack(d.x,d.y,y),f.emplaceBack(d.x,d.y,y)}function Xr(f){for(var d=0,y=f.sections;d<y.length;d+=1)if(jf(y[d].text))return!0;return!1}var sn=function(f){this.layoutVertexArray=new Xc,this.indexArray=new Rs,this.programConfigurations=f,this.segments=new De,this.dynamicLayoutVertexArray=new ll,this.opacityVertexArray=new Wf,this.placedSymbolArray=new M};sn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},sn.prototype.upload=function(f,d,y,T){this.isEmpty()||(y&&(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,Bd.members),this.indexBuffer=f.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=f.createVertexBuffer(this.dynamicLayoutVertexArray,X0.members,!0),this.opacityVertexBuffer=f.createVertexBuffer(this.opacityVertexArray,$e,!0),this.opacityVertexBuffer.itemSize=1),(y||T)&&this.programConfigurations.upload(f))},sn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Zi("SymbolBuffers",sn);var mr=function(f,d,y){this.layoutVertexArray=new f,this.layoutAttributes=d,this.indexArray=new y,this.segments=new De,this.collisionVertexArray=new Sd};mr.prototype.upload=function(f){this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=f.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=f.createVertexBuffer(this.collisionVertexArray,Yp.members,!0)},mr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Zi("CollisionBuffers",mr);var pr=function(f){this.collisionBoxArray=f.collisionBoxArray,this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(N){return N.id}),this.index=f.index,this.pixelRatio=f.pixelRatio,this.sourceLayerIndex=f.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Sl([]),this.placementViewportMatrix=Sl([]);var d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Li(this.zoom,d["text-size"]),this.iconSizeData=Li(this.zoom,d["icon-size"]);var y=this.layers[0].layout,T=y.get("symbol-sort-key"),O=y.get("symbol-z-order");this.canOverlap=y.get("text-allow-overlap")||y.get("icon-allow-overlap")||y.get("text-ignore-placement")||y.get("icon-ignore-placement"),this.sortFeaturesByKey=O!=="viewport-y"&&T.constantOr(1)!==void 0,this.sortFeaturesByY=(O==="viewport-y"||O==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,y.get("symbol-placement")==="point"&&(this.writingModes=y.get("text-writing-mode").map(function(N){return vi[N]})),this.stateDependentLayerIds=this.layers.filter(function(N){return N.isStateDependent()}).map(function(N){return N.id}),this.sourceID=f.sourceID};pr.prototype.createArrays=function(){this.text=new sn(new da(this.layers,this.zoom,function(f){return/^text/.test(f)})),this.icon=new sn(new da(this.layers,this.zoom,function(f){return/^icon/.test(f)})),this.glyphOffsetArray=new $,this.lineVertexArray=new ft,this.symbolInstances=new H},pr.prototype.calculateGlyphDependencies=function(f,d,y,T,O){for(var N=0;N<f.length;N++)if(d[f.charCodeAt(N)]=!0,(y||T)&&O){var Z=Nu[f.charAt(N)];Z&&(d[Z.charCodeAt(0)]=!0)}},pr.prototype.populate=function(f,d,y){var T=this.layers[0],O=T.layout,N=O.get("text-font"),Z=O.get("text-field"),q=O.get("icon-image"),dt=(Z.value.kind!=="constant"||Z.value.value instanceof Wo&&!Z.value.value.isEmpty()||Z.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),Pt=q.value.kind!=="constant"||!!q.value.value||Object.keys(q.parameters).length>0,Zt=O.get("symbol-sort-key");if(this.features=[],dt||Pt){for(var qt=d.iconDependencies,pe=d.glyphDependencies,Oe=d.availableImages,sr=new Ka(this.zoom),lr=0,Cr=f;lr<Cr.length;lr+=1){var gr=Cr[lr],Ur=gr.feature,Ar=gr.id,Dr=gr.index,mn=gr.sourceLayerIndex,Fn=T._featureFilter.needGeometry,ni=cs(Ur,Fn);if(T._featureFilter.filter(sr,ni,y)){Fn||(ni.geometry=ls(Ur));var ki=void 0;if(dt){var oa=T.getValueAndResolveTokens("text-field",ni,y,Oe),Di=Wo.factory(oa);Xr(Di)&&(this.hasRTLText=!0),(!this.hasRTLText||Ed()==="unavailable"||this.hasRTLText&&Ko.isParsed())&&(ki=Th(Di,T,ni))}var ca=void 0;if(Pt){var zi=T.getValueAndResolveTokens("icon-image",ni,y,Oe);ca=zi instanceof bo?zi:bo.fromString(zi)}if(ki||ca){var Oa=this.sortFeaturesByKey?Zt.evaluate(ni,{},y):void 0;if(this.features.push({id:Ar,text:ki,icon:ca,index:Dr,sourceLayerIndex:mn,geometry:ni.geometry,properties:Ur.properties,type:so[Ur.type],sortKey:Oa}),ca&&(qt[ca.name]=!0),ki){var xa=N.evaluate(ni,{},y).join(","),Qi=O.get("text-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(vi.vertical)>=0;for(var lo=0,Ja=ki.sections;lo<Ja.length;lo+=1){var To=Ja[lo];if(To.image)qt[To.image.name]=!0;else{var ea=Hf(ki.toString()),Zo=To.fontStack||xa,Es=pe[Zo]=pe[Zo]||{};this.calculateGlyphDependencies(To.text,Es,Qi,this.allowVerticalPlacement,ea)}}}}}}O.get("symbol-placement")==="line"&&(this.features=function(uu){var Ws={},ks={},eu=[],Qu=0;function lu(Ss){eu.push(uu[Ss]),Qu++}function Gl(Ss,Pu,fu){var Oo=ks[Ss];return delete ks[Ss],ks[Pu]=Oo,eu[Oo].geometry[0].pop(),eu[Oo].geometry[0]=eu[Oo].geometry[0].concat(fu[0]),Oo}function us(Ss,Pu,fu){var Oo=Ws[Pu];return delete Ws[Pu],Ws[Ss]=Oo,eu[Oo].geometry[0].shift(),eu[Oo].geometry[0]=fu[0].concat(eu[Oo].geometry[0]),Oo}function Hl(Ss,Pu,fu){var Oo=fu?Pu[0][Pu[0].length-1]:Pu[0][0];return Ss+":"+Oo.x+":"+Oo.y}for(var mu=0;mu<uu.length;mu++){var cu=uu[mu],ro=cu.geometry,va=cu.text?cu.text.toString():null;if(va){var ts=Hl(va,ro),Do=Hl(va,ro,!0);if(ts in ks&&Do in Ws&&ks[ts]!==Ws[Do]){var jl=us(ts,Do,ro),Uu=Gl(ts,Do,eu[jl].geometry);delete Ws[ts],delete ks[Do],ks[Hl(va,eu[Uu].geometry,!0)]=Uu,eu[jl].geometry=null}else ts in ks?Gl(ts,Do,ro):Do in Ws?us(ts,Do,ro):(lu(mu),Ws[ts]=Qu-1,ks[Do]=Qu-1)}else lu(mu)}return eu.filter(function(Ss){return Ss.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(uu,Ws){return uu.sortKey-Ws.sortKey})}},pr.prototype.update=function(f,d,y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(f,d,this.layers,y),this.icon.programConfigurations.updatePaintArrays(f,d,this.layers,y))},pr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},pr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},pr.prototype.upload=function(f){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(f),this.iconCollisionBox.upload(f)),this.text.upload(f,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(f,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},pr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},pr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},pr.prototype.addToLineVertexArray=function(f,d){var y=this.lineVertexArray.length;if(f.segment!==void 0){for(var T=f.dist(d[f.segment+1]),O=f.dist(d[f.segment]),N={},Z=f.segment+1;Z<d.length;Z++)N[Z]={x:d[Z].x,y:d[Z].y,tileUnitDistanceFromAnchor:T},Z<d.length-1&&(T+=d[Z+1].dist(d[Z]));for(var q=f.segment||0;q>=0;q--)N[q]={x:d[q].x,y:d[q].y,tileUnitDistanceFromAnchor:O},q>0&&(O+=d[q-1].dist(d[q]));for(var dt=0;dt<d.length;dt++){var Pt=N[dt];this.lineVertexArray.emplaceBack(Pt.x,Pt.y,Pt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:y,lineLength:this.lineVertexArray.length-y}},pr.prototype.addSymbols=function(f,d,y,T,O,N,Z,q,dt,Pt,Zt,qt){for(var pe=f.indexArray,Oe=f.layoutVertexArray,sr=f.segments.prepareSegment(4*d.length,Oe,pe,this.canOverlap?N.sortKey:void 0),lr=this.glyphOffsetArray.length,Cr=sr.vertexLength,gr=this.allowVerticalPlacement&&Z===vi.vertical?Math.PI/2:0,Ur=N.text&&N.text.sections,Ar=0;Ar<d.length;Ar++){var Dr=d[Ar],mn=Dr.tl,Fn=Dr.tr,ni=Dr.bl,ki=Dr.br,oa=Dr.tex,Di=Dr.pixelOffsetTL,ca=Dr.pixelOffsetBR,zi=Dr.minFontScaleX,Oa=Dr.minFontScaleY,xa=Dr.glyphOffset,Qi=Dr.isSDF,lo=Dr.sectionIndex,Ja=sr.vertexLength,To=xa[1];Fe(Oe,q.x,q.y,mn.x,To+mn.y,oa.x,oa.y,y,Qi,Di.x,Di.y,zi,Oa),Fe(Oe,q.x,q.y,Fn.x,To+Fn.y,oa.x+oa.w,oa.y,y,Qi,ca.x,Di.y,zi,Oa),Fe(Oe,q.x,q.y,ni.x,To+ni.y,oa.x,oa.y+oa.h,y,Qi,Di.x,ca.y,zi,Oa),Fe(Oe,q.x,q.y,ki.x,To+ki.y,oa.x+oa.w,oa.y+oa.h,y,Qi,ca.x,ca.y,zi,Oa),yr(f.dynamicLayoutVertexArray,q,gr),pe.emplaceBack(Ja,Ja+1,Ja+2),pe.emplaceBack(Ja+1,Ja+2,Ja+3),sr.vertexLength+=4,sr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(xa[0]),Ar!==d.length-1&&lo===d[Ar+1].sectionIndex||f.programConfigurations.populatePaintArrays(Oe.length,N,N.index,{},qt,Ur&&Ur[lo])}f.placedSymbolArray.emplaceBack(q.x,q.y,lr,this.glyphOffsetArray.length-lr,Cr,dt,Pt,q.segment,y?y[0]:0,y?y[1]:0,T[0],T[1],Z,0,!1,0,Zt)},pr.prototype._addCollisionDebugVertex=function(f,d,y,T,O,N){return d.emplaceBack(0,0),f.emplaceBack(y.x,y.y,T,O,Math.round(N.x),Math.round(N.y))},pr.prototype.addCollisionDebugVertices=function(f,d,y,T,O,N,Z){var q=O.segments.prepareSegment(4,O.layoutVertexArray,O.indexArray),dt=q.vertexLength,Pt=O.layoutVertexArray,Zt=O.collisionVertexArray,qt=Z.anchorX,pe=Z.anchorY;this._addCollisionDebugVertex(Pt,Zt,N,qt,pe,new ht(f,d)),this._addCollisionDebugVertex(Pt,Zt,N,qt,pe,new ht(y,d)),this._addCollisionDebugVertex(Pt,Zt,N,qt,pe,new ht(y,T)),this._addCollisionDebugVertex(Pt,Zt,N,qt,pe,new ht(f,T)),q.vertexLength+=4;var Oe=O.indexArray;Oe.emplaceBack(dt,dt+1),Oe.emplaceBack(dt+1,dt+2),Oe.emplaceBack(dt+2,dt+3),Oe.emplaceBack(dt+3,dt),q.primitiveLength+=4},pr.prototype.addDebugCollisionBoxes=function(f,d,y,T){for(var O=f;O<d;O++){var N=this.collisionBoxArray.get(O);this.addCollisionDebugVertices(N.x1,N.y1,N.x2,N.y2,T?this.textCollisionBox:this.iconCollisionBox,N.anchorPoint,y)}},pr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new mr(mh,n0.members,pc),this.iconCollisionBox=new mr(mh,n0.members,pc);for(var f=0;f<this.symbolInstances.length;f++){var d=this.symbolInstances.get(f);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}},pr.prototype._deserializeCollisionBoxesForSymbol=function(f,d,y,T,O,N,Z,q,dt){for(var Pt={},Zt=d;Zt<y;Zt++){var qt=f.get(Zt);Pt.textBox={x1:qt.x1,y1:qt.y1,x2:qt.x2,y2:qt.y2,anchorPointX:qt.anchorPointX,anchorPointY:qt.anchorPointY},Pt.textFeatureIndex=qt.featureIndex;break}for(var pe=T;pe<O;pe++){var Oe=f.get(pe);Pt.verticalTextBox={x1:Oe.x1,y1:Oe.y1,x2:Oe.x2,y2:Oe.y2,anchorPointX:Oe.anchorPointX,anchorPointY:Oe.anchorPointY},Pt.verticalTextFeatureIndex=Oe.featureIndex;break}for(var sr=N;sr<Z;sr++){var lr=f.get(sr);Pt.iconBox={x1:lr.x1,y1:lr.y1,x2:lr.x2,y2:lr.y2,anchorPointX:lr.anchorPointX,anchorPointY:lr.anchorPointY},Pt.iconFeatureIndex=lr.featureIndex;break}for(var Cr=q;Cr<dt;Cr++){var gr=f.get(Cr);Pt.verticalIconBox={x1:gr.x1,y1:gr.y1,x2:gr.x2,y2:gr.y2,anchorPointX:gr.anchorPointX,anchorPointY:gr.anchorPointY},Pt.verticalIconFeatureIndex=gr.featureIndex;break}return Pt},pr.prototype.deserializeCollisionBoxes=function(f){this.collisionArrays=[];for(var d=0;d<this.symbolInstances.length;d++){var y=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(f,y.textBoxStartIndex,y.textBoxEndIndex,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y.iconBoxStartIndex,y.iconBoxEndIndex,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex))}},pr.prototype.hasTextData=function(){return this.text.segments.get().length>0},pr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},pr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},pr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},pr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},pr.prototype.addIndicesForPlacedSymbol=function(f,d){for(var y=f.placedSymbolArray.get(d),T=y.vertexStartIndex+4*y.numGlyphs,O=y.vertexStartIndex;O<T;O+=4)f.indexArray.emplaceBack(O,O+1,O+2),f.indexArray.emplaceBack(O+1,O+2,O+3)},pr.prototype.getSortedSymbolIndexes=function(f){if(this.sortedAngle===f&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var d=Math.sin(f),y=Math.cos(f),T=[],O=[],N=[],Z=0;Z<this.symbolInstances.length;++Z){N.push(Z);var q=this.symbolInstances.get(Z);T.push(0|Math.round(d*q.anchorX+y*q.anchorY)),O.push(q.featureIndex)}return N.sort(function(dt,Pt){return T[dt]-T[Pt]||O[Pt]-O[dt]}),N},pr.prototype.addToSortKeyRanges=function(f,d){var y=this.sortKeyRanges[this.sortKeyRanges.length-1];y&&y.sortKey===d?y.symbolInstanceEnd=f+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:f,symbolInstanceEnd:f+1})},pr.prototype.sortFeatures=function(f){var d=this;if(this.sortFeaturesByY&&this.sortedAngle!==f&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(f),this.sortedAngle=f,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var y=0,T=this.symbolInstanceIndexes;y<T.length;y+=1){var O=this.symbolInstances.get(T[y]);this.featureSortOrder.push(O.featureIndex),[O.rightJustifiedTextSymbolIndex,O.centerJustifiedTextSymbolIndex,O.leftJustifiedTextSymbolIndex].forEach(function(N,Z,q){N>=0&&q.indexOf(N)===Z&&d.addIndicesForPlacedSymbol(d.text,N)}),O.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,O.verticalPlacedTextSymbolIndex),O.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,O.placedIconSymbolIndex),O.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,O.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Zi("SymbolBucket",pr,{omit:["layers","collisionBoxArray","features","compareText"]}),pr.MAX_GLYPHS=65535,pr.addDynamicAttributes=yr;var kr=new Ru({"symbol-placement":new Ki(Le.layout_symbol["symbol-placement"]),"symbol-spacing":new Ki(Le.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ki(Le.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Wi(Le.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ki(Le.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ki(Le.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ki(Le.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ki(Le.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ki(Le.layout_symbol["icon-rotation-alignment"]),"icon-size":new Wi(Le.layout_symbol["icon-size"]),"icon-text-fit":new Ki(Le.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ki(Le.layout_symbol["icon-text-fit-padding"]),"icon-image":new Wi(Le.layout_symbol["icon-image"]),"icon-rotate":new Wi(Le.layout_symbol["icon-rotate"]),"icon-padding":new Ki(Le.layout_symbol["icon-padding"]),"icon-keep-upright":new Ki(Le.layout_symbol["icon-keep-upright"]),"icon-offset":new Wi(Le.layout_symbol["icon-offset"]),"icon-anchor":new Wi(Le.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ki(Le.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ki(Le.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ki(Le.layout_symbol["text-rotation-alignment"]),"text-field":new Wi(Le.layout_symbol["text-field"]),"text-font":new Wi(Le.layout_symbol["text-font"]),"text-size":new Wi(Le.layout_symbol["text-size"]),"text-max-width":new Wi(Le.layout_symbol["text-max-width"]),"text-line-height":new Ki(Le.layout_symbol["text-line-height"]),"text-letter-spacing":new Wi(Le.layout_symbol["text-letter-spacing"]),"text-justify":new Wi(Le.layout_symbol["text-justify"]),"text-radial-offset":new Wi(Le.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ki(Le.layout_symbol["text-variable-anchor"]),"text-anchor":new Wi(Le.layout_symbol["text-anchor"]),"text-max-angle":new Ki(Le.layout_symbol["text-max-angle"]),"text-writing-mode":new Ki(Le.layout_symbol["text-writing-mode"]),"text-rotate":new Wi(Le.layout_symbol["text-rotate"]),"text-padding":new Ki(Le.layout_symbol["text-padding"]),"text-keep-upright":new Ki(Le.layout_symbol["text-keep-upright"]),"text-transform":new Wi(Le.layout_symbol["text-transform"]),"text-offset":new Wi(Le.layout_symbol["text-offset"]),"text-allow-overlap":new Ki(Le.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ki(Le.layout_symbol["text-ignore-placement"]),"text-optional":new Ki(Le.layout_symbol["text-optional"])}),Ve={paint:new Ru({"icon-opacity":new Wi(Le.paint_symbol["icon-opacity"]),"icon-color":new Wi(Le.paint_symbol["icon-color"]),"icon-halo-color":new Wi(Le.paint_symbol["icon-halo-color"]),"icon-halo-width":new Wi(Le.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Wi(Le.paint_symbol["icon-halo-blur"]),"icon-translate":new Ki(Le.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ki(Le.paint_symbol["icon-translate-anchor"]),"text-opacity":new Wi(Le.paint_symbol["text-opacity"]),"text-color":new Wi(Le.paint_symbol["text-color"],{runtimeType:hi,getOverride:function(f){return f.textColor},hasOverride:function(f){return!!f.textColor}}),"text-halo-color":new Wi(Le.paint_symbol["text-halo-color"]),"text-halo-width":new Wi(Le.paint_symbol["text-halo-width"]),"text-halo-blur":new Wi(Le.paint_symbol["text-halo-blur"]),"text-translate":new Ki(Le.paint_symbol["text-translate"]),"text-translate-anchor":new Ki(Le.paint_symbol["text-translate-anchor"])}),layout:kr},vr=function(f){this.type=f.property.overrides?f.property.overrides.runtimeType:wi,this.defaultValue=f};vr.prototype.evaluate=function(f){if(f.formattedSection){var d=this.defaultValue.property.overrides;if(d&&d.hasOverride(f.formattedSection))return d.getOverride(f.formattedSection)}return f.feature&&f.featureState?this.defaultValue.evaluate(f.feature,f.featureState):this.defaultValue.property.specification.default},vr.prototype.eachChild=function(f){this.defaultValue.isConstant()||f(this.defaultValue.value._styleExpression.expression)},vr.prototype.outputDefined=function(){return!1},vr.prototype.serialize=function(){return null},Zi("FormatSectionOverride",vr,{omit:["defaultValue"]});var Qe=function(f){function d(y){f.call(this,y,Ve)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.recalculate=function(y,T){if(f.prototype.recalculate.call(this,y,T),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var O=this.layout.get("text-writing-mode");if(O){for(var N=[],Z=0,q=O;Z<q.length;Z+=1){var dt=q[Z];N.indexOf(dt)<0&&N.push(dt)}this.layout._values["text-writing-mode"]=N}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},d.prototype.getValueAndResolveTokens=function(y,T,O,N){var Z=this.layout.get(y).evaluate(T,{},O,N),q=this._unevaluatedLayout._values[y];return q.isDataDriven()||Gc(q.value)||!Z?Z:function(dt,Pt){return Pt.replace(/{([^{}]+)}/g,function(Zt,qt){return qt in dt?String(dt[qt]):""})}(T.properties,Z)},d.prototype.createBucket=function(y){return new pr(y)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype._setPaintOverrides=function(){for(var y=0,T=Ve.paint.overridableProperties;y<T.length;y+=1){var O=T[y];if(d.hasPaintOverride(this.layout,O)){var N,Z=this.paint.get(O),q=new vr(Z),dt=new zf(q,Z.property.specification);N=Z.value.kind==="constant"||Z.value.kind==="source"?new Uf("source",dt):new lc("composite",dt,Z.value.zoomStops,Z.value._interpolationType),this.paint._values[O]=new wu(Z.property,N,Z.parameters)}}},d.prototype._handleOverridablePaintPropertyUpdate=function(y,T,O){return!(!this.layout||T.isDataDriven()||O.isDataDriven())&&d.hasPaintOverride(this.layout,y)},d.hasPaintOverride=function(y,T){var O=y.get("text-field"),N=Ve.paint.properties[T],Z=!1,q=function(Zt){for(var qt=0,pe=Zt;qt<pe.length;qt+=1)if(N.overrides&&N.overrides.hasOverride(pe[qt]))return void(Z=!0)};if(O.value.kind==="constant"&&O.value.value instanceof Wo)q(O.value.value.sections);else if(O.value.kind==="source"){var dt=function(Zt){Z||(Zt instanceof tn&&Ge(Zt.value)===po?q(Zt.value.sections):Zt instanceof ta?q(Zt.sections):Zt.eachChild(dt))},Pt=O.value;Pt._styleExpression&&dt(Pt._styleExpression.expression)}return Z},d}(bs),Hr={paint:new Ru({"background-color":new Ki(Le.paint_background["background-color"]),"background-pattern":new ol(Le.paint_background["background-pattern"]),"background-opacity":new Ki(Le.paint_background["background-opacity"])})},Jr=function(f){function d(y){f.call(this,y,Hr)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(bs),Bn={paint:new Ru({"raster-opacity":new Ki(Le.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ki(Le.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ki(Le.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ki(Le.paint_raster["raster-brightness-max"]),"raster-saturation":new Ki(Le.paint_raster["raster-saturation"]),"raster-contrast":new Ki(Le.paint_raster["raster-contrast"]),"raster-resampling":new Ki(Le.paint_raster["raster-resampling"]),"raster-fade-duration":new Ki(Le.paint_raster["raster-fade-duration"])})},gi=function(f){function d(y){f.call(this,y,Bn)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(bs),mi=function(f){function d(y){f.call(this,y,{}),this.implementation=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},d.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},d.prototype.recalculate=function(){},d.prototype.updateTransitions=function(){},d.prototype.hasTransition=function(){},d.prototype.serialize=function(){},d.prototype.onAdd=function(y){this.implementation.onAdd&&this.implementation.onAdd(y,y.painter.context.gl)},d.prototype.onRemove=function(y){this.implementation.onRemove&&this.implementation.onRemove(y,y.painter.context.gl)},d}(bs),pi={circle:Qc,heatmap:uv,hillshade:G0,fill:Pd,"fill-extrusion":nc,line:W0,symbol:Qe,background:Jr,raster:gi},fi=tt.HTMLImageElement,Xi=tt.HTMLCanvasElement,Pi=tt.HTMLVideoElement,Gi=tt.ImageData,kn=tt.ImageBitmap,Ni=function(f,d,y,T){this.context=f,this.format=y,this.texture=f.gl.createTexture(),this.update(d,T)};Ni.prototype.update=function(f,d,y){var T=f.width,O=f.height,N=!(this.size&&this.size[0]===T&&this.size[1]===O||y),Z=this.context,q=Z.gl;if(this.useMipmap=Boolean(d&&d.useMipmap),q.bindTexture(q.TEXTURE_2D,this.texture),Z.pixelStoreUnpackFlipY.set(!1),Z.pixelStoreUnpack.set(1),Z.pixelStoreUnpackPremultiplyAlpha.set(this.format===q.RGBA&&(!d||d.premultiply!==!1)),N)this.size=[T,O],f instanceof fi||f instanceof Xi||f instanceof Pi||f instanceof Gi||kn&&f instanceof kn?q.texImage2D(q.TEXTURE_2D,0,this.format,this.format,q.UNSIGNED_BYTE,f):q.texImage2D(q.TEXTURE_2D,0,this.format,T,O,0,this.format,q.UNSIGNED_BYTE,f.data);else{var dt=y||{x:0,y:0},Pt=dt.x,Zt=dt.y;f instanceof fi||f instanceof Xi||f instanceof Pi||f instanceof Gi||kn&&f instanceof kn?q.texSubImage2D(q.TEXTURE_2D,0,Pt,Zt,q.RGBA,q.UNSIGNED_BYTE,f):q.texSubImage2D(q.TEXTURE_2D,0,Pt,Zt,T,O,q.RGBA,q.UNSIGNED_BYTE,f.data)}this.useMipmap&&this.isSizePowerOfTwo()&&q.generateMipmap(q.TEXTURE_2D)},Ni.prototype.bind=function(f,d,y){var T=this.context.gl;T.bindTexture(T.TEXTURE_2D,this.texture),y!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(y=T.LINEAR),f!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,f),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,y||f),this.filter=f),d!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,d),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,d),this.wrap=d)},Ni.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ni.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Ea=function(f){var d=this;this._callback=f,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){d._triggered=!1,d._callback()})};Ea.prototype.trigger=function(){var f=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){f._triggered=!1,f._callback()},0))},Ea.prototype.remove=function(){delete this._channel,this._callback=function(){}};var jo=function(f,d,y){this.target=f,this.parent=d,this.mapId=y,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Mt(["receive","process"],this),this.invoker=new Ea(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Lt()?f:tt};function Iu(f,d,y){var T=2*Math.PI*6378137/256/Math.pow(2,y);return[f*T-2*Math.PI*6378137/2,d*T-2*Math.PI*6378137/2]}jo.prototype.send=function(f,d,y,T,O){var N=this;O===void 0&&(O=!1);var Z=Math.round(1e18*Math.random()).toString(36).substring(0,10);y&&(this.callbacks[Z]=y);var q=Ct(this.globalScope)?void 0:[];return this.target.postMessage({id:Z,type:f,hasCallback:!!y,targetMapId:T,mustQueue:O,sourceMapId:this.mapId,data:cc(d,q)},q),{cancel:function(){y&&delete N.callbacks[Z],N.target.postMessage({id:Z,type:"<cancel>",targetMapId:T,sourceMapId:N.mapId})}}},jo.prototype.receive=function(f){var d=f.data,y=d.id;if(y&&(!d.targetMapId||this.mapId===d.targetMapId))if(d.type==="<cancel>"){delete this.tasks[y];var T=this.cancelCallbacks[y];delete this.cancelCallbacks[y],T&&T()}else Lt()||d.mustQueue?(this.tasks[y]=d,this.taskQueue.push(y),this.invoker.trigger()):this.processTask(y,d)},jo.prototype.process=function(){if(this.taskQueue.length){var f=this.taskQueue.shift(),d=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),d&&this.processTask(f,d)}},jo.prototype.processTask=function(f,d){var y=this;if(d.type==="<response>"){var T=this.callbacks[f];delete this.callbacks[f],T&&(d.error?T(ml(d.error)):T(null,ml(d.data)))}else{var O=!1,N=Ct(this.globalScope)?void 0:[],Z=d.hasCallback?function(Zt,qt){O=!0,delete y.cancelCallbacks[f],y.target.postMessage({id:f,type:"<response>",sourceMapId:y.mapId,error:Zt?cc(Zt):null,data:cc(qt,N)},N)}:function(Zt){O=!0},q=null,dt=ml(d.data);if(this.parent[d.type])q=this.parent[d.type](d.sourceMapId,dt,Z);else if(this.parent.getWorkerSource){var Pt=d.type.split(".");q=this.parent.getWorkerSource(d.sourceMapId,Pt[0],dt.source)[Pt[1]](dt,Z)}else Z(new Error("Could not find function "+d.type));!O&&q&&q.cancel&&(this.cancelCallbacks[f]=q.cancel)}},jo.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var _a=function(f,d){f&&(d?this.setSouthWest(f).setNorthEast(d):f.length===4?this.setSouthWest([f[0],f[1]]).setNorthEast([f[2],f[3]]):this.setSouthWest(f[0]).setNorthEast(f[1]))};_a.prototype.setNorthEast=function(f){return this._ne=f instanceof mo?new mo(f.lng,f.lat):mo.convert(f),this},_a.prototype.setSouthWest=function(f){return this._sw=f instanceof mo?new mo(f.lng,f.lat):mo.convert(f),this},_a.prototype.extend=function(f){var d,y,T=this._sw,O=this._ne;if(f instanceof mo)d=f,y=f;else{if(!(f instanceof _a))return Array.isArray(f)?f.length===4||f.every(Array.isArray)?this.extend(_a.convert(f)):this.extend(mo.convert(f)):this;if(y=f._ne,!(d=f._sw)||!y)return this}return T||O?(T.lng=Math.min(d.lng,T.lng),T.lat=Math.min(d.lat,T.lat),O.lng=Math.max(y.lng,O.lng),O.lat=Math.max(y.lat,O.lat)):(this._sw=new mo(d.lng,d.lat),this._ne=new mo(y.lng,y.lat)),this},_a.prototype.getCenter=function(){return new mo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},_a.prototype.getSouthWest=function(){return this._sw},_a.prototype.getNorthEast=function(){return this._ne},_a.prototype.getNorthWest=function(){return new mo(this.getWest(),this.getNorth())},_a.prototype.getSouthEast=function(){return new mo(this.getEast(),this.getSouth())},_a.prototype.getWest=function(){return this._sw.lng},_a.prototype.getSouth=function(){return this._sw.lat},_a.prototype.getEast=function(){return this._ne.lng},_a.prototype.getNorth=function(){return this._ne.lat},_a.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},_a.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},_a.prototype.isEmpty=function(){return!(this._sw&&this._ne)},_a.prototype.contains=function(f){var d=mo.convert(f),y=d.lng,T=d.lat,O=this._sw.lng<=y&&y<=this._ne.lng;return this._sw.lng>this._ne.lng&&(O=this._sw.lng>=y&&y>=this._ne.lng),this._sw.lat<=T&&T<=this._ne.lat&&O},_a.convert=function(f){return!f||f instanceof _a?f:new _a(f)};var mo=function(f,d){if(isNaN(f)||isNaN(d))throw new Error("Invalid LngLat object: ("+f+", "+d+")");if(this.lng=+f,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};mo.prototype.wrap=function(){return new mo(P(this.lng,-180,180),this.lat)},mo.prototype.toArray=function(){return[this.lng,this.lat]},mo.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},mo.prototype.distanceTo=function(f){var d=Math.PI/180,y=this.lat*d,T=f.lat*d,O=Math.sin(y)*Math.sin(T)+Math.cos(y)*Math.cos(T)*Math.cos((f.lng-this.lng)*d);return 63710088e-1*Math.acos(Math.min(O,1))},mo.prototype.toBounds=function(f){f===void 0&&(f=0);var d=360*f/40075017,y=d/Math.cos(Math.PI/180*this.lat);return new _a(new mo(this.lng-y,this.lat-d),new mo(this.lng+y,this.lat+d))},mo.convert=function(f){if(f instanceof mo)return f;if(Array.isArray(f)&&(f.length===2||f.length===3))return new mo(Number(f[0]),Number(f[1]));if(!Array.isArray(f)&&typeof f=="object"&&f!==null)return new mo(Number("lng"in f?f.lng:f.lon),Number(f.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Oc=2*Math.PI*63710088e-1;function Al(f){return Oc*Math.cos(f*Math.PI/180)}function lf(f){return(180+f)/360}function Zl(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function Y0(f,d){return f/Al(d)}function Ll(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}var rh=function(f,d,y){y===void 0&&(y=0),this.x=+f,this.y=+d,this.z=+y};rh.fromLngLat=function(f,d){d===void 0&&(d=0);var y=mo.convert(f);return new rh(lf(y.lng),Zl(y.lat),Y0(d,y.lat))},rh.prototype.toLngLat=function(){return new mo(360*this.x-180,Ll(this.y))},rh.prototype.toAltitude=function(){return this.z*Al(Ll(this.y))},rh.prototype.meterInMercatorCoordinateUnits=function(){return 1/Oc*(f=Ll(this.y),1/Math.cos(f*Math.PI/180));var f};var cp=function(f,d,y){this.z=f,this.x=d,this.y=y,this.key=mv(0,f,f,d,y)};cp.prototype.equals=function(f){return this.z===f.z&&this.x===f.x&&this.y===f.y},cp.prototype.url=function(f,d){var y,T,O,N,Z,q=(T=this.y,O=this.z,N=Iu(256*(y=this.x),256*(T=Math.pow(2,O)-T-1),O),Z=Iu(256*(y+1),256*(T+1),O),N[0]+","+N[1]+","+Z[0]+","+Z[1]),dt=function(Pt,Zt,qt){for(var pe,Oe="",sr=Pt;sr>0;sr--)Oe+=(Zt&(pe=1<<sr-1)?1:0)+(qt&pe?2:0);return Oe}(this.z,this.x,this.y);return f[(this.x+this.y)%f.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",dt).replace("{bbox-epsg-3857}",q)},cp.prototype.getTilePoint=function(f){var d=Math.pow(2,this.z);return new ht(8192*(f.x*d-this.x),8192*(f.y*d-this.y))},cp.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var gv=function(f,d){this.wrap=f,this.canonical=d,this.key=mv(f,d.z,d.z,d.x,d.y)},ku=function(f,d,y,T,O){this.overscaledZ=f,this.wrap=d,this.canonical=new cp(y,+T,+O),this.key=mv(d,f,y,T,O)};function mv(f,d,y,T,O){(f*=2)<0&&(f=-1*f-1);var N=1<<y;return(N*N*f+N*O+T).toString(36)+y.toString(36)+d.toString(36)}ku.prototype.equals=function(f){return this.overscaledZ===f.overscaledZ&&this.wrap===f.wrap&&this.canonical.equals(f.canonical)},ku.prototype.scaledTo=function(f){var d=this.canonical.z-f;return f>this.canonical.z?new ku(f,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ku(f,this.wrap,f,this.canonical.x>>d,this.canonical.y>>d)},ku.prototype.calculateScaledKey=function(f,d){var y=this.canonical.z-f;return f>this.canonical.z?mv(this.wrap*+d,f,this.canonical.z,this.canonical.x,this.canonical.y):mv(this.wrap*+d,f,f,this.canonical.x>>y,this.canonical.y>>y)},ku.prototype.isChildOf=function(f){if(f.wrap!==this.wrap)return!1;var d=this.canonical.z-f.canonical.z;return f.overscaledZ===0||f.overscaledZ<this.overscaledZ&&f.canonical.x===this.canonical.x>>d&&f.canonical.y===this.canonical.y>>d},ku.prototype.children=function(f){if(this.overscaledZ>=f)return[new ku(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var d=this.canonical.z+1,y=2*this.canonical.x,T=2*this.canonical.y;return[new ku(d,this.wrap,d,y,T),new ku(d,this.wrap,d,y+1,T),new ku(d,this.wrap,d,y,T+1),new ku(d,this.wrap,d,y+1,T+1)]},ku.prototype.isLessThan=function(f){return this.wrap<f.wrap||!(this.wrap>f.wrap)&&(this.overscaledZ<f.overscaledZ||!(this.overscaledZ>f.overscaledZ)&&(this.canonical.x<f.canonical.x||!(this.canonical.x>f.canonical.x)&&this.canonical.y<f.canonical.y))},ku.prototype.wrapped=function(){return new ku(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ku.prototype.unwrapTo=function(f){return new ku(this.overscaledZ,f,this.canonical.z,this.canonical.x,this.canonical.y)},ku.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ku.prototype.toUnwrapped=function(){return new gv(this.wrap,this.canonical)},ku.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ku.prototype.getTilePoint=function(f){return this.canonical.getTilePoint(new rh(f.x-this.wrap,f.y))},Zi("CanonicalTileID",cp),Zi("OverscaledTileID",ku,{omit:["posMatrix"]});var Mh=function(f,d,y){if(this.uid=f,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(y&&y!=="mapbox"&&y!=="terrarium")return te('"'+y+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=d.height;var T=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=y||"mapbox";for(var O=0;O<T;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(T,O)]=this.data[this._idx(T-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,T)]=this.data[this._idx(O,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)]};Mh.prototype.get=function(f,d){var y=new Uint8Array(this.data.buffer),T=4*this._idx(f,d);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(y[T],y[T+1],y[T+2])},Mh.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Mh.prototype._idx=function(f,d){if(f<-1||f>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(f+1)},Mh.prototype._unpackMapbox=function(f,d,y){return(256*f*256+256*d+y)/10-1e4},Mh.prototype._unpackTerrarium=function(f,d,y){return 256*f+d+y/256-32768},Mh.prototype.getPixels=function(){return new Cu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Mh.prototype.backfillBorder=function(f,d,y){if(this.dim!==f.dim)throw new Error("dem dimension mismatch");var T=d*this.dim,O=d*this.dim+this.dim,N=y*this.dim,Z=y*this.dim+this.dim;switch(d){case-1:T=O-1;break;case 1:O=T+1}switch(y){case-1:N=Z-1;break;case 1:Z=N+1}for(var q=-d*this.dim,dt=-y*this.dim,Pt=N;Pt<Z;Pt++)for(var Zt=T;Zt<O;Zt++)this.data[this._idx(Zt,Pt)]=f.data[this._idx(Zt+q,Pt+dt)]},Zi("DEMData",Mh);var i0=function(f){this._stringToNumber={},this._numberToString=[];for(var d=0;d<f.length;d++){var y=f[d];this._stringToNumber[y]=d,this._numberToString[d]=y}};i0.prototype.encode=function(f){return this._stringToNumber[f]},i0.prototype.decode=function(f){return this._numberToString[f]};var $0=function(f,d,y,T,O){this.type="Feature",this._vectorTileFeature=f,f._z=d,f._x=y,f._y=T,this.properties=f.properties,this.id=O},Zg={geometry:{configurable:!0}};Zg.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Zg.geometry.set=function(f){this._geometry=f},$0.prototype.toJSON=function(){var f={geometry:this.geometry};for(var d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(f[d]=this[d]);return f},Object.defineProperties($0.prototype,Zg);var Kp=function(){this.state={},this.stateChanges={},this.deletedStates={}};Kp.prototype.updateState=function(f,d,y){var T=String(d);if(this.stateChanges[f]=this.stateChanges[f]||{},this.stateChanges[f][T]=this.stateChanges[f][T]||{},b(this.stateChanges[f][T],y),this.deletedStates[f]===null)for(var O in this.deletedStates[f]={},this.state[f])O!==T&&(this.deletedStates[f][O]=null);else if(this.deletedStates[f]&&this.deletedStates[f][T]===null)for(var N in this.deletedStates[f][T]={},this.state[f][T])y[N]||(this.deletedStates[f][T][N]=null);else for(var Z in y)this.deletedStates[f]&&this.deletedStates[f][T]&&this.deletedStates[f][T][Z]===null&&delete this.deletedStates[f][T][Z]},Kp.prototype.removeFeatureState=function(f,d,y){if(this.deletedStates[f]!==null){var T=String(d);if(this.deletedStates[f]=this.deletedStates[f]||{},y&&d!==void 0)this.deletedStates[f][T]!==null&&(this.deletedStates[f][T]=this.deletedStates[f][T]||{},this.deletedStates[f][T][y]=null);else if(d!==void 0)if(this.stateChanges[f]&&this.stateChanges[f][T])for(y in this.deletedStates[f][T]={},this.stateChanges[f][T])this.deletedStates[f][T][y]=null;else this.deletedStates[f][T]=null;else this.deletedStates[f]=null}},Kp.prototype.getState=function(f,d){var y=String(d),T=b({},(this.state[f]||{})[y],(this.stateChanges[f]||{})[y]);if(this.deletedStates[f]===null)return{};if(this.deletedStates[f]){var O=this.deletedStates[f][d];if(O===null)return{};for(var N in O)delete T[N]}return T},Kp.prototype.initializeTileState=function(f,d){f.setFeatureState(this.state,d)},Kp.prototype.coalesceChanges=function(f,d){var y={};for(var T in this.stateChanges){this.state[T]=this.state[T]||{};var O={};for(var N in this.stateChanges[T])this.state[T][N]||(this.state[T][N]={}),b(this.state[T][N],this.stateChanges[T][N]),O[N]=this.state[T][N];y[T]=O}for(var Z in this.deletedStates){this.state[Z]=this.state[Z]||{};var q={};if(this.deletedStates[Z]===null)for(var dt in this.state[Z])q[dt]={},this.state[Z][dt]={};else for(var Pt in this.deletedStates[Z]){if(this.deletedStates[Z][Pt]===null)this.state[Z][Pt]={};else for(var Zt=0,qt=Object.keys(this.deletedStates[Z][Pt]);Zt<qt.length;Zt+=1)delete this.state[Z][Pt][qt[Zt]];q[Pt]=this.state[Z][Pt]}y[Z]=y[Z]||{},b(y[Z],q)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(var pe in f)f[pe].setFeatureState(y,d)};var Ih=function(f,d){this.tileID=f,this.x=f.canonical.x,this.y=f.canonical.y,this.z=f.canonical.z,this.grid=new Ef(8192,16,0),this.grid3D=new Ef(8192,16,0),this.featureIndexArray=new ee,this.promoteId=d};function jm(f,d,y,T,O){return Dt(f,function(N,Z){var q=d instanceof Il?d.get(Z):null;return q&&q.evaluate?q.evaluate(y,T,O):q})}function Vg(f){for(var d=1/0,y=1/0,T=-1/0,O=-1/0,N=0,Z=f;N<Z.length;N+=1){var q=Z[N];d=Math.min(d,q.x),y=Math.min(y,q.y),T=Math.max(T,q.x),O=Math.max(O,q.y)}return{minX:d,minY:y,maxX:T,maxY:O}}function Gg(f,d){return d-f}Ih.prototype.insert=function(f,d,y,T,O,N){var Z=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(y,T,O);for(var q=N?this.grid3D:this.grid,dt=0;dt<d.length;dt++){for(var Pt=d[dt],Zt=[1/0,1/0,-1/0,-1/0],qt=0;qt<Pt.length;qt++){var pe=Pt[qt];Zt[0]=Math.min(Zt[0],pe.x),Zt[1]=Math.min(Zt[1],pe.y),Zt[2]=Math.max(Zt[2],pe.x),Zt[3]=Math.max(Zt[3],pe.y)}Zt[0]<8192&&Zt[1]<8192&&Zt[2]>=0&&Zt[3]>=0&&q.insert(Z,Zt[0],Zt[1],Zt[2],Zt[3])}},Ih.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new rc.VectorTile(new th(this.rawTileData)).layers,this.sourceLayerCoder=new i0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ih.prototype.query=function(f,d,y,T){var O=this;this.loadVTLayers();for(var N=f.params||{},Z=8192/f.tileSize/f.scale,q=Op(N.filter),dt=f.queryGeometry,Pt=f.queryPadding*Z,Zt=Vg(dt),qt=this.grid.query(Zt.minX-Pt,Zt.minY-Pt,Zt.maxX+Pt,Zt.maxY+Pt),pe=Vg(f.cameraQueryGeometry),Oe=this.grid3D.query(pe.minX-Pt,pe.minY-Pt,pe.maxX+Pt,pe.maxY+Pt,function(Dr,mn,Fn,ni){return function(ki,oa,Di,ca,zi){for(var Oa=0,xa=ki;Oa<xa.length;Oa+=1){var Qi=xa[Oa];if(oa<=Qi.x&&Di<=Qi.y&&ca>=Qi.x&&zi>=Qi.y)return!0}var lo=[new ht(oa,Di),new ht(oa,zi),new ht(ca,zi),new ht(ca,Di)];if(ki.length>2){for(var Ja=0,To=lo;Ja<To.length;Ja+=1)if(dc(ki,To[Ja]))return!0}for(var ea=0;ea<ki.length-1;ea++)if(xh(ki[ea],ki[ea+1],lo))return!0;return!1}(f.cameraQueryGeometry,Dr-Pt,mn-Pt,Fn+Pt,ni+Pt)}),sr=0,lr=Oe;sr<lr.length;sr+=1)qt.push(lr[sr]);qt.sort(Gg);for(var Cr,gr={},Ur=function(Dr){var mn=qt[Dr];if(mn!==Cr){Cr=mn;var Fn=O.featureIndexArray.get(mn),ni=null;O.loadMatchingFeature(gr,Fn.bucketIndex,Fn.sourceLayerIndex,Fn.featureIndex,q,N.layers,N.availableImages,d,y,T,function(ki,oa,Di){return ni||(ni=ls(ki)),oa.queryIntersectsFeature(dt,ki,Di,ni,O.z,f.transform,Z,f.pixelPosMatrix)})}},Ar=0;Ar<qt.length;Ar++)Ur(Ar);return gr},Ih.prototype.loadMatchingFeature=function(f,d,y,T,O,N,Z,q,dt,Pt,Zt){var qt=this.bucketLayerIDs[d];if(!N||function(ki,oa){for(var Di=0;Di<ki.length;Di++)if(oa.indexOf(ki[Di])>=0)return!0;return!1}(N,qt)){var pe=this.sourceLayerCoder.decode(y),Oe=this.vtLayers[pe].feature(T);if(O.needGeometry){var sr=cs(Oe,!0);if(!O.filter(new Ka(this.tileID.overscaledZ),sr,this.tileID.canonical))return}else if(!O.filter(new Ka(this.tileID.overscaledZ),Oe))return;for(var lr=this.getId(Oe,pe),Cr=0;Cr<qt.length;Cr++){var gr=qt[Cr];if(!(N&&N.indexOf(gr)<0)){var Ur=q[gr];if(Ur){var Ar={};lr!==void 0&&Pt&&(Ar=Pt.getState(Ur.sourceLayer||"_geojsonTileLayer",lr));var Dr=b({},dt[gr]);Dr.paint=jm(Dr.paint,Ur.paint,Oe,Ar,Z),Dr.layout=jm(Dr.layout,Ur.layout,Oe,Ar,Z);var mn=!Zt||Zt(Oe,Ur,Ar);if(mn){var Fn=new $0(Oe,this.z,this.x,this.y,lr);Fn.layer=Dr;var ni=f[gr];ni===void 0&&(ni=f[gr]=[]),ni.push({featureIndex:T,feature:Fn,intersectionZ:mn})}}}}}},Ih.prototype.lookupSymbolFeatures=function(f,d,y,T,O,N,Z,q){var dt={};this.loadVTLayers();for(var Pt=Op(O),Zt=0,qt=f;Zt<qt.length;Zt+=1)this.loadMatchingFeature(dt,y,T,qt[Zt],Pt,N,Z,q,d);return dt},Ih.prototype.hasLayer=function(f){for(var d=0,y=this.bucketLayerIDs;d<y.length;d+=1)for(var T=0,O=y[d];T<O.length;T+=1)if(f===O[T])return!0;return!1},Ih.prototype.getId=function(f,d){var y=f.id;return this.promoteId&&typeof(y=f.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]])=="boolean"&&(y=Number(y)),y},Zi("FeatureIndex",Ih,{omit:["rawTileData","sourceLayerCoder"]});var Lu=function(f,d){this.tileID=f,this.uid=fe(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Lu.prototype.registerFadeDuration=function(f){var d=f+this.timeAdded;d<Me.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)},Lu.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Lu.prototype.loadVectorData=function(f,d,y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",f){for(var T in f.featureIndex&&(this.latestFeatureIndex=f.featureIndex,f.rawTileData?(this.latestRawTileData=f.rawTileData,this.latestFeatureIndex.rawTileData=f.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=f.collisionBoxArray,this.buckets=function(Pt,Zt){var qt={};if(!Zt)return qt;for(var pe=function(){var lr=sr[Oe],Cr=lr.layerIds.map(function(Ar){return Zt.getLayer(Ar)}).filter(Boolean);if(Cr.length!==0){lr.layers=Cr,lr.stateDependentLayerIds&&(lr.stateDependentLayers=lr.stateDependentLayerIds.map(function(Ar){return Cr.filter(function(Dr){return Dr.id===Ar})[0]}));for(var gr=0,Ur=Cr;gr<Ur.length;gr+=1)qt[Ur[gr].id]=lr}},Oe=0,sr=Pt;Oe<sr.length;Oe+=1)pe();return qt}(f.buckets,d.style),this.hasSymbolBuckets=!1,this.buckets){var O=this.buckets[T];if(O instanceof pr){if(this.hasSymbolBuckets=!0,!y)break;O.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var N in this.buckets){var Z=this.buckets[N];if(Z instanceof pr&&Z.hasRTLText){this.hasRTLText=!0,Ko.isLoading()||Ko.isLoaded()||Ed()!=="deferred"||Ml();break}}for(var q in this.queryPadding=0,this.buckets){var dt=this.buckets[q];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(q).queryRadius(dt))}f.imageAtlas&&(this.imageAtlas=f.imageAtlas),f.glyphAtlasImage&&(this.glyphAtlasImage=f.glyphAtlasImage)}else this.collisionBoxArray=new C},Lu.prototype.unloadVectorData=function(){for(var f in this.buckets)this.buckets[f].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Lu.prototype.getBucket=function(f){return this.buckets[f.id]},Lu.prototype.upload=function(f){for(var d in this.buckets){var y=this.buckets[d];y.uploadPending()&&y.upload(f)}var T=f.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ni(f,this.imageAtlas.image,T.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ni(f,this.glyphAtlasImage,T.ALPHA),this.glyphAtlasImage=null)},Lu.prototype.prepare=function(f){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(f,this.imageAtlasTexture)},Lu.prototype.queryRenderedFeatures=function(f,d,y,T,O,N,Z,q,dt,Pt){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:T,cameraQueryGeometry:O,scale:N,tileSize:this.tileSize,pixelPosMatrix:Pt,transform:q,params:Z,queryPadding:this.queryPadding*dt},f,d,y):{}},Lu.prototype.querySourceFeatures=function(f,d){var y=this.latestFeatureIndex;if(y&&y.rawTileData){var T=y.loadVTLayers(),O=d?d.sourceLayer:"",N=T._geojsonTileLayer||T[O];if(N)for(var Z=Op(d&&d.filter),q=this.tileID.canonical,dt=q.z,Pt=q.x,Zt=q.y,qt={z:dt,x:Pt,y:Zt},pe=0;pe<N.length;pe++){var Oe=N.feature(pe);if(Z.needGeometry){var sr=cs(Oe,!0);if(!Z.filter(new Ka(this.tileID.overscaledZ),sr,this.tileID.canonical))continue}else if(!Z.filter(new Ka(this.tileID.overscaledZ),Oe))continue;var lr=y.getId(Oe,O),Cr=new $0(Oe,dt,Pt,Zt,lr);Cr.tile=qt,f.push(Cr)}}},Lu.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Lu.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Lu.prototype.setExpiryData=function(f){var d=this.expirationTime;if(f.cacheControl){var y=Qt(f.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else f.expires&&(this.expirationTime=new Date(f.expires).getTime());if(this.expirationTime){var T=Date.now(),O=!1;if(this.expirationTime>T)O=!1;else if(d)if(this.expirationTime<d)O=!0;else{var N=this.expirationTime-d;N?this.expirationTime=T+Math.max(N,3e4):O=!0}else O=!0;O?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Lu.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Lu.prototype.setFeatureState=function(f,d){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(f).length!==0){var y=this.latestFeatureIndex.loadVTLayers();for(var T in this.buckets)if(d.style.hasLayer(T)){var O=this.buckets[T],N=O.layers[0].sourceLayer||"_geojsonTileLayer",Z=y[N],q=f[N];if(Z&&q&&Object.keys(q).length!==0){O.update(q,Z,this.imageAtlas&&this.imageAtlas.patternPositions||{});var dt=d&&d.style&&d.style.getLayer(T);dt&&(this.queryPadding=Math.max(this.queryPadding,dt.queryRadius(O)))}}}},Lu.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Lu.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Me.now()},Lu.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Lu.prototype.setHoldDuration=function(f){this.symbolFadeHoldUntil=Me.now()+f},Lu.prototype.setDependencies=function(f,d){for(var y={},T=0,O=d;T<O.length;T+=1)y[O[T]]=!0;this.dependencies[f]=y},Lu.prototype.hasDependency=function(f,d){for(var y=0,T=f;y<T.length;y+=1){var O=this.dependencies[T[y]];if(O){for(var N=0,Z=d;N<Z.length;N+=1)if(O[Z[N]])return!0}}return!1};var Vl=tt.performance,q0=function(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},Vl.mark(this._marks.start)};q0.prototype.finish=function(){Vl.mark(this._marks.end);var f=Vl.getEntriesByName(this._marks.measure);return f.length===0&&(Vl.measure(this._marks.measure,this._marks.start,this._marks.end),f=Vl.getEntriesByName(this._marks.measure),Vl.clearMarks(this._marks.start),Vl.clearMarks(this._marks.end),Vl.clearMeasures(this._marks.measure)),f},I.Actor=jo,I.AlphaImage=kl,I.CanonicalTileID=cp,I.CollisionBoxArray=C,I.Color=to,I.DEMData=Mh,I.DataConstantProperty=Ki,I.DictionaryCoder=i0,I.EXTENT=8192,I.ErrorEvent=fr,I.EvaluationParameters=Ka,I.Event=ze,I.Evented=wr,I.FeatureIndex=Ih,I.FillBucket=Ul,I.FillExtrusionBucket=sf,I.ImageAtlas=Xn,I.ImagePosition=Gr,I.LineBucket=Ro,I.LngLat=mo,I.LngLatBounds=_a,I.MercatorCoordinate=rh,I.ONE_EM=24,I.OverscaledTileID=ku,I.Point=ht,I.Point$1=ht,I.Properties=Ru,I.Protobuf=th,I.RGBAImage=Cu,I.RequestManager=$t,I.RequestPerformance=q0,I.ResourceType=Zr,I.SegmentVector=De,I.SourceFeatureState=Kp,I.StructArrayLayout1ui2=zp,I.StructArrayLayout2f1f2i16=Xf,I.StructArrayLayout2i4=Wc,I.StructArrayLayout3ui6=Rs,I.StructArrayLayout4i8=hc,I.SymbolBucket=pr,I.Texture=Ni,I.Tile=Lu,I.Transitionable=Ts,I.Uniform1f=Kn,I.Uniform1i=Zn,I.Uniform2f=ci,I.Uniform3f=Oi,I.Uniform4f=na,I.UniformColor=ia,I.UniformMatrix4f=Qa,I.UnwrappedTileID=gv,I.ValidationError=ur,I.WritingMode=vi,I.ZoomHistory=Dp,I.add=function(f,d,y){return f[0]=d[0]+y[0],f[1]=d[1]+y[1],f[2]=d[2]+y[2],f},I.addDynamicAttributes=yr,I.asyncAll=function(f,d,y){if(!f.length)return y(null,[]);var T=f.length,O=new Array(f.length),N=null;f.forEach(function(Z,q){d(Z,function(dt,Pt){dt&&(N=dt),O[q]=Pt,--T==0&&y(N,O)})})},I.bezier=it,I.bindAll=Mt,I.browser=Me,I.cacheEntryPossiblyAdded=function(f){++Br>He&&(f.getActor().send("enforceCacheSizeLimit",Ae),Br=0)},I.clamp=Ut,I.clearTileCache=function(f){var d=tt.caches.delete("mapbox-tiles");f&&d.catch(f).then(function(){return f()})},I.clipLine=su,I.clone=function(f){var d=new Lo(16);return d[0]=f[0],d[1]=f[1],d[2]=f[2],d[3]=f[3],d[4]=f[4],d[5]=f[5],d[6]=f[6],d[7]=f[7],d[8]=f[8],d[9]=f[9],d[10]=f[10],d[11]=f[11],d[12]=f[12],d[13]=f[13],d[14]=f[14],d[15]=f[15],d},I.clone$1=_e,I.clone$2=function(f){var d=new Lo(3);return d[0]=f[0],d[1]=f[1],d[2]=f[2],d},I.collisionCircleLayout=ic,I.config=ae,I.create=function(){var f=new Lo(16);return Lo!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},I.create$1=function(){var f=new Lo(9);return Lo!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f},I.create$2=function(){var f=new Lo(4);return Lo!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f},I.createCommonjsModule=xt,I.createExpression=vh,I.createLayout=os,I.createStyleLayer=function(f){return f.type==="custom"?new mi(f):new pi[f.type](f)},I.cross=function(f,d,y){var T=d[0],O=d[1],N=d[2],Z=y[0],q=y[1],dt=y[2];return f[0]=O*dt-N*q,f[1]=N*Z-T*dt,f[2]=T*q-O*Z,f},I.deepEqual=function f(d,y){if(Array.isArray(d)){if(!Array.isArray(y)||d.length!==y.length)return!1;for(var T=0;T<d.length;T++)if(!f(d[T],y[T]))return!1;return!0}if(typeof d=="object"&&d!==null&&y!==null){if(typeof y!="object"||Object.keys(d).length!==Object.keys(y).length)return!1;for(var O in d)if(!f(d[O],y[O]))return!1;return!0}return d===y},I.dot=function(f,d){return f[0]*d[0]+f[1]*d[1]+f[2]*d[2]},I.dot$1=function(f,d){return f[0]*d[0]+f[1]*d[1]+f[2]*d[2]+f[3]*d[3]},I.ease=st,I.emitValidationErrors=rp,I.endsWith=et,I.enforceCacheSizeLimit=function(f){qe(),Tt&&Tt.then(function(d){d.keys().then(function(y){for(var T=0;T<y.length-f;T++)d.delete(y[T])})})},I.evaluateSizeForFeature=Sa,I.evaluateSizeForZoom=Da,I.evaluateVariableOffset=Po,I.evented=bd,I.extend=b,I.featureFilter=Op,I.filterObject=we,I.fromRotation=function(f,d){var y=Math.sin(d),T=Math.cos(d);return f[0]=T,f[1]=y,f[2]=0,f[3]=-y,f[4]=T,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},I.getAnchorAlignment=Mi,I.getAnchorJustification=Ke,I.getArrayBuffer=Sn,I.getImage=Wt,I.getJSON=function(f,d){return jn(b(f,{type:"json"}),d)},I.getRTLTextPluginStatus=Ed,I.getReferrer=rn,I.getVideo=function(f,d){var y,T,O=tt.document.createElement("video");O.muted=!0,O.onloadstart=function(){d(null,O)};for(var N=0;N<f.length;N++){var Z=tt.document.createElement("source");y=f[N],T=void 0,(T=tt.document.createElement("a")).href=y,(T.protocol!==tt.document.location.protocol||T.host!==tt.document.location.host)&&(O.crossOrigin="Anonymous"),Z.src=f[N],O.appendChild(Z)}return{cancel:function(){}}},I.identity=Sl,I.invert=function(f,d){var y=d[0],T=d[1],O=d[2],N=d[3],Z=d[4],q=d[5],dt=d[6],Pt=d[7],Zt=d[8],qt=d[9],pe=d[10],Oe=d[11],sr=d[12],lr=d[13],Cr=d[14],gr=d[15],Ur=y*q-T*Z,Ar=y*dt-O*Z,Dr=y*Pt-N*Z,mn=T*dt-O*q,Fn=T*Pt-N*q,ni=O*Pt-N*dt,ki=Zt*lr-qt*sr,oa=Zt*Cr-pe*sr,Di=Zt*gr-Oe*sr,ca=qt*Cr-pe*lr,zi=qt*gr-Oe*lr,Oa=pe*gr-Oe*Cr,xa=Ur*Oa-Ar*zi+Dr*ca+mn*Di-Fn*oa+ni*ki;return xa?(f[0]=(q*Oa-dt*zi+Pt*ca)*(xa=1/xa),f[1]=(O*zi-T*Oa-N*ca)*xa,f[2]=(lr*ni-Cr*Fn+gr*mn)*xa,f[3]=(pe*Fn-qt*ni-Oe*mn)*xa,f[4]=(dt*Di-Z*Oa-Pt*oa)*xa,f[5]=(y*Oa-O*Di+N*oa)*xa,f[6]=(Cr*Dr-sr*ni-gr*Ar)*xa,f[7]=(Zt*ni-pe*Dr+Oe*Ar)*xa,f[8]=(Z*zi-q*Di+Pt*ki)*xa,f[9]=(T*Di-y*zi-N*ki)*xa,f[10]=(sr*Fn-lr*Dr+gr*Ur)*xa,f[11]=(qt*Dr-Zt*Fn-Oe*Ur)*xa,f[12]=(q*oa-Z*ca-dt*ki)*xa,f[13]=(y*ca-T*oa+O*ki)*xa,f[14]=(lr*Ar-sr*mn-Cr*Ur)*xa,f[15]=(Zt*mn-qt*Ar+pe*Ur)*xa,f):null},I.isChar=Ai,I.isMapboxURL=Yt,I.keysDifference=function(f,d){var y=[];for(var T in f)T in d||y.push(T);return y},I.makeRequest=jn,I.mapObject=Dt,I.mercatorXfromLng=lf,I.mercatorYfromLat=Zl,I.mercatorZfromAltitude=Y0,I.mul=Kc,I.multiply=Ku,I.mvt=rc,I.nextPowerOfTwo=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},I.normalize=function(f,d){var y=d[0],T=d[1],O=d[2],N=y*y+T*T+O*O;return N>0&&(N=1/Math.sqrt(N)),f[0]=d[0]*N,f[1]=d[1]*N,f[2]=d[2]*N,f},I.number=Fo,I.offscreenCanvasSupported=Lr,I.ortho=function(f,d,y,T,O,N,Z){var q=1/(d-y),dt=1/(T-O),Pt=1/(N-Z);return f[0]=-2*q,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*dt,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*Pt,f[11]=0,f[12]=(d+y)*q,f[13]=(O+T)*dt,f[14]=(Z+N)*Pt,f[15]=1,f},I.parseGlyphPBF=function(f){return new th(f).readFields(ui,[])},I.pbf=th,I.performSymbolLayout=function(f,d,y,T,O,N,Z){f.createArrays(),f.tilePixelRatio=8192/(512*f.overscaling),f.compareText={},f.iconsNeedLinear=!1;var q=f.layers[0].layout,dt=f.layers[0]._unevaluatedLayout._values,Pt={};if(f.textSizeData.kind==="composite"){var Zt=f.textSizeData,qt=Zt.maxZoom;Pt.compositeTextSizes=[dt["text-size"].possiblyEvaluate(new Ka(Zt.minZoom),Z),dt["text-size"].possiblyEvaluate(new Ka(qt),Z)]}if(f.iconSizeData.kind==="composite"){var pe=f.iconSizeData,Oe=pe.maxZoom;Pt.compositeIconSizes=[dt["icon-size"].possiblyEvaluate(new Ka(pe.minZoom),Z),dt["icon-size"].possiblyEvaluate(new Ka(Oe),Z)]}Pt.layoutTextSize=dt["text-size"].possiblyEvaluate(new Ka(f.zoom+1),Z),Pt.layoutIconSize=dt["icon-size"].possiblyEvaluate(new Ka(f.zoom+1),Z),Pt.textMaxSize=dt["text-size"].possiblyEvaluate(new Ka(18));for(var sr=24*q.get("text-line-height"),lr=q.get("text-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",Cr=q.get("text-keep-upright"),gr=q.get("text-size"),Ur=function(){var mn=Dr[Ar],Fn=q.get("text-font").evaluate(mn,{},Z).join(","),ni=gr.evaluate(mn,{},Z),ki=Pt.layoutTextSize.evaluate(mn,{},Z),oa=Pt.layoutIconSize.evaluate(mn,{},Z),Di={horizontal:{},vertical:void 0},ca=mn.text,zi=[0,0];if(ca){var Oa=ca.toString(),xa=24*q.get("text-letter-spacing").evaluate(mn,{},Z),Qi=function(ro){for(var va=0,ts=ro;va<ts.length;va+=1)if(Do=ts[va].charCodeAt(0),Ai.Arabic(Do)||Ai["Arabic Supplement"](Do)||Ai["Arabic Extended-A"](Do)||Ai["Arabic Presentation Forms-A"](Do)||Ai["Arabic Presentation Forms-B"](Do))return!1;var Do;return!0}(Oa)?xa:0,lo=q.get("text-anchor").evaluate(mn,{},Z),Ja=q.get("text-variable-anchor");if(!Ja){var To=q.get("text-radial-offset").evaluate(mn,{},Z);zi=To?Po(lo,[24*To,So]):q.get("text-offset").evaluate(mn,{},Z).map(function(ro){return 24*ro})}var ea=lr?"center":q.get("text-justify").evaluate(mn,{},Z),Zo=q.get("symbol-placement"),Es=Zo==="point"?24*q.get("text-max-width").evaluate(mn,{},Z):0,uu=function(){f.allowVerticalPlacement&&Hf(Oa)&&(Di.vertical=Ti(ca,d,y,O,Fn,Es,sr,lo,"left",Qi,zi,vi.vertical,!0,Zo,ki,ni))};if(!lr&&Ja){for(var Ws=ea==="auto"?Ja.map(function(ro){return Ke(ro)}):[ea],ks=!1,eu=0;eu<Ws.length;eu++){var Qu=Ws[eu];if(!Di.horizontal[Qu])if(ks)Di.horizontal[Qu]=Di.horizontal[0];else{var lu=Ti(ca,d,y,O,Fn,Es,sr,"center",Qu,Qi,zi,vi.horizontal,!1,Zo,ki,ni);lu&&(Di.horizontal[Qu]=lu,ks=lu.positionedLines.length===1)}}uu()}else{ea==="auto"&&(ea=Ke(lo));var Gl=Ti(ca,d,y,O,Fn,Es,sr,lo,ea,Qi,zi,vi.horizontal,!1,Zo,ki,ni);Gl&&(Di.horizontal[ea]=Gl),uu(),Hf(Oa)&&lr&&Cr&&(Di.vertical=Ti(ca,d,y,O,Fn,Es,sr,lo,ea,Qi,zi,vi.vertical,!1,Zo,ki,ni))}}var us=void 0,Hl=!1;if(mn.icon&&mn.icon.name){var mu=T[mn.icon.name];mu&&(us=function(ro,va,ts){var Do=Mi(ts),jl=va[0]-ro.displaySize[0]*Do.horizontalAlign,Uu=va[1]-ro.displaySize[1]*Do.verticalAlign;return{image:ro,top:Uu,bottom:Uu+ro.displaySize[1],left:jl,right:jl+ro.displaySize[0]}}(O[mn.icon.name],q.get("icon-offset").evaluate(mn,{},Z),q.get("icon-anchor").evaluate(mn,{},Z)),Hl=mu.sdf,f.sdfIcons===void 0?f.sdfIcons=mu.sdf:f.sdfIcons!==mu.sdf&&te("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(mu.pixelRatio!==f.pixelRatio||q.get("icon-rotate").constantOr(1)!==0)&&(f.iconsNeedLinear=!0))}var cu=en(Di.horizontal)||Di.vertical;f.iconsInText=!!cu&&cu.iconsInText,(cu||us)&&function(ro,va,ts,Do,jl,Uu,Ss,Pu,fu,Oo,cf){var ff=Uu.textMaxSize.evaluate(va,{});ff===void 0&&(ff=Ss);var nh,ru=ro.layers[0].layout,kh=ru.get("icon-offset").evaluate(va,{},cf),fl=en(ts.horizontal),Qp=Ss/24,Pl=ro.tilePixelRatio*Qp,Lf=ro.tilePixelRatio*ff/24,ih=ro.tilePixelRatio*Pu,Nd=ro.tilePixelRatio*ru.get("symbol-spacing"),a0=ru.get("text-padding")*ro.tilePixelRatio,fp=ru.get("icon-padding")*ro.tilePixelRatio,yv=ru.get("text-max-angle")/180*Math.PI,zd=ru.get("text-rotation-alignment")==="map"&&ru.get("symbol-placement")!=="point",_v=ru.get("icon-rotation-alignment")==="map"&&ru.get("symbol-placement")!=="point",yc=ru.get("symbol-placement"),hp=Nd/2,Zu=ru.get("icon-text-fit");Do&&Zu!=="none"&&(ro.allowVerticalPlacement&&ts.vertical&&(nh=Yn(Do,ts.vertical,Zu,ru.get("icon-text-fit-padding"),kh,Qp)),fl&&(Do=Yn(Do,fl,Zu,ru.get("icon-text-fit-padding"),kh,Qp)));var pp=function(_c,hf){hf.x<0||hf.x>=8192||hf.y<0||hf.y>=8192||function(Va,Ju,Y_,mp,J0,jg,s0,Fc,ah,Lh,tg,u0,eg,Xm,l0,Wg,Wl,Ym,$m,qm,Rc,rg,yp,pf,Xg){var Tv,Pf,Ph,rd,_p,xp=Va.addToLineVertexArray(Ju,Y_),c0=0,Oh=0,Vd=0,Gd=0,Mv=-1,Fh=-1,Dc={},Iv=rr(""),Ol=0,kv=0;if(Fc._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Ol=(Tv=Fc.layout.get("text-offset").evaluate(Rc,{},pf).map(function(bp){return 24*bp}))[0],kv=Tv[1]):(Ol=24*Fc.layout.get("text-radial-offset").evaluate(Rc,{},pf),kv=So),Va.allowVerticalPlacement&&mp.vertical){var Lv=Fc.layout.get("text-rotate").evaluate(Rc,{},pf)+90;rd=new tu(ah,Ju,Lh,tg,u0,mp.vertical,eg,Xm,l0,Lv),s0&&(_p=new tu(ah,Ju,Lh,tg,u0,s0,Wl,Ym,l0,Lv))}if(J0){var Rh=Fc.layout.get("icon-rotate").evaluate(Rc,{}),Yg=Fc.layout.get("icon-text-fit")!=="none",$g=Tu(J0,Rh,yp,Yg),qg=s0?Tu(s0,Rh,yp,Yg):void 0;Ph=new tu(ah,Ju,Lh,tg,u0,J0,Wl,Ym,!1,Rh),c0=4*$g.length;var Kg=Va.iconSizeData,Pv=null;Kg.kind==="source"?(Pv=[128*Fc.layout.get("icon-size").evaluate(Rc,{})])[0]>32640&&te(Va.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Kg.kind==="composite"&&((Pv=[128*rg.compositeIconSizes[0].evaluate(Rc,{},pf),128*rg.compositeIconSizes[1].evaluate(Rc,{},pf)])[0]>32640||Pv[1]>32640)&&te(Va.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Va.addSymbols(Va.icon,$g,Pv,qm,$m,Rc,!1,Ju,xp.lineStartIndex,xp.lineLength,-1,pf),Mv=Va.icon.placedSymbolArray.length-1,qg&&(Oh=4*qg.length,Va.addSymbols(Va.icon,qg,Pv,qm,$m,Rc,vi.vertical,Ju,xp.lineStartIndex,xp.lineLength,-1,pf),Fh=Va.icon.placedSymbolArray.length-1)}for(var Ov in mp.horizontal){var Fv=mp.horizontal[Ov];if(!Pf){Iv=rr(Fv.text);var $_=Fc.layout.get("text-rotate").evaluate(Rc,{},pf);Pf=new tu(ah,Ju,Lh,tg,u0,Fv,eg,Xm,l0,$_)}var Of=Fv.positionedLines.length===1;if(Vd+=an(Va,Ju,Fv,jg,Fc,l0,Rc,Wg,xp,mp.vertical?vi.horizontal:vi.horizontalOnly,Of?Object.keys(mp.horizontal):[Ov],Dc,Mv,rg,pf),Of)break}mp.vertical&&(Gd+=an(Va,Ju,mp.vertical,jg,Fc,l0,Rc,Wg,xp,vi.vertical,["vertical"],Dc,Fh,rg,pf));var Km=Pf?Pf.boxStartIndex:Va.collisionBoxArray.length,q_=Pf?Pf.boxEndIndex:Va.collisionBoxArray.length,ng=rd?rd.boxStartIndex:Va.collisionBoxArray.length,K_=rd?rd.boxEndIndex:Va.collisionBoxArray.length,Hd=Ph?Ph.boxStartIndex:Va.collisionBoxArray.length,ig=Ph?Ph.boxEndIndex:Va.collisionBoxArray.length,ag=_p?_p.boxStartIndex:Va.collisionBoxArray.length,Qg=_p?_p.boxEndIndex:Va.collisionBoxArray.length,Ls=-1,df=function(bp,sg){return bp&&bp.circleDiameter?Math.max(bp.circleDiameter,sg):sg};Ls=df(Pf,Ls),Ls=df(rd,Ls),Ls=df(Ph,Ls);var og=(Ls=df(_p,Ls))>-1?1:0;og&&(Ls*=Xg/24),Va.glyphOffsetArray.length>=pr.MAX_GLYPHS&&te("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Rc.sortKey!==void 0&&Va.addToSortKeyRanges(Va.symbolInstances.length,Rc.sortKey),Va.symbolInstances.emplaceBack(Ju.x,Ju.y,Dc.right>=0?Dc.right:-1,Dc.center>=0?Dc.center:-1,Dc.left>=0?Dc.left:-1,Dc.vertical||-1,Mv,Fh,Iv,Km,q_,ng,K_,Hd,ig,ag,Qg,Lh,Vd,Gd,c0,Oh,og,0,eg,Ol,kv,Ls)}(ro,hf,_c,ts,Do,jl,nh,ro.layers[0],ro.collisionBoxArray,va.index,va.sourceLayerIndex,ro.index,Pl,a0,zd,fu,ih,fp,_v,kh,va,Uu,Oo,cf,Ss)};if(yc==="line")for(var Jp=0,Ud=su(va.geometry,0,0,8192,8192);Jp<Ud.length;Jp+=1)for(var Zd=Ud[Jp],xv=0,bv=Qs(Zd,Nd,yv,ts.vertical||fl,Do,24,Lf,ro.overscaling,8192);xv<bv.length;xv+=1){var Ev=bv[xv];fl&&Ri(ro,fl.text,hp,Ev)||pp(Zd,Ev)}else if(yc==="line-center")for(var Sv=0,td=va.geometry;Sv<td.length;Sv+=1){var wv=td[Sv];if(wv.length>1){var o0=Xo(wv,yv,ts.vertical||fl,Do,24,Lf);o0&&pp(wv,o0)}}else if(va.type==="Polygon")for(var Us=0,Kt=rf(va.geometry,0);Us<Kt.length;Us+=1){var dp=Kt[Us],Cv=ya(dp,16);pp(dp[0],new Ii(Cv.x,Cv.y,0))}else if(va.type==="LineString")for(var vp=0,Av=va.geometry;vp<Av.length;vp+=1){var gp=Av[vp];pp(gp,new Ii(gp[0].x,gp[0].y,0))}else if(va.type==="Point")for(var K0=0,Q0=va.geometry;K0<Q0.length;K0+=1)for(var ed=0,Wm=Q0[K0];ed<Wm.length;ed+=1){var Hg=Wm[ed];pp([Hg],new Ii(Hg.x,Hg.y,0))}}(f,mn,Di,us,T,Pt,ki,oa,zi,Hl,Z)},Ar=0,Dr=f.features;Ar<Dr.length;Ar+=1)Ur();N&&f.generateCollisionDebugBuffers()},I.perspective=function(f,d,y,T,O){var N,Z=1/Math.tan(d/2);return f[0]=Z/y,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=Z,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,O!=null&&O!==1/0?(f[10]=(O+T)*(N=1/(T-O)),f[14]=2*O*T*N):(f[10]=-1,f[14]=-2*T),f},I.pick=function(f,d){for(var y={},T=0;T<d.length;T++){var O=d[T];O in f&&(y[O]=f[O])}return y},I.plugin=Ko,I.polygonIntersectsPolygon=kc,I.postMapLoadEvent=Gt,I.postTurnstileEvent=jt,I.potpack=ri,I.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],I.register=Zi,I.registerForPluginStateChange=function(f){return f({pluginStatus:_l,pluginURL:sa}),bd.on("pluginStateChange",f),f},I.renderColorRamp=wd,I.rotate=function(f,d,y){var T=d[0],O=d[1],N=d[2],Z=d[3],q=Math.sin(y),dt=Math.cos(y);return f[0]=T*dt+N*q,f[1]=O*dt+Z*q,f[2]=T*-q+N*dt,f[3]=O*-q+Z*dt,f},I.rotateX=function(f,d,y){var T=Math.sin(y),O=Math.cos(y),N=d[4],Z=d[5],q=d[6],dt=d[7],Pt=d[8],Zt=d[9],qt=d[10],pe=d[11];return d!==f&&(f[0]=d[0],f[1]=d[1],f[2]=d[2],f[3]=d[3],f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15]),f[4]=N*O+Pt*T,f[5]=Z*O+Zt*T,f[6]=q*O+qt*T,f[7]=dt*O+pe*T,f[8]=Pt*O-N*T,f[9]=Zt*O-Z*T,f[10]=qt*O-q*T,f[11]=pe*O-dt*T,f},I.rotateZ=function(f,d,y){var T=Math.sin(y),O=Math.cos(y),N=d[0],Z=d[1],q=d[2],dt=d[3],Pt=d[4],Zt=d[5],qt=d[6],pe=d[7];return d!==f&&(f[8]=d[8],f[9]=d[9],f[10]=d[10],f[11]=d[11],f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15]),f[0]=N*O+Pt*T,f[1]=Z*O+Zt*T,f[2]=q*O+qt*T,f[3]=dt*O+pe*T,f[4]=Pt*O-N*T,f[5]=Zt*O-Z*T,f[6]=qt*O-q*T,f[7]=pe*O-dt*T,f},I.scale=function(f,d,y){var T=y[0],O=y[1],N=y[2];return f[0]=d[0]*T,f[1]=d[1]*T,f[2]=d[2]*T,f[3]=d[3]*T,f[4]=d[4]*O,f[5]=d[5]*O,f[6]=d[6]*O,f[7]=d[7]*O,f[8]=d[8]*N,f[9]=d[9]*N,f[10]=d[10]*N,f[11]=d[11]*N,f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15],f},I.scale$1=function(f,d,y){return f[0]=d[0]*y,f[1]=d[1]*y,f[2]=d[2]*y,f[3]=d[3]*y,f},I.scale$2=function(f,d,y){return f[0]=d[0]*y,f[1]=d[1]*y,f[2]=d[2]*y,f},I.setCacheLimits=function(f,d){Ae=f,He=d},I.setRTLTextPlugin=function(f,d,y){if(y===void 0&&(y=!1),_l==="deferred"||_l==="loading"||_l==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");sa=Me.resolveURL(f),_l="deferred",fc=d,Np(),y||Ml()},I.sphericalToCartesian=function(f){var d=f[0],y=f[1],T=f[2];return y+=90,y*=Math.PI/180,T*=Math.PI/180,{x:d*Math.cos(y)*Math.sin(T),y:d*Math.sin(y)*Math.sin(T),z:d*Math.cos(T)}},I.sqrLen=function(f){var d=f[0],y=f[1];return d*d+y*y},I.styleSpec=Le,I.sub=function(f,d,y){return f[0]=d[0]-y[0],f[1]=d[1]-y[1],f[2]=d[2]-y[2],f},I.symbolSize=oo,I.transformMat3=function(f,d,y){var T=d[0],O=d[1],N=d[2];return f[0]=T*y[0]+O*y[3]+N*y[6],f[1]=T*y[1]+O*y[4]+N*y[7],f[2]=T*y[2]+O*y[5]+N*y[8],f},I.transformMat4=$f,I.translate=function(f,d,y){var T,O,N,Z,q,dt,Pt,Zt,qt,pe,Oe,sr,lr=y[0],Cr=y[1],gr=y[2];return d===f?(f[12]=d[0]*lr+d[4]*Cr+d[8]*gr+d[12],f[13]=d[1]*lr+d[5]*Cr+d[9]*gr+d[13],f[14]=d[2]*lr+d[6]*Cr+d[10]*gr+d[14],f[15]=d[3]*lr+d[7]*Cr+d[11]*gr+d[15]):(O=d[1],N=d[2],Z=d[3],q=d[4],dt=d[5],Pt=d[6],Zt=d[7],qt=d[8],pe=d[9],Oe=d[10],sr=d[11],f[0]=T=d[0],f[1]=O,f[2]=N,f[3]=Z,f[4]=q,f[5]=dt,f[6]=Pt,f[7]=Zt,f[8]=qt,f[9]=pe,f[10]=Oe,f[11]=sr,f[12]=T*lr+q*Cr+qt*gr+d[12],f[13]=O*lr+dt*Cr+pe*gr+d[13],f[14]=N*lr+Pt*Cr+Oe*gr+d[14],f[15]=Z*lr+Zt*Cr+sr*gr+d[15]),f},I.triggerPluginCompletionEvent=Bp,I.uniqueId=fe,I.validateCustomStyleLayer=function(f){var d=[],y=f.id;return y===void 0&&d.push({message:"layers."+y+': missing required property "id"'}),f.render===void 0&&d.push({message:"layers."+y+': missing required method "render"'}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&d.push({message:"layers."+y+': property "renderingMode" must be either "2d" or "3d"'}),d},I.validateLight=xd,I.validateStyle=tp,I.values=function(f){var d=[];for(var y in f)d.push(f[y]);return d},I.vectorTile=rc,I.version="1.13.2",I.warnOnce=te,I.webpSupported=Je,I.window=tt,I.wrap=P}),bt(["./shared"],function(I){"use strict";function xt(Rt){var Wt=typeof Rt;if(Wt==="number"||Wt==="boolean"||Wt==="string"||Rt==null)return JSON.stringify(Rt);if(Array.isArray(Rt)){for(var oe="[",Se=0,ze=Rt;Se<ze.length;Se+=1)oe+=xt(ze[Se])+",";return oe+"]"}for(var fr=Object.keys(Rt).sort(),wr="{",Le=0;Le<fr.length;Le++)wr+=JSON.stringify(fr[Le])+":"+xt(Rt[fr[Le]])+",";return wr+"}"}function K(Rt){for(var Wt="",oe=0,Se=I.refProperties;oe<Se.length;oe+=1)Wt+="/"+xt(Rt[Se[oe]]);return Wt}var ut=function(Rt){this.keyCache={},Rt&&this.replace(Rt)};ut.prototype.replace=function(Rt){this._layerConfigs={},this._layers={},this.update(Rt,[])},ut.prototype.update=function(Rt,Wt){for(var oe=this,Se=0,ze=Rt;Se<ze.length;Se+=1){var fr=ze[Se];this._layerConfigs[fr.id]=fr;var wr=this._layers[fr.id]=I.createStyleLayer(fr);wr._featureFilter=I.featureFilter(wr.filter),this.keyCache[fr.id]&&delete this.keyCache[fr.id]}for(var Le=0,ur=Wt;Le<ur.length;Le+=1){var Wr=ur[Le];delete this.keyCache[Wr],delete this._layerConfigs[Wr],delete this._layers[Wr]}this.familiesBySource={};for(var wn=0,qr=function(li,hi){for(var ra={},Ci=0;Ci<li.length;Ci++){var Ba=hi&&hi[li[Ci].id]||K(li[Ci]);hi&&(hi[li[Ci].id]=Ba);var po=ra[Ba];po||(po=ra[Ba]=[]),po.push(li[Ci])}var za=[];for(var Xa in ra)za.push(ra[Xa]);return za}(I.values(this._layerConfigs),this.keyCache);wn<qr.length;wn+=1){var Qr=qr[wn].map(function(li){return oe._layers[li.id]}),Mn=Qr[0];if(Mn.visibility!=="none"){var bi=Mn.source||"",wi=this.familiesBySource[bi];wi||(wi=this.familiesBySource[bi]={});var Kr=Mn.sourceLayer||"_geojsonTileLayer",ai=wi[Kr];ai||(ai=wi[Kr]=[]),ai.push(Qr)}}};var ht=function(Rt){var Wt={},oe=[];for(var Se in Rt){var ze=Rt[Se],fr=Wt[Se]={};for(var wr in ze){var Le=ze[+wr];if(Le&&Le.bitmap.width!==0&&Le.bitmap.height!==0){var ur={x:0,y:0,w:Le.bitmap.width+2,h:Le.bitmap.height+2};oe.push(ur),fr[wr]={rect:ur,metrics:Le.metrics}}}}var Wr=I.potpack(oe),wn=new I.AlphaImage({width:Wr.w||1,height:Wr.h||1});for(var qr in Rt){var Qr=Rt[qr];for(var Mn in Qr){var bi=Qr[+Mn];if(bi&&bi.bitmap.width!==0&&bi.bitmap.height!==0){var wi=Wt[qr][Mn].rect;I.AlphaImage.copy(bi.bitmap,wn,{x:0,y:0},{x:wi.x+1,y:wi.y+1},bi.bitmap)}}}this.image=wn,this.positions=Wt};I.register("GlyphAtlas",ht);var lt=function(Rt){this.tileID=new I.OverscaledTileID(Rt.tileID.overscaledZ,Rt.tileID.wrap,Rt.tileID.canonical.z,Rt.tileID.canonical.x,Rt.tileID.canonical.y),this.uid=Rt.uid,this.zoom=Rt.zoom,this.pixelRatio=Rt.pixelRatio,this.tileSize=Rt.tileSize,this.source=Rt.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Rt.showCollisionBoxes,this.collectResourceTiming=!!Rt.collectResourceTiming,this.returnDependencies=!!Rt.returnDependencies,this.promoteId=Rt.promoteId};function tt(Rt,Wt,oe){for(var Se=new I.EvaluationParameters(Wt),ze=0,fr=Rt;ze<fr.length;ze+=1)fr[ze].recalculate(Se,oe)}function be(Rt,Wt){var oe=I.getArrayBuffer(Rt.request,function(Se,ze,fr,wr){Se?Wt(Se):ze&&Wt(null,{vectorTile:new I.vectorTile.VectorTile(new I.pbf(ze)),rawData:ze,cacheControl:fr,expires:wr})});return function(){oe.cancel(),Wt()}}lt.prototype.parse=function(Rt,Wt,oe,Se,ze){var fr=this;this.status="parsing",this.data=Rt,this.collisionBoxArray=new I.CollisionBoxArray;var wr=new I.DictionaryCoder(Object.keys(Rt.layers).sort()),Le=new I.FeatureIndex(this.tileID,this.promoteId);Le.bucketLayerIDs=[];var ur,Wr,wn,qr,Qr={},Mn={featureIndex:Le,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:oe},bi=Wt.familiesBySource[this.source];for(var wi in bi){var Kr=Rt.layers[wi];if(Kr){Kr.version===1&&I.warnOnce('Vector tile source "'+this.source+'" layer "'+wi+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var ai=wr.encode(wi),li=[],hi=0;hi<Kr.length;hi++){var ra=Kr.feature(hi),Ci=Le.getId(ra,wi);li.push({feature:ra,id:Ci,index:hi,sourceLayerIndex:ai})}for(var Ba=0,po=bi[wi];Ba<po.length;Ba+=1){var za=po[Ba],Xa=za[0];Xa.minzoom&&this.zoom<Math.floor(Xa.minzoom)||Xa.maxzoom&&this.zoom>=Xa.maxzoom||Xa.visibility!=="none"&&(tt(za,this.zoom,oe),(Qr[Xa.id]=Xa.createBucket({index:Le.bucketLayerIDs.length,layers:za,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ai,sourceID:this.source})).populate(li,Mn,this.tileID.canonical),Le.bucketLayerIDs.push(za.map(function(vo){return vo.id})))}}}var Ta=I.mapObject(Mn.glyphDependencies,function(vo){return Object.keys(vo).map(Number)});Object.keys(Ta).length?Se.send("getGlyphs",{uid:this.uid,stacks:Ta},function(vo,ja){ur||(ur=vo,Wr=ja,Vo.call(fr))}):Wr={};var ga=Object.keys(Mn.iconDependencies);ga.length?Se.send("getImages",{icons:ga,source:this.source,tileID:this.tileID,type:"icons"},function(vo,ja){ur||(ur=vo,wn=ja,Vo.call(fr))}):wn={};var no=Object.keys(Mn.patternDependencies);function Vo(){if(ur)return ze(ur);if(Wr&&wn&&qr){var vo=new ht(Wr),ja=new I.ImageAtlas(wn,qr);for(var to in Qr){var Uo=Qr[to];Uo instanceof I.SymbolBucket?(tt(Uo.layers,this.zoom,oe),I.performSymbolLayout(Uo,Wr,vo.positions,wn,ja.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Uo.hasPattern&&(Uo instanceof I.LineBucket||Uo instanceof I.FillBucket||Uo instanceof I.FillExtrusionBucket)&&(tt(Uo.layers,this.zoom,oe),Uo.addFeatures(Mn,this.tileID.canonical,ja.patternPositions))}this.status="done",ze(null,{buckets:I.values(Qr).filter(function(ju){return!ju.isEmpty()}),featureIndex:Le,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vo.image,imageAtlas:ja,glyphMap:this.returnDependencies?Wr:null,iconMap:this.returnDependencies?wn:null,glyphPositions:this.returnDependencies?vo.positions:null})}}no.length?Se.send("getImages",{icons:no,source:this.source,tileID:this.tileID,type:"patterns"},function(vo,ja){ur||(ur=vo,qr=ja,Vo.call(fr))}):qr={},Vo.call(this)};var it=function(Rt,Wt,oe,Se){this.actor=Rt,this.layerIndex=Wt,this.availableImages=oe,this.loadVectorData=Se||be,this.loading={},this.loaded={}};it.prototype.loadTile=function(Rt,Wt){var oe=this,Se=Rt.uid;this.loading||(this.loading={});var ze=!!(Rt&&Rt.request&&Rt.request.collectResourceTiming)&&new I.RequestPerformance(Rt.request),fr=this.loading[Se]=new lt(Rt);fr.abort=this.loadVectorData(Rt,function(wr,Le){if(delete oe.loading[Se],wr||!Le)return fr.status="done",oe.loaded[Se]=fr,Wt(wr);var ur=Le.rawData,Wr={};Le.expires&&(Wr.expires=Le.expires),Le.cacheControl&&(Wr.cacheControl=Le.cacheControl);var wn={};if(ze){var qr=ze.finish();qr&&(wn.resourceTiming=JSON.parse(JSON.stringify(qr)))}fr.vectorTile=Le.vectorTile,fr.parse(Le.vectorTile,oe.layerIndex,oe.availableImages,oe.actor,function(Qr,Mn){if(Qr||!Mn)return Wt(Qr);Wt(null,I.extend({rawTileData:ur.slice(0)},Mn,Wr,wn))}),oe.loaded=oe.loaded||{},oe.loaded[Se]=fr})},it.prototype.reloadTile=function(Rt,Wt){var oe=this,Se=this.loaded,ze=Rt.uid,fr=this;if(Se&&Se[ze]){var wr=Se[ze];wr.showCollisionBoxes=Rt.showCollisionBoxes;var Le=function(ur,Wr){var wn=wr.reloadCallback;wn&&(delete wr.reloadCallback,wr.parse(wr.vectorTile,fr.layerIndex,oe.availableImages,fr.actor,wn)),Wt(ur,Wr)};wr.status==="parsing"?wr.reloadCallback=Le:wr.status==="done"&&(wr.vectorTile?wr.parse(wr.vectorTile,this.layerIndex,this.availableImages,this.actor,Le):Le())}},it.prototype.abortTile=function(Rt,Wt){var oe=this.loading,Se=Rt.uid;oe&&oe[Se]&&oe[Se].abort&&(oe[Se].abort(),delete oe[Se]),Wt()},it.prototype.removeTile=function(Rt,Wt){var oe=this.loaded,Se=Rt.uid;oe&&oe[Se]&&delete oe[Se],Wt()};var st=I.window.ImageBitmap,Ut=function(){this.loaded={}};function P(Rt,Wt){if(Rt.length!==0){b(Rt[0],Wt);for(var oe=1;oe<Rt.length;oe++)b(Rt[oe],!Wt)}}function b(Rt,Wt){for(var oe=0,Se=0,ze=Rt.length,fr=ze-1;Se<ze;fr=Se++)oe+=(Rt[Se][0]-Rt[fr][0])*(Rt[fr][1]+Rt[Se][1]);oe>=0!=!!Wt&&Rt.reverse()}Ut.prototype.loadTile=function(Rt,Wt){var oe=Rt.uid,Se=Rt.encoding,ze=Rt.rawImageData,fr=st&&ze instanceof st?this.getImageData(ze):ze,wr=new I.DEMData(oe,fr,Se);this.loaded=this.loaded||{},this.loaded[oe]=wr,Wt(null,wr)},Ut.prototype.getImageData=function(Rt){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Rt.width,Rt.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Rt.width,this.offscreenCanvas.height=Rt.height,this.offscreenCanvasContext.drawImage(Rt,0,0,Rt.width,Rt.height);var Wt=this.offscreenCanvasContext.getImageData(-1,-1,Rt.width+2,Rt.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new I.RGBAImage({width:Wt.width,height:Wt.height},Wt.data)},Ut.prototype.removeTile=function(Rt){var Wt=this.loaded,oe=Rt.uid;Wt&&Wt[oe]&&delete Wt[oe]};var W=I.vectorTile.VectorTileFeature.prototype.toGeoJSON,fe=function(Rt){this._feature=Rt,this.extent=I.EXTENT,this.type=Rt.type,this.properties=Rt.tags,"id"in Rt&&!isNaN(Rt.id)&&(this.id=parseInt(Rt.id,10))};fe.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Rt=[],Wt=0,oe=this._feature.geometry;Wt<oe.length;Wt+=1){var Se=oe[Wt];Rt.push([new I.Point$1(Se[0],Se[1])])}return Rt}for(var ze=[],fr=0,wr=this._feature.geometry;fr<wr.length;fr+=1){for(var Le=[],ur=0,Wr=wr[fr];ur<Wr.length;ur+=1){var wn=Wr[ur];Le.push(new I.Point$1(wn[0],wn[1]))}ze.push(Le)}return ze},fe.prototype.toGeoJSON=function(Rt,Wt,oe){return W.call(this,Rt,Wt,oe)};var Ee=function(Rt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=I.EXTENT,this.length=Rt.length,this._features=Rt};Ee.prototype.feature=function(Rt){return new fe(this._features[Rt])};var Te=I.vectorTile.VectorTileFeature,Mt=et;function et(Rt,Wt){this.options=Wt||{},this.features=Rt,this.length=Rt.length}function Dt(Rt,Wt){this.id=typeof Rt.id=="number"?Rt.id:void 0,this.type=Rt.type,this.rawGeometry=Rt.type===1?[Rt.geometry]:Rt.geometry,this.properties=Rt.tags,this.extent=Wt||4096}et.prototype.feature=function(Rt){return new Dt(this.features[Rt],this.options.extent)},Dt.prototype.loadGeometry=function(){var Rt=this.rawGeometry;this.geometry=[];for(var Wt=0;Wt<Rt.length;Wt++){for(var oe=Rt[Wt],Se=[],ze=0;ze<oe.length;ze++)Se.push(new I.Point$1(oe[ze][0],oe[ze][1]));this.geometry.push(Se)}return this.geometry},Dt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Rt=this.geometry,Wt=1/0,oe=-1/0,Se=1/0,ze=-1/0,fr=0;fr<Rt.length;fr++)for(var wr=Rt[fr],Le=0;Le<wr.length;Le++){var ur=wr[Le];Wt=Math.min(Wt,ur.x),oe=Math.max(oe,ur.x),Se=Math.min(Se,ur.y),ze=Math.max(ze,ur.y)}return[Wt,Se,oe,ze]},Dt.prototype.toGeoJSON=Te.prototype.toGeoJSON;var we=ge,_e=Mt;function ge(Rt){var Wt=new I.pbf;return function(oe,Se){for(var ze in oe.layers)Se.writeMessage(3,te,oe.layers[ze])}(Rt,Wt),Wt.finish()}function te(Rt,Wt){var oe;Wt.writeVarintField(15,Rt.version||1),Wt.writeStringField(1,Rt.name||""),Wt.writeVarintField(5,Rt.extent||4096);var Se={keys:[],values:[],keycache:{},valuecache:{}};for(oe=0;oe<Rt.length;oe++)Se.feature=Rt.feature(oe),Wt.writeMessage(2,xe,Se);var ze=Se.keys;for(oe=0;oe<ze.length;oe++)Wt.writeStringField(3,ze[oe]);var fr=Se.values;for(oe=0;oe<fr.length;oe++)Wt.writeMessage(4,Ct,fr[oe])}function xe(Rt,Wt){var oe=Rt.feature;oe.id!==void 0&&Wt.writeVarintField(1,oe.id),Wt.writeMessage(2,Ye,Rt),Wt.writeVarintField(3,oe.type),Wt.writeMessage(4,ct,oe)}function Ye(Rt,Wt){var oe=Rt.feature,Se=Rt.keys,ze=Rt.values,fr=Rt.keycache,wr=Rt.valuecache;for(var Le in oe.properties){var ur=fr[Le];ur===void 0&&(Se.push(Le),fr[Le]=ur=Se.length-1),Wt.writeVarint(ur);var Wr=oe.properties[Le],wn=typeof Wr;wn!=="string"&&wn!=="boolean"&&wn!=="number"&&(Wr=JSON.stringify(Wr));var qr=wn+":"+Wr,Qr=wr[qr];Qr===void 0&&(ze.push(Wr),wr[qr]=Qr=ze.length-1),Wt.writeVarint(Qr)}}function Lt(Rt,Wt){return(Wt<<3)+(7&Rt)}function Qt(Rt){return Rt<<1^Rt>>31}function ct(Rt,Wt){for(var oe=Rt.loadGeometry(),Se=Rt.type,ze=0,fr=0,wr=oe.length,Le=0;Le<wr;Le++){var ur=oe[Le],Wr=1;Se===1&&(Wr=ur.length),Wt.writeVarint(Lt(1,Wr));for(var wn=Se===3?ur.length-1:ur.length,qr=0;qr<wn;qr++){qr===1&&Se!==1&&Wt.writeVarint(Lt(2,wn-1));var Qr=ur[qr].x-ze,Mn=ur[qr].y-fr;Wt.writeVarint(Qt(Qr)),Wt.writeVarint(Qt(Mn)),ze+=Qr,fr+=Mn}Se===3&&Wt.writeVarint(Lt(7,1))}}function Ct(Rt,Wt){var oe=typeof Rt;oe==="string"?Wt.writeStringField(1,Rt):oe==="boolean"?Wt.writeBooleanField(7,Rt):oe==="number"&&(Rt%1!=0?Wt.writeDoubleField(3,Rt):Rt<0?Wt.writeSVarintField(6,Rt):Wt.writeVarintField(5,Rt))}function Y(Rt,Wt,oe,Se){yt(Rt,oe,Se),yt(Wt,2*oe,2*Se),yt(Wt,2*oe+1,2*Se+1)}function yt(Rt,Wt,oe){var Se=Rt[Wt];Rt[Wt]=Rt[oe],Rt[oe]=Se}function Xt(Rt,Wt,oe,Se){var ze=Rt-oe,fr=Wt-Se;return ze*ze+fr*fr}we.fromVectorTileJs=ge,we.fromGeojsonVt=function(Rt,Wt){Wt=Wt||{};var oe={};for(var Se in Rt)oe[Se]=new Mt(Rt[Se].features,Wt),oe[Se].name=Se,oe[Se].version=Wt.version,oe[Se].extent=Wt.extent;return ge({layers:oe})},we.GeoJSONWrapper=_e;var ie=function(Rt){return Rt[0]},Ce=function(Rt){return Rt[1]},er=function(Rt,Wt,oe,Se,ze){Wt===void 0&&(Wt=ie),oe===void 0&&(oe=Ce),Se===void 0&&(Se=64),ze===void 0&&(ze=Float64Array),this.nodeSize=Se,this.points=Rt;for(var fr=Rt.length<65536?Uint16Array:Uint32Array,wr=this.ids=new fr(Rt.length),Le=this.coords=new ze(2*Rt.length),ur=0;ur<Rt.length;ur++)wr[ur]=ur,Le[2*ur]=Wt(Rt[ur]),Le[2*ur+1]=oe(Rt[ur]);(function Wr(wn,qr,Qr,Mn,bi,wi){if(!(bi-Mn<=Qr)){var Kr=Mn+bi>>1;(function ai(li,hi,ra,Ci,Ba,po){for(;Ba>Ci;){if(Ba-Ci>600){var za=Ba-Ci+1,Xa=ra-Ci+1,Ta=Math.log(za),ga=.5*Math.exp(2*Ta/3),no=.5*Math.sqrt(Ta*ga*(za-ga)/za)*(Xa-za/2<0?-1:1);ai(li,hi,ra,Math.max(Ci,Math.floor(ra-Xa*ga/za+no)),Math.min(Ba,Math.floor(ra+(za-Xa)*ga/za+no)),po)}var Vo=hi[2*ra+po],vo=Ci,ja=Ba;for(Y(li,hi,Ci,ra),hi[2*Ba+po]>Vo&&Y(li,hi,Ci,Ba);vo<ja;){for(Y(li,hi,vo,ja),vo++,ja--;hi[2*vo+po]<Vo;)vo++;for(;hi[2*ja+po]>Vo;)ja--}hi[2*Ci+po]===Vo?Y(li,hi,Ci,ja):Y(li,hi,++ja,Ba),ja<=ra&&(Ci=ja+1),ra<=ja&&(Ba=ja-1)}})(wn,qr,Kr,Mn,bi,wi%2),Wr(wn,qr,Qr,Mn,Kr-1,wi+1),Wr(wn,qr,Qr,Kr+1,bi,wi+1)}})(wr,Le,Se,0,wr.length-1,0)};er.prototype.range=function(Rt,Wt,oe,Se){return function(ze,fr,wr,Le,ur,Wr,wn){for(var qr,Qr,Mn=[0,ze.length-1,0],bi=[];Mn.length;){var wi=Mn.pop(),Kr=Mn.pop(),ai=Mn.pop();if(Kr-ai<=wn)for(var li=ai;li<=Kr;li++)Qr=fr[2*li+1],(qr=fr[2*li])>=wr&&qr<=ur&&Qr>=Le&&Qr<=Wr&&bi.push(ze[li]);else{var hi=Math.floor((ai+Kr)/2);Qr=fr[2*hi+1],(qr=fr[2*hi])>=wr&&qr<=ur&&Qr>=Le&&Qr<=Wr&&bi.push(ze[hi]);var ra=(wi+1)%2;(wi===0?wr<=qr:Le<=Qr)&&(Mn.push(ai),Mn.push(hi-1),Mn.push(ra)),(wi===0?ur>=qr:Wr>=Qr)&&(Mn.push(hi+1),Mn.push(Kr),Mn.push(ra))}}return bi}(this.ids,this.coords,Rt,Wt,oe,Se,this.nodeSize)},er.prototype.within=function(Rt,Wt,oe){return function(Se,ze,fr,wr,Le,ur){for(var Wr=[0,Se.length-1,0],wn=[],qr=Le*Le;Wr.length;){var Qr=Wr.pop(),Mn=Wr.pop(),bi=Wr.pop();if(Mn-bi<=ur)for(var wi=bi;wi<=Mn;wi++)Xt(ze[2*wi],ze[2*wi+1],fr,wr)<=qr&&wn.push(Se[wi]);else{var Kr=Math.floor((bi+Mn)/2),ai=ze[2*Kr],li=ze[2*Kr+1];Xt(ai,li,fr,wr)<=qr&&wn.push(Se[Kr]);var hi=(Qr+1)%2;(Qr===0?fr-Le<=ai:wr-Le<=li)&&(Wr.push(bi),Wr.push(Kr-1),Wr.push(hi)),(Qr===0?fr+Le>=ai:wr+Le>=li)&&(Wr.push(Kr+1),Wr.push(Mn),Wr.push(hi))}}return wn}(this.ids,this.coords,Rt,Wt,oe,this.nodeSize)};var Ht={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Rt){return Rt}},ne=function(Rt){this.options=Et(Object.create(Ht),Rt),this.trees=new Array(this.options.maxZoom+1)};function Me(Rt,Wt,oe,Se,ze){return{x:Rt,y:Wt,zoom:1/0,id:oe,parentId:-1,numPoints:Se,properties:ze}}function ae(Rt,Wt){var oe=Rt.geometry.coordinates,Se=oe[1];return{x:re(oe[0]),y:Jt(Se),zoom:1/0,index:Wt,parentId:-1}}function Je(Rt){return{type:"Feature",id:Rt.id,properties:or(Rt),geometry:{type:"Point",coordinates:[(Se=Rt.x,360*(Se-.5)),(Wt=Rt.y,oe=(180-360*Wt)*Math.PI/180,360*Math.atan(Math.exp(oe))/Math.PI-90)]}};var Wt,oe,Se}function or(Rt){var Wt=Rt.numPoints,oe=Wt>=1e4?Math.round(Wt/1e3)+"k":Wt>=1e3?Math.round(Wt/100)/10+"k":Wt;return Et(Et({},Rt.properties),{cluster:!0,cluster_id:Rt.id,point_count:Wt,point_count_abbreviated:oe})}function re(Rt){return Rt/360+.5}function Jt(Rt){var Wt=Math.sin(Rt*Math.PI/180),oe=.5-.25*Math.log((1+Wt)/(1-Wt))/Math.PI;return oe<0?0:oe>1?1:oe}function Et(Rt,Wt){for(var oe in Wt)Rt[oe]=Wt[oe];return Rt}function $t(Rt){return Rt.x}function Yt(Rt){return Rt.y}function St(Rt,Wt,oe,Se,ze,fr){var wr=ze-oe,Le=fr-Se;if(wr!==0||Le!==0){var ur=((Rt-oe)*wr+(Wt-Se)*Le)/(wr*wr+Le*Le);ur>1?(oe=ze,Se=fr):ur>0&&(oe+=wr*ur,Se+=Le*ur)}return(wr=Rt-oe)*wr+(Le=Wt-Se)*Le}function At(Rt,Wt,oe,Se){var ze={id:Rt===void 0?null:Rt,type:Wt,geometry:oe,tags:Se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(fr){var wr=fr.geometry,Le=fr.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")ue(fr,wr);else if(Le==="Polygon"||Le==="MultiLineString")for(var ur=0;ur<wr.length;ur++)ue(fr,wr[ur]);else if(Le==="MultiPolygon")for(ur=0;ur<wr.length;ur++)for(var Wr=0;Wr<wr[ur].length;Wr++)ue(fr,wr[ur][Wr])}(ze),ze}function ue(Rt,Wt){for(var oe=0;oe<Wt.length;oe+=3)Rt.minX=Math.min(Rt.minX,Wt[oe]),Rt.minY=Math.min(Rt.minY,Wt[oe+1]),Rt.maxX=Math.max(Rt.maxX,Wt[oe]),Rt.maxY=Math.max(Rt.maxY,Wt[oe+1])}function Pe(Rt,Wt,oe,Se){if(Wt.geometry){var ze=Wt.geometry.coordinates,fr=Wt.geometry.type,wr=Math.pow(oe.tolerance/((1<<oe.maxZoom)*oe.extent),2),Le=[],ur=Wt.id;if(oe.promoteId?ur=Wt.properties[oe.promoteId]:oe.generateId&&(ur=Se||0),fr==="Point")je(ze,Le);else if(fr==="MultiPoint")for(var Wr=0;Wr<ze.length;Wr++)je(ze[Wr],Le);else if(fr==="LineString")Nt(ze,Le,wr,!1);else if(fr==="MultiLineString"){if(oe.lineMetrics){for(Wr=0;Wr<ze.length;Wr++)Nt(ze[Wr],Le=[],wr,!1),Rt.push(At(ur,"LineString",Le,Wt.properties));return}wt(ze,Le,wr,!1)}else if(fr==="Polygon")wt(ze,Le,wr,!0);else{if(fr!=="MultiPolygon"){if(fr==="GeometryCollection"){for(Wr=0;Wr<Wt.geometry.geometries.length;Wr++)Pe(Rt,{id:ur,geometry:Wt.geometry.geometries[Wr],properties:Wt.properties},oe,Se);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Wr=0;Wr<ze.length;Wr++){var wn=[];wt(ze[Wr],wn,wr,!0),Le.push(wn)}}Rt.push(At(ur,fr,Le,Wt.properties))}}function je(Rt,Wt){Wt.push(Tt(Rt[0])),Wt.push(Ft(Rt[1])),Wt.push(0)}function Nt(Rt,Wt,oe,Se){for(var ze,fr,wr=0,Le=0;Le<Rt.length;Le++){var ur=Tt(Rt[Le][0]),Wr=Ft(Rt[Le][1]);Wt.push(ur),Wt.push(Wr),Wt.push(0),Le>0&&(wr+=Se?(ze*Wr-ur*fr)/2:Math.sqrt(Math.pow(ur-ze,2)+Math.pow(Wr-fr,2))),ze=ur,fr=Wr}var wn=Wt.length-3;Wt[2]=1,function qr(Qr,Mn,bi,wi){for(var Kr,ai=wi,li=bi-Mn>>1,hi=bi-Mn,ra=Qr[Mn],Ci=Qr[Mn+1],Ba=Qr[bi],po=Qr[bi+1],za=Mn+3;za<bi;za+=3){var Xa=St(Qr[za],Qr[za+1],ra,Ci,Ba,po);if(Xa>ai)Kr=za,ai=Xa;else if(Xa===ai){var Ta=Math.abs(za-li);Ta<hi&&(Kr=za,hi=Ta)}}ai>wi&&(Kr-Mn>3&&qr(Qr,Mn,Kr,wi),Qr[Kr+2]=ai,bi-Kr>3&&qr(Qr,Kr,bi,wi))}(Wt,0,wn,oe),Wt[wn+2]=1,Wt.size=Math.abs(wr),Wt.start=0,Wt.end=Wt.size}function wt(Rt,Wt,oe,Se){for(var ze=0;ze<Rt.length;ze++){var fr=[];Nt(Rt[ze],fr,oe,Se),Wt.push(fr)}}function Tt(Rt){return Rt/360+.5}function Ft(Rt){var Wt=Math.sin(Rt*Math.PI/180),oe=.5-.25*Math.log((1+Wt)/(1-Wt))/Math.PI;return oe<0?0:oe>1?1:oe}function J(Rt,Wt,oe,Se,ze,fr,wr,Le){if(Se/=Wt,fr>=(oe/=Wt)&&wr<Se)return Rt;if(wr<oe||fr>=Se)return null;for(var ur=[],Wr=0;Wr<Rt.length;Wr++){var wn=Rt[Wr],qr=wn.geometry,Qr=wn.type,Mn=ze===0?wn.minX:wn.minY,bi=ze===0?wn.maxX:wn.maxY;if(Mn>=oe&&bi<Se)ur.push(wn);else if(!(bi<oe||Mn>=Se)){var wi=[];if(Qr==="Point"||Qr==="MultiPoint")gt(qr,wi,oe,Se,ze);else if(Qr==="LineString")jt(qr,wi,oe,Se,ze,!1,Le.lineMetrics);else if(Qr==="MultiLineString")Gt(qr,wi,oe,Se,ze,!1);else if(Qr==="Polygon")Gt(qr,wi,oe,Se,ze,!0);else if(Qr==="MultiPolygon")for(var Kr=0;Kr<qr.length;Kr++){var ai=[];Gt(qr[Kr],ai,oe,Se,ze,!0),ai.length&&wi.push(ai)}if(wi.length){if(Le.lineMetrics&&Qr==="LineString"){for(Kr=0;Kr<wi.length;Kr++)ur.push(At(wn.id,Qr,wi[Kr],wn.tags));continue}Qr!=="LineString"&&Qr!=="MultiLineString"||(wi.length===1?(Qr="LineString",wi=wi[0]):Qr="MultiLineString"),Qr!=="Point"&&Qr!=="MultiPoint"||(Qr=wi.length===3?"Point":"MultiPoint"),ur.push(At(wn.id,Qr,wi,wn.tags))}}}return ur.length?ur:null}function gt(Rt,Wt,oe,Se,ze){for(var fr=0;fr<Rt.length;fr+=3){var wr=Rt[fr+ze];wr>=oe&&wr<=Se&&(Wt.push(Rt[fr]),Wt.push(Rt[fr+1]),Wt.push(Rt[fr+2]))}}function jt(Rt,Wt,oe,Se,ze,fr,wr){for(var Le,ur,Wr=ve(Rt),wn=ze===0?He:qe,qr=Rt.start,Qr=0;Qr<Rt.length-3;Qr+=3){var Mn=Rt[Qr],bi=Rt[Qr+1],wi=Rt[Qr+2],Kr=Rt[Qr+3],ai=Rt[Qr+4],li=ze===0?Mn:bi,hi=ze===0?Kr:ai,ra=!1;wr&&(Le=Math.sqrt(Math.pow(Mn-Kr,2)+Math.pow(bi-ai,2))),li<oe?hi>oe&&(ur=wn(Wr,Mn,bi,Kr,ai,oe),wr&&(Wr.start=qr+Le*ur)):li>Se?hi<Se&&(ur=wn(Wr,Mn,bi,Kr,ai,Se),wr&&(Wr.start=qr+Le*ur)):Ae(Wr,Mn,bi,wi),hi<oe&&li>=oe&&(ur=wn(Wr,Mn,bi,Kr,ai,oe),ra=!0),hi>Se&&li<=Se&&(ur=wn(Wr,Mn,bi,Kr,ai,Se),ra=!0),!fr&&ra&&(wr&&(Wr.end=qr+Le*ur),Wt.push(Wr),Wr=ve(Rt)),wr&&(qr+=Le)}var Ci=Rt.length-3;Mn=Rt[Ci],bi=Rt[Ci+1],wi=Rt[Ci+2],(li=ze===0?Mn:bi)>=oe&&li<=Se&&Ae(Wr,Mn,bi,wi),Ci=Wr.length-3,fr&&Ci>=3&&(Wr[Ci]!==Wr[0]||Wr[Ci+1]!==Wr[1])&&Ae(Wr,Wr[0],Wr[1],Wr[2]),Wr.length&&Wt.push(Wr)}function ve(Rt){var Wt=[];return Wt.size=Rt.size,Wt.start=Rt.start,Wt.end=Rt.end,Wt}function Gt(Rt,Wt,oe,Se,ze,fr){for(var wr=0;wr<Rt.length;wr++)jt(Rt[wr],Wt,oe,Se,ze,fr,!1)}function Ae(Rt,Wt,oe,Se){Rt.push(Wt),Rt.push(oe),Rt.push(Se)}function He(Rt,Wt,oe,Se,ze,fr){var wr=(fr-Wt)/(Se-Wt);return Rt.push(fr),Rt.push(oe+(ze-oe)*wr),Rt.push(1),wr}function qe(Rt,Wt,oe,Se,ze,fr){var wr=(fr-oe)/(ze-oe);return Rt.push(Wt+(Se-Wt)*wr),Rt.push(fr),Rt.push(1),wr}function hr(Rt,Wt){for(var oe=[],Se=0;Se<Rt.length;Se++){var ze,fr=Rt[Se],wr=fr.type;if(wr==="Point"||wr==="MultiPoint"||wr==="LineString")ze=tr(fr.geometry,Wt);else if(wr==="MultiLineString"||wr==="Polygon"){ze=[];for(var Le=0;Le<fr.geometry.length;Le++)ze.push(tr(fr.geometry[Le],Wt))}else if(wr==="MultiPolygon")for(ze=[],Le=0;Le<fr.geometry.length;Le++){for(var ur=[],Wr=0;Wr<fr.geometry[Le].length;Wr++)ur.push(tr(fr.geometry[Le][Wr],Wt));ze.push(ur)}oe.push(At(fr.id,wr,ze,fr.tags))}return oe}function tr(Rt,Wt){var oe=[];oe.size=Rt.size,Rt.start!==void 0&&(oe.start=Rt.start,oe.end=Rt.end);for(var Se=0;Se<Rt.length;Se+=3)oe.push(Rt[Se]+Wt,Rt[Se+1],Rt[Se+2]);return oe}function Br(Rt,Wt){if(Rt.transformed)return Rt;var oe,Se,ze,fr=1<<Rt.z,wr=Rt.x,Le=Rt.y;for(oe=0;oe<Rt.features.length;oe++){var ur=Rt.features[oe],Wr=ur.geometry,wn=ur.type;if(ur.geometry=[],wn===1)for(Se=0;Se<Wr.length;Se+=2)ur.geometry.push(Lr(Wr[Se],Wr[Se+1],Wt,fr,wr,Le));else for(Se=0;Se<Wr.length;Se++){var qr=[];for(ze=0;ze<Wr[Se].length;ze+=2)qr.push(Lr(Wr[Se][ze],Wr[Se][ze+1],Wt,fr,wr,Le));ur.geometry.push(qr)}}return Rt.transformed=!0,Rt}function Lr(Rt,Wt,oe,Se,ze,fr){return[Math.round(oe*(Rt*Se-ze)),Math.round(oe*(Wt*Se-fr))]}function Zr(Rt,Wt,oe,Se,ze){for(var fr=Wt===ze.maxZoom?0:ze.tolerance/((1<<Wt)*ze.extent),wr={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:oe,y:Se,z:Wt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Le=0;Le<Rt.length;Le++){wr.numFeatures++,Tn(wr,Rt[Le],fr,ze);var ur=Rt[Le].minX,Wr=Rt[Le].minY,wn=Rt[Le].maxX,qr=Rt[Le].maxY;ur<wr.minX&&(wr.minX=ur),Wr<wr.minY&&(wr.minY=Wr),wn>wr.maxX&&(wr.maxX=wn),qr>wr.maxY&&(wr.maxY=qr)}return wr}function Tn(Rt,Wt,oe,Se){var ze=Wt.geometry,fr=Wt.type,wr=[];if(fr==="Point"||fr==="MultiPoint")for(var Le=0;Le<ze.length;Le+=3)wr.push(ze[Le]),wr.push(ze[Le+1]),Rt.numPoints++,Rt.numSimplified++;else if(fr==="LineString")rn(wr,ze,Rt,oe,!1,!1);else if(fr==="MultiLineString"||fr==="Polygon")for(Le=0;Le<ze.length;Le++)rn(wr,ze[Le],Rt,oe,fr==="Polygon",Le===0);else if(fr==="MultiPolygon")for(var ur=0;ur<ze.length;ur++){var Wr=ze[ur];for(Le=0;Le<Wr.length;Le++)rn(wr,Wr[Le],Rt,oe,!0,Le===0)}if(wr.length){var wn=Wt.tags||null;if(fr==="LineString"&&Se.lineMetrics){for(var qr in wn={},Wt.tags)wn[qr]=Wt.tags[qr];wn.mapbox_clip_start=ze.start/ze.size,wn.mapbox_clip_end=ze.end/ze.size}var Qr={geometry:wr,type:fr==="Polygon"||fr==="MultiPolygon"?3:fr==="LineString"||fr==="MultiLineString"?2:1,tags:wn};Wt.id!==null&&(Qr.id=Wt.id),Rt.features.push(Qr)}}function rn(Rt,Wt,oe,Se,ze,fr){var wr=Se*Se;if(Se>0&&Wt.size<(ze?wr:Se))oe.numPoints+=Wt.length/3;else{for(var Le=[],ur=0;ur<Wt.length;ur+=3)(Se===0||Wt[ur+2]>wr)&&(oe.numSimplified++,Le.push(Wt[ur]),Le.push(Wt[ur+1])),oe.numPoints++;ze&&function(Wr,wn){for(var qr=0,Qr=0,Mn=Wr.length,bi=Mn-2;Qr<Mn;bi=Qr,Qr+=2)qr+=(Wr[Qr]-Wr[bi])*(Wr[Qr+1]+Wr[bi+1]);if(qr>0===wn)for(Qr=0,Mn=Wr.length;Qr<Mn/2;Qr+=2){var wi=Wr[Qr],Kr=Wr[Qr+1];Wr[Qr]=Wr[Mn-2-Qr],Wr[Qr+1]=Wr[Mn-1-Qr],Wr[Mn-2-Qr]=wi,Wr[Mn-1-Qr]=Kr}}(Le,fr),Rt.push(Le)}}function Nn(Rt,Wt){var oe=(Wt=this.options=function(ze,fr){for(var wr in fr)ze[wr]=fr[wr];return ze}(Object.create(this.options),Wt)).debug;if(oe&&console.time("preprocess data"),Wt.maxZoom<0||Wt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Wt.promoteId&&Wt.generateId)throw new Error("promoteId and generateId cannot be used together.");var Se=function(ze,fr){var wr=[];if(ze.type==="FeatureCollection")for(var Le=0;Le<ze.features.length;Le++)Pe(wr,ze.features[Le],fr,Le);else Pe(wr,ze.type==="Feature"?ze:{geometry:ze},fr);return wr}(Rt,Wt);this.tiles={},this.tileCoords=[],oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Wt.indexMaxZoom,Wt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Se=function(ze,fr){var wr=fr.buffer/fr.extent,Le=ze,ur=J(ze,1,-1-wr,wr,0,-1,2,fr),Wr=J(ze,1,1-wr,2+wr,0,-1,2,fr);return(ur||Wr)&&(Le=J(ze,1,-wr,1+wr,0,-1,2,fr)||[],ur&&(Le=hr(ur,1).concat(Le)),Wr&&(Le=Le.concat(hr(Wr,-1)))),Le}(Se,Wt)).length&&this.splitTile(Se,0,0,0),oe&&(Se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function zn(Rt,Wt,oe){return 32*((1<<Rt)*oe+Wt)+Rt}function jn(Rt,Wt){var oe=Rt.tileID.canonical;if(!this._geoJSONIndex)return Wt(null,null);var Se=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!Se)return Wt(null,null);var ze=new Ee(Se.features),fr=we(ze);fr.byteOffset===0&&fr.byteLength===fr.buffer.byteLength||(fr=new Uint8Array(fr)),Wt(null,{vectorTile:ze,rawData:fr.buffer})}ne.prototype.load=function(Rt){var Wt=this.options,oe=Wt.log,Se=Wt.minZoom,ze=Wt.maxZoom,fr=Wt.nodeSize;oe&&console.time("total time");var wr="prepare "+Rt.length+" points";oe&&console.time(wr),this.points=Rt;for(var Le=[],ur=0;ur<Rt.length;ur++)Rt[ur].geometry&&Le.push(ae(Rt[ur],ur));this.trees[ze+1]=new er(Le,$t,Yt,fr,Float32Array),oe&&console.timeEnd(wr);for(var Wr=ze;Wr>=Se;Wr--){var wn=+Date.now();Le=this._cluster(Le,Wr),this.trees[Wr]=new er(Le,$t,Yt,fr,Float32Array),oe&&console.log("z%d: %d clusters in %dms",Wr,Le.length,+Date.now()-wn)}return oe&&console.timeEnd("total time"),this},ne.prototype.getClusters=function(Rt,Wt){var oe=((Rt[0]+180)%360+360)%360-180,Se=Math.max(-90,Math.min(90,Rt[1])),ze=Rt[2]===180?180:((Rt[2]+180)%360+360)%360-180,fr=Math.max(-90,Math.min(90,Rt[3]));if(Rt[2]-Rt[0]>=360)oe=-180,ze=180;else if(oe>ze){var wr=this.getClusters([oe,Se,180,fr],Wt),Le=this.getClusters([-180,Se,ze,fr],Wt);return wr.concat(Le)}for(var ur=this.trees[this._limitZoom(Wt)],Wr=[],wn=0,qr=ur.range(re(oe),Jt(fr),re(ze),Jt(Se));wn<qr.length;wn+=1){var Qr=ur.points[qr[wn]];Wr.push(Qr.numPoints?Je(Qr):this.points[Qr.index])}return Wr},ne.prototype.getChildren=function(Rt){var Wt=this._getOriginId(Rt),oe=this._getOriginZoom(Rt),Se="No cluster with the specified id.",ze=this.trees[oe];if(!ze)throw new Error(Se);var fr=ze.points[Wt];if(!fr)throw new Error(Se);for(var wr=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),Le=[],ur=0,Wr=ze.within(fr.x,fr.y,wr);ur<Wr.length;ur+=1){var wn=ze.points[Wr[ur]];wn.parentId===Rt&&Le.push(wn.numPoints?Je(wn):this.points[wn.index])}if(Le.length===0)throw new Error(Se);return Le},ne.prototype.getLeaves=function(Rt,Wt,oe){var Se=[];return this._appendLeaves(Se,Rt,Wt=Wt||10,oe=oe||0,0),Se},ne.prototype.getTile=function(Rt,Wt,oe){var Se=this.trees[this._limitZoom(Rt)],ze=Math.pow(2,Rt),fr=this.options,wr=fr.radius/fr.extent,Le=(oe-wr)/ze,ur=(oe+1+wr)/ze,Wr={features:[]};return this._addTileFeatures(Se.range((Wt-wr)/ze,Le,(Wt+1+wr)/ze,ur),Se.points,Wt,oe,ze,Wr),Wt===0&&this._addTileFeatures(Se.range(1-wr/ze,Le,1,ur),Se.points,ze,oe,ze,Wr),Wt===ze-1&&this._addTileFeatures(Se.range(0,Le,wr/ze,ur),Se.points,-1,oe,ze,Wr),Wr.features.length?Wr:null},ne.prototype.getClusterExpansionZoom=function(Rt){for(var Wt=this._getOriginZoom(Rt)-1;Wt<=this.options.maxZoom;){var oe=this.getChildren(Rt);if(Wt++,oe.length!==1)break;Rt=oe[0].properties.cluster_id}return Wt},ne.prototype._appendLeaves=function(Rt,Wt,oe,Se,ze){for(var fr=0,wr=this.getChildren(Wt);fr<wr.length;fr+=1){var Le=wr[fr],ur=Le.properties;if(ur&&ur.cluster?ze+ur.point_count<=Se?ze+=ur.point_count:ze=this._appendLeaves(Rt,ur.cluster_id,oe,Se,ze):ze<Se?ze++:Rt.push(Le),Rt.length===oe)break}return ze},ne.prototype._addTileFeatures=function(Rt,Wt,oe,Se,ze,fr){for(var wr=0,Le=Rt;wr<Le.length;wr+=1){var ur=Wt[Le[wr]],Wr=ur.numPoints,wn={type:1,geometry:[[Math.round(this.options.extent*(ur.x*ze-oe)),Math.round(this.options.extent*(ur.y*ze-Se))]],tags:Wr?or(ur):this.points[ur.index].properties},qr=void 0;Wr?qr=ur.id:this.options.generateId?qr=ur.index:this.points[ur.index].id&&(qr=this.points[ur.index].id),qr!==void 0&&(wn.id=qr),fr.features.push(wn)}},ne.prototype._limitZoom=function(Rt){return Math.max(this.options.minZoom,Math.min(+Rt,this.options.maxZoom+1))},ne.prototype._cluster=function(Rt,Wt){for(var oe=[],Se=this.options,ze=Se.reduce,fr=Se.minPoints,wr=Se.radius/(Se.extent*Math.pow(2,Wt)),Le=0;Le<Rt.length;Le++){var ur=Rt[Le];if(!(ur.zoom<=Wt)){ur.zoom=Wt;for(var Wr=this.trees[Wt+1],wn=Wr.within(ur.x,ur.y,wr),qr=ur.numPoints||1,Qr=qr,Mn=0,bi=wn;Mn<bi.length;Mn+=1){var wi=Wr.points[bi[Mn]];wi.zoom>Wt&&(Qr+=wi.numPoints||1)}if(Qr>=fr){for(var Kr=ur.x*qr,ai=ur.y*qr,li=ze&&qr>1?this._map(ur,!0):null,hi=(Le<<5)+(Wt+1)+this.points.length,ra=0,Ci=wn;ra<Ci.length;ra+=1){var Ba=Wr.points[Ci[ra]];if(!(Ba.zoom<=Wt)){Ba.zoom=Wt;var po=Ba.numPoints||1;Kr+=Ba.x*po,ai+=Ba.y*po,Ba.parentId=hi,ze&&(li||(li=this._map(ur,!0)),ze(li,this._map(Ba)))}}ur.parentId=hi,oe.push(Me(Kr/Qr,ai/Qr,hi,Qr,li))}else if(oe.push(ur),Qr>1)for(var za=0,Xa=wn;za<Xa.length;za+=1){var Ta=Wr.points[Xa[za]];Ta.zoom<=Wt||(Ta.zoom=Wt,oe.push(Ta))}}}return oe},ne.prototype._getOriginId=function(Rt){return Rt-this.points.length>>5},ne.prototype._getOriginZoom=function(Rt){return(Rt-this.points.length)%32},ne.prototype._map=function(Rt,Wt){if(Rt.numPoints)return Wt?Et({},Rt.properties):Rt.properties;var oe=this.points[Rt.index].properties,Se=this.options.map(oe);return Wt&&Se===oe?Et({},Se):Se},Nn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Nn.prototype.splitTile=function(Rt,Wt,oe,Se,ze,fr,wr){for(var Le=[Rt,Wt,oe,Se],ur=this.options,Wr=ur.debug;Le.length;){Se=Le.pop(),oe=Le.pop(),Wt=Le.pop(),Rt=Le.pop();var wn=1<<Wt,qr=zn(Wt,oe,Se),Qr=this.tiles[qr];if(!Qr&&(Wr>1&&console.time("creation"),Qr=this.tiles[qr]=Zr(Rt,Wt,oe,Se,ur),this.tileCoords.push({z:Wt,x:oe,y:Se}),Wr)){Wr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Wt,oe,Se,Qr.numFeatures,Qr.numPoints,Qr.numSimplified),console.timeEnd("creation"));var Mn="z"+Wt;this.stats[Mn]=(this.stats[Mn]||0)+1,this.total++}if(Qr.source=Rt,ze){if(Wt===ur.maxZoom||Wt===ze)continue;var bi=1<<ze-Wt;if(oe!==Math.floor(fr/bi)||Se!==Math.floor(wr/bi))continue}else if(Wt===ur.indexMaxZoom||Qr.numPoints<=ur.indexMaxPoints)continue;if(Qr.source=null,Rt.length!==0){Wr>1&&console.time("clipping");var wi,Kr,ai,li,hi,ra,Ci=.5*ur.buffer/ur.extent,Ba=.5-Ci,po=.5+Ci,za=1+Ci;wi=Kr=ai=li=null,hi=J(Rt,wn,oe-Ci,oe+po,0,Qr.minX,Qr.maxX,ur),ra=J(Rt,wn,oe+Ba,oe+za,0,Qr.minX,Qr.maxX,ur),Rt=null,hi&&(wi=J(hi,wn,Se-Ci,Se+po,1,Qr.minY,Qr.maxY,ur),Kr=J(hi,wn,Se+Ba,Se+za,1,Qr.minY,Qr.maxY,ur),hi=null),ra&&(ai=J(ra,wn,Se-Ci,Se+po,1,Qr.minY,Qr.maxY,ur),li=J(ra,wn,Se+Ba,Se+za,1,Qr.minY,Qr.maxY,ur),ra=null),Wr>1&&console.timeEnd("clipping"),Le.push(wi||[],Wt+1,2*oe,2*Se),Le.push(Kr||[],Wt+1,2*oe,2*Se+1),Le.push(ai||[],Wt+1,2*oe+1,2*Se),Le.push(li||[],Wt+1,2*oe+1,2*Se+1)}}},Nn.prototype.getTile=function(Rt,Wt,oe){var Se=this.options,ze=Se.extent,fr=Se.debug;if(Rt<0||Rt>24)return null;var wr=1<<Rt,Le=zn(Rt,Wt=(Wt%wr+wr)%wr,oe);if(this.tiles[Le])return Br(this.tiles[Le],ze);fr>1&&console.log("drilling down to z%d-%d-%d",Rt,Wt,oe);for(var ur,Wr=Rt,wn=Wt,qr=oe;!ur&&Wr>0;)Wr--,wn=Math.floor(wn/2),qr=Math.floor(qr/2),ur=this.tiles[zn(Wr,wn,qr)];return ur&&ur.source?(fr>1&&console.log("found parent tile z%d-%d-%d",Wr,wn,qr),fr>1&&console.time("drilling down"),this.splitTile(ur.source,Wr,wn,qr,Rt,Wt,oe),fr>1&&console.timeEnd("drilling down"),this.tiles[Le]?Br(this.tiles[Le],ze):null):null};var Sn=function(Rt){function Wt(oe,Se,ze,fr){Rt.call(this,oe,Se,ze,jn),fr&&(this.loadGeoJSON=fr)}return Rt&&(Wt.__proto__=Rt),(Wt.prototype=Object.create(Rt&&Rt.prototype)).constructor=Wt,Wt.prototype.loadData=function(oe,Se){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Se,this._pendingLoadDataParams=oe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Wt.prototype._loadData=function(){var oe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Se=this._pendingCallback,ze=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var fr=!!(ze&&ze.request&&ze.request.collectResourceTiming)&&new I.RequestPerformance(ze.request);this.loadGeoJSON(ze,function(wr,Le){if(wr||!Le)return Se(wr);if(typeof Le!="object")return Se(new Error("Input data given to '"+ze.source+"' is not a valid GeoJSON object."));(function Qr(Mn,bi){var wi,Kr=Mn&&Mn.type;if(Kr==="FeatureCollection")for(wi=0;wi<Mn.features.length;wi++)Qr(Mn.features[wi],bi);else if(Kr==="GeometryCollection")for(wi=0;wi<Mn.geometries.length;wi++)Qr(Mn.geometries[wi],bi);else if(Kr==="Feature")Qr(Mn.geometry,bi);else if(Kr==="Polygon")P(Mn.coordinates,bi);else if(Kr==="MultiPolygon")for(wi=0;wi<Mn.coordinates.length;wi++)P(Mn.coordinates[wi],bi);return Mn})(Le,!0);try{if(ze.filter){var ur=I.createExpression(ze.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ur.result==="error")throw new Error(ur.value.map(function(Qr){return Qr.key+": "+Qr.message}).join(", "));var Wr=Le.features.filter(function(Qr){return ur.value.evaluate({zoom:0},Qr)});Le={type:"FeatureCollection",features:Wr}}oe._geoJSONIndex=ze.cluster?new ne(function(Qr){var Mn=Qr.superclusterOptions,bi=Qr.clusterProperties;if(!bi||!Mn)return Mn;for(var wi={},Kr={},ai={accumulated:null,zoom:0},li={properties:null},hi=Object.keys(bi),ra=0,Ci=hi;ra<Ci.length;ra+=1){var Ba=Ci[ra],po=bi[Ba],za=po[0],Xa=I.createExpression(po[1]),Ta=I.createExpression(typeof za=="string"?[za,["accumulated"],["get",Ba]]:za);wi[Ba]=Xa.value,Kr[Ba]=Ta.value}return Mn.map=function(ga){li.properties=ga;for(var no={},Vo=0,vo=hi;Vo<vo.length;Vo+=1){var ja=vo[Vo];no[ja]=wi[ja].evaluate(ai,li)}return no},Mn.reduce=function(ga,no){li.properties=no;for(var Vo=0,vo=hi;Vo<vo.length;Vo+=1){var ja=vo[Vo];ai.accumulated=ga[ja],ga[ja]=Kr[ja].evaluate(ai,li)}},Mn}(ze)).load(Le.features):function(Qr,Mn){return new Nn(Qr,Mn)}(Le,ze.geojsonVtOptions)}catch(Qr){return Se(Qr)}oe.loaded={};var wn={};if(fr){var qr=fr.finish();qr&&(wn.resourceTiming={},wn.resourceTiming[ze.source]=JSON.parse(JSON.stringify(qr)))}Se(null,wn)})}},Wt.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Wt.prototype.reloadTile=function(oe,Se){var ze=this.loaded;return ze&&ze[oe.uid]?Rt.prototype.reloadTile.call(this,oe,Se):this.loadTile(oe,Se)},Wt.prototype.loadGeoJSON=function(oe,Se){if(oe.request)I.getJSON(oe.request,Se);else{if(typeof oe.data!="string")return Se(new Error("Input data given to '"+oe.source+"' is not a valid GeoJSON object."));try{return Se(null,JSON.parse(oe.data))}catch(ze){return Se(new Error("Input data given to '"+oe.source+"' is not a valid GeoJSON object."))}}},Wt.prototype.removeSource=function(oe,Se){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Se()},Wt.prototype.getClusterExpansionZoom=function(oe,Se){try{Se(null,this._geoJSONIndex.getClusterExpansionZoom(oe.clusterId))}catch(ze){Se(ze)}},Wt.prototype.getClusterChildren=function(oe,Se){try{Se(null,this._geoJSONIndex.getChildren(oe.clusterId))}catch(ze){Se(ze)}},Wt.prototype.getClusterLeaves=function(oe,Se){try{Se(null,this._geoJSONIndex.getLeaves(oe.clusterId,oe.limit,oe.offset))}catch(ze){Se(ze)}},Wt}(it),Wn=function(Rt){var Wt=this;this.self=Rt,this.actor=new I.Actor(Rt,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:it,geojson:Sn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(oe,Se){if(Wt.workerSourceTypes[oe])throw new Error('Worker source with name "'+oe+'" already registered.');Wt.workerSourceTypes[oe]=Se},this.self.registerRTLTextPlugin=function(oe){if(I.plugin.isParsed())throw new Error("RTL text plugin already registered.");I.plugin.applyArabicShaping=oe.applyArabicShaping,I.plugin.processBidirectionalText=oe.processBidirectionalText,I.plugin.processStyledBidirectionalText=oe.processStyledBidirectionalText}};return Wn.prototype.setReferrer=function(Rt,Wt){this.referrer=Wt},Wn.prototype.setImages=function(Rt,Wt,oe){for(var Se in this.availableImages[Rt]=Wt,this.workerSources[Rt]){var ze=this.workerSources[Rt][Se];for(var fr in ze)ze[fr].availableImages=Wt}oe()},Wn.prototype.setLayers=function(Rt,Wt,oe){this.getLayerIndex(Rt).replace(Wt),oe()},Wn.prototype.updateLayers=function(Rt,Wt,oe){this.getLayerIndex(Rt).update(Wt.layers,Wt.removedIds),oe()},Wn.prototype.loadTile=function(Rt,Wt,oe){this.getWorkerSource(Rt,Wt.type,Wt.source).loadTile(Wt,oe)},Wn.prototype.loadDEMTile=function(Rt,Wt,oe){this.getDEMWorkerSource(Rt,Wt.source).loadTile(Wt,oe)},Wn.prototype.reloadTile=function(Rt,Wt,oe){this.getWorkerSource(Rt,Wt.type,Wt.source).reloadTile(Wt,oe)},Wn.prototype.abortTile=function(Rt,Wt,oe){this.getWorkerSource(Rt,Wt.type,Wt.source).abortTile(Wt,oe)},Wn.prototype.removeTile=function(Rt,Wt,oe){this.getWorkerSource(Rt,Wt.type,Wt.source).removeTile(Wt,oe)},Wn.prototype.removeDEMTile=function(Rt,Wt){this.getDEMWorkerSource(Rt,Wt.source).removeTile(Wt)},Wn.prototype.removeSource=function(Rt,Wt,oe){if(this.workerSources[Rt]&&this.workerSources[Rt][Wt.type]&&this.workerSources[Rt][Wt.type][Wt.source]){var Se=this.workerSources[Rt][Wt.type][Wt.source];delete this.workerSources[Rt][Wt.type][Wt.source],Se.removeSource!==void 0?Se.removeSource(Wt,oe):oe()}},Wn.prototype.loadWorkerSource=function(Rt,Wt,oe){try{this.self.importScripts(Wt.url),oe()}catch(Se){oe(Se.toString())}},Wn.prototype.syncRTLPluginState=function(Rt,Wt,oe){try{I.plugin.setState(Wt);var Se=I.plugin.getPluginURL();if(I.plugin.isLoaded()&&!I.plugin.isParsed()&&Se!=null){this.self.importScripts(Se);var ze=I.plugin.isParsed();oe(ze?void 0:new Error("RTL Text Plugin failed to import scripts from "+Se),ze)}}catch(fr){oe(fr.toString())}},Wn.prototype.getAvailableImages=function(Rt){var Wt=this.availableImages[Rt];return Wt||(Wt=[]),Wt},Wn.prototype.getLayerIndex=function(Rt){var Wt=this.layerIndexes[Rt];return Wt||(Wt=this.layerIndexes[Rt]=new ut),Wt},Wn.prototype.getWorkerSource=function(Rt,Wt,oe){var Se=this;return this.workerSources[Rt]||(this.workerSources[Rt]={}),this.workerSources[Rt][Wt]||(this.workerSources[Rt][Wt]={}),this.workerSources[Rt][Wt][oe]||(this.workerSources[Rt][Wt][oe]=new this.workerSourceTypes[Wt]({send:function(ze,fr,wr){Se.actor.send(ze,fr,wr,Rt)}},this.getLayerIndex(Rt),this.getAvailableImages(Rt))),this.workerSources[Rt][Wt][oe]},Wn.prototype.getDEMWorkerSource=function(Rt,Wt){return this.demWorkerSources[Rt]||(this.demWorkerSources[Rt]={}),this.demWorkerSources[Rt][Wt]||(this.demWorkerSources[Rt][Wt]=new Ut),this.demWorkerSources[Rt][Wt]},Wn.prototype.enforceCacheSizeLimit=function(Rt,Wt){I.enforceCacheSizeLimit(Wt)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Wn(self)),Wn}),bt(["./shared"],function(I){"use strict";var xt=I.createCommonjsModule(function(x){function C(z){return!S(z)}function S(z){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var $,ft,zt=new Blob([""],{type:"text/javascript"}),ee=URL.createObjectURL(zt);try{ft=new Worker(ee),$=!0}catch(Re){$=!1}return ft&&ft.terminate(),URL.revokeObjectURL(ee),$}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var $=document.createElement("canvas");$.width=$.height=1;var ft=$.getContext("2d");if(!ft)return!1;var zt=ft.getImageData(0,0,1,1);return zt&&zt.width===$.width}()?(M[H=z&&z.failIfMajorPerformanceCaveat]===void 0&&(M[H]=function($){var ft=function(ee){var Re=document.createElement("canvas"),De=Object.create(C.webGLContextAttributes);return De.failIfMajorPerformanceCaveat=ee,Re.probablySupportsContext?Re.probablySupportsContext("webgl",De)||Re.probablySupportsContext("experimental-webgl",De):Re.supportsContext?Re.supportsContext("webgl",De)||Re.supportsContext("experimental-webgl",De):Re.getContext("webgl",De)||Re.getContext("experimental-webgl",De)}($);if(!ft)return!1;var zt=ft.createShader(ft.VERTEX_SHADER);return!(!zt||ft.isContextLost())&&(ft.shaderSource(zt,"void main() {}"),ft.compileShader(zt),ft.getShaderParameter(zt,ft.COMPILE_STATUS)===!0)}(H)),M[H]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var H}x.exports?x.exports=C:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=C,window.mapboxgl.notSupportedReason=S);var M={};C.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),K={create:function(x,C,S){var M=I.window.document.createElement(x);return C!==void 0&&(M.className=C),S&&S.appendChild(M),M},createNS:function(x,C){return I.window.document.createElementNS(x,C)}},ut=I.window.document&&I.window.document.documentElement.style;function ht(x){if(!ut)return x[0];for(var C=0;C<x.length;C++)if(x[C]in ut)return x[C];return x[0]}var lt,tt=ht(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);K.disableDrag=function(){ut&&tt&&(lt=ut[tt],ut[tt]="none")},K.enableDrag=function(){ut&&tt&&(ut[tt]=lt)};var be=ht(["transform","WebkitTransform"]);K.setTransform=function(x,C){x.style[be]=C};var it=!1;try{var st=Object.defineProperty({},"passive",{get:function(){it=!0}});I.window.addEventListener("test",st,st),I.window.removeEventListener("test",st,st)}catch(x){it=!1}K.addEventListener=function(x,C,S,M){M===void 0&&(M={}),x.addEventListener(C,S,"passive"in M&&it?M:M.capture)},K.removeEventListener=function(x,C,S,M){M===void 0&&(M={}),x.removeEventListener(C,S,"passive"in M&&it?M:M.capture)};var Ut=function(x){x.preventDefault(),x.stopPropagation(),I.window.removeEventListener("click",Ut,!0)};function P(x){var C=x.userImage;return!!(C&&C.render&&C.render())&&(x.data.replace(new Uint8Array(C.data.buffer)),!0)}K.suppressClick=function(){I.window.addEventListener("click",Ut,!0),I.window.setTimeout(function(){I.window.removeEventListener("click",Ut,!0)},0)},K.mousePos=function(x,C){var S=x.getBoundingClientRect();return new I.Point(C.clientX-S.left-x.clientLeft,C.clientY-S.top-x.clientTop)},K.touchPos=function(x,C){for(var S=x.getBoundingClientRect(),M=[],z=0;z<C.length;z++)M.push(new I.Point(C[z].clientX-S.left-x.clientLeft,C[z].clientY-S.top-x.clientTop));return M},K.mouseButton=function(x){return I.window.InstallTrigger!==void 0&&x.button===2&&x.ctrlKey&&I.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:x.button},K.remove=function(x){x.parentNode&&x.parentNode.removeChild(x)};var b=function(x){function C(){x.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new I.RGBAImage({width:1,height:1}),this.dirty=!0}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.isLoaded=function(){return this.loaded},C.prototype.setLoaded=function(S){if(this.loaded!==S&&(this.loaded=S,S)){for(var M=0,z=this.requestors;M<z.length;M+=1){var H=z[M];this._notify(H.ids,H.callback)}this.requestors=[]}},C.prototype.getImage=function(S){return this.images[S]},C.prototype.addImage=function(S,M){this._validate(S,M)&&(this.images[S]=M)},C.prototype._validate=function(S,M){var z=!0;return this._validateStretch(M.stretchX,M.data&&M.data.width)||(this.fire(new I.ErrorEvent(new Error('Image "'+S+'" has invalid "stretchX" value'))),z=!1),this._validateStretch(M.stretchY,M.data&&M.data.height)||(this.fire(new I.ErrorEvent(new Error('Image "'+S+'" has invalid "stretchY" value'))),z=!1),this._validateContent(M.content,M)||(this.fire(new I.ErrorEvent(new Error('Image "'+S+'" has invalid "content" value'))),z=!1),z},C.prototype._validateStretch=function(S,M){if(!S)return!0;for(var z=0,H=0,$=S;H<$.length;H+=1){var ft=$[H];if(ft[0]<z||ft[1]<ft[0]||M<ft[1])return!1;z=ft[1]}return!0},C.prototype._validateContent=function(S,M){return!(S&&(S.length!==4||S[0]<0||M.data.width<S[0]||S[1]<0||M.data.height<S[1]||S[2]<0||M.data.width<S[2]||S[3]<0||M.data.height<S[3]||S[2]<S[0]||S[3]<S[1]))},C.prototype.updateImage=function(S,M){M.version=this.images[S].version+1,this.images[S]=M,this.updatedImages[S]=!0},C.prototype.removeImage=function(S){var M=this.images[S];delete this.images[S],delete this.patterns[S],M.userImage&&M.userImage.onRemove&&M.userImage.onRemove()},C.prototype.listImages=function(){return Object.keys(this.images)},C.prototype.getImages=function(S,M){var z=!0;if(!this.isLoaded())for(var H=0,$=S;H<$.length;H+=1)this.images[$[H]]||(z=!1);this.isLoaded()||z?this._notify(S,M):this.requestors.push({ids:S,callback:M})},C.prototype._notify=function(S,M){for(var z={},H=0,$=S;H<$.length;H+=1){var ft=$[H];this.images[ft]||this.fire(new I.Event("styleimagemissing",{id:ft}));var zt=this.images[ft];zt?z[ft]={data:zt.data.clone(),pixelRatio:zt.pixelRatio,sdf:zt.sdf,version:zt.version,stretchX:zt.stretchX,stretchY:zt.stretchY,content:zt.content,hasRenderCallback:Boolean(zt.userImage&&zt.userImage.render)}:I.warnOnce('Image "'+ft+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}M(null,z)},C.prototype.getPixelSize=function(){var S=this.atlasImage;return{width:S.width,height:S.height}},C.prototype.getPattern=function(S){var M=this.patterns[S],z=this.getImage(S);if(!z)return null;if(M&&M.position.version===z.version)return M.position;if(M)M.position.version=z.version;else{var H={w:z.data.width+2,h:z.data.height+2,x:0,y:0},$=new I.ImagePosition(H,z);this.patterns[S]={bin:H,position:$}}return this._updatePatternAtlas(),this.patterns[S].position},C.prototype.bind=function(S){var M=S.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new I.Texture(S,this.atlasImage,M.RGBA),this.atlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE)},C.prototype._updatePatternAtlas=function(){var S=[];for(var M in this.patterns)S.push(this.patterns[M].bin);var z=I.potpack(S),H=z.w,$=z.h,ft=this.atlasImage;for(var zt in ft.resize({width:H||1,height:$||1}),this.patterns){var ee=this.patterns[zt].bin,Re=ee.x+1,De=ee.y+1,ke=this.images[zt].data,cr=ke.width,ar=ke.height;I.RGBAImage.copy(ke,ft,{x:0,y:0},{x:Re,y:De},{width:cr,height:ar}),I.RGBAImage.copy(ke,ft,{x:0,y:ar-1},{x:Re,y:De-1},{width:cr,height:1}),I.RGBAImage.copy(ke,ft,{x:0,y:0},{x:Re,y:De+ar},{width:cr,height:1}),I.RGBAImage.copy(ke,ft,{x:cr-1,y:0},{x:Re-1,y:De},{width:1,height:ar}),I.RGBAImage.copy(ke,ft,{x:0,y:0},{x:Re+cr,y:De},{width:1,height:ar})}this.dirty=!0},C.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},C.prototype.dispatchRenderCallbacks=function(S){for(var M=0,z=S;M<z.length;M+=1){var H=z[M];if(!this.callbackDispatchedThisFrame[H]){this.callbackDispatchedThisFrame[H]=!0;var $=this.images[H];P($)&&this.updateImage(H,$)}}},C}(I.Evented),W=Te,fe=Te,Ee=1e20;function Te(x,C,S,M,z,H){this.fontSize=x||24,this.buffer=C===void 0?3:C,this.cutoff=M||.25,this.fontFamily=z||"sans-serif",this.fontWeight=H||"normal",this.radius=S||8;var $=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=$,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array($*$),this.gridInner=new Float64Array($*$),this.f=new Float64Array($),this.d=new Float64Array($),this.z=new Float64Array($+1),this.v=new Int16Array($),this.middle=Math.round($/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Mt(x,C,S,M,z,H,$){for(var ft=0;ft<C;ft++){for(var zt=0;zt<S;zt++)M[zt]=x[zt*C+ft];for(et(M,z,H,$,S),zt=0;zt<S;zt++)x[zt*C+ft]=z[zt]}for(zt=0;zt<S;zt++){for(ft=0;ft<C;ft++)M[ft]=x[zt*C+ft];for(et(M,z,H,$,C),ft=0;ft<C;ft++)x[zt*C+ft]=Math.sqrt(z[ft])}}function et(x,C,S,M,z){S[0]=0,M[0]=-Ee,M[1]=+Ee;for(var H=1,$=0;H<z;H++){for(var ft=(x[H]+H*H-(x[S[$]]+S[$]*S[$]))/(2*H-2*S[$]);ft<=M[$];)$--,ft=(x[H]+H*H-(x[S[$]]+S[$]*S[$]))/(2*H-2*S[$]);S[++$]=H,M[$]=ft,M[$+1]=+Ee}for(H=0,$=0;H<z;H++){for(;M[$+1]<H;)$++;C[H]=(H-S[$])*(H-S[$])+x[S[$]]}}Te.prototype.draw=function(x){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(x,this.buffer,this.middle);for(var C=this.ctx.getImageData(0,0,this.size,this.size),S=new Uint8ClampedArray(this.size*this.size),M=0;M<this.size*this.size;M++){var z=C.data[4*M+3]/255;this.gridOuter[M]=z===1?0:z===0?Ee:Math.pow(Math.max(0,.5-z),2),this.gridInner[M]=z===1?Ee:z===0?0:Math.pow(Math.max(0,z-.5),2)}for(Mt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Mt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),M=0;M<this.size*this.size;M++)S[M]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[M]-this.gridInner[M])/this.radius+this.cutoff))));return S},W.default=fe;var Dt=function(x,C){this.requestManager=x,this.localIdeographFontFamily=C,this.entries={}};Dt.prototype.setURL=function(x){this.url=x},Dt.prototype.getGlyphs=function(x,C){var S=this,M=[];for(var z in x)for(var H=0,$=x[z];H<$.length;H+=1)M.push({stack:z,id:$[H]});I.asyncAll(M,function(ft,zt){var ee=ft.stack,Re=ft.id,De=S.entries[ee];De||(De=S.entries[ee]={glyphs:{},requests:{},ranges:{}});var ke=De.glyphs[Re];if(ke===void 0){if(ke=S._tinySDF(De,ee,Re))return De.glyphs[Re]=ke,void zt(null,{stack:ee,id:Re,glyph:ke});var cr=Math.floor(Re/256);if(256*cr>65535)zt(new Error("glyphs > 65535 not supported"));else if(De.ranges[cr])zt(null,{stack:ee,id:Re,glyph:ke});else{var ar=De.requests[cr];ar||(ar=De.requests[cr]=[],Dt.loadGlyphRange(ee,cr,S.url,S.requestManager,function(br,rr){if(rr){for(var xr in rr)S._doesCharSupportLocalGlyph(+xr)||(De.glyphs[+xr]=rr[+xr]);De.ranges[cr]=!0}for(var Pr=0,Rr=ar;Pr<Rr.length;Pr+=1)(0,Rr[Pr])(br,rr);delete De.requests[cr]})),ar.push(function(br,rr){br?zt(br):rr&&zt(null,{stack:ee,id:Re,glyph:rr[Re]||null})})}}else zt(null,{stack:ee,id:Re,glyph:ke})},function(ft,zt){if(ft)C(ft);else if(zt){for(var ee={},Re=0,De=zt;Re<De.length;Re+=1){var ke=De[Re],cr=ke.stack,ar=ke.id,br=ke.glyph;(ee[cr]||(ee[cr]={}))[ar]=br&&{id:br.id,bitmap:br.bitmap.clone(),metrics:br.metrics}}C(null,ee)}})},Dt.prototype._doesCharSupportLocalGlyph=function(x){return!!this.localIdeographFontFamily&&(I.isChar["CJK Unified Ideographs"](x)||I.isChar["Hangul Syllables"](x)||I.isChar.Hiragana(x)||I.isChar.Katakana(x))},Dt.prototype._tinySDF=function(x,C,S){var M=this.localIdeographFontFamily;if(M&&this._doesCharSupportLocalGlyph(S)){var z=x.tinySDF;if(!z){var H="400";/bold/i.test(C)?H="900":/medium/i.test(C)?H="500":/light/i.test(C)&&(H="200"),z=x.tinySDF=new Dt.TinySDF(24,3,8,.25,M,H)}return{id:S,bitmap:new I.AlphaImage({width:30,height:30},z.draw(String.fromCharCode(S))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Dt.loadGlyphRange=function(x,C,S,M,z){var H=256*C,$=H+255,ft=M.transformRequest(M.normalizeGlyphsURL(S).replace("{fontstack}",x).replace("{range}",H+"-"+$),I.ResourceType.Glyphs);I.getArrayBuffer(ft,function(zt,ee){if(zt)z(zt);else if(ee){for(var Re={},De=0,ke=I.parseGlyphPBF(ee);De<ke.length;De+=1){var cr=ke[De];Re[cr.id]=cr}z(null,Re)}})},Dt.TinySDF=W;var we=function(){this.specification=I.styleSpec.light.position};we.prototype.possiblyEvaluate=function(x,C){return I.sphericalToCartesian(x.expression.evaluate(C))},we.prototype.interpolate=function(x,C,S){return{x:I.number(x.x,C.x,S),y:I.number(x.y,C.y,S),z:I.number(x.z,C.z,S)}};var _e=new I.Properties({anchor:new I.DataConstantProperty(I.styleSpec.light.anchor),position:new we,color:new I.DataConstantProperty(I.styleSpec.light.color),intensity:new I.DataConstantProperty(I.styleSpec.light.intensity)}),ge=function(x){function C(S){x.call(this),this._transitionable=new I.Transitionable(_e),this.setLight(S),this._transitioning=this._transitionable.untransitioned()}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getLight=function(){return this._transitionable.serialize()},C.prototype.setLight=function(S,M){if(M===void 0&&(M={}),!this._validate(I.validateLight,S,M))for(var z in S){var H=S[z];I.endsWith(z,"-transition")?this._transitionable.setTransition(z.slice(0,-11),H):this._transitionable.setValue(z,H)}},C.prototype.updateTransitions=function(S){this._transitioning=this._transitionable.transitioned(S,this._transitioning)},C.prototype.hasTransition=function(){return this._transitioning.hasTransition()},C.prototype.recalculate=function(S){this.properties=this._transitioning.possiblyEvaluate(S)},C.prototype._validate=function(S,M,z){return(!z||z.validate!==!1)&&I.emitValidationErrors(this,S.call(I.validateStyle,I.extend({value:M,style:{glyphs:!0,sprite:!0},styleSpec:I.styleSpec})))},C}(I.Evented),te=function(x,C){this.width=x,this.height=C,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};te.prototype.getDash=function(x,C){var S=x.join(",")+String(C);return this.dashEntry[S]||(this.dashEntry[S]=this.addDash(x,C)),this.dashEntry[S]},te.prototype.getDashRanges=function(x,C,S){var M=[],z=x.length%2==1?-x[x.length-1]*S:0,H=x[0]*S,$=!0;M.push({left:z,right:H,isDash:$,zeroLength:x[0]===0});for(var ft=x[0],zt=1;zt<x.length;zt++){var ee=x[zt];M.push({left:z=ft*S,right:H=(ft+=ee)*S,isDash:$=!$,zeroLength:ee===0})}return M},te.prototype.addRoundDash=function(x,C,S){for(var M=C/2,z=-S;z<=S;z++)for(var H=this.width*(this.nextRow+S+z),$=0,ft=x[$],zt=0;zt<this.width;zt++){zt/ft.right>1&&(ft=x[++$]);var ee=Math.abs(zt-ft.left),Re=Math.abs(zt-ft.right),De=Math.min(ee,Re),ke=void 0,cr=z/S*(M+1);if(ft.isDash){var ar=M-Math.abs(cr);ke=Math.sqrt(De*De+ar*ar)}else ke=M-Math.sqrt(De*De+cr*cr);this.data[H+zt]=Math.max(0,Math.min(255,ke+128))}},te.prototype.addRegularDash=function(x){for(var C=x.length-1;C>=0;--C){var S=x[C],M=x[C+1];S.zeroLength?x.splice(C,1):M&&M.isDash===S.isDash&&(M.left=S.left,x.splice(C,1))}var z=x[0],H=x[x.length-1];z.isDash===H.isDash&&(z.left=H.left-this.width,H.right=z.right+this.width);for(var $=this.width*this.nextRow,ft=0,zt=x[ft],ee=0;ee<this.width;ee++){ee/zt.right>1&&(zt=x[++ft]);var Re=Math.abs(ee-zt.left),De=Math.abs(ee-zt.right),ke=Math.min(Re,De);this.data[$+ee]=Math.max(0,Math.min(255,(zt.isDash?ke:-ke)+128))}},te.prototype.addDash=function(x,C){var S=C?7:0,M=2*S+1;if(this.nextRow+M>this.height)return I.warnOnce("LineAtlas out of space"),null;for(var z=0,H=0;H<x.length;H++)z+=x[H];if(z!==0){var $=this.width/z,ft=this.getDashRanges(x,this.width,$);C?this.addRoundDash(ft,$,S):this.addRegularDash(ft)}var zt={y:(this.nextRow+S+.5)/this.height,height:2*S/this.height,width:z};return this.nextRow+=M,this.dirty=!0,zt},te.prototype.bind=function(x){var C=x.gl;this.texture?(C.bindTexture(C.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,C.texSubImage2D(C.TEXTURE_2D,0,0,0,this.width,this.height,C.ALPHA,C.UNSIGNED_BYTE,this.data))):(this.texture=C.createTexture(),C.bindTexture(C.TEXTURE_2D,this.texture),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,C.REPEAT),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,C.REPEAT),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,C.LINEAR),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,C.LINEAR),C.texImage2D(C.TEXTURE_2D,0,C.ALPHA,this.width,this.height,0,C.ALPHA,C.UNSIGNED_BYTE,this.data))};var xe=function x(C,S){this.workerPool=C,this.actors=[],this.currentActor=0,this.id=I.uniqueId();for(var M=this.workerPool.acquire(this.id),z=0;z<M.length;z++){var H=new x.Actor(M[z],S,this.id);H.name="Worker "+z,this.actors.push(H)}};function Ye(x,C,S){var M=function(z,H){if(z)return S(z);if(H){var $=I.pick(I.extend(H,x),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);H.vector_layers&&($.vectorLayers=H.vector_layers,$.vectorLayerIds=$.vectorLayers.map(function(ft){return ft.id})),$.tiles=C.canonicalizeTileset($,x.url),S(null,$)}};return x.url?I.getJSON(C.transformRequest(C.normalizeSourceURL(x.url),I.ResourceType.Source),M):I.browser.frame(function(){return M(null,x)})}xe.prototype.broadcast=function(x,C,S){I.asyncAll(this.actors,function(M,z){M.send(x,C,z)},S=S||function(){})},xe.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},xe.prototype.remove=function(){this.actors.forEach(function(x){x.remove()}),this.actors=[],this.workerPool.release(this.id)},xe.Actor=I.Actor;var Lt=function(x,C,S){this.bounds=I.LngLatBounds.convert(this.validateBounds(x)),this.minzoom=C||0,this.maxzoom=S||24};Lt.prototype.validateBounds=function(x){return Array.isArray(x)&&x.length===4?[Math.max(-180,x[0]),Math.max(-90,x[1]),Math.min(180,x[2]),Math.min(90,x[3])]:[-180,-90,180,90]},Lt.prototype.contains=function(x){var C=Math.pow(2,x.z),S=Math.floor(I.mercatorXfromLng(this.bounds.getWest())*C),M=Math.floor(I.mercatorYfromLat(this.bounds.getNorth())*C),z=Math.ceil(I.mercatorXfromLng(this.bounds.getEast())*C),H=Math.ceil(I.mercatorYfromLat(this.bounds.getSouth())*C);return x.x>=S&&x.x<z&&x.y>=M&&x.y<H};var Qt=function(x){function C(S,M,z,H){if(x.call(this),this.id=S,this.dispatcher=z,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,I.extend(this,I.pick(M,["url","scheme","tileSize","promoteId"])),this._options=I.extend({type:"vector"},M),this._collectResourceTiming=M.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(H)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var S=this;this._loaded=!1,this.fire(new I.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ye(this._options,this.map._requestManager,function(M,z){S._tileJSONRequest=null,S._loaded=!0,M?S.fire(new I.ErrorEvent(M)):z&&(I.extend(S,z),z.bounds&&(S.tileBounds=new Lt(z.bounds,S.minzoom,S.maxzoom)),I.postTurnstileEvent(z.tiles,S.map._requestManager._customAccessToken),I.postMapLoadEvent(z.tiles,S.map._getMapId(),S.map._requestManager._skuToken,S.map._requestManager._customAccessToken),S.fire(new I.Event("data",{dataType:"source",sourceDataType:"metadata"})),S.fire(new I.Event("data",{dataType:"source",sourceDataType:"content"})))})},C.prototype.loaded=function(){return this._loaded},C.prototype.hasTile=function(S){return!this.tileBounds||this.tileBounds.contains(S.canonical)},C.prototype.onAdd=function(S){this.map=S,this.load()},C.prototype.setSourceProperty=function(S){this._tileJSONRequest&&this._tileJSONRequest.cancel(),S(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},C.prototype.setTiles=function(S){var M=this;return this.setSourceProperty(function(){M._options.tiles=S}),this},C.prototype.setUrl=function(S){var M=this;return this.setSourceProperty(function(){M.url=S,M._options.url=S}),this},C.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},C.prototype.serialize=function(){return I.extend({},this._options)},C.prototype.loadTile=function(S,M){var z=this.map._requestManager.normalizeTileURL(S.tileID.canonical.url(this.tiles,this.scheme)),H={request:this.map._requestManager.transformRequest(z,I.ResourceType.Tile),uid:S.uid,tileID:S.tileID,zoom:S.tileID.overscaledZ,tileSize:this.tileSize*S.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:I.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function $(ft,zt){return delete S.request,S.aborted?M(null):ft&&ft.status!==404?M(ft):(zt&&zt.resourceTiming&&(S.resourceTiming=zt.resourceTiming),this.map._refreshExpiredTiles&&zt&&S.setExpiryData(zt),S.loadVectorData(zt,this.map.painter),I.cacheEntryPossiblyAdded(this.dispatcher),M(null),void(S.reloadCallback&&(this.loadTile(S,S.reloadCallback),S.reloadCallback=null)))}H.request.collectResourceTiming=this._collectResourceTiming,S.actor&&S.state!=="expired"?S.state==="loading"?S.reloadCallback=M:S.request=S.actor.send("reloadTile",H,$.bind(this)):(S.actor=this.dispatcher.getActor(),S.request=S.actor.send("loadTile",H,$.bind(this)))},C.prototype.abortTile=function(S){S.request&&(S.request.cancel(),delete S.request),S.actor&&S.actor.send("abortTile",{uid:S.uid,type:this.type,source:this.id},void 0)},C.prototype.unloadTile=function(S){S.unloadVectorData(),S.actor&&S.actor.send("removeTile",{uid:S.uid,type:this.type,source:this.id},void 0)},C.prototype.hasTransition=function(){return!1},C}(I.Evented),ct=function(x){function C(S,M,z,H){x.call(this),this.id=S,this.dispatcher=z,this.setEventedParent(H),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=I.extend({type:"raster"},M),I.extend(this,I.pick(M,["url","scheme","tileSize"]))}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var S=this;this._loaded=!1,this.fire(new I.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ye(this._options,this.map._requestManager,function(M,z){S._tileJSONRequest=null,S._loaded=!0,M?S.fire(new I.ErrorEvent(M)):z&&(I.extend(S,z),z.bounds&&(S.tileBounds=new Lt(z.bounds,S.minzoom,S.maxzoom)),I.postTurnstileEvent(z.tiles),I.postMapLoadEvent(z.tiles,S.map._getMapId(),S.map._requestManager._skuToken),S.fire(new I.Event("data",{dataType:"source",sourceDataType:"metadata"})),S.fire(new I.Event("data",{dataType:"source",sourceDataType:"content"})))})},C.prototype.loaded=function(){return this._loaded},C.prototype.onAdd=function(S){this.map=S,this.load()},C.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},C.prototype.serialize=function(){return I.extend({},this._options)},C.prototype.hasTile=function(S){return!this.tileBounds||this.tileBounds.contains(S.canonical)},C.prototype.loadTile=function(S,M){var z=this,H=this.map._requestManager.normalizeTileURL(S.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);S.request=I.getImage(this.map._requestManager.transformRequest(H,I.ResourceType.Tile),function($,ft){if(delete S.request,S.aborted)S.state="unloaded",M(null);else if($)S.state="errored",M($);else if(ft){z.map._refreshExpiredTiles&&S.setExpiryData(ft),delete ft.cacheControl,delete ft.expires;var zt=z.map.painter.context,ee=zt.gl;S.texture=z.map.painter.getTileTexture(ft.width),S.texture?S.texture.update(ft,{useMipmap:!0}):(S.texture=new I.Texture(zt,ft,ee.RGBA,{useMipmap:!0}),S.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE,ee.LINEAR_MIPMAP_NEAREST),zt.extTextureFilterAnisotropic&&ee.texParameterf(ee.TEXTURE_2D,zt.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,zt.extTextureFilterAnisotropicMax)),S.state="loaded",I.cacheEntryPossiblyAdded(z.dispatcher),M(null)}})},C.prototype.abortTile=function(S,M){S.request&&(S.request.cancel(),delete S.request),M()},C.prototype.unloadTile=function(S,M){S.texture&&this.map.painter.saveTileTexture(S.texture),M()},C.prototype.hasTransition=function(){return!1},C}(I.Evented),Ct=function(x){function C(S,M,z,H){x.call(this,S,M,z,H),this.type="raster-dem",this.maxzoom=22,this._options=I.extend({type:"raster-dem"},M),this.encoding=M.encoding||"mapbox"}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},C.prototype.loadTile=function(S,M){var z=this.map._requestManager.normalizeTileURL(S.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function H($,ft){$&&(S.state="errored",M($)),ft&&(S.dem=ft,S.needsHillshadePrepare=!0,S.state="loaded",M(null))}S.request=I.getImage(this.map._requestManager.transformRequest(z,I.ResourceType.Tile),function($,ft){if(delete S.request,S.aborted)S.state="unloaded",M(null);else if($)S.state="errored",M($);else if(ft){this.map._refreshExpiredTiles&&S.setExpiryData(ft),delete ft.cacheControl,delete ft.expires;var zt=I.window.ImageBitmap&&ft instanceof I.window.ImageBitmap&&I.offscreenCanvasSupported()?ft:I.browser.getImageData(ft,1),ee={uid:S.uid,coord:S.tileID,source:this.id,rawImageData:zt,encoding:this.encoding};S.actor&&S.state!=="expired"||(S.actor=this.dispatcher.getActor(),S.actor.send("loadDEMTile",ee,H.bind(this)))}}.bind(this)),S.neighboringTiles=this._getNeighboringTiles(S.tileID)},C.prototype._getNeighboringTiles=function(S){var M=S.canonical,z=Math.pow(2,M.z),H=(M.x-1+z)%z,$=M.x===0?S.wrap-1:S.wrap,ft=(M.x+1+z)%z,zt=M.x+1===z?S.wrap+1:S.wrap,ee={};return ee[new I.OverscaledTileID(S.overscaledZ,$,M.z,H,M.y).key]={backfilled:!1},ee[new I.OverscaledTileID(S.overscaledZ,zt,M.z,ft,M.y).key]={backfilled:!1},M.y>0&&(ee[new I.OverscaledTileID(S.overscaledZ,$,M.z,H,M.y-1).key]={backfilled:!1},ee[new I.OverscaledTileID(S.overscaledZ,S.wrap,M.z,M.x,M.y-1).key]={backfilled:!1},ee[new I.OverscaledTileID(S.overscaledZ,zt,M.z,ft,M.y-1).key]={backfilled:!1}),M.y+1<z&&(ee[new I.OverscaledTileID(S.overscaledZ,$,M.z,H,M.y+1).key]={backfilled:!1},ee[new I.OverscaledTileID(S.overscaledZ,S.wrap,M.z,M.x,M.y+1).key]={backfilled:!1},ee[new I.OverscaledTileID(S.overscaledZ,zt,M.z,ft,M.y+1).key]={backfilled:!1}),ee},C.prototype.unloadTile=function(S){S.demTexture&&this.map.painter.saveTileTexture(S.demTexture),S.fbo&&(S.fbo.destroy(),delete S.fbo),S.dem&&delete S.dem,delete S.neighboringTiles,S.state="unloaded",S.actor&&S.actor.send("removeDEMTile",{uid:S.uid,source:this.id})},C}(ct),Y=function(x){function C(S,M,z,H){x.call(this),this.id=S,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=z.getActor(),this.setEventedParent(H),this._data=M.data,this._options=I.extend({},M),this._collectResourceTiming=M.collectResourceTiming,this._resourceTiming=[],M.maxzoom!==void 0&&(this.maxzoom=M.maxzoom),M.type&&(this.type=M.type),M.attribution&&(this.attribution=M.attribution),this.promoteId=M.promoteId;var $=I.EXTENT/this.tileSize;this.workerOptions=I.extend({source:this.id,cluster:M.cluster||!1,geojsonVtOptions:{buffer:(M.buffer!==void 0?M.buffer:128)*$,tolerance:(M.tolerance!==void 0?M.tolerance:.375)*$,extent:I.EXTENT,maxZoom:this.maxzoom,lineMetrics:M.lineMetrics||!1,generateId:M.generateId||!1},superclusterOptions:{maxZoom:M.clusterMaxZoom!==void 0?Math.min(M.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,M.clusterMinPoints||2),extent:I.EXTENT,radius:(M.clusterRadius||50)*$,log:!1,generateId:M.generateId||!1},clusterProperties:M.clusterProperties,filter:M.filter},M.workerOptions)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var S=this;this.fire(new I.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(M){if(M)S.fire(new I.ErrorEvent(M));else{var z={dataType:"source",sourceDataType:"metadata"};S._collectResourceTiming&&S._resourceTiming&&S._resourceTiming.length>0&&(z.resourceTiming=S._resourceTiming,S._resourceTiming=[]),S.fire(new I.Event("data",z))}})},C.prototype.onAdd=function(S){this.map=S,this.load()},C.prototype.setData=function(S){var M=this;return this._data=S,this.fire(new I.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(z){if(z)M.fire(new I.ErrorEvent(z));else{var H={dataType:"source",sourceDataType:"content"};M._collectResourceTiming&&M._resourceTiming&&M._resourceTiming.length>0&&(H.resourceTiming=M._resourceTiming,M._resourceTiming=[]),M.fire(new I.Event("data",H))}}),this},C.prototype.getClusterExpansionZoom=function(S,M){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:S,source:this.id},M),this},C.prototype.getClusterChildren=function(S,M){return this.actor.send("geojson.getClusterChildren",{clusterId:S,source:this.id},M),this},C.prototype.getClusterLeaves=function(S,M,z,H){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:S,limit:M,offset:z},H),this},C.prototype._updateWorkerData=function(S){var M=this;this._loaded=!1;var z=I.extend({},this.workerOptions),H=this._data;typeof H=="string"?(z.request=this.map._requestManager.transformRequest(I.browser.resolveURL(H),I.ResourceType.Source),z.request.collectResourceTiming=this._collectResourceTiming):z.data=JSON.stringify(H),this.actor.send(this.type+".loadData",z,function($,ft){M._removed||ft&&ft.abandoned||(M._loaded=!0,ft&&ft.resourceTiming&&ft.resourceTiming[M.id]&&(M._resourceTiming=ft.resourceTiming[M.id].slice(0)),M.actor.send(M.type+".coalesce",{source:z.source},null),S($))})},C.prototype.loaded=function(){return this._loaded},C.prototype.loadTile=function(S,M){var z=this,H=S.actor?"reloadTile":"loadTile";S.actor=this.actor,S.request=this.actor.send(H,{type:this.type,uid:S.uid,tileID:S.tileID,zoom:S.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:I.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function($,ft){return delete S.request,S.unloadVectorData(),S.aborted?M(null):$?M($):(S.loadVectorData(ft,z.map.painter,H==="reloadTile"),M(null))})},C.prototype.abortTile=function(S){S.request&&(S.request.cancel(),delete S.request),S.aborted=!0},C.prototype.unloadTile=function(S){S.unloadVectorData(),this.actor.send("removeTile",{uid:S.uid,type:this.type,source:this.id})},C.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},C.prototype.serialize=function(){return I.extend({},this._options,{type:this.type,data:this._data})},C.prototype.hasTransition=function(){return!1},C}(I.Evented),yt=I.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Xt=function(x){function C(S,M,z,H){x.call(this),this.id=S,this.dispatcher=z,this.coordinates=M.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(H),this.options=M}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(S,M){var z=this;this._loaded=!1,this.fire(new I.Event("dataloading",{dataType:"source"})),this.url=this.options.url,I.getImage(this.map._requestManager.transformRequest(this.url,I.ResourceType.Image),function(H,$){z._loaded=!0,H?z.fire(new I.ErrorEvent(H)):$&&(z.image=$,S&&(z.coordinates=S),M&&M(),z._finishLoading())})},C.prototype.loaded=function(){return this._loaded},C.prototype.updateImage=function(S){var M=this;return this.image&&S.url?(this.options.url=S.url,this.load(S.coordinates,function(){M.texture=null}),this):this},C.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new I.Event("data",{dataType:"source",sourceDataType:"metadata"})))},C.prototype.onAdd=function(S){this.map=S,this.load()},C.prototype.setCoordinates=function(S){var M=this;this.coordinates=S;var z=S.map(I.MercatorCoordinate.fromLngLat);this.tileID=function($){for(var ft=1/0,zt=1/0,ee=-1/0,Re=-1/0,De=0,ke=$;De<ke.length;De+=1){var cr=ke[De];ft=Math.min(ft,cr.x),zt=Math.min(zt,cr.y),ee=Math.max(ee,cr.x),Re=Math.max(Re,cr.y)}var ar=Math.max(ee-ft,Re-zt),br=Math.max(0,Math.floor(-Math.log(ar)/Math.LN2)),rr=Math.pow(2,br);return new I.CanonicalTileID(br,Math.floor((ft+ee)/2*rr),Math.floor((zt+Re)/2*rr))}(z),this.minzoom=this.maxzoom=this.tileID.z;var H=z.map(function($){return M.tileID.getTilePoint($)._round()});return this._boundsArray=new I.StructArrayLayout4i8,this._boundsArray.emplaceBack(H[0].x,H[0].y,0,0),this._boundsArray.emplaceBack(H[1].x,H[1].y,I.EXTENT,0),this._boundsArray.emplaceBack(H[3].x,H[3].y,0,I.EXTENT),this._boundsArray.emplaceBack(H[2].x,H[2].y,I.EXTENT,I.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new I.Event("data",{dataType:"source",sourceDataType:"content"})),this},C.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var S=this.map.painter.context,M=S.gl;for(var z in this.boundsBuffer||(this.boundsBuffer=S.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=I.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new I.Texture(S,this.image,M.RGBA),this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE)),this.tiles){var H=this.tiles[z];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}}},C.prototype.loadTile=function(S,M){this.tileID&&this.tileID.equals(S.tileID.canonical)?(this.tiles[String(S.tileID.wrap)]=S,S.buckets={},M(null)):(S.state="errored",M(null))},C.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},C.prototype.hasTransition=function(){return!1},C}(I.Evented),ie=function(x){function C(S,M,z,H){x.call(this,S,M,z,H),this.roundZoom=!0,this.type="video",this.options=M}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var S=this;this._loaded=!1;var M=this.options;this.urls=[];for(var z=0,H=M.urls;z<H.length;z+=1)this.urls.push(this.map._requestManager.transformRequest(H[z],I.ResourceType.Source).url);I.getVideo(this.urls,function($,ft){S._loaded=!0,$?S.fire(new I.ErrorEvent($)):ft&&(S.video=ft,S.video.loop=!0,S.video.addEventListener("playing",function(){S.map.triggerRepaint()}),S.map&&S.video.play(),S._finishLoading())})},C.prototype.pause=function(){this.video&&this.video.pause()},C.prototype.play=function(){this.video&&this.video.play()},C.prototype.seek=function(S){if(this.video){var M=this.video.seekable;S<M.start(0)||S>M.end(0)?this.fire(new I.ErrorEvent(new I.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+M.start(0)+" and "+M.end(0)+"-second mark."))):this.video.currentTime=S}},C.prototype.getVideo=function(){return this.video},C.prototype.onAdd=function(S){this.map||(this.map=S,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},C.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var S=this.map.painter.context,M=S.gl;for(var z in this.boundsBuffer||(this.boundsBuffer=S.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=I.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE),M.texSubImage2D(M.TEXTURE_2D,0,0,0,M.RGBA,M.UNSIGNED_BYTE,this.video)):(this.texture=new I.Texture(S,this.video,M.RGBA),this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE)),this.tiles){var H=this.tiles[z];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}}},C.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},C.prototype.hasTransition=function(){return this.video&&!this.video.paused},C}(Xt),Ce=function(x){function C(S,M,z,H){x.call(this,S,M,z,H),M.coordinates?Array.isArray(M.coordinates)&&M.coordinates.length===4&&!M.coordinates.some(function($){return!Array.isArray($)||$.length!==2||$.some(function(ft){return typeof ft!="number"})})||this.fire(new I.ErrorEvent(new I.ValidationError("sources."+S,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new I.ErrorEvent(new I.ValidationError("sources."+S,null,'missing required property "coordinates"'))),M.animate&&typeof M.animate!="boolean"&&this.fire(new I.ErrorEvent(new I.ValidationError("sources."+S,null,'optional "animate" property must be a boolean value'))),M.canvas?typeof M.canvas=="string"||M.canvas instanceof I.window.HTMLCanvasElement||this.fire(new I.ErrorEvent(new I.ValidationError("sources."+S,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new I.ErrorEvent(new I.ValidationError("sources."+S,null,'missing required property "canvas"'))),this.options=M,this.animate=M.animate===void 0||M.animate}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof I.window.HTMLCanvasElement?this.options.canvas:I.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new I.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},C.prototype.getCanvas=function(){return this.canvas},C.prototype.onAdd=function(S){this.map=S,this.load(),this.canvas&&this.animate&&this.play()},C.prototype.onRemove=function(){this.pause()},C.prototype.prepare=function(){var S=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,S=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,S=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var M=this.map.painter.context,z=M.gl;for(var H in this.boundsBuffer||(this.boundsBuffer=M.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=I.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(S||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new I.Texture(M,this.canvas,z.RGBA,{premultiply:!0}),this.tiles){var $=this.tiles[H];$.state!=="loaded"&&($.state="loaded",$.texture=this.texture)}}},C.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},C.prototype.hasTransition=function(){return this._playing},C.prototype._hasInvalidDimensions=function(){for(var S=0,M=[this.canvas.width,this.canvas.height];S<M.length;S+=1){var z=M[S];if(isNaN(z)||z<=0)return!0}return!1},C}(Xt),er={vector:Qt,raster:ct,"raster-dem":Ct,geojson:Y,video:ie,image:Xt,canvas:Ce};function Ht(x,C){var S=I.identity([]);return I.translate(S,S,[1,1,0]),I.scale(S,S,[.5*x.width,.5*x.height,1]),I.multiply(S,S,x.calculatePosMatrix(C.toUnwrapped()))}function ne(x,C,S,M,z,H){var $=function(br,rr,xr){if(br)for(var Pr=0,Rr=br;Pr<Rr.length;Pr+=1){var vn=rr[Rr[Pr]];if(vn&&vn.source===xr&&vn.type==="fill-extrusion")return!0}else for(var ln in rr){var bn=rr[ln];if(bn.source===xr&&bn.type==="fill-extrusion")return!0}return!1}(z&&z.layers,C,x.id),ft=H.maxPitchScaleFactor(),zt=x.tilesIn(M,ft,$);zt.sort(Me);for(var ee=[],Re=0,De=zt;Re<De.length;Re+=1){var ke=De[Re];ee.push({wrappedTileID:ke.tileID.wrapped().key,queryResults:ke.tile.queryRenderedFeatures(C,S,x._state,ke.queryGeometry,ke.cameraQueryGeometry,ke.scale,z,H,ft,Ht(x.transform,ke.tileID))})}var cr=function(br){for(var rr={},xr={},Pr=0,Rr=br;Pr<Rr.length;Pr+=1){var vn=Rr[Pr],ln=vn.queryResults,bn=vn.wrappedTileID,Zn=xr[bn]=xr[bn]||{};for(var Kn in ln)for(var ci=ln[Kn],Oi=Zn[Kn]=Zn[Kn]||{},na=rr[Kn]=rr[Kn]||[],ia=0,ua=ci;ia<ua.length;ia+=1){var Qa=ua[ia];Oi[Qa.featureIndex]||(Oi[Qa.featureIndex]=!0,na.push(Qa))}}return rr}(ee);for(var ar in cr)cr[ar].forEach(function(br){var rr=br.feature,xr=x.getFeatureState(rr.layer["source-layer"],rr.id);rr.source=rr.layer.source,rr.layer["source-layer"]&&(rr.sourceLayer=rr.layer["source-layer"]),rr.state=xr});return cr}function Me(x,C){var S=x.tileID,M=C.tileID;return S.overscaledZ-M.overscaledZ||S.canonical.y-M.canonical.y||S.wrap-M.wrap||S.canonical.x-M.canonical.x}var ae=function(x,C){this.max=x,this.onRemove=C,this.reset()};ae.prototype.reset=function(){for(var x in this.data)for(var C=0,S=this.data[x];C<S.length;C+=1){var M=S[C];M.timeout&&clearTimeout(M.timeout),this.onRemove(M.value)}return this.data={},this.order=[],this},ae.prototype.add=function(x,C,S){var M=this,z=x.wrapped().key;this.data[z]===void 0&&(this.data[z]=[]);var H={value:C,timeout:void 0};if(S!==void 0&&(H.timeout=setTimeout(function(){M.remove(x,H)},S)),this.data[z].push(H),this.order.push(z),this.order.length>this.max){var $=this._getAndRemoveByKey(this.order[0]);$&&this.onRemove($)}return this},ae.prototype.has=function(x){return x.wrapped().key in this.data},ae.prototype.getAndRemove=function(x){return this.has(x)?this._getAndRemoveByKey(x.wrapped().key):null},ae.prototype._getAndRemoveByKey=function(x){var C=this.data[x].shift();return C.timeout&&clearTimeout(C.timeout),this.data[x].length===0&&delete this.data[x],this.order.splice(this.order.indexOf(x),1),C.value},ae.prototype.getByKey=function(x){var C=this.data[x];return C?C[0].value:null},ae.prototype.get=function(x){return this.has(x)?this.data[x.wrapped().key][0].value:null},ae.prototype.remove=function(x,C){if(!this.has(x))return this;var S=x.wrapped().key,M=C===void 0?0:this.data[S].indexOf(C),z=this.data[S][M];return this.data[S].splice(M,1),z.timeout&&clearTimeout(z.timeout),this.data[S].length===0&&delete this.data[S],this.onRemove(z.value),this.order.splice(this.order.indexOf(S),1),this},ae.prototype.setMaxSize=function(x){for(this.max=x;this.order.length>this.max;){var C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this},ae.prototype.filter=function(x){var C=[];for(var S in this.data)for(var M=0,z=this.data[S];M<z.length;M+=1){var H=z[M];x(H.value)||C.push(H)}for(var $=0,ft=C;$<ft.length;$+=1){var zt=ft[$];this.remove(zt.value.tileID,zt)}};var Je=function(x,C,S){this.context=x;var M=x.gl;this.buffer=M.createBuffer(),this.dynamicDraw=Boolean(S),this.context.unbindVAO(),x.bindElementBuffer.set(this.buffer),M.bufferData(M.ELEMENT_ARRAY_BUFFER,C.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete C.arrayBuffer};Je.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Je.prototype.updateData=function(x){var C=this.context.gl;this.context.unbindVAO(),this.bind(),C.bufferSubData(C.ELEMENT_ARRAY_BUFFER,0,x.arrayBuffer)},Je.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var or={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},re=function(x,C,S,M){this.length=C.length,this.attributes=S,this.itemSize=C.bytesPerElement,this.dynamicDraw=M,this.context=x;var z=x.gl;this.buffer=z.createBuffer(),x.bindVertexBuffer.set(this.buffer),z.bufferData(z.ARRAY_BUFFER,C.arrayBuffer,this.dynamicDraw?z.DYNAMIC_DRAW:z.STATIC_DRAW),this.dynamicDraw||delete C.arrayBuffer};re.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},re.prototype.updateData=function(x){var C=this.context.gl;this.bind(),C.bufferSubData(C.ARRAY_BUFFER,0,x.arrayBuffer)},re.prototype.enableAttributes=function(x,C){for(var S=0;S<this.attributes.length;S++){var M=C.attributes[this.attributes[S].name];M!==void 0&&x.enableVertexAttribArray(M)}},re.prototype.setVertexAttribPointers=function(x,C,S){for(var M=0;M<this.attributes.length;M++){var z=this.attributes[M],H=C.attributes[z.name];H!==void 0&&x.vertexAttribPointer(H,z.components,x[or[z.type]],!1,this.itemSize,z.offset+this.itemSize*(S||0))}},re.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Jt=function(x){this.gl=x.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Jt.prototype.get=function(){return this.current},Jt.prototype.set=function(x){},Jt.prototype.getDefault=function(){return this.default},Jt.prototype.setDefault=function(){this.set(this.default)};var Et=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return I.Color.transparent},C.prototype.set=function(S){var M=this.current;(S.r!==M.r||S.g!==M.g||S.b!==M.b||S.a!==M.a||this.dirty)&&(this.gl.clearColor(S.r,S.g,S.b,S.a),this.current=S,this.dirty=!1)},C}(Jt),$t=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 1},C.prototype.set=function(S){(S!==this.current||this.dirty)&&(this.gl.clearDepth(S),this.current=S,this.dirty=!1)},C}(Jt),Yt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 0},C.prototype.set=function(S){(S!==this.current||this.dirty)&&(this.gl.clearStencil(S),this.current=S,this.dirty=!1)},C}(Jt),St=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return[!0,!0,!0,!0]},C.prototype.set=function(S){var M=this.current;(S[0]!==M[0]||S[1]!==M[1]||S[2]!==M[2]||S[3]!==M[3]||this.dirty)&&(this.gl.colorMask(S[0],S[1],S[2],S[3]),this.current=S,this.dirty=!1)},C}(Jt),At=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!0},C.prototype.set=function(S){(S!==this.current||this.dirty)&&(this.gl.depthMask(S),this.current=S,this.dirty=!1)},C}(Jt),ue=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 255},C.prototype.set=function(S){(S!==this.current||this.dirty)&&(this.gl.stencilMask(S),this.current=S,this.dirty=!1)},C}(Jt),Pe=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},C.prototype.set=function(S){var M=this.current;(S.func!==M.func||S.ref!==M.ref||S.mask!==M.mask||this.dirty)&&(this.gl.stencilFunc(S.func,S.ref,S.mask),this.current=S,this.dirty=!1)},C}(Jt),je=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){var S=this.gl;return[S.KEEP,S.KEEP,S.KEEP]},C.prototype.set=function(S){var M=this.current;(S[0]!==M[0]||S[1]!==M[1]||S[2]!==M[2]||this.dirty)&&(this.gl.stencilOp(S[0],S[1],S[2]),this.current=S,this.dirty=!1)},C}(Jt),Nt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;S?M.enable(M.STENCIL_TEST):M.disable(M.STENCIL_TEST),this.current=S,this.dirty=!1}},C}(Jt),wt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return[0,1]},C.prototype.set=function(S){var M=this.current;(S[0]!==M[0]||S[1]!==M[1]||this.dirty)&&(this.gl.depthRange(S[0],S[1]),this.current=S,this.dirty=!1)},C}(Jt),Tt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;S?M.enable(M.DEPTH_TEST):M.disable(M.DEPTH_TEST),this.current=S,this.dirty=!1}},C}(Jt),Ft=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.LESS},C.prototype.set=function(S){(S!==this.current||this.dirty)&&(this.gl.depthFunc(S),this.current=S,this.dirty=!1)},C}(Jt),J=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;S?M.enable(M.BLEND):M.disable(M.BLEND),this.current=S,this.dirty=!1}},C}(Jt),gt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){var S=this.gl;return[S.ONE,S.ZERO]},C.prototype.set=function(S){var M=this.current;(S[0]!==M[0]||S[1]!==M[1]||this.dirty)&&(this.gl.blendFunc(S[0],S[1]),this.current=S,this.dirty=!1)},C}(Jt),jt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return I.Color.transparent},C.prototype.set=function(S){var M=this.current;(S.r!==M.r||S.g!==M.g||S.b!==M.b||S.a!==M.a||this.dirty)&&(this.gl.blendColor(S.r,S.g,S.b,S.a),this.current=S,this.dirty=!1)},C}(Jt),ve=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.FUNC_ADD},C.prototype.set=function(S){(S!==this.current||this.dirty)&&(this.gl.blendEquation(S),this.current=S,this.dirty=!1)},C}(Jt),Gt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;S?M.enable(M.CULL_FACE):M.disable(M.CULL_FACE),this.current=S,this.dirty=!1}},C}(Jt),Ae=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.BACK},C.prototype.set=function(S){(S!==this.current||this.dirty)&&(this.gl.cullFace(S),this.current=S,this.dirty=!1)},C}(Jt),He=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.CCW},C.prototype.set=function(S){(S!==this.current||this.dirty)&&(this.gl.frontFace(S),this.current=S,this.dirty=!1)},C}(Jt),qe=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(S){(S!==this.current||this.dirty)&&(this.gl.useProgram(S),this.current=S,this.dirty=!1)},C}(Jt),hr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.TEXTURE0},C.prototype.set=function(S){(S!==this.current||this.dirty)&&(this.gl.activeTexture(S),this.current=S,this.dirty=!1)},C}(Jt),tr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){var S=this.gl;return[0,0,S.drawingBufferWidth,S.drawingBufferHeight]},C.prototype.set=function(S){var M=this.current;(S[0]!==M[0]||S[1]!==M[1]||S[2]!==M[2]||S[3]!==M[3]||this.dirty)&&(this.gl.viewport(S[0],S[1],S[2],S[3]),this.current=S,this.dirty=!1)},C}(Jt),Br=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;M.bindFramebuffer(M.FRAMEBUFFER,S),this.current=S,this.dirty=!1}},C}(Jt),Lr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;M.bindRenderbuffer(M.RENDERBUFFER,S),this.current=S,this.dirty=!1}},C}(Jt),Zr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;M.bindTexture(M.TEXTURE_2D,S),this.current=S,this.dirty=!1}},C}(Jt),Tn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;M.bindBuffer(M.ARRAY_BUFFER,S),this.current=S,this.dirty=!1}},C}(Jt),rn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(S){var M=this.gl;M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,S),this.current=S,this.dirty=!1},C}(Jt),Nn=function(x){function C(S){x.call(this,S),this.vao=S.extVertexArrayObject}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(S){this.vao&&(S!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(S),this.current=S,this.dirty=!1)},C}(Jt),zn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 4},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_ALIGNMENT,S),this.current=S,this.dirty=!1}},C}(Jt),jn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_PREMULTIPLY_ALPHA_WEBGL,S),this.current=S,this.dirty=!1}},C}(Jt),Sn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(S){if(S!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,S),this.current=S,this.dirty=!1}},C}(Jt),Wn=function(x){function C(S,M){x.call(this,S),this.context=S,this.parent=M}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C}(Jt),Rt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.setDirty=function(){this.dirty=!0},C.prototype.set=function(S){if(S!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var M=this.gl;M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_2D,S,0),this.current=S,this.dirty=!1}},C}(Wn),Wt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.set=function(S){if(S!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var M=this.gl;M.framebufferRenderbuffer(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.RENDERBUFFER,S),this.current=S,this.dirty=!1}},C}(Wn),oe=function(x,C,S,M){this.context=x,this.width=C,this.height=S;var z=this.framebuffer=x.gl.createFramebuffer();this.colorAttachment=new Rt(x,z),M&&(this.depthAttachment=new Wt(x,z))};oe.prototype.destroy=function(){var x=this.context.gl,C=this.colorAttachment.get();if(C&&x.deleteTexture(C),this.depthAttachment){var S=this.depthAttachment.get();S&&x.deleteRenderbuffer(S)}x.deleteFramebuffer(this.framebuffer)};var Se=function(x,C,S){this.func=x,this.mask=C,this.range=S};Se.ReadOnly=!1,Se.ReadWrite=!0,Se.disabled=new Se(519,Se.ReadOnly,[0,1]);var ze=function(x,C,S,M,z,H){this.test=x,this.ref=C,this.mask=S,this.fail=M,this.depthFail=z,this.pass=H};ze.disabled=new ze({func:519,mask:0},0,0,7680,7680,7680);var fr=function(x,C,S){this.blendFunction=x,this.blendColor=C,this.mask=S};fr.disabled=new fr(fr.Replace=[1,0],I.Color.transparent,[!1,!1,!1,!1]),fr.unblended=new fr(fr.Replace,I.Color.transparent,[!0,!0,!0,!0]),fr.alphaBlended=new fr([1,771],I.Color.transparent,[!0,!0,!0,!0]);var wr=function(x,C,S){this.enable=x,this.mode=C,this.frontFace=S};wr.disabled=new wr(!1,1029,2305),wr.backCCW=new wr(!0,1029,2305);var Le=function(x){this.gl=x,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Et(this),this.clearDepth=new $t(this),this.clearStencil=new Yt(this),this.colorMask=new St(this),this.depthMask=new At(this),this.stencilMask=new ue(this),this.stencilFunc=new Pe(this),this.stencilOp=new je(this),this.stencilTest=new Nt(this),this.depthRange=new wt(this),this.depthTest=new Tt(this),this.depthFunc=new Ft(this),this.blend=new J(this),this.blendFunc=new gt(this),this.blendColor=new jt(this),this.blendEquation=new ve(this),this.cullFace=new Gt(this),this.cullFaceSide=new Ae(this),this.frontFace=new He(this),this.program=new qe(this),this.activeTexture=new hr(this),this.viewport=new tr(this),this.bindFramebuffer=new Br(this),this.bindRenderbuffer=new Lr(this),this.bindTexture=new Zr(this),this.bindVertexBuffer=new Tn(this),this.bindElementBuffer=new rn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Nn(this),this.pixelStoreUnpack=new zn(this),this.pixelStoreUnpackPremultiplyAlpha=new jn(this),this.pixelStoreUnpackFlipY=new Sn(this),this.extTextureFilterAnisotropic=x.getExtension("EXT_texture_filter_anisotropic")||x.getExtension("MOZ_EXT_texture_filter_anisotropic")||x.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=x.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=x.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(x.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=x.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=x.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=x.getParameter(x.MAX_TEXTURE_SIZE)};Le.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Le.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Le.prototype.createIndexBuffer=function(x,C){return new Je(this,x,C)},Le.prototype.createVertexBuffer=function(x,C,S){return new re(this,x,C,S)},Le.prototype.createRenderbuffer=function(x,C,S){var M=this.gl,z=M.createRenderbuffer();return this.bindRenderbuffer.set(z),M.renderbufferStorage(M.RENDERBUFFER,x,C,S),this.bindRenderbuffer.set(null),z},Le.prototype.createFramebuffer=function(x,C,S){return new oe(this,x,C,S)},Le.prototype.clear=function(x){var C=x.color,S=x.depth,M=this.gl,z=0;C&&(z|=M.COLOR_BUFFER_BIT,this.clearColor.set(C),this.colorMask.set([!0,!0,!0,!0])),S!==void 0&&(z|=M.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(S),this.depthMask.set(!0)),M.clear(z)},Le.prototype.setCullFace=function(x){x.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(x.mode),this.frontFace.set(x.frontFace))},Le.prototype.setDepthMode=function(x){x.func!==this.gl.ALWAYS||x.mask?(this.depthTest.set(!0),this.depthFunc.set(x.func),this.depthMask.set(x.mask),this.depthRange.set(x.range)):this.depthTest.set(!1)},Le.prototype.setStencilMode=function(x){x.test.func!==this.gl.ALWAYS||x.mask?(this.stencilTest.set(!0),this.stencilMask.set(x.mask),this.stencilOp.set([x.fail,x.depthFail,x.pass]),this.stencilFunc.set({func:x.test.func,ref:x.ref,mask:x.test.mask})):this.stencilTest.set(!1)},Le.prototype.setColorMode=function(x){I.deepEqual(x.blendFunction,fr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(x.blendFunction),this.blendColor.set(x.blendColor)),this.colorMask.set(x.mask)},Le.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ur=function(x){function C(S,M,z){var H=this;x.call(this),this.id=S,this.dispatcher=z,this.on("data",function($){$.dataType==="source"&&$.sourceDataType==="metadata"&&(H._sourceLoaded=!0),H._sourceLoaded&&!H._paused&&$.dataType==="source"&&$.sourceDataType==="content"&&(H.reload(),H.transform&&H.update(H.transform))}),this.on("error",function(){H._sourceErrored=!0}),this._source=function($,ft,zt,ee){var Re=new er[ft.type]($,ft,zt,ee);if(Re.id!==$)throw new Error("Expected Source id to be "+$+" instead of "+Re.id);return I.bindAll(["load","abort","unload","serialize","prepare"],Re),Re}(S,M,z,this),this._tiles={},this._cache=new ae(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new I.SourceFeatureState}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.onAdd=function(S){this.map=S,this._maxTileCacheSize=S?S._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(S)},C.prototype.onRemove=function(S){this._source&&this._source.onRemove&&this._source.onRemove(S)},C.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var S in this._tiles){var M=this._tiles[S];if(M.state!=="loaded"&&M.state!=="errored")return!1}return!0},C.prototype.getSource=function(){return this._source},C.prototype.pause=function(){this._paused=!0},C.prototype.resume=function(){if(this._paused){var S=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,S&&this.reload(),this.transform&&this.update(this.transform)}},C.prototype._loadTile=function(S,M){return this._source.loadTile(S,M)},C.prototype._unloadTile=function(S){if(this._source.unloadTile)return this._source.unloadTile(S,function(){})},C.prototype._abortTile=function(S){if(this._source.abortTile)return this._source.abortTile(S,function(){})},C.prototype.serialize=function(){return this._source.serialize()},C.prototype.prepare=function(S){for(var M in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var z=this._tiles[M];z.upload(S),z.prepare(this.map.style.imageManager)}},C.prototype.getIds=function(){return I.values(this._tiles).map(function(S){return S.tileID}).sort(Wr).map(function(S){return S.key})},C.prototype.getRenderableIds=function(S){var M=this,z=[];for(var H in this._tiles)this._isIdRenderable(H,S)&&z.push(this._tiles[H]);return S?z.sort(function($,ft){var zt=$.tileID,ee=ft.tileID,Re=new I.Point(zt.canonical.x,zt.canonical.y)._rotate(M.transform.angle),De=new I.Point(ee.canonical.x,ee.canonical.y)._rotate(M.transform.angle);return zt.overscaledZ-ee.overscaledZ||De.y-Re.y||De.x-Re.x}).map(function($){return $.tileID.key}):z.map(function($){return $.tileID}).sort(Wr).map(function($){return $.key})},C.prototype.hasRenderableParent=function(S){var M=this.findLoadedParent(S,0);return!!M&&this._isIdRenderable(M.tileID.key)},C.prototype._isIdRenderable=function(S,M){return this._tiles[S]&&this._tiles[S].hasData()&&!this._coveredTiles[S]&&(M||!this._tiles[S].holdingForFade())},C.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var S in this._cache.reset(),this._tiles)this._tiles[S].state!=="errored"&&this._reloadTile(S,"reloading")},C.prototype._reloadTile=function(S,M){var z=this._tiles[S];z&&(z.state!=="loading"&&(z.state=M),this._loadTile(z,this._tileLoaded.bind(this,z,S,M)))},C.prototype._tileLoaded=function(S,M,z,H){if(H)return S.state="errored",void(H.status!==404?this._source.fire(new I.ErrorEvent(H,{tile:S})):this.update(this.transform));S.timeAdded=I.browser.now(),z==="expired"&&(S.refreshedUponExpiration=!0),this._setTileReloadTimer(M,S),this.getSource().type==="raster-dem"&&S.dem&&this._backfillDEM(S),this._state.initializeTileState(S,this.map?this.map.painter:null),this._source.fire(new I.Event("data",{dataType:"source",tile:S,coord:S.tileID}))},C.prototype._backfillDEM=function(S){for(var M=this.getRenderableIds(),z=0;z<M.length;z++){var H=M[z];if(S.neighboringTiles&&S.neighboringTiles[H]){var $=this.getTileByID(H);ft(S,$),ft($,S)}}function ft(zt,ee){zt.needsHillshadePrepare=!0;var Re=ee.tileID.canonical.x-zt.tileID.canonical.x,De=ee.tileID.canonical.y-zt.tileID.canonical.y,ke=Math.pow(2,zt.tileID.canonical.z),cr=ee.tileID.key;Re===0&&De===0||Math.abs(De)>1||(Math.abs(Re)>1&&(Math.abs(Re+ke)===1?Re+=ke:Math.abs(Re-ke)===1&&(Re-=ke)),ee.dem&&zt.dem&&(zt.dem.backfillBorder(ee.dem,Re,De),zt.neighboringTiles&&zt.neighboringTiles[cr]&&(zt.neighboringTiles[cr].backfilled=!0)))}},C.prototype.getTile=function(S){return this.getTileByID(S.key)},C.prototype.getTileByID=function(S){return this._tiles[S]},C.prototype._retainLoadedChildren=function(S,M,z,H){for(var $ in this._tiles){var ft=this._tiles[$];if(!(H[$]||!ft.hasData()||ft.tileID.overscaledZ<=M||ft.tileID.overscaledZ>z)){for(var zt=ft.tileID;ft&&ft.tileID.overscaledZ>M+1;){var ee=ft.tileID.scaledTo(ft.tileID.overscaledZ-1);(ft=this._tiles[ee.key])&&ft.hasData()&&(zt=ee)}for(var Re=zt;Re.overscaledZ>M;)if(S[(Re=Re.scaledTo(Re.overscaledZ-1)).key]){H[zt.key]=zt;break}}}},C.prototype.findLoadedParent=function(S,M){if(S.key in this._loadedParentTiles){var z=this._loadedParentTiles[S.key];return z&&z.tileID.overscaledZ>=M?z:null}for(var H=S.overscaledZ-1;H>=M;H--){var $=S.scaledTo(H),ft=this._getLoadedTile($);if(ft)return ft}},C.prototype._getLoadedTile=function(S){var M=this._tiles[S.key];return M&&M.hasData()?M:this._cache.getByKey(S.wrapped().key)},C.prototype.updateCacheSize=function(S){var M=Math.ceil(S.width/this._source.tileSize)+1,z=Math.ceil(S.height/this._source.tileSize)+1,H=Math.floor(M*z*5),$=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,H):H;this._cache.setMaxSize($)},C.prototype.handleWrapJump=function(S){var M=Math.round((S-(this._prevLng===void 0?S:this._prevLng))/360);if(this._prevLng=S,M){var z={};for(var H in this._tiles){var $=this._tiles[H];$.tileID=$.tileID.unwrapTo($.tileID.wrap+M),z[$.tileID.key]=$}for(var ft in this._tiles=z,this._timers)clearTimeout(this._timers[ft]),delete this._timers[ft];for(var zt in this._tiles)this._setTileReloadTimer(zt,this._tiles[zt])}},C.prototype.update=function(S){var M=this;if(this.transform=S,this._sourceLoaded&&!this._paused){var z;this.updateCacheSize(S),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?z=S.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Zn){return new I.OverscaledTileID(Zn.canonical.z,Zn.wrap,Zn.canonical.z,Zn.canonical.x,Zn.canonical.y)}):(z=S.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(z=z.filter(function(Zn){return M._source.hasTile(Zn)}))):z=[];var H=S.coveringZoomLevel(this._source),$=Math.max(H-C.maxOverzooming,this._source.minzoom),ft=Math.max(H+C.maxUnderzooming,this._source.minzoom),zt=this._updateRetainedTiles(z,H);if(wn(this._source.type)){for(var ee={},Re={},De=0,ke=Object.keys(zt);De<ke.length;De+=1){var cr=ke[De],ar=zt[cr],br=this._tiles[cr];if(br&&!(br.fadeEndTime&&br.fadeEndTime<=I.browser.now())){var rr=this.findLoadedParent(ar,$);rr&&(this._addTile(rr.tileID),ee[rr.tileID.key]=rr.tileID),Re[cr]=ar}}for(var xr in this._retainLoadedChildren(Re,H,ft,zt),ee)zt[xr]||(this._coveredTiles[xr]=!0,zt[xr]=ee[xr])}for(var Pr in zt)this._tiles[Pr].clearFadeHold();for(var Rr=0,vn=I.keysDifference(this._tiles,zt);Rr<vn.length;Rr+=1){var ln=vn[Rr],bn=this._tiles[ln];bn.hasSymbolBuckets&&!bn.holdingForFade()?bn.setHoldDuration(this.map._fadeDuration):bn.hasSymbolBuckets&&!bn.symbolFadeFinished()||this._removeTile(ln)}this._updateLoadedParentTileCache()}},C.prototype.releaseSymbolFadeTiles=function(){for(var S in this._tiles)this._tiles[S].holdingForFade()&&this._removeTile(S)},C.prototype._updateRetainedTiles=function(S,M){for(var z={},H={},$=Math.max(M-C.maxOverzooming,this._source.minzoom),ft=Math.max(M+C.maxUnderzooming,this._source.minzoom),zt={},ee=0,Re=S;ee<Re.length;ee+=1){var De=Re[ee],ke=this._addTile(De);z[De.key]=De,ke.hasData()||M<this._source.maxzoom&&(zt[De.key]=De)}this._retainLoadedChildren(zt,M,ft,z);for(var cr=0,ar=S;cr<ar.length;cr+=1){var br=ar[cr],rr=this._tiles[br.key];if(!rr.hasData()){if(M+1>this._source.maxzoom){var xr=br.children(this._source.maxzoom)[0],Pr=this.getTile(xr);if(Pr&&Pr.hasData()){z[xr.key]=xr;continue}}else{var Rr=br.children(this._source.maxzoom);if(z[Rr[0].key]&&z[Rr[1].key]&&z[Rr[2].key]&&z[Rr[3].key])continue}for(var vn=rr.wasRequested(),ln=br.overscaledZ-1;ln>=$;--ln){var bn=br.scaledTo(ln);if(H[bn.key]||(H[bn.key]=!0,!(rr=this.getTile(bn))&&vn&&(rr=this._addTile(bn)),rr&&(z[bn.key]=bn,vn=rr.wasRequested(),rr.hasData())))break}}}return z},C.prototype._updateLoadedParentTileCache=function(){for(var S in this._loadedParentTiles={},this._tiles){for(var M=[],z=void 0,H=this._tiles[S].tileID;H.overscaledZ>0;){if(H.key in this._loadedParentTiles){z=this._loadedParentTiles[H.key];break}M.push(H.key);var $=H.scaledTo(H.overscaledZ-1);if(z=this._getLoadedTile($))break;H=$}for(var ft=0,zt=M;ft<zt.length;ft+=1)this._loadedParentTiles[zt[ft]]=z}},C.prototype._addTile=function(S){var M=this._tiles[S.key];if(M)return M;(M=this._cache.getAndRemove(S))&&(this._setTileReloadTimer(S.key,M),M.tileID=S,this._state.initializeTileState(M,this.map?this.map.painter:null),this._cacheTimers[S.key]&&(clearTimeout(this._cacheTimers[S.key]),delete this._cacheTimers[S.key],this._setTileReloadTimer(S.key,M)));var z=Boolean(M);return z||(M=new I.Tile(S,this._source.tileSize*S.overscaleFactor()),this._loadTile(M,this._tileLoaded.bind(this,M,S.key,M.state))),M?(M.uses++,this._tiles[S.key]=M,z||this._source.fire(new I.Event("dataloading",{tile:M,coord:M.tileID,dataType:"source"})),M):null},C.prototype._setTileReloadTimer=function(S,M){var z=this;S in this._timers&&(clearTimeout(this._timers[S]),delete this._timers[S]);var H=M.getExpiryTimeout();H&&(this._timers[S]=setTimeout(function(){z._reloadTile(S,"expired"),delete z._timers[S]},H))},C.prototype._removeTile=function(S){var M=this._tiles[S];M&&(M.uses--,delete this._tiles[S],this._timers[S]&&(clearTimeout(this._timers[S]),delete this._timers[S]),M.uses>0||(M.hasData()&&M.state!=="reloading"?this._cache.add(M.tileID,M,M.getExpiryTimeout()):(M.aborted=!0,this._abortTile(M),this._unloadTile(M))))},C.prototype.clearTiles=function(){for(var S in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(S);this._cache.reset()},C.prototype.tilesIn=function(S,M,z){var H=this,$=[],ft=this.transform;if(!ft)return $;for(var zt=z?ft.getCameraQueryGeometry(S):S,ee=S.map(function(ln){return ft.pointCoordinate(ln)}),Re=zt.map(function(ln){return ft.pointCoordinate(ln)}),De=this.getIds(),ke=1/0,cr=1/0,ar=-1/0,br=-1/0,rr=0,xr=Re;rr<xr.length;rr+=1){var Pr=xr[rr];ke=Math.min(ke,Pr.x),cr=Math.min(cr,Pr.y),ar=Math.max(ar,Pr.x),br=Math.max(br,Pr.y)}for(var Rr=function(ln){var bn=H._tiles[De[ln]];if(!bn.holdingForFade()){var Zn=bn.tileID,Kn=Math.pow(2,ft.zoom-bn.tileID.overscaledZ),ci=M*bn.queryPadding*I.EXTENT/bn.tileSize/Kn,Oi=[Zn.getTilePoint(new I.MercatorCoordinate(ke,cr)),Zn.getTilePoint(new I.MercatorCoordinate(ar,br))];if(Oi[0].x-ci<I.EXTENT&&Oi[0].y-ci<I.EXTENT&&Oi[1].x+ci>=0&&Oi[1].y+ci>=0){var na=ee.map(function(ua){return Zn.getTilePoint(ua)}),ia=Re.map(function(ua){return Zn.getTilePoint(ua)});$.push({tile:bn,tileID:Zn,queryGeometry:na,cameraQueryGeometry:ia,scale:Kn})}}},vn=0;vn<De.length;vn++)Rr(vn);return $},C.prototype.getVisibleCoordinates=function(S){for(var M=this,z=this.getRenderableIds(S).map(function(zt){return M._tiles[zt].tileID}),H=0,$=z;H<$.length;H+=1){var ft=$[H];ft.posMatrix=this.transform.calculatePosMatrix(ft.toUnwrapped())}return z},C.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(wn(this._source.type))for(var S in this._tiles){var M=this._tiles[S];if(M.fadeEndTime!==void 0&&M.fadeEndTime>=I.browser.now())return!0}return!1},C.prototype.setFeatureState=function(S,M,z){this._state.updateState(S=S||"_geojsonTileLayer",M,z)},C.prototype.removeFeatureState=function(S,M,z){this._state.removeFeatureState(S=S||"_geojsonTileLayer",M,z)},C.prototype.getFeatureState=function(S,M){return this._state.getState(S=S||"_geojsonTileLayer",M)},C.prototype.setDependencies=function(S,M,z){var H=this._tiles[S];H&&H.setDependencies(M,z)},C.prototype.reloadTilesForDependencies=function(S,M){for(var z in this._tiles)this._tiles[z].hasDependency(S,M)&&this._reloadTile(z,"reloading");this._cache.filter(function(H){return!H.hasDependency(S,M)})},C}(I.Evented);function Wr(x,C){var S=Math.abs(2*x.wrap)-+(x.wrap<0),M=Math.abs(2*C.wrap)-+(C.wrap<0);return x.overscaledZ-C.overscaledZ||M-S||C.canonical.y-x.canonical.y||C.canonical.x-x.canonical.x}function wn(x){return x==="raster"||x==="image"||x==="video"}function qr(){return new I.window.Worker(Yc.workerUrl)}ur.maxOverzooming=10,ur.maxUnderzooming=3;var Qr="mapboxgl_preloaded_worker_pool",Mn=function(){this.active={}};Mn.prototype.acquire=function(x){if(!this.workers)for(this.workers=[];this.workers.length<Mn.workerCount;)this.workers.push(new qr);return this.active[x]=!0,this.workers.slice()},Mn.prototype.release=function(x){delete this.active[x],this.numActive()===0&&(this.workers.forEach(function(C){C.terminate()}),this.workers=null)},Mn.prototype.isPreloaded=function(){return!!this.active[Qr]},Mn.prototype.numActive=function(){return Object.keys(this.active).length};var bi,wi=Math.floor(I.browser.hardwareConcurrency/2);function Kr(){return bi||(bi=new Mn),bi}function ai(x,C){var S={};for(var M in x)M!=="ref"&&(S[M]=x[M]);return I.refProperties.forEach(function(z){z in C&&(S[z]=C[z])}),S}function li(x){x=x.slice();for(var C=Object.create(null),S=0;S<x.length;S++)C[x[S].id]=x[S];for(var M=0;M<x.length;M++)"ref"in x[M]&&(x[M]=ai(x[M],C[x[M].ref]));return x}Mn.workerCount=Math.max(Math.min(wi,6),1);var hi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ra(x,C,S){S.push({command:hi.addSource,args:[x,C[x]]})}function Ci(x,C,S){C.push({command:hi.removeSource,args:[x]}),S[x]=!0}function Ba(x,C,S,M){Ci(x,S,M),ra(x,C,S)}function po(x,C,S){var M;for(M in x[S])if(x[S].hasOwnProperty(M)&&M!=="data"&&!I.deepEqual(x[S][M],C[S][M]))return!1;for(M in C[S])if(C[S].hasOwnProperty(M)&&M!=="data"&&!I.deepEqual(x[S][M],C[S][M]))return!1;return!0}function za(x,C,S,M,z,H){var $;for($ in C=C||{},x=x||{})x.hasOwnProperty($)&&(I.deepEqual(x[$],C[$])||S.push({command:H,args:[M,$,C[$],z]}));for($ in C)C.hasOwnProperty($)&&!x.hasOwnProperty($)&&(I.deepEqual(x[$],C[$])||S.push({command:H,args:[M,$,C[$],z]}))}function Xa(x){return x.id}function Ta(x,C){return x[C.id]=C,x}var ga=function(x,C){this.reset(x,C)};ga.prototype.reset=function(x,C){this.points=x||[],this._distances=[0];for(var S=1;S<this.points.length;S++)this._distances[S]=this._distances[S-1]+this.points[S].dist(this.points[S-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(C||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ga.prototype.lerp=function(x){if(this.points.length===1)return this.points[0];x=I.clamp(x,0,1);for(var C=1,S=this._distances[C],M=x*this.paddedLength+this.padding;S<M&&C<this._distances.length;)S=this._distances[++C];var z=C-1,H=this._distances[z],$=S-H,ft=$>0?(M-H)/$:0;return this.points[z].mult(1-ft).add(this.points[C].mult(ft))};var no=function(x,C,S){var M=this.boxCells=[],z=this.circleCells=[];this.xCellCount=Math.ceil(x/S),this.yCellCount=Math.ceil(C/S);for(var H=0;H<this.xCellCount*this.yCellCount;H++)M.push([]),z.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=x,this.height=C,this.xScale=this.xCellCount/x,this.yScale=this.yCellCount/C,this.boxUid=0,this.circleUid=0};function Vo(x,C,S,M,z){var H=I.create();return C?(I.scale(H,H,[1/z,1/z,1]),S||I.rotateZ(H,H,M.angle)):I.multiply(H,M.labelPlaneMatrix,x),H}function vo(x,C,S,M,z){if(C){var H=I.clone(x);return I.scale(H,H,[z,z,1]),S||I.rotateZ(H,H,-M.angle),H}return M.glCoordMatrix}function ja(x,C){var S=[x.x,x.y,0,1];In(S,S,C);var M=S[3];return{point:new I.Point(S[0]/M,S[1]/M),signedDistanceFromCamera:M}}function to(x,C){return .5+x/C*.5}function Uo(x,C){var S=x[0]/x[3],M=x[1]/x[3];return S>=-C[0]&&S<=C[0]&&M>=-C[1]&&M<=C[1]}function ju(x,C,S,M,z,H,$,ft){var zt=M?x.textSizeData:x.iconSizeData,ee=I.evaluateSizeForZoom(zt,S.transform.zoom),Re=[256/S.width*2+1,256/S.height*2+1],De=M?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;De.clear();for(var ke=x.lineVertexArray,cr=M?x.text.placedSymbolArray:x.icon.placedSymbolArray,ar=S.transform.width/S.transform.height,br=!1,rr=0;rr<cr.length;rr++){var xr=cr.get(rr);if(xr.hidden||xr.writingMode===I.WritingMode.vertical&&!br)tn(xr.numGlyphs,De);else{br=!1;var Pr=[xr.anchorX,xr.anchorY,0,1];if(I.transformMat4(Pr,Pr,C),Uo(Pr,Re)){var Rr=to(S.transform.cameraToCenterDistance,Pr[3]),vn=I.evaluateSizeForFeature(zt,ee,xr),ln=$?vn/Rr:vn*Rr,bn=new I.Point(xr.anchorX,xr.anchorY),Zn=ja(bn,z).point,Kn={},ci=nr(xr,ln,!1,ft,C,z,H,x.glyphOffsetArray,ke,De,Zn,bn,Kn,ar);br=ci.useVertical,(ci.notEnoughRoom||br||ci.needsFlipping&&nr(xr,ln,!0,ft,C,z,H,x.glyphOffsetArray,ke,De,Zn,bn,Kn,ar).notEnoughRoom)&&tn(xr.numGlyphs,De)}else tn(xr.numGlyphs,De)}}M?x.text.dynamicLayoutVertexBuffer.updateData(De):x.icon.dynamicLayoutVertexBuffer.updateData(De)}function Wo(x,C,S,M,z,H,$,ft,zt,ee,Re){var De=ft.glyphStartIndex+ft.numGlyphs,ke=ft.lineStartIndex,cr=ft.lineStartIndex+ft.lineLength,ar=C.getoffsetX(ft.glyphStartIndex),br=C.getoffsetX(De-1),rr=Ge(x*ar,S,M,z,H,$,ft.segment,ke,cr,zt,ee,Re);if(!rr)return null;var xr=Ge(x*br,S,M,z,H,$,ft.segment,ke,cr,zt,ee,Re);return xr?{first:rr,last:xr}:null}function bo(x,C,S,M){return x===I.WritingMode.horizontal&&Math.abs(S.y-C.y)>Math.abs(S.x-C.x)*M?{useVertical:!0}:(x===I.WritingMode.vertical?C.y<S.y:C.x>S.x)?{needsFlipping:!0}:null}function nr(x,C,S,M,z,H,$,ft,zt,ee,Re,De,ke,cr){var ar,br=C/24,rr=x.lineOffsetX*br,xr=x.lineOffsetY*br;if(x.numGlyphs>1){var Pr=x.glyphStartIndex+x.numGlyphs,Rr=x.lineStartIndex,vn=x.lineStartIndex+x.lineLength,ln=Wo(br,ft,rr,xr,S,Re,De,x,zt,H,ke);if(!ln)return{notEnoughRoom:!0};var bn=ja(ln.first.point,$).point,Zn=ja(ln.last.point,$).point;if(M&&!S){var Kn=bo(x.writingMode,bn,Zn,cr);if(Kn)return Kn}ar=[ln.first];for(var ci=x.glyphStartIndex+1;ci<Pr-1;ci++)ar.push(Ge(br*ft.getoffsetX(ci),rr,xr,S,Re,De,x.segment,Rr,vn,zt,H,ke));ar.push(ln.last)}else{if(M&&!S){var Oi=ja(De,z).point,na=x.lineStartIndex+x.segment+1,ia=new I.Point(zt.getx(na),zt.gety(na)),ua=ja(ia,z),Qa=ua.signedDistanceFromCamera>0?ua.point:ye(De,ia,Oi,1,z),Fi=bo(x.writingMode,Oi,Qa,cr);if(Fi)return Fi}var Ra=Ge(br*ft.getoffsetX(x.glyphStartIndex),rr,xr,S,Re,De,x.segment,x.lineStartIndex,x.lineStartIndex+x.lineLength,zt,H,ke);if(!Ra)return{notEnoughRoom:!0};ar=[Ra]}for(var Aa=0,ka=ar;Aa<ka.length;Aa+=1){var la=ka[Aa];I.addDynamicAttributes(ee,la.point,la.angle)}return{}}function ye(x,C,S,M,z){var H=ja(x.add(x.sub(C)._unit()),z).point,$=S.sub(H);return S.add($._mult(M/$.mag()))}function Ge(x,C,S,M,z,H,$,ft,zt,ee,Re,De){var ke=M?x-C:x+C,cr=ke>0?1:-1,ar=0;M&&(cr*=-1,ar=Math.PI),cr<0&&(ar+=Math.PI);for(var br=cr>0?ft+$:ft+$+1,rr=z,xr=z,Pr=0,Rr=0,vn=Math.abs(ke),ln=[];Pr+Rr<=vn;){if((br+=cr)<ft||br>=zt)return null;if(xr=rr,ln.push(rr),(rr=De[br])===void 0){var bn=new I.Point(ee.getx(br),ee.gety(br)),Zn=ja(bn,Re);if(Zn.signedDistanceFromCamera>0)rr=De[br]=Zn.point;else{var Kn=br-cr;rr=ye(Pr===0?H:new I.Point(ee.getx(Kn),ee.gety(Kn)),bn,xr,vn-Pr+1,Re)}}Pr+=Rr,Rr=xr.dist(rr)}var ci=(vn-Pr)/Rr,Oi=rr.sub(xr),na=Oi.mult(ci)._add(xr);na._add(Oi._unit()._perp()._mult(S*cr));var ia=ar+Math.atan2(rr.y-xr.y,rr.x-xr.x);return ln.push(na),{point:na,angle:ia,path:ln}}no.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},no.prototype.insert=function(x,C,S,M,z){this._forEachCell(C,S,M,z,this._insertBoxCell,this.boxUid++),this.boxKeys.push(x),this.bboxes.push(C),this.bboxes.push(S),this.bboxes.push(M),this.bboxes.push(z)},no.prototype.insertCircle=function(x,C,S,M){this._forEachCell(C-M,S-M,C+M,S+M,this._insertCircleCell,this.circleUid++),this.circleKeys.push(x),this.circles.push(C),this.circles.push(S),this.circles.push(M)},no.prototype._insertBoxCell=function(x,C,S,M,z,H){this.boxCells[z].push(H)},no.prototype._insertCircleCell=function(x,C,S,M,z,H){this.circleCells[z].push(H)},no.prototype._query=function(x,C,S,M,z,H){if(S<0||x>this.width||M<0||C>this.height)return!z&&[];var $=[];if(x<=0&&C<=0&&this.width<=S&&this.height<=M){if(z)return!0;for(var ft=0;ft<this.boxKeys.length;ft++)$.push({key:this.boxKeys[ft],x1:this.bboxes[4*ft],y1:this.bboxes[4*ft+1],x2:this.bboxes[4*ft+2],y2:this.bboxes[4*ft+3]});for(var zt=0;zt<this.circleKeys.length;zt++){var ee=this.circles[3*zt],Re=this.circles[3*zt+1],De=this.circles[3*zt+2];$.push({key:this.circleKeys[zt],x1:ee-De,y1:Re-De,x2:ee+De,y2:Re+De})}return H?$.filter(H):$}return this._forEachCell(x,C,S,M,this._queryCell,$,{hitTest:z,seenUids:{box:{},circle:{}}},H),z?$.length>0:$},no.prototype._queryCircle=function(x,C,S,M,z){var H=x-S,$=x+S,ft=C-S,zt=C+S;if($<0||H>this.width||zt<0||ft>this.height)return!M&&[];var ee=[];return this._forEachCell(H,ft,$,zt,this._queryCellCircle,ee,{hitTest:M,circle:{x,y:C,radius:S},seenUids:{box:{},circle:{}}},z),M?ee.length>0:ee},no.prototype.query=function(x,C,S,M,z){return this._query(x,C,S,M,!1,z)},no.prototype.hitTest=function(x,C,S,M,z){return this._query(x,C,S,M,!0,z)},no.prototype.hitTestCircle=function(x,C,S,M){return this._queryCircle(x,C,S,!0,M)},no.prototype._queryCell=function(x,C,S,M,z,H,$,ft){var zt=$.seenUids,ee=this.boxCells[z];if(ee!==null)for(var Re=this.bboxes,De=0,ke=ee;De<ke.length;De+=1){var cr=ke[De];if(!zt.box[cr]){zt.box[cr]=!0;var ar=4*cr;if(x<=Re[ar+2]&&C<=Re[ar+3]&&S>=Re[ar+0]&&M>=Re[ar+1]&&(!ft||ft(this.boxKeys[cr]))){if($.hitTest)return H.push(!0),!0;H.push({key:this.boxKeys[cr],x1:Re[ar],y1:Re[ar+1],x2:Re[ar+2],y2:Re[ar+3]})}}}var br=this.circleCells[z];if(br!==null)for(var rr=this.circles,xr=0,Pr=br;xr<Pr.length;xr+=1){var Rr=Pr[xr];if(!zt.circle[Rr]){zt.circle[Rr]=!0;var vn=3*Rr;if(this._circleAndRectCollide(rr[vn],rr[vn+1],rr[vn+2],x,C,S,M)&&(!ft||ft(this.circleKeys[Rr]))){if($.hitTest)return H.push(!0),!0;var ln=rr[vn],bn=rr[vn+1],Zn=rr[vn+2];H.push({key:this.circleKeys[Rr],x1:ln-Zn,y1:bn-Zn,x2:ln+Zn,y2:bn+Zn})}}}},no.prototype._queryCellCircle=function(x,C,S,M,z,H,$,ft){var zt=$.circle,ee=$.seenUids,Re=this.boxCells[z];if(Re!==null)for(var De=this.bboxes,ke=0,cr=Re;ke<cr.length;ke+=1){var ar=cr[ke];if(!ee.box[ar]){ee.box[ar]=!0;var br=4*ar;if(this._circleAndRectCollide(zt.x,zt.y,zt.radius,De[br+0],De[br+1],De[br+2],De[br+3])&&(!ft||ft(this.boxKeys[ar])))return H.push(!0),!0}}var rr=this.circleCells[z];if(rr!==null)for(var xr=this.circles,Pr=0,Rr=rr;Pr<Rr.length;Pr+=1){var vn=Rr[Pr];if(!ee.circle[vn]){ee.circle[vn]=!0;var ln=3*vn;if(this._circlesCollide(xr[ln],xr[ln+1],xr[ln+2],zt.x,zt.y,zt.radius)&&(!ft||ft(this.circleKeys[vn])))return H.push(!0),!0}}},no.prototype._forEachCell=function(x,C,S,M,z,H,$,ft){for(var zt=this._convertToXCellCoord(x),ee=this._convertToYCellCoord(C),Re=this._convertToXCellCoord(S),De=this._convertToYCellCoord(M),ke=zt;ke<=Re;ke++)for(var cr=ee;cr<=De;cr++)if(z.call(this,x,C,S,M,this.xCellCount*cr+ke,H,$,ft))return},no.prototype._convertToXCellCoord=function(x){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(x*this.xScale)))},no.prototype._convertToYCellCoord=function(x){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(x*this.yScale)))},no.prototype._circlesCollide=function(x,C,S,M,z,H){var $=M-x,ft=z-C,zt=S+H;return zt*zt>$*$+ft*ft},no.prototype._circleAndRectCollide=function(x,C,S,M,z,H,$){var ft=(H-M)/2,zt=Math.abs(x-(M+ft));if(zt>ft+S)return!1;var ee=($-z)/2,Re=Math.abs(C-(z+ee));if(Re>ee+S)return!1;if(zt<=ft||Re<=ee)return!0;var De=zt-ft,ke=Re-ee;return De*De+ke*ke<=S*S};var Mr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function tn(x,C){for(var S=0;S<x;S++){var M=C.length;C.resize(M+4),C.float32.set(Mr,3*M)}}function In(x,C,S){var M=C[0],z=C[1];return x[0]=S[0]*M+S[4]*z+S[12],x[1]=S[1]*M+S[5]*z+S[13],x[3]=S[3]*M+S[7]*z+S[15],x}var Un=function(x,C,S){C===void 0&&(C=new no(x.width+200,x.height+200,25)),S===void 0&&(S=new no(x.width+200,x.height+200,25)),this.transform=x,this.grid=C,this.ignoredGrid=S,this.pitchfactor=Math.cos(x._pitch)*x.cameraToCenterDistance,this.screenRightBoundary=x.width+100,this.screenBottomBoundary=x.height+100,this.gridRightBoundary=x.width+200,this.gridBottomBoundary=x.height+200};function Cn(x,C,S){return C*(I.EXTENT/(x.tileSize*Math.pow(2,S-x.tileID.overscaledZ)))}Un.prototype.placeCollisionBox=function(x,C,S,M,z){var H=this.projectAndGetPerspectiveRatio(M,x.anchorPointX,x.anchorPointY),$=S*H.perspectiveRatio,ft=x.x1*$+H.point.x,zt=x.y1*$+H.point.y,ee=x.x2*$+H.point.x,Re=x.y2*$+H.point.y;return!this.isInsideGrid(ft,zt,ee,Re)||!C&&this.grid.hitTest(ft,zt,ee,Re,z)?{box:[],offscreen:!1}:{box:[ft,zt,ee,Re],offscreen:this.isOffscreen(ft,zt,ee,Re)}},Un.prototype.placeCollisionCircles=function(x,C,S,M,z,H,$,ft,zt,ee,Re,De,ke){var cr=[],ar=new I.Point(C.anchorX,C.anchorY),br=ja(ar,H),rr=to(this.transform.cameraToCenterDistance,br.signedDistanceFromCamera),xr=(ee?z/rr:z*rr)/I.ONE_EM,Pr=ja(ar,$).point,Rr=Wo(xr,M,C.lineOffsetX*xr,C.lineOffsetY*xr,!1,Pr,ar,C,S,$,{}),vn=!1,ln=!1,bn=!0;if(Rr){for(var Zn=.5*De*rr+ke,Kn=new I.Point(-100,-100),ci=new I.Point(this.screenRightBoundary,this.screenBottomBoundary),Oi=new ga,na=Rr.first,ia=Rr.last,ua=[],Qa=na.path.length-1;Qa>=1;Qa--)ua.push(na.path[Qa]);for(var Fi=1;Fi<ia.path.length;Fi++)ua.push(ia.path[Fi]);var Ra=2.5*Zn;if(ft){var Aa=ua.map(function(cl){return ja(cl,ft)});ua=Aa.some(function(cl){return cl.signedDistanceFromCamera<=0})?[]:Aa.map(function(cl){return cl.point})}var ka=[];if(ua.length>0){for(var la=ua[0].clone(),Na=ua[0].clone(),pa=1;pa<ua.length;pa++)la.x=Math.min(la.x,ua[pa].x),la.y=Math.min(la.y,ua[pa].y),Na.x=Math.max(Na.x,ua[pa].x),Na.y=Math.max(Na.y,ua[pa].y);ka=la.x>=Kn.x&&Na.x<=ci.x&&la.y>=Kn.y&&Na.y<=ci.y?[ua]:Na.x<Kn.x||la.x>ci.x||Na.y<Kn.y||la.y>ci.y?[]:I.clipLine([ua],Kn.x,Kn.y,ci.x,ci.y)}for(var da=0,Ds=ka;da<Ds.length;da+=1){var ss;Oi.reset(Ds[da],.25*Zn),ss=Oi.length<=.5*Zn?1:Math.ceil(Oi.paddedLength/Ra)+1;for(var ou=0;ou<ss;ou++){var Ks=ou/Math.max(ss-1,1),ls=Oi.lerp(Ks),cs=ls.x+100,vu=ls.y+100;cr.push(cs,vu,Zn,0);var Du=cs-Zn,kc=vu-Zn,qu=cs+Zn,Kl=vu+Zn;if(bn=bn&&this.isOffscreen(Du,kc,qu,Kl),ln=ln||this.isInsideGrid(Du,kc,qu,Kl),!x&&this.grid.hitTestCircle(cs,vu,Zn,Re)&&(vn=!0,!zt))return{circles:[],offscreen:!1,collisionDetected:vn}}}}return{circles:!zt&&vn||!ln?[]:cr,offscreen:bn,collisionDetected:vn}},Un.prototype.queryRenderedSymbols=function(x){if(x.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var C=[],S=1/0,M=1/0,z=-1/0,H=-1/0,$=0,ft=x;$<ft.length;$+=1){var zt=ft[$],ee=new I.Point(zt.x+100,zt.y+100);S=Math.min(S,ee.x),M=Math.min(M,ee.y),z=Math.max(z,ee.x),H=Math.max(H,ee.y),C.push(ee)}for(var Re={},De={},ke=0,cr=this.grid.query(S,M,z,H).concat(this.ignoredGrid.query(S,M,z,H));ke<cr.length;ke+=1){var ar=cr[ke],br=ar.key;if(Re[br.bucketInstanceId]===void 0&&(Re[br.bucketInstanceId]={}),!Re[br.bucketInstanceId][br.featureIndex]){var rr=[new I.Point(ar.x1,ar.y1),new I.Point(ar.x2,ar.y1),new I.Point(ar.x2,ar.y2),new I.Point(ar.x1,ar.y2)];I.polygonIntersectsPolygon(C,rr)&&(Re[br.bucketInstanceId][br.featureIndex]=!0,De[br.bucketInstanceId]===void 0&&(De[br.bucketInstanceId]=[]),De[br.bucketInstanceId].push(br.featureIndex))}}return De},Un.prototype.insertCollisionBox=function(x,C,S,M,z){(C?this.ignoredGrid:this.grid).insert({bucketInstanceId:S,featureIndex:M,collisionGroupID:z},x[0],x[1],x[2],x[3])},Un.prototype.insertCollisionCircles=function(x,C,S,M,z){for(var H=C?this.ignoredGrid:this.grid,$={bucketInstanceId:S,featureIndex:M,collisionGroupID:z},ft=0;ft<x.length;ft+=4)H.insertCircle($,x[ft],x[ft+1],x[ft+2])},Un.prototype.projectAndGetPerspectiveRatio=function(x,C,S){var M=[C,S,0,1];return In(M,M,x),{point:new I.Point((M[0]/M[3]+1)/2*this.transform.width+100,(-M[1]/M[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/M[3]*.5}},Un.prototype.isOffscreen=function(x,C,S,M){return S<100||x>=this.screenRightBoundary||M<100||C>this.screenBottomBoundary},Un.prototype.isInsideGrid=function(x,C,S,M){return S>=0&&x<this.gridRightBoundary&&M>=0&&C<this.gridBottomBoundary},Un.prototype.getViewportMatrix=function(){var x=I.identity([]);return I.translate(x,x,[-100,-100,0]),x};var ta=function(x,C,S,M){this.opacity=x?Math.max(0,Math.min(1,x.opacity+(x.placed?C:-C))):M&&S?1:0,this.placed=S};ta.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Wa=function(x,C,S,M,z){this.text=new ta(x?x.text:null,C,S,z),this.icon=new ta(x?x.icon:null,C,M,z)};Wa.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var es=function(x,C,S){this.text=x,this.icon=C,this.skipFade=S},ko=function(){this.invProjMatrix=I.create(),this.viewportMatrix=I.create(),this.circles=[]},ns=function(x,C,S,M,z){this.bucketInstanceId=x,this.featureIndex=C,this.sourceLayerIndex=S,this.bucketIndex=M,this.tileID=z},Ya=function(x){this.crossSourceCollisions=x,this.maxGroupID=0,this.collisionGroups={}};function Go(x,C,S,M,z){var H=I.getAnchorAlignment(x),$=-(H.horizontalAlign-.5)*C,ft=-(H.verticalAlign-.5)*S,zt=I.evaluateVariableOffset(x,M);return new I.Point($+zt[0]*z,ft+zt[1]*z)}function pu(x,C,S,M,z,H){var $=x.x1,ft=x.x2,zt=x.y1,ee=x.y2,Re=x.anchorPointX,De=x.anchorPointY,ke=new I.Point(C,S);return M&&ke._rotate(z?H:-H),{x1:$+ke.x,y1:zt+ke.y,x2:ft+ke.x,y2:ee+ke.y,anchorPointX:Re,anchorPointY:De}}Ya.prototype.get=function(x){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[x]){var C=++this.maxGroupID;this.collisionGroups[x]={ID:C,predicate:function(S){return S.collisionGroupID===C}}}return this.collisionGroups[x]};var ys=function(x,C,S,M){this.transform=x.clone(),this.collisionIndex=new Un(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=C,this.retainedQueryData={},this.collisionGroups=new Ya(S),this.collisionCircleArrays={},this.prevPlacement=M,M&&(M.prevPlacement=void 0),this.placedOrientations={}};function Rl(x,C,S,M,z){x.emplaceBack(C?1:0,S?1:0,M||0,z||0),x.emplaceBack(C?1:0,S?1:0,M||0,z||0),x.emplaceBack(C?1:0,S?1:0,M||0,z||0),x.emplaceBack(C?1:0,S?1:0,M||0,z||0)}ys.prototype.getBucketParts=function(x,C,S,M){var z=S.getBucket(C),H=S.latestFeatureIndex;if(z&&H&&C.id===z.layerIds[0]){var $=S.collisionBoxArray,ft=z.layers[0].layout,zt=Math.pow(2,this.transform.zoom-S.tileID.overscaledZ),ee=S.tileSize/I.EXTENT,Re=this.transform.calculatePosMatrix(S.tileID.toUnwrapped()),De=ft.get("text-pitch-alignment")==="map",ke=ft.get("text-rotation-alignment")==="map",cr=Cn(S,1,this.transform.zoom),ar=Vo(Re,De,ke,this.transform,cr),br=null;if(De){var rr=vo(Re,De,ke,this.transform,cr);br=I.multiply([],this.transform.labelPlaneMatrix,rr)}this.retainedQueryData[z.bucketInstanceId]=new ns(z.bucketInstanceId,H,z.sourceLayerIndex,z.index,S.tileID);var xr={bucket:z,layout:ft,posMatrix:Re,textLabelPlaneMatrix:ar,labelToScreenMatrix:br,scale:zt,textPixelRatio:ee,holdingForFade:S.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:I.evaluateSizeForZoom(z.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(z.sourceID)};if(M)for(var Pr=0,Rr=z.sortKeyRanges;Pr<Rr.length;Pr+=1){var vn=Rr[Pr];x.push({sortKey:vn.sortKey,symbolInstanceStart:vn.symbolInstanceStart,symbolInstanceEnd:vn.symbolInstanceEnd,parameters:xr})}else x.push({symbolInstanceStart:0,symbolInstanceEnd:z.symbolInstances.length,parameters:xr})}},ys.prototype.attemptAnchorPlacement=function(x,C,S,M,z,H,$,ft,zt,ee,Re,De,ke,cr,ar){var br,rr=[De.textOffset0,De.textOffset1],xr=Go(x,S,M,rr,z),Pr=this.collisionIndex.placeCollisionBox(pu(C,xr.x,xr.y,H,$,this.transform.angle),Re,ft,zt,ee.predicate);if(!ar||this.collisionIndex.placeCollisionBox(pu(ar,xr.x,xr.y,H,$,this.transform.angle),Re,ft,zt,ee.predicate).box.length!==0)return Pr.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[De.crossTileID]&&this.prevPlacement.placements[De.crossTileID]&&this.prevPlacement.placements[De.crossTileID].text&&(br=this.prevPlacement.variableOffsets[De.crossTileID].anchor),this.variableOffsets[De.crossTileID]={textOffset:rr,width:S,height:M,anchor:x,textBoxScale:z,prevAnchor:br},this.markUsedJustification(ke,x,De,cr),ke.allowVerticalPlacement&&(this.markUsedOrientation(ke,cr,De),this.placedOrientations[De.crossTileID]=cr),{shift:xr,placedGlyphBoxes:Pr}):void 0},ys.prototype.placeLayerBucketPart=function(x,C,S){var M=this,z=x.parameters,H=z.bucket,$=z.layout,ft=z.posMatrix,zt=z.textLabelPlaneMatrix,ee=z.labelToScreenMatrix,Re=z.textPixelRatio,De=z.holdingForFade,ke=z.collisionBoxArray,cr=z.partiallyEvaluatedTextSize,ar=z.collisionGroup,br=$.get("text-optional"),rr=$.get("icon-optional"),xr=$.get("text-allow-overlap"),Pr=$.get("icon-allow-overlap"),Rr=$.get("text-rotation-alignment")==="map",vn=$.get("text-pitch-alignment")==="map",ln=$.get("icon-text-fit")!=="none",bn=$.get("symbol-z-order")==="viewport-y",Zn=xr&&(Pr||!H.hasIconData()||rr),Kn=Pr&&(xr||!H.hasTextData()||br);!H.collisionArrays&&ke&&H.deserializeCollisionBoxes(ke);var ci=function(Fi,Ra){if(!C[Fi.crossTileID])if(De)M.placements[Fi.crossTileID]=new es(!1,!1,!1);else{var Aa,ka=!1,la=!1,Na=!0,pa=null,da={box:null,offscreen:null},Ds={box:null,offscreen:null},ss=null,ou=null,Ks=0,ls=0,cs=0;Ra.textFeatureIndex?Ks=Ra.textFeatureIndex:Fi.useRuntimeCollisionCircles&&(Ks=Fi.featureIndex),Ra.verticalTextFeatureIndex&&(ls=Ra.verticalTextFeatureIndex);var vu=Ra.textBox;if(vu){var Du=function(Lo){var Sl=I.WritingMode.horizontal;if(H.allowVerticalPlacement&&!Lo&&M.prevPlacement){var Ku=M.prevPlacement.placedOrientations[Fi.crossTileID];Ku&&(M.placedOrientations[Fi.crossTileID]=Ku,M.markUsedOrientation(H,Sl=Ku,Fi))}return Sl},kc=function(Lo,Sl){if(H.allowVerticalPlacement&&Fi.numVerticalGlyphVertices>0&&Ra.verticalTextBox)for(var Ku=0,qc=H.writingModes;Ku<qc.length&&(qc[Ku]===I.WritingMode.vertical?(da=Sl(),Ds=da):da=Lo(),!(da&&da.box&&da.box.length));Ku+=1);else da=Lo()};if($.get("text-variable-anchor")){var qu=$.get("text-variable-anchor");if(M.prevPlacement&&M.prevPlacement.variableOffsets[Fi.crossTileID]){var Kl=M.prevPlacement.variableOffsets[Fi.crossTileID];qu.indexOf(Kl.anchor)>0&&(qu=qu.filter(function(Lo){return Lo!==Kl.anchor})).unshift(Kl.anchor)}var cl=function(Lo,Sl,Ku){for(var qc=Lo.x2-Lo.x1,Kc=Lo.y2-Lo.y1,$f=Fi.textBoxScale,Qc=ln&&!Pr?Sl:null,Bu={box:[],offscreen:!1},bh=xr?2*qu.length:qu.length,tc=0;tc<bh;++tc){var Jc=M.attemptAnchorPlacement(qu[tc%qu.length],Lo,qc,Kc,$f,Rr,vn,Re,ft,ar,tc>=qu.length,Fi,H,Ku,Qc);if(Jc&&(Bu=Jc.placedGlyphBoxes)&&Bu.box&&Bu.box.length){ka=!0,pa=Jc.shift;break}}return Bu};kc(function(){return cl(vu,Ra.iconBox,I.WritingMode.horizontal)},function(){var Lo=Ra.verticalTextBox;return H.allowVerticalPlacement&&!(da&&da.box&&da.box.length)&&Fi.numVerticalGlyphVertices>0&&Lo?cl(Lo,Ra.verticalIconBox,I.WritingMode.vertical):{box:null,offscreen:null}}),da&&(ka=da.box,Na=da.offscreen);var yh=Du(da&&da.box);if(!ka&&M.prevPlacement){var El=M.prevPlacement.variableOffsets[Fi.crossTileID];El&&(M.variableOffsets[Fi.crossTileID]=El,M.markUsedJustification(H,El.anchor,Fi,yh))}}else{var Ql=function(Lo,Sl){var Ku=M.collisionIndex.placeCollisionBox(Lo,xr,Re,ft,ar.predicate);return Ku&&Ku.box&&Ku.box.length&&(M.markUsedOrientation(H,Sl,Fi),M.placedOrientations[Fi.crossTileID]=Sl),Ku};kc(function(){return Ql(vu,I.WritingMode.horizontal)},function(){var Lo=Ra.verticalTextBox;return H.allowVerticalPlacement&&Fi.numVerticalGlyphVertices>0&&Lo?Ql(Lo,I.WritingMode.vertical):{box:null,offscreen:null}}),Du(da&&da.box&&da.box.length)}}if(ka=(Aa=da)&&Aa.box&&Aa.box.length>0,Na=Aa&&Aa.offscreen,Fi.useRuntimeCollisionCircles){var _h=H.text.placedSymbolArray.get(Fi.centerJustifiedTextSymbolIndex),Yf=I.evaluateSizeForFeature(H.textSizeData,cr,_h),dc=$.get("text-padding");ss=M.collisionIndex.placeCollisionCircles(xr,_h,H.lineVertexArray,H.glyphOffsetArray,Yf,ft,zt,ee,S,vn,ar.predicate,Fi.collisionCircleDiameter,dc),ka=xr||ss.circles.length>0&&!ss.collisionDetected,Na=Na&&ss.offscreen}if(Ra.iconFeatureIndex&&(cs=Ra.iconFeatureIndex),Ra.iconBox){var xh=function(Lo){var Sl=ln&&pa?pu(Lo,pa.x,pa.y,Rr,vn,M.transform.angle):Lo;return M.collisionIndex.placeCollisionBox(Sl,Pr,Re,ft,ar.predicate)};la=Ds&&Ds.box&&Ds.box.length&&Ra.verticalIconBox?(ou=xh(Ra.verticalIconBox)).box.length>0:(ou=xh(Ra.iconBox)).box.length>0,Na=Na&&ou.offscreen}var Jl=br||Fi.numHorizontalGlyphVertices===0&&Fi.numVerticalGlyphVertices===0,js=rr||Fi.numIconVertices===0;if(Jl||js?js?Jl||(la=la&&ka):ka=la&&ka:la=ka=la&&ka,ka&&Aa&&Aa.box&&M.collisionIndex.insertCollisionBox(Aa.box,$.get("text-ignore-placement"),H.bucketInstanceId,Ds&&Ds.box&&ls?ls:Ks,ar.ID),la&&ou&&M.collisionIndex.insertCollisionBox(ou.box,$.get("icon-ignore-placement"),H.bucketInstanceId,cs,ar.ID),ss&&(ka&&M.collisionIndex.insertCollisionCircles(ss.circles,$.get("text-ignore-placement"),H.bucketInstanceId,Ks,ar.ID),S)){var $c=H.bucketInstanceId,Tf=M.collisionCircleArrays[$c];Tf===void 0&&(Tf=M.collisionCircleArrays[$c]=new ko);for(var vc=0;vc<ss.circles.length;vc+=4)Tf.circles.push(ss.circles[vc+0]),Tf.circles.push(ss.circles[vc+1]),Tf.circles.push(ss.circles[vc+2]),Tf.circles.push(ss.collisionDetected?1:0)}M.placements[Fi.crossTileID]=new es(ka||Zn,la||Kn,Na||H.justReloaded),C[Fi.crossTileID]=!0}};if(bn)for(var Oi=H.getSortedSymbolIndexes(this.transform.angle),na=Oi.length-1;na>=0;--na){var ia=Oi[na];ci(H.symbolInstances.get(ia),H.collisionArrays[ia])}else for(var ua=x.symbolInstanceStart;ua<x.symbolInstanceEnd;ua++)ci(H.symbolInstances.get(ua),H.collisionArrays[ua]);if(S&&H.bucketInstanceId in this.collisionCircleArrays){var Qa=this.collisionCircleArrays[H.bucketInstanceId];I.invert(Qa.invProjMatrix,ft),Qa.viewportMatrix=this.collisionIndex.getViewportMatrix()}H.justReloaded=!1},ys.prototype.markUsedJustification=function(x,C,S,M){var z;z=M===I.WritingMode.vertical?S.verticalPlacedTextSymbolIndex:{left:S.leftJustifiedTextSymbolIndex,center:S.centerJustifiedTextSymbolIndex,right:S.rightJustifiedTextSymbolIndex}[I.getAnchorJustification(C)];for(var H=0,$=[S.leftJustifiedTextSymbolIndex,S.centerJustifiedTextSymbolIndex,S.rightJustifiedTextSymbolIndex,S.verticalPlacedTextSymbolIndex];H<$.length;H+=1){var ft=$[H];ft>=0&&(x.text.placedSymbolArray.get(ft).crossTileID=z>=0&&ft!==z?0:S.crossTileID)}},ys.prototype.markUsedOrientation=function(x,C,S){for(var M=C===I.WritingMode.horizontal||C===I.WritingMode.horizontalOnly?C:0,z=C===I.WritingMode.vertical?C:0,H=0,$=[S.leftJustifiedTextSymbolIndex,S.centerJustifiedTextSymbolIndex,S.rightJustifiedTextSymbolIndex];H<$.length;H+=1)x.text.placedSymbolArray.get($[H]).placedOrientation=M;S.verticalPlacedTextSymbolIndex&&(x.text.placedSymbolArray.get(S.verticalPlacedTextSymbolIndex).placedOrientation=z)},ys.prototype.commit=function(x){this.commitTime=x,this.zoomAtLastRecencyCheck=this.transform.zoom;var C=this.prevPlacement,S=!1;this.prevZoomAdjustment=C?C.zoomAdjustment(this.transform.zoom):0;var M=C?C.symbolFadeChange(x):1,z=C?C.opacities:{},H=C?C.variableOffsets:{},$=C?C.placedOrientations:{};for(var ft in this.placements){var zt=this.placements[ft],ee=z[ft];ee?(this.opacities[ft]=new Wa(ee,M,zt.text,zt.icon),S=S||zt.text!==ee.text.placed||zt.icon!==ee.icon.placed):(this.opacities[ft]=new Wa(null,M,zt.text,zt.icon,zt.skipFade),S=S||zt.text||zt.icon)}for(var Re in z){var De=z[Re];if(!this.opacities[Re]){var ke=new Wa(De,M,!1,!1);ke.isHidden()||(this.opacities[Re]=ke,S=S||De.text.placed||De.icon.placed)}}for(var cr in H)this.variableOffsets[cr]||!this.opacities[cr]||this.opacities[cr].isHidden()||(this.variableOffsets[cr]=H[cr]);for(var ar in $)this.placedOrientations[ar]||!this.opacities[ar]||this.opacities[ar].isHidden()||(this.placedOrientations[ar]=$[ar]);S?this.lastPlacementChangeTime=x:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=C?C.lastPlacementChangeTime:x)},ys.prototype.updateLayerOpacities=function(x,C){for(var S={},M=0,z=C;M<z.length;M+=1){var H=z[M],$=H.getBucket(x);$&&H.latestFeatureIndex&&x.id===$.layerIds[0]&&this.updateBucketOpacities($,S,H.collisionBoxArray)}},ys.prototype.updateBucketOpacities=function(x,C,S){var M=this;x.hasTextData()&&x.text.opacityVertexArray.clear(),x.hasIconData()&&x.icon.opacityVertexArray.clear(),x.hasIconCollisionBoxData()&&x.iconCollisionBox.collisionVertexArray.clear(),x.hasTextCollisionBoxData()&&x.textCollisionBox.collisionVertexArray.clear();var z=x.layers[0].layout,H=new Wa(null,0,!1,!1,!0),$=z.get("text-allow-overlap"),ft=z.get("icon-allow-overlap"),zt=z.get("text-variable-anchor"),ee=z.get("text-rotation-alignment")==="map",Re=z.get("text-pitch-alignment")==="map",De=z.get("icon-text-fit")!=="none",ke=new Wa(null,0,$&&(ft||!x.hasIconData()||z.get("icon-optional")),ft&&($||!x.hasTextData()||z.get("text-optional")),!0);!x.collisionArrays&&S&&(x.hasIconCollisionBoxData()||x.hasTextCollisionBoxData())&&x.deserializeCollisionBoxes(S);for(var cr=function(xr,Pr,Rr){for(var vn=0;vn<Pr/4;vn++)xr.opacityVertexArray.emplaceBack(Rr)},ar=function(xr){var Pr=x.symbolInstances.get(xr),Rr=Pr.numHorizontalGlyphVertices,vn=Pr.numVerticalGlyphVertices,ln=Pr.crossTileID,bn=M.opacities[ln];C[ln]?bn=H:bn||(M.opacities[ln]=bn=ke),C[ln]=!0;var Zn=Pr.numIconVertices>0,Kn=M.placedOrientations[Pr.crossTileID],ci=Kn===I.WritingMode.vertical,Oi=Kn===I.WritingMode.horizontal||Kn===I.WritingMode.horizontalOnly;if(Rr>0||vn>0){var na=ji(bn.text);cr(x.text,Rr,ci?Ma:na),cr(x.text,vn,Oi?Ma:na);var ia=bn.text.isHidden();[Pr.rightJustifiedTextSymbolIndex,Pr.centerJustifiedTextSymbolIndex,Pr.leftJustifiedTextSymbolIndex].forEach(function(da){da>=0&&(x.text.placedSymbolArray.get(da).hidden=ia||ci?1:0)}),Pr.verticalPlacedTextSymbolIndex>=0&&(x.text.placedSymbolArray.get(Pr.verticalPlacedTextSymbolIndex).hidden=ia||Oi?1:0);var ua=M.variableOffsets[Pr.crossTileID];ua&&M.markUsedJustification(x,ua.anchor,Pr,Kn);var Qa=M.placedOrientations[Pr.crossTileID];Qa&&(M.markUsedJustification(x,"left",Pr,Qa),M.markUsedOrientation(x,Qa,Pr))}if(Zn){var Fi=ji(bn.icon),Ra=!(De&&Pr.verticalPlacedIconSymbolIndex&&ci);Pr.placedIconSymbolIndex>=0&&(cr(x.icon,Pr.numIconVertices,Ra?Fi:Ma),x.icon.placedSymbolArray.get(Pr.placedIconSymbolIndex).hidden=bn.icon.isHidden()),Pr.verticalPlacedIconSymbolIndex>=0&&(cr(x.icon,Pr.numVerticalIconVertices,Ra?Ma:Fi),x.icon.placedSymbolArray.get(Pr.verticalPlacedIconSymbolIndex).hidden=bn.icon.isHidden())}if(x.hasIconCollisionBoxData()||x.hasTextCollisionBoxData()){var Aa=x.collisionArrays[xr];if(Aa){var ka=new I.Point(0,0);if(Aa.textBox||Aa.verticalTextBox){var la=!0;if(zt){var Na=M.variableOffsets[ln];Na?(ka=Go(Na.anchor,Na.width,Na.height,Na.textOffset,Na.textBoxScale),ee&&ka._rotate(Re?M.transform.angle:-M.transform.angle)):la=!1}Aa.textBox&&Rl(x.textCollisionBox.collisionVertexArray,bn.text.placed,!la||ci,ka.x,ka.y),Aa.verticalTextBox&&Rl(x.textCollisionBox.collisionVertexArray,bn.text.placed,!la||Oi,ka.x,ka.y)}var pa=Boolean(!Oi&&Aa.verticalIconBox);Aa.iconBox&&Rl(x.iconCollisionBox.collisionVertexArray,bn.icon.placed,pa,De?ka.x:0,De?ka.y:0),Aa.verticalIconBox&&Rl(x.iconCollisionBox.collisionVertexArray,bn.icon.placed,!pa,De?ka.x:0,De?ka.y:0)}}},br=0;br<x.symbolInstances.length;br++)ar(br);if(x.sortFeatures(this.transform.angle),this.retainedQueryData[x.bucketInstanceId]&&(this.retainedQueryData[x.bucketInstanceId].featureSortOrder=x.featureSortOrder),x.hasTextData()&&x.text.opacityVertexBuffer&&x.text.opacityVertexBuffer.updateData(x.text.opacityVertexArray),x.hasIconData()&&x.icon.opacityVertexBuffer&&x.icon.opacityVertexBuffer.updateData(x.icon.opacityVertexArray),x.hasIconCollisionBoxData()&&x.iconCollisionBox.collisionVertexBuffer&&x.iconCollisionBox.collisionVertexBuffer.updateData(x.iconCollisionBox.collisionVertexArray),x.hasTextCollisionBoxData()&&x.textCollisionBox.collisionVertexBuffer&&x.textCollisionBox.collisionVertexBuffer.updateData(x.textCollisionBox.collisionVertexArray),x.bucketInstanceId in this.collisionCircleArrays){var rr=this.collisionCircleArrays[x.bucketInstanceId];x.placementInvProjMatrix=rr.invProjMatrix,x.placementViewportMatrix=rr.viewportMatrix,x.collisionCircleArray=rr.circles,delete this.collisionCircleArrays[x.bucketInstanceId]}},ys.prototype.symbolFadeChange=function(x){return this.fadeDuration===0?1:(x-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ys.prototype.zoomAdjustment=function(x){return Math.max(0,(this.transform.zoom-x)/1.5)},ys.prototype.hasTransitions=function(x){return this.stale||x-this.lastPlacementChangeTime<this.fadeDuration},ys.prototype.stillRecent=function(x,C){var S=this.zoomAtLastRecencyCheck===C?1-this.zoomAdjustment(C):1;return this.zoomAtLastRecencyCheck=C,this.commitTime+this.fadeDuration*S>x},ys.prototype.setStale=function(){this.stale=!0};var mf=Math.pow(2,25),Wu=Math.pow(2,24),Ie=Math.pow(2,17),We=Math.pow(2,16),Tr=Math.pow(2,9),un=Math.pow(2,8),si=Math.pow(2,1);function ji(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;var C=x.placed?1:0,S=Math.floor(127*x.opacity);return S*mf+C*Wu+S*Ie+C*We+S*Tr+C*un+S*si+C}var Ma=0,ds=function(x){this._sortAcrossTiles=x.layout.get("symbol-z-order")!=="viewport-y"&&x.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ds.prototype.continuePlacement=function(x,C,S,M,z){for(var H=this._bucketParts;this._currentTileIndex<x.length;)if(C.getBucketParts(H,M,x[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,z())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,H.sort(function($,ft){return $.sortKey-ft.sortKey}));this._currentPartIndex<H.length;)if(C.placeLayerBucketPart(H[this._currentPartIndex],this._seenCrossTileIDs,S),this._currentPartIndex++,z())return!0;return!1};var Ho=function(x,C,S,M,z,H,$){this.placement=new ys(x,z,H,$),this._currentPlacementIndex=C.length-1,this._forceFullPlacement=S,this._showCollisionBoxes=M,this._done=!1};Ho.prototype.isDone=function(){return this._done},Ho.prototype.continuePlacement=function(x,C,S){for(var M=this,z=I.browser.now(),H=function(){var zt=I.browser.now()-z;return!M._forceFullPlacement&&zt>2};this._currentPlacementIndex>=0;){var $=C[x[this._currentPlacementIndex]],ft=this.placement.collisionIndex.transform.zoom;if($.type==="symbol"&&(!$.minzoom||$.minzoom<=ft)&&(!$.maxzoom||$.maxzoom>ft)){if(this._inProgressLayer||(this._inProgressLayer=new ds($)),this._inProgressLayer.continuePlacement(S[$.source],this.placement,this._showCollisionBoxes,$,H))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ho.prototype.commit=function(x){return this.placement.commit(x),this.placement};var qo=512/I.EXTENT/2,Hs=function(x,C,S){this.tileID=x,this.indexedSymbolInstances={},this.bucketInstanceId=S;for(var M=0;M<C.length;M++){var z=C.get(M),H=z.key;this.indexedSymbolInstances[H]||(this.indexedSymbolInstances[H]=[]),this.indexedSymbolInstances[H].push({crossTileID:z.crossTileID,coord:this.getScaledCoordinates(z,x)})}};Hs.prototype.getScaledCoordinates=function(x,C){var S=qo/Math.pow(2,C.canonical.z-this.tileID.canonical.z);return{x:Math.floor((C.canonical.x*I.EXTENT+x.anchorX)*S),y:Math.floor((C.canonical.y*I.EXTENT+x.anchorY)*S)}},Hs.prototype.findMatches=function(x,C,S){for(var M=this.tileID.canonical.z<C.canonical.z?1:Math.pow(2,this.tileID.canonical.z-C.canonical.z),z=0;z<x.length;z++){var H=x.get(z);if(!H.crossTileID){var $=this.indexedSymbolInstances[H.key];if($)for(var ft=this.getScaledCoordinates(H,C),zt=0,ee=$;zt<ee.length;zt+=1){var Re=ee[zt];if(Math.abs(Re.coord.x-ft.x)<=M&&Math.abs(Re.coord.y-ft.y)<=M&&!S[Re.crossTileID]){S[Re.crossTileID]=!0,H.crossTileID=Re.crossTileID;break}}}}};var Xu=function(){this.maxCrossTileID=0};Xu.prototype.generate=function(){return++this.maxCrossTileID};var _s=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};_s.prototype.handleWrapJump=function(x){var C=Math.round((x-this.lng)/360);if(C!==0)for(var S in this.indexes){var M=this.indexes[S],z={};for(var H in M){var $=M[H];$.tileID=$.tileID.unwrapTo($.tileID.wrap+C),z[$.tileID.key]=$}this.indexes[S]=z}this.lng=x},_s.prototype.addBucket=function(x,C,S){if(this.indexes[x.overscaledZ]&&this.indexes[x.overscaledZ][x.key]){if(this.indexes[x.overscaledZ][x.key].bucketInstanceId===C.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(x.overscaledZ,this.indexes[x.overscaledZ][x.key])}for(var M=0;M<C.symbolInstances.length;M++)C.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[x.overscaledZ]||(this.usedCrossTileIDs[x.overscaledZ]={});var z=this.usedCrossTileIDs[x.overscaledZ];for(var H in this.indexes){var $=this.indexes[H];if(Number(H)>x.overscaledZ)for(var ft in $){var zt=$[ft];zt.tileID.isChildOf(x)&&zt.findMatches(C.symbolInstances,x,z)}else{var ee=$[x.scaledTo(Number(H)).key];ee&&ee.findMatches(C.symbolInstances,x,z)}}for(var Re=0;Re<C.symbolInstances.length;Re++){var De=C.symbolInstances.get(Re);De.crossTileID||(De.crossTileID=S.generate(),z[De.crossTileID]=!0)}return this.indexes[x.overscaledZ]===void 0&&(this.indexes[x.overscaledZ]={}),this.indexes[x.overscaledZ][x.key]=new Hs(x,C.symbolInstances,C.bucketInstanceId),!0},_s.prototype.removeBucketCrossTileIDs=function(x,C){for(var S in C.indexedSymbolInstances)for(var M=0,z=C.indexedSymbolInstances[S];M<z.length;M+=1)delete this.usedCrossTileIDs[x][z[M].crossTileID]},_s.prototype.removeStaleBuckets=function(x){var C=!1;for(var S in this.indexes){var M=this.indexes[S];for(var z in M)x[M[z].bucketInstanceId]||(this.removeBucketCrossTileIDs(S,M[z]),delete M[z],C=!0)}return C};var vs=function(){this.layerIndexes={},this.crossTileIDs=new Xu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};vs.prototype.addLayer=function(x,C,S){var M=this.layerIndexes[x.id];M===void 0&&(M=this.layerIndexes[x.id]=new _s);var z=!1,H={};M.handleWrapJump(S);for(var $=0,ft=C;$<ft.length;$+=1){var zt=ft[$],ee=zt.getBucket(x);ee&&x.id===ee.layerIds[0]&&(ee.bucketInstanceId||(ee.bucketInstanceId=++this.maxBucketInstanceId),M.addBucket(zt.tileID,ee,this.crossTileIDs)&&(z=!0),H[ee.bucketInstanceId]=!0)}return M.removeStaleBuckets(H)&&(z=!0),z},vs.prototype.pruneUnusedLayers=function(x){var C={};for(var S in x.forEach(function(M){C[M]=!0}),this.layerIndexes)C[S]||delete this.layerIndexes[S]};var Ou=function(x,C){return I.emitValidationErrors(x,C&&C.filter(function(S){return S.identifier!=="source.canvas"}))},rl=I.pick(hi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),nu=I.pick(hi,["setCenter","setZoom","setBearing","setPitch"]),dl=function(){var x={},C=I.styleSpec.$version;for(var S in I.styleSpec.$root){var M,z=I.styleSpec.$root[S];z.required&&(M=S==="version"?C:z.type==="array"?[]:{})!=null&&(x[S]=M)}return x}(),Fu=function(x){function C(S,M){var z=this;M===void 0&&(M={}),x.call(this),this.map=S,this.dispatcher=new xe(Kr(),this),this.imageManager=new b,this.imageManager.setEventedParent(this),this.glyphManager=new Dt(S._requestManager,M.localIdeographFontFamily),this.lineAtlas=new te(256,512),this.crossTileSymbolIndex=new vs,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new I.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",I.getReferrer());var H=this;this._rtlTextPluginCallback=C.registerForPluginStateChange(function($){H.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:$.pluginStatus,pluginURL:$.pluginURL},function(ft,zt){if(I.triggerPluginCompletionEvent(ft),zt&&zt.every(function(Re){return Re}))for(var ee in H.sourceCaches)H.sourceCaches[ee].reload()})}),this.on("data",function($){if($.dataType==="source"&&$.sourceDataType==="metadata"){var ft=z.sourceCaches[$.sourceId];if(ft){var zt=ft.getSource();if(zt&&zt.vectorLayerIds)for(var ee in z._layers){var Re=z._layers[ee];Re.source===zt.id&&z._validateLayer(Re)}}}})}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.loadURL=function(S,M){var z=this;M===void 0&&(M={}),this.fire(new I.Event("dataloading",{dataType:"style"}));var H=typeof M.validate=="boolean"?M.validate:!I.isMapboxURL(S);S=this.map._requestManager.normalizeStyleURL(S,M.accessToken);var $=this.map._requestManager.transformRequest(S,I.ResourceType.Style);this._request=I.getJSON($,function(ft,zt){z._request=null,ft?z.fire(new I.ErrorEvent(ft)):zt&&z._load(zt,H)})},C.prototype.loadJSON=function(S,M){var z=this;M===void 0&&(M={}),this.fire(new I.Event("dataloading",{dataType:"style"})),this._request=I.browser.frame(function(){z._request=null,z._load(S,M.validate!==!1)})},C.prototype.loadEmpty=function(){this.fire(new I.Event("dataloading",{dataType:"style"})),this._load(dl,!1)},C.prototype._load=function(S,M){if(!M||!Ou(this,I.validateStyle(S))){for(var z in this._loaded=!0,this.stylesheet=S,S.sources)this.addSource(z,S.sources[z],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs);var H=li(this.stylesheet.layers);this._order=H.map(function(ee){return ee.id}),this._layers={},this._serializedLayers={};for(var $=0,ft=H;$<ft.length;$+=1){var zt=ft[$];(zt=I.createStyleLayer(zt)).setEventedParent(this,{layer:{id:zt.id}}),this._layers[zt.id]=zt,this._serializedLayers[zt.id]=zt.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ge(this.stylesheet.light),this.fire(new I.Event("data",{dataType:"style"})),this.fire(new I.Event("style.load"))}},C.prototype._loadSprite=function(S){var M=this;this._spriteRequest=function(z,H,$){var ft,zt,ee,Re=I.browser.devicePixelRatio>1?"@2x":"",De=I.getJSON(H.transformRequest(H.normalizeSpriteURL(z,Re,".json"),I.ResourceType.SpriteJSON),function(ar,br){De=null,ee||(ee=ar,ft=br,cr())}),ke=I.getImage(H.transformRequest(H.normalizeSpriteURL(z,Re,".png"),I.ResourceType.SpriteImage),function(ar,br){ke=null,ee||(ee=ar,zt=br,cr())});function cr(){if(ee)$(ee);else if(ft&&zt){var ar=I.browser.getImageData(zt),br={};for(var rr in ft){var xr=ft[rr],Pr=xr.width,Rr=xr.height,vn=xr.x,ln=xr.y,bn=xr.sdf,Zn=xr.pixelRatio,Kn=xr.stretchX,ci=xr.stretchY,Oi=xr.content,na=new I.RGBAImage({width:Pr,height:Rr});I.RGBAImage.copy(ar,na,{x:vn,y:ln},{x:0,y:0},{width:Pr,height:Rr}),br[rr]={data:na,pixelRatio:Zn,sdf:bn,stretchX:Kn,stretchY:ci,content:Oi}}$(null,br)}}return{cancel:function(){De&&(De.cancel(),De=null),ke&&(ke.cancel(),ke=null)}}}(S,this.map._requestManager,function(z,H){if(M._spriteRequest=null,z)M.fire(new I.ErrorEvent(z));else if(H)for(var $ in H)M.imageManager.addImage($,H[$]);M.imageManager.setLoaded(!0),M._availableImages=M.imageManager.listImages(),M.dispatcher.broadcast("setImages",M._availableImages),M.fire(new I.Event("data",{dataType:"style"}))})},C.prototype._validateLayer=function(S){var M=this.sourceCaches[S.source];if(M){var z=S.sourceLayer;if(z){var H=M.getSource();(H.type==="geojson"||H.vectorLayerIds&&H.vectorLayerIds.indexOf(z)===-1)&&this.fire(new I.ErrorEvent(new Error('Source layer "'+z+'" does not exist on source "'+H.id+'" as specified by style layer "'+S.id+'"')))}}},C.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var S in this.sourceCaches)if(!this.sourceCaches[S].loaded())return!1;return!!this.imageManager.isLoaded()},C.prototype._serializeLayers=function(S){for(var M=[],z=0,H=S;z<H.length;z+=1){var $=this._layers[H[z]];$.type!=="custom"&&M.push($.serialize())}return M},C.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var S in this.sourceCaches)if(this.sourceCaches[S].hasTransition())return!0;for(var M in this._layers)if(this._layers[M].hasTransition())return!0;return!1},C.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},C.prototype.update=function(S){if(this._loaded){var M=this._changed;if(this._changed){var z=Object.keys(this._updatedLayers),H=Object.keys(this._removedLayers);for(var $ in(z.length||H.length)&&this._updateWorkerLayers(z,H),this._updatedSources){var ft=this._updatedSources[$];ft==="reload"?this._reloadSource($):ft==="clear"&&this._clearSource($)}for(var zt in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[zt].updateTransitions(S);this.light.updateTransitions(S),this._resetUpdates()}var ee={};for(var Re in this.sourceCaches){var De=this.sourceCaches[Re];ee[Re]=De.used,De.used=!1}for(var ke=0,cr=this._order;ke<cr.length;ke+=1){var ar=this._layers[cr[ke]];ar.recalculate(S,this._availableImages),!ar.isHidden(S.zoom)&&ar.source&&(this.sourceCaches[ar.source].used=!0)}for(var br in ee){var rr=this.sourceCaches[br];ee[br]!==rr.used&&rr.fire(new I.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:br}))}this.light.recalculate(S),this.z=S.zoom,M&&this.fire(new I.Event("data",{dataType:"style"}))}},C.prototype._updateTilesForChangedImages=function(){var S=Object.keys(this._changedImages);if(S.length){for(var M in this.sourceCaches)this.sourceCaches[M].reloadTilesForDependencies(["icons","patterns"],S);this._changedImages={}}},C.prototype._updateWorkerLayers=function(S,M){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(S),removedIds:M})},C.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},C.prototype.setState=function(S){var M=this;if(this._checkLoaded(),Ou(this,I.validateStyle(S)))return!1;(S=I.clone$1(S)).layers=li(S.layers);var z=function($,ft){if(!$)return[{command:hi.setStyle,args:[ft]}];var zt=[];try{if(!I.deepEqual($.version,ft.version))return[{command:hi.setStyle,args:[ft]}];I.deepEqual($.center,ft.center)||zt.push({command:hi.setCenter,args:[ft.center]}),I.deepEqual($.zoom,ft.zoom)||zt.push({command:hi.setZoom,args:[ft.zoom]}),I.deepEqual($.bearing,ft.bearing)||zt.push({command:hi.setBearing,args:[ft.bearing]}),I.deepEqual($.pitch,ft.pitch)||zt.push({command:hi.setPitch,args:[ft.pitch]}),I.deepEqual($.sprite,ft.sprite)||zt.push({command:hi.setSprite,args:[ft.sprite]}),I.deepEqual($.glyphs,ft.glyphs)||zt.push({command:hi.setGlyphs,args:[ft.glyphs]}),I.deepEqual($.transition,ft.transition)||zt.push({command:hi.setTransition,args:[ft.transition]}),I.deepEqual($.light,ft.light)||zt.push({command:hi.setLight,args:[ft.light]});var ee={},Re=[];(function(ke,cr,ar,br){var rr;for(rr in cr=cr||{},ke=ke||{})ke.hasOwnProperty(rr)&&(cr.hasOwnProperty(rr)||Ci(rr,ar,br));for(rr in cr)cr.hasOwnProperty(rr)&&(ke.hasOwnProperty(rr)?I.deepEqual(ke[rr],cr[rr])||(ke[rr].type==="geojson"&&cr[rr].type==="geojson"&&po(ke,cr,rr)?ar.push({command:hi.setGeoJSONSourceData,args:[rr,cr[rr].data]}):Ba(rr,cr,ar,br)):ra(rr,cr,ar))})($.sources,ft.sources,Re,ee);var De=[];$.layers&&$.layers.forEach(function(ke){ee[ke.source]?zt.push({command:hi.removeLayer,args:[ke.id]}):De.push(ke)}),zt=zt.concat(Re),function(ke,cr,ar){cr=cr||[];var br,rr,xr,Pr,Rr,vn,ln,bn=(ke=ke||[]).map(Xa),Zn=cr.map(Xa),Kn=ke.reduce(Ta,{}),ci=cr.reduce(Ta,{}),Oi=bn.slice(),na=Object.create(null);for(br=0,rr=0;br<bn.length;br++)ci.hasOwnProperty(xr=bn[br])?rr++:(ar.push({command:hi.removeLayer,args:[xr]}),Oi.splice(Oi.indexOf(xr,rr),1));for(br=0,rr=0;br<Zn.length;br++)Oi[Oi.length-1-br]!==(xr=Zn[Zn.length-1-br])&&(Kn.hasOwnProperty(xr)?(ar.push({command:hi.removeLayer,args:[xr]}),Oi.splice(Oi.lastIndexOf(xr,Oi.length-rr),1)):rr++,ar.push({command:hi.addLayer,args:[ci[xr],vn=Oi[Oi.length-br]]}),Oi.splice(Oi.length-br,0,xr),na[xr]=!0);for(br=0;br<Zn.length;br++)if(Pr=Kn[xr=Zn[br]],Rr=ci[xr],!na[xr]&&!I.deepEqual(Pr,Rr))if(I.deepEqual(Pr.source,Rr.source)&&I.deepEqual(Pr["source-layer"],Rr["source-layer"])&&I.deepEqual(Pr.type,Rr.type)){for(ln in za(Pr.layout,Rr.layout,ar,xr,null,hi.setLayoutProperty),za(Pr.paint,Rr.paint,ar,xr,null,hi.setPaintProperty),I.deepEqual(Pr.filter,Rr.filter)||ar.push({command:hi.setFilter,args:[xr,Rr.filter]}),I.deepEqual(Pr.minzoom,Rr.minzoom)&&I.deepEqual(Pr.maxzoom,Rr.maxzoom)||ar.push({command:hi.setLayerZoomRange,args:[xr,Rr.minzoom,Rr.maxzoom]}),Pr)Pr.hasOwnProperty(ln)&&ln!=="layout"&&ln!=="paint"&&ln!=="filter"&&ln!=="metadata"&&ln!=="minzoom"&&ln!=="maxzoom"&&(ln.indexOf("paint.")===0?za(Pr[ln],Rr[ln],ar,xr,ln.slice(6),hi.setPaintProperty):I.deepEqual(Pr[ln],Rr[ln])||ar.push({command:hi.setLayerProperty,args:[xr,ln,Rr[ln]]}));for(ln in Rr)Rr.hasOwnProperty(ln)&&!Pr.hasOwnProperty(ln)&&ln!=="layout"&&ln!=="paint"&&ln!=="filter"&&ln!=="metadata"&&ln!=="minzoom"&&ln!=="maxzoom"&&(ln.indexOf("paint.")===0?za(Pr[ln],Rr[ln],ar,xr,ln.slice(6),hi.setPaintProperty):I.deepEqual(Pr[ln],Rr[ln])||ar.push({command:hi.setLayerProperty,args:[xr,ln,Rr[ln]]}))}else ar.push({command:hi.removeLayer,args:[xr]}),vn=Oi[Oi.lastIndexOf(xr)+1],ar.push({command:hi.addLayer,args:[Rr,vn]})}(De,ft.layers,zt)}catch(ke){console.warn("Unable to compute style diff:",ke),zt=[{command:hi.setStyle,args:[ft]}]}return zt}(this.serialize(),S).filter(function($){return!($.command in nu)});if(z.length===0)return!1;var H=z.filter(function($){return!($.command in rl)});if(H.length>0)throw new Error("Unimplemented: "+H.map(function($){return $.command}).join(", ")+".");return z.forEach(function($){$.command!=="setTransition"&&M[$.command].apply(M,$.args)}),this.stylesheet=S,!0},C.prototype.addImage=function(S,M){if(this.getImage(S))return this.fire(new I.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(S,M),this._afterImageUpdated(S)},C.prototype.updateImage=function(S,M){this.imageManager.updateImage(S,M)},C.prototype.getImage=function(S){return this.imageManager.getImage(S)},C.prototype.removeImage=function(S){if(!this.getImage(S))return this.fire(new I.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(S),this._afterImageUpdated(S)},C.prototype._afterImageUpdated=function(S){this._availableImages=this.imageManager.listImages(),this._changedImages[S]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new I.Event("data",{dataType:"style"}))},C.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},C.prototype.addSource=function(S,M,z){var H=this;if(z===void 0&&(z={}),this._checkLoaded(),this.sourceCaches[S]!==void 0)throw new Error("There is already a source with this ID");if(!M.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(M).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(M.type)>=0&&this._validate(I.validateStyle.source,"sources."+S,M,null,z))){this.map&&this.map._collectResourceTiming&&(M.collectResourceTiming=!0);var $=this.sourceCaches[S]=new ur(S,M,this.dispatcher);$.style=this,$.setEventedParent(this,function(){return{isSourceLoaded:H.loaded(),source:$.serialize(),sourceId:S}}),$.onAdd(this.map),this._changed=!0}},C.prototype.removeSource=function(S){if(this._checkLoaded(),this.sourceCaches[S]===void 0)throw new Error("There is no source with this ID");for(var M in this._layers)if(this._layers[M].source===S)return this.fire(new I.ErrorEvent(new Error('Source "'+S+'" cannot be removed while layer "'+M+'" is using it.')));var z=this.sourceCaches[S];delete this.sourceCaches[S],delete this._updatedSources[S],z.fire(new I.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:S})),z.setEventedParent(null),z.clearTiles(),z.onRemove&&z.onRemove(this.map),this._changed=!0},C.prototype.setGeoJSONSourceData=function(S,M){this._checkLoaded(),this.sourceCaches[S].getSource().setData(M),this._changed=!0},C.prototype.getSource=function(S){return this.sourceCaches[S]&&this.sourceCaches[S].getSource()},C.prototype.addLayer=function(S,M,z){z===void 0&&(z={}),this._checkLoaded();var H=S.id;if(this.getLayer(H))this.fire(new I.ErrorEvent(new Error('Layer with id "'+H+'" already exists on this map')));else{var $;if(S.type==="custom"){if(Ou(this,I.validateCustomStyleLayer(S)))return;$=I.createStyleLayer(S)}else{if(typeof S.source=="object"&&(this.addSource(H,S.source),S=I.clone$1(S),S=I.extend(S,{source:H})),this._validate(I.validateStyle.layer,"layers."+H,S,{arrayIndex:-1},z))return;$=I.createStyleLayer(S),this._validateLayer($),$.setEventedParent(this,{layer:{id:H}}),this._serializedLayers[$.id]=$.serialize()}var ft=M?this._order.indexOf(M):this._order.length;if(M&&ft===-1)this.fire(new I.ErrorEvent(new Error('Layer with id "'+M+'" does not exist on this map.')));else{if(this._order.splice(ft,0,H),this._layerOrderChanged=!0,this._layers[H]=$,this._removedLayers[H]&&$.source&&$.type!=="custom"){var zt=this._removedLayers[H];delete this._removedLayers[H],zt.type!==$.type?this._updatedSources[$.source]="clear":(this._updatedSources[$.source]="reload",this.sourceCaches[$.source].pause())}this._updateLayer($),$.onAdd&&$.onAdd(this.map)}}},C.prototype.moveLayer=function(S,M){if(this._checkLoaded(),this._changed=!0,this._layers[S]){if(S!==M){var z=this._order.indexOf(S);this._order.splice(z,1);var H=M?this._order.indexOf(M):this._order.length;M&&H===-1?this.fire(new I.ErrorEvent(new Error('Layer with id "'+M+'" does not exist on this map.'))):(this._order.splice(H,0,S),this._layerOrderChanged=!0)}}else this.fire(new I.ErrorEvent(new Error("The layer '"+S+"' does not exist in the map's style and cannot be moved.")))},C.prototype.removeLayer=function(S){this._checkLoaded();var M=this._layers[S];if(M){M.setEventedParent(null);var z=this._order.indexOf(S);this._order.splice(z,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[S]=M,delete this._layers[S],delete this._serializedLayers[S],delete this._updatedLayers[S],delete this._updatedPaintProps[S],M.onRemove&&M.onRemove(this.map)}else this.fire(new I.ErrorEvent(new Error("The layer '"+S+"' does not exist in the map's style and cannot be removed.")))},C.prototype.getLayer=function(S){return this._layers[S]},C.prototype.hasLayer=function(S){return S in this._layers},C.prototype.setLayerZoomRange=function(S,M,z){this._checkLoaded();var H=this.getLayer(S);H?H.minzoom===M&&H.maxzoom===z||(M!=null&&(H.minzoom=M),z!=null&&(H.maxzoom=z),this._updateLayer(H)):this.fire(new I.ErrorEvent(new Error("The layer '"+S+"' does not exist in the map's style and cannot have zoom extent.")))},C.prototype.setFilter=function(S,M,z){z===void 0&&(z={}),this._checkLoaded();var H=this.getLayer(S);if(H){if(!I.deepEqual(H.filter,M))return M==null?(H.filter=void 0,void this._updateLayer(H)):void(this._validate(I.validateStyle.filter,"layers."+H.id+".filter",M,null,z)||(H.filter=I.clone$1(M),this._updateLayer(H)))}else this.fire(new I.ErrorEvent(new Error("The layer '"+S+"' does not exist in the map's style and cannot be filtered.")))},C.prototype.getFilter=function(S){return I.clone$1(this.getLayer(S).filter)},C.prototype.setLayoutProperty=function(S,M,z,H){H===void 0&&(H={}),this._checkLoaded();var $=this.getLayer(S);$?I.deepEqual($.getLayoutProperty(M),z)||($.setLayoutProperty(M,z,H),this._updateLayer($)):this.fire(new I.ErrorEvent(new Error("The layer '"+S+"' does not exist in the map's style and cannot be styled.")))},C.prototype.getLayoutProperty=function(S,M){var z=this.getLayer(S);if(z)return z.getLayoutProperty(M);this.fire(new I.ErrorEvent(new Error("The layer '"+S+"' does not exist in the map's style.")))},C.prototype.setPaintProperty=function(S,M,z,H){H===void 0&&(H={}),this._checkLoaded();var $=this.getLayer(S);$?I.deepEqual($.getPaintProperty(M),z)||($.setPaintProperty(M,z,H)&&this._updateLayer($),this._changed=!0,this._updatedPaintProps[S]=!0):this.fire(new I.ErrorEvent(new Error("The layer '"+S+"' does not exist in the map's style and cannot be styled.")))},C.prototype.getPaintProperty=function(S,M){return this.getLayer(S).getPaintProperty(M)},C.prototype.setFeatureState=function(S,M){this._checkLoaded();var z=S.source,H=S.sourceLayer,$=this.sourceCaches[z];if($!==void 0){var ft=$.getSource().type;ft==="geojson"&&H?this.fire(new I.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ft!=="vector"||H?(S.id===void 0&&this.fire(new I.ErrorEvent(new Error("The feature id parameter must be provided."))),$.setFeatureState(H,S.id,M)):this.fire(new I.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new I.ErrorEvent(new Error("The source '"+z+"' does not exist in the map's style.")))},C.prototype.removeFeatureState=function(S,M){this._checkLoaded();var z=S.source,H=this.sourceCaches[z];if(H!==void 0){var $=H.getSource().type,ft=$==="vector"?S.sourceLayer:void 0;$!=="vector"||ft?M&&typeof S.id!="string"&&typeof S.id!="number"?this.fire(new I.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):H.removeFeatureState(ft,S.id,M):this.fire(new I.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new I.ErrorEvent(new Error("The source '"+z+"' does not exist in the map's style.")))},C.prototype.getFeatureState=function(S){this._checkLoaded();var M=S.source,z=S.sourceLayer,H=this.sourceCaches[M];if(H!==void 0){if(H.getSource().type!=="vector"||z)return S.id===void 0&&this.fire(new I.ErrorEvent(new Error("The feature id parameter must be provided."))),H.getFeatureState(z,S.id);this.fire(new I.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new I.ErrorEvent(new Error("The source '"+M+"' does not exist in the map's style.")))},C.prototype.getTransition=function(){return I.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},C.prototype.serialize=function(){return I.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:I.mapObject(this.sourceCaches,function(S){return S.serialize()}),layers:this._serializeLayers(this._order)},function(S){return S!==void 0})},C.prototype._updateLayer=function(S){this._updatedLayers[S.id]=!0,S.source&&!this._updatedSources[S.source]&&this.sourceCaches[S.source].getSource().type!=="raster"&&(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause()),this._changed=!0},C.prototype._flattenAndSortRenderedFeatures=function(S){for(var M=this,z=function(Kn){return M._layers[Kn].type==="fill-extrusion"},H={},$=[],ft=this._order.length-1;ft>=0;ft--){var zt=this._order[ft];if(z(zt)){H[zt]=ft;for(var ee=0,Re=S;ee<Re.length;ee+=1){var De=Re[ee][zt];if(De)for(var ke=0,cr=De;ke<cr.length;ke+=1)$.push(cr[ke])}}}$.sort(function(Kn,ci){return ci.intersectionZ-Kn.intersectionZ});for(var ar=[],br=this._order.length-1;br>=0;br--){var rr=this._order[br];if(z(rr))for(var xr=$.length-1;xr>=0;xr--){var Pr=$[xr].feature;if(H[Pr.layer.id]<br)break;ar.push(Pr),$.pop()}else for(var Rr=0,vn=S;Rr<vn.length;Rr+=1){var ln=vn[Rr][rr];if(ln)for(var bn=0,Zn=ln;bn<Zn.length;bn+=1)ar.push(Zn[bn].feature)}}return ar},C.prototype.queryRenderedFeatures=function(S,M,z){M&&M.filter&&this._validate(I.validateStyle.filter,"queryRenderedFeatures.filter",M.filter,null,M);var H={};if(M&&M.layers){if(!Array.isArray(M.layers))return this.fire(new I.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var $=0,ft=M.layers;$<ft.length;$+=1){var zt=ft[$],ee=this._layers[zt];if(!ee)return this.fire(new I.ErrorEvent(new Error("The layer '"+zt+"' does not exist in the map's style and cannot be queried for features."))),[];H[ee.source]=!0}}var Re=[];for(var De in M.availableImages=this._availableImages,this.sourceCaches)M.layers&&!H[De]||Re.push(ne(this.sourceCaches[De],this._layers,this._serializedLayers,S,M,z));return this.placement&&Re.push(function(ke,cr,ar,br,rr,xr,Pr){for(var Rr={},vn=xr.queryRenderedSymbols(br),ln=[],bn=0,Zn=Object.keys(vn).map(Number);bn<Zn.length;bn+=1)ln.push(Pr[Zn[bn]]);ln.sort(Me);for(var Kn=function(){var ua=Oi[ci],Qa=ua.featureIndex.lookupSymbolFeatures(vn[ua.bucketInstanceId],cr,ua.bucketIndex,ua.sourceLayerIndex,rr.filter,rr.layers,rr.availableImages,ke);for(var Fi in Qa){var Ra=Rr[Fi]=Rr[Fi]||[],Aa=Qa[Fi];Aa.sort(function(Na,pa){var da=ua.featureSortOrder;if(da){var Ds=da.indexOf(Na.featureIndex);return da.indexOf(pa.featureIndex)-Ds}return pa.featureIndex-Na.featureIndex});for(var ka=0,la=Aa;ka<la.length;ka+=1)Ra.push(la[ka])}},ci=0,Oi=ln;ci<Oi.length;ci+=1)Kn();var na=function(ua){Rr[ua].forEach(function(Qa){var Fi=Qa.feature,Ra=ar[ke[ua].source].getFeatureState(Fi.layer["source-layer"],Fi.id);Fi.source=Fi.layer.source,Fi.layer["source-layer"]&&(Fi.sourceLayer=Fi.layer["source-layer"]),Fi.state=Ra})};for(var ia in Rr)na(ia);return Rr}(this._layers,this._serializedLayers,this.sourceCaches,S,M,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Re)},C.prototype.querySourceFeatures=function(S,M){M&&M.filter&&this._validate(I.validateStyle.filter,"querySourceFeatures.filter",M.filter,null,M);var z=this.sourceCaches[S];return z?function(H,$){for(var ft=H.getRenderableIds().map(function(cr){return H.getTileByID(cr)}),zt=[],ee={},Re=0;Re<ft.length;Re++){var De=ft[Re],ke=De.tileID.canonical.key;ee[ke]||(ee[ke]=!0,De.querySourceFeatures(zt,$))}return zt}(z,M):[]},C.prototype.addSourceType=function(S,M,z){return C.getSourceType(S)?z(new Error('A source type called "'+S+'" already exists.')):(C.setSourceType(S,M),M.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:S,url:M.workerSourceURL},z):z(null,null))},C.prototype.getLight=function(){return this.light.getLight()},C.prototype.setLight=function(S,M){M===void 0&&(M={}),this._checkLoaded();var z=this.light.getLight(),H=!1;for(var $ in S)if(!I.deepEqual(S[$],z[$])){H=!0;break}if(H){var ft={now:I.browser.now(),transition:I.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(S,M),this.light.updateTransitions(ft)}},C.prototype._validate=function(S,M,z,H,$){return $===void 0&&($={}),(!$||$.validate!==!1)&&Ou(this,S.call(I.validateStyle,I.extend({key:M,style:this.serialize(),value:z,styleSpec:I.styleSpec},H)))},C.prototype._remove=function(){for(var S in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),I.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[S].setEventedParent(null);for(var M in this.sourceCaches)this.sourceCaches[M].clearTiles(),this.sourceCaches[M].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},C.prototype._clearSource=function(S){this.sourceCaches[S].clearTiles()},C.prototype._reloadSource=function(S){this.sourceCaches[S].resume(),this.sourceCaches[S].reload()},C.prototype._updateSources=function(S){for(var M in this.sourceCaches)this.sourceCaches[M].update(S)},C.prototype._generateCollisionBoxes=function(){for(var S in this.sourceCaches)this._reloadSource(S)},C.prototype._updatePlacement=function(S,M,z,H,$){$===void 0&&($=!1);for(var ft=!1,zt=!1,ee={},Re=0,De=this._order;Re<De.length;Re+=1){var ke=this._layers[De[Re]];if(ke.type==="symbol"){if(!ee[ke.source]){var cr=this.sourceCaches[ke.source];ee[ke.source]=cr.getRenderableIds(!0).map(function(Pr){return cr.getTileByID(Pr)}).sort(function(Pr,Rr){return Rr.tileID.overscaledZ-Pr.tileID.overscaledZ||(Pr.tileID.isLessThan(Rr.tileID)?-1:1)})}var ar=this.crossTileSymbolIndex.addLayer(ke,ee[ke.source],S.center.lng);ft=ft||ar}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),(($=$||this._layerOrderChanged||z===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(I.browser.now(),S.zoom))&&(this.pauseablePlacement=new Ho(S,this._order,$,M,z,H,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ee),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(I.browser.now()),zt=!0),ft&&this.pauseablePlacement.placement.setStale()),zt||ft)for(var br=0,rr=this._order;br<rr.length;br+=1){var xr=this._layers[rr[br]];xr.type==="symbol"&&this.placement.updateLayerOpacities(xr,ee[xr.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(I.browser.now())},C.prototype._releaseSymbolFadeTiles=function(){for(var S in this.sourceCaches)this.sourceCaches[S].releaseSymbolFadeTiles()},C.prototype.getImages=function(S,M,z){this.imageManager.getImages(M.icons,z),this._updateTilesForChangedImages();var H=this.sourceCaches[M.source];H&&H.setDependencies(M.tileID.key,M.type,M.icons)},C.prototype.getGlyphs=function(S,M,z){this.glyphManager.getGlyphs(M.stacks,z)},C.prototype.getResource=function(S,M,z){return I.makeRequest(M,z)},C}(I.Evented);Fu.getSourceType=function(x){return er[x]},Fu.setSourceType=function(x,C){er[x]=C},Fu.registerForPluginStateChange=I.registerForPluginStateChange;var Fo=I.createLayout([{name:"a_pos",type:"Int16",components:2}]),rs=qa(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Uc=qa(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),_u=qa(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Zc=qa(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Co=qa("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),sc=qa(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Xl=qa(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),nl=qa("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),uc=qa("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),D=qa("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),X=qa(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),_t=qa(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),rt=qa(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),se=qa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Ze=qa(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Sr=qa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),jr=qa(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Vr=qa(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ln=qa(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Gn=qa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),$i=qa(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Pa=qa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ba=qa(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),uo=qa(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Ca=qa(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Ao=qa(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function qa(x,C){var S=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,M=C.match(/attribute ([\w]+) ([\w]+)/g),z=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),H=C.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),$=H?H.concat(z):z,ft={};return{fragmentSource:x=x.replace(S,function(zt,ee,Re,De,ke){return ft[ke]=!0,ee==="define"?`
#ifndef HAS_UNIFORM_u_`+ke+`
varying `+Re+" "+De+" "+ke+`;
#else
uniform `+Re+" "+De+" u_"+ke+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+ke+`
    `+Re+" "+De+" "+ke+" = u_"+ke+`;
#endif
`}),vertexSource:C=C.replace(S,function(zt,ee,Re,De,ke){var cr=De==="float"?"vec2":"vec4",ar=ke.match(/color/)?"color":cr;return ft[ke]?ee==="define"?`
#ifndef HAS_UNIFORM_u_`+ke+`
uniform lowp float u_`+ke+`_t;
attribute `+Re+" "+cr+" a_"+ke+`;
varying `+Re+" "+De+" "+ke+`;
#else
uniform `+Re+" "+De+" u_"+ke+`;
#endif
`:ar==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ke+`
    `+ke+" = a_"+ke+`;
#else
    `+Re+" "+De+" "+ke+" = u_"+ke+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ke+`
    `+ke+" = unpack_mix_"+ar+"(a_"+ke+", u_"+ke+`_t);
#else
    `+Re+" "+De+" "+ke+" = u_"+ke+`;
#endif
`:ee==="define"?`
#ifndef HAS_UNIFORM_u_`+ke+`
uniform lowp float u_`+ke+`_t;
attribute `+Re+" "+cr+" a_"+ke+`;
#else
uniform `+Re+" "+De+" u_"+ke+`;
#endif
`:ar==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ke+`
    `+Re+" "+De+" "+ke+" = a_"+ke+`;
#else
    `+Re+" "+De+" "+ke+" = u_"+ke+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ke+`
    `+Re+" "+De+" "+ke+" = unpack_mix_"+ar+"(a_"+ke+", u_"+ke+`_t);
#else
    `+Re+" "+De+" "+ke+" = u_"+ke+`;
#endif
`}),staticAttributes:M,staticUniforms:$}}var gs=Object.freeze({__proto__:null,prelude:rs,background:Uc,backgroundPattern:_u,circle:Zc,clippingMask:Co,heatmap:sc,heatmapTexture:Xl,collisionBox:nl,collisionCircle:uc,debug:D,fill:X,fillOutline:_t,fillOutlinePattern:rt,fillPattern:se,fillExtrusion:Ze,fillExtrusionPattern:Sr,hillshadePrepare:jr,hillshade:Vr,line:Ln,lineGradient:Gn,linePattern:$i,lineSDF:Pa,raster:ba,symbolIcon:uo,symbolSDF:Ca,symbolTextAndIcon:Ao}),xu=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function il(x){for(var C=[],S=0;S<x.length;S++)if(x[S]!==null){var M=x[S].split(" ");C.push(M.pop())}return C}xu.prototype.bind=function(x,C,S,M,z,H,$,ft){this.context=x;for(var zt=this.boundPaintVertexBuffers.length!==M.length,ee=0;!zt&&ee<M.length;ee++)this.boundPaintVertexBuffers[ee]!==M[ee]&&(zt=!0);x.extVertexArrayObject&&this.vao&&this.boundProgram===C&&this.boundLayoutVertexBuffer===S&&!zt&&this.boundIndexBuffer===z&&this.boundVertexOffset===H&&this.boundDynamicVertexBuffer===$&&this.boundDynamicVertexBuffer2===ft?(x.bindVertexArrayOES.set(this.vao),$&&$.bind(),z&&z.dynamicDraw&&z.bind(),ft&&ft.bind()):this.freshBind(C,S,M,z,H,$,ft)},xu.prototype.freshBind=function(x,C,S,M,z,H,$){var ft,zt=x.numAttributes,ee=this.context,Re=ee.gl;if(ee.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ee.extVertexArrayObject.createVertexArrayOES(),ee.bindVertexArrayOES.set(this.vao),ft=0,this.boundProgram=x,this.boundLayoutVertexBuffer=C,this.boundPaintVertexBuffers=S,this.boundIndexBuffer=M,this.boundVertexOffset=z,this.boundDynamicVertexBuffer=H,this.boundDynamicVertexBuffer2=$;else{ft=ee.currentNumAttributes||0;for(var De=zt;De<ft;De++)Re.disableVertexAttribArray(De)}C.enableAttributes(Re,x);for(var ke=0,cr=S;ke<cr.length;ke+=1)cr[ke].enableAttributes(Re,x);H&&H.enableAttributes(Re,x),$&&$.enableAttributes(Re,x),C.bind(),C.setVertexAttribPointers(Re,x,z);for(var ar=0,br=S;ar<br.length;ar+=1){var rr=br[ar];rr.bind(),rr.setVertexAttribPointers(Re,x,z)}H&&(H.bind(),H.setVertexAttribPointers(Re,x,z)),M&&M.bind(),$&&($.bind(),$.setVertexAttribPointers(Re,x,z)),ee.currentNumAttributes=zt},xu.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var bu=function(x,C,S,M,z,H){var $=x.gl;this.program=$.createProgram();for(var ft=il(S.staticAttributes),zt=M?M.getBinderAttributes():[],ee=ft.concat(zt),Re=S.staticUniforms?il(S.staticUniforms):[],De=M?M.getBinderUniforms():[],ke=[],cr=0,ar=Re.concat(De);cr<ar.length;cr+=1){var br=ar[cr];ke.indexOf(br)<0&&ke.push(br)}var rr=M?M.defines():[];H&&rr.push("#define OVERDRAW_INSPECTOR;");var xr=rr.concat(rs.fragmentSource,S.fragmentSource).join(`
`),Pr=rr.concat(rs.vertexSource,S.vertexSource).join(`
`),Rr=$.createShader($.FRAGMENT_SHADER);if($.isContextLost())this.failedToCreate=!0;else{$.shaderSource(Rr,xr),$.compileShader(Rr),$.attachShader(this.program,Rr);var vn=$.createShader($.VERTEX_SHADER);if($.isContextLost())this.failedToCreate=!0;else{$.shaderSource(vn,Pr),$.compileShader(vn),$.attachShader(this.program,vn),this.attributes={};var ln={};this.numAttributes=ee.length;for(var bn=0;bn<this.numAttributes;bn++)ee[bn]&&($.bindAttribLocation(this.program,bn,ee[bn]),this.attributes[ee[bn]]=bn);$.linkProgram(this.program),$.deleteShader(vn),$.deleteShader(Rr);for(var Zn=0;Zn<ke.length;Zn++){var Kn=ke[Zn];if(Kn&&!ln[Kn]){var ci=$.getUniformLocation(this.program,Kn);ci&&(ln[Kn]=ci)}}this.fixedUniforms=z(x,ln),this.binderUniforms=M?M.getUniforms(x,ln):[]}}};function iu(x,C,S){var M=1/Cn(S,1,C.transform.tileZoom),z=Math.pow(2,S.tileID.overscaledZ),H=S.tileSize*Math.pow(2,C.transform.tileZoom)/z,$=H*(S.tileID.canonical.x+S.tileID.wrap*z),ft=H*S.tileID.canonical.y;return{u_image:0,u_texsize:S.imageAtlasTexture.size,u_scale:[M,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[$>>16,ft>>16],u_pixel_coord_lower:[65535&$,65535&ft]}}bu.prototype.draw=function(x,C,S,M,z,H,$,ft,zt,ee,Re,De,ke,cr,ar,br){var rr,xr=x.gl;if(!this.failedToCreate){for(var Pr in x.program.set(this.program),x.setDepthMode(S),x.setStencilMode(M),x.setColorMode(z),x.setCullFace(H),this.fixedUniforms)this.fixedUniforms[Pr].set($[Pr]);cr&&cr.setUniforms(x,this.binderUniforms,De,{zoom:ke});for(var Rr=(rr={},rr[xr.LINES]=2,rr[xr.TRIANGLES]=3,rr[xr.LINE_STRIP]=1,rr)[C],vn=0,ln=Re.get();vn<ln.length;vn+=1){var bn=ln[vn],Zn=bn.vaos||(bn.vaos={});(Zn[ft]||(Zn[ft]=new xu)).bind(x,this,zt,cr?cr.getPaintVertexBuffers():[],ee,bn.vertexOffset,ar,br),xr.drawElements(C,bn.primitiveLength*Rr,xr.UNSIGNED_SHORT,bn.primitiveOffset*Rr*2)}}};var Vc=function(x,C,S,M){var z=C.style.light,H=z.properties.get("position"),$=[H.x,H.y,H.z],ft=I.create$1();z.properties.get("anchor")==="viewport"&&I.fromRotation(ft,-C.transform.angle),I.transformMat3($,$,ft);var zt=z.properties.get("color");return{u_matrix:x,u_lightpos:$,u_lightintensity:z.properties.get("intensity"),u_lightcolor:[zt.r,zt.g,zt.b],u_vertical_gradient:+S,u_opacity:M}},$s=function(x,C,S,M,z,H,$){return I.extend(Vc(x,C,S,M),iu(H,C,$),{u_height_factor:-Math.pow(2,z.overscaledZ)/$.tileSize/8})},Yl=function(x){return{u_matrix:x}},me=function(x,C,S,M){return I.extend(Yl(x),iu(S,C,M))},ir=function(x,C){return{u_matrix:x,u_world:C}},Or=function(x,C,S,M,z){return I.extend(me(x,C,S,M),{u_world:z})},$r=function(x,C,S,M){var z,H,$=x.transform;if(M.paint.get("circle-pitch-alignment")==="map"){var ft=Cn(S,1,$.zoom);z=!0,H=[ft,ft]}else z=!1,H=$.pixelsToGLUnits;return{u_camera_to_center_distance:$.cameraToCenterDistance,u_scale_with_map:+(M.paint.get("circle-pitch-scale")==="map"),u_matrix:x.translatePosMatrix(C.posMatrix,S,M.paint.get("circle-translate"),M.paint.get("circle-translate-anchor")),u_pitch_with_map:+z,u_device_pixel_ratio:I.browser.devicePixelRatio,u_extrude_scale:H}},xn=function(x,C,S){var M=Cn(S,1,C.zoom),z=Math.pow(2,C.zoom-S.tileID.overscaledZ),H=S.tileID.overscaleFactor();return{u_matrix:x,u_camera_to_center_distance:C.cameraToCenterDistance,u_pixels_to_tile_units:M,u_extrude_scale:[C.pixelsToGLUnits[0]/(M*z),C.pixelsToGLUnits[1]/(M*z)],u_overscale_factor:H}},_i=function(x,C,S){return{u_matrix:x,u_inv_matrix:C,u_camera_to_center_distance:S.cameraToCenterDistance,u_viewport_size:[S.width,S.height]}},qi=function(x,C,S){return S===void 0&&(S=1),{u_matrix:x,u_color:C,u_overlay:0,u_overlay_scale:S}},Ia=function(x){return{u_matrix:x}},du=function(x,C,S,M){return{u_matrix:x,u_extrude_scale:Cn(C,1,S),u_intensity:M}},qs=function(x,C,S){var M=x.transform;return{u_matrix:vd(x,C,S),u_ratio:1/Cn(C,1,M.zoom),u_device_pixel_ratio:I.browser.devicePixelRatio,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]]}},$a=function(x,C,S,M){return I.extend(qs(x,C,S),{u_image:0,u_image_height:M})},Dl=function(x,C,S,M){var z=x.transform,H=yf(C,z);return{u_matrix:vd(x,C,S),u_texsize:C.imageAtlasTexture.size,u_ratio:1/Cn(C,1,z.zoom),u_device_pixel_ratio:I.browser.devicePixelRatio,u_image:0,u_scale:[H,M.fromScale,M.toScale],u_fade:M.t,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]]}},av=function(x,C,S,M,z){var H=x.lineAtlas,$=yf(C,x.transform),ft=S.layout.get("line-cap")==="round",zt=H.getDash(M.from,ft),ee=H.getDash(M.to,ft),Re=zt.width*z.fromScale,De=ee.width*z.toScale;return I.extend(qs(x,C,S),{u_patternscale_a:[$/Re,-zt.height/2],u_patternscale_b:[$/De,-ee.height/2],u_sdfgamma:H.width/(256*Math.min(Re,De)*I.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:zt.y,u_tex_y_b:ee.y,u_mix:z.t})};function yf(x,C){return 1/Cn(x,1,C.tileZoom)}function vd(x,C,S){return x.translatePosMatrix(C.tileID.posMatrix,C,S.paint.get("line-translate"),S.paint.get("line-translate-anchor"))}var ov=function(x,C,S,M,z){return{u_matrix:x,u_tl_parent:C,u_scale_parent:S,u_buffer_scale:1,u_fade_t:M.mix,u_opacity:M.opacity*z.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:z.paint.get("raster-brightness-min"),u_brightness_high:z.paint.get("raster-brightness-max"),u_saturation_factor:($=z.paint.get("raster-saturation"),$>0?1-1/(1.001-$):-$),u_contrast_factor:(H=z.paint.get("raster-contrast"),H>0?1/(1-H):1+H),u_spin_weights:sv(z.paint.get("raster-hue-rotate"))};var H,$};function sv(x){x*=Math.PI/180;var C=Math.sin(x),S=Math.cos(x);return[(2*S+1)/3,(-Math.sqrt(3)*C-S+1)/3,(Math.sqrt(3)*C-S+1)/3]}var dh,zf=function(x,C,S,M,z,H,$,ft,zt,ee){var Re=z.transform;return{u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:C?C.uSizeT:0,u_size:C?C.uSize:0,u_camera_to_center_distance:Re.cameraToCenterDistance,u_pitch:Re.pitch/360*2*Math.PI,u_rotate_symbol:+S,u_aspect_ratio:Re.width/Re.height,u_fade_change:z.options.fadeDuration?z.symbolFadeChange:1,u_matrix:H,u_label_plane_matrix:$,u_coord_matrix:ft,u_is_text:+zt,u_pitch_with_map:+M,u_texsize:ee,u_texture:0}},Gc=function(x,C,S,M,z,H,$,ft,zt,ee,Re){var De=z.transform;return I.extend(zf(x,C,S,M,z,H,$,ft,zt,ee),{u_gamma_scale:M?Math.cos(De._pitch)*De.cameraToCenterDistance:1,u_device_pixel_ratio:I.browser.devicePixelRatio,u_is_halo:+Re})},vh=function(x,C,S,M,z,H,$,ft,zt,ee){return I.extend(Gc(x,C,S,M,z,H,$,ft,!0,zt,!0),{u_texsize_icon:ee,u_texture_icon:1})},Uf=function(x,C,S){return{u_matrix:x,u_opacity:C,u_color:S}},lc=function(x,C,S,M,z,H){return I.extend(function($,ft,zt,ee){var Re=zt.imageManager.getPattern($.from.toString()),De=zt.imageManager.getPattern($.to.toString()),ke=zt.imageManager.getPixelSize(),cr=ke.width,ar=ke.height,br=Math.pow(2,ee.tileID.overscaledZ),rr=ee.tileSize*Math.pow(2,zt.transform.tileZoom)/br,xr=rr*(ee.tileID.canonical.x+ee.tileID.wrap*br),Pr=rr*ee.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Re.tl,u_pattern_br_a:Re.br,u_pattern_tl_b:De.tl,u_pattern_br_b:De.br,u_texsize:[cr,ar],u_mix:ft.t,u_pattern_size_a:Re.displaySize,u_pattern_size_b:De.displaySize,u_scale_a:ft.fromScale,u_scale_b:ft.toScale,u_tile_units_to_pixels:1/Cn(ee,1,zt.transform.tileZoom),u_pixel_coord_upper:[xr>>16,Pr>>16],u_pixel_coord_lower:[65535&xr,65535&Pr]}}(M,H,S,z),{u_matrix:x,u_opacity:C})},al={fillExtrusion:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_lightpos:new I.Uniform3f(x,C.u_lightpos),u_lightintensity:new I.Uniform1f(x,C.u_lightintensity),u_lightcolor:new I.Uniform3f(x,C.u_lightcolor),u_vertical_gradient:new I.Uniform1f(x,C.u_vertical_gradient),u_opacity:new I.Uniform1f(x,C.u_opacity)}},fillExtrusionPattern:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_lightpos:new I.Uniform3f(x,C.u_lightpos),u_lightintensity:new I.Uniform1f(x,C.u_lightintensity),u_lightcolor:new I.Uniform3f(x,C.u_lightcolor),u_vertical_gradient:new I.Uniform1f(x,C.u_vertical_gradient),u_height_factor:new I.Uniform1f(x,C.u_height_factor),u_image:new I.Uniform1i(x,C.u_image),u_texsize:new I.Uniform2f(x,C.u_texsize),u_pixel_coord_upper:new I.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new I.Uniform2f(x,C.u_pixel_coord_lower),u_scale:new I.Uniform3f(x,C.u_scale),u_fade:new I.Uniform1f(x,C.u_fade),u_opacity:new I.Uniform1f(x,C.u_opacity)}},fill:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix)}},fillPattern:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_image:new I.Uniform1i(x,C.u_image),u_texsize:new I.Uniform2f(x,C.u_texsize),u_pixel_coord_upper:new I.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new I.Uniform2f(x,C.u_pixel_coord_lower),u_scale:new I.Uniform3f(x,C.u_scale),u_fade:new I.Uniform1f(x,C.u_fade)}},fillOutline:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_world:new I.Uniform2f(x,C.u_world)}},fillOutlinePattern:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_world:new I.Uniform2f(x,C.u_world),u_image:new I.Uniform1i(x,C.u_image),u_texsize:new I.Uniform2f(x,C.u_texsize),u_pixel_coord_upper:new I.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new I.Uniform2f(x,C.u_pixel_coord_lower),u_scale:new I.Uniform3f(x,C.u_scale),u_fade:new I.Uniform1f(x,C.u_fade)}},circle:function(x,C){return{u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_scale_with_map:new I.Uniform1i(x,C.u_scale_with_map),u_pitch_with_map:new I.Uniform1i(x,C.u_pitch_with_map),u_extrude_scale:new I.Uniform2f(x,C.u_extrude_scale),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_matrix:new I.UniformMatrix4f(x,C.u_matrix)}},collisionBox:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_pixels_to_tile_units:new I.Uniform1f(x,C.u_pixels_to_tile_units),u_extrude_scale:new I.Uniform2f(x,C.u_extrude_scale),u_overscale_factor:new I.Uniform1f(x,C.u_overscale_factor)}},collisionCircle:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_inv_matrix:new I.UniformMatrix4f(x,C.u_inv_matrix),u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_viewport_size:new I.Uniform2f(x,C.u_viewport_size)}},debug:function(x,C){return{u_color:new I.UniformColor(x,C.u_color),u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_overlay:new I.Uniform1i(x,C.u_overlay),u_overlay_scale:new I.Uniform1f(x,C.u_overlay_scale)}},clippingMask:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix)}},heatmap:function(x,C){return{u_extrude_scale:new I.Uniform1f(x,C.u_extrude_scale),u_intensity:new I.Uniform1f(x,C.u_intensity),u_matrix:new I.UniformMatrix4f(x,C.u_matrix)}},heatmapTexture:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_world:new I.Uniform2f(x,C.u_world),u_image:new I.Uniform1i(x,C.u_image),u_color_ramp:new I.Uniform1i(x,C.u_color_ramp),u_opacity:new I.Uniform1f(x,C.u_opacity)}},hillshade:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_image:new I.Uniform1i(x,C.u_image),u_latrange:new I.Uniform2f(x,C.u_latrange),u_light:new I.Uniform2f(x,C.u_light),u_shadow:new I.UniformColor(x,C.u_shadow),u_highlight:new I.UniformColor(x,C.u_highlight),u_accent:new I.UniformColor(x,C.u_accent)}},hillshadePrepare:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_image:new I.Uniform1i(x,C.u_image),u_dimension:new I.Uniform2f(x,C.u_dimension),u_zoom:new I.Uniform1f(x,C.u_zoom),u_unpack:new I.Uniform4f(x,C.u_unpack)}},line:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_ratio:new I.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_units_to_pixels:new I.Uniform2f(x,C.u_units_to_pixels)}},lineGradient:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_ratio:new I.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_units_to_pixels:new I.Uniform2f(x,C.u_units_to_pixels),u_image:new I.Uniform1i(x,C.u_image),u_image_height:new I.Uniform1f(x,C.u_image_height)}},linePattern:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_texsize:new I.Uniform2f(x,C.u_texsize),u_ratio:new I.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_image:new I.Uniform1i(x,C.u_image),u_units_to_pixels:new I.Uniform2f(x,C.u_units_to_pixels),u_scale:new I.Uniform3f(x,C.u_scale),u_fade:new I.Uniform1f(x,C.u_fade)}},lineSDF:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_ratio:new I.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_units_to_pixels:new I.Uniform2f(x,C.u_units_to_pixels),u_patternscale_a:new I.Uniform2f(x,C.u_patternscale_a),u_patternscale_b:new I.Uniform2f(x,C.u_patternscale_b),u_sdfgamma:new I.Uniform1f(x,C.u_sdfgamma),u_image:new I.Uniform1i(x,C.u_image),u_tex_y_a:new I.Uniform1f(x,C.u_tex_y_a),u_tex_y_b:new I.Uniform1f(x,C.u_tex_y_b),u_mix:new I.Uniform1f(x,C.u_mix)}},raster:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_tl_parent:new I.Uniform2f(x,C.u_tl_parent),u_scale_parent:new I.Uniform1f(x,C.u_scale_parent),u_buffer_scale:new I.Uniform1f(x,C.u_buffer_scale),u_fade_t:new I.Uniform1f(x,C.u_fade_t),u_opacity:new I.Uniform1f(x,C.u_opacity),u_image0:new I.Uniform1i(x,C.u_image0),u_image1:new I.Uniform1i(x,C.u_image1),u_brightness_low:new I.Uniform1f(x,C.u_brightness_low),u_brightness_high:new I.Uniform1f(x,C.u_brightness_high),u_saturation_factor:new I.Uniform1f(x,C.u_saturation_factor),u_contrast_factor:new I.Uniform1f(x,C.u_contrast_factor),u_spin_weights:new I.Uniform3f(x,C.u_spin_weights)}},symbolIcon:function(x,C){return{u_is_size_zoom_constant:new I.Uniform1i(x,C.u_is_size_zoom_constant),u_is_size_feature_constant:new I.Uniform1i(x,C.u_is_size_feature_constant),u_size_t:new I.Uniform1f(x,C.u_size_t),u_size:new I.Uniform1f(x,C.u_size),u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_pitch:new I.Uniform1f(x,C.u_pitch),u_rotate_symbol:new I.Uniform1i(x,C.u_rotate_symbol),u_aspect_ratio:new I.Uniform1f(x,C.u_aspect_ratio),u_fade_change:new I.Uniform1f(x,C.u_fade_change),u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_label_plane_matrix:new I.UniformMatrix4f(x,C.u_label_plane_matrix),u_coord_matrix:new I.UniformMatrix4f(x,C.u_coord_matrix),u_is_text:new I.Uniform1i(x,C.u_is_text),u_pitch_with_map:new I.Uniform1i(x,C.u_pitch_with_map),u_texsize:new I.Uniform2f(x,C.u_texsize),u_texture:new I.Uniform1i(x,C.u_texture)}},symbolSDF:function(x,C){return{u_is_size_zoom_constant:new I.Uniform1i(x,C.u_is_size_zoom_constant),u_is_size_feature_constant:new I.Uniform1i(x,C.u_is_size_feature_constant),u_size_t:new I.Uniform1f(x,C.u_size_t),u_size:new I.Uniform1f(x,C.u_size),u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_pitch:new I.Uniform1f(x,C.u_pitch),u_rotate_symbol:new I.Uniform1i(x,C.u_rotate_symbol),u_aspect_ratio:new I.Uniform1f(x,C.u_aspect_ratio),u_fade_change:new I.Uniform1f(x,C.u_fade_change),u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_label_plane_matrix:new I.UniformMatrix4f(x,C.u_label_plane_matrix),u_coord_matrix:new I.UniformMatrix4f(x,C.u_coord_matrix),u_is_text:new I.Uniform1i(x,C.u_is_text),u_pitch_with_map:new I.Uniform1i(x,C.u_pitch_with_map),u_texsize:new I.Uniform2f(x,C.u_texsize),u_texture:new I.Uniform1i(x,C.u_texture),u_gamma_scale:new I.Uniform1f(x,C.u_gamma_scale),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_is_halo:new I.Uniform1i(x,C.u_is_halo)}},symbolTextAndIcon:function(x,C){return{u_is_size_zoom_constant:new I.Uniform1i(x,C.u_is_size_zoom_constant),u_is_size_feature_constant:new I.Uniform1i(x,C.u_is_size_feature_constant),u_size_t:new I.Uniform1f(x,C.u_size_t),u_size:new I.Uniform1f(x,C.u_size),u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_pitch:new I.Uniform1f(x,C.u_pitch),u_rotate_symbol:new I.Uniform1i(x,C.u_rotate_symbol),u_aspect_ratio:new I.Uniform1f(x,C.u_aspect_ratio),u_fade_change:new I.Uniform1f(x,C.u_fade_change),u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_label_plane_matrix:new I.UniformMatrix4f(x,C.u_label_plane_matrix),u_coord_matrix:new I.UniformMatrix4f(x,C.u_coord_matrix),u_is_text:new I.Uniform1i(x,C.u_is_text),u_pitch_with_map:new I.Uniform1i(x,C.u_pitch_with_map),u_texsize:new I.Uniform2f(x,C.u_texsize),u_texsize_icon:new I.Uniform2f(x,C.u_texsize_icon),u_texture:new I.Uniform1i(x,C.u_texture),u_texture_icon:new I.Uniform1i(x,C.u_texture_icon),u_gamma_scale:new I.Uniform1f(x,C.u_gamma_scale),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_is_halo:new I.Uniform1i(x,C.u_is_halo)}},background:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_opacity:new I.Uniform1f(x,C.u_opacity),u_color:new I.UniformColor(x,C.u_color)}},backgroundPattern:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_opacity:new I.Uniform1f(x,C.u_opacity),u_image:new I.Uniform1i(x,C.u_image),u_pattern_tl_a:new I.Uniform2f(x,C.u_pattern_tl_a),u_pattern_br_a:new I.Uniform2f(x,C.u_pattern_br_a),u_pattern_tl_b:new I.Uniform2f(x,C.u_pattern_tl_b),u_pattern_br_b:new I.Uniform2f(x,C.u_pattern_br_b),u_texsize:new I.Uniform2f(x,C.u_texsize),u_mix:new I.Uniform1f(x,C.u_mix),u_pattern_size_a:new I.Uniform2f(x,C.u_pattern_size_a),u_pattern_size_b:new I.Uniform2f(x,C.u_pattern_size_b),u_scale_a:new I.Uniform1f(x,C.u_scale_a),u_scale_b:new I.Uniform1f(x,C.u_scale_b),u_pixel_coord_upper:new I.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new I.Uniform2f(x,C.u_pixel_coord_lower),u_tile_units_to_pixels:new I.Uniform1f(x,C.u_tile_units_to_pixels)}}};function _f(x,C,S,M,z,H,$){for(var ft=x.context,zt=ft.gl,ee=x.useProgram("collisionBox"),Re=[],De=0,ke=0,cr=0;cr<M.length;cr++){var ar=M[cr],br=C.getTile(ar),rr=br.getBucket(S);if(rr){var xr=ar.posMatrix;z[0]===0&&z[1]===0||(xr=x.translatePosMatrix(ar.posMatrix,br,z,H));var Pr=$?rr.textCollisionBox:rr.iconCollisionBox,Rr=rr.collisionCircleArray;if(Rr.length>0){var vn=I.create(),ln=xr;I.mul(vn,rr.placementInvProjMatrix,x.transform.glCoordMatrix),I.mul(vn,vn,rr.placementViewportMatrix),Re.push({circleArray:Rr,circleOffset:ke,transform:ln,invTransform:vn}),ke=De+=Rr.length/4}Pr&&ee.draw(ft,zt.LINES,Se.disabled,ze.disabled,x.colorModeForRenderPass(),wr.disabled,xn(xr,x.transform,br),S.id,Pr.layoutVertexBuffer,Pr.indexBuffer,Pr.segments,null,x.transform.zoom,null,null,Pr.collisionVertexBuffer)}}if($&&Re.length){var bn=x.useProgram("collisionCircle"),Zn=new I.StructArrayLayout2f1f2i16;Zn.resize(4*De),Zn._trim();for(var Kn=0,ci=0,Oi=Re;ci<Oi.length;ci+=1)for(var na=Oi[ci],ia=0;ia<na.circleArray.length/4;ia++){var ua=4*ia,Qa=na.circleArray[ua+0],Fi=na.circleArray[ua+1],Ra=na.circleArray[ua+2],Aa=na.circleArray[ua+3];Zn.emplace(Kn++,Qa,Fi,Ra,Aa,0),Zn.emplace(Kn++,Qa,Fi,Ra,Aa,1),Zn.emplace(Kn++,Qa,Fi,Ra,Aa,2),Zn.emplace(Kn++,Qa,Fi,Ra,Aa,3)}(!dh||dh.length<2*De)&&(dh=function(ss){var ou=2*ss,Ks=new I.StructArrayLayout3ui6;Ks.resize(ou),Ks._trim();for(var ls=0;ls<ou;ls++){var cs=6*ls;Ks.uint16[cs+0]=4*ls+0,Ks.uint16[cs+1]=4*ls+1,Ks.uint16[cs+2]=4*ls+2,Ks.uint16[cs+3]=4*ls+2,Ks.uint16[cs+4]=4*ls+3,Ks.uint16[cs+5]=4*ls+0}return Ks}(De));for(var ka=ft.createIndexBuffer(dh,!0),la=ft.createVertexBuffer(Zn,I.collisionCircleLayout.members,!0),Na=0,pa=Re;Na<pa.length;Na+=1){var da=pa[Na],Ds=_i(da.transform,da.invTransform,x.transform);bn.draw(ft,zt.TRIANGLES,Se.disabled,ze.disabled,x.colorModeForRenderPass(),wr.disabled,Ds,S.id,la,ka,I.SegmentVector.simpleSegment(0,2*da.circleOffset,da.circleArray.length,da.circleArray.length/2),null,x.transform.zoom,null,null,null)}la.destroy(),ka.destroy()}}var vl=I.identity(new Float32Array(16));function Eu(x,C,S,M,z,H){var $=I.getAnchorAlignment(x),ft=-($.horizontalAlign-.5)*C,zt=-($.verticalAlign-.5)*S,ee=I.evaluateVariableOffset(x,M);return new I.Point((ft/z+ee[0])*H,(zt/z+ee[1])*H)}function Yh(x,C,S,M,z,H,$,ft,zt,ee,Re){var De=x.text.placedSymbolArray,ke=x.text.dynamicLayoutVertexArray,cr=x.icon.dynamicLayoutVertexArray,ar={};ke.clear();for(var br=0;br<De.length;br++){var rr=De.get(br),xr=rr.hidden||!rr.crossTileID||x.allowVerticalPlacement&&!rr.placedOrientation?null:M[rr.crossTileID];if(xr){var Pr=new I.Point(rr.anchorX,rr.anchorY),Rr=ja(Pr,S?ft:$),vn=to(H.cameraToCenterDistance,Rr.signedDistanceFromCamera),ln=z.evaluateSizeForFeature(x.textSizeData,ee,rr)*vn/I.ONE_EM;S&&(ln*=x.tilePixelRatio/zt);for(var bn=Eu(xr.anchor,xr.width,xr.height,xr.textOffset,xr.textBoxScale,ln),Zn=S?ja(Pr.add(bn),$).point:Rr.point.add(C?bn.rotate(-H.angle):bn),Kn=x.allowVerticalPlacement&&rr.placedOrientation===I.WritingMode.vertical?Math.PI/2:0,ci=0;ci<rr.numGlyphs;ci++)I.addDynamicAttributes(ke,Zn,Kn);Re&&rr.associatedIconIndex>=0&&(ar[rr.associatedIconIndex]={shiftedAnchor:Zn,angle:Kn})}else tn(rr.numGlyphs,ke)}if(Re){cr.clear();for(var Oi=x.icon.placedSymbolArray,na=0;na<Oi.length;na++){var ia=Oi.get(na);if(ia.hidden)tn(ia.numGlyphs,cr);else{var ua=ar[na];if(ua)for(var Qa=0;Qa<ia.numGlyphs;Qa++)I.addDynamicAttributes(cr,ua.shiftedAnchor,ua.angle);else tn(ia.numGlyphs,cr)}}x.icon.dynamicLayoutVertexBuffer.updateData(cr)}x.text.dynamicLayoutVertexBuffer.updateData(ke)}function Pp(x,C,S){return S.iconsInText&&C?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function wc(x,C,S,M,z,H,$,ft,zt,ee,Re,De){for(var ke=x.context,cr=ke.gl,ar=x.transform,br=ft==="map",rr=zt==="map",xr=br&&S.layout.get("symbol-placement")!=="point",Pr=br&&!rr&&!xr,Rr=S.layout.get("symbol-sort-key").constantOr(1)!==void 0,vn=!1,ln=x.depthModeForSublayer(0,Se.ReadOnly),bn=S.layout.get("text-variable-anchor"),Zn=[],Kn=0,ci=M;Kn<ci.length;Kn+=1){var Oi=ci[Kn],na=C.getTile(Oi),ia=na.getBucket(S);if(ia){var ua=z?ia.text:ia.icon;if(ua&&ua.segments.get().length){var Qa=ua.programConfigurations.get(S.id),Fi=z||ia.sdfIcons,Ra=z?ia.textSizeData:ia.iconSizeData,Aa=rr||ar.pitch!==0,ka=x.useProgram(Pp(Fi,z,ia),Qa),la=I.evaluateSizeForZoom(Ra,ar.zoom),Na=void 0,pa=[0,0],da=void 0,Ds=void 0,ss=null,ou=void 0;if(z)da=na.glyphAtlasTexture,Ds=cr.LINEAR,Na=na.glyphAtlasTexture.size,ia.iconsInText&&(pa=na.imageAtlasTexture.size,ss=na.imageAtlasTexture,ou=Aa||x.options.rotating||x.options.zooming||Ra.kind==="composite"||Ra.kind==="camera"?cr.LINEAR:cr.NEAREST);else{var Ks=S.layout.get("icon-size").constantOr(0)!==1||ia.iconsNeedLinear;da=na.imageAtlasTexture,Ds=Fi||x.options.rotating||x.options.zooming||Ks||Aa?cr.LINEAR:cr.NEAREST,Na=na.imageAtlasTexture.size}var ls=Cn(na,1,x.transform.zoom),cs=Vo(Oi.posMatrix,rr,br,x.transform,ls),vu=vo(Oi.posMatrix,rr,br,x.transform,ls),Du=bn&&ia.hasTextData(),kc=S.layout.get("icon-text-fit")!=="none"&&Du&&ia.hasIconData();xr&&ju(ia,Oi.posMatrix,x,z,cs,vu,rr,ee);var qu=x.translatePosMatrix(Oi.posMatrix,na,H,$),Kl=xr||z&&bn||kc?vl:cs,cl=x.translatePosMatrix(vu,na,H,$,!0),yh=Fi&&S.paint.get(z?"text-halo-width":"icon-halo-width").constantOr(1)!==0,El={program:ka,buffers:ua,uniformValues:Fi?ia.iconsInText?vh(Ra.kind,la,Pr,rr,x,qu,Kl,cl,Na,pa):Gc(Ra.kind,la,Pr,rr,x,qu,Kl,cl,z,Na,!0):zf(Ra.kind,la,Pr,rr,x,qu,Kl,cl,z,Na),atlasTexture:da,atlasTextureIcon:ss,atlasInterpolation:Ds,atlasInterpolationIcon:ou,isSDF:Fi,hasHalo:yh};if(Rr&&ia.canOverlap){vn=!0;for(var Ql=0,_h=ua.segments.get();Ql<_h.length;Ql+=1){var Yf=_h[Ql];Zn.push({segments:new I.SegmentVector([Yf]),sortKey:Yf.sortKey,state:El})}}else Zn.push({segments:ua.segments,sortKey:0,state:El})}}}vn&&Zn.sort(function(Tf,vc){return Tf.sortKey-vc.sortKey});for(var dc=0,xh=Zn;dc<xh.length;dc+=1){var Jl=xh[dc],js=Jl.state;if(ke.activeTexture.set(cr.TEXTURE0),js.atlasTexture.bind(js.atlasInterpolation,cr.CLAMP_TO_EDGE),js.atlasTextureIcon&&(ke.activeTexture.set(cr.TEXTURE1),js.atlasTextureIcon&&js.atlasTextureIcon.bind(js.atlasInterpolationIcon,cr.CLAMP_TO_EDGE)),js.isSDF){var $c=js.uniformValues;js.hasHalo&&($c.u_is_halo=1,gl(js.buffers,Jl.segments,S,x,js.program,ln,Re,De,$c)),$c.u_is_halo=0}gl(js.buffers,Jl.segments,S,x,js.program,ln,Re,De,js.uniformValues)}}function gl(x,C,S,M,z,H,$,ft,zt){var ee=M.context;z.draw(ee,ee.gl.TRIANGLES,H,$,ft,wr.disabled,zt,S.id,x.layoutVertexBuffer,x.indexBuffer,C,S.paint,M.transform.zoom,x.programConfigurations.get(S.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function $h(x,C,S,M,z,H,$){var ft,zt,ee,Re,De,ke=x.context.gl,cr=S.paint.get("fill-pattern"),ar=cr&&cr.constantOr(1),br=S.getCrossfadeParameters();$?(zt=ar&&!S.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ft=ke.LINES):(zt=ar?"fillPattern":"fill",ft=ke.TRIANGLES);for(var rr=0,xr=M;rr<xr.length;rr+=1){var Pr=xr[rr],Rr=C.getTile(Pr);if(!ar||Rr.patternsLoaded()){var vn=Rr.getBucket(S);if(vn){var ln=vn.programConfigurations.get(S.id),bn=x.useProgram(zt,ln);ar&&(x.context.activeTexture.set(ke.TEXTURE0),Rr.imageAtlasTexture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),ln.updatePaintBuffers(br));var Zn=cr.constantOr(null);if(Zn&&Rr.imageAtlas){var Kn=Rr.imageAtlas,ci=Kn.patternPositions[Zn.to.toString()],Oi=Kn.patternPositions[Zn.from.toString()];ci&&Oi&&ln.setConstantPatternPositions(ci,Oi)}var na=x.translatePosMatrix(Pr.posMatrix,Rr,S.paint.get("fill-translate"),S.paint.get("fill-translate-anchor"));if($){Re=vn.indexBuffer2,De=vn.segments2;var ia=[ke.drawingBufferWidth,ke.drawingBufferHeight];ee=zt==="fillOutlinePattern"&&ar?Or(na,x,br,Rr,ia):ir(na,ia)}else Re=vn.indexBuffer,De=vn.segments,ee=ar?me(na,x,br,Rr):Yl(na);bn.draw(x.context,ft,z,x.stencilModeForClipping(Pr),H,wr.disabled,ee,S.id,vn.layoutVertexBuffer,Re,De,S.paint,x.transform.zoom,ln)}}}}function qh(x,C,S,M,z,H,$){for(var ft=x.context,zt=ft.gl,ee=S.paint.get("fill-extrusion-pattern"),Re=ee.constantOr(1),De=S.getCrossfadeParameters(),ke=S.paint.get("fill-extrusion-opacity"),cr=0,ar=M;cr<ar.length;cr+=1){var br=ar[cr],rr=C.getTile(br),xr=rr.getBucket(S);if(xr){var Pr=xr.programConfigurations.get(S.id),Rr=x.useProgram(Re?"fillExtrusionPattern":"fillExtrusion",Pr);Re&&(x.context.activeTexture.set(zt.TEXTURE0),rr.imageAtlasTexture.bind(zt.LINEAR,zt.CLAMP_TO_EDGE),Pr.updatePaintBuffers(De));var vn=ee.constantOr(null);if(vn&&rr.imageAtlas){var ln=rr.imageAtlas,bn=ln.patternPositions[vn.to.toString()],Zn=ln.patternPositions[vn.from.toString()];bn&&Zn&&Pr.setConstantPatternPositions(bn,Zn)}var Kn=x.translatePosMatrix(br.posMatrix,rr,S.paint.get("fill-extrusion-translate"),S.paint.get("fill-extrusion-translate-anchor")),ci=S.paint.get("fill-extrusion-vertical-gradient"),Oi=Re?$s(Kn,x,ci,ke,br,De,rr):Vc(Kn,x,ci,ke);Rr.draw(ft,ft.gl.TRIANGLES,z,H,$,wr.backCCW,Oi,S.id,xr.layoutVertexBuffer,xr.indexBuffer,xr.segments,S.paint,x.transform.zoom,Pr)}}}function Op(x,C,S,M,z,H){var $=x.context,ft=$.gl,zt=C.fbo;if(zt){var ee=x.useProgram("hillshade");$.activeTexture.set(ft.TEXTURE0),ft.bindTexture(ft.TEXTURE_2D,zt.colorAttachment.get());var Re=function(De,ke,cr){var ar=cr.paint.get("hillshade-shadow-color"),br=cr.paint.get("hillshade-highlight-color"),rr=cr.paint.get("hillshade-accent-color"),xr=cr.paint.get("hillshade-illumination-direction")*(Math.PI/180);cr.paint.get("hillshade-illumination-anchor")==="viewport"&&(xr-=De.transform.angle);var Pr,Rr,vn,ln=!De.options.moving;return{u_matrix:De.transform.calculatePosMatrix(ke.tileID.toUnwrapped(),ln),u_image:0,u_latrange:(Pr=ke.tileID,Rr=Math.pow(2,Pr.canonical.z),vn=Pr.canonical.y,[new I.MercatorCoordinate(0,vn/Rr).toLngLat().lat,new I.MercatorCoordinate(0,(vn+1)/Rr).toLngLat().lat]),u_light:[cr.paint.get("hillshade-exaggeration"),xr],u_shadow:ar,u_highlight:br,u_accent:rr}}(x,C,S);ee.draw($,ft.TRIANGLES,M,z,H,wr.disabled,Re,S.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}}function Hc(x,C,S,M,z,H){var $=x.context,ft=$.gl,zt=C.dem;if(zt&&zt.data){var ee=zt.dim,Re=zt.stride,De=zt.getPixels();if($.activeTexture.set(ft.TEXTURE1),$.pixelStoreUnpackPremultiplyAlpha.set(!1),C.demTexture=C.demTexture||x.getTileTexture(Re),C.demTexture){var ke=C.demTexture;ke.update(De,{premultiply:!1}),ke.bind(ft.NEAREST,ft.CLAMP_TO_EDGE)}else C.demTexture=new I.Texture($,De,ft.RGBA,{premultiply:!1}),C.demTexture.bind(ft.NEAREST,ft.CLAMP_TO_EDGE);$.activeTexture.set(ft.TEXTURE0);var cr=C.fbo;if(!cr){var ar=new I.Texture($,{width:ee,height:ee,data:null},ft.RGBA);ar.bind(ft.LINEAR,ft.CLAMP_TO_EDGE),(cr=C.fbo=$.createFramebuffer(ee,ee,!0)).colorAttachment.set(ar.texture)}$.bindFramebuffer.set(cr.framebuffer),$.viewport.set([0,0,ee,ee]),x.useProgram("hillshadePrepare").draw($,ft.TRIANGLES,M,z,H,wr.disabled,function(br,rr){var xr=rr.stride,Pr=I.create();return I.ortho(Pr,0,I.EXTENT,-I.EXTENT,0,0,1),I.translate(Pr,Pr,[0,-I.EXTENT,0]),{u_matrix:Pr,u_image:1,u_dimension:[xr,xr],u_zoom:br.overscaledZ,u_unpack:rr.getUnpackVector()}}(C.tileID,zt),S.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments),C.needsHillshadePrepare=!1}}function Kh(x,C,S,M,z){var H=M.paint.get("raster-fade-duration");if(H>0){var $=I.browser.now(),ft=($-x.timeAdded)/H,zt=C?($-C.timeAdded)/H:-1,ee=S.getSource(),Re=z.coveringZoomLevel({tileSize:ee.tileSize,roundZoom:ee.roundZoom}),De=!C||Math.abs(C.tileID.overscaledZ-Re)>Math.abs(x.tileID.overscaledZ-Re),ke=De&&x.refreshedUponExpiration?1:I.clamp(De?ft:1-zt,0,1);return x.refreshedUponExpiration&&ft>=1&&(x.refreshedUponExpiration=!1),C?{opacity:1,mix:1-ke}:{opacity:ke,mix:0}}return{opacity:1,mix:0}}var $l=new I.Color(1,0,0,1),Qh=new I.Color(0,1,0,1),Zf=new I.Color(0,0,1,1),Tl=new I.Color(1,0,1,1),gd=new I.Color(0,1,1,1);function md(x,C,S,M){gh(x,0,C+S/2,x.transform.width,S,M)}function yd(x,C,S,M){gh(x,C-S/2,0,S,x.transform.height,M)}function gh(x,C,S,M,z,H){var $=x.context,ft=$.gl;ft.enable(ft.SCISSOR_TEST),ft.scissor(C*I.browser.devicePixelRatio,S*I.browser.devicePixelRatio,M*I.browser.devicePixelRatio,z*I.browser.devicePixelRatio),$.clear({color:H}),ft.disable(ft.SCISSOR_TEST)}function _d(x,C,S){var M=x.context,z=M.gl,H=S.posMatrix,$=x.useProgram("debug"),ft=Se.disabled,zt=ze.disabled,ee=x.colorModeForRenderPass();M.activeTexture.set(z.TEXTURE0),x.emptyTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),$.draw(M,z.LINE_STRIP,ft,zt,ee,wr.disabled,qi(H,I.Color.red),"$debug",x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments);var Re=C.getTileByID(S.key).latestRawTileData,De=Math.floor((Re&&Re.byteLength||0)/1024),ke=C.getTile(S).tileSize,cr=512/Math.min(ke,512)*(S.overscaledZ/x.transform.zoom)*.5,ar=S.canonical.toString();S.overscaledZ!==S.canonical.z&&(ar+=" => "+S.overscaledZ),function(br,rr){br.initDebugOverlayCanvas();var xr=br.debugOverlayCanvas,Pr=br.context.gl,Rr=br.debugOverlayCanvas.getContext("2d");Rr.clearRect(0,0,xr.width,xr.height),Rr.shadowColor="white",Rr.shadowBlur=2,Rr.lineWidth=1.5,Rr.strokeStyle="white",Rr.textBaseline="top",Rr.font="bold 36px Open Sans, sans-serif",Rr.fillText(rr,5,5),Rr.strokeText(rr,5,5),br.debugOverlayTexture.update(xr),br.debugOverlayTexture.bind(Pr.LINEAR,Pr.CLAMP_TO_EDGE)}(x,ar+" "+De+"kb"),$.draw(M,z.TRIANGLES,ft,zt,fr.alphaBlended,wr.disabled,qi(H,I.Color.transparent,cr),"$debug",x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments)}var xf={symbol:function(x,C,S,M,z){if(x.renderPass==="translucent"){var H=ze.disabled,$=x.colorModeForRenderPass();S.layout.get("text-variable-anchor")&&function(ft,zt,ee,Re,De,ke,cr){for(var ar=zt.transform,br=De==="map",rr=ke==="map",xr=0,Pr=ft;xr<Pr.length;xr+=1){var Rr=Pr[xr],vn=Re.getTile(Rr),ln=vn.getBucket(ee);if(ln&&ln.text&&ln.text.segments.get().length){var bn=I.evaluateSizeForZoom(ln.textSizeData,ar.zoom),Zn=Cn(vn,1,zt.transform.zoom),Kn=Vo(Rr.posMatrix,rr,br,zt.transform,Zn),ci=ee.layout.get("icon-text-fit")!=="none"&&ln.hasIconData();if(bn){var Oi=Math.pow(2,ar.zoom-vn.tileID.overscaledZ);Yh(ln,br,rr,cr,I.symbolSize,ar,Kn,Rr.posMatrix,Oi,bn,ci)}}}}(M,x,S,C,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),z),S.paint.get("icon-opacity").constantOr(1)!==0&&wc(x,C,S,M,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),H,$),S.paint.get("text-opacity").constantOr(1)!==0&&wc(x,C,S,M,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),H,$),C.map.showCollisionBoxes&&(_f(x,C,S,M,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),!0),_f(x,C,S,M,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),!1))}},circle:function(x,C,S,M){if(x.renderPass==="translucent"){var z=S.paint.get("circle-opacity"),H=S.paint.get("circle-stroke-width"),$=S.paint.get("circle-stroke-opacity"),ft=S.layout.get("circle-sort-key").constantOr(1)!==void 0;if(z.constantOr(1)!==0||H.constantOr(1)!==0&&$.constantOr(1)!==0){for(var zt=x.context,ee=zt.gl,Re=x.depthModeForSublayer(0,Se.ReadOnly),De=ze.disabled,ke=x.colorModeForRenderPass(),cr=[],ar=0;ar<M.length;ar++){var br=M[ar],rr=C.getTile(br),xr=rr.getBucket(S);if(xr){var Pr=xr.programConfigurations.get(S.id),Rr={programConfiguration:Pr,program:x.useProgram("circle",Pr),layoutVertexBuffer:xr.layoutVertexBuffer,indexBuffer:xr.indexBuffer,uniformValues:$r(x,br,rr,S)};if(ft)for(var vn=0,ln=xr.segments.get();vn<ln.length;vn+=1){var bn=ln[vn];cr.push({segments:new I.SegmentVector([bn]),sortKey:bn.sortKey,state:Rr})}else cr.push({segments:xr.segments,sortKey:0,state:Rr})}}ft&&cr.sort(function(na,ia){return na.sortKey-ia.sortKey});for(var Zn=0,Kn=cr;Zn<Kn.length;Zn+=1){var ci=Kn[Zn],Oi=ci.state;Oi.program.draw(zt,ee.TRIANGLES,Re,De,ke,wr.disabled,Oi.uniformValues,S.id,Oi.layoutVertexBuffer,Oi.indexBuffer,ci.segments,S.paint,x.transform.zoom,Oi.programConfiguration)}}}},heatmap:function(x,C,S,M){if(S.paint.get("heatmap-opacity")!==0)if(x.renderPass==="offscreen"){var z=x.context,H=z.gl,$=ze.disabled,ft=new fr([H.ONE,H.ONE],I.Color.transparent,[!0,!0,!0,!0]);(function(cr,ar,br){var rr=cr.gl;cr.activeTexture.set(rr.TEXTURE1),cr.viewport.set([0,0,ar.width/4,ar.height/4]);var xr=br.heatmapFbo;if(xr)rr.bindTexture(rr.TEXTURE_2D,xr.colorAttachment.get()),cr.bindFramebuffer.set(xr.framebuffer);else{var Pr=rr.createTexture();rr.bindTexture(rr.TEXTURE_2D,Pr),rr.texParameteri(rr.TEXTURE_2D,rr.TEXTURE_WRAP_S,rr.CLAMP_TO_EDGE),rr.texParameteri(rr.TEXTURE_2D,rr.TEXTURE_WRAP_T,rr.CLAMP_TO_EDGE),rr.texParameteri(rr.TEXTURE_2D,rr.TEXTURE_MIN_FILTER,rr.LINEAR),rr.texParameteri(rr.TEXTURE_2D,rr.TEXTURE_MAG_FILTER,rr.LINEAR),xr=br.heatmapFbo=cr.createFramebuffer(ar.width/4,ar.height/4,!1),function(Rr,vn,ln,bn){var Zn=Rr.gl;Zn.texImage2D(Zn.TEXTURE_2D,0,Zn.RGBA,vn.width/4,vn.height/4,0,Zn.RGBA,Rr.extRenderToTextureHalfFloat?Rr.extTextureHalfFloat.HALF_FLOAT_OES:Zn.UNSIGNED_BYTE,null),bn.colorAttachment.set(ln)}(cr,ar,Pr,xr)}})(z,x,S),z.clear({color:I.Color.transparent});for(var zt=0;zt<M.length;zt++){var ee=M[zt];if(!C.hasRenderableParent(ee)){var Re=C.getTile(ee),De=Re.getBucket(S);if(De){var ke=De.programConfigurations.get(S.id);x.useProgram("heatmap",ke).draw(z,H.TRIANGLES,Se.disabled,$,ft,wr.disabled,du(ee.posMatrix,Re,x.transform.zoom,S.paint.get("heatmap-intensity")),S.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,S.paint,x.transform.zoom,ke)}}}z.viewport.set([0,0,x.width,x.height])}else x.renderPass==="translucent"&&(x.context.setColorMode(x.colorModeForRenderPass()),function(cr,ar){var br=cr.context,rr=br.gl,xr=ar.heatmapFbo;if(xr){br.activeTexture.set(rr.TEXTURE0),rr.bindTexture(rr.TEXTURE_2D,xr.colorAttachment.get()),br.activeTexture.set(rr.TEXTURE1);var Pr=ar.colorRampTexture;Pr||(Pr=ar.colorRampTexture=new I.Texture(br,ar.colorRamp,rr.RGBA)),Pr.bind(rr.LINEAR,rr.CLAMP_TO_EDGE),cr.useProgram("heatmapTexture").draw(br,rr.TRIANGLES,Se.disabled,ze.disabled,cr.colorModeForRenderPass(),wr.disabled,function(Rr,vn,ln,bn){var Zn=I.create();I.ortho(Zn,0,Rr.width,Rr.height,0,0,1);var Kn=Rr.context.gl;return{u_matrix:Zn,u_world:[Kn.drawingBufferWidth,Kn.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:vn.paint.get("heatmap-opacity")}}(cr,ar),ar.id,cr.viewportBuffer,cr.quadTriangleIndexBuffer,cr.viewportSegments,ar.paint,cr.transform.zoom)}}(x,S))},line:function(x,C,S,M){if(x.renderPass==="translucent"){var z=S.paint.get("line-opacity"),H=S.paint.get("line-width");if(z.constantOr(1)!==0&&H.constantOr(1)!==0)for(var $=x.depthModeForSublayer(0,Se.ReadOnly),ft=x.colorModeForRenderPass(),zt=S.paint.get("line-dasharray"),ee=S.paint.get("line-pattern"),Re=ee.constantOr(1),De=S.paint.get("line-gradient"),ke=S.getCrossfadeParameters(),cr=Re?"linePattern":zt?"lineSDF":De?"lineGradient":"line",ar=x.context,br=ar.gl,rr=!0,xr=0,Pr=M;xr<Pr.length;xr+=1){var Rr=Pr[xr],vn=C.getTile(Rr);if(!Re||vn.patternsLoaded()){var ln=vn.getBucket(S);if(ln){var bn=ln.programConfigurations.get(S.id),Zn=x.context.program.get(),Kn=x.useProgram(cr,bn),ci=rr||Kn.program!==Zn,Oi=ee.constantOr(null);if(Oi&&vn.imageAtlas){var na=vn.imageAtlas,ia=na.patternPositions[Oi.to.toString()],ua=na.patternPositions[Oi.from.toString()];ia&&ua&&bn.setConstantPatternPositions(ia,ua)}var Qa=Re?Dl(x,vn,S,ke):zt?av(x,vn,S,zt,ke):De?$a(x,vn,S,ln.lineClipsArray.length):qs(x,vn,S);if(Re)ar.activeTexture.set(br.TEXTURE0),vn.imageAtlasTexture.bind(br.LINEAR,br.CLAMP_TO_EDGE),bn.updatePaintBuffers(ke);else if(zt&&(ci||x.lineAtlas.dirty))ar.activeTexture.set(br.TEXTURE0),x.lineAtlas.bind(ar);else if(De){var Fi=ln.gradients[S.id],Ra=Fi.texture;if(S.gradientVersion!==Fi.version){var Aa=256;if(S.stepInterpolant){var ka=C.getSource().maxzoom,la=Rr.canonical.z===ka?Math.ceil(1<<x.transform.maxZoom-Rr.canonical.z):1;Aa=I.clamp(I.nextPowerOfTwo(ln.maxLineLength/I.EXTENT*1024*la),256,ar.maxTextureSize)}Fi.gradient=I.renderColorRamp({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:Aa,image:Fi.gradient||void 0,clips:ln.lineClipsArray}),Fi.texture?Fi.texture.update(Fi.gradient):Fi.texture=new I.Texture(ar,Fi.gradient,br.RGBA),Fi.version=S.gradientVersion,Ra=Fi.texture}ar.activeTexture.set(br.TEXTURE0),Ra.bind(S.stepInterpolant?br.NEAREST:br.LINEAR,br.CLAMP_TO_EDGE)}Kn.draw(ar,br.TRIANGLES,$,x.stencilModeForClipping(Rr),ft,wr.disabled,Qa,S.id,ln.layoutVertexBuffer,ln.indexBuffer,ln.segments,S.paint,x.transform.zoom,bn,ln.layoutVertexBuffer2),rr=!1}}}}},fill:function(x,C,S,M){var z=S.paint.get("fill-color"),H=S.paint.get("fill-opacity");if(H.constantOr(1)!==0){var $=x.colorModeForRenderPass(),ft=S.paint.get("fill-pattern"),zt=x.opaquePassEnabledForLayer()&&!ft.constantOr(1)&&z.constantOr(I.Color.transparent).a===1&&H.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===zt){var ee=x.depthModeForSublayer(1,x.renderPass==="opaque"?Se.ReadWrite:Se.ReadOnly);$h(x,C,S,M,ee,$,!1)}if(x.renderPass==="translucent"&&S.paint.get("fill-antialias")){var Re=x.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,Se.ReadOnly);$h(x,C,S,M,Re,$,!0)}}},"fill-extrusion":function(x,C,S,M){var z=S.paint.get("fill-extrusion-opacity");if(z!==0&&x.renderPass==="translucent"){var H=new Se(x.context.gl.LEQUAL,Se.ReadWrite,x.depthRangeFor3D);if(z!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))qh(x,C,S,M,H,ze.disabled,fr.disabled),qh(x,C,S,M,H,x.stencilModeFor3D(),x.colorModeForRenderPass());else{var $=x.colorModeForRenderPass();qh(x,C,S,M,H,ze.disabled,$)}}},hillshade:function(x,C,S,M){if(x.renderPass==="offscreen"||x.renderPass==="translucent"){for(var z=x.context,H=x.depthModeForSublayer(0,Se.ReadOnly),$=x.colorModeForRenderPass(),ft=x.renderPass==="translucent"?x.stencilConfigForOverlap(M):[{},M],zt=ft[0],ee=0,Re=ft[1];ee<Re.length;ee+=1){var De=Re[ee],ke=C.getTile(De);ke.needsHillshadePrepare&&x.renderPass==="offscreen"?Hc(x,ke,S,H,ze.disabled,$):x.renderPass==="translucent"&&Op(x,ke,S,H,zt[De.overscaledZ],$)}z.viewport.set([0,0,x.width,x.height])}},raster:function(x,C,S,M){if(x.renderPass==="translucent"&&S.paint.get("raster-opacity")!==0&&M.length)for(var z=x.context,H=z.gl,$=C.getSource(),ft=x.useProgram("raster"),zt=x.colorModeForRenderPass(),ee=$ instanceof Xt?[{},M]:x.stencilConfigForOverlap(M),Re=ee[0],De=ee[1],ke=De[De.length-1].overscaledZ,cr=!x.options.moving,ar=0,br=De;ar<br.length;ar+=1){var rr=br[ar],xr=x.depthModeForSublayer(rr.overscaledZ-ke,S.paint.get("raster-opacity")===1?Se.ReadWrite:Se.ReadOnly,H.LESS),Pr=C.getTile(rr),Rr=x.transform.calculatePosMatrix(rr.toUnwrapped(),cr);Pr.registerFadeDuration(S.paint.get("raster-fade-duration"));var vn=C.findLoadedParent(rr,0),ln=Kh(Pr,vn,C,S,x.transform),bn=void 0,Zn=void 0,Kn=S.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;z.activeTexture.set(H.TEXTURE0),Pr.texture.bind(Kn,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),z.activeTexture.set(H.TEXTURE1),vn?(vn.texture.bind(Kn,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),bn=Math.pow(2,vn.tileID.overscaledZ-Pr.tileID.overscaledZ),Zn=[Pr.tileID.canonical.x*bn%1,Pr.tileID.canonical.y*bn%1]):Pr.texture.bind(Kn,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);var ci=ov(Rr,Zn||[0,0],bn||1,ln,S);$ instanceof Xt?ft.draw(z,H.TRIANGLES,xr,ze.disabled,zt,wr.disabled,ci,S.id,$.boundsBuffer,x.quadTriangleIndexBuffer,$.boundsSegments):ft.draw(z,H.TRIANGLES,xr,Re[rr.overscaledZ],zt,wr.disabled,ci,S.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}},background:function(x,C,S){var M=S.paint.get("background-color"),z=S.paint.get("background-opacity");if(z!==0){var H=x.context,$=H.gl,ft=x.transform,zt=ft.tileSize,ee=S.paint.get("background-pattern");if(!x.isPatternMissing(ee)){var Re=!ee&&M.a===1&&z===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass===Re){var De=ze.disabled,ke=x.depthModeForSublayer(0,Re==="opaque"?Se.ReadWrite:Se.ReadOnly),cr=x.colorModeForRenderPass(),ar=x.useProgram(ee?"backgroundPattern":"background"),br=ft.coveringTiles({tileSize:zt});ee&&(H.activeTexture.set($.TEXTURE0),x.imageManager.bind(x.context));for(var rr=S.getCrossfadeParameters(),xr=0,Pr=br;xr<Pr.length;xr+=1){var Rr=Pr[xr],vn=x.transform.calculatePosMatrix(Rr.toUnwrapped()),ln=ee?lc(vn,z,x,ee,{tileID:Rr,tileSize:zt},rr):Uf(vn,z,M);ar.draw(H,$.TRIANGLES,ke,De,cr,wr.disabled,ln,S.id,x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}}}},debug:function(x,C,S){for(var M=0;M<S.length;M++)_d(x,C,S[M])},custom:function(x,C,S){var M=x.context,z=S.implementation;if(x.renderPass==="offscreen"){var H=z.prerender;H&&(x.setCustomLayerDefaults(),M.setColorMode(x.colorModeForRenderPass()),H.call(z,M.gl,x.transform.customLayerMatrix()),M.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),M.setColorMode(x.colorModeForRenderPass()),M.setStencilMode(ze.disabled);var $=z.renderingMode==="3d"?new Se(x.context.gl.LEQUAL,Se.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,Se.ReadOnly);M.setDepthMode($),z.render(M.gl,x.transform.customLayerMatrix()),M.setDirty(),x.setBaseState(),M.bindFramebuffer.set(null)}}},xs=function(x,C){this.context=new Le(x),this.transform=C,this._tileTextures={},this.setup(),this.numSublayers=ur.maxUnderzooming+ur.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new vs,this.gpuTimers={}};xs.prototype.resize=function(x,C){if(this.width=x*I.browser.devicePixelRatio,this.height=C*I.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var S=0,M=this.style._order;S<M.length;S+=1)this.style._layers[M[S]].resize()},xs.prototype.setup=function(){var x=this.context,C=new I.StructArrayLayout2i4;C.emplaceBack(0,0),C.emplaceBack(I.EXTENT,0),C.emplaceBack(0,I.EXTENT),C.emplaceBack(I.EXTENT,I.EXTENT),this.tileExtentBuffer=x.createVertexBuffer(C,Fo.members),this.tileExtentSegments=I.SegmentVector.simpleSegment(0,0,4,2);var S=new I.StructArrayLayout2i4;S.emplaceBack(0,0),S.emplaceBack(I.EXTENT,0),S.emplaceBack(0,I.EXTENT),S.emplaceBack(I.EXTENT,I.EXTENT),this.debugBuffer=x.createVertexBuffer(S,Fo.members),this.debugSegments=I.SegmentVector.simpleSegment(0,0,4,5);var M=new I.StructArrayLayout4i8;M.emplaceBack(0,0,0,0),M.emplaceBack(I.EXTENT,0,I.EXTENT,0),M.emplaceBack(0,I.EXTENT,0,I.EXTENT),M.emplaceBack(I.EXTENT,I.EXTENT,I.EXTENT,I.EXTENT),this.rasterBoundsBuffer=x.createVertexBuffer(M,yt.members),this.rasterBoundsSegments=I.SegmentVector.simpleSegment(0,0,4,2);var z=new I.StructArrayLayout2i4;z.emplaceBack(0,0),z.emplaceBack(1,0),z.emplaceBack(0,1),z.emplaceBack(1,1),this.viewportBuffer=x.createVertexBuffer(z,Fo.members),this.viewportSegments=I.SegmentVector.simpleSegment(0,0,4,2);var H=new I.StructArrayLayout1ui2;H.emplaceBack(0),H.emplaceBack(1),H.emplaceBack(3),H.emplaceBack(2),H.emplaceBack(0),this.tileBorderIndexBuffer=x.createIndexBuffer(H);var $=new I.StructArrayLayout3ui6;$.emplaceBack(0,1,2),$.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=x.createIndexBuffer($),this.emptyTexture=new I.Texture(x,{width:1,height:1,data:new Uint8Array([0,0,0,0])},x.gl.RGBA);var ft=this.context.gl;this.stencilClearMode=new ze({func:ft.ALWAYS,mask:0},0,255,ft.ZERO,ft.ZERO,ft.ZERO)},xs.prototype.clearStencil=function(){var x=this.context,C=x.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var S=I.create();I.ortho(S,0,this.width,this.height,0,0,1),I.scale(S,S,[C.drawingBufferWidth,C.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(x,C.TRIANGLES,Se.disabled,this.stencilClearMode,fr.disabled,wr.disabled,Ia(S),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},xs.prototype._renderTileClippingMasks=function(x,C){if(this.currentStencilSource!==x.source&&x.isTileClipped()&&C&&C.length){this.currentStencilSource=x.source;var S=this.context,M=S.gl;this.nextStencilID+C.length>256&&this.clearStencil(),S.setColorMode(fr.disabled),S.setDepthMode(Se.disabled);var z=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var H=0,$=C;H<$.length;H+=1){var ft=$[H],zt=this._tileClippingMaskIDs[ft.key]=this.nextStencilID++;z.draw(S,M.TRIANGLES,Se.disabled,new ze({func:M.ALWAYS,mask:0},zt,255,M.KEEP,M.KEEP,M.REPLACE),fr.disabled,wr.disabled,Ia(ft.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},xs.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var x=this.nextStencilID++,C=this.context.gl;return new ze({func:C.NOTEQUAL,mask:255},x,255,C.KEEP,C.KEEP,C.REPLACE)},xs.prototype.stencilModeForClipping=function(x){var C=this.context.gl;return new ze({func:C.EQUAL,mask:255},this._tileClippingMaskIDs[x.key],0,C.KEEP,C.KEEP,C.REPLACE)},xs.prototype.stencilConfigForOverlap=function(x){var C,S=this.context.gl,M=x.sort(function(zt,ee){return ee.overscaledZ-zt.overscaledZ}),z=M[M.length-1].overscaledZ,H=M[0].overscaledZ-z+1;if(H>1){this.currentStencilSource=void 0,this.nextStencilID+H>256&&this.clearStencil();for(var $={},ft=0;ft<H;ft++)$[ft+z]=new ze({func:S.GEQUAL,mask:255},ft+this.nextStencilID,255,S.KEEP,S.KEEP,S.REPLACE);return this.nextStencilID+=H,[$,M]}return[(C={},C[z]=ze.disabled,C),M]},xs.prototype.colorModeForRenderPass=function(){var x=this.context.gl;return this._showOverdrawInspector?new fr([x.CONSTANT_COLOR,x.ONE],new I.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fr.unblended:fr.alphaBlended},xs.prototype.depthModeForSublayer=function(x,C,S){if(!this.opaquePassEnabledForLayer())return Se.disabled;var M=1-((1+this.currentLayer)*this.numSublayers+x)*this.depthEpsilon;return new Se(S||this.context.gl.LEQUAL,C,[M,M])},xs.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},xs.prototype.render=function(x,C){var S=this;this.style=x,this.options=C,this.lineAtlas=x.lineAtlas,this.imageManager=x.imageManager,this.glyphManager=x.glyphManager,this.symbolFadeChange=x.placement.symbolFadeChange(I.browser.now()),this.imageManager.beginFrame();var M=this.style._order,z=this.style.sourceCaches;for(var H in z){var $=z[H];$.used&&$.prepare(this.context)}var ft,zt,ee={},Re={},De={};for(var ke in z){var cr=z[ke];ee[ke]=cr.getVisibleCoordinates(),Re[ke]=ee[ke].slice().reverse(),De[ke]=cr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var ar=0;ar<M.length;ar++)if(this.style._layers[M[ar]].is3D()){this.opaquePassCutoff=ar;break}this.renderPass="offscreen";for(var br=0,rr=M;br<rr.length;br+=1){var xr=this.style._layers[rr[br]];if(xr.hasOffscreenPass()&&!xr.isHidden(this.transform.zoom)){var Pr=Re[xr.source];(xr.type==="custom"||Pr.length)&&this.renderLayer(this,z[xr.source],xr,Pr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:C.showOverdrawInspector?I.Color.black:I.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=C.showOverdrawInspector,this.depthRangeFor3D=[0,1-(x._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=M.length-1;this.currentLayer>=0;this.currentLayer--){var Rr=this.style._layers[M[this.currentLayer]],vn=z[Rr.source],ln=ee[Rr.source];this._renderTileClippingMasks(Rr,ln),this.renderLayer(this,vn,Rr,ln)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<M.length;this.currentLayer++){var bn=this.style._layers[M[this.currentLayer]],Zn=z[bn.source],Kn=(bn.type==="symbol"?De:Re)[bn.source];this._renderTileClippingMasks(bn,ee[bn.source]),this.renderLayer(this,Zn,bn,Kn)}this.options.showTileBoundaries&&(I.values(this.style._layers).forEach(function(ci){ci.source&&!ci.isHidden(S.transform.zoom)&&(ci.source!==(zt&&zt.id)&&(zt=S.style.sourceCaches[ci.source]),(!ft||ft.getSource().maxzoom<zt.getSource().maxzoom)&&(ft=zt))}),ft&&xf.debug(this,ft,ft.getVisibleCoordinates())),this.options.showPadding&&function(ci){var Oi=ci.transform.padding;md(ci,ci.transform.height-(Oi.top||0),3,$l),md(ci,Oi.bottom||0,3,Qh),yd(ci,Oi.left||0,3,Zf),yd(ci,ci.transform.width-(Oi.right||0),3,Tl);var na=ci.transform.centerPoint;(function(ia,ua,Qa,Fi){gh(ia,ua-1,Qa-10,2,20,Fi),gh(ia,ua-10,Qa-1,20,2,Fi)})(ci,na.x,ci.transform.height-na.y,gd)}(this),this.context.setDefault()},xs.prototype.renderLayer=function(x,C,S,M){S.isHidden(this.transform.zoom)||(S.type==="background"||S.type==="custom"||M.length)&&(this.id=S.id,this.gpuTimingStart(S),xf[S.type](x,C,S,M,this.style.placement.variableOffsets),this.gpuTimingEnd())},xs.prototype.gpuTimingStart=function(x){if(this.options.gpuTiming){var C=this.context.extTimerQuery,S=this.gpuTimers[x.id];S||(S=this.gpuTimers[x.id]={calls:0,cpuTime:0,query:C.createQueryEXT()}),S.calls++,C.beginQueryEXT(C.TIME_ELAPSED_EXT,S.query)}},xs.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var x=this.context.extTimerQuery;x.endQueryEXT(x.TIME_ELAPSED_EXT)}},xs.prototype.collectGpuTimers=function(){var x=this.gpuTimers;return this.gpuTimers={},x},xs.prototype.queryGpuTimers=function(x){var C={};for(var S in x){var M=x[S],z=this.context.extTimerQuery,H=z.getQueryObjectEXT(M.query,z.QUERY_RESULT_EXT)/1e6;z.deleteQueryEXT(M.query),C[S]=H}return C},xs.prototype.translatePosMatrix=function(x,C,S,M,z){if(!S[0]&&!S[1])return x;var H=z?M==="map"?this.transform.angle:0:M==="viewport"?-this.transform.angle:0;if(H){var $=Math.sin(H),ft=Math.cos(H);S=[S[0]*ft-S[1]*$,S[0]*$+S[1]*ft]}var zt=[z?S[0]:Cn(C,S[0],this.transform.zoom),z?S[1]:Cn(C,S[1],this.transform.zoom),0],ee=new Float32Array(16);return I.translate(ee,x,zt),ee},xs.prototype.saveTileTexture=function(x){var C=this._tileTextures[x.size[0]];C?C.push(x):this._tileTextures[x.size[0]]=[x]},xs.prototype.getTileTexture=function(x){var C=this._tileTextures[x];return C&&C.length>0?C.pop():null},xs.prototype.isPatternMissing=function(x){if(!x)return!1;if(!x.from||!x.to)return!0;var C=this.imageManager.getPattern(x.from.toString()),S=this.imageManager.getPattern(x.to.toString());return!C||!S},xs.prototype.useProgram=function(x,C){this.cache=this.cache||{};var S=""+x+(C?C.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[S]||(this.cache[S]=new bu(this.context,x,gs[x],C,al[x],this._showOverdrawInspector)),this.cache[S]},xs.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},xs.prototype.setBaseState=function(){var x=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(x.FUNC_ADD)},xs.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=I.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new I.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},xs.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Jh=function(x,C){this.points=x,this.planes=C};Jh.fromInvProjectionMatrix=function(x,C,S){var M=Math.pow(2,S),z=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function($){return I.transformMat4([],$,x)}).map(function($){return I.scale$1([],$,1/$[3]/C*M)}),H=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function($){var ft=I.sub([],z[$[0]],z[$[1]]),zt=I.sub([],z[$[2]],z[$[1]]),ee=I.normalize([],I.cross([],ft,zt)),Re=-I.dot(ee,z[$[1]]);return ee.concat(Re)});return new Jh(z,H)};var Vf=function(x,C){this.min=x,this.max=C,this.center=I.scale$2([],I.add([],this.min,this.max),.5)};Vf.prototype.quadrant=function(x){for(var C=[x%2==0,x<2],S=I.clone$2(this.min),M=I.clone$2(this.max),z=0;z<C.length;z++)S[z]=C[z]?this.min[z]:this.center[z],M[z]=C[z]?this.center[z]:this.max[z];return M[2]=this.max[2],new Vf(S,M)},Vf.prototype.distanceX=function(x){return Math.max(Math.min(this.max[0],x[0]),this.min[0])-x[0]},Vf.prototype.distanceY=function(x){return Math.max(Math.min(this.max[1],x[1]),this.min[1])-x[1]},Vf.prototype.intersects=function(x){for(var C=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],S=!0,M=0;M<x.planes.length;M++){for(var z=x.planes[M],H=0,$=0;$<C.length;$++)H+=I.dot$1(z,C[$])>=0;if(H===0)return 0;H!==C.length&&(S=!1)}if(S)return 2;for(var ft=0;ft<3;ft++){for(var zt=Number.MAX_VALUE,ee=-Number.MAX_VALUE,Re=0;Re<x.points.length;Re++){var De=x.points[Re][ft]-this.min[ft];zt=Math.min(zt,De),ee=Math.max(ee,De)}if(ee<0||zt>this.max[ft]-this.min[ft])return 0}return 1};var Bl=function(x,C,S,M){if(x===void 0&&(x=0),C===void 0&&(C=0),S===void 0&&(S=0),M===void 0&&(M=0),isNaN(x)||x<0||isNaN(C)||C<0||isNaN(S)||S<0||isNaN(M)||M<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=x,this.bottom=C,this.left=S,this.right=M};Bl.prototype.interpolate=function(x,C,S){return C.top!=null&&x.top!=null&&(this.top=I.number(x.top,C.top,S)),C.bottom!=null&&x.bottom!=null&&(this.bottom=I.number(x.bottom,C.bottom,S)),C.left!=null&&x.left!=null&&(this.left=I.number(x.left,C.left,S)),C.right!=null&&x.right!=null&&(this.right=I.number(x.right,C.right,S)),this},Bl.prototype.getCenter=function(x,C){var S=I.clamp((this.left+x-this.right)/2,0,x),M=I.clamp((this.top+C-this.bottom)/2,0,C);return new I.Point(S,M)},Bl.prototype.equals=function(x){return this.top===x.top&&this.bottom===x.bottom&&this.left===x.left&&this.right===x.right},Bl.prototype.clone=function(){return new Bl(this.top,this.bottom,this.left,this.right)},Bl.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var go=function(x,C,S,M,z){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=z===void 0||z,this._minZoom=x||0,this._maxZoom=C||22,this._minPitch=S==null?0:S,this._maxPitch=M==null?60:M,this.setMaxBounds(),this.width=0,this.height=0,this._center=new I.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Bl,this._posMatrixCache={},this._alignedPosMatrixCache={}},is={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};go.prototype.clone=function(){var x=new go(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return x.tileSize=this.tileSize,x.latRange=this.latRange,x.width=this.width,x.height=this.height,x._center=this._center,x.zoom=this.zoom,x.angle=this.angle,x._fov=this._fov,x._pitch=this._pitch,x._unmodified=this._unmodified,x._edgeInsets=this._edgeInsets.clone(),x._calcMatrices(),x},is.minZoom.get=function(){return this._minZoom},is.minZoom.set=function(x){this._minZoom!==x&&(this._minZoom=x,this.zoom=Math.max(this.zoom,x))},is.maxZoom.get=function(){return this._maxZoom},is.maxZoom.set=function(x){this._maxZoom!==x&&(this._maxZoom=x,this.zoom=Math.min(this.zoom,x))},is.minPitch.get=function(){return this._minPitch},is.minPitch.set=function(x){this._minPitch!==x&&(this._minPitch=x,this.pitch=Math.max(this.pitch,x))},is.maxPitch.get=function(){return this._maxPitch},is.maxPitch.set=function(x){this._maxPitch!==x&&(this._maxPitch=x,this.pitch=Math.min(this.pitch,x))},is.renderWorldCopies.get=function(){return this._renderWorldCopies},is.renderWorldCopies.set=function(x){x===void 0?x=!0:x===null&&(x=!1),this._renderWorldCopies=x},is.worldSize.get=function(){return this.tileSize*this.scale},is.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},is.size.get=function(){return new I.Point(this.width,this.height)},is.bearing.get=function(){return-this.angle/Math.PI*180},is.bearing.set=function(x){var C=-I.wrap(x,-180,180)*Math.PI/180;this.angle!==C&&(this._unmodified=!1,this.angle=C,this._calcMatrices(),this.rotationMatrix=I.create$2(),I.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},is.pitch.get=function(){return this._pitch/Math.PI*180},is.pitch.set=function(x){var C=I.clamp(x,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==C&&(this._unmodified=!1,this._pitch=C,this._calcMatrices())},is.fov.get=function(){return this._fov/Math.PI*180},is.fov.set=function(x){x=Math.max(.01,Math.min(60,x)),this._fov!==x&&(this._unmodified=!1,this._fov=x/180*Math.PI,this._calcMatrices())},is.zoom.get=function(){return this._zoom},is.zoom.set=function(x){var C=Math.min(Math.max(x,this.minZoom),this.maxZoom);this._zoom!==C&&(this._unmodified=!1,this._zoom=C,this.scale=this.zoomScale(C),this.tileZoom=Math.floor(C),this.zoomFraction=C-this.tileZoom,this._constrain(),this._calcMatrices())},is.center.get=function(){return this._center},is.center.set=function(x){x.lat===this._center.lat&&x.lng===this._center.lng||(this._unmodified=!1,this._center=x,this._constrain(),this._calcMatrices())},is.padding.get=function(){return this._edgeInsets.toJSON()},is.padding.set=function(x){this._edgeInsets.equals(x)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,x,1),this._calcMatrices())},is.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},go.prototype.isPaddingEqual=function(x){return this._edgeInsets.equals(x)},go.prototype.interpolatePadding=function(x,C,S){this._unmodified=!1,this._edgeInsets.interpolate(x,C,S),this._constrain(),this._calcMatrices()},go.prototype.coveringZoomLevel=function(x){var C=(x.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/x.tileSize));return Math.max(0,C)},go.prototype.getVisibleUnwrappedCoordinates=function(x){var C=[new I.UnwrappedTileID(0,x)];if(this._renderWorldCopies)for(var S=this.pointCoordinate(new I.Point(0,0)),M=this.pointCoordinate(new I.Point(this.width,0)),z=this.pointCoordinate(new I.Point(this.width,this.height)),H=this.pointCoordinate(new I.Point(0,this.height)),$=Math.floor(Math.min(S.x,M.x,z.x,H.x)),ft=Math.floor(Math.max(S.x,M.x,z.x,H.x)),zt=$-1;zt<=ft+1;zt++)zt!==0&&C.push(new I.UnwrappedTileID(zt,x));return C},go.prototype.coveringTiles=function(x){var C=this.coveringZoomLevel(x),S=C;if(x.minzoom!==void 0&&C<x.minzoom)return[];x.maxzoom!==void 0&&C>x.maxzoom&&(C=x.maxzoom);var M=I.MercatorCoordinate.fromLngLat(this.center),z=Math.pow(2,C),H=[z*M.x,z*M.y,0],$=Jh.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,C),ft=x.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ft=C);var zt=function(ci){return{aabb:new Vf([ci*z,0,0],[(ci+1)*z,z,0]),zoom:0,x:0,y:0,wrap:ci,fullyVisible:!1}},ee=[],Re=[],De=C,ke=x.reparseOverscaled?S:C;if(this._renderWorldCopies)for(var cr=1;cr<=3;cr++)ee.push(zt(-cr)),ee.push(zt(cr));for(ee.push(zt(0));ee.length>0;){var ar=ee.pop(),br=ar.x,rr=ar.y,xr=ar.fullyVisible;if(!xr){var Pr=ar.aabb.intersects($);if(Pr===0)continue;xr=Pr===2}var Rr=ar.aabb.distanceX(H),vn=ar.aabb.distanceY(H),ln=Math.max(Math.abs(Rr),Math.abs(vn));if(ar.zoom===De||ln>3+(1<<De-ar.zoom)-2&&ar.zoom>=ft)Re.push({tileID:new I.OverscaledTileID(ar.zoom===De?ke:ar.zoom,ar.wrap,ar.zoom,br,rr),distanceSq:I.sqrLen([H[0]-.5-br,H[1]-.5-rr])});else for(var bn=0;bn<4;bn++){var Zn=(br<<1)+bn%2,Kn=(rr<<1)+(bn>>1);ee.push({aabb:ar.aabb.quadrant(bn),zoom:ar.zoom+1,x:Zn,y:Kn,wrap:ar.wrap,fullyVisible:xr})}}return Re.sort(function(ci,Oi){return ci.distanceSq-Oi.distanceSq}).map(function(ci){return ci.tileID})},go.prototype.resize=function(x,C){this.width=x,this.height=C,this.pixelsToGLUnits=[2/x,-2/C],this._constrain(),this._calcMatrices()},is.unmodified.get=function(){return this._unmodified},go.prototype.zoomScale=function(x){return Math.pow(2,x)},go.prototype.scaleZoom=function(x){return Math.log(x)/Math.LN2},go.prototype.project=function(x){var C=I.clamp(x.lat,-this.maxValidLatitude,this.maxValidLatitude);return new I.Point(I.mercatorXfromLng(x.lng)*this.worldSize,I.mercatorYfromLat(C)*this.worldSize)},go.prototype.unproject=function(x){return new I.MercatorCoordinate(x.x/this.worldSize,x.y/this.worldSize).toLngLat()},is.point.get=function(){return this.project(this.center)},go.prototype.setLocationAtPoint=function(x,C){var S=this.pointCoordinate(C),M=this.pointCoordinate(this.centerPoint),z=this.locationCoordinate(x),H=new I.MercatorCoordinate(z.x-(S.x-M.x),z.y-(S.y-M.y));this.center=this.coordinateLocation(H),this._renderWorldCopies&&(this.center=this.center.wrap())},go.prototype.locationPoint=function(x){return this.coordinatePoint(this.locationCoordinate(x))},go.prototype.pointLocation=function(x){return this.coordinateLocation(this.pointCoordinate(x))},go.prototype.locationCoordinate=function(x){return I.MercatorCoordinate.fromLngLat(x)},go.prototype.coordinateLocation=function(x){return x.toLngLat()},go.prototype.pointCoordinate=function(x){var C=[x.x,x.y,0,1],S=[x.x,x.y,1,1];I.transformMat4(C,C,this.pixelMatrixInverse),I.transformMat4(S,S,this.pixelMatrixInverse);var M=C[3],z=S[3],H=C[1]/M,$=S[1]/z,ft=C[2]/M,zt=S[2]/z,ee=ft===zt?0:(0-ft)/(zt-ft);return new I.MercatorCoordinate(I.number(C[0]/M,S[0]/z,ee)/this.worldSize,I.number(H,$,ee)/this.worldSize)},go.prototype.coordinatePoint=function(x){var C=[x.x*this.worldSize,x.y*this.worldSize,0,1];return I.transformMat4(C,C,this.pixelMatrix),new I.Point(C[0]/C[3],C[1]/C[3])},go.prototype.getBounds=function(){return new I.LngLatBounds().extend(this.pointLocation(new I.Point(0,0))).extend(this.pointLocation(new I.Point(this.width,0))).extend(this.pointLocation(new I.Point(this.width,this.height))).extend(this.pointLocation(new I.Point(0,this.height)))},go.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new I.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},go.prototype.setMaxBounds=function(x){x?(this.lngRange=[x.getWest(),x.getEast()],this.latRange=[x.getSouth(),x.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},go.prototype.calculatePosMatrix=function(x,C){C===void 0&&(C=!1);var S=x.key,M=C?this._alignedPosMatrixCache:this._posMatrixCache;if(M[S])return M[S];var z=x.canonical,H=this.worldSize/this.zoomScale(z.z),$=z.x+Math.pow(2,z.z)*x.wrap,ft=I.identity(new Float64Array(16));return I.translate(ft,ft,[$*H,z.y*H,0]),I.scale(ft,ft,[H/I.EXTENT,H/I.EXTENT,1]),I.multiply(ft,C?this.alignedProjMatrix:this.projMatrix,ft),M[S]=new Float32Array(ft),M[S]},go.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},go.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var x,C,S,M,z=-90,H=90,$=-180,ft=180,zt=this.size,ee=this._unmodified;if(this.latRange){var Re=this.latRange;z=I.mercatorYfromLat(Re[1])*this.worldSize,x=(H=I.mercatorYfromLat(Re[0])*this.worldSize)-z<zt.y?zt.y/(H-z):0}if(this.lngRange){var De=this.lngRange;$=I.mercatorXfromLng(De[0])*this.worldSize,C=(ft=I.mercatorXfromLng(De[1])*this.worldSize)-$<zt.x?zt.x/(ft-$):0}var ke=this.point,cr=Math.max(C||0,x||0);if(cr)return this.center=this.unproject(new I.Point(C?(ft+$)/2:ke.x,x?(H+z)/2:ke.y)),this.zoom+=this.scaleZoom(cr),this._unmodified=ee,void(this._constraining=!1);if(this.latRange){var ar=ke.y,br=zt.y/2;ar-br<z&&(M=z+br),ar+br>H&&(M=H-br)}if(this.lngRange){var rr=ke.x,xr=zt.x/2;rr-xr<$&&(S=$+xr),rr+xr>ft&&(S=ft-xr)}S===void 0&&M===void 0||(this.center=this.unproject(new I.Point(S!==void 0?S:ke.x,M!==void 0?M:ke.y))),this._unmodified=ee,this._constraining=!1}},go.prototype._calcMatrices=function(){if(this.height){var x=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var C=Math.PI/2+this._pitch,S=this._fov*(.5+x.y/this.height),M=Math.sin(S)*this.cameraToCenterDistance/Math.sin(I.clamp(Math.PI-C-S,.01,Math.PI-.01)),z=this.point,H=z.x,$=z.y,ft=1.01*(Math.cos(Math.PI/2-this._pitch)*M+this.cameraToCenterDistance),zt=this.height/50,ee=new Float64Array(16);I.perspective(ee,this._fov,this.width/this.height,zt,ft),ee[8]=2*-x.x/this.width,ee[9]=2*x.y/this.height,I.scale(ee,ee,[1,-1,1]),I.translate(ee,ee,[0,0,-this.cameraToCenterDistance]),I.rotateX(ee,ee,this._pitch),I.rotateZ(ee,ee,this.angle),I.translate(ee,ee,[-H,-$,0]),this.mercatorMatrix=I.scale([],ee,[this.worldSize,this.worldSize,this.worldSize]),I.scale(ee,ee,[1,1,I.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=ee,this.invProjMatrix=I.invert([],this.projMatrix);var Re=this.width%2/2,De=this.height%2/2,ke=Math.cos(this.angle),cr=Math.sin(this.angle),ar=H-Math.round(H)+ke*Re+cr*De,br=$-Math.round($)+ke*De+cr*Re,rr=new Float64Array(ee);if(I.translate(rr,rr,[ar>.5?ar-1:ar,br>.5?br-1:br,0]),this.alignedProjMatrix=rr,ee=I.create(),I.scale(ee,ee,[this.width/2,-this.height/2,1]),I.translate(ee,ee,[1,-1,0]),this.labelPlaneMatrix=ee,ee=I.create(),I.scale(ee,ee,[1,-1,1]),I.translate(ee,ee,[-1,-1,0]),I.scale(ee,ee,[2/this.width,2/this.height,1]),this.glCoordMatrix=ee,this.pixelMatrix=I.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(ee=I.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=ee,this._posMatrixCache={},this._alignedPosMatrixCache={}}},go.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var x=this.pointCoordinate(new I.Point(0,0)),C=[x.x*this.worldSize,x.y*this.worldSize,0,1];return I.transformMat4(C,C,this.pixelMatrix)[3]/this.cameraToCenterDistance},go.prototype.getCameraPoint=function(){var x=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new I.Point(0,x))},go.prototype.getCameraQueryGeometry=function(x){var C=this.getCameraPoint();if(x.length===1)return[x[0],C];for(var S=C.x,M=C.y,z=C.x,H=C.y,$=0,ft=x;$<ft.length;$+=1){var zt=ft[$];S=Math.min(S,zt.x),M=Math.min(M,zt.y),z=Math.max(z,zt.x),H=Math.max(H,zt.y)}return[new I.Point(S,M),new I.Point(z,M),new I.Point(z,H),new I.Point(S,H),new I.Point(S,M)]},Object.defineProperties(go.prototype,is);var Yu=function(x){var C,S,M,z;this._hashName=x&&encodeURIComponent(x),I.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(C=this._updateHashUnthrottled.bind(this),S=!1,M=null,z=function(){M=null,S&&(C(),M=setTimeout(z,300),S=!1)},function(){return S=!0,M||z(),M})};Yu.prototype.addTo=function(x){return this._map=x,I.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Yu.prototype.remove=function(){return I.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Yu.prototype.getHashString=function(x){var C=this._map.getCenter(),S=Math.round(100*this._map.getZoom())/100,M=Math.ceil((S*Math.LN2+Math.log(512/360/.5))/Math.LN10),z=Math.pow(10,M),H=Math.round(C.lng*z)/z,$=Math.round(C.lat*z)/z,ft=this._map.getBearing(),zt=this._map.getPitch(),ee="";if(ee+=x?"/"+H+"/"+$+"/"+S:S+"/"+$+"/"+H,(ft||zt)&&(ee+="/"+Math.round(10*ft)/10),zt&&(ee+="/"+Math.round(zt)),this._hashName){var Re=this._hashName,De=!1,ke=I.window.location.hash.slice(1).split("&").map(function(cr){var ar=cr.split("=")[0];return ar===Re?(De=!0,ar+"="+ee):cr}).filter(function(cr){return cr});return De||ke.push(Re+"="+ee),"#"+ke.join("&")}return"#"+ee},Yu.prototype._getCurrentHash=function(){var x,C=this,S=I.window.location.hash.replace("#","");return this._hashName?(S.split("&").map(function(M){return M.split("=")}).forEach(function(M){M[0]===C._hashName&&(x=M)}),(x&&x[1]||"").split("/")):S.split("/")},Yu.prototype._onHashChange=function(){var x=this._getCurrentHash();if(x.length>=3&&!x.some(function(S){return isNaN(S)})){var C=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(x[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+x[2],+x[1]],zoom:+x[0],bearing:C,pitch:+(x[4]||0)}),!0}return!1},Yu.prototype._updateHashUnthrottled=function(){var x=I.window.location.href.replace(/(#.+)?$/,this.getHashString());try{I.window.history.replaceState(I.window.history.state,null,x)}catch(C){}};var Fp={linearity:.3,easing:I.bezier(0,0,.3,1)},bf=I.extend({deceleration:2500,maxSpeed:1400},Fp),tp=I.extend({deceleration:20,maxSpeed:1400},Fp),xd=I.extend({deceleration:1e3,maxSpeed:360},Fp),ep=I.extend({deceleration:1e3,maxSpeed:90},Fp),Rp=function(x){this._map=x,this.clear()};function rp(x,C){(!x.duration||x.duration<C.duration)&&(x.duration=C.duration,x.easing=C.easing)}function Ef(x,C,S){var M=S.maxSpeed,z=S.linearity,H=S.deceleration,$=I.clamp(x*z/(C/1e3),-M,M),ft=Math.abs($)/(H*z);return{easing:S.easing,duration:1e3*ft,amount:$*(ft/2)}}Rp.prototype.clear=function(){this._inertiaBuffer=[]},Rp.prototype.record=function(x){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:I.browser.now(),settings:x})},Rp.prototype._drainInertiaBuffer=function(){for(var x=this._inertiaBuffer,C=I.browser.now();x.length>0&&C-x[0].time>160;)x.shift()},Rp.prototype._onMoveEnd=function(x){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var C={zoom:0,bearing:0,pitch:0,pan:new I.Point(0,0),pinchAround:void 0,around:void 0},S=0,M=this._inertiaBuffer;S<M.length;S+=1){var z=M[S].settings;C.zoom+=z.zoomDelta||0,C.bearing+=z.bearingDelta||0,C.pitch+=z.pitchDelta||0,z.panDelta&&C.pan._add(z.panDelta),z.around&&(C.around=z.around),z.pinchAround&&(C.pinchAround=z.pinchAround)}var H=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,$={};if(C.pan.mag()){var ft=Ef(C.pan.mag(),H,I.extend({},bf,x||{}));$.offset=C.pan.mult(ft.amount/C.pan.mag()),$.center=this._map.transform.center,rp($,ft)}if(C.zoom){var zt=Ef(C.zoom,H,tp);$.zoom=this._map.transform.zoom+zt.amount,rp($,zt)}if(C.bearing){var ee=Ef(C.bearing,H,xd);$.bearing=this._map.transform.bearing+I.clamp(ee.amount,-179,179),rp($,ee)}if(C.pitch){var Re=Ef(C.pitch,H,ep);$.pitch=this._map.transform.pitch+Re.amount,rp($,Re)}if($.zoom||$.bearing){var De=C.pinchAround===void 0?C.around:C.pinchAround;$.around=De?this._map.unproject(De):this._map.getCenter()}return this.clear(),I.extend($,{noMoveStart:!0})}};var au=function(x){function C(M,z,H,$){$===void 0&&($={});var ft=K.mousePos(z.getCanvasContainer(),H),zt=z.unproject(ft);x.call(this,M,I.extend({point:ft,lngLat:zt,originalEvent:H},$)),this._defaultPrevented=!1,this.target=z}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var S={defaultPrevented:{configurable:!0}};return C.prototype.preventDefault=function(){this._defaultPrevented=!0},S.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(C.prototype,S),C}(I.Event),Sf=function(x){function C(M,z,H){var $=M==="touchend"?H.changedTouches:H.touches,ft=K.touchPos(z.getCanvasContainer(),$),zt=ft.map(function(De){return z.unproject(De)}),ee=ft.reduce(function(De,ke,cr,ar){return De.add(ke.div(ar.length))},new I.Point(0,0)),Re=z.unproject(ee);x.call(this,M,{points:ft,point:ee,lngLats:zt,lngLat:Re,originalEvent:H}),this._defaultPrevented=!1}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var S={defaultPrevented:{configurable:!0}};return C.prototype.preventDefault=function(){this._defaultPrevented=!0},S.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(C.prototype,S),C}(I.Event),np=function(x){function C(M,z,H){x.call(this,M,{originalEvent:H}),this._defaultPrevented=!1}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var S={defaultPrevented:{configurable:!0}};return C.prototype.preventDefault=function(){this._defaultPrevented=!0},S.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(C.prototype,S),C}(I.Event),As=function(x,C){this._map=x,this._clickTolerance=C.clickTolerance};As.prototype.reset=function(){delete this._mousedownPos},As.prototype.wheel=function(x){return this._firePreventable(new np(x.type,this._map,x))},As.prototype.mousedown=function(x,C){return this._mousedownPos=C,this._firePreventable(new au(x.type,this._map,x))},As.prototype.mouseup=function(x){this._map.fire(new au(x.type,this._map,x))},As.prototype.click=function(x,C){this._mousedownPos&&this._mousedownPos.dist(C)>=this._clickTolerance||this._map.fire(new au(x.type,this._map,x))},As.prototype.dblclick=function(x){return this._firePreventable(new au(x.type,this._map,x))},As.prototype.mouseover=function(x){this._map.fire(new au(x.type,this._map,x))},As.prototype.mouseout=function(x){this._map.fire(new au(x.type,this._map,x))},As.prototype.touchstart=function(x){return this._firePreventable(new Sf(x.type,this._map,x))},As.prototype.touchmove=function(x){this._map.fire(new Sf(x.type,this._map,x))},As.prototype.touchend=function(x){this._map.fire(new Sf(x.type,this._map,x))},As.prototype.touchcancel=function(x){this._map.fire(new Sf(x.type,this._map,x))},As.prototype._firePreventable=function(x){if(this._map.fire(x),x.defaultPrevented)return{}},As.prototype.isEnabled=function(){return!0},As.prototype.isActive=function(){return!1},As.prototype.enable=function(){},As.prototype.disable=function(){};var Zi=function(x){this._map=x};Zi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Zi.prototype.mousemove=function(x){this._map.fire(new au(x.type,this._map,x))},Zi.prototype.mousedown=function(){this._delayContextMenu=!0},Zi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new au("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Zi.prototype.contextmenu=function(x){this._delayContextMenu?this._contextMenuEvent=x:this._map.fire(new au(x.type,this._map,x)),this._map.listens("contextmenu")&&x.preventDefault()},Zi.prototype.isEnabled=function(){return!0},Zi.prototype.isActive=function(){return!1},Zi.prototype.enable=function(){},Zi.prototype.disable=function(){};var as=function(x,C){this._map=x,this._el=x.getCanvasContainer(),this._container=x.getContainer(),this._clickTolerance=C.clickTolerance||1};function wf(x,C){for(var S={},M=0;M<x.length;M++)S[x[M].identifier]=C[M];return S}as.prototype.isEnabled=function(){return!!this._enabled},as.prototype.isActive=function(){return!!this._active},as.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},as.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},as.prototype.mousedown=function(x,C){this.isEnabled()&&x.shiftKey&&x.button===0&&(K.disableDrag(),this._startPos=this._lastPos=C,this._active=!0)},as.prototype.mousemoveWindow=function(x,C){if(this._active){var S=C;if(!(this._lastPos.equals(S)||!this._box&&S.dist(this._startPos)<this._clickTolerance)){var M=this._startPos;this._lastPos=S,this._box||(this._box=K.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",x));var z=Math.min(M.x,S.x),H=Math.max(M.x,S.x),$=Math.min(M.y,S.y),ft=Math.max(M.y,S.y);K.setTransform(this._box,"translate("+z+"px,"+$+"px)"),this._box.style.width=H-z+"px",this._box.style.height=ft-$+"px"}}},as.prototype.mouseupWindow=function(x,C){var S=this;if(this._active&&x.button===0){var M=this._startPos,z=C;if(this.reset(),K.suppressClick(),M.x!==z.x||M.y!==z.y)return this._map.fire(new I.Event("boxzoomend",{originalEvent:x})),{cameraAnimation:function(H){return H.fitScreenCoordinates(M,z,S._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",x)}},as.prototype.keydown=function(x){this._active&&x.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",x))},as.prototype.blur=function(){this.reset()},as.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(K.remove(this._box),this._box=null),K.enableDrag(),delete this._startPos,delete this._lastPos},as.prototype._fireEvent=function(x,C){return this._map.fire(new I.Event(x,{originalEvent:C}))};var Gf=function(x){this.reset(),this.numTouches=x.numTouches};Gf.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Gf.prototype.touchstart=function(x,C,S){(this.centroid||S.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=x.timeStamp),S.length===this.numTouches&&(this.centroid=function(M){for(var z=new I.Point(0,0),H=0,$=M;H<$.length;H+=1)z._add($[H]);return z.div(M.length)}(C),this.touches=wf(S,C)))},Gf.prototype.touchmove=function(x,C,S){if(!this.aborted&&this.centroid){var M=wf(S,C);for(var z in this.touches){var H=M[z];(!H||H.dist(this.touches[z])>30)&&(this.aborted=!0)}}},Gf.prototype.touchend=function(x,C,S){if((!this.centroid||x.timeStamp-this.startTime>500)&&(this.aborted=!0),S.length===0){var M=!this.aborted&&this.centroid;if(this.reset(),M)return M}};var cc=function(x){this.singleTap=new Gf(x),this.numTaps=x.numTaps,this.reset()};cc.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},cc.prototype.touchstart=function(x,C,S){this.singleTap.touchstart(x,C,S)},cc.prototype.touchmove=function(x,C,S){this.singleTap.touchmove(x,C,S)},cc.prototype.touchend=function(x,C,S){var M=this.singleTap.touchend(x,C,S);if(M){var z=x.timeStamp-this.lastTime<500,H=!this.lastTap||this.lastTap.dist(M)<30;if(z&&H||this.reset(),this.count++,this.lastTime=x.timeStamp,this.lastTap=M,this.count===this.numTaps)return this.reset(),M}};var ml=function(){this._zoomIn=new cc({numTouches:1,numTaps:2}),this._zoomOut=new cc({numTouches:2,numTaps:1}),this.reset()};ml.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ml.prototype.touchstart=function(x,C,S){this._zoomIn.touchstart(x,C,S),this._zoomOut.touchstart(x,C,S)},ml.prototype.touchmove=function(x,C,S){this._zoomIn.touchmove(x,C,S),this._zoomOut.touchmove(x,C,S)},ml.prototype.touchend=function(x,C,S){var M=this,z=this._zoomIn.touchend(x,C,S),H=this._zoomOut.touchend(x,C,S);return z?(this._active=!0,x.preventDefault(),setTimeout(function(){return M.reset()},0),{cameraAnimation:function($){return $.easeTo({duration:300,zoom:$.getZoom()+1,around:$.unproject(z)},{originalEvent:x})}}):H?(this._active=!0,x.preventDefault(),setTimeout(function(){return M.reset()},0),{cameraAnimation:function($){return $.easeTo({duration:300,zoom:$.getZoom()-1,around:$.unproject(H)},{originalEvent:x})}}):void 0},ml.prototype.touchcancel=function(){this.reset()},ml.prototype.enable=function(){this._enabled=!0},ml.prototype.disable=function(){this._enabled=!1,this.reset()},ml.prototype.isEnabled=function(){return this._enabled},ml.prototype.isActive=function(){return this._active};var Dp={0:1,2:2},Ai=function(x){this.reset(),this._clickTolerance=x.clickTolerance||1};Ai.prototype.blur=function(){this.reset()},Ai.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ai.prototype._correctButton=function(x,C){return!1},Ai.prototype._move=function(x,C){return{}},Ai.prototype.mousedown=function(x,C){if(!this._lastPoint){var S=K.mouseButton(x);this._correctButton(x,S)&&(this._lastPoint=C,this._eventButton=S)}},Ai.prototype.mousemoveWindow=function(x,C){var S=this._lastPoint;if(S){if(x.preventDefault(),function(M,z){var H=Dp[z];return M.buttons===void 0||(M.buttons&H)!==H}(x,this._eventButton))this.reset();else if(this._moved||!(C.dist(S)<this._clickTolerance))return this._moved=!0,this._lastPoint=C,this._move(S,C)}},Ai.prototype.mouseupWindow=function(x){this._lastPoint&&K.mouseButton(x)===this._eventButton&&(this._moved&&K.suppressClick(),this.reset())},Ai.prototype.enable=function(){this._enabled=!0},Ai.prototype.disable=function(){this._enabled=!1,this.reset()},Ai.prototype.isEnabled=function(){return this._enabled},Ai.prototype.isActive=function(){return this._active};var Hf=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.mousedown=function(S,M){x.prototype.mousedown.call(this,S,M),this._lastPoint&&(this._active=!0)},C.prototype._correctButton=function(S,M){return M===0&&!S.ctrlKey},C.prototype._move=function(S,M){return{around:M,panDelta:M.sub(S)}},C}(Ai),Cc=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype._correctButton=function(S,M){return M===0&&S.ctrlKey||M===2},C.prototype._move=function(S,M){var z=.8*(M.x-S.x);if(z)return this._active=!0,{bearingDelta:z}},C.prototype.contextmenu=function(S){S.preventDefault()},C}(Ai),Cf=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype._correctButton=function(S,M){return M===0&&S.ctrlKey||M===2},C.prototype._move=function(S,M){var z=-.5*(M.y-S.y);if(z)return this._active=!0,{pitchDelta:z}},C.prototype.contextmenu=function(S){S.preventDefault()},C}(Ai),ma=function(x){this._minTouches=1,this._clickTolerance=x.clickTolerance||1,this.reset()};ma.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new I.Point(0,0)},ma.prototype.touchstart=function(x,C,S){return this._calculateTransform(x,C,S)},ma.prototype.touchmove=function(x,C,S){if(this._active&&!(S.length<this._minTouches))return x.preventDefault(),this._calculateTransform(x,C,S)},ma.prototype.touchend=function(x,C,S){this._calculateTransform(x,C,S),this._active&&S.length<this._minTouches&&this.reset()},ma.prototype.touchcancel=function(){this.reset()},ma.prototype._calculateTransform=function(x,C,S){S.length>0&&(this._active=!0);var M=wf(S,C),z=new I.Point(0,0),H=new I.Point(0,0),$=0;for(var ft in M){var zt=M[ft],ee=this._touches[ft];ee&&(z._add(zt),H._add(zt.sub(ee)),$++,M[ft]=zt)}if(this._touches=M,!($<this._minTouches)&&H.mag()){var Re=H.div($);if(this._sum._add(Re),!(this._sum.mag()<this._clickTolerance))return{around:z.div($),panDelta:Re}}},ma.prototype.enable=function(){this._enabled=!0},ma.prototype.disable=function(){this._enabled=!1,this.reset()},ma.prototype.isEnabled=function(){return this._enabled},ma.prototype.isActive=function(){return this._active};var yl=function(){this.reset()};function jf(x,C,S){for(var M=0;M<x.length;M++)if(x[M].identifier===S)return C[M]}function fc(x,C){return Math.log(x/C)/Math.LN2}yl.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},yl.prototype._start=function(x){},yl.prototype._move=function(x,C,S){return{}},yl.prototype.touchstart=function(x,C,S){this._firstTwoTouches||S.length<2||(this._firstTwoTouches=[S[0].identifier,S[1].identifier],this._start([C[0],C[1]]))},yl.prototype.touchmove=function(x,C,S){if(this._firstTwoTouches){x.preventDefault();var M=this._firstTwoTouches,z=M[1],H=jf(S,C,M[0]),$=jf(S,C,z);if(H&&$){var ft=this._aroundCenter?null:H.add($).div(2);return this._move([H,$],ft,x)}}},yl.prototype.touchend=function(x,C,S){if(this._firstTwoTouches){var M=this._firstTwoTouches,z=M[1],H=jf(S,C,M[0]),$=jf(S,C,z);H&&$||(this._active&&K.suppressClick(),this.reset())}},yl.prototype.touchcancel=function(){this.reset()},yl.prototype.enable=function(x){this._enabled=!0,this._aroundCenter=!!x&&x.around==="center"},yl.prototype.disable=function(){this._enabled=!1,this.reset()},yl.prototype.isEnabled=function(){return this._enabled},yl.prototype.isActive=function(){return this._active};var _l=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.reset=function(){x.prototype.reset.call(this),delete this._distance,delete this._startDistance},C.prototype._start=function(S){this._startDistance=this._distance=S[0].dist(S[1])},C.prototype._move=function(S,M){var z=this._distance;if(this._distance=S[0].dist(S[1]),this._active||!(Math.abs(fc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:fc(this._distance,z),pinchAround:M}},C}(yl);function sa(x,C){return 180*x.angleWith(C)/Math.PI}var Bp=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.reset=function(){x.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},C.prototype._start=function(S){this._startVector=this._vector=S[0].sub(S[1]),this._minDiameter=S[0].dist(S[1])},C.prototype._move=function(S,M){var z=this._vector;if(this._vector=S[0].sub(S[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:sa(this._vector,z),pinchAround:M}},C.prototype._isBelowThreshold=function(S){this._minDiameter=Math.min(this._minDiameter,S.mag());var M=25/(Math.PI*this._minDiameter)*360,z=sa(S,this._startVector);return Math.abs(z)<M},C}(yl);function Np(x){return Math.abs(x.y)>Math.abs(x.x)}var bd=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.reset=function(){x.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},C.prototype._start=function(S){this._lastPoints=S,Np(S[0].sub(S[1]))&&(this._valid=!1)},C.prototype._move=function(S,M,z){var H=S[0].sub(this._lastPoints[0]),$=S[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(H,$,z.timeStamp),this._valid)return this._lastPoints=S,this._active=!0,{pitchDelta:(H.y+$.y)/2*-.5}},C.prototype.gestureBeginsVertically=function(S,M,z){if(this._valid!==void 0)return this._valid;var H=S.mag()>=2,$=M.mag()>=2;if(H||$){if(!H||!$)return this._firstMove===void 0&&(this._firstMove=z),z-this._firstMove<100&&void 0;var ft=S.y>0==M.y>0;return Np(S)&&Np(M)&&ft}},C}(yl),Ed={panStep:100,bearingStep:15,pitchStep:10},Ml=function(){var x=Ed;this._panStep=x.panStep,this._bearingStep=x.bearingStep,this._pitchStep=x.pitchStep,this._rotationDisabled=!1};function Ko(x){return x*(2-x)}Ml.prototype.blur=function(){this.reset()},Ml.prototype.reset=function(){this._active=!1},Ml.prototype.keydown=function(x){var C=this;if(!(x.altKey||x.ctrlKey||x.metaKey)){var S=0,M=0,z=0,H=0,$=0;switch(x.keyCode){case 61:case 107:case 171:case 187:S=1;break;case 189:case 109:case 173:S=-1;break;case 37:x.shiftKey?M=-1:(x.preventDefault(),H=-1);break;case 39:x.shiftKey?M=1:(x.preventDefault(),H=1);break;case 38:x.shiftKey?z=1:(x.preventDefault(),$=-1);break;case 40:x.shiftKey?z=-1:(x.preventDefault(),$=1);break;default:return}return this._rotationDisabled&&(M=0,z=0),{cameraAnimation:function(ft){var zt=ft.getZoom();ft.easeTo({duration:300,easeId:"keyboardHandler",easing:Ko,zoom:S?Math.round(zt)+S*(x.shiftKey?2:1):zt,bearing:ft.getBearing()+M*C._bearingStep,pitch:ft.getPitch()+z*C._pitchStep,offset:[-H*C._panStep,-$*C._panStep],center:ft.getCenter()},{originalEvent:x})}}}},Ml.prototype.enable=function(){this._enabled=!0},Ml.prototype.disable=function(){this._enabled=!1,this.reset()},Ml.prototype.isEnabled=function(){return this._enabled},Ml.prototype.isActive=function(){return this._active},Ml.prototype.disableRotation=function(){this._rotationDisabled=!0},Ml.prototype.enableRotation=function(){this._rotationDisabled=!1};var Ka=function(x,C){this._map=x,this._el=x.getCanvasContainer(),this._handler=C,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,I.bindAll(["_onTimeout"],this)};Ka.prototype.setZoomRate=function(x){this._defaultZoomRate=x},Ka.prototype.setWheelZoomRate=function(x){this._wheelZoomRate=x},Ka.prototype.isEnabled=function(){return!!this._enabled},Ka.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ka.prototype.isZooming=function(){return!!this._zooming},Ka.prototype.enable=function(x){this.isEnabled()||(this._enabled=!0,this._aroundCenter=x&&x.around==="center")},Ka.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ka.prototype.wheel=function(x){if(this.isEnabled()){var C=x.deltaMode===I.window.WheelEvent.DOM_DELTA_LINE?40*x.deltaY:x.deltaY,S=I.browser.now(),M=S-(this._lastWheelEventTime||0);this._lastWheelEventTime=S,C!==0&&C%4.000244140625==0?this._type="wheel":C!==0&&Math.abs(C)<4?this._type="trackpad":M>400?(this._type=null,this._lastValue=C,this._timeout=setTimeout(this._onTimeout,40,x)):this._type||(this._type=Math.abs(M*C)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,C+=this._lastValue)),x.shiftKey&&C&&(C/=4),this._type&&(this._lastWheelEvent=x,this._delta-=C,this._active||this._start(x)),x.preventDefault()}},Ka.prototype._onTimeout=function(x){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(x)},Ka.prototype._start=function(x){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var C=K.mousePos(this._el,x);this._around=I.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(C)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ka.prototype.renderFrame=function(){var x=this;if(this._frameId&&(this._frameId=null,this.isActive())){var C=this._map.transform;if(this._delta!==0){var S=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,M=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&M!==0&&(M=1/M);var z=typeof this._targetZoom=="number"?C.zoomScale(this._targetZoom):C.scale;this._targetZoom=Math.min(C.maxZoom,Math.max(C.minZoom,C.scaleZoom(z*M))),this._type==="wheel"&&(this._startZoom=C.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var H,$=typeof this._targetZoom=="number"?this._targetZoom:C.zoom,ft=this._startZoom,zt=this._easing,ee=!1;if(this._type==="wheel"&&ft&&zt){var Re=Math.min((I.browser.now()-this._lastWheelEventTime)/200,1),De=zt(Re);H=I.number(ft,$,De),Re<1?this._frameId||(this._frameId=!0):ee=!0}else H=$,ee=!0;return this._active=!0,ee&&(this._active=!1,this._finishTimeout=setTimeout(function(){x._zooming=!1,x._handler._triggerRenderFrame(),delete x._targetZoom,delete x._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ee,zoomDelta:H-C.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ka.prototype._smoothOutEasing=function(x){var C=I.ease;if(this._prevEase){var S=this._prevEase,M=(I.browser.now()-S.start)/S.duration,z=S.easing(M+.01)-S.easing(M),H=.27/Math.sqrt(z*z+1e-4)*.01,$=Math.sqrt(.0729-H*H);C=I.bezier(H,$,.25,1)}return this._prevEase={start:I.browser.now(),duration:x,easing:C},C},Ka.prototype.blur=function(){this.reset()},Ka.prototype.reset=function(){this._active=!1};var xl=function(x,C){this._clickZoom=x,this._tapZoom=C};xl.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},xl.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},xl.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},xl.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ql=function(){this.reset()};ql.prototype.reset=function(){this._active=!1},ql.prototype.blur=function(){this.reset()},ql.prototype.dblclick=function(x,C){return x.preventDefault(),{cameraAnimation:function(S){S.easeTo({duration:300,zoom:S.getZoom()+(x.shiftKey?-1:1),around:S.unproject(C)},{originalEvent:x})}}},ql.prototype.enable=function(){this._enabled=!0},ql.prototype.disable=function(){this._enabled=!1,this.reset()},ql.prototype.isEnabled=function(){return this._enabled},ql.prototype.isActive=function(){return this._active};var Ts=function(){this._tap=new cc({numTouches:1,numTaps:1}),this.reset()};Ts.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Ts.prototype.touchstart=function(x,C,S){this._swipePoint||(this._tapTime&&x.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?S.length>0&&(this._swipePoint=C[0],this._swipeTouch=S[0].identifier):this._tap.touchstart(x,C,S))},Ts.prototype.touchmove=function(x,C,S){if(this._tapTime){if(this._swipePoint){if(S[0].identifier!==this._swipeTouch)return;var M=C[0],z=M.y-this._swipePoint.y;return this._swipePoint=M,x.preventDefault(),this._active=!0,{zoomDelta:z/128}}}else this._tap.touchmove(x,C,S)},Ts.prototype.touchend=function(x,C,S){this._tapTime?this._swipePoint&&S.length===0&&this.reset():this._tap.touchend(x,C,S)&&(this._tapTime=x.timeStamp)},Ts.prototype.touchcancel=function(){this.reset()},Ts.prototype.enable=function(){this._enabled=!0},Ts.prototype.disable=function(){this._enabled=!1,this.reset()},Ts.prototype.isEnabled=function(){return this._enabled},Ts.prototype.isActive=function(){return this._active};var jc=function(x,C,S){this._el=x,this._mousePan=C,this._touchPan=S};jc.prototype.enable=function(x){this._inertiaOptions=x||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},jc.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},jc.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},jc.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Nl=function(x,C,S){this._pitchWithRotate=x.pitchWithRotate,this._mouseRotate=C,this._mousePitch=S};Nl.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Nl.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Nl.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Nl.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Su=function(x,C,S,M){this._el=x,this._touchZoom=C,this._touchRotate=S,this._tapDragZoom=M,this._rotationDisabled=!1,this._enabled=!0};Su.prototype.enable=function(x){this._touchZoom.enable(x),this._rotationDisabled||this._touchRotate.enable(x),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Su.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Su.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Su.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Su.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Su.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var wu=function(x){return x.zoom||x.drag||x.pitch||x.rotate},Il=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C}(I.Event);function Ki(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}var Wi=function(x,C){this._map=x,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Rp(x),this._bearingSnap=C.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(C),I.bindAll(["handleEvent","handleWindowEvent"],this);var S=this._el;this._listeners=[[S,"touchstart",{passive:!0}],[S,"touchmove",{passive:!1}],[S,"touchend",void 0],[S,"touchcancel",void 0],[S,"mousedown",void 0],[S,"mousemove",void 0],[S,"mouseup",void 0],[I.window.document,"mousemove",{capture:!0}],[I.window.document,"mouseup",void 0],[S,"mouseover",void 0],[S,"mouseout",void 0],[S,"dblclick",void 0],[S,"click",void 0],[S,"keydown",{capture:!1}],[S,"keyup",void 0],[S,"wheel",{passive:!1}],[S,"contextmenu",void 0],[I.window,"blur",void 0]];for(var M=0,z=this._listeners;M<z.length;M+=1){var H=z[M],$=H[0];K.addEventListener($,H[1],$===I.window.document?this.handleWindowEvent:this.handleEvent,H[2])}};Wi.prototype.destroy=function(){for(var x=0,C=this._listeners;x<C.length;x+=1){var S=C[x],M=S[0];K.removeEventListener(M,S[1],M===I.window.document?this.handleWindowEvent:this.handleEvent,S[2])}},Wi.prototype._addDefaultHandlers=function(x){var C=this._map,S=C.getCanvasContainer();this._add("mapEvent",new As(C,x));var M=C.boxZoom=new as(C,x);this._add("boxZoom",M);var z=new ml,H=new ql;C.doubleClickZoom=new xl(H,z),this._add("tapZoom",z),this._add("clickZoom",H);var $=new Ts;this._add("tapDragZoom",$);var ft=C.touchPitch=new bd;this._add("touchPitch",ft);var zt=new Cc(x),ee=new Cf(x);C.dragRotate=new Nl(x,zt,ee),this._add("mouseRotate",zt,["mousePitch"]),this._add("mousePitch",ee,["mouseRotate"]);var Re=new Hf(x),De=new ma(x);C.dragPan=new jc(S,Re,De),this._add("mousePan",Re),this._add("touchPan",De,["touchZoom","touchRotate"]);var ke=new Bp,cr=new _l;C.touchZoomRotate=new Su(S,cr,ke,$),this._add("touchRotate",ke,["touchPan","touchZoom"]),this._add("touchZoom",cr,["touchPan","touchRotate"]);var ar=C.scrollZoom=new Ka(C,this);this._add("scrollZoom",ar,["mousePan"]);var br=C.keyboard=new Ml;this._add("keyboard",br),this._add("blockableMapEvent",new Zi(C));for(var rr=0,xr=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];rr<xr.length;rr+=1){var Pr=xr[rr];x.interactive&&x[Pr]&&C[Pr].enable(x[Pr])}},Wi.prototype._add=function(x,C,S){this._handlers.push({handlerName:x,handler:C,allowed:S}),this._handlersById[x]=C},Wi.prototype.stop=function(x){if(!this._updatingCamera){for(var C=0,S=this._handlers;C<S.length;C+=1)S[C].handler.reset();this._inertia.clear(),this._fireEvents({},{},x),this._changes=[]}},Wi.prototype.isActive=function(){for(var x=0,C=this._handlers;x<C.length;x+=1)if(C[x].handler.isActive())return!0;return!1},Wi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Wi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Wi.prototype.isMoving=function(){return Boolean(wu(this._eventsInProgress))||this.isZooming()},Wi.prototype._blockedByActive=function(x,C,S){for(var M in x)if(M!==S&&(!C||C.indexOf(M)<0))return!0;return!1},Wi.prototype.handleWindowEvent=function(x){this.handleEvent(x,x.type+"Window")},Wi.prototype._getMapTouches=function(x){for(var C=[],S=0,M=x;S<M.length;S+=1){var z=M[S];this._el.contains(z.target)&&C.push(z)}return C},Wi.prototype.handleEvent=function(x,C){this._updatingCamera=!0;for(var S=x.type==="renderFrame"?void 0:x,M={needsRenderFrame:!1},z={},H={},$=x.touches?this._getMapTouches(x.touches):void 0,ft=$?K.touchPos(this._el,$):K.mousePos(this._el,x),zt=0,ee=this._handlers;zt<ee.length;zt+=1){var Re=ee[zt],De=Re.handlerName,ke=Re.handler,cr=Re.allowed;if(ke.isEnabled()){var ar=void 0;this._blockedByActive(H,cr,De)?ke.reset():ke[C||x.type]&&(ar=ke[C||x.type](x,ft,$),this.mergeHandlerResult(M,z,ar,De,S),ar&&ar.needsRenderFrame&&this._triggerRenderFrame()),(ar||ke.isActive())&&(H[De]=ke)}}var br={};for(var rr in this._previousActiveHandlers)H[rr]||(br[rr]=S);this._previousActiveHandlers=H,(Object.keys(br).length||Ki(M))&&(this._changes.push([M,z,br]),this._triggerRenderFrame()),(Object.keys(H).length||Ki(M))&&this._map._stop(!0),this._updatingCamera=!1;var xr=M.cameraAnimation;xr&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],xr(this._map))},Wi.prototype.mergeHandlerResult=function(x,C,S,M,z){if(S){I.extend(x,S);var H={handlerName:M,originalEvent:S.originalEvent||z};S.zoomDelta!==void 0&&(C.zoom=H),S.panDelta!==void 0&&(C.drag=H),S.pitchDelta!==void 0&&(C.pitch=H),S.bearingDelta!==void 0&&(C.rotate=H)}},Wi.prototype._applyChanges=function(){for(var x={},C={},S={},M=0,z=this._changes;M<z.length;M+=1){var H=z[M],$=H[0],ft=H[1],zt=H[2];$.panDelta&&(x.panDelta=(x.panDelta||new I.Point(0,0))._add($.panDelta)),$.zoomDelta&&(x.zoomDelta=(x.zoomDelta||0)+$.zoomDelta),$.bearingDelta&&(x.bearingDelta=(x.bearingDelta||0)+$.bearingDelta),$.pitchDelta&&(x.pitchDelta=(x.pitchDelta||0)+$.pitchDelta),$.around!==void 0&&(x.around=$.around),$.pinchAround!==void 0&&(x.pinchAround=$.pinchAround),$.noInertia&&(x.noInertia=$.noInertia),I.extend(C,ft),I.extend(S,zt)}this._updateMapTransform(x,C,S),this._changes=[]},Wi.prototype._updateMapTransform=function(x,C,S){var M=this._map,z=M.transform;if(!Ki(x))return this._fireEvents(C,S,!0);var H=x.panDelta,$=x.zoomDelta,ft=x.bearingDelta,zt=x.pitchDelta,ee=x.around,Re=x.pinchAround;Re!==void 0&&(ee=Re),M._stop(!0),ee=ee||M.transform.centerPoint;var De=z.pointLocation(H?ee.sub(H):ee);ft&&(z.bearing+=ft),zt&&(z.pitch+=zt),$&&(z.zoom+=$),z.setLocationAtPoint(De,ee),this._map._update(),x.noInertia||this._inertia.record(x),this._fireEvents(C,S,!0)},Wi.prototype._fireEvents=function(x,C,S){var M=this,z=wu(this._eventsInProgress),H=wu(x),$={};for(var ft in x)this._eventsInProgress[ft]||($[ft+"start"]=x[ft].originalEvent),this._eventsInProgress[ft]=x[ft];for(var zt in!z&&H&&this._fireEvent("movestart",H.originalEvent),$)this._fireEvent(zt,$[zt]);for(var ee in H&&this._fireEvent("move",H.originalEvent),x)this._fireEvent(ee,x[ee].originalEvent);var Re,De={};for(var ke in this._eventsInProgress){var cr=this._eventsInProgress[ke],ar=cr.handlerName,br=cr.originalEvent;this._handlersById[ar].isActive()||(delete this._eventsInProgress[ke],De[ke+"end"]=Re=C[ar]||br)}for(var rr in De)this._fireEvent(rr,De[rr]);var xr=wu(this._eventsInProgress);if(S&&(z||H)&&!xr){this._updatingCamera=!0;var Pr=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Rr=function(vn){return vn!==0&&-M._bearingSnap<vn&&vn<M._bearingSnap};Pr?(Rr(Pr.bearing||this._map.getBearing())&&(Pr.bearing=0),this._map.easeTo(Pr,{originalEvent:Re})):(this._map.fire(new I.Event("moveend",{originalEvent:Re})),Rr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Wi.prototype._fireEvent=function(x,C){this._map.fire(new I.Event(x,C?{originalEvent:C}:{}))},Wi.prototype._requestFrame=function(){var x=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(C){delete x._frameId,x.handleEvent(new Il("renderFrame",{timeStamp:C})),x._applyChanges()})},Wi.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Af=function(x){function C(S,M){x.call(this),this._moving=!1,this._zooming=!1,this.transform=S,this._bearingSnap=M.bearingSnap,I.bindAll(["_renderFrameCallback"],this)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getCenter=function(){return new I.LngLat(this.transform.center.lng,this.transform.center.lat)},C.prototype.setCenter=function(S,M){return this.jumpTo({center:S},M)},C.prototype.panBy=function(S,M,z){return S=I.Point.convert(S).mult(-1),this.panTo(this.transform.center,I.extend({offset:S},M),z)},C.prototype.panTo=function(S,M,z){return this.easeTo(I.extend({center:S},M),z)},C.prototype.getZoom=function(){return this.transform.zoom},C.prototype.setZoom=function(S,M){return this.jumpTo({zoom:S},M),this},C.prototype.zoomTo=function(S,M,z){return this.easeTo(I.extend({zoom:S},M),z)},C.prototype.zoomIn=function(S,M){return this.zoomTo(this.getZoom()+1,S,M),this},C.prototype.zoomOut=function(S,M){return this.zoomTo(this.getZoom()-1,S,M),this},C.prototype.getBearing=function(){return this.transform.bearing},C.prototype.setBearing=function(S,M){return this.jumpTo({bearing:S},M),this},C.prototype.getPadding=function(){return this.transform.padding},C.prototype.setPadding=function(S,M){return this.jumpTo({padding:S},M),this},C.prototype.rotateTo=function(S,M,z){return this.easeTo(I.extend({bearing:S},M),z)},C.prototype.resetNorth=function(S,M){return this.rotateTo(0,I.extend({duration:1e3},S),M),this},C.prototype.resetNorthPitch=function(S,M){return this.easeTo(I.extend({bearing:0,pitch:0,duration:1e3},S),M),this},C.prototype.snapToNorth=function(S,M){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(S,M):this},C.prototype.getPitch=function(){return this.transform.pitch},C.prototype.setPitch=function(S,M){return this.jumpTo({pitch:S},M),this},C.prototype.cameraForBounds=function(S,M){S=I.LngLatBounds.convert(S);var z=M&&M.bearing||0;return this._cameraForBoxAndBearing(S.getNorthWest(),S.getSouthEast(),z,M)},C.prototype._cameraForBoxAndBearing=function(S,M,z,H){var $={top:0,bottom:0,right:0,left:0};if(typeof(H=I.extend({padding:$,offset:[0,0],maxZoom:this.transform.maxZoom},H)).padding=="number"){var ft=H.padding;H.padding={top:ft,bottom:ft,right:ft,left:ft}}H.padding=I.extend($,H.padding);var zt=this.transform,ee=zt.padding,Re=zt.project(I.LngLat.convert(S)),De=zt.project(I.LngLat.convert(M)),ke=Re.rotate(-z*Math.PI/180),cr=De.rotate(-z*Math.PI/180),ar=new I.Point(Math.max(ke.x,cr.x),Math.max(ke.y,cr.y)),br=new I.Point(Math.min(ke.x,cr.x),Math.min(ke.y,cr.y)),rr=ar.sub(br),xr=(zt.width-(ee.left+ee.right+H.padding.left+H.padding.right))/rr.x,Pr=(zt.height-(ee.top+ee.bottom+H.padding.top+H.padding.bottom))/rr.y;if(!(Pr<0||xr<0)){var Rr=Math.min(zt.scaleZoom(zt.scale*Math.min(xr,Pr)),H.maxZoom),vn=typeof H.offset.x=="number"?new I.Point(H.offset.x,H.offset.y):I.Point.convert(H.offset),ln=new I.Point((H.padding.left-H.padding.right)/2,(H.padding.top-H.padding.bottom)/2).rotate(z*Math.PI/180),bn=vn.add(ln).mult(zt.scale/zt.zoomScale(Rr));return{center:zt.unproject(Re.add(De).div(2).sub(bn)),zoom:Rr,bearing:z}}I.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},C.prototype.fitBounds=function(S,M,z){return this._fitInternal(this.cameraForBounds(S,M),M,z)},C.prototype.fitScreenCoordinates=function(S,M,z,H,$){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(I.Point.convert(S)),this.transform.pointLocation(I.Point.convert(M)),z,H),H,$)},C.prototype._fitInternal=function(S,M,z){return S?(delete(M=I.extend(S,M)).padding,M.linear?this.easeTo(M,z):this.flyTo(M,z)):this},C.prototype.jumpTo=function(S,M){this.stop();var z=this.transform,H=!1,$=!1,ft=!1;return"zoom"in S&&z.zoom!==+S.zoom&&(H=!0,z.zoom=+S.zoom),S.center!==void 0&&(z.center=I.LngLat.convert(S.center)),"bearing"in S&&z.bearing!==+S.bearing&&($=!0,z.bearing=+S.bearing),"pitch"in S&&z.pitch!==+S.pitch&&(ft=!0,z.pitch=+S.pitch),S.padding==null||z.isPaddingEqual(S.padding)||(z.padding=S.padding),this.fire(new I.Event("movestart",M)).fire(new I.Event("move",M)),H&&this.fire(new I.Event("zoomstart",M)).fire(new I.Event("zoom",M)).fire(new I.Event("zoomend",M)),$&&this.fire(new I.Event("rotatestart",M)).fire(new I.Event("rotate",M)).fire(new I.Event("rotateend",M)),ft&&this.fire(new I.Event("pitchstart",M)).fire(new I.Event("pitch",M)).fire(new I.Event("pitchend",M)),this.fire(new I.Event("moveend",M))},C.prototype.easeTo=function(S,M){var z=this;this._stop(!1,S.easeId),((S=I.extend({offset:[0,0],duration:500,easing:I.ease},S)).animate===!1||!S.essential&&I.browser.prefersReducedMotion)&&(S.duration=0);var H=this.transform,$=this.getZoom(),ft=this.getBearing(),zt=this.getPitch(),ee=this.getPadding(),Re="zoom"in S?+S.zoom:$,De="bearing"in S?this._normalizeBearing(S.bearing,ft):ft,ke="pitch"in S?+S.pitch:zt,cr="padding"in S?S.padding:H.padding,ar=I.Point.convert(S.offset),br=H.centerPoint.add(ar),rr=H.pointLocation(br),xr=I.LngLat.convert(S.center||rr);this._normalizeCenter(xr);var Pr,Rr,vn=H.project(rr),ln=H.project(xr).sub(vn),bn=H.zoomScale(Re-$);S.around&&(Pr=I.LngLat.convert(S.around),Rr=H.locationPoint(Pr));var Zn={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Re!==$,this._rotating=this._rotating||ft!==De,this._pitching=this._pitching||ke!==zt,this._padding=!H.isPaddingEqual(cr),this._easeId=S.easeId,this._prepareEase(M,S.noMoveStart,Zn),this._ease(function(Kn){if(z._zooming&&(H.zoom=I.number($,Re,Kn)),z._rotating&&(H.bearing=I.number(ft,De,Kn)),z._pitching&&(H.pitch=I.number(zt,ke,Kn)),z._padding&&(H.interpolatePadding(ee,cr,Kn),br=H.centerPoint.add(ar)),Pr)H.setLocationAtPoint(Pr,Rr);else{var ci=H.zoomScale(H.zoom-$),Oi=Re>$?Math.min(2,bn):Math.max(.5,bn),na=Math.pow(Oi,1-Kn),ia=H.unproject(vn.add(ln.mult(Kn*na)).mult(ci));H.setLocationAtPoint(H.renderWorldCopies?ia.wrap():ia,br)}z._fireMoveEvents(M)},function(Kn){z._afterEase(M,Kn)},S),this},C.prototype._prepareEase=function(S,M,z){z===void 0&&(z={}),this._moving=!0,M||z.moving||this.fire(new I.Event("movestart",S)),this._zooming&&!z.zooming&&this.fire(new I.Event("zoomstart",S)),this._rotating&&!z.rotating&&this.fire(new I.Event("rotatestart",S)),this._pitching&&!z.pitching&&this.fire(new I.Event("pitchstart",S))},C.prototype._fireMoveEvents=function(S){this.fire(new I.Event("move",S)),this._zooming&&this.fire(new I.Event("zoom",S)),this._rotating&&this.fire(new I.Event("rotate",S)),this._pitching&&this.fire(new I.Event("pitch",S))},C.prototype._afterEase=function(S,M){if(!this._easeId||!M||this._easeId!==M){delete this._easeId;var z=this._zooming,H=this._rotating,$=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,z&&this.fire(new I.Event("zoomend",S)),H&&this.fire(new I.Event("rotateend",S)),$&&this.fire(new I.Event("pitchend",S)),this.fire(new I.Event("moveend",S))}},C.prototype.flyTo=function(S,M){var z=this;if(!S.essential&&I.browser.prefersReducedMotion){var H=I.pick(S,["center","zoom","bearing","pitch","around"]);return this.jumpTo(H,M)}this.stop(),S=I.extend({offset:[0,0],speed:1.2,curve:1.42,easing:I.ease},S);var $=this.transform,ft=this.getZoom(),zt=this.getBearing(),ee=this.getPitch(),Re=this.getPadding(),De="zoom"in S?I.clamp(+S.zoom,$.minZoom,$.maxZoom):ft,ke="bearing"in S?this._normalizeBearing(S.bearing,zt):zt,cr="pitch"in S?+S.pitch:ee,ar="padding"in S?S.padding:$.padding,br=$.zoomScale(De-ft),rr=I.Point.convert(S.offset),xr=$.centerPoint.add(rr),Pr=$.pointLocation(xr),Rr=I.LngLat.convert(S.center||Pr);this._normalizeCenter(Rr);var vn=$.project(Pr),ln=$.project(Rr).sub(vn),bn=S.curve,Zn=Math.max($.width,$.height),Kn=Zn/br,ci=ln.mag();if("minZoom"in S){var Oi=I.clamp(Math.min(S.minZoom,ft,De),$.minZoom,$.maxZoom),na=Zn/$.zoomScale(Oi-ft);bn=Math.sqrt(na/ci*2)}var ia=bn*bn;function ua(pa){var da=(Kn*Kn-Zn*Zn+(pa?-1:1)*ia*ia*ci*ci)/(2*(pa?Kn:Zn)*ia*ci);return Math.log(Math.sqrt(da*da+1)-da)}function Qa(pa){return(Math.exp(pa)-Math.exp(-pa))/2}function Fi(pa){return(Math.exp(pa)+Math.exp(-pa))/2}var Ra=ua(0),Aa=function(pa){return Fi(Ra)/Fi(Ra+bn*pa)},ka=function(pa){return Zn*((Fi(Ra)*(Qa(da=Ra+bn*pa)/Fi(da))-Qa(Ra))/ia)/ci;var da},la=(ua(1)-Ra)/bn;if(Math.abs(ci)<1e-6||!isFinite(la)){if(Math.abs(Zn-Kn)<1e-6)return this.easeTo(S,M);var Na=Kn<Zn?-1:1;la=Math.abs(Math.log(Kn/Zn))/bn,ka=function(){return 0},Aa=function(pa){return Math.exp(Na*bn*pa)}}return S.duration="duration"in S?+S.duration:1e3*la/("screenSpeed"in S?+S.screenSpeed/bn:+S.speed),S.maxDuration&&S.duration>S.maxDuration&&(S.duration=0),this._zooming=!0,this._rotating=zt!==ke,this._pitching=cr!==ee,this._padding=!$.isPaddingEqual(ar),this._prepareEase(M,!1),this._ease(function(pa){var da=pa*la,Ds=1/Aa(da);$.zoom=pa===1?De:ft+$.scaleZoom(Ds),z._rotating&&($.bearing=I.number(zt,ke,pa)),z._pitching&&($.pitch=I.number(ee,cr,pa)),z._padding&&($.interpolatePadding(Re,ar,pa),xr=$.centerPoint.add(rr));var ss=pa===1?Rr:$.unproject(vn.add(ln.mult(ka(da))).mult(Ds));$.setLocationAtPoint($.renderWorldCopies?ss.wrap():ss,xr),z._fireMoveEvents(M)},function(){return z._afterEase(M)},S),this},C.prototype.isEasing=function(){return!!this._easeFrameId},C.prototype.stop=function(){return this._stop()},C.prototype._stop=function(S,M){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var z=this._onEaseEnd;delete this._onEaseEnd,z.call(this,M)}if(!S){var H=this.handlers;H&&H.stop(!1)}return this},C.prototype._ease=function(S,M,z){z.animate===!1||z.duration===0?(S(1),M()):(this._easeStart=I.browser.now(),this._easeOptions=z,this._onEaseFrame=S,this._onEaseEnd=M,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},C.prototype._renderFrameCallback=function(){var S=Math.min((I.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(S)),S<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},C.prototype._normalizeBearing=function(S,M){S=I.wrap(S,-180,180);var z=Math.abs(S-M);return Math.abs(S-360-M)<z&&(S-=360),Math.abs(S+360-M)<z&&(S+=360),S},C.prototype._normalizeCenter=function(S){var M=this.transform;if(M.renderWorldCopies&&!M.lngRange){var z=S.lng-M.center.lng;S.lng+=z>180?-360:z<-180?360:0}},C}(I.Evented),ol=function(x){x===void 0&&(x={}),this.options=x,I.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};ol.prototype.getDefaultPosition=function(){return"bottom-right"},ol.prototype.onAdd=function(x){var C=this.options&&this.options.compact;return this._map=x,this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=K.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=K.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),C&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),C===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ol.prototype.onRemove=function(){K.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ol.prototype._setElementTitle=function(x,C){var S=this._map._getUIString("AttributionControl."+C);x.title=S,x.setAttribute("aria-label",S)},ol.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},ol.prototype._updateEditLink=function(){var x=this._editLink;x||(x=this._editLink=this._container.querySelector(".mapbox-improve-map"));var C=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||I.config.ACCESS_TOKEN}];if(x){var S=C.reduce(function(M,z,H){return z.value&&(M+=z.key+"="+z.value+(H<C.length-1?"&":"")),M},"?");x.href=I.config.FEEDBACK_URL+"/"+S+(this._map._hash?this._map._hash.getHashString(!0):""),x.rel="noopener nofollow",this._setElementTitle(x,"MapFeedback")}},ol.prototype._updateData=function(x){!x||x.sourceDataType!=="metadata"&&x.sourceDataType!=="visibility"&&x.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ol.prototype._updateAttributions=function(){if(this._map.style){var x=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?x=x.concat(this.options.customAttribution.map(function(ft){return typeof ft!="string"?"":ft})):typeof this.options.customAttribution=="string"&&x.push(this.options.customAttribution)),this._map.style.stylesheet){var C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}var S=this._map.style.sourceCaches;for(var M in S){var z=S[M];if(z.used){var H=z.getSource();H.attribution&&x.indexOf(H.attribution)<0&&x.push(H.attribution)}}x.sort(function(ft,zt){return ft.length-zt.length});var $=(x=x.filter(function(ft,zt){for(var ee=zt+1;ee<x.length;ee++)if(x[ee].indexOf(ft)>=0)return!1;return!0})).join(" | ");$!==this._attribHTML&&(this._attribHTML=$,x.length?(this._innerContainer.innerHTML=$,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ol.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var sl=function(){I.bindAll(["_updateLogo"],this),I.bindAll(["_updateCompact"],this)};sl.prototype.onAdd=function(x){this._map=x,this._container=K.create("div","mapboxgl-ctrl");var C=K.create("a","mapboxgl-ctrl-logo");return C.target="_blank",C.rel="noopener nofollow",C.href="https://www.mapbox.com/",C.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),C.setAttribute("rel","noopener nofollow"),this._container.appendChild(C),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},sl.prototype.onRemove=function(){K.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},sl.prototype.getDefaultPosition=function(){return"bottom-left"},sl.prototype._updateLogo=function(x){x&&x.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},sl.prototype._logoRequired=function(){if(this._map.style){var x=this._map.style.sourceCaches;for(var C in x)if(x[C].getSource().mapbox_logo)return!0;return!1}},sl.prototype._updateCompact=function(){var x=this._container.children;if(x.length){var C=x[0];this._map.getCanvasContainer().offsetWidth<250?C.classList.add("mapboxgl-compact"):C.classList.remove("mapboxgl-compact")}};var Ru=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ru.prototype.add=function(x){var C=++this._id;return this._queue.push({callback:x,id:C,cancelled:!1}),C},Ru.prototype.remove=function(x){for(var C=this._currentlyRunning,S=0,M=C?this._queue.concat(C):this._queue;S<M.length;S+=1){var z=M[S];if(z.id===x)return void(z.cancelled=!0)}},Ru.prototype.run=function(x){x===void 0&&(x=0);var C=this._currentlyRunning=this._queue;this._queue=[];for(var S=0,M=C;S<M.length;S+=1){var z=M[S];if(!z.cancelled&&(z.callback(x),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ru.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var bs={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Ac=I.window.HTMLImageElement,Tc=I.window.HTMLElement,No=I.window.ImageBitmap,os={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ip=function(x){function C(M){var z=this;if((M=I.extend({},os,M)).minZoom!=null&&M.maxZoom!=null&&M.minZoom>M.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(M.minPitch!=null&&M.maxPitch!=null&&M.minPitch>M.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(M.minPitch!=null&&M.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(M.maxPitch!=null&&M.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var H=new go(M.minZoom,M.maxZoom,M.minPitch,M.maxPitch,M.renderWorldCopies);if(x.call(this,H,M),this._interactive=M.interactive,this._maxTileCacheSize=M.maxTileCacheSize,this._failIfMajorPerformanceCaveat=M.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=M.preserveDrawingBuffer,this._antialias=M.antialias,this._trackResize=M.trackResize,this._bearingSnap=M.bearingSnap,this._refreshExpiredTiles=M.refreshExpiredTiles,this._fadeDuration=M.fadeDuration,this._crossSourceCollisions=M.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=M.collectResourceTiming,this._renderTaskQueue=new Ru,this._controls=[],this._mapId=I.uniqueId(),this._locale=I.extend({},bs,M.locale),this._clickTolerance=M.clickTolerance,this._requestManager=new I.RequestManager(M.transformRequest,M.accessToken),typeof M.container=="string"){if(this._container=I.window.document.getElementById(M.container),!this._container)throw new Error("Container '"+M.container+"' not found.")}else{if(!(M.container instanceof Tc))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=M.container}if(M.maxBounds&&this.setMaxBounds(M.maxBounds),I.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return z._update(!1)}),this.on("moveend",function(){return z._update(!1)}),this.on("zoom",function(){return z._update(!0)}),I.window!==void 0&&(I.window.addEventListener("online",this._onWindowOnline,!1),I.window.addEventListener("resize",this._onWindowResize,!1),I.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Wi(this,M),this._hash=M.hash&&new Yu(typeof M.hash=="string"&&M.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:M.center,zoom:M.zoom,bearing:M.bearing,pitch:M.pitch}),M.bounds&&(this.resize(),this.fitBounds(M.bounds,I.extend({},M.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=M.localIdeographFontFamily,M.style&&this.setStyle(M.style,{localIdeographFontFamily:M.localIdeographFontFamily}),M.attributionControl&&this.addControl(new ol({customAttribution:M.customAttribution})),this.addControl(new sl,M.logoPosition),this.on("style.load",function(){z.transform.unmodified&&z.jumpTo(z.style.stylesheet)}),this.on("data",function($){z._update($.dataType==="style"),z.fire(new I.Event($.dataType+"data",$))}),this.on("dataloading",function($){z.fire(new I.Event($.dataType+"dataloading",$))})}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var S={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return C.prototype._getMapId=function(){return this._mapId},C.prototype.addControl=function(M,z){if(z===void 0&&(z=M.getDefaultPosition?M.getDefaultPosition():"top-right"),!M||!M.onAdd)return this.fire(new I.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var H=M.onAdd(this);this._controls.push(M);var $=this._controlPositions[z];return z.indexOf("bottom")!==-1?$.insertBefore(H,$.firstChild):$.appendChild(H),this},C.prototype.removeControl=function(M){if(!M||!M.onRemove)return this.fire(new I.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var z=this._controls.indexOf(M);return z>-1&&this._controls.splice(z,1),M.onRemove(this),this},C.prototype.hasControl=function(M){return this._controls.indexOf(M)>-1},C.prototype.resize=function(M){var z=this._containerDimensions(),H=z[0],$=z[1];if(H===this.transform.width&&$===this.transform.height)return this;this._resizeCanvas(H,$),this.transform.resize(H,$),this.painter.resize(H,$);var ft=!this._moving;return ft&&this.fire(new I.Event("movestart",M)).fire(new I.Event("move",M)),this.fire(new I.Event("resize",M)),ft&&this.fire(new I.Event("moveend",M)),this},C.prototype.getBounds=function(){return this.transform.getBounds()},C.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},C.prototype.setMaxBounds=function(M){return this.transform.setMaxBounds(I.LngLatBounds.convert(M)),this._update()},C.prototype.setMinZoom=function(M){if((M=M==null?-2:M)>=-2&&M<=this.transform.maxZoom)return this.transform.minZoom=M,this._update(),this.getZoom()<M&&this.setZoom(M),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},C.prototype.getMinZoom=function(){return this.transform.minZoom},C.prototype.setMaxZoom=function(M){if((M=M==null?22:M)>=this.transform.minZoom)return this.transform.maxZoom=M,this._update(),this.getZoom()>M&&this.setZoom(M),this;throw new Error("maxZoom must be greater than the current minZoom")},C.prototype.getMaxZoom=function(){return this.transform.maxZoom},C.prototype.setMinPitch=function(M){if((M=M==null?0:M)<0)throw new Error("minPitch must be greater than or equal to 0");if(M>=0&&M<=this.transform.maxPitch)return this.transform.minPitch=M,this._update(),this.getPitch()<M&&this.setPitch(M),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},C.prototype.getMinPitch=function(){return this.transform.minPitch},C.prototype.setMaxPitch=function(M){if((M=M==null?60:M)>60)throw new Error("maxPitch must be less than or equal to 60");if(M>=this.transform.minPitch)return this.transform.maxPitch=M,this._update(),this.getPitch()>M&&this.setPitch(M),this;throw new Error("maxPitch must be greater than the current minPitch")},C.prototype.getMaxPitch=function(){return this.transform.maxPitch},C.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},C.prototype.setRenderWorldCopies=function(M){return this.transform.renderWorldCopies=M,this._update()},C.prototype.project=function(M){return this.transform.locationPoint(I.LngLat.convert(M))},C.prototype.unproject=function(M){return this.transform.pointLocation(I.Point.convert(M))},C.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},C.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},C.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},C.prototype._createDelegatedListener=function(M,z,H){var $,ft=this;if(M==="mouseenter"||M==="mouseover"){var zt=!1;return{layer:z,listener:H,delegates:{mousemove:function(Re){var De=ft.getLayer(z)?ft.queryRenderedFeatures(Re.point,{layers:[z]}):[];De.length?zt||(zt=!0,H.call(ft,new au(M,ft,Re.originalEvent,{features:De}))):zt=!1},mouseout:function(){zt=!1}}}}if(M==="mouseleave"||M==="mouseout"){var ee=!1;return{layer:z,listener:H,delegates:{mousemove:function(Re){(ft.getLayer(z)?ft.queryRenderedFeatures(Re.point,{layers:[z]}):[]).length?ee=!0:ee&&(ee=!1,H.call(ft,new au(M,ft,Re.originalEvent)))},mouseout:function(Re){ee&&(ee=!1,H.call(ft,new au(M,ft,Re.originalEvent)))}}}}return{layer:z,listener:H,delegates:($={},$[M]=function(Re){var De=ft.getLayer(z)?ft.queryRenderedFeatures(Re.point,{layers:[z]}):[];De.length&&(Re.features=De,H.call(ft,Re),delete Re.features)},$)}},C.prototype.on=function(M,z,H){if(H===void 0)return x.prototype.on.call(this,M,z);var $=this._createDelegatedListener(M,z,H);for(var ft in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[M]=this._delegatedListeners[M]||[],this._delegatedListeners[M].push($),$.delegates)this.on(ft,$.delegates[ft]);return this},C.prototype.once=function(M,z,H){if(H===void 0)return x.prototype.once.call(this,M,z);var $=this._createDelegatedListener(M,z,H);for(var ft in $.delegates)this.once(ft,$.delegates[ft]);return this},C.prototype.off=function(M,z,H){var $=this;return H===void 0?x.prototype.off.call(this,M,z):(this._delegatedListeners&&this._delegatedListeners[M]&&function(ft){for(var zt=ft[M],ee=0;ee<zt.length;ee++){var Re=zt[ee];if(Re.layer===z&&Re.listener===H){for(var De in Re.delegates)$.off(De,Re.delegates[De]);return zt.splice(ee,1),$}}}(this._delegatedListeners),this)},C.prototype.queryRenderedFeatures=function(M,z){if(!this.style)return[];var H;if(z!==void 0||M===void 0||M instanceof I.Point||Array.isArray(M)||(z=M,M=void 0),z=z||{},(M=M||[[0,0],[this.transform.width,this.transform.height]])instanceof I.Point||typeof M[0]=="number")H=[I.Point.convert(M)];else{var $=I.Point.convert(M[0]),ft=I.Point.convert(M[1]);H=[$,new I.Point(ft.x,$.y),ft,new I.Point($.x,ft.y),$]}return this.style.queryRenderedFeatures(H,z,this.transform)},C.prototype.querySourceFeatures=function(M,z){return this.style.querySourceFeatures(M,z)},C.prototype.setStyle=function(M,z){return(z=I.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},z)).diff!==!1&&z.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&M?(this._diffStyle(M,z),this):(this._localIdeographFontFamily=z.localIdeographFontFamily,this._updateStyle(M,z))},C.prototype._getUIString=function(M){var z=this._locale[M];if(z==null)throw new Error("Missing UI string '"+M+"'");return z},C.prototype._updateStyle=function(M,z){return this.style&&(this.style.setEventedParent(null),this.style._remove()),M?(this.style=new Fu(this,z||{}),this.style.setEventedParent(this,{style:this.style}),typeof M=="string"?this.style.loadURL(M):this.style.loadJSON(M),this):(delete this.style,this)},C.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Fu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},C.prototype._diffStyle=function(M,z){var H=this;if(typeof M=="string"){var $=this._requestManager.normalizeStyleURL(M),ft=this._requestManager.transformRequest($,I.ResourceType.Style);I.getJSON(ft,function(zt,ee){zt?H.fire(new I.ErrorEvent(zt)):ee&&H._updateDiff(ee,z)})}else typeof M=="object"&&this._updateDiff(M,z)},C.prototype._updateDiff=function(M,z){try{this.style.setState(M)&&this._update(!0)}catch(H){I.warnOnce("Unable to perform style diff: "+(H.message||H.error||H)+".  Rebuilding the style from scratch."),this._updateStyle(M,z)}},C.prototype.getStyle=function(){if(this.style)return this.style.serialize()},C.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():I.warnOnce("There is no style added to the map.")},C.prototype.addSource=function(M,z){return this._lazyInitEmptyStyle(),this.style.addSource(M,z),this._update(!0)},C.prototype.isSourceLoaded=function(M){var z=this.style&&this.style.sourceCaches[M];if(z!==void 0)return z.loaded();this.fire(new I.ErrorEvent(new Error("There is no source with ID '"+M+"'")))},C.prototype.areTilesLoaded=function(){var M=this.style&&this.style.sourceCaches;for(var z in M){var H=M[z]._tiles;for(var $ in H){var ft=H[$];if(ft.state!=="loaded"&&ft.state!=="errored")return!1}}return!0},C.prototype.addSourceType=function(M,z,H){return this._lazyInitEmptyStyle(),this.style.addSourceType(M,z,H)},C.prototype.removeSource=function(M){return this.style.removeSource(M),this._update(!0)},C.prototype.getSource=function(M){return this.style.getSource(M)},C.prototype.addImage=function(M,z,H){H===void 0&&(H={});var $=H.pixelRatio;$===void 0&&($=1);var ft=H.sdf;ft===void 0&&(ft=!1);var zt=H.stretchX,ee=H.stretchY,Re=H.content;if(this._lazyInitEmptyStyle(),z instanceof Ac||No&&z instanceof No){var De=I.browser.getImageData(z);this.style.addImage(M,{data:new I.RGBAImage({width:De.width,height:De.height},De.data),pixelRatio:$,stretchX:zt,stretchY:ee,content:Re,sdf:ft,version:0})}else{if(z.width===void 0||z.height===void 0)return this.fire(new I.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var ke=z;this.style.addImage(M,{data:new I.RGBAImage({width:z.width,height:z.height},new Uint8Array(z.data)),pixelRatio:$,stretchX:zt,stretchY:ee,content:Re,sdf:ft,version:0,userImage:ke}),ke.onAdd&&ke.onAdd(this,M)}},C.prototype.updateImage=function(M,z){var H=this.style.getImage(M);if(!H)return this.fire(new I.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var $=z instanceof Ac||No&&z instanceof No?I.browser.getImageData(z):z,ft=$.width,zt=$.height,ee=$.data;return ft===void 0||zt===void 0?this.fire(new I.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):ft!==H.data.width||zt!==H.data.height?this.fire(new I.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(H.data.replace(ee,!(z instanceof Ac||No&&z instanceof No)),void this.style.updateImage(M,H))},C.prototype.hasImage=function(M){return M?!!this.style.getImage(M):(this.fire(new I.ErrorEvent(new Error("Missing required image id"))),!1)},C.prototype.removeImage=function(M){this.style.removeImage(M)},C.prototype.loadImage=function(M,z){I.getImage(this._requestManager.transformRequest(M,I.ResourceType.Image),z)},C.prototype.listImages=function(){return this.style.listImages()},C.prototype.addLayer=function(M,z){return this._lazyInitEmptyStyle(),this.style.addLayer(M,z),this._update(!0)},C.prototype.moveLayer=function(M,z){return this.style.moveLayer(M,z),this._update(!0)},C.prototype.removeLayer=function(M){return this.style.removeLayer(M),this._update(!0)},C.prototype.getLayer=function(M){return this.style.getLayer(M)},C.prototype.setLayerZoomRange=function(M,z,H){return this.style.setLayerZoomRange(M,z,H),this._update(!0)},C.prototype.setFilter=function(M,z,H){return H===void 0&&(H={}),this.style.setFilter(M,z,H),this._update(!0)},C.prototype.getFilter=function(M){return this.style.getFilter(M)},C.prototype.setPaintProperty=function(M,z,H,$){return $===void 0&&($={}),this.style.setPaintProperty(M,z,H,$),this._update(!0)},C.prototype.getPaintProperty=function(M,z){return this.style.getPaintProperty(M,z)},C.prototype.setLayoutProperty=function(M,z,H,$){return $===void 0&&($={}),this.style.setLayoutProperty(M,z,H,$),this._update(!0)},C.prototype.getLayoutProperty=function(M,z){return this.style.getLayoutProperty(M,z)},C.prototype.setLight=function(M,z){return z===void 0&&(z={}),this._lazyInitEmptyStyle(),this.style.setLight(M,z),this._update(!0)},C.prototype.getLight=function(){return this.style.getLight()},C.prototype.setFeatureState=function(M,z){return this.style.setFeatureState(M,z),this._update()},C.prototype.removeFeatureState=function(M,z){return this.style.removeFeatureState(M,z),this._update()},C.prototype.getFeatureState=function(M){return this.style.getFeatureState(M)},C.prototype.getContainer=function(){return this._container},C.prototype.getCanvasContainer=function(){return this._canvasContainer},C.prototype.getCanvas=function(){return this._canvas},C.prototype._containerDimensions=function(){var M=0,z=0;return this._container&&(M=this._container.clientWidth||400,z=this._container.clientHeight||300),[M,z]},C.prototype._detectMissingCSS=function(){I.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&I.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},C.prototype._setupContainer=function(){var M=this._container;M.classList.add("mapboxgl-map"),(this._missingCSSCanary=K.create("div","mapboxgl-canary",M)).style.visibility="hidden",this._detectMissingCSS();var z=this._canvasContainer=K.create("div","mapboxgl-canvas-container",M);this._interactive&&z.classList.add("mapboxgl-interactive"),this._canvas=K.create("canvas","mapboxgl-canvas",z),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var H=this._containerDimensions();this._resizeCanvas(H[0],H[1]);var $=this._controlContainer=K.create("div","mapboxgl-control-container",M),ft=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(zt){ft[zt]=K.create("div","mapboxgl-ctrl-"+zt,$)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},C.prototype._resizeCanvas=function(M,z){var H=I.browser.devicePixelRatio||1;this._canvas.width=H*M,this._canvas.height=H*z,this._canvas.style.width=M+"px",this._canvas.style.height=z+"px"},C.prototype._setupPainter=function(){var M=I.extend({},xt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),z=this._canvas.getContext("webgl",M)||this._canvas.getContext("experimental-webgl",M);z?(this.painter=new xs(z,this.transform),I.webpSupported.testSupport(z)):this.fire(new I.ErrorEvent(new Error("Failed to initialize WebGL")))},C.prototype._contextLost=function(M){M.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new I.Event("webglcontextlost",{originalEvent:M}))},C.prototype._contextRestored=function(M){this._setupPainter(),this.resize(),this._update(),this.fire(new I.Event("webglcontextrestored",{originalEvent:M}))},C.prototype._onMapScroll=function(M){if(M.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},C.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},C.prototype._update=function(M){return this.style?(this._styleDirty=this._styleDirty||M,this._sourcesDirty=!0,this.triggerRepaint(),this):this},C.prototype._requestRenderFrame=function(M){return this._update(),this._renderTaskQueue.add(M)},C.prototype._cancelRenderFrame=function(M){this._renderTaskQueue.remove(M)},C.prototype._render=function(M){var z,H=this,$=0,ft=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(z=ft.createQueryEXT(),ft.beginQueryEXT(ft.TIME_ELAPSED_EXT,z),$=I.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(M),!this._removed){var zt=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var ee=this.transform.zoom,Re=I.browser.now();this.style.zoomHistory.update(ee,Re);var De=new I.EvaluationParameters(ee,{now:Re,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ke=De.crossFadingFactor();ke===1&&ke===this._crossFadingFactor||(zt=!0,this._crossFadingFactor=ke),this.style.update(De)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new I.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new I.Event("load"))),this.style&&(this.style.hasTransitions()||zt)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var cr=I.browser.now()-$;ft.endQueryEXT(ft.TIME_ELAPSED_EXT,z),setTimeout(function(){var rr=ft.getQueryObjectEXT(z,ft.QUERY_RESULT_EXT)/1e6;ft.deleteQueryEXT(z),H.fire(new I.Event("gpu-timing-frame",{cpuTime:cr,gpuTime:rr}))},50)}if(this.listens("gpu-timing-layer")){var ar=this.painter.collectGpuTimers();setTimeout(function(){var rr=H.painter.queryGpuTimers(ar);H.fire(new I.Event("gpu-timing-layer",{layerTimes:rr}))},50)}var br=this._sourcesDirty||this._styleDirty||this._placementDirty;return br||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new I.Event("idle")),!this._loaded||this._fullyLoaded||br||(this._fullyLoaded=!0),this}},C.prototype.remove=function(){this._hash&&this._hash.remove();for(var M=0,z=this._controls;M<z.length;M+=1)z[M].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),I.window!==void 0&&(I.window.removeEventListener("resize",this._onWindowResize,!1),I.window.removeEventListener("orientationchange",this._onWindowResize,!1),I.window.removeEventListener("online",this._onWindowOnline,!1));var H=this.painter.context.gl.getExtension("WEBGL_lose_context");H&&H.loseContext(),Wc(this._canvasContainer),Wc(this._controlContainer),Wc(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new I.Event("remove"))},C.prototype.triggerRepaint=function(){var M=this;this.style&&!this._frame&&(this._frame=I.browser.frame(function(z){M._frame=null,M._render(z)}))},C.prototype._onWindowOnline=function(){this._update()},C.prototype._onWindowResize=function(M){this._trackResize&&this.resize({originalEvent:M})._update()},S.showTileBoundaries.get=function(){return!!this._showTileBoundaries},S.showTileBoundaries.set=function(M){this._showTileBoundaries!==M&&(this._showTileBoundaries=M,this._update())},S.showPadding.get=function(){return!!this._showPadding},S.showPadding.set=function(M){this._showPadding!==M&&(this._showPadding=M,this._update())},S.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},S.showCollisionBoxes.set=function(M){this._showCollisionBoxes!==M&&(this._showCollisionBoxes=M,M?this.style._generateCollisionBoxes():this._update())},S.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},S.showOverdrawInspector.set=function(M){this._showOverdrawInspector!==M&&(this._showOverdrawInspector=M,this._update())},S.repaint.get=function(){return!!this._repaint},S.repaint.set=function(M){this._repaint!==M&&(this._repaint=M,this.triggerRepaint())},S.vertices.get=function(){return!!this._vertices},S.vertices.set=function(M){this._vertices=M,this._update()},C.prototype._setCacheLimits=function(M,z){I.setCacheLimits(M,z)},S.version.get=function(){return I.version},Object.defineProperties(C.prototype,S),C}(Af);function Wc(x){x.parentNode&&x.parentNode.removeChild(x)}var hc={showCompass:!0,showZoom:!0,visualizePitch:!1},ul=function(x){var C=this;this.options=I.extend({},hc,x),this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this.options.showZoom&&(I.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(S){return C._map.zoomIn({},{originalEvent:S})}),K.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(S){return C._map.zoomOut({},{originalEvent:S})}),K.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(I.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(S){C.options.visualizePitch?C._map.resetNorthPitch({},{originalEvent:S}):C._map.resetNorth({},{originalEvent:S})}),this._compassIcon=K.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ul.prototype._updateZoomButtons=function(){var x=this._map.getZoom(),C=x===this._map.getMaxZoom(),S=x===this._map.getMinZoom();this._zoomInButton.disabled=C,this._zoomOutButton.disabled=S,this._zoomInButton.setAttribute("aria-disabled",C.toString()),this._zoomOutButton.setAttribute("aria-disabled",S.toString())},ul.prototype._rotateCompassArrow=function(){var x=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=x},ul.prototype.onAdd=function(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Fs(this._map,this._compass,this.options.visualizePitch)),this._container},ul.prototype.onRemove=function(){K.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ul.prototype._createButton=function(x,C){var S=K.create("button",x,this._container);return S.type="button",S.addEventListener("click",C),S},ul.prototype._setButtonTitle=function(x,C){var S=this._map._getUIString("NavigationControl."+C);x.title=S,x.setAttribute("aria-label",S)};var Fs=function(x,C,S){S===void 0&&(S=!1),this._clickTolerance=10,this.element=C,this.mouseRotate=new Cc({clickTolerance:x.dragRotate._mouseRotate._clickTolerance}),this.map=x,S&&(this.mousePitch=new Cf({clickTolerance:x.dragRotate._mousePitch._clickTolerance})),I.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),K.addEventListener(C,"mousedown",this.mousedown),K.addEventListener(C,"touchstart",this.touchstart,{passive:!1}),K.addEventListener(C,"touchmove",this.touchmove),K.addEventListener(C,"touchend",this.touchend),K.addEventListener(C,"touchcancel",this.reset)};function Ms(x,C,S){if(x=new I.LngLat(x.lng,x.lat),C){var M=new I.LngLat(x.lng-360,x.lat),z=new I.LngLat(x.lng+360,x.lat),H=S.locationPoint(x).distSqr(C);S.locationPoint(M).distSqr(C)<H?x=M:S.locationPoint(z).distSqr(C)<H&&(x=z)}for(;Math.abs(x.lng-S.center.lng)>180;){var $=S.locationPoint(x);if($.x>=0&&$.y>=0&&$.x<=S.width&&$.y<=S.height)break;x.lng>S.center.lng?x.lng-=360:x.lng+=360}return x}Fs.prototype.down=function(x,C){this.mouseRotate.mousedown(x,C),this.mousePitch&&this.mousePitch.mousedown(x,C),K.disableDrag()},Fs.prototype.move=function(x,C){var S=this.map,M=this.mouseRotate.mousemoveWindow(x,C);if(M&&M.bearingDelta&&S.setBearing(S.getBearing()+M.bearingDelta),this.mousePitch){var z=this.mousePitch.mousemoveWindow(x,C);z&&z.pitchDelta&&S.setPitch(S.getPitch()+z.pitchDelta)}},Fs.prototype.off=function(){var x=this.element;K.removeEventListener(x,"mousedown",this.mousedown),K.removeEventListener(x,"touchstart",this.touchstart,{passive:!1}),K.removeEventListener(x,"touchmove",this.touchmove),K.removeEventListener(x,"touchend",this.touchend),K.removeEventListener(x,"touchcancel",this.reset),this.offTemp()},Fs.prototype.offTemp=function(){K.enableDrag(),K.removeEventListener(I.window,"mousemove",this.mousemove),K.removeEventListener(I.window,"mouseup",this.mouseup)},Fs.prototype.mousedown=function(x){this.down(I.extend({},x,{ctrlKey:!0,preventDefault:function(){return x.preventDefault()}}),K.mousePos(this.element,x)),K.addEventListener(I.window,"mousemove",this.mousemove),K.addEventListener(I.window,"mouseup",this.mouseup)},Fs.prototype.mousemove=function(x){this.move(x,K.mousePos(this.element,x))},Fs.prototype.mouseup=function(x){this.mouseRotate.mouseupWindow(x),this.mousePitch&&this.mousePitch.mouseupWindow(x),this.offTemp()},Fs.prototype.touchstart=function(x){x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=K.touchPos(this.element,x.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return x.preventDefault()}},this._startPos))},Fs.prototype.touchmove=function(x){x.targetTouches.length!==1?this.reset():(this._lastPos=K.touchPos(this.element,x.targetTouches)[0],this.move({preventDefault:function(){return x.preventDefault()}},this._lastPos))},Fs.prototype.touchend=function(x){x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Fs.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var $u={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Xc(x,C,S){var M=x.classList;for(var z in $u)M.remove("mapboxgl-"+S+"-anchor-"+z);M.add("mapboxgl-"+S+"-anchor-"+C)}var ll,Wf=function(x){function C(S,M){if(x.call(this),(S instanceof I.window.HTMLElement||M)&&(S=I.extend({element:S},M)),I.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=S&&S.anchor||"center",this._color=S&&S.color||"#3FB1CE",this._scale=S&&S.scale||1,this._draggable=S&&S.draggable||!1,this._clickTolerance=S&&S.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=S&&S.rotation||0,this._rotationAlignment=S&&S.rotationAlignment||"auto",this._pitchAlignment=S&&S.pitchAlignment&&S.pitchAlignment!=="auto"?S.pitchAlignment:this._rotationAlignment,S&&S.element)this._element=S.element,this._offset=I.Point.convert(S&&S.offset||[0,0]);else{this._defaultMarker=!0,this._element=K.create("div"),this._element.setAttribute("aria-label","Map marker");var z=K.createNS("http://www.w3.org/2000/svg","svg");z.setAttributeNS(null,"display","block"),z.setAttributeNS(null,"height","41px"),z.setAttributeNS(null,"width","27px"),z.setAttributeNS(null,"viewBox","0 0 27 41");var H=K.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"stroke","none"),H.setAttributeNS(null,"stroke-width","1"),H.setAttributeNS(null,"fill","none"),H.setAttributeNS(null,"fill-rule","evenodd");var $=K.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"fill-rule","nonzero");var ft=K.createNS("http://www.w3.org/2000/svg","g");ft.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ft.setAttributeNS(null,"fill","#000000");for(var zt=0,ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];zt<ee.length;zt+=1){var Re=ee[zt],De=K.createNS("http://www.w3.org/2000/svg","ellipse");De.setAttributeNS(null,"opacity","0.04"),De.setAttributeNS(null,"cx","10.5"),De.setAttributeNS(null,"cy","5.80029008"),De.setAttributeNS(null,"rx",Re.rx),De.setAttributeNS(null,"ry",Re.ry),ft.appendChild(De)}var ke=K.createNS("http://www.w3.org/2000/svg","g");ke.setAttributeNS(null,"fill",this._color);var cr=K.createNS("http://www.w3.org/2000/svg","path");cr.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ke.appendChild(cr);var ar=K.createNS("http://www.w3.org/2000/svg","g");ar.setAttributeNS(null,"opacity","0.25"),ar.setAttributeNS(null,"fill","#000000");var br=K.createNS("http://www.w3.org/2000/svg","path");br.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ar.appendChild(br);var rr=K.createNS("http://www.w3.org/2000/svg","g");rr.setAttributeNS(null,"transform","translate(6.0, 7.0)"),rr.setAttributeNS(null,"fill","#FFFFFF");var xr=K.createNS("http://www.w3.org/2000/svg","g");xr.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Pr=K.createNS("http://www.w3.org/2000/svg","circle");Pr.setAttributeNS(null,"fill","#000000"),Pr.setAttributeNS(null,"opacity","0.25"),Pr.setAttributeNS(null,"cx","5.5"),Pr.setAttributeNS(null,"cy","5.5"),Pr.setAttributeNS(null,"r","5.4999962");var Rr=K.createNS("http://www.w3.org/2000/svg","circle");Rr.setAttributeNS(null,"fill","#FFFFFF"),Rr.setAttributeNS(null,"cx","5.5"),Rr.setAttributeNS(null,"cy","5.5"),Rr.setAttributeNS(null,"r","5.4999962"),xr.appendChild(Pr),xr.appendChild(Rr),$.appendChild(ft),$.appendChild(ke),$.appendChild(ar),$.appendChild(rr),$.appendChild(xr),z.appendChild($),z.setAttributeNS(null,"height",41*this._scale+"px"),z.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(z),this._offset=I.Point.convert(S&&S.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(vn){vn.preventDefault()}),this._element.addEventListener("mousedown",function(vn){vn.preventDefault()}),Xc(this._element,this._anchor,"marker"),this._popup=null}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.addTo=function(S){return this.remove(),this._map=S,S.getCanvasContainer().appendChild(this._element),S.on("move",this._update),S.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},C.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),K.remove(this._element),this._popup&&this._popup.remove(),this},C.prototype.getLngLat=function(){return this._lngLat},C.prototype.setLngLat=function(S){return this._lngLat=I.LngLat.convert(S),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},C.prototype.getElement=function(){return this._element},C.prototype.setPopup=function(S){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),S){if(!("offset"in S.options)){var M=Math.sqrt(Math.pow(13.5,2)/2);S.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[M,-1*(24.6+M)],"bottom-right":[-M,-1*(24.6+M)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=S,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},C.prototype._onKeyPress=function(S){var M=S.code,z=S.charCode||S.keyCode;M!=="Space"&&M!=="Enter"&&z!==32&&z!==13||this.togglePopup()},C.prototype._onMapClick=function(S){var M=S.originalEvent.target,z=this._element;this._popup&&(M===z||z.contains(M))&&this.togglePopup()},C.prototype.getPopup=function(){return this._popup},C.prototype.togglePopup=function(){var S=this._popup;return S?(S.isOpen()?S.remove():S.addTo(this._map),this):this},C.prototype._update=function(S){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ms(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var M="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?M="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(M="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var z="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?z="rotateX(0deg)":this._pitchAlignment==="map"&&(z="rotateX("+this._map.getPitch()+"deg)"),S&&S.type!=="moveend"||(this._pos=this._pos.round()),K.setTransform(this._element,$u[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+z+" "+M)}},C.prototype.getOffset=function(){return this._offset},C.prototype.setOffset=function(S){return this._offset=I.Point.convert(S),this._update(),this},C.prototype._onMove=function(S){if(!this._isDragging){var M=this._clickTolerance||this._map._clickTolerance;this._isDragging=S.point.dist(this._pointerdownPos)>=M}this._isDragging&&(this._pos=S.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new I.Event("dragstart"))),this.fire(new I.Event("drag")))},C.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new I.Event("dragend")),this._state="inactive"},C.prototype._addDragHandler=function(S){this._element.contains(S.originalEvent.target)&&(S.preventDefault(),this._positionDelta=S.point.sub(this._pos).add(this._offset),this._pointerdownPos=S.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},C.prototype.setDraggable=function(S){return this._draggable=!!S,this._map&&(S?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},C.prototype.isDraggable=function(){return this._draggable},C.prototype.setRotation=function(S){return this._rotation=S||0,this._update(),this},C.prototype.getRotation=function(){return this._rotation},C.prototype.setRotationAlignment=function(S){return this._rotationAlignment=S||"auto",this._update(),this},C.prototype.getRotationAlignment=function(){return this._rotationAlignment},C.prototype.setPitchAlignment=function(S){return this._pitchAlignment=S&&S!=="auto"?S:this._rotationAlignment,this._update(),this},C.prototype.getPitchAlignment=function(){return this._pitchAlignment},C}(I.Evented),Mc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},mh=0,Xf=!1,Sd=function(x){function C(S){x.call(this),this.options=I.extend({},Mc,S),I.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.onAdd=function(S){var M;return this._map=S,this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),M=this._setupUI,ll!==void 0?M(ll):I.window.navigator.permissions!==void 0?I.window.navigator.permissions.query({name:"geolocation"}).then(function(z){M(ll=z.state!=="denied")}):M(ll=!!I.window.navigator.geolocation),this._container},C.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(I.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),K.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,mh=0,Xf=!1},C.prototype._isOutOfMapMaxBounds=function(S){var M=this._map.getMaxBounds(),z=S.coords;return M&&(z.longitude<M.getWest()||z.longitude>M.getEast()||z.latitude<M.getSouth()||z.latitude>M.getNorth())},C.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},C.prototype._onSuccess=function(S){if(this._map){if(this._isOutOfMapMaxBounds(S))return this._setErrorState(),this.fire(new I.Event("outofmaxbounds",S)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=S,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(S),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(S),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new I.Event("geolocate",S)),this._finish()}},C.prototype._updateCamera=function(S){var M=new I.LngLat(S.coords.longitude,S.coords.latitude),z=S.coords.accuracy,H=this._map.getBearing(),$=I.extend({bearing:H},this.options.fitBoundsOptions);this._map.fitBounds(M.toBounds(z),$,{geolocateSource:!0})},C.prototype._updateMarker=function(S){if(S){var M=new I.LngLat(S.coords.longitude,S.coords.latitude);this._accuracyCircleMarker.setLngLat(M).addTo(this._map),this._userLocationDotMarker.setLngLat(M).addTo(this._map),this._accuracy=S.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},C.prototype._updateCircleRadius=function(){var S=this._map._container.clientHeight/2,M=this._map.unproject([0,S]),z=this._map.unproject([1,S]),H=M.distanceTo(z),$=Math.ceil(2*this._accuracy/H);this._circleElement.style.width=$+"px",this._circleElement.style.height=$+"px"},C.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},C.prototype._onError=function(S){if(this._map){if(this.options.trackUserLocation)if(S.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var M=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=M,this._geolocateButton.setAttribute("aria-label",M),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(S.code===3&&Xf)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new I.Event("error",S)),this._finish()}},C.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},C.prototype._setupUI=function(S){var M=this;if(this._container.addEventListener("contextmenu",function($){return $.preventDefault()}),this._geolocateButton=K.create("button","mapboxgl-ctrl-geolocate",this._container),K.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",S===!1){I.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var z=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=z,this._geolocateButton.setAttribute("aria-label",z)}else{var H=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=H,this._geolocateButton.setAttribute("aria-label",H)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=K.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Wf(this._dotElement),this._circleElement=K.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function($){$.geolocateSource||M._watchState!=="ACTIVE_LOCK"||$.originalEvent&&$.originalEvent.type==="resize"||(M._watchState="BACKGROUND",M._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),M._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),M.fire(new I.Event("trackuserlocationend")))})},C.prototype.trigger=function(){if(!this._setup)return I.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new I.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":mh--,Xf=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new I.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new I.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var S;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++mh>1?(S={maximumAge:6e5,timeout:0},Xf=!0):(S=this.options.positionOptions,Xf=!1),this._geolocationWatchID=I.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,S)}}else I.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},C.prototype._clearWatch=function(){I.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},C}(I.Evented),Rs={maxWidth:100,unit:"metric"},Ic=function(x){this.options=I.extend({},Rs,x),I.bindAll(["_onMove","setUnit"],this)};function ap(x,C,S){var M=S&&S.maxWidth||100,z=x._container.clientHeight/2,H=x.unproject([0,z]),$=x.unproject([M,z]),ft=H.distanceTo($);if(S&&S.unit==="imperial"){var zt=3.2808*ft;zt>5280?bl(C,M,zt/5280,x._getUIString("ScaleControl.Miles")):bl(C,M,zt,x._getUIString("ScaleControl.Feet"))}else S&&S.unit==="nautical"?bl(C,M,ft/1852,x._getUIString("ScaleControl.NauticalMiles")):ft>=1e3?bl(C,M,ft/1e3,x._getUIString("ScaleControl.Kilometers")):bl(C,M,ft,x._getUIString("ScaleControl.Meters"))}function bl(x,C,S,M){var z,H,$,ft=(z=S,(H=Math.pow(10,(""+Math.floor(z)).length-1))*($=($=z/H)>=10?10:$>=5?5:$>=3?3:$>=2?2:$>=1?1:function(zt){var ee=Math.pow(10,Math.ceil(-Math.log(zt)/Math.LN10));return Math.round(zt*ee)/ee}($)));x.style.width=C*(ft/S)+"px",x.innerHTML=ft+"&nbsp;"+M}Ic.prototype.getDefaultPosition=function(){return"bottom-left"},Ic.prototype._onMove=function(){ap(this._map,this._container,this.options)},Ic.prototype.onAdd=function(x){return this._map=x,this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ic.prototype.onRemove=function(){K.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ic.prototype.setUnit=function(x){this.options.unit=x,ap(this._map,this._container,this.options)};var zl=function(x){this._fullscreen=!1,x&&x.container&&(x.container instanceof I.window.HTMLElement?this._container=x.container:I.warnOnce("Full screen control 'container' must be a DOM element.")),I.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in I.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in I.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in I.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in I.window.document&&(this._fullscreenchange="MSFullscreenChange")};zl.prototype.onAdd=function(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",I.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},zl.prototype.onRemove=function(){K.remove(this._controlContainer),this._map=null,I.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},zl.prototype._checkFullscreenSupport=function(){return!!(I.window.document.fullscreenEnabled||I.window.document.mozFullScreenEnabled||I.window.document.msFullscreenEnabled||I.window.document.webkitFullscreenEnabled)},zl.prototype._setupUI=function(){var x=this._fullscreenButton=K.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);K.create("span","mapboxgl-ctrl-icon",x).setAttribute("aria-hidden",!0),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),I.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},zl.prototype._updateTitle=function(){var x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.title=x},zl.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},zl.prototype._isFullscreen=function(){return this._fullscreen},zl.prototype._changeIcon=function(){(I.window.document.fullscreenElement||I.window.document.mozFullScreenElement||I.window.document.webkitFullscreenElement||I.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},zl.prototype._onClickFullscreen=function(){this._isFullscreen()?I.window.document.exitFullscreen?I.window.document.exitFullscreen():I.window.document.mozCancelFullScreen?I.window.document.mozCancelFullScreen():I.window.document.msExitFullscreen?I.window.document.msExitFullscreen():I.window.document.webkitCancelFullScreen&&I.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var op={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},pc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),zp=function(x){function C(S){x.call(this),this.options=I.extend(Object.create(op),S),I.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.addTo=function(S){return this._map&&this.remove(),this._map=S,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new I.Event("open")),this},C.prototype.isOpen=function(){return!!this._map},C.prototype.remove=function(){return this._content&&K.remove(this._content),this._container&&(K.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new I.Event("close")),this},C.prototype.getLngLat=function(){return this._lngLat},C.prototype.setLngLat=function(S){return this._lngLat=I.LngLat.convert(S),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},C.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},C.prototype.getElement=function(){return this._container},C.prototype.setText=function(S){return this.setDOMContent(I.window.document.createTextNode(S))},C.prototype.setHTML=function(S){var M,z=I.window.document.createDocumentFragment(),H=I.window.document.createElement("body");for(H.innerHTML=S;M=H.firstChild;)z.appendChild(M);return this.setDOMContent(z)},C.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},C.prototype.setMaxWidth=function(S){return this.options.maxWidth=S,this._update(),this},C.prototype.setDOMContent=function(S){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=K.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(S),this._createCloseButton(),this._update(),this._focusFirstElement(),this},C.prototype.addClassName=function(S){this._container&&this._container.classList.add(S)},C.prototype.removeClassName=function(S){this._container&&this._container.classList.remove(S)},C.prototype.setOffset=function(S){return this.options.offset=S,this._update(),this},C.prototype.toggleClassName=function(S){if(this._container)return this._container.classList.toggle(S)},C.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=K.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},C.prototype._onMouseUp=function(S){this._update(S.point)},C.prototype._onMouseMove=function(S){this._update(S.point)},C.prototype._onDrag=function(S){this._update(S.point)},C.prototype._update=function(S){var M=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=K.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=K.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(De){return M._container.classList.add(De)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ms(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||S)){var z=this._pos=this._trackPointer&&S?S:this._map.project(this._lngLat),H=this.options.anchor,$=function De(ke){if(ke){if(typeof ke=="number"){var cr=Math.round(Math.sqrt(.5*Math.pow(ke,2)));return{center:new I.Point(0,0),top:new I.Point(0,ke),"top-left":new I.Point(cr,cr),"top-right":new I.Point(-cr,cr),bottom:new I.Point(0,-ke),"bottom-left":new I.Point(cr,-cr),"bottom-right":new I.Point(-cr,-cr),left:new I.Point(ke,0),right:new I.Point(-ke,0)}}if(ke instanceof I.Point||Array.isArray(ke)){var ar=I.Point.convert(ke);return{center:ar,top:ar,"top-left":ar,"top-right":ar,bottom:ar,"bottom-left":ar,"bottom-right":ar,left:ar,right:ar}}return{center:I.Point.convert(ke.center||[0,0]),top:I.Point.convert(ke.top||[0,0]),"top-left":I.Point.convert(ke["top-left"]||[0,0]),"top-right":I.Point.convert(ke["top-right"]||[0,0]),bottom:I.Point.convert(ke.bottom||[0,0]),"bottom-left":I.Point.convert(ke["bottom-left"]||[0,0]),"bottom-right":I.Point.convert(ke["bottom-right"]||[0,0]),left:I.Point.convert(ke.left||[0,0]),right:I.Point.convert(ke.right||[0,0])}}return De(new I.Point(0,0))}(this.options.offset);if(!H){var ft,zt=this._container.offsetWidth,ee=this._container.offsetHeight;ft=z.y+$.bottom.y<ee?["top"]:z.y>this._map.transform.height-ee?["bottom"]:[],z.x<zt/2?ft.push("left"):z.x>this._map.transform.width-zt/2&&ft.push("right"),H=ft.length===0?"bottom":ft.join("-")}var Re=z.add($[H]).round();K.setTransform(this._container,$u[H]+" translate("+Re.x+"px,"+Re.y+"px)"),Xc(this._container,H,"popup")}},C.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var S=this._container.querySelector(pc);S&&S.focus()}},C.prototype._onClose=function(){this.remove()},C}(I.Evented),Yc={version:I.version,supported:xt,setRTLTextPlugin:I.setRTLTextPlugin,getRTLTextPluginStatus:I.getRTLTextPluginStatus,Map:ip,NavigationControl:ul,GeolocateControl:Sd,AttributionControl:ol,ScaleControl:Ic,FullscreenControl:zl,Popup:zp,Marker:Wf,Style:Fu,LngLat:I.LngLat,LngLatBounds:I.LngLatBounds,Point:I.Point,MercatorCoordinate:I.MercatorCoordinate,Evented:I.Evented,config:I.config,prewarm:function(){Kr().acquire(Qr)},clearPrewarmedResources:function(){var x=bi;x&&(x.isPreloaded()&&x.numActive()===1?(x.release(Qr),bi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return I.config.ACCESS_TOKEN},set accessToken(x){I.config.ACCESS_TOKEN=x},get baseApiUrl(){return I.config.API_URL},set baseApiUrl(x){I.config.API_URL=x},get workerCount(){return Mn.workerCount},set workerCount(x){Mn.workerCount=x},get maxParallelImageRequests(){return I.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(x){I.config.MAX_PARALLEL_IMAGE_REQUESTS=x},clearStorage:function(x){I.clearTileCache(x)},workerUrl:""};return Yc}),kt})},3614:function(gn,Ot,ot){"use strict";gn.exports=bt;var kt=ot(80645);function bt(Lt){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Lt)?Lt:new Uint8Array(Lt||0),this.pos=0,this.type=0,this.length=this.buf.length}bt.Varint=0,bt.Fixed64=1,bt.Bytes=2,bt.Fixed32=5;var I=(1<<16)*(1<<16),xt=1/I,K=12,ut=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");bt.prototype={destroy:function(){this.buf=null},readFields:function(Lt,Qt,ct){for(ct=ct||this.length;this.pos<ct;){var Ct=this.readVarint(),Y=Ct>>3,yt=this.pos;this.type=Ct&7,Lt(Y,Qt,this),this.pos===yt&&this.skip(Ct)}return Qt},readMessage:function(Lt,Qt){return this.readFields(Lt,Qt,this.readVarint()+this.pos)},readFixed32:function(){var Lt=we(this.buf,this.pos);return this.pos+=4,Lt},readSFixed32:function(){var Lt=ge(this.buf,this.pos);return this.pos+=4,Lt},readFixed64:function(){var Lt=we(this.buf,this.pos)+we(this.buf,this.pos+4)*I;return this.pos+=8,Lt},readSFixed64:function(){var Lt=we(this.buf,this.pos)+ge(this.buf,this.pos+4)*I;return this.pos+=8,Lt},readFloat:function(){var Lt=kt.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Lt},readDouble:function(){var Lt=kt.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Lt},readVarint:function(Lt){var Qt=this.buf,ct,Ct;return Ct=Qt[this.pos++],ct=Ct&127,Ct<128||(Ct=Qt[this.pos++],ct|=(Ct&127)<<7,Ct<128)||(Ct=Qt[this.pos++],ct|=(Ct&127)<<14,Ct<128)||(Ct=Qt[this.pos++],ct|=(Ct&127)<<21,Ct<128)?ct:(Ct=Qt[this.pos],ct|=(Ct&15)<<28,ht(ct,Lt,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Lt=this.readVarint();return Lt%2===1?(Lt+1)/-2:Lt/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var Lt=this.readVarint()+this.pos,Qt=this.pos;return this.pos=Lt,Lt-Qt>=K&&ut?xe(this.buf,Qt,Lt):te(this.buf,Qt,Lt)},readBytes:function(){var Lt=this.readVarint()+this.pos,Qt=this.buf.subarray(this.pos,Lt);return this.pos=Lt,Qt},readPackedVarint:function(Lt,Qt){if(this.type!==bt.Bytes)return Lt.push(this.readVarint(Qt));var ct=lt(this);for(Lt=Lt||[];this.pos<ct;)Lt.push(this.readVarint(Qt));return Lt},readPackedSVarint:function(Lt){if(this.type!==bt.Bytes)return Lt.push(this.readSVarint());var Qt=lt(this);for(Lt=Lt||[];this.pos<Qt;)Lt.push(this.readSVarint());return Lt},readPackedBoolean:function(Lt){if(this.type!==bt.Bytes)return Lt.push(this.readBoolean());var Qt=lt(this);for(Lt=Lt||[];this.pos<Qt;)Lt.push(this.readBoolean());return Lt},readPackedFloat:function(Lt){if(this.type!==bt.Bytes)return Lt.push(this.readFloat());var Qt=lt(this);for(Lt=Lt||[];this.pos<Qt;)Lt.push(this.readFloat());return Lt},readPackedDouble:function(Lt){if(this.type!==bt.Bytes)return Lt.push(this.readDouble());var Qt=lt(this);for(Lt=Lt||[];this.pos<Qt;)Lt.push(this.readDouble());return Lt},readPackedFixed32:function(Lt){if(this.type!==bt.Bytes)return Lt.push(this.readFixed32());var Qt=lt(this);for(Lt=Lt||[];this.pos<Qt;)Lt.push(this.readFixed32());return Lt},readPackedSFixed32:function(Lt){if(this.type!==bt.Bytes)return Lt.push(this.readSFixed32());var Qt=lt(this);for(Lt=Lt||[];this.pos<Qt;)Lt.push(this.readSFixed32());return Lt},readPackedFixed64:function(Lt){if(this.type!==bt.Bytes)return Lt.push(this.readFixed64());var Qt=lt(this);for(Lt=Lt||[];this.pos<Qt;)Lt.push(this.readFixed64());return Lt},readPackedSFixed64:function(Lt){if(this.type!==bt.Bytes)return Lt.push(this.readSFixed64());var Qt=lt(this);for(Lt=Lt||[];this.pos<Qt;)Lt.push(this.readSFixed64());return Lt},skip:function(Lt){var Qt=Lt&7;if(Qt===bt.Varint)for(;this.buf[this.pos++]>127;);else if(Qt===bt.Bytes)this.pos=this.readVarint()+this.pos;else if(Qt===bt.Fixed32)this.pos+=4;else if(Qt===bt.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Qt)},writeTag:function(Lt,Qt){this.writeVarint(Lt<<3|Qt)},realloc:function(Lt){for(var Qt=this.length||16;Qt<this.pos+Lt;)Qt*=2;if(Qt!==this.length){var ct=new Uint8Array(Qt);ct.set(this.buf),this.buf=ct,this.length=Qt}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Lt){this.realloc(4),_e(this.buf,Lt,this.pos),this.pos+=4},writeSFixed32:function(Lt){this.realloc(4),_e(this.buf,Lt,this.pos),this.pos+=4},writeFixed64:function(Lt){this.realloc(8),_e(this.buf,Lt&-1,this.pos),_e(this.buf,Math.floor(Lt*xt),this.pos+4),this.pos+=8},writeSFixed64:function(Lt){this.realloc(8),_e(this.buf,Lt&-1,this.pos),_e(this.buf,Math.floor(Lt*xt),this.pos+4),this.pos+=8},writeVarint:function(Lt){if(Lt=+Lt||0,Lt>268435455||Lt<0){be(Lt,this);return}this.realloc(4),this.buf[this.pos++]=Lt&127|(Lt>127?128:0),!(Lt<=127)&&(this.buf[this.pos++]=(Lt>>>=7)&127|(Lt>127?128:0),!(Lt<=127)&&(this.buf[this.pos++]=(Lt>>>=7)&127|(Lt>127?128:0),!(Lt<=127)&&(this.buf[this.pos++]=Lt>>>7&127)))},writeSVarint:function(Lt){this.writeVarint(Lt<0?-Lt*2-1:Lt*2)},writeBoolean:function(Lt){this.writeVarint(Boolean(Lt))},writeString:function(Lt){Lt=String(Lt),this.realloc(Lt.length*4),this.pos++;var Qt=this.pos;this.pos=Ye(this.buf,Lt,this.pos);var ct=this.pos-Qt;ct>=128&&Ut(Qt,ct,this),this.pos=Qt-1,this.writeVarint(ct),this.pos+=ct},writeFloat:function(Lt){this.realloc(4),kt.write(this.buf,Lt,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Lt){this.realloc(8),kt.write(this.buf,Lt,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Lt){var Qt=Lt.length;this.writeVarint(Qt),this.realloc(Qt);for(var ct=0;ct<Qt;ct++)this.buf[this.pos++]=Lt[ct]},writeRawMessage:function(Lt,Qt){this.pos++;var ct=this.pos;Lt(Qt,this);var Ct=this.pos-ct;Ct>=128&&Ut(ct,Ct,this),this.pos=ct-1,this.writeVarint(Ct),this.pos+=Ct},writeMessage:function(Lt,Qt,ct){this.writeTag(Lt,bt.Bytes),this.writeRawMessage(Qt,ct)},writePackedVarint:function(Lt,Qt){Qt.length&&this.writeMessage(Lt,P,Qt)},writePackedSVarint:function(Lt,Qt){Qt.length&&this.writeMessage(Lt,b,Qt)},writePackedBoolean:function(Lt,Qt){Qt.length&&this.writeMessage(Lt,Ee,Qt)},writePackedFloat:function(Lt,Qt){Qt.length&&this.writeMessage(Lt,W,Qt)},writePackedDouble:function(Lt,Qt){Qt.length&&this.writeMessage(Lt,fe,Qt)},writePackedFixed32:function(Lt,Qt){Qt.length&&this.writeMessage(Lt,Te,Qt)},writePackedSFixed32:function(Lt,Qt){Qt.length&&this.writeMessage(Lt,Mt,Qt)},writePackedFixed64:function(Lt,Qt){Qt.length&&this.writeMessage(Lt,et,Qt)},writePackedSFixed64:function(Lt,Qt){Qt.length&&this.writeMessage(Lt,Dt,Qt)},writeBytesField:function(Lt,Qt){this.writeTag(Lt,bt.Bytes),this.writeBytes(Qt)},writeFixed32Field:function(Lt,Qt){this.writeTag(Lt,bt.Fixed32),this.writeFixed32(Qt)},writeSFixed32Field:function(Lt,Qt){this.writeTag(Lt,bt.Fixed32),this.writeSFixed32(Qt)},writeFixed64Field:function(Lt,Qt){this.writeTag(Lt,bt.Fixed64),this.writeFixed64(Qt)},writeSFixed64Field:function(Lt,Qt){this.writeTag(Lt,bt.Fixed64),this.writeSFixed64(Qt)},writeVarintField:function(Lt,Qt){this.writeTag(Lt,bt.Varint),this.writeVarint(Qt)},writeSVarintField:function(Lt,Qt){this.writeTag(Lt,bt.Varint),this.writeSVarint(Qt)},writeStringField:function(Lt,Qt){this.writeTag(Lt,bt.Bytes),this.writeString(Qt)},writeFloatField:function(Lt,Qt){this.writeTag(Lt,bt.Fixed32),this.writeFloat(Qt)},writeDoubleField:function(Lt,Qt){this.writeTag(Lt,bt.Fixed64),this.writeDouble(Qt)},writeBooleanField:function(Lt,Qt){this.writeVarintField(Lt,Boolean(Qt))}};function ht(Lt,Qt,ct){var Ct=ct.buf,Y,yt;if(yt=Ct[ct.pos++],Y=(yt&112)>>4,yt<128||(yt=Ct[ct.pos++],Y|=(yt&127)<<3,yt<128)||(yt=Ct[ct.pos++],Y|=(yt&127)<<10,yt<128)||(yt=Ct[ct.pos++],Y|=(yt&127)<<17,yt<128)||(yt=Ct[ct.pos++],Y|=(yt&127)<<24,yt<128)||(yt=Ct[ct.pos++],Y|=(yt&1)<<31,yt<128))return tt(Lt,Y,Qt);throw new Error("Expected varint not more than 10 bytes")}function lt(Lt){return Lt.type===bt.Bytes?Lt.readVarint()+Lt.pos:Lt.pos+1}function tt(Lt,Qt,ct){return ct?Qt*4294967296+(Lt>>>0):(Qt>>>0)*4294967296+(Lt>>>0)}function be(Lt,Qt){var ct,Ct;if(Lt>=0?(ct=Lt%4294967296|0,Ct=Lt/4294967296|0):(ct=~(-Lt%4294967296),Ct=~(-Lt/4294967296),ct^4294967295?ct=ct+1|0:(ct=0,Ct=Ct+1|0)),Lt>=18446744073709552e3||Lt<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Qt.realloc(10),it(ct,Ct,Qt),st(Ct,Qt)}function it(Lt,Qt,ct){ct.buf[ct.pos++]=Lt&127|128,Lt>>>=7,ct.buf[ct.pos++]=Lt&127|128,Lt>>>=7,ct.buf[ct.pos++]=Lt&127|128,Lt>>>=7,ct.buf[ct.pos++]=Lt&127|128,Lt>>>=7,ct.buf[ct.pos]=Lt&127}function st(Lt,Qt){var ct=(Lt&7)<<4;Qt.buf[Qt.pos++]|=ct|((Lt>>>=3)?128:0),Lt&&(Qt.buf[Qt.pos++]=Lt&127|((Lt>>>=7)?128:0),Lt&&(Qt.buf[Qt.pos++]=Lt&127|((Lt>>>=7)?128:0),Lt&&(Qt.buf[Qt.pos++]=Lt&127|((Lt>>>=7)?128:0),Lt&&(Qt.buf[Qt.pos++]=Lt&127|((Lt>>>=7)?128:0),Lt&&(Qt.buf[Qt.pos++]=Lt&127)))))}function Ut(Lt,Qt,ct){var Ct=Qt<=16383?1:Qt<=2097151?2:Qt<=268435455?3:Math.floor(Math.log(Qt)/(Math.LN2*7));ct.realloc(Ct);for(var Y=ct.pos-1;Y>=Lt;Y--)ct.buf[Y+Ct]=ct.buf[Y]}function P(Lt,Qt){for(var ct=0;ct<Lt.length;ct++)Qt.writeVarint(Lt[ct])}function b(Lt,Qt){for(var ct=0;ct<Lt.length;ct++)Qt.writeSVarint(Lt[ct])}function W(Lt,Qt){for(var ct=0;ct<Lt.length;ct++)Qt.writeFloat(Lt[ct])}function fe(Lt,Qt){for(var ct=0;ct<Lt.length;ct++)Qt.writeDouble(Lt[ct])}function Ee(Lt,Qt){for(var ct=0;ct<Lt.length;ct++)Qt.writeBoolean(Lt[ct])}function Te(Lt,Qt){for(var ct=0;ct<Lt.length;ct++)Qt.writeFixed32(Lt[ct])}function Mt(Lt,Qt){for(var ct=0;ct<Lt.length;ct++)Qt.writeSFixed32(Lt[ct])}function et(Lt,Qt){for(var ct=0;ct<Lt.length;ct++)Qt.writeFixed64(Lt[ct])}function Dt(Lt,Qt){for(var ct=0;ct<Lt.length;ct++)Qt.writeSFixed64(Lt[ct])}function we(Lt,Qt){return(Lt[Qt]|Lt[Qt+1]<<8|Lt[Qt+2]<<16)+Lt[Qt+3]*16777216}function _e(Lt,Qt,ct){Lt[ct]=Qt,Lt[ct+1]=Qt>>>8,Lt[ct+2]=Qt>>>16,Lt[ct+3]=Qt>>>24}function ge(Lt,Qt){return(Lt[Qt]|Lt[Qt+1]<<8|Lt[Qt+2]<<16)+(Lt[Qt+3]<<24)}function te(Lt,Qt,ct){for(var Ct="",Y=Qt;Y<ct;){var yt=Lt[Y],Xt=null,ie=yt>239?4:yt>223?3:yt>191?2:1;if(Y+ie>ct)break;var Ce,er,Ht;ie===1?yt<128&&(Xt=yt):ie===2?(Ce=Lt[Y+1],(Ce&192)===128&&(Xt=(yt&31)<<6|Ce&63,Xt<=127&&(Xt=null))):ie===3?(Ce=Lt[Y+1],er=Lt[Y+2],(Ce&192)===128&&(er&192)===128&&(Xt=(yt&15)<<12|(Ce&63)<<6|er&63,(Xt<=2047||Xt>=55296&&Xt<=57343)&&(Xt=null))):ie===4&&(Ce=Lt[Y+1],er=Lt[Y+2],Ht=Lt[Y+3],(Ce&192)===128&&(er&192)===128&&(Ht&192)===128&&(Xt=(yt&15)<<18|(Ce&63)<<12|(er&63)<<6|Ht&63,(Xt<=65535||Xt>=1114112)&&(Xt=null))),Xt===null?(Xt=65533,ie=1):Xt>65535&&(Xt-=65536,Ct+=String.fromCharCode(Xt>>>10&1023|55296),Xt=56320|Xt&1023),Ct+=String.fromCharCode(Xt),Y+=ie}return Ct}function xe(Lt,Qt,ct){return ut.decode(Lt.subarray(Qt,ct))}function Ye(Lt,Qt,ct){for(var Ct=0,Y,yt;Ct<Qt.length;Ct++){if(Y=Qt.charCodeAt(Ct),Y>55295&&Y<57344)if(yt)if(Y<56320){Lt[ct++]=239,Lt[ct++]=191,Lt[ct++]=189,yt=Y;continue}else Y=yt-55296<<10|Y-56320|65536,yt=null;else{Y>56319||Ct+1===Qt.length?(Lt[ct++]=239,Lt[ct++]=191,Lt[ct++]=189):yt=Y;continue}else yt&&(Lt[ct++]=239,Lt[ct++]=191,Lt[ct++]=189,yt=null);Y<128?Lt[ct++]=Y:(Y<2048?Lt[ct++]=Y>>6|192:(Y<65536?Lt[ct++]=Y>>12|224:(Lt[ct++]=Y>>18|240,Lt[ct++]=Y>>12&63|128),Lt[ct++]=Y>>6&63|128),Lt[ct++]=Y&63|128)}return ct}},73807:function(gn){"use strict";var Ot=gn.exports;gn.exports.isNumber=function(ot){return typeof ot=="number"},gn.exports.findMin=function(ot){if(ot.length===0)return 1/0;for(var kt=ot[0],bt=1;bt<ot.length;bt++)kt=Math.min(kt,ot[bt]);return kt},gn.exports.findMax=function(ot){if(ot.length===0)return-1/0;for(var kt=ot[0],bt=1;bt<ot.length;bt++)kt=Math.max(kt,ot[bt]);return kt},gn.exports.findMinMulti=function(ot){for(var kt=Ot.findMin(ot[0]),bt=1;bt<ot.length;bt++)kt=Math.min(kt,Ot.findMin(ot[bt]));return kt},gn.exports.findMaxMulti=function(ot){for(var kt=Ot.findMax(ot[0]),bt=1;bt<ot.length;bt++)kt=Math.max(kt,Ot.findMax(ot[bt]));return kt},gn.exports.inside=function(ot,kt,bt){return ot<=bt&&bt<=kt}},53843:function(gn,Ot,ot){"use strict";var kt=50,bt=2,I=Math.log(2),xt=gn.exports,K=ot(73807);function ut(lt){return 1-Math.abs(lt)}gn.exports.getUnifiedMinMax=function(lt,tt){return xt.getUnifiedMinMaxMulti([lt],tt)},gn.exports.getUnifiedMinMaxMulti=function(lt,tt){tt=tt||{};var be=!1,it=!1,st=K.isNumber(tt.width)?tt.width:bt,Ut=K.isNumber(tt.size)?tt.size:kt,P=K.isNumber(tt.min)?tt.min:(be=!0,K.findMinMulti(lt)),b=K.isNumber(tt.max)?tt.max:(it=!0,K.findMaxMulti(lt)),W=b-P,fe=W/(Ut-1);return be&&(P=P-2*st*fe),it&&(b=b+2*st*fe),{min:P,max:b}},gn.exports.create=function(lt,tt){if(tt=tt||{},!lt||lt.length===0)return[];var be=K.isNumber(tt.size)?tt.size:kt,it=K.isNumber(tt.width)?tt.width:bt,st=xt.getUnifiedMinMax(lt,{size:be,width:it,min:tt.min,max:tt.max}),Ut=st.min,P=st.max,b=P-Ut,W=b/(be-1);if(b===0)return[{x:Ut,y:1}];for(var fe=[],Ee=0;Ee<be;Ee++)fe.push({x:Ut+Ee*W,y:0});var Te=function(xe){return Math.floor((xe-Ut)/W)},Mt=ht(ut,it),et=Mt[it],Dt=Mt[it-1]-Mt[it-2],we=0;lt.forEach(function(xe){var Ye=Te(xe);if(!(Ye+it<0||Ye-it>=fe.length)){var Lt=Math.max(Ye-it,0),Qt=Ye,ct=Math.min(Ye+it,fe.length-1),Ct=Lt-(Ye-it),Y=Ye+it-ct,yt=Mt[-it-1+Ct]||0,Xt=Mt[-it-1+Y]||0,ie=et/(et-yt-Xt);Ct>0&&(we+=ie*(Ct-1)*Dt);var Ce=Math.max(0,Ye-it+1);K.inside(0,fe.length-1,Ce)&&(fe[Ce].y+=ie*1*Dt),K.inside(0,fe.length-1,Qt+1)&&(fe[Qt+1].y-=ie*2*Dt),K.inside(0,fe.length-1,ct+1)&&(fe[ct+1].y+=ie*1*Dt)}});var _e=we,ge=0,te=0;return fe.forEach(function(xe){ge+=xe.y,_e+=ge,xe.y=_e,te+=_e}),te>0&&fe.forEach(function(xe){xe.y/=te}),fe};function ht(lt,tt){for(var be={},it=0,st=-tt;st<=tt;st++)it+=lt(st/tt),be[st]=it;return be}gn.exports.getExpectedValueFromPdf=function(lt){if(!(!lt||lt.length===0)){var tt=0;return lt.forEach(function(be){tt+=be.x*be.y}),tt}},gn.exports.getXWithLeftTailArea=function(lt,tt){if(!(!lt||lt.length===0)){for(var be=0,it=0,st=0;st<lt.length&&(it=st,be+=lt[st].y,!(be>=tt));st++);return lt[it].x}},gn.exports.getPerplexity=function(lt){if(!(!lt||lt.length===0)){var tt=0;return lt.forEach(function(be){var it=Math.log(be.y);isFinite(it)&&(tt+=be.y*it)}),tt=-tt/I,Math.pow(2,tt)}}},32676:function(gn,Ot,ot){var kt=ot(34155);(function(bt,I){gn.exports=I()})(this,function(){"use strict";function bt(Nt,wt){if(!(Nt instanceof wt))throw new TypeError("Cannot call a class as a function")}function I(Nt,wt){for(var Tt=0;Tt<wt.length;Tt++){var Ft=wt[Tt];Ft.enumerable=Ft.enumerable||!1,Ft.configurable=!0,"value"in Ft&&(Ft.writable=!0),Object.defineProperty(Nt,Ft.key,Ft)}}function xt(Nt,wt,Tt){return wt&&I(Nt.prototype,wt),Tt&&I(Nt,Tt),Nt}var K=function(){function Nt(wt,Tt){this.next=null,this.key=wt,this.data=Tt,this.left=null,this.right=null}return Nt}();function ut(Nt,wt){return Nt>wt?1:Nt<wt?-1:0}function ht(Nt,wt,Tt){for(var Ft=new K(null,null),J=Ft,gt=Ft;;){var jt=Tt(Nt,wt.key);if(jt<0){if(wt.left===null)break;if(Tt(Nt,wt.left.key)<0){var ve=wt.left;if(wt.left=ve.right,ve.right=wt,wt=ve,wt.left===null)break}gt.left=wt,gt=wt,wt=wt.left}else if(jt>0){if(wt.right===null)break;if(Tt(Nt,wt.right.key)>0){var ve=wt.right;if(wt.right=ve.left,ve.left=wt,wt=ve,wt.right===null)break}J.right=wt,J=wt,wt=wt.right}else break}return J.right=wt.left,gt.left=wt.right,wt.left=Ft.right,wt.right=Ft.left,wt}function lt(Nt,wt,Tt,Ft){var J=new K(Nt,wt);if(Tt===null)return J.left=J.right=null,J;Tt=ht(Nt,Tt,Ft);var gt=Ft(Nt,Tt.key);return gt<0?(J.left=Tt.left,J.right=Tt,Tt.left=null):gt>=0&&(J.right=Tt.right,J.left=Tt,Tt.right=null),J}function tt(Nt,wt,Tt){var Ft=null,J=null;if(wt){wt=ht(Nt,wt,Tt);var gt=Tt(wt.key,Nt);gt===0?(Ft=wt.left,J=wt.right):gt<0?(J=wt.right,wt.right=null,Ft=wt):(Ft=wt.left,wt.left=null,J=wt)}return{left:Ft,right:J}}function be(Nt,wt,Tt){return wt===null?Nt:(Nt===null||(wt=ht(Nt.key,wt,Tt),wt.left=Nt),wt)}function it(Nt,wt,Tt,Ft,J){if(Nt){Ft(""+wt+(Tt?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+J(Nt)+`
`);var gt=wt+(Tt?"    ":"\u2502   ");Nt.left&&it(Nt.left,gt,!1,Ft,J),Nt.right&&it(Nt.right,gt,!0,Ft,J)}}var st=function(){function Nt(wt){wt===void 0&&(wt=ut),this._root=null,this._size=0,this._comparator=wt}return Nt.prototype.insert=function(wt,Tt){return this._size++,this._root=lt(wt,Tt,this._root,this._comparator)},Nt.prototype.add=function(wt,Tt){var Ft=new K(wt,Tt);this._root===null&&(Ft.left=Ft.right=null,this._size++,this._root=Ft);var J=this._comparator,gt=ht(wt,this._root,J),jt=J(wt,gt.key);return jt===0?this._root=gt:(jt<0?(Ft.left=gt.left,Ft.right=gt,gt.left=null):jt>0&&(Ft.right=gt.right,Ft.left=gt,gt.right=null),this._size++,this._root=Ft),this._root},Nt.prototype.remove=function(wt){this._root=this._remove(wt,this._root,this._comparator)},Nt.prototype._remove=function(wt,Tt,Ft){var J;if(Tt===null)return null;Tt=ht(wt,Tt,Ft);var gt=Ft(wt,Tt.key);return gt===0?(Tt.left===null?J=Tt.right:(J=ht(wt,Tt.left,Ft),J.right=Tt.right),this._size--,J):Tt},Nt.prototype.pop=function(){var wt=this._root;if(wt){for(;wt.left;)wt=wt.left;return this._root=ht(wt.key,this._root,this._comparator),this._root=this._remove(wt.key,this._root,this._comparator),{key:wt.key,data:wt.data}}return null},Nt.prototype.findStatic=function(wt){for(var Tt=this._root,Ft=this._comparator;Tt;){var J=Ft(wt,Tt.key);if(J===0)return Tt;J<0?Tt=Tt.left:Tt=Tt.right}return null},Nt.prototype.find=function(wt){return this._root&&(this._root=ht(wt,this._root,this._comparator),this._comparator(wt,this._root.key)!==0)?null:this._root},Nt.prototype.contains=function(wt){for(var Tt=this._root,Ft=this._comparator;Tt;){var J=Ft(wt,Tt.key);if(J===0)return!0;J<0?Tt=Tt.left:Tt=Tt.right}return!1},Nt.prototype.forEach=function(wt,Tt){for(var Ft=this._root,J=[],gt=!1;!gt;)Ft!==null?(J.push(Ft),Ft=Ft.left):J.length!==0?(Ft=J.pop(),wt.call(Tt,Ft),Ft=Ft.right):gt=!0;return this},Nt.prototype.range=function(wt,Tt,Ft,J){for(var gt=[],jt=this._comparator,ve=this._root,Gt;gt.length!==0||ve;)if(ve)gt.push(ve),ve=ve.left;else{if(ve=gt.pop(),Gt=jt(ve.key,Tt),Gt>0)break;if(jt(ve.key,wt)>=0&&Ft.call(J,ve))return this;ve=ve.right}return this},Nt.prototype.keys=function(){var wt=[];return this.forEach(function(Tt){var Ft=Tt.key;return wt.push(Ft)}),wt},Nt.prototype.values=function(){var wt=[];return this.forEach(function(Tt){var Ft=Tt.data;return wt.push(Ft)}),wt},Nt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Nt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Nt.prototype.minNode=function(wt){if(wt===void 0&&(wt=this._root),wt)for(;wt.left;)wt=wt.left;return wt},Nt.prototype.maxNode=function(wt){if(wt===void 0&&(wt=this._root),wt)for(;wt.right;)wt=wt.right;return wt},Nt.prototype.at=function(wt){for(var Tt=this._root,Ft=!1,J=0,gt=[];!Ft;)if(Tt)gt.push(Tt),Tt=Tt.left;else if(gt.length>0){if(Tt=gt.pop(),J===wt)return Tt;J++,Tt=Tt.right}else Ft=!0;return null},Nt.prototype.next=function(wt){var Tt=this._root,Ft=null;if(wt.right){for(Ft=wt.right;Ft.left;)Ft=Ft.left;return Ft}for(var J=this._comparator;Tt;){var gt=J(wt.key,Tt.key);if(gt===0)break;gt<0?(Ft=Tt,Tt=Tt.left):Tt=Tt.right}return Ft},Nt.prototype.prev=function(wt){var Tt=this._root,Ft=null;if(wt.left!==null){for(Ft=wt.left;Ft.right;)Ft=Ft.right;return Ft}for(var J=this._comparator;Tt;){var gt=J(wt.key,Tt.key);if(gt===0)break;gt<0?Tt=Tt.left:(Ft=Tt,Tt=Tt.right)}return Ft},Nt.prototype.clear=function(){return this._root=null,this._size=0,this},Nt.prototype.toList=function(){return b(this._root)},Nt.prototype.load=function(wt,Tt,Ft){Tt===void 0&&(Tt=[]),Ft===void 0&&(Ft=!1);var J=wt.length,gt=this._comparator;if(Ft&&Ee(wt,Tt,0,J-1,gt),this._root===null)this._root=Ut(wt,Tt,0,J),this._size=J;else{var jt=fe(this.toList(),P(wt,Tt),gt);J=this._size+J,this._root=W({head:jt},0,J)}return this},Nt.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Nt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Nt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Nt.prototype.toString=function(wt){wt===void 0&&(wt=function(J){return String(J.key)});var Tt=[];return it(this._root,"",!0,function(Ft){return Tt.push(Ft)},wt),Tt.join("")},Nt.prototype.update=function(wt,Tt,Ft){var J=this._comparator,gt=tt(wt,this._root,J),jt=gt.left,ve=gt.right;J(wt,Tt)<0?ve=lt(Tt,Ft,ve,J):jt=lt(Tt,Ft,jt,J),this._root=be(jt,ve,J)},Nt.prototype.split=function(wt){return tt(wt,this._root,this._comparator)},Nt}();function Ut(Nt,wt,Tt,Ft){var J=Ft-Tt;if(J>0){var gt=Tt+Math.floor(J/2),jt=Nt[gt],ve=wt[gt],Gt=new K(jt,ve);return Gt.left=Ut(Nt,wt,Tt,gt),Gt.right=Ut(Nt,wt,gt+1,Ft),Gt}return null}function P(Nt,wt){for(var Tt=new K(null,null),Ft=Tt,J=0;J<Nt.length;J++)Ft=Ft.next=new K(Nt[J],wt[J]);return Ft.next=null,Tt.next}function b(Nt){for(var wt=Nt,Tt=[],Ft=!1,J=new K(null,null),gt=J;!Ft;)wt?(Tt.push(wt),wt=wt.left):Tt.length>0?(wt=gt=gt.next=Tt.pop(),wt=wt.right):Ft=!0;return gt.next=null,J.next}function W(Nt,wt,Tt){var Ft=Tt-wt;if(Ft>0){var J=wt+Math.floor(Ft/2),gt=W(Nt,wt,J),jt=Nt.head;return jt.left=gt,Nt.head=Nt.head.next,jt.right=W(Nt,J+1,Tt),jt}return null}function fe(Nt,wt,Tt){for(var Ft=new K(null,null),J=Ft,gt=Nt,jt=wt;gt!==null&&jt!==null;)Tt(gt.key,jt.key)<0?(J.next=gt,gt=gt.next):(J.next=jt,jt=jt.next),J=J.next;return gt!==null?J.next=gt:jt!==null&&(J.next=jt),Ft.next}function Ee(Nt,wt,Tt,Ft,J){if(!(Tt>=Ft)){for(var gt=Nt[Tt+Ft>>1],jt=Tt-1,ve=Ft+1;;){do jt++;while(J(Nt[jt],gt)<0);do ve--;while(J(Nt[ve],gt)>0);if(jt>=ve)break;var Gt=Nt[jt];Nt[jt]=Nt[ve],Nt[ve]=Gt,Gt=wt[jt],wt[jt]=wt[ve],wt[ve]=Gt}Ee(Nt,wt,Tt,ve,J),Ee(Nt,wt,ve+1,Ft,J)}}var Te=function(wt,Tt){return wt.ll.x<=Tt.x&&Tt.x<=wt.ur.x&&wt.ll.y<=Tt.y&&Tt.y<=wt.ur.y},Mt=function(wt,Tt){if(Tt.ur.x<wt.ll.x||wt.ur.x<Tt.ll.x||Tt.ur.y<wt.ll.y||wt.ur.y<Tt.ll.y)return null;var Ft=wt.ll.x<Tt.ll.x?Tt.ll.x:wt.ll.x,J=wt.ur.x<Tt.ur.x?wt.ur.x:Tt.ur.x,gt=wt.ll.y<Tt.ll.y?Tt.ll.y:wt.ll.y,jt=wt.ur.y<Tt.ur.y?wt.ur.y:Tt.ur.y;return{ll:{x:Ft,y:gt},ur:{x:J,y:jt}}},et=Number.EPSILON;et===void 0&&(et=Math.pow(2,-52));var Dt=et*et,we=function(wt,Tt){if(-et<wt&&wt<et&&-et<Tt&&Tt<et)return 0;var Ft=wt-Tt;return Ft*Ft<Dt*wt*Tt?0:wt<Tt?-1:1},_e=function(){function Nt(){bt(this,Nt),this.reset()}return xt(Nt,[{key:"reset",value:function(){this.xRounder=new ge,this.yRounder=new ge}},{key:"round",value:function(Tt,Ft){return{x:this.xRounder.round(Tt),y:this.yRounder.round(Ft)}}}]),Nt}(),ge=function(){function Nt(){bt(this,Nt),this.tree=new st,this.round(0)}return xt(Nt,[{key:"round",value:function(Tt){var Ft=this.tree.add(Tt),J=this.tree.prev(Ft);if(J!==null&&we(Ft.key,J.key)===0)return this.tree.remove(Tt),J.key;var gt=this.tree.next(Ft);return gt!==null&&we(Ft.key,gt.key)===0?(this.tree.remove(Tt),gt.key):Tt}}]),Nt}(),te=new _e,xe=function(wt,Tt){return wt.x*Tt.y-wt.y*Tt.x},Ye=function(wt,Tt){return wt.x*Tt.x+wt.y*Tt.y},Lt=function(wt,Tt,Ft){var J={x:Tt.x-wt.x,y:Tt.y-wt.y},gt={x:Ft.x-wt.x,y:Ft.y-wt.y},jt=xe(J,gt);return we(jt,0)},Qt=function(wt){return Math.sqrt(Ye(wt,wt))},ct=function(wt,Tt,Ft){var J={x:Tt.x-wt.x,y:Tt.y-wt.y},gt={x:Ft.x-wt.x,y:Ft.y-wt.y};return xe(gt,J)/Qt(gt)/Qt(J)},Ct=function(wt,Tt,Ft){var J={x:Tt.x-wt.x,y:Tt.y-wt.y},gt={x:Ft.x-wt.x,y:Ft.y-wt.y};return Ye(gt,J)/Qt(gt)/Qt(J)},Y=function(wt,Tt,Ft){return Tt.y===0?null:{x:wt.x+Tt.x/Tt.y*(Ft-wt.y),y:Ft}},yt=function(wt,Tt,Ft){return Tt.x===0?null:{x:Ft,y:wt.y+Tt.y/Tt.x*(Ft-wt.x)}},Xt=function(wt,Tt,Ft,J){if(Tt.x===0)return yt(Ft,J,wt.x);if(J.x===0)return yt(wt,Tt,Ft.x);if(Tt.y===0)return Y(Ft,J,wt.y);if(J.y===0)return Y(wt,Tt,Ft.y);var gt=xe(Tt,J);if(gt==0)return null;var jt={x:Ft.x-wt.x,y:Ft.y-wt.y},ve=xe(jt,Tt)/gt,Gt=xe(jt,J)/gt,Ae=wt.x+Gt*Tt.x,He=Ft.x+ve*J.x,qe=wt.y+Gt*Tt.y,hr=Ft.y+ve*J.y,tr=(Ae+He)/2,Br=(qe+hr)/2;return{x:tr,y:Br}},ie=function(){xt(Nt,null,[{key:"compare",value:function(Tt,Ft){var J=Nt.comparePoints(Tt.point,Ft.point);return J!==0?J:(Tt.point!==Ft.point&&Tt.link(Ft),Tt.isLeft!==Ft.isLeft?Tt.isLeft?1:-1:er.compare(Tt.segment,Ft.segment))}},{key:"comparePoints",value:function(Tt,Ft){return Tt.x<Ft.x?-1:Tt.x>Ft.x?1:Tt.y<Ft.y?-1:Tt.y>Ft.y?1:0}}]);function Nt(wt,Tt){bt(this,Nt),wt.events===void 0?wt.events=[this]:wt.events.push(this),this.point=wt,this.isLeft=Tt}return xt(Nt,[{key:"link",value:function(Tt){if(Tt.point===this.point)throw new Error("Tried to link already linked events");for(var Ft=Tt.point.events,J=0,gt=Ft.length;J<gt;J++){var jt=Ft[J];this.point.events.push(jt),jt.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var Tt=this.point.events.length,Ft=0;Ft<Tt;Ft++){var J=this.point.events[Ft];if(J.segment.consumedBy===void 0)for(var gt=Ft+1;gt<Tt;gt++){var jt=this.point.events[gt];jt.consumedBy===void 0&&J.otherSE.point.events===jt.otherSE.point.events&&J.segment.consume(jt.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var Tt=[],Ft=0,J=this.point.events.length;Ft<J;Ft++){var gt=this.point.events[Ft];gt!==this&&!gt.segment.ringOut&&gt.segment.isInResult()&&Tt.push(gt)}return Tt}},{key:"getLeftmostComparator",value:function(Tt){var Ft=this,J=new Map,gt=function(ve){var Gt=ve.otherSE;J.set(ve,{sine:ct(Ft.point,Tt.point,Gt.point),cosine:Ct(Ft.point,Tt.point,Gt.point)})};return function(jt,ve){J.has(jt)||gt(jt),J.has(ve)||gt(ve);var Gt=J.get(jt),Ae=Gt.sine,He=Gt.cosine,qe=J.get(ve),hr=qe.sine,tr=qe.cosine;return Ae>=0&&hr>=0?He<tr?1:He>tr?-1:0:Ae<0&&hr<0?He<tr?-1:He>tr?1:0:hr<Ae?-1:hr>Ae?1:0}}}]),Nt}(),Ce=0,er=function(){xt(Nt,null,[{key:"compare",value:function(Tt,Ft){var J=Tt.leftSE.point.x,gt=Ft.leftSE.point.x,jt=Tt.rightSE.point.x,ve=Ft.rightSE.point.x;if(ve<J)return 1;if(jt<gt)return-1;var Gt=Tt.leftSE.point.y,Ae=Ft.leftSE.point.y,He=Tt.rightSE.point.y,qe=Ft.rightSE.point.y;if(J<gt){if(Ae<Gt&&Ae<He)return 1;if(Ae>Gt&&Ae>He)return-1;var hr=Tt.comparePoint(Ft.leftSE.point);if(hr<0)return 1;if(hr>0)return-1;var tr=Ft.comparePoint(Tt.rightSE.point);return tr!==0?tr:-1}if(J>gt){if(Gt<Ae&&Gt<qe)return-1;if(Gt>Ae&&Gt>qe)return 1;var Br=Ft.comparePoint(Tt.leftSE.point);if(Br!==0)return Br;var Lr=Tt.comparePoint(Ft.rightSE.point);return Lr<0?1:Lr>0?-1:1}if(Gt<Ae)return-1;if(Gt>Ae)return 1;if(jt<ve){var Zr=Ft.comparePoint(Tt.rightSE.point);if(Zr!==0)return Zr}if(jt>ve){var Tn=Tt.comparePoint(Ft.rightSE.point);if(Tn<0)return 1;if(Tn>0)return-1}if(jt!==ve){var rn=He-Gt,Nn=jt-J,zn=qe-Ae,jn=ve-gt;if(rn>Nn&&zn<jn)return 1;if(rn<Nn&&zn>jn)return-1}return jt>ve?1:jt<ve||He<qe?-1:He>qe?1:Tt.id<Ft.id?-1:Tt.id>Ft.id?1:0}}]);function Nt(wt,Tt,Ft,J){bt(this,Nt),this.id=++Ce,this.leftSE=wt,wt.segment=this,wt.otherSE=Tt,this.rightSE=Tt,Tt.segment=this,Tt.otherSE=wt,this.rings=Ft,this.windings=J}return xt(Nt,[{key:"replaceRightSE",value:function(Tt){this.rightSE=Tt,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var Tt=this.leftSE.point.y,Ft=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:Tt<Ft?Tt:Ft},ur:{x:this.rightSE.point.x,y:Tt>Ft?Tt:Ft}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(Tt){return Tt.x===this.leftSE.point.x&&Tt.y===this.leftSE.point.y||Tt.x===this.rightSE.point.x&&Tt.y===this.rightSE.point.y}},{key:"comparePoint",value:function(Tt){if(this.isAnEndpoint(Tt))return 0;var Ft=this.leftSE.point,J=this.rightSE.point,gt=this.vector();if(Ft.x===J.x)return Tt.x===Ft.x?0:Tt.x<Ft.x?1:-1;var jt=(Tt.y-Ft.y)/gt.y,ve=Ft.x+jt*gt.x;if(Tt.x===ve)return 0;var Gt=(Tt.x-Ft.x)/gt.x,Ae=Ft.y+Gt*gt.y;return Tt.y===Ae?0:Tt.y<Ae?-1:1}},{key:"getIntersection",value:function(Tt){var Ft=this.bbox(),J=Tt.bbox(),gt=Mt(Ft,J);if(gt===null)return null;var jt=this.leftSE.point,ve=this.rightSE.point,Gt=Tt.leftSE.point,Ae=Tt.rightSE.point,He=Te(Ft,Gt)&&this.comparePoint(Gt)===0,qe=Te(J,jt)&&Tt.comparePoint(jt)===0,hr=Te(Ft,Ae)&&this.comparePoint(Ae)===0,tr=Te(J,ve)&&Tt.comparePoint(ve)===0;if(qe&&He)return tr&&!hr?ve:!tr&&hr?Ae:null;if(qe)return hr&&jt.x===Ae.x&&jt.y===Ae.y?null:jt;if(He)return tr&&ve.x===Gt.x&&ve.y===Gt.y?null:Gt;if(tr&&hr)return null;if(tr)return ve;if(hr)return Ae;var Br=Xt(jt,this.vector(),Gt,Tt.vector());return Br===null||!Te(gt,Br)?null:te.round(Br.x,Br.y)}},{key:"split",value:function(Tt){var Ft=[],J=Tt.events!==void 0,gt=new ie(Tt,!0),jt=new ie(Tt,!1),ve=this.rightSE;this.replaceRightSE(jt),Ft.push(jt),Ft.push(gt);var Gt=new Nt(gt,ve,this.rings.slice(),this.windings.slice());return ie.comparePoints(Gt.leftSE.point,Gt.rightSE.point)>0&&Gt.swapEvents(),ie.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),J&&(gt.checkForConsuming(),jt.checkForConsuming()),Ft}},{key:"swapEvents",value:function(){var Tt=this.rightSE;this.rightSE=this.leftSE,this.leftSE=Tt,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var Ft=0,J=this.windings.length;Ft<J;Ft++)this.windings[Ft]*=-1}},{key:"consume",value:function(Tt){for(var Ft=this,J=Tt;Ft.consumedBy;)Ft=Ft.consumedBy;for(;J.consumedBy;)J=J.consumedBy;var gt=Nt.compare(Ft,J);if(gt!==0){if(gt>0){var jt=Ft;Ft=J,J=jt}if(Ft.prev===J){var ve=Ft;Ft=J,J=ve}for(var Gt=0,Ae=J.rings.length;Gt<Ae;Gt++){var He=J.rings[Gt],qe=J.windings[Gt],hr=Ft.rings.indexOf(He);hr===-1?(Ft.rings.push(He),Ft.windings.push(qe)):Ft.windings[hr]+=qe}J.rings=null,J.windings=null,J.consumedBy=Ft,J.leftSE.consumedBy=Ft.leftSE,J.rightSE.consumedBy=Ft.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var Tt=this.prev.consumedBy||this.prev;this._beforeState=Tt.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var Tt=this.beforeState();this._afterState={rings:Tt.rings.slice(0),windings:Tt.windings.slice(0),multiPolys:[]};for(var Ft=this._afterState.rings,J=this._afterState.windings,gt=this._afterState.multiPolys,jt=0,ve=this.rings.length;jt<ve;jt++){var Gt=this.rings[jt],Ae=this.windings[jt],He=Ft.indexOf(Gt);He===-1?(Ft.push(Gt),J.push(Ae)):J[He]+=Ae}for(var qe=[],hr=[],tr=0,Br=Ft.length;tr<Br;tr++)if(J[tr]!==0){var Lr=Ft[tr],Zr=Lr.poly;if(hr.indexOf(Zr)===-1)if(Lr.isExterior)qe.push(Zr);else{hr.indexOf(Zr)===-1&&hr.push(Zr);var Tn=qe.indexOf(Lr.poly);Tn!==-1&&qe.splice(Tn,1)}}for(var rn=0,Nn=qe.length;rn<Nn;rn++){var zn=qe[rn].multiPoly;gt.indexOf(zn)===-1&&gt.push(zn)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var Tt=this.beforeState().multiPolys,Ft=this.afterState().multiPolys;switch(Yt.type){case"union":{var J=Tt.length===0,gt=Ft.length===0;this._isInResult=J!==gt;break}case"intersection":{var jt,ve;Tt.length<Ft.length?(jt=Tt.length,ve=Ft.length):(jt=Ft.length,ve=Tt.length),this._isInResult=ve===Yt.numMultiPolys&&jt<ve;break}case"xor":{var Gt=Math.abs(Tt.length-Ft.length);this._isInResult=Gt%2===1;break}case"difference":{var Ae=function(qe){return qe.length===1&&qe[0].isSubject};this._isInResult=Ae(Tt)!==Ae(Ft);break}default:throw new Error("Unrecognized operation type found ".concat(Yt.type))}return this._isInResult}}],[{key:"fromRing",value:function(Tt,Ft,J){var gt,jt,ve,Gt=ie.comparePoints(Tt,Ft);if(Gt<0)gt=Tt,jt=Ft,ve=1;else if(Gt>0)gt=Ft,jt=Tt,ve=-1;else throw new Error("Tried to create degenerate segment at [".concat(Tt.x,", ").concat(Tt.y,"]"));var Ae=new ie(gt,!0),He=new ie(jt,!1);return new Nt(Ae,He,[J],[ve])}}]),Nt}(),Ht=function(){function Nt(wt,Tt,Ft){if(bt(this,Nt),!Array.isArray(wt)||wt.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=Tt,this.isExterior=Ft,this.segments=[],typeof wt[0][0]!="number"||typeof wt[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var J=te.round(wt[0][0],wt[0][1]);this.bbox={ll:{x:J.x,y:J.y},ur:{x:J.x,y:J.y}};for(var gt=J,jt=1,ve=wt.length;jt<ve;jt++){if(typeof wt[jt][0]!="number"||typeof wt[jt][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Gt=te.round(wt[jt][0],wt[jt][1]);Gt.x===gt.x&&Gt.y===gt.y||(this.segments.push(er.fromRing(gt,Gt,this)),Gt.x<this.bbox.ll.x&&(this.bbox.ll.x=Gt.x),Gt.y<this.bbox.ll.y&&(this.bbox.ll.y=Gt.y),Gt.x>this.bbox.ur.x&&(this.bbox.ur.x=Gt.x),Gt.y>this.bbox.ur.y&&(this.bbox.ur.y=Gt.y),gt=Gt)}(J.x!==gt.x||J.y!==gt.y)&&this.segments.push(er.fromRing(gt,J,this))}return xt(Nt,[{key:"getSweepEvents",value:function(){for(var Tt=[],Ft=0,J=this.segments.length;Ft<J;Ft++){var gt=this.segments[Ft];Tt.push(gt.leftSE),Tt.push(gt.rightSE)}return Tt}}]),Nt}(),ne=function(){function Nt(wt,Tt){if(bt(this,Nt),!Array.isArray(wt))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ht(wt[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var Ft=1,J=wt.length;Ft<J;Ft++){var gt=new Ht(wt[Ft],this,!1);gt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=gt.bbox.ll.x),gt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=gt.bbox.ll.y),gt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=gt.bbox.ur.x),gt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=gt.bbox.ur.y),this.interiorRings.push(gt)}this.multiPoly=Tt}return xt(Nt,[{key:"getSweepEvents",value:function(){for(var Tt=this.exteriorRing.getSweepEvents(),Ft=0,J=this.interiorRings.length;Ft<J;Ft++)for(var gt=this.interiorRings[Ft].getSweepEvents(),jt=0,ve=gt.length;jt<ve;jt++)Tt.push(gt[jt]);return Tt}}]),Nt}(),Me=function(){function Nt(wt,Tt){if(bt(this,Nt),!Array.isArray(wt))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof wt[0][0][0]=="number"&&(wt=[wt])}catch(jt){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var Ft=0,J=wt.length;Ft<J;Ft++){var gt=new ne(wt[Ft],this);gt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=gt.bbox.ll.x),gt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=gt.bbox.ll.y),gt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=gt.bbox.ur.x),gt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=gt.bbox.ur.y),this.polys.push(gt)}this.isSubject=Tt}return xt(Nt,[{key:"getSweepEvents",value:function(){for(var Tt=[],Ft=0,J=this.polys.length;Ft<J;Ft++)for(var gt=this.polys[Ft].getSweepEvents(),jt=0,ve=gt.length;jt<ve;jt++)Tt.push(gt[jt]);return Tt}}]),Nt}(),ae=function(){xt(Nt,null,[{key:"factory",value:function(Tt){for(var Ft=[],J=0,gt=Tt.length;J<gt;J++){var jt=Tt[J];if(!(!jt.isInResult()||jt.ringOut)){for(var ve=null,Gt=jt.leftSE,Ae=jt.rightSE,He=[Gt],qe=Gt.point,hr=[];ve=Gt,Gt=Ae,He.push(Gt),Gt.point!==qe;)for(;;){var tr=Gt.getAvailableLinkedEvents();if(tr.length===0){var Br=He[0].point,Lr=He[He.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Br.x,",")+" ".concat(Br.y,"]. Last matching segment found ends at")+" [".concat(Lr.x,", ").concat(Lr.y,"]."))}if(tr.length===1){Ae=tr[0].otherSE;break}for(var Zr=null,Tn=0,rn=hr.length;Tn<rn;Tn++)if(hr[Tn].point===Gt.point){Zr=Tn;break}if(Zr!==null){var Nn=hr.splice(Zr)[0],zn=He.splice(Nn.index);zn.unshift(zn[0].otherSE),Ft.push(new Nt(zn.reverse()));continue}hr.push({index:He.length,point:Gt.point});var jn=Gt.getLeftmostComparator(ve);Ae=tr.sort(jn)[0].otherSE;break}Ft.push(new Nt(He))}}return Ft}}]);function Nt(wt){bt(this,Nt),this.events=wt;for(var Tt=0,Ft=wt.length;Tt<Ft;Tt++)wt[Tt].segment.ringOut=this;this.poly=null}return xt(Nt,[{key:"getGeom",value:function(){for(var Tt=this.events[0].point,Ft=[Tt],J=1,gt=this.events.length-1;J<gt;J++){var jt=this.events[J].point,ve=this.events[J+1].point;Lt(jt,Tt,ve)!==0&&(Ft.push(jt),Tt=jt)}if(Ft.length===1)return null;var Gt=Ft[0],Ae=Ft[1];Lt(Gt,Tt,Ae)===0&&Ft.shift(),Ft.push(Ft[0]);for(var He=this.isExteriorRing()?1:-1,qe=this.isExteriorRing()?0:Ft.length-1,hr=this.isExteriorRing()?Ft.length:-1,tr=[],Br=qe;Br!=hr;Br+=He)tr.push([Ft[Br].x,Ft[Br].y]);return tr}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var Tt=this.enclosingRing();this._isExteriorRing=Tt?!Tt.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var Tt=this.events[0],Ft=1,J=this.events.length;Ft<J;Ft++){var gt=this.events[Ft];ie.compare(Tt,gt)>0&&(Tt=gt)}for(var jt=Tt.segment.prevInResult(),ve=jt?jt.prevInResult():null;;){if(!jt)return null;if(!ve)return jt.ringOut;if(ve.ringOut!==jt.ringOut)return ve.ringOut.enclosingRing()!==jt.ringOut?jt.ringOut:jt.ringOut.enclosingRing();jt=ve.prevInResult(),ve=jt?jt.prevInResult():null}}}]),Nt}(),Je=function(){function Nt(wt){bt(this,Nt),this.exteriorRing=wt,wt.poly=this,this.interiorRings=[]}return xt(Nt,[{key:"addInterior",value:function(Tt){this.interiorRings.push(Tt),Tt.poly=this}},{key:"getGeom",value:function(){var Tt=[this.exteriorRing.getGeom()];if(Tt[0]===null)return null;for(var Ft=0,J=this.interiorRings.length;Ft<J;Ft++){var gt=this.interiorRings[Ft].getGeom();gt!==null&&Tt.push(gt)}return Tt}}]),Nt}(),or=function(){function Nt(wt){bt(this,Nt),this.rings=wt,this.polys=this._composePolys(wt)}return xt(Nt,[{key:"getGeom",value:function(){for(var Tt=[],Ft=0,J=this.polys.length;Ft<J;Ft++){var gt=this.polys[Ft].getGeom();gt!==null&&Tt.push(gt)}return Tt}},{key:"_composePolys",value:function(Tt){for(var Ft=[],J=0,gt=Tt.length;J<gt;J++){var jt=Tt[J];if(!jt.poly)if(jt.isExteriorRing())Ft.push(new Je(jt));else{var ve=jt.enclosingRing();ve.poly||Ft.push(new Je(ve)),ve.poly.addInterior(jt)}}return Ft}}]),Nt}(),re=function(){function Nt(wt){var Tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:er.compare;bt(this,Nt),this.queue=wt,this.tree=new st(Tt),this.segments=[]}return xt(Nt,[{key:"process",value:function(Tt){var Ft=Tt.segment,J=[];if(Tt.consumedBy)return Tt.isLeft?this.queue.remove(Tt.otherSE):this.tree.remove(Ft),J;var gt=Tt.isLeft?this.tree.insert(Ft):this.tree.find(Ft);if(!gt)throw new Error("Unable to find segment #".concat(Ft.id," ")+"[".concat(Ft.leftSE.point.x,", ").concat(Ft.leftSE.point.y,"] -> ")+"[".concat(Ft.rightSE.point.x,", ").concat(Ft.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var jt=gt,ve=gt,Gt=void 0,Ae=void 0;Gt===void 0;)jt=this.tree.prev(jt),jt===null?Gt=null:jt.key.consumedBy===void 0&&(Gt=jt.key);for(;Ae===void 0;)ve=this.tree.next(ve),ve===null?Ae=null:ve.key.consumedBy===void 0&&(Ae=ve.key);if(Tt.isLeft){var He=null;if(Gt){var qe=Gt.getIntersection(Ft);if(qe!==null&&(Ft.isAnEndpoint(qe)||(He=qe),!Gt.isAnEndpoint(qe)))for(var hr=this._splitSafely(Gt,qe),tr=0,Br=hr.length;tr<Br;tr++)J.push(hr[tr])}var Lr=null;if(Ae){var Zr=Ae.getIntersection(Ft);if(Zr!==null&&(Ft.isAnEndpoint(Zr)||(Lr=Zr),!Ae.isAnEndpoint(Zr)))for(var Tn=this._splitSafely(Ae,Zr),rn=0,Nn=Tn.length;rn<Nn;rn++)J.push(Tn[rn])}if(He!==null||Lr!==null){var zn=null;if(He===null)zn=Lr;else if(Lr===null)zn=He;else{var jn=ie.comparePoints(He,Lr);zn=jn<=0?He:Lr}this.queue.remove(Ft.rightSE),J.push(Ft.rightSE);for(var Sn=Ft.split(zn),Wn=0,Rt=Sn.length;Wn<Rt;Wn++)J.push(Sn[Wn])}J.length>0?(this.tree.remove(Ft),J.push(Tt)):(this.segments.push(Ft),Ft.prev=Gt)}else{if(Gt&&Ae){var Wt=Gt.getIntersection(Ae);if(Wt!==null){if(!Gt.isAnEndpoint(Wt))for(var oe=this._splitSafely(Gt,Wt),Se=0,ze=oe.length;Se<ze;Se++)J.push(oe[Se]);if(!Ae.isAnEndpoint(Wt))for(var fr=this._splitSafely(Ae,Wt),wr=0,Le=fr.length;wr<Le;wr++)J.push(fr[wr])}}this.tree.remove(Ft)}return J}},{key:"_splitSafely",value:function(Tt,Ft){this.tree.remove(Tt);var J=Tt.rightSE;this.queue.remove(J);var gt=Tt.split(Ft);return gt.push(J),Tt.consumedBy===void 0&&this.tree.insert(Tt),gt}}]),Nt}(),Jt=typeof kt!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Et=typeof kt!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,$t=function(){function Nt(){bt(this,Nt)}return xt(Nt,[{key:"run",value:function(Tt,Ft,J){Yt.type=Tt,te.reset();for(var gt=[new Me(Ft,!0)],jt=0,ve=J.length;jt<ve;jt++)gt.push(new Me(J[jt],!1));if(Yt.numMultiPolys=gt.length,Yt.type==="difference")for(var Gt=gt[0],Ae=1;Ae<gt.length;)Mt(gt[Ae].bbox,Gt.bbox)!==null?Ae++:gt.splice(Ae,1);if(Yt.type==="intersection"){for(var He=0,qe=gt.length;He<qe;He++)for(var hr=gt[He],tr=He+1,Br=gt.length;tr<Br;tr++)if(Mt(hr.bbox,gt[tr].bbox)===null)return[]}for(var Lr=new st(ie.compare),Zr=0,Tn=gt.length;Zr<Tn;Zr++)for(var rn=gt[Zr].getSweepEvents(),Nn=0,zn=rn.length;Nn<zn;Nn++)if(Lr.insert(rn[Nn]),Lr.size>Jt)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var jn=new re(Lr),Sn=Lr.size,Wn=Lr.pop();Wn;){var Rt=Wn.key;if(Lr.size===Sn){var Wt=Rt.segment;throw new Error("Unable to pop() ".concat(Rt.isLeft?"left":"right"," SweepEvent ")+"[".concat(Rt.point.x,", ").concat(Rt.point.y,"] from segment #").concat(Wt.id," ")+"[".concat(Wt.leftSE.point.x,", ").concat(Wt.leftSE.point.y,"] -> ")+"[".concat(Wt.rightSE.point.x,", ").concat(Wt.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Lr.size>Jt)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(jn.segments.length>Et)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var oe=jn.process(Rt),Se=0,ze=oe.length;Se<ze;Se++){var fr=oe[Se];fr.consumedBy===void 0&&Lr.insert(fr)}Sn=Lr.size,Wn=Lr.pop()}te.reset();var wr=ae.factory(jn.segments),Le=new or(wr);return Le.getGeom()}}]),Nt}(),Yt=new $t,St=function(wt){for(var Tt=arguments.length,Ft=new Array(Tt>1?Tt-1:0),J=1;J<Tt;J++)Ft[J-1]=arguments[J];return Yt.run("union",wt,Ft)},At=function(wt){for(var Tt=arguments.length,Ft=new Array(Tt>1?Tt-1:0),J=1;J<Tt;J++)Ft[J-1]=arguments[J];return Yt.run("intersection",wt,Ft)},ue=function(wt){for(var Tt=arguments.length,Ft=new Array(Tt>1?Tt-1:0),J=1;J<Tt;J++)Ft[J-1]=arguments[J];return Yt.run("xor",wt,Ft)},Pe=function(wt){for(var Tt=arguments.length,Ft=new Array(Tt>1?Tt-1:0),J=1;J<Tt;J++)Ft[J-1]=arguments[J];return Yt.run("difference",wt,Ft)},je={union:St,intersection:At,xor:ue,difference:Pe};return je})},24561:function(gn,Ot,ot){"use strict";var kt=ot(67294);var bt=function(){return bt=Object.assign||function(Ut){for(var P,b=1,W=arguments.length;b<W;b++){P=arguments[b];for(var fe in P)Object.prototype.hasOwnProperty.call(P,fe)&&(Ut[fe]=P[fe])}return Ut},bt.apply(this,arguments)};function I(st,Ut){var P={};for(var b in st)Object.prototype.hasOwnProperty.call(st,b)&&Ut.indexOf(b)<0&&(P[b]=st[b]);if(st!=null&&typeof Object.getOwnPropertySymbols=="function")for(var W=0,b=Object.getOwnPropertySymbols(st);W<b.length;W++)Ut.indexOf(b[W])<0&&Object.prototype.propertyIsEnumerable.call(st,b[W])&&(P[b[W]]=st[b[W]]);return P}var xt=function(){return Math.random().toString(36).substring(6)},K=function(st){var Ut=st.animate,P=st.backgroundColor,b=st.backgroundOpacity,W=st.baseUrl,fe=st.children,Ee=st.foregroundColor,Te=st.foregroundOpacity,Mt=st.gradientRatio,et=st.uniqueKey,Dt=st.interval,we=st.rtl,_e=st.speed,ge=st.style,te=st.title,xe=I(st,["animate","backgroundColor","backgroundOpacity","baseUrl","children","foregroundColor","foregroundOpacity","gradientRatio","uniqueKey","interval","rtl","speed","style","title"]),Ye=et||xt(),Lt=Ye+"-diff",Qt=Ye+"-animated-diff",ct=Ye+"-aria",Ct=we?{transform:"scaleX(-1)"}:null,Y="0; "+Dt+"; 1",yt=_e+"s";return(0,kt.createElement)("svg",bt({"aria-labelledby":ct,role:"img",style:bt(bt({},ge),Ct)},xe),te?(0,kt.createElement)("title",{id:ct},te):null,(0,kt.createElement)("rect",{role:"presentation",x:"0",y:"0",width:"100%",height:"100%",clipPath:"url("+W+"#"+Lt+")",style:{fill:"url("+W+"#"+Qt+")"}}),(0,kt.createElement)("defs",{role:"presentation"},(0,kt.createElement)("clipPath",{id:Lt},fe),(0,kt.createElement)("linearGradient",{id:Qt},(0,kt.createElement)("stop",{offset:"0%",stopColor:P,stopOpacity:b},Ut&&(0,kt.createElement)("animate",{attributeName:"offset",values:-Mt+"; "+-Mt+"; 1",keyTimes:Y,dur:yt,repeatCount:"indefinite"})),(0,kt.createElement)("stop",{offset:"50%",stopColor:Ee,stopOpacity:Te},Ut&&(0,kt.createElement)("animate",{attributeName:"offset",values:-Mt/2+"; "+-Mt/2+"; "+(1+Mt/2),keyTimes:Y,dur:yt,repeatCount:"indefinite"})),(0,kt.createElement)("stop",{offset:"100%",stopColor:P,stopOpacity:b},Ut&&(0,kt.createElement)("animate",{attributeName:"offset",values:"0; 0; "+(1+Mt),keyTimes:Y,dur:yt,repeatCount:"indefinite"})))))};K.defaultProps={animate:!0,backgroundColor:"#f5f6f7",backgroundOpacity:1,baseUrl:"",foregroundColor:"#eee",foregroundOpacity:1,gradientRatio:2,id:null,interval:.25,rtl:!1,speed:1.2,style:{},title:"Loading..."};var ut=function(st){return st.children?(0,kt.createElement)(K,bt({},st)):(0,kt.createElement)(ht,bt({},st))},ht=function(st){return(0,kt.createElement)(ut,bt({viewBox:"0 0 476 124"},st),(0,kt.createElement)("rect",{x:"48",y:"8",width:"88",height:"6",rx:"3"}),(0,kt.createElement)("rect",{x:"48",y:"26",width:"52",height:"6",rx:"3"}),(0,kt.createElement)("rect",{x:"0",y:"56",width:"410",height:"6",rx:"3"}),(0,kt.createElement)("rect",{x:"0",y:"72",width:"380",height:"6",rx:"3"}),(0,kt.createElement)("rect",{x:"0",y:"88",width:"178",height:"6",rx:"3"}),(0,kt.createElement)("circle",{cx:"20",cy:"20",r:"20"}))},lt=function(st){return createElement(ut,bt({viewBox:"0 0 400 460"},st),createElement("circle",{cx:"31",cy:"31",r:"15"}),createElement("rect",{x:"58",y:"18",rx:"2",ry:"2",width:"140",height:"10"}),createElement("rect",{x:"58",y:"34",rx:"2",ry:"2",width:"140",height:"10"}),createElement("rect",{x:"0",y:"60",rx:"2",ry:"2",width:"400",height:"400"}))},tt=function(st){return createElement(ut,bt({viewBox:"0 0 340 84"},st),createElement("rect",{x:"0",y:"0",width:"67",height:"11",rx:"3"}),createElement("rect",{x:"76",y:"0",width:"140",height:"11",rx:"3"}),createElement("rect",{x:"127",y:"48",width:"53",height:"11",rx:"3"}),createElement("rect",{x:"187",y:"48",width:"72",height:"11",rx:"3"}),createElement("rect",{x:"18",y:"48",width:"100",height:"11",rx:"3"}),createElement("rect",{x:"0",y:"71",width:"37",height:"11",rx:"3"}),createElement("rect",{x:"18",y:"23",width:"140",height:"11",rx:"3"}),createElement("rect",{x:"166",y:"23",width:"173",height:"11",rx:"3"}))},be=function(st){return createElement(ut,bt({viewBox:"0 0 400 110"},st),createElement("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"250",height:"10"}),createElement("rect",{x:"20",y:"20",rx:"3",ry:"3",width:"220",height:"10"}),createElement("rect",{x:"20",y:"40",rx:"3",ry:"3",width:"170",height:"10"}),createElement("rect",{x:"0",y:"60",rx:"3",ry:"3",width:"250",height:"10"}),createElement("rect",{x:"20",y:"80",rx:"3",ry:"3",width:"200",height:"10"}),createElement("rect",{x:"20",y:"100",rx:"3",ry:"3",width:"80",height:"10"}))},it=function(st){return createElement(ut,bt({viewBox:"0 0 245 125"},st),createElement("circle",{cx:"10",cy:"20",r:"8"}),createElement("rect",{x:"25",y:"15",rx:"5",ry:"5",width:"220",height:"10"}),createElement("circle",{cx:"10",cy:"50",r:"8"}),createElement("rect",{x:"25",y:"45",rx:"5",ry:"5",width:"220",height:"10"}),createElement("circle",{cx:"10",cy:"80",r:"8"}),createElement("rect",{x:"25",y:"75",rx:"5",ry:"5",width:"220",height:"10"}),createElement("circle",{cx:"10",cy:"110",r:"8"}),createElement("rect",{x:"25",y:"105",rx:"5",ry:"5",width:"220",height:"10"}))};Ot.ZP=ut},28660:function(gn,Ot,ot){var kt=ot(34155);var bt;(function(I){(function(xt){var K=typeof ot.g=="object"?ot.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),ut=ht(I);typeof K.Reflect=="undefined"?K.Reflect=I:ut=ht(K.Reflect,ut),xt(ut);function ht(lt,tt){return function(be,it){typeof lt[be]!="function"&&Object.defineProperty(lt,be,{configurable:!0,writable:!0,value:it}),tt&&tt(be,it)}}})(function(xt){var K=Object.prototype.hasOwnProperty,ut=typeof Symbol=="function",ht=ut&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",lt=ut&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",tt=typeof Object.create=="function",be={__proto__:[]}instanceof Array,it=!tt&&!be,st={create:tt?function(){return ve(Object.create(null))}:be?function(){return ve({__proto__:null})}:function(){return ve({})},has:it?function(Gt,Ae){return K.call(Gt,Ae)}:function(Gt,Ae){return Ae in Gt},get:it?function(Gt,Ae){return K.call(Gt,Ae)?Gt[Ae]:void 0}:function(Gt,Ae){return Gt[Ae]}},Ut=Object.getPrototypeOf(Function),P=typeof kt=="object"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",b=!P&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:J(),W=!P&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:gt(),fe=!P&&typeof WeakMap=="function"?WeakMap:jt(),Ee=new fe;function Te(Gt,Ae,He,qe){if(ne(He)){if(!Yt(Gt))throw new TypeError;if(!At(Ae))throw new TypeError;return Lt(Gt,Ae)}else{if(!Yt(Gt))throw new TypeError;if(!Je(Ae))throw new TypeError;if(!Je(qe)&&!ne(qe)&&!Me(qe))throw new TypeError;return Me(qe)&&(qe=void 0),He=$t(He),Qt(Gt,Ae,He,qe)}}xt("decorate",Te);function Mt(Gt,Ae){function He(qe,hr){if(!Je(qe))throw new TypeError;if(!ne(hr)&&!ue(hr))throw new TypeError;ie(Gt,Ae,qe,hr)}return He}xt("metadata",Mt);function et(Gt,Ae,He,qe){if(!Je(He))throw new TypeError;return ne(qe)||(qe=$t(qe)),ie(Gt,Ae,He,qe)}xt("defineMetadata",et);function Dt(Gt,Ae,He){if(!Je(Ae))throw new TypeError;return ne(He)||(He=$t(He)),Ct(Gt,Ae,He)}xt("hasMetadata",Dt);function we(Gt,Ae,He){if(!Je(Ae))throw new TypeError;return ne(He)||(He=$t(He)),Y(Gt,Ae,He)}xt("hasOwnMetadata",we);function _e(Gt,Ae,He){if(!Je(Ae))throw new TypeError;return ne(He)||(He=$t(He)),yt(Gt,Ae,He)}xt("getMetadata",_e);function ge(Gt,Ae,He){if(!Je(Ae))throw new TypeError;return ne(He)||(He=$t(He)),Xt(Gt,Ae,He)}xt("getOwnMetadata",ge);function te(Gt,Ae){if(!Je(Gt))throw new TypeError;return ne(Ae)||(Ae=$t(Ae)),Ce(Gt,Ae)}xt("getMetadataKeys",te);function xe(Gt,Ae){if(!Je(Gt))throw new TypeError;return ne(Ae)||(Ae=$t(Ae)),er(Gt,Ae)}xt("getOwnMetadataKeys",xe);function Ye(Gt,Ae,He){if(!Je(Ae))throw new TypeError;ne(He)||(He=$t(He));var qe=ct(Ae,He,!1);if(ne(qe)||!qe.delete(Gt))return!1;if(qe.size>0)return!0;var hr=Ee.get(Ae);return hr.delete(He),hr.size>0||Ee.delete(Ae),!0}xt("deleteMetadata",Ye);function Lt(Gt,Ae){for(var He=Gt.length-1;He>=0;--He){var qe=Gt[He],hr=qe(Ae);if(!ne(hr)&&!Me(hr)){if(!At(hr))throw new TypeError;Ae=hr}}return Ae}function Qt(Gt,Ae,He,qe){for(var hr=Gt.length-1;hr>=0;--hr){var tr=Gt[hr],Br=tr(Ae,He,qe);if(!ne(Br)&&!Me(Br)){if(!Je(Br))throw new TypeError;qe=Br}}return qe}function ct(Gt,Ae,He){var qe=Ee.get(Gt);if(ne(qe)){if(!He)return;qe=new b,Ee.set(Gt,qe)}var hr=qe.get(Ae);if(ne(hr)){if(!He)return;hr=new b,qe.set(Ae,hr)}return hr}function Ct(Gt,Ae,He){var qe=Y(Gt,Ae,He);if(qe)return!0;var hr=Ft(Ae);return Me(hr)?!1:Ct(Gt,hr,He)}function Y(Gt,Ae,He){var qe=ct(Ae,He,!1);return ne(qe)?!1:Jt(qe.has(Gt))}function yt(Gt,Ae,He){var qe=Y(Gt,Ae,He);if(qe)return Xt(Gt,Ae,He);var hr=Ft(Ae);if(!Me(hr))return yt(Gt,hr,He)}function Xt(Gt,Ae,He){var qe=ct(Ae,He,!1);if(!ne(qe))return qe.get(Gt)}function ie(Gt,Ae,He,qe){var hr=ct(He,qe,!0);hr.set(Gt,Ae)}function Ce(Gt,Ae){var He=er(Gt,Ae),qe=Ft(Gt);if(qe===null)return He;var hr=Ce(qe,Ae);if(hr.length<=0)return He;if(He.length<=0)return hr;for(var tr=new W,Br=[],Lr=0,Zr=He;Lr<Zr.length;Lr++){var Tn=Zr[Lr],rn=tr.has(Tn);rn||(tr.add(Tn),Br.push(Tn))}for(var Nn=0,zn=hr;Nn<zn.length;Nn++){var Tn=zn[Nn],rn=tr.has(Tn);rn||(tr.add(Tn),Br.push(Tn))}return Br}function er(Gt,Ae){var He=[],qe=ct(Gt,Ae,!1);if(ne(qe))return He;for(var hr=qe.keys(),tr=je(hr),Br=0;;){var Lr=wt(tr);if(!Lr)return He.length=Br,He;var Zr=Nt(Lr);try{He[Br]=Zr}catch(Tn){try{Tt(tr)}finally{throw Tn}}Br++}}function Ht(Gt){if(Gt===null)return 1;switch(typeof Gt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Gt===null?1:6;default:return 6}}function ne(Gt){return Gt===void 0}function Me(Gt){return Gt===null}function ae(Gt){return typeof Gt=="symbol"}function Je(Gt){return typeof Gt=="object"?Gt!==null:typeof Gt=="function"}function or(Gt,Ae){switch(Ht(Gt)){case 0:return Gt;case 1:return Gt;case 2:return Gt;case 3:return Gt;case 4:return Gt;case 5:return Gt}var He=Ae===3?"string":Ae===5?"number":"default",qe=Pe(Gt,ht);if(qe!==void 0){var hr=qe.call(Gt,He);if(Je(hr))throw new TypeError;return hr}return re(Gt,He==="default"?"number":He)}function re(Gt,Ae){if(Ae==="string"){var He=Gt.toString;if(St(He)){var qe=He.call(Gt);if(!Je(qe))return qe}var hr=Gt.valueOf;if(St(hr)){var qe=hr.call(Gt);if(!Je(qe))return qe}}else{var hr=Gt.valueOf;if(St(hr)){var qe=hr.call(Gt);if(!Je(qe))return qe}var tr=Gt.toString;if(St(tr)){var qe=tr.call(Gt);if(!Je(qe))return qe}}throw new TypeError}function Jt(Gt){return!!Gt}function Et(Gt){return""+Gt}function $t(Gt){var Ae=or(Gt,3);return ae(Ae)?Ae:Et(Ae)}function Yt(Gt){return Array.isArray?Array.isArray(Gt):Gt instanceof Object?Gt instanceof Array:Object.prototype.toString.call(Gt)==="[object Array]"}function St(Gt){return typeof Gt=="function"}function At(Gt){return typeof Gt=="function"}function ue(Gt){switch(Ht(Gt)){case 3:return!0;case 4:return!0;default:return!1}}function Pe(Gt,Ae){var He=Gt[Ae];if(He!=null){if(!St(He))throw new TypeError;return He}}function je(Gt){var Ae=Pe(Gt,lt);if(!St(Ae))throw new TypeError;var He=Ae.call(Gt);if(!Je(He))throw new TypeError;return He}function Nt(Gt){return Gt.value}function wt(Gt){var Ae=Gt.next();return Ae.done?!1:Ae}function Tt(Gt){var Ae=Gt.return;Ae&&Ae.call(Gt)}function Ft(Gt){var Ae=Object.getPrototypeOf(Gt);if(typeof Gt!="function"||Gt===Ut||Ae!==Ut)return Ae;var He=Gt.prototype,qe=He&&Object.getPrototypeOf(He);if(qe==null||qe===Object.prototype)return Ae;var hr=qe.constructor;return typeof hr!="function"||hr===Gt?Ae:hr}function J(){var Gt={},Ae=[],He=function(){function Br(Lr,Zr,Tn){this._index=0,this._keys=Lr,this._values=Zr,this._selector=Tn}return Br.prototype["@@iterator"]=function(){return this},Br.prototype[lt]=function(){return this},Br.prototype.next=function(){var Lr=this._index;if(Lr>=0&&Lr<this._keys.length){var Zr=this._selector(this._keys[Lr],this._values[Lr]);return Lr+1>=this._keys.length?(this._index=-1,this._keys=Ae,this._values=Ae):this._index++,{value:Zr,done:!1}}return{value:void 0,done:!0}},Br.prototype.throw=function(Lr){throw this._index>=0&&(this._index=-1,this._keys=Ae,this._values=Ae),Lr},Br.prototype.return=function(Lr){return this._index>=0&&(this._index=-1,this._keys=Ae,this._values=Ae),{value:Lr,done:!0}},Br}();return function(){function Br(){this._keys=[],this._values=[],this._cacheKey=Gt,this._cacheIndex=-2}return Object.defineProperty(Br.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Br.prototype.has=function(Lr){return this._find(Lr,!1)>=0},Br.prototype.get=function(Lr){var Zr=this._find(Lr,!1);return Zr>=0?this._values[Zr]:void 0},Br.prototype.set=function(Lr,Zr){var Tn=this._find(Lr,!0);return this._values[Tn]=Zr,this},Br.prototype.delete=function(Lr){var Zr=this._find(Lr,!1);if(Zr>=0){for(var Tn=this._keys.length,rn=Zr+1;rn<Tn;rn++)this._keys[rn-1]=this._keys[rn],this._values[rn-1]=this._values[rn];return this._keys.length--,this._values.length--,Lr===this._cacheKey&&(this._cacheKey=Gt,this._cacheIndex=-2),!0}return!1},Br.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Gt,this._cacheIndex=-2},Br.prototype.keys=function(){return new He(this._keys,this._values,qe)},Br.prototype.values=function(){return new He(this._keys,this._values,hr)},Br.prototype.entries=function(){return new He(this._keys,this._values,tr)},Br.prototype["@@iterator"]=function(){return this.entries()},Br.prototype[lt]=function(){return this.entries()},Br.prototype._find=function(Lr,Zr){return this._cacheKey!==Lr&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Lr)),this._cacheIndex<0&&Zr&&(this._cacheIndex=this._keys.length,this._keys.push(Lr),this._values.push(void 0)),this._cacheIndex},Br}();function qe(Br,Lr){return Br}function hr(Br,Lr){return Lr}function tr(Br,Lr){return[Br,Lr]}}function gt(){return function(){function Gt(){this._map=new b}return Object.defineProperty(Gt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Gt.prototype.has=function(Ae){return this._map.has(Ae)},Gt.prototype.add=function(Ae){return this._map.set(Ae,Ae),this},Gt.prototype.delete=function(Ae){return this._map.delete(Ae)},Gt.prototype.clear=function(){this._map.clear()},Gt.prototype.keys=function(){return this._map.keys()},Gt.prototype.values=function(){return this._map.values()},Gt.prototype.entries=function(){return this._map.entries()},Gt.prototype["@@iterator"]=function(){return this.keys()},Gt.prototype[lt]=function(){return this.keys()},Gt}()}function jt(){var Gt=16,Ae=st.create(),He=qe();return function(){function Zr(){this._key=qe()}return Zr.prototype.has=function(Tn){var rn=hr(Tn,!1);return rn!==void 0?st.has(rn,this._key):!1},Zr.prototype.get=function(Tn){var rn=hr(Tn,!1);return rn!==void 0?st.get(rn,this._key):void 0},Zr.prototype.set=function(Tn,rn){var Nn=hr(Tn,!0);return Nn[this._key]=rn,this},Zr.prototype.delete=function(Tn){var rn=hr(Tn,!1);return rn!==void 0?delete rn[this._key]:!1},Zr.prototype.clear=function(){this._key=qe()},Zr}();function qe(){var Zr;do Zr="@@WeakMap@@"+Lr();while(st.has(Ae,Zr));return Ae[Zr]=!0,Zr}function hr(Zr,Tn){if(!K.call(Zr,He)){if(!Tn)return;Object.defineProperty(Zr,He,{value:st.create()})}return Zr[He]}function tr(Zr,Tn){for(var rn=0;rn<Tn;++rn)Zr[rn]=Math.random()*255|0;return Zr}function Br(Zr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(Zr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(Zr)):tr(new Uint8Array(Zr),Zr):tr(new Array(Zr),Zr)}function Lr(){var Zr=Br(Gt);Zr[6]=Zr[6]&79|64,Zr[8]=Zr[8]&191|128;for(var Tn="",rn=0;rn<Gt;++rn){var Nn=Zr[rn];(rn===4||rn===6||rn===8)&&(Tn+="-"),Nn<16&&(Tn+="0"),Tn+=Nn.toString(16).toLowerCase()}return Tn}}function ve(Gt){return Gt.__=void 0,delete Gt.__,Gt}})})(bt||(bt={}))},55168:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.SensorTabIndex=Ot.SensorClassName=Ot.SizeSensorId=void 0;var ot="size-sensor-id";Ot.SizeSensorId=ot;var kt="size-sensor-object";Ot.SensorClassName=kt;var bt="-1";Ot.SensorTabIndex=bt},12177:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=void 0;var ot=function(bt){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:60,xt=null;return function(){for(var K=this,ut=arguments.length,ht=new Array(ut),lt=0;lt<ut;lt++)ht[lt]=arguments[lt];clearTimeout(xt),xt=setTimeout(function(){bt.apply(K,ht)},I)}};Ot.default=ot},15378:function(gn,Ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=void 0;var ot=1,kt=function(){return"".concat(ot++)};Ot.default=kt},18587:function(gn,Ot,ot){"use strict";var kt;kt={value:!0},kt=kt=Ot.ak=void 0;var bt=ot(12955),I=function(ht,lt){var tt=(0,bt.getSensor)(ht);return tt.bind(lt),function(){tt.unbind(lt)}};Ot.ak=I;var xt=function(ht){var lt=(0,bt.getSensor)(ht);(0,bt.removeSensor)(lt)};kt=xt;var K="1.0.1";kt=K},12955:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.removeSensor=Ot.getSensor=void 0;var kt=xt(ot(15378)),bt=ot(82578),I=ot(55168);function xt(lt){return lt&&lt.__esModule?lt:{default:lt}}var K={},ut=function(tt){var be=tt.getAttribute(I.SizeSensorId);if(be&&K[be])return K[be];var it=(0,kt.default)();tt.setAttribute(I.SizeSensorId,it);var st=(0,bt.createSensor)(tt);return K[it]=st,st};Ot.getSensor=ut;var ht=function(tt){var be=tt.element.getAttribute(I.SizeSensorId);tt.element.removeAttribute(I.SizeSensorId),tt.destroy(),be&&K[be]&&delete K[be]};Ot.removeSensor=ht},82578:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.createSensor=void 0;var kt=ot(27643),bt=ot(31743),I=typeof ResizeObserver!="undefined"?bt.createSensor:kt.createSensor;Ot.createSensor=I},27643:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.createSensor=void 0;var kt=I(ot(12177)),bt=ot(55168);function I(K){return K&&K.__esModule?K:{default:K}}var xt=function(ut){var ht=void 0,lt=[],tt=function(){getComputedStyle(ut).position==="static"&&(ut.style.position="relative");var b=document.createElement("object");return b.onload=function(){b.contentDocument.defaultView.addEventListener("resize",be),be()},b.style.display="block",b.style.position="absolute",b.style.top="0",b.style.left="0",b.style.height="100%",b.style.width="100%",b.style.overflow="hidden",b.style.pointerEvents="none",b.style.zIndex="-1",b.style.opacity="0",b.setAttribute("class",bt.SensorClassName),b.setAttribute("tabindex",bt.SensorTabIndex),b.type="text/html",ut.appendChild(b),b.data="about:blank",b},be=(0,kt.default)(function(){lt.forEach(function(P){P(ut)})}),it=function(b){ht||(ht=tt()),lt.indexOf(b)===-1&&lt.push(b)},st=function(){ht&&ht.parentNode&&(ht.contentDocument&&ht.contentDocument.defaultView.removeEventListener("resize",be),ht.parentNode.removeChild(ht),ht=void 0,lt=[])},Ut=function(b){var W=lt.indexOf(b);W!==-1&&lt.splice(W,1),lt.length===0&&ht&&st()};return{element:ut,bind:it,destroy:st,unbind:Ut}};Ot.createSensor=xt},31743:function(gn,Ot,ot){"use strict";Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.createSensor=void 0;var kt=bt(ot(12177));function bt(xt){return xt&&xt.__esModule?xt:{default:xt}}var I=function(K){var ut=void 0,ht=[],lt=(0,kt.default)(function(){ht.forEach(function(Ut){Ut(K)})}),tt=function(){var P=new ResizeObserver(lt);return P.observe(K),lt(),P},be=function(P){ut||(ut=tt()),ht.indexOf(P)===-1&&ht.push(P)},it=function(){ut.disconnect(),ht=[],ut=void 0},st=function(P){var b=ht.indexOf(P);b!==-1&&ht.splice(b,1),ht.length===0&&ut&&it()};return{element:K,bind:be,destroy:it,unbind:st}};Ot.createSensor=I},69848:function(gn){(function(Ot,ot){gn.exports=ot()})(this,function(){"use strict";function Ot(we,_e,ge,te,xe,Ye){if(!(xe-te<=ge)){var Lt=te+xe>>1;ot(we,_e,Lt,te,xe,Ye%2),Ot(we,_e,ge,te,Lt-1,Ye+1),Ot(we,_e,ge,Lt+1,xe,Ye+1)}}function ot(we,_e,ge,te,xe,Ye){for(;xe>te;){if(xe-te>600){var Lt=xe-te+1,Qt=ge-te+1,ct=Math.log(Lt),Ct=.5*Math.exp(2*ct/3),Y=.5*Math.sqrt(ct*Ct*(Lt-Ct)/Lt)*(Qt-Lt/2<0?-1:1),yt=Math.max(te,Math.floor(ge-Qt*Ct/Lt+Y)),Xt=Math.min(xe,Math.floor(ge+(Lt-Qt)*Ct/Lt+Y));ot(we,_e,ge,yt,Xt,Ye)}var ie=_e[2*ge+Ye],Ce=te,er=xe;for(kt(we,_e,te,ge),_e[2*xe+Ye]>ie&&kt(we,_e,te,xe);Ce<er;){for(kt(we,_e,Ce,er),Ce++,er--;_e[2*Ce+Ye]<ie;)Ce++;for(;_e[2*er+Ye]>ie;)er--}_e[2*te+Ye]===ie?kt(we,_e,te,er):(er++,kt(we,_e,er,xe)),er<=ge&&(te=er+1),ge<=er&&(xe=er-1)}}function kt(we,_e,ge,te){bt(we,ge,te),bt(_e,2*ge,2*te),bt(_e,2*ge+1,2*te+1)}function bt(we,_e,ge){var te=we[_e];we[_e]=we[ge],we[ge]=te}function I(we,_e,ge,te,xe,Ye,Lt){for(var Qt=[0,we.length-1,0],ct=[],Ct,Y;Qt.length;){var yt=Qt.pop(),Xt=Qt.pop(),ie=Qt.pop();if(Xt-ie<=Lt){for(var Ce=ie;Ce<=Xt;Ce++)Ct=_e[2*Ce],Y=_e[2*Ce+1],Ct>=ge&&Ct<=xe&&Y>=te&&Y<=Ye&&ct.push(we[Ce]);continue}var er=Math.floor((ie+Xt)/2);Ct=_e[2*er],Y=_e[2*er+1],Ct>=ge&&Ct<=xe&&Y>=te&&Y<=Ye&&ct.push(we[er]);var Ht=(yt+1)%2;(yt===0?ge<=Ct:te<=Y)&&(Qt.push(ie),Qt.push(er-1),Qt.push(Ht)),(yt===0?xe>=Ct:Ye>=Y)&&(Qt.push(er+1),Qt.push(Xt),Qt.push(Ht))}return ct}function xt(we,_e,ge,te,xe,Ye){for(var Lt=[0,we.length-1,0],Qt=[],ct=xe*xe;Lt.length;){var Ct=Lt.pop(),Y=Lt.pop(),yt=Lt.pop();if(Y-yt<=Ye){for(var Xt=yt;Xt<=Y;Xt++)K(_e[2*Xt],_e[2*Xt+1],ge,te)<=ct&&Qt.push(we[Xt]);continue}var ie=Math.floor((yt+Y)/2),Ce=_e[2*ie],er=_e[2*ie+1];K(Ce,er,ge,te)<=ct&&Qt.push(we[ie]);var Ht=(Ct+1)%2;(Ct===0?ge-xe<=Ce:te-xe<=er)&&(Lt.push(yt),Lt.push(ie-1),Lt.push(Ht)),(Ct===0?ge+xe>=Ce:te+xe>=er)&&(Lt.push(ie+1),Lt.push(Y),Lt.push(Ht))}return Qt}function K(we,_e,ge,te){var xe=we-ge,Ye=_e-te;return xe*xe+Ye*Ye}var ut=function(we){return we[0]},ht=function(we){return we[1]},lt=function(_e,ge,te,xe,Ye){ge===void 0&&(ge=ut),te===void 0&&(te=ht),xe===void 0&&(xe=64),Ye===void 0&&(Ye=Float64Array),this.nodeSize=xe,this.points=_e;for(var Lt=_e.length<65536?Uint16Array:Uint32Array,Qt=this.ids=new Lt(_e.length),ct=this.coords=new Ye(_e.length*2),Ct=0;Ct<_e.length;Ct++)Qt[Ct]=Ct,ct[2*Ct]=ge(_e[Ct]),ct[2*Ct+1]=te(_e[Ct]);Ot(Qt,ct,xe,0,Qt.length-1,0)};lt.prototype.range=function(_e,ge,te,xe){return I(this.ids,this.coords,_e,ge,te,xe,this.nodeSize)},lt.prototype.within=function(_e,ge,te){return xt(this.ids,this.coords,_e,ge,te,this.nodeSize)};var tt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(we){return we}},be=Math.fround||function(we){return function(_e){return we[0]=+_e,we[0]}}(new Float32Array(1)),it=function(_e){this.options=Mt(Object.create(tt),_e),this.trees=new Array(this.options.maxZoom+1)};it.prototype.load=function(_e){var ge=this.options,te=ge.log,xe=ge.minZoom,Ye=ge.maxZoom,Lt=ge.nodeSize;te&&console.time("total time");var Qt="prepare "+_e.length+" points";te&&console.time(Qt),this.points=_e;for(var ct=[],Ct=0;Ct<_e.length;Ct++)!_e[Ct].geometry||ct.push(Ut(_e[Ct],Ct));this.trees[Ye+1]=new lt(ct,et,Dt,Lt,Float32Array),te&&console.timeEnd(Qt);for(var Y=Ye;Y>=xe;Y--){var yt=+Date.now();ct=this._cluster(ct,Y),this.trees[Y]=new lt(ct,et,Dt,Lt,Float32Array),te&&console.log("z%d: %d clusters in %dms",Y,ct.length,+Date.now()-yt)}return te&&console.timeEnd("total time"),this},it.prototype.getClusters=function(_e,ge){var te=((_e[0]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,_e[1])),Ye=_e[2]===180?180:((_e[2]+180)%360+360)%360-180,Lt=Math.max(-90,Math.min(90,_e[3]));if(_e[2]-_e[0]>=360)te=-180,Ye=180;else if(te>Ye){var Qt=this.getClusters([te,xe,180,Lt],ge),ct=this.getClusters([-180,xe,Ye,Lt],ge);return Qt.concat(ct)}for(var Ct=this.trees[this._limitZoom(ge)],Y=Ct.range(W(te),fe(Lt),W(Ye),fe(xe)),yt=[],Xt=0,ie=Y;Xt<ie.length;Xt+=1){var Ce=ie[Xt],er=Ct.points[Ce];yt.push(er.numPoints?P(er):this.points[er.index])}return yt},it.prototype.getChildren=function(_e){var ge=this._getOriginId(_e),te=this._getOriginZoom(_e),xe="No cluster with the specified id.",Ye=this.trees[te];if(!Ye)throw new Error(xe);var Lt=Ye.points[ge];if(!Lt)throw new Error(xe);for(var Qt=this.options.radius/(this.options.extent*Math.pow(2,te-1)),ct=Ye.within(Lt.x,Lt.y,Qt),Ct=[],Y=0,yt=ct;Y<yt.length;Y+=1){var Xt=yt[Y],ie=Ye.points[Xt];ie.parentId===_e&&Ct.push(ie.numPoints?P(ie):this.points[ie.index])}if(Ct.length===0)throw new Error(xe);return Ct},it.prototype.getLeaves=function(_e,ge,te){ge=ge||10,te=te||0;var xe=[];return this._appendLeaves(xe,_e,ge,te,0),xe},it.prototype.getTile=function(_e,ge,te){var xe=this.trees[this._limitZoom(_e)],Ye=Math.pow(2,_e),Lt=this.options,Qt=Lt.extent,ct=Lt.radius,Ct=ct/Qt,Y=(te-Ct)/Ye,yt=(te+1+Ct)/Ye,Xt={features:[]};return this._addTileFeatures(xe.range((ge-Ct)/Ye,Y,(ge+1+Ct)/Ye,yt),xe.points,ge,te,Ye,Xt),ge===0&&this._addTileFeatures(xe.range(1-Ct/Ye,Y,1,yt),xe.points,Ye,te,Ye,Xt),ge===Ye-1&&this._addTileFeatures(xe.range(0,Y,Ct/Ye,yt),xe.points,-1,te,Ye,Xt),Xt.features.length?Xt:null},it.prototype.getClusterExpansionZoom=function(_e){for(var ge=this._getOriginZoom(_e)-1;ge<=this.options.maxZoom;){var te=this.getChildren(_e);if(ge++,te.length!==1)break;_e=te[0].properties.cluster_id}return ge},it.prototype._appendLeaves=function(_e,ge,te,xe,Ye){for(var Lt=this.getChildren(ge),Qt=0,ct=Lt;Qt<ct.length;Qt+=1){var Ct=ct[Qt],Y=Ct.properties;if(Y&&Y.cluster?Ye+Y.point_count<=xe?Ye+=Y.point_count:Ye=this._appendLeaves(_e,Y.cluster_id,te,xe,Ye):Ye<xe?Ye++:_e.push(Ct),_e.length===te)break}return Ye},it.prototype._addTileFeatures=function(_e,ge,te,xe,Ye,Lt){for(var Qt=0,ct=_e;Qt<ct.length;Qt+=1){var Ct=ct[Qt],Y=ge[Ct],yt=Y.numPoints,Xt=void 0,ie=void 0,Ce=void 0;if(yt)Xt=b(Y),ie=Y.x,Ce=Y.y;else{var er=this.points[Y.index];Xt=er.properties,ie=W(er.geometry.coordinates[0]),Ce=fe(er.geometry.coordinates[1])}var Ht={type:1,geometry:[[Math.round(this.options.extent*(ie*Ye-te)),Math.round(this.options.extent*(Ce*Ye-xe))]],tags:Xt},ne=void 0;yt?ne=Y.id:this.options.generateId?ne=Y.index:this.points[Y.index].id&&(ne=this.points[Y.index].id),ne!==void 0&&(Ht.id=ne),Lt.features.push(Ht)}},it.prototype._limitZoom=function(_e){return Math.max(this.options.minZoom,Math.min(Math.floor(+_e),this.options.maxZoom+1))},it.prototype._cluster=function(_e,ge){for(var te=[],xe=this.options,Ye=xe.radius,Lt=xe.extent,Qt=xe.reduce,ct=xe.minPoints,Ct=Ye/(Lt*Math.pow(2,ge)),Y=0;Y<_e.length;Y++){var yt=_e[Y];if(!(yt.zoom<=ge)){yt.zoom=ge;for(var Xt=this.trees[ge+1],ie=Xt.within(yt.x,yt.y,Ct),Ce=yt.numPoints||1,er=Ce,Ht=0,ne=ie;Ht<ne.length;Ht+=1){var Me=ne[Ht],ae=Xt.points[Me];ae.zoom>ge&&(er+=ae.numPoints||1)}if(er>Ce&&er>=ct){for(var Je=yt.x*Ce,or=yt.y*Ce,re=Qt&&Ce>1?this._map(yt,!0):null,Jt=(Y<<5)+(ge+1)+this.points.length,Et=0,$t=ie;Et<$t.length;Et+=1){var Yt=$t[Et],St=Xt.points[Yt];if(!(St.zoom<=ge)){St.zoom=ge;var At=St.numPoints||1;Je+=St.x*At,or+=St.y*At,St.parentId=Jt,Qt&&(re||(re=this._map(yt,!0)),Qt(re,this._map(St)))}}yt.parentId=Jt,te.push(st(Je/er,or/er,Jt,er,re))}else if(te.push(yt),er>1)for(var ue=0,Pe=ie;ue<Pe.length;ue+=1){var je=Pe[ue],Nt=Xt.points[je];Nt.zoom<=ge||(Nt.zoom=ge,te.push(Nt))}}}return te},it.prototype._getOriginId=function(_e){return _e-this.points.length>>5},it.prototype._getOriginZoom=function(_e){return(_e-this.points.length)%32},it.prototype._map=function(_e,ge){if(_e.numPoints)return ge?Mt({},_e.properties):_e.properties;var te=this.points[_e.index].properties,xe=this.options.map(te);return ge&&xe===te?Mt({},xe):xe};function st(we,_e,ge,te,xe){return{x:be(we),y:be(_e),zoom:1/0,id:ge,parentId:-1,numPoints:te,properties:xe}}function Ut(we,_e){var ge=we.geometry.coordinates,te=ge[0],xe=ge[1];return{x:be(W(te)),y:be(fe(xe)),zoom:1/0,index:_e,parentId:-1}}function P(we){return{type:"Feature",id:we.id,properties:b(we),geometry:{type:"Point",coordinates:[Ee(we.x),Te(we.y)]}}}function b(we){var _e=we.numPoints,ge=_e>=1e4?Math.round(_e/1e3)+"k":_e>=1e3?Math.round(_e/100)/10+"k":_e;return Mt(Mt({},we.properties),{cluster:!0,cluster_id:we.id,point_count:_e,point_count_abbreviated:ge})}function W(we){return we/360+.5}function fe(we){var _e=Math.sin(we*Math.PI/180),ge=.5-.25*Math.log((1+_e)/(1-_e))/Math.PI;return ge<0?0:ge>1?1:ge}function Ee(we){return(we-.5)*360}function Te(we){var _e=(180-we*360)*Math.PI/180;return 360*Math.atan(Math.exp(_e))/Math.PI-90}function Mt(we,_e){for(var ge in _e)we[ge]=_e[ge];return we}function et(we){return we.x}function Dt(we){return we.y}return it})},17061:function(gn,Ot,ot){var kt=ot(18698).default;function bt(){"use strict";gn.exports=bt=function(){return I},gn.exports.__esModule=!0,gn.exports.default=gn.exports;var I={},xt=Object.prototype,K=xt.hasOwnProperty,ut=Object.defineProperty||function(ct,Ct,Y){ct[Ct]=Y.value},ht=typeof Symbol=="function"?Symbol:{},lt=ht.iterator||"@@iterator",tt=ht.asyncIterator||"@@asyncIterator",be=ht.toStringTag||"@@toStringTag";function it(ct,Ct,Y){return Object.defineProperty(ct,Ct,{value:Y,enumerable:!0,configurable:!0,writable:!0}),ct[Ct]}try{it({},"")}catch(ct){it=function(Y,yt,Xt){return Y[yt]=Xt}}function st(ct,Ct,Y,yt){var Xt=Ct&&Ct.prototype instanceof b?Ct:b,ie=Object.create(Xt.prototype),Ce=new Ye(yt||[]);return ut(ie,"_invoke",{value:_e(ct,Y,Ce)}),ie}function Ut(ct,Ct,Y){try{return{type:"normal",arg:ct.call(Ct,Y)}}catch(yt){return{type:"throw",arg:yt}}}I.wrap=st;var P={};function b(){}function W(){}function fe(){}var Ee={};it(Ee,lt,function(){return this});var Te=Object.getPrototypeOf,Mt=Te&&Te(Te(Lt([])));Mt&&Mt!==xt&&K.call(Mt,lt)&&(Ee=Mt);var et=fe.prototype=b.prototype=Object.create(Ee);function Dt(ct){["next","throw","return"].forEach(function(Ct){it(ct,Ct,function(Y){return this._invoke(Ct,Y)})})}function we(ct,Ct){function Y(Xt,ie,Ce,er){var Ht=Ut(ct[Xt],ct,ie);if(Ht.type!=="throw"){var ne=Ht.arg,Me=ne.value;return Me&&kt(Me)=="object"&&K.call(Me,"__await")?Ct.resolve(Me.__await).then(function(ae){Y("next",ae,Ce,er)},function(ae){Y("throw",ae,Ce,er)}):Ct.resolve(Me).then(function(ae){ne.value=ae,Ce(ne)},function(ae){return Y("throw",ae,Ce,er)})}er(Ht.arg)}var yt;ut(this,"_invoke",{value:function(ie,Ce){function er(){return new Ct(function(Ht,ne){Y(ie,Ce,Ht,ne)})}return yt=yt?yt.then(er,er):er()}})}function _e(ct,Ct,Y){var yt="suspendedStart";return function(Xt,ie){if(yt==="executing")throw new Error("Generator is already running");if(yt==="completed"){if(Xt==="throw")throw ie;return Qt()}for(Y.method=Xt,Y.arg=ie;;){var Ce=Y.delegate;if(Ce){var er=ge(Ce,Y);if(er){if(er===P)continue;return er}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(yt==="suspendedStart")throw yt="completed",Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);yt="executing";var Ht=Ut(ct,Ct,Y);if(Ht.type==="normal"){if(yt=Y.done?"completed":"suspendedYield",Ht.arg===P)continue;return{value:Ht.arg,done:Y.done}}Ht.type==="throw"&&(yt="completed",Y.method="throw",Y.arg=Ht.arg)}}}function ge(ct,Ct){var Y=Ct.method,yt=ct.iterator[Y];if(yt===void 0)return Ct.delegate=null,Y==="throw"&&ct.iterator.return&&(Ct.method="return",Ct.arg=void 0,ge(ct,Ct),Ct.method==="throw")||Y!=="return"&&(Ct.method="throw",Ct.arg=new TypeError("The iterator does not provide a '"+Y+"' method")),P;var Xt=Ut(yt,ct.iterator,Ct.arg);if(Xt.type==="throw")return Ct.method="throw",Ct.arg=Xt.arg,Ct.delegate=null,P;var ie=Xt.arg;return ie?ie.done?(Ct[ct.resultName]=ie.value,Ct.next=ct.nextLoc,Ct.method!=="return"&&(Ct.method="next",Ct.arg=void 0),Ct.delegate=null,P):ie:(Ct.method="throw",Ct.arg=new TypeError("iterator result is not an object"),Ct.delegate=null,P)}function te(ct){var Ct={tryLoc:ct[0]};1 in ct&&(Ct.catchLoc=ct[1]),2 in ct&&(Ct.finallyLoc=ct[2],Ct.afterLoc=ct[3]),this.tryEntries.push(Ct)}function xe(ct){var Ct=ct.completion||{};Ct.type="normal",delete Ct.arg,ct.completion=Ct}function Ye(ct){this.tryEntries=[{tryLoc:"root"}],ct.forEach(te,this),this.reset(!0)}function Lt(ct){if(ct){var Ct=ct[lt];if(Ct)return Ct.call(ct);if(typeof ct.next=="function")return ct;if(!isNaN(ct.length)){var Y=-1,yt=function Xt(){for(;++Y<ct.length;)if(K.call(ct,Y))return Xt.value=ct[Y],Xt.done=!1,Xt;return Xt.value=void 0,Xt.done=!0,Xt};return yt.next=yt}}return{next:Qt}}function Qt(){return{value:void 0,done:!0}}return W.prototype=fe,ut(et,"constructor",{value:fe,configurable:!0}),ut(fe,"constructor",{value:W,configurable:!0}),W.displayName=it(fe,be,"GeneratorFunction"),I.isGeneratorFunction=function(ct){var Ct=typeof ct=="function"&&ct.constructor;return!!Ct&&(Ct===W||(Ct.displayName||Ct.name)==="GeneratorFunction")},I.mark=function(ct){return Object.setPrototypeOf?Object.setPrototypeOf(ct,fe):(ct.__proto__=fe,it(ct,be,"GeneratorFunction")),ct.prototype=Object.create(et),ct},I.awrap=function(ct){return{__await:ct}},Dt(we.prototype),it(we.prototype,tt,function(){return this}),I.AsyncIterator=we,I.async=function(ct,Ct,Y,yt,Xt){Xt===void 0&&(Xt=Promise);var ie=new we(st(ct,Ct,Y,yt),Xt);return I.isGeneratorFunction(Ct)?ie:ie.next().then(function(Ce){return Ce.done?Ce.value:ie.next()})},Dt(et),it(et,be,"Generator"),it(et,lt,function(){return this}),it(et,"toString",function(){return"[object Generator]"}),I.keys=function(ct){var Ct=Object(ct),Y=[];for(var yt in Ct)Y.push(yt);return Y.reverse(),function Xt(){for(;Y.length;){var ie=Y.pop();if(ie in Ct)return Xt.value=ie,Xt.done=!1,Xt}return Xt.done=!0,Xt}},I.values=Lt,Ye.prototype={constructor:Ye,reset:function(Ct){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(xe),!Ct)for(var Y in this)Y.charAt(0)==="t"&&K.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=void 0)},stop:function(){this.done=!0;var Ct=this.tryEntries[0].completion;if(Ct.type==="throw")throw Ct.arg;return this.rval},dispatchException:function(Ct){if(this.done)throw Ct;var Y=this;function yt(ne,Me){return Ce.type="throw",Ce.arg=Ct,Y.next=ne,Me&&(Y.method="next",Y.arg=void 0),!!Me}for(var Xt=this.tryEntries.length-1;Xt>=0;--Xt){var ie=this.tryEntries[Xt],Ce=ie.completion;if(ie.tryLoc==="root")return yt("end");if(ie.tryLoc<=this.prev){var er=K.call(ie,"catchLoc"),Ht=K.call(ie,"finallyLoc");if(er&&Ht){if(this.prev<ie.catchLoc)return yt(ie.catchLoc,!0);if(this.prev<ie.finallyLoc)return yt(ie.finallyLoc)}else if(er){if(this.prev<ie.catchLoc)return yt(ie.catchLoc,!0)}else{if(!Ht)throw new Error("try statement without catch or finally");if(this.prev<ie.finallyLoc)return yt(ie.finallyLoc)}}}},abrupt:function(Ct,Y){for(var yt=this.tryEntries.length-1;yt>=0;--yt){var Xt=this.tryEntries[yt];if(Xt.tryLoc<=this.prev&&K.call(Xt,"finallyLoc")&&this.prev<Xt.finallyLoc){var ie=Xt;break}}ie&&(Ct==="break"||Ct==="continue")&&ie.tryLoc<=Y&&Y<=ie.finallyLoc&&(ie=null);var Ce=ie?ie.completion:{};return Ce.type=Ct,Ce.arg=Y,ie?(this.method="next",this.next=ie.finallyLoc,P):this.complete(Ce)},complete:function(Ct,Y){if(Ct.type==="throw")throw Ct.arg;return Ct.type==="break"||Ct.type==="continue"?this.next=Ct.arg:Ct.type==="return"?(this.rval=this.arg=Ct.arg,this.method="return",this.next="end"):Ct.type==="normal"&&Y&&(this.next=Y),P},finish:function(Ct){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var yt=this.tryEntries[Y];if(yt.finallyLoc===Ct)return this.complete(yt.completion,yt.afterLoc),xe(yt),P}},catch:function(Ct){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var yt=this.tryEntries[Y];if(yt.tryLoc===Ct){var Xt=yt.completion;if(Xt.type==="throw"){var ie=Xt.arg;xe(yt)}return ie}}throw new Error("illegal catch attempt")},delegateYield:function(Ct,Y,yt){return this.delegate={iterator:Lt(Ct),resultName:Y,nextLoc:yt},this.method==="next"&&(this.arg=void 0),P}},I}gn.exports=bt,gn.exports.__esModule=!0,gn.exports.default=gn.exports},64687:function(gn,Ot,ot){var kt=ot(17061)();gn.exports=kt;try{regeneratorRuntime=kt}catch(bt){typeof globalThis=="object"?globalThis.regeneratorRuntime=kt:Function("r","regeneratorRuntime = r")(kt)}}}]);
