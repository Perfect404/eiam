/*
 * eiam-console - Employee Identity and Access Management Program
 * Copyright Â© 2020-2023 TopIAM (support@topiam.cn)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
(self.webpackChunktopiam_console=self.webpackChunktopiam_console||[]).push([[2051],{23113:function(W,L,r){"use strict";r.d(L,{Gh:function(){return p},SC:function(){return j},Zw:function(){return s},gD:function(){return U},n6:function(){return N},o:function(){return A},pR:function(){return x},rD:function(){return F}});var F;(function(e){e.EX900005="EX900005",e.EX000102="EX000102",e.EX000202="EX000202",e.SUCCESS="200"})(F||(F={}));var s;(function(e){e.ALIYUN="aliyun",e.QI_NIU="qiniu",e.TENCENT="tencent",e.NET_EASE="netease",e.MAXMIND="maxmind"})(s||(s={}));var N;(function(e){e.ALIYUN="aliyun",e.TENCENT="tencent",e.GEE_TEST="geetest",e.HCAPTCHA="hcaptcha",e.RECAPTCHA="recaptcha"})(N||(N={}));var x;(function(e){e.STANDARD="standard",e.CUSTOM_MADE="custom_made"})(x||(x={}));var U;(function(e){e.SAML2="saml2",e.OIDC="oidc",e.CAS="cas",e.JWT="jwt",e.FORM="form",e.OAUTH2="oauth2"})(U||(U={}));var p;(function(e){e.ALLOW="ALLOW",e.DENY="DENY"})(p||(p={}));var j;(function(e){e.ROLE="ROLE",e.RESOURCE="RESOURCE",e.USER="USER",e.ORGANIZATION="ORGANIZATION",e.USER_GROUP="USER_GROUP"})(j||(j={}));var A;(function(e){e.PHONE="PHONE",e.USERNAME="USERNAME",e.EMAIL="EMAIL"})(A||(A={}))},56472:function(W,L,r){"use strict";r.r(L),r.d(L,{default:function(){return pe}});var F=r(84019),s=r.n(F),N=r(76091),x=r.n(N),U=r(32061),p=r.n(U),j=r(7863),A=r.n(j),e=r(23113),H=r(73883),Y=r(75267),M=r.n(Y),Q=function(d,f){var a=M().enc.Base64.parse(f),o=M().enc.Utf8.parse(d),h=M().AES.encrypt(o,a,{mode:M().mode.ECB,padding:M().pad.Pkcs7});return h.toString()};function Fe(m,d){var f=CryptoJS.enc.Base64.parse(d),a=CryptoJS.AES.decrypt(m,f,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return CryptoJS.enc.Utf8.stringify(a)}function Ne(m){var d=m.text,f=m.secretKey,a=CryptoJS.enc.Base64.parse(f),o=a.clone();o.sigBytes=16,o.words.splice(4);var h=CryptoJS.enc.Utf8.parse(d),y=CryptoJS.AES.encrypt(h,a,{iv:o,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return y.toString()}function Ue(m){var d=m.textBase64,f=m.secretKey,a=CryptoJS.enc.Base64.parse(f),o=a.clone();o.sigBytes=16,o.words.splice(4);var h=CryptoJS.AES.decrypt(d,a,{iv:o,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return CryptoJS.enc.Utf8.stringify(h)}var k=r(69462),V=r(89419),q=r(29718),$=r(70695),_=r(34718),ee=r(78035),re=r(15457),ne=r(66015),te=r(21654),ae=r(82913),P=r(46673),R=r(79685),E=r(22590),T=r(30708),se=r(50374),ue=r(68591),O=r.n(ue),oe=r(39620),Z=r.n(oe),ie=r(53010),le=r(69567),ce=le.ZP.ConfigContext;function de(m){var d=".".concat(m),f=(0,R.useContext)(ce),a=f.getPrefixCls,o=".".concat(a()),h=(0,ie.l)(function(y){var B,J=y.token;return Z()({},"".concat(d),(B={padding:"24px"},Z()(B,"".concat(d,"-form-prefix-icon"),{color:J.colorPrimary,fontSize:J.fontSize}),Z()(B,"".concat(o,"-pro-form-login-page-logo"),{width:"200px",height:"50px",marginRight:0,fontSize:"18px",lineHeight:"50px",textAlign:"center",verticalAlign:"top"}),Z()(B,"".concat(o,"-pro-form-login-page-desc"),{marginTop:"30px",marginBottom:"25px",color:"rgba(0, 0, 0, 0.45)",fontSize:"14px"}),B))});return{className:h}}var fe=r(56709),t=r(63342),I="login",G=!0,ve=function(d){var f=d.content;return(0,t.jsx)(te.Z,{message:f,type:"error",showIcon:!0})},ge=function(){var d=(0,R.useState)(),f=A()(d,2),a=f[0],o=f[1],h=(0,E.useModel)("@@initialState"),y=h.initialState,B=h.setInitialState,J=ae.Z.useForm(),he=A()(J,1),X=he[0],D=(0,E.useIntl)(),ye=de(I),Se=ye.className,Ee=function(){var i=p()(s()().mark(function u(){var n,v;return s()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,y==null||(n=y.fetchUserInfo)===null||n===void 0?void 0:n.call(y);case 2:v=C.sent,v&&(0,se.flushSync)(function(){B(function(l){return x()(x()({},l),{},{currentUser:v})})});case 4:case"end":return C.stop()}},u)}));return function(){return i.apply(this,arguments)}}(),b=function(){if(E.history){var u=T.Z.parse(E.history.location.search),n=u,v=n.redirect_uri;window.location.replace(v||"/")}},Ce=function(){var i=p()(s()().mark(function u(){var n,v,g;return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,H.qX)();case 2:if(n=l.sent,v=n.success,g=n.result,!(v&&g)){l.next=7;break}return l.abrupt("return",Promise.resolve(g.secret));case 7:return l.abrupt("return",Promise.resolve(void 0));case 8:case"end":return l.stop()}},u)}));return function(){return i.apply(this,arguments)}}();(0,ee.Z)(p()(s()().mark(function i(){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(y&&y.currentUser)){n.next=4;break}return n.next=3,b();case 3:return n.abrupt("return");case 4:case"end":return n.stop()}},i)}))),(0,re.Z)(p()(s()().mark(function i(){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:G&&X.setFieldsValue({username:"admin",password:"NI7k1FxahAPv2oy4"});case 1:case"end":return n.stop()}},i)})),[]);var z=function(){var i=p()(s()().mark(function u(n){var v,g,C,l,S;return s()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return v=n.password,c.next=3,Ce().then(function(K){K&&(v=Q(v,K))});case 3:return g=T.Z.parse(E.history.location.search),C=g,l=C.redirect_uri,l||(l=window.location.href),c.next=8,(0,H.vq)(x()(x()({},n),{},{password:v,redirect_uri:l}));case 8:if(S=c.sent,o({message:"",status:""}),!(S!=null&&S.success)){c.next=18;break}return c.next=13,Ee();case 13:return P.ZP.loading({content:"\u767B\u5F55\u6210\u529F\uFF01\u6B63\u5728\u8DF3\u8F6C...",key:"loading",duration:0}),c.next=16,b();case 16:return P.ZP.destroy("loading"),c.abrupt("return",Promise.resolve(!0));case 18:if(!(!S.success&&S.status===e.rD.EX900005)){c.next=22;break}return c.next=21,z(n);case 21:return c.abrupt("return",c.sent);case 22:return o({message:S.message,status:S==null?void 0:S.result}),c.abrupt("return",Promise.resolve(!1));case 24:case"end":return c.stop()}},u)}));return function(n){return i.apply(this,arguments)}}(),w=(0,ne.Z)(z,{debounceWait:0,manual:!0}),xe=w.data,Be=w.loading,Ae=w.run;return(0,t.jsxs)("div",{className:Se,children:[G&&(0,t.jsx)(fe.Z,{}),(0,t.jsx)("div",{className:O()("".concat(I)),children:(0,t.jsx)("div",{style:{backgroundColor:"white",height:"calc(100vh - 48px)",border:"1px solid rgb(240, 240, 240)"},children:(0,t.jsxs)(q.B,{backgroundImageUrl:"/login-background.png",logo:"/full-logo.svg",subTitle:"\u4F01\u4E1A\u7EA7\u8EAB\u4EFD\u7BA1\u7406\u548C\u8BBF\u95EE\u7BA1\u7406\u7A0B\u5E8F\uFF0C\u4E3A\u6570\u5B57\u8EAB\u4EFD\u5B89\u5168\u8D4B\u80FD\uFF01",initialValues:{"remember-me":!1},form:X,scrollToFirstError:!0,submitter:{searchConfig:{submitText:D.formatMessage({id:"pages.login.submit",defaultMessage:"\u767B\u5F55"})},render:function(u,n){return n.pop()},submitButtonProps:{loading:Be,size:"large",style:{width:"100%"}}},onFinish:function(){var i=p()(s()().mark(function u(n){return s()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,Ae(n);case 2:return g.abrupt("return",xe);case 3:case"end":return g.stop()}},u)}));return function(u){return i.apply(this,arguments)}}(),children:[(a==null?void 0:a.status)!==e.rD.SUCCESS&&(a==null?void 0:a.message)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ve,{content:a==null?void 0:a.message}),(0,t.jsx)("br",{})]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.Z,{name:"username",fieldProps:{size:"large",prefix:(0,t.jsx)(k.Z,{className:O()("".concat(I,"-form-prefix-icon"))}),autoComplete:"off"},placeholder:D.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D / \u624B\u673A\u53F7 / \u90AE\u7BB1"}),rules:[{required:!0,message:(0,t.jsx)(E.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8D26\u53F7\u672A\u586B\u5199"})}]}),(0,t.jsx)($.Z.Password,{name:"password",fieldProps:{size:"large",autoComplete:"new-password",prefix:(0,t.jsx)(V.Z,{className:O()("".concat(I,"-form-prefix-icon"))})},placeholder:D.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"}),rules:[{required:!0,message:(0,t.jsx)(E.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u5BC6\u7801\u672A\u586B\u5199"})}]})]}),(0,t.jsxs)("div",{style:{marginBottom:24},children:[(0,t.jsx)(_.Z,{noStyle:!0,name:"remember-me",children:(0,t.jsx)(E.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,t.jsx)("a",{style:{float:"right"},onClick:p()(s()().mark(function i(){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:P.ZP.info("\u6682\u672A\u5B9E\u73B0");case 1:case"end":return n.stop()}},i)})),children:(0,t.jsx)(E.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})})})]})},me=ge,pe=me},89665:function(){}}]);
