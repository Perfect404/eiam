"use strict";(self.webpackChunktopiam_console=self.webpackChunktopiam_console||[]).push([[3091],{11911:function(hr,Be,S){S.d(Be,{Gh:function(){return k},SC:function(){return Ie},Zw:function(){return N},b$:function(){return Pe},n6:function(){return Ze},pR:function(){return a},rD:function(){return Ae}});var Ae;(function(p){p.EX900005="EX900005",p.EX000102="EX000102",p.EX000202="EX000202",p.SUCCESS="200"})(Ae||(Ae={}));var N;(function(p){p.ALIYUN="aliyun",p.QI_NIU="qiniu",p.TENCENT="tencent",p.NET_EASE="netease",p.MAXMIND="maxmind"})(N||(N={}));var Ze;(function(p){p.ALIYUN="aliyun",p.TENCENT="tencent",p.GEE_TEST="geetest",p.HCAPTCHA="hcaptcha",p.RECAPTCHA="recaptcha"})(Ze||(Ze={}));var a;(function(p){p.STANDARD="standard",p.CUSTOM_MADE="custom_made"})(a||(a={}));var Pe;(function(p){p.SAML2="saml2",p.OIDC="oidc",p.CAS="cas",p.JWT="jwt",p.FORM="form",p.OAUTH2="oauth2"})(Pe||(Pe={}));var k;(function(p){p.ALLOW="ALLOW",p.DENY="DENY"})(k||(k={}));var Ie;(function(p){p.ROLE="ROLE",p.RESOURCE="RESOURCE",p.USER="USER",p.ORGANIZATION="ORGANIZATION",p.USER_GROUP="USER_GROUP"})(Ie||(Ie={}))},71493:function(hr,Be,S){S.r(Be),S.d(Be,{default:function(){return Ja}});var Ae=S(11281),N=S.n(Ae),Ze=S(97983),a=S.n(Ze),Pe=S(40794),k=S.n(Pe),Ie=S(12741),p=S.n(Ie),De=S(84865),gr=S(45742),Fr=S(69243),Cr=S(62548),xr=S(56034),Sr=S(14459),Q=S(2093),K=S(2453),yr=S(71230),Xe=S(15746),br=S(68508),R=S(67294),jr=S(64129),Fe=S.n(jr),$e=S(137),Er=S(69606),e=S(85893),Ar=function(r){var n=(0,R.useState)(),y=p()(n,2),I=y[0],j=y[1];(0,Q.Z)(k()(a()().mark(function D(){var u,s,t;return a()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,$e.mB)();case 2:if(g.t0=g.sent,g.t0){g.next=5;break}g.t0={};case 5:u=g.t0,s=u.success,t=u.result,s&&t&&j([t]);case 9:case"end":return g.stop()}},D)})),[]);var b=function(){var D=k()(a()().mark(function u(s){var t,E,g,c;return a()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return t=s[s.length-1],t.loading=!0,Z.next=4,(0,$e.z3)(t.id);case 4:E=Z.sent,g=E.success,c=E.result,g&&c&&(t.children=Fe()(c),j(Fe()(I))),t.loading=!1;case 9:case"end":return Z.stop()}},u)}));return function(s){return D.apply(this,arguments)}}();return(0,e.jsx)(Er.Z,N()({fieldNames:{value:"id",label:"name"},options:I,loadData:b,changeOnSelect:!0,showCheckedStrategy:"SHOW_CHILD"},r))},Zr=Ar,Je=Zr,Oe=S(34041),re=S(57953),me=S(96486),Pr=Oe.Z.Option,Qe,Ir=function(){var T=k()(a()().mark(function r(n){var y,I;return a()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return Qe=n,b.next=3,(0,$e.S4)({name:n});case 3:if(y=b.sent,I=y.data,Qe!==n){b.next=7;break}return b.abrupt("return",I==null?void 0:I.map(function(D){return{value:D.id,label:"".concat(D.name)}}));case 7:return b.abrupt("return",[]);case 8:case"end":return b.stop()}},r)}));return function(n){return T.apply(this,arguments)}}(),wr=function(r){var n=(0,R.useState)([]),y=p()(n,2),I=y[0],j=y[1],b=(0,R.useState)(!1),D=p()(b,2),u=D[0],s=D[1],t=(0,R.useRef)(0),E=(0,R.useMemo)(function(){var A=function(i){t.current+=1;var f=t.current;j([]),s(!0),Ir(i).then(function(d){f===t.current&&(j(d),s(!1))})};return(0,me.debounce)(A,600)},[]),g=function(){var A=k()(a()().mark(function Z(i){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:i?E(i):j([]);case 1:case"end":return d.stop()}},Z)}));return function(i){return A.apply(this,arguments)}}(),c=I.map(function(A){return(0,e.jsx)(Pr,{value:A.value,children:A.label},A.value)});return(0,e.jsx)(Oe.Z,N()(N()({showSearch:!0,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onSearch:g,allowClear:!0,notFoundContent:u?(0,e.jsx)(re.Z,{size:"small"}):null},r),{},{children:c}))},Rr=wr,qe=Rr,Tr=Oe.Z.Option,_e,Br=function(){var T=k()(a()().mark(function r(n){var y,I;return a()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return _e=n,b.next=3,(0,$e.lE)({username:n});case 3:if(y=b.sent,I=y.data,_e!==n){b.next=7;break}return b.abrupt("return",I==null?void 0:I.map(function(D){return{value:D.id,label:"".concat(D.username)}}));case 7:return b.abrupt("return",[]);case 8:case"end":return b.stop()}},r)}));return function(n){return T.apply(this,arguments)}}(),Dr=function(r){var n=(0,R.useState)([]),y=p()(n,2),I=y[0],j=y[1],b=(0,R.useState)(!1),D=p()(b,2),u=D[0],s=D[1],t=(0,R.useRef)(0),E=(0,R.useMemo)(function(){var A=function(i){t.current+=1;var f=t.current;j([]),s(!0),Br(i).then(function(d){f===t.current&&(j(d),s(!1))})};return(0,me.debounce)(A,600)},[]),g=function(){var A=k()(a()().mark(function Z(i){return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:i?E(i):j([]);case 1:case"end":return d.stop()}},Z)}));return function(i){return A.apply(this,arguments)}}(),c=I.map(function(A){return(0,e.jsx)(Tr,{value:A.value,children:A.label},A.value)});return(0,e.jsx)(Oe.Z,N()(N()({showSearch:!0,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onSearch:g,allowClear:!0,notFoundContent:u?(0,e.jsx)(re.Z,{size:"small"}):null},r),{},{children:c}))},$r=Dr,Ne=$r,X=S(11911),U=S(56162),Ce=S(25035),ye=S(24969),z=S(5966),we=S(1914),er=S(37476),Or=S(86615),xe=S(97462),Se=S(86738),H=S(43825),fe=S(71577),ve=S(27414),Lr=function(T){var r=(0,R.useRef)(),n=T.appId,y=[{title:"\u6388\u6743\u4E3B\u4F53",dataIndex:"subjectName",ellipsis:!0,fixed:"left"},{title:"\u4E3B\u4F53\u7C7B\u578B",dataIndex:"subjectType",valueType:"select",ellipsis:!0,valueEnum:{USER:{text:"\u7528\u6237"},USER_GROUP:{text:"\u7528\u6237\u7EC4"},ORGANIZATION:{text:"\u7EC4\u7EC7\u673A\u6784"}}},{title:"\u6388\u6743\u65F6\u95F4",align:"center",ellipsis:!0,dataIndex:"createTime",valueType:"dateTime",search:!1},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:80,align:"center",fixed:"right",render:function(b,D){return[(0,e.jsx)(Se.Z,{title:"\u60A8\u786E\u5B9A\u8981\u53D6\u6D88\u4E3B\u4F53\u6388\u6743\uFF1F\u53D6\u6D88\u6388\u6743\u540E\u4E0D\u53EF\u81EA\u52A8\u6062\u590D\u3002",placement:"bottomRight",icon:(0,e.jsx)(Ce.Z,{style:{color:"red"}}),onConfirm:k()(a()().mark(function u(){var s,t,E;return a()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,U.AY)(D.id);case 2:if(s=c.sent,t=s.success,!t){c.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(E=r.current)===null||E===void 0||E.reload(),c.abrupt("return");case 8:case"end":return c.stop()}},u)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u53D6\u6D88\u6388\u6743"},"remove")},"delete")]}}],I=function(){var b=H.Z.useForm(),D=p()(b,1),u=D[0];return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(er.Y,{title:"\u6DFB\u52A0\u6388\u6743",width:600,form:u,scrollToFirstError:!0,trigger:(0,e.jsx)(fe.Z,{icon:(0,e.jsx)(ye.Z,{}),type:"primary",children:"\u6DFB\u52A0\u6388\u6743"},"button"),layout:"horizontal",labelCol:{span:4},wrapperCol:{span:20},autoFocusFirstInput:!0,preserve:!1,modalProps:{forceRender:!0,destroyOnClose:!0,onCancel:function(){u.resetFields()}},onFinish:function(){var s=k()(a()().mark(function t(E){var g,c,A;return a()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,U.gI)(N()({appId:n},E));case 2:if(g=i.sent,c=g.success,!c){i.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(A=r.current)===null||A===void 0||A.reload(),i.abrupt("return",!0);case 8:return K.ZP.error("\u64CD\u4F5C\u5931\u8D25"),i.abrupt("return",!1);case 10:case"end":return i.stop()}},t)}));return function(t){return s.apply(this,arguments)}}(),children:[(0,e.jsx)(Or.Z.Group,{name:"subjectType",label:"\u6388\u6743\u7C7B\u578B",initialValue:X.SC.USER,fieldProps:{onChange:function(){u.resetFields(["subjectIds"]),u.setFieldsValue({effect:X.Gh.ALLOW})}},options:[{value:X.SC.USER,label:"\u7528\u6237"},{value:X.SC.USER_GROUP,label:"\u7528\u6237\u7EC4"},{value:X.SC.ORGANIZATION,label:"\u7EC4\u7EC7\u673A\u6784"}],rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u7C7B\u578B"}]}),(0,e.jsx)(z.Z,{name:"effect",hidden:!0}),(0,e.jsx)(xe.Z,{name:["subjectType"],children:function(t){var E=t.subjectType;return E===X.SC.USER?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(H.Z.Item,{label:"\u6388\u6743\u7528\u6237",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u7528\u6237"}],children:(0,e.jsx)(Ne,{placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u641C\u7D22\u7528\u6237",mode:"multiple"})})}):E===X.SC.USER_GROUP?(0,e.jsx)(H.Z.Item,{label:"\u6388\u6743\u5206\u7EC4",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u5206\u7EC4"}],children:(0,e.jsx)(qe,{placeholder:"\u8BF7\u9009\u62E9\u6388\u6743\u5206\u7EC4",mode:"multiple"})}):E===X.SC.ORGANIZATION?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(H.Z.Item,{label:"\u6388\u6743\u7EC4\u7EC7",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9009\u62E9\u7EC4\u7EC7\u8282\u70B9"}],children:(0,e.jsx)(Je,{placeholder:"\u9009\u62E9\u7EC4\u7EC7\u8282\u70B9"})})}):(0,e.jsx)(e.Fragment,{})}})]})})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(we.Z,{columns:y,actionRef:r,scroll:{x:700},rowSelection:{selections:[ve.Z.SELECTION_ALL,ve.Z.SELECTION_INVERT]},request:U.Je,params:{appId:n},rowKey:"id",search:{},options:!1,pagination:{defaultPageSize:5},style:{height:"calc(100vh - 190px)",overflow:"auto"},cardProps:{style:{minHeight:"100%"}},dateFormatter:"string",toolBarRender:function(){return[(0,e.jsx)(I,{},"create")]}})})},kr=Lr,Ge=S(38345),ue=S(99138),Mr=function(){return(0,e.jsx)(Ge.Z,{style:{height:"calc(100vh - 190px)",overflow:"auto"},bodyStyle:{height:"100%"},children:(0,e.jsx)(ue.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},message:"\u6682\u672A\u5B9E\u73B0"})})},Ur=function(T){var r=(0,R.useRef)(),n=T.appId,y=[{title:"\u7CFB\u7EDF\u7528\u6237",dataIndex:"username",ellipsis:!0,fixed:"left"},{title:"\u5E94\u7528\u8D26\u6237",dataIndex:"account",ellipsis:!0},{title:"\u6DFB\u52A0\u65F6\u95F4",dataIndex:"createTime",valueType:"dateTime",search:!1,ellipsis:!0},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:80,align:"center",fixed:"right",render:function(b,D){return[(0,e.jsx)(Se.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u6B64\u5E94\u7528\u8D26\u6237\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(Ce.Z,{style:{color:"red"}}),onConfirm:k()(a()().mark(function u(){var s,t,E;return a()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,U.Zd)(D.id);case 2:if(s=c.sent,t=s.success,!t){c.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(E=r.current)===null||E===void 0||E.reload(),c.abrupt("return");case 8:case"end":return c.stop()}},u)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u5220\u9664"},"remove")},"delete")]}}],I=function(){var b=H.Z.useForm(),D=p()(b,1),u=D[0];return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(er.Y,{title:"\u6DFB\u52A0\u5E94\u7528\u8D26\u6237",width:600,form:u,scrollToFirstError:!0,trigger:(0,e.jsx)(fe.Z,{icon:(0,e.jsx)(ye.Z,{}),type:"primary",children:"\u6DFB\u52A0\u5E94\u7528\u8D26\u6237"},"button"),layout:"horizontal",labelCol:{span:4},wrapperCol:{span:20},autoFocusFirstInput:!0,preserve:!1,modalProps:{destroyOnClose:!0,onCancel:function(){u.resetFields()}},onFinish:function(){var s=k()(a()().mark(function t(E){var g,c,A;return a()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,U.o1)(N()({appId:n},E));case 2:if(g=i.sent,c=g.success,!c){i.next=8;break}return K.ZP.success("\u6DFB\u52A0\u6210\u529F"),(A=r.current)===null||A===void 0||A.reload(),i.abrupt("return",!0);case 8:return K.ZP.error("\u6DFB\u52A0\u5931\u8D25"),i.abrupt("return",!1);case 10:case"end":return i.stop()}},t)}));return function(t){return s.apply(this,arguments)}}(),children:[(0,e.jsx)(H.Z.Item,{label:"\u7CFB\u7EDF\u7528\u6237",name:"userId",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7528\u6237"}],children:(0,e.jsx)(Ne,{placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u3001\u624B\u673A\u6216\u90AE\u7BB1\u641C\u7D22\u7528\u6237"})}),(0,e.jsx)(z.Z,{label:"\u5E94\u7528\u8EAB\u4EFD",name:"account",placeholder:"\u8BF7\u8F93\u5165\u8D26\u6237\u8BBF\u95EE\u5E94\u7528\u65F6\u6240\u4F7F\u8EAB\u4EFD",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u6237\u8BBF\u95EE\u5E94\u7528\u65F6\u6240\u4F7F\u8EAB\u4EFD"}]})]})})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ue.Z,{banner:!0,type:"info",message:" \u5982\u679C\u60A8\u914D\u7F6E\u4F7F\u7528\u3010\u7CFB\u7EDF\u8D26\u6237\u540D\u3011\uFF0C\u5E94\u7528\u8D26\u6237\u5C5E\u6027\u914D\u7F6E\u540E\u4E0D\u4F1A\u751F\u6548\uFF1B\u5982\u9700\u53D8\u66F4\uFF0C\u8BF7\u5728 \u534F\u8BAE\u914D\u7F6E \u66F4\u6539\u914D\u7F6E\u3002",style:{marginBottom:16}}),(0,e.jsx)(we.Z,{columns:y,actionRef:r,scroll:{x:700},rowSelection:{selections:[ve.Z.SELECTION_ALL,ve.Z.SELECTION_INVERT]},request:U.IC,params:{appId:n},rowKey:"id",search:{},style:{height:"calc(100vh - 244px)",overflow:"auto"},cardProps:{style:{minHeight:"100%"}},options:!1,pagination:{defaultPageSize:5},dateFormatter:"string",toolBarRender:function(){return[(0,e.jsx)(I,{},"create")]}})]})},Nr=Ur,ce=S(85307),rr=S(21687),ze=S(98971),Le=S(67038),Gr=S(12812),se=S.n(Gr),Ve=S(46986),ar=S(38755),zr=Ve.ZP.ConfigContext;function Vr(T){var r=(0,R.useContext)(zr),n=r.getPrefixCls,y=".".concat(n()),I=(0,ar.l)(function(){return se()({},".".concat(T,"-descriptions"),se()({},"".concat(y,"-descriptions-small ").concat(y,"-descriptions-row > th, ").concat(y,"-descriptions-small ").concat(y,"-descriptions-row > td"),{"padding-bottom":"16px"}))});return{className:I}}var Kr=S(94184),Re=S.n(Kr),nr="user-detail-info",Hr=function(T){var r=T.appId,n=(0,R.useState)(!0),y=p()(n,2),I=y[0],j=y[1],b=(0,R.useState)(),D=p()(b,2),u=D[0],s=D[1],t=(0,ze.useLocation)(),E=(0,Le.parse)(t.search),g=Vr(nr),c=g.className;(0,Q.Z)(k()(a()().mark(function Z(){var i,f,d;return a()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return j(!0),F.next=3,(0,U.Mq)(r);case 3:i=F.sent,f=i.result,d=i.success,d&&f&&s(f),j(!1);case 8:case"end":return F.stop()}},Z)})),[]);var A=function(){var Z=k()(a()().mark(function i(f,d){var o,F;return a()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,U.KT)({id:d.id,name:d.name,remark:d.remark});case 2:if(o=C.sent,F=o.success,!F){C.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),s(N()({},d)),ze.history.replace("/app/config?id=".concat(E.id,"&name=").concat(d.name,"&type=").concat(E.type)),C.abrupt("return",Promise.resolve(!0));case 9:return C.abrupt("return",Promise.resolve(!1));case 10:case"end":return C.stop()}},i)}));return function(f,d){return Z.apply(this,arguments)}}();return(0,e.jsx)(Ge.Z,{title:"\u57FA\u672C\u914D\u7F6E",style:{height:"100%"},headerBordered:!0,className:c,children:(0,e.jsx)(rr.Z,{loading:I,active:!0,paragraph:{rows:5},children:(0,e.jsx)("div",{className:Re()("".concat(nr,"-descriptions")),children:(0,e.jsxs)(ce.vY,{size:"small",column:2,dataSource:(0,me.omit)(u,"config"),editable:{onSave:A},children:[(0,e.jsx)(ce.vY.Item,{dataIndex:"name",label:"\u5E94\u7528\u540D\u79F0",copyable:!1,formItemProps:{rules:[{required:!0,message:"\u5E94\u7528\u540D\u79F0\u4E3A\u5FC5\u586B\u9879"}]}}),(0,e.jsx)(ce.vY.Item,{dataIndex:"enabled",label:"\u5E94\u7528\u72B6\u6001",editable:!1,valueEnum:{true:{text:"\u6B63\u5E38",status:"Success"},false:{text:"\u7981\u7528",status:"Error"}}}),(0,e.jsx)(ce.vY.Item,{dataIndex:"type",label:"\u5E94\u7528\u7C7B\u578B",editable:!1,valueEnum:{custom_made:{text:"\u5B9A\u5236\u5E94\u7528"},standard:{text:"\u6807\u51C6\u5E94\u7528"},self_developed:{text:"\u81EA\u7814\u5E94\u7528"}}}),(0,e.jsx)(ce.vY.Item,{dataIndex:"protocolName",label:"\u5E94\u7528\u534F\u8BAE",editable:!1}),(u==null?void 0:u.clientId)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ce.vY.Item,{dataIndex:"clientId",label:"\u5BA2\u6237\u7AEF ID",valueType:"text",editable:!1,copyable:!0}),(0,e.jsx)(ce.vY.Item,{dataIndex:"clientSecret",label:"\u5BA2\u6237\u7AEF\u79D8\u94A5",valueType:"password",editable:!1,copyable:!0})]}),(0,e.jsx)(ce.vY.Item,{dataIndex:"createTime",label:"\u521B\u5EFA\u65F6\u95F4",valueType:"dateTime",copyable:!1,editable:!1}),(0,e.jsx)(ce.vY.Item,{dataIndex:"remark",label:"\u5907\u6CE8",valueType:"textarea",fieldProps:{rows:2,maxLength:20},copyable:!1})]})})})})},Y;(function(T){T.BASIC="basic",T.PROTOCOL_CONFIG="protocol_config",T.ACCOUNT_SYNC="account_sync",T.ACCESS_POLICY="access_policy",T.LOGIN_ACCESS="login_access",T.PERMISSION_RESOURCE="permission_resource",T.PERMISSION_ROLE="permission_role",T.PERMISSION_POLICY="permission_policy",T.APP_PERMISSION="app_permission",T.APP_ACCOUNT="app_account"})(Y||(Y={}));var he;(function(T){T.APP="only_app_init_sso",T.PORTAL_OR_APP="portal_or_app_init_sso"})(he||(he={}));var ge;(function(T){T.AUTHORIZATION="authorization",T.ALL_ACCESS="all_access"})(ge||(ge={}));var ke;(function(T){T.SAML_SIGN="saml_sign"})(ke||(ke={}));var q=S(15045),Me=S(4393),ee=S(96074),tr=S(71975),W=S(63434),Yr=q.Z.Panel,Wr=function(r){var n=(0,R.useState)(!1),y=p()(n,2),I=y[0],j=y[1],b=(0,R.useState)(),D=p()(b,2),u=D[0],s=D[1],t=(0,R.useState)([]),E=p()(t,2),g=E[0],c=E[1],A=r.open,Z=r.appId,i=r.onCancel,f=r.subjectType;(0,Q.Z)(k()(a()().mark(function o(){var F,v;return a()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!A){x.next=8;break}return j(!0),x.next=4,(0,U.Sf)({appId:Z});case 4:F=x.sent,v=F.result,s(v),j(!1);case 8:case"end":return x.stop()}},o)})),[A,f]);var d=function(F){if(F.target.checked){c([].concat(Fe()(g),[F.target.value]));return}c(g==null?void 0:g.filter(function(v){return v!==F.target.value}))};return(0,e.jsx)(tr.a,{title:"\u6388\u6743",width:650,layout:"horizontal",labelCol:{span:4},open:A,wrapperCol:{span:19},onFinish:function(F){return j(!0),console.log("roles",F.roles),console.log("subjectIds",F.subjectIds),console.log("permissions",g),c([]),j(!1),Promise.resolve(!1)},drawerProps:{destroyOnClose:!0,onClose:function(F){c([]),i(F)}},children:(0,e.jsxs)(re.Z,{spinning:I,children:[(0,e.jsx)(ue.Z,{message:"\u652F\u6301\u4E24\u79CD\u6743\u9650\u6A21\u578B\uFF1A\u57FA\u4E8E\u89D2\u8272\u7684\u8BBF\u95EE\u63A7\u5236\uFF08RBAC\uFF09\u548C\u57FA\u4E8E\u5C5E\u6027\u7684\u8BBF\u95EE\u63A7\u5236\uFF08ABAC\uFF09"}),(0,e.jsx)("br",{}),f===X.SC.USER&&(0,e.jsx)(H.Z.Item,{label:"\u6388\u6743\u7528\u6237",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u7528\u6237"}],children:(0,e.jsx)(Ne,{placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u3001\u624B\u673A\u6216\u90AE\u7BB1\u641C\u7D22\u7528\u6237",mode:"multiple"})}),f===X.SC.USER_GROUP&&(0,e.jsx)(H.Z.Item,{label:"\u6388\u6743\u7528\u6237\u7EC4",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u5206\u7EC4"}],children:(0,e.jsx)(qe,{placeholder:"\u8BF7\u9009\u62E9\u6388\u6743\u5206\u7EC4",mode:"multiple"})}),f===X.SC.ORGANIZATION&&(0,e.jsx)(H.Z.Item,{label:"\u6388\u6743\u7EC4\u7EC7",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9009\u62E9\u7EC4\u7EC7\u8282\u70B9"}],children:(0,e.jsx)(Je,{placeholder:"\u9009\u62E9\u7EC4\u7EC7\u8282\u70B9"})}),(0,e.jsxs)(Me.Z,{bodyStyle:{paddingBottom:0,paddingTop:0},children:[(0,e.jsx)(ee.Z,{orientation:"left",children:"\u5E94\u7528\u89D2\u8272"}),(0,e.jsx)(W.Z.Group,{name:"roles",layout:"vertical",options:["\u8682\u8681\u533A\u5757\u94FEBaaS\u5E73\u53F0-\u7BA1\u7406\u5458","\u5BA1\u8BA1\u7BA1\u7406\u5458","Captain-\u96C6\u7FA4\u6269\u5BB9\u5DE5\u7A0B\u5E08","Captain-\u96C6\u7FA4\u8FD0\u7EF4\u5DE5\u7A0B\u5E08","Captain-\u96C6\u7FA4\u7BA1\u7406\u5458","Captain-\u8D85\u7EA7\u7BA1\u7406\u5458","\u51FD\u6570\u8BA1\u7B97\u7BA1\u7406\u5458","\u51FD\u6570\u8BA1\u7B97\u89C2\u5BDF\u8005"]})]}),(0,e.jsx)("br",{}),(0,e.jsxs)(Me.Z,{bodyStyle:{paddingBottom:0,paddingTop:0},children:[(0,e.jsx)(ee.Z,{orientation:"left",children:"\u5E94\u7528\u8D44\u6E90"}),u==null?void 0:u.map(function(o){var F,v,C,x,m;return(0,e.jsxs)("div",{children:[(0,e.jsx)(q.Z,{bordered:!1,children:(0,e.jsxs)(Yr,{header:o.name,children:[o.menus.length>0&&(0,e.jsx)(W.Z.Group,{name:"menu_".concat(o.id),label:"\u83DC\u5355\u6743\u9650",layout:"vertical",options:(F=o.menus)===null||F===void 0?void 0:F.map(function(l){return{label:l.name,value:l.id,onChange:d}})}),o.buttons.length>0&&(0,e.jsx)(W.Z.Group,{name:"button_".concat(o.id),label:"\u6309\u94AE\u6743\u9650",layout:"vertical",options:(v=o.buttons)===null||v===void 0?void 0:v.map(function(l){return{label:l.name,value:l.id,onChange:d}})}),o.apis.length>0&&(0,e.jsx)(W.Z.Group,{name:"api_".concat(o.id),layout:"vertical",label:"\u63A5\u53E3\u6743\u9650",options:(C=o.apis)===null||C===void 0?void 0:C.map(function(l){return{label:l.name,value:l.id,onChange:d}})}),o.datas.length>0&&(0,e.jsx)(W.Z.Group,{name:"data_".concat(o.id),layout:"vertical",label:"\u6570\u636E\u6743\u9650",options:(x=o.apis)===null||x===void 0?void 0:x.map(function(l){return{label:l.name,value:l.id,onChange:d}})}),o.others.length>0&&(0,e.jsx)(W.Z.Group,{name:"other_".concat(o.id),layout:"vertical",label:"\u5176\u4ED6\u6743\u9650",options:(m=o.apis)===null||m===void 0?void 0:m.map(function(l){return{label:l.name,value:l.id,onChange:d}})})]},o.id)},o.id),(0,e.jsx)("br",{})]},o.id)})]})]})},"create_permission")},Xr=Wr,Jr=q.Z.Panel,Qr=function(r){var n=H.Z.useForm(),y=p()(n,1),I=y[0],j=(0,R.useState)(!1),b=p()(j,2),D=b[0],u=b[1],s=(0,R.useState)(),t=p()(s,2),E=t[0],g=t[1],c=r.open,A=r.onCancel,Z=r.subjectType,i=r.subjectId,f=(0,R.useState)([]),d=p()(f,2),o=d[0],F=d[1];(0,Q.Z)(k()(a()().mark(function C(){return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:c&&(u(!0),console.log(i),g([]),u(!1));case 1:case"end":return m.stop()}},C)})),[c,Z,i]);var v=function(x){if(x.target.checked){F([].concat(Fe()(o),[x.target.value]));return}F(o==null?void 0:o.filter(function(m){return m!==x.target.value}))};return(0,e.jsx)(tr.a,{title:"\u6388\u6743",width:650,layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},form:I,scrollToFirstError:!0,trigger:(0,e.jsx)("a",{type:"primary",children:"\u4FEE\u6539"},"update"),onFinish:function(x){return u(!0),console.log("roles",x.roles),console.log("permissions",o),F([]),u(!1),Promise.resolve(!1)},drawerProps:{afterOpenChange:function(x){},destroyOnClose:!0,onClose:function(x){F([]),A(x)}},children:(0,e.jsxs)(re.Z,{spinning:D,children:[(0,e.jsx)(ue.Z,{message:"\u652F\u6301\u4E24\u79CD\u6743\u9650\u6A21\u578B\uFF1A\u57FA\u4E8E\u89D2\u8272\u7684\u8BBF\u95EE\u63A7\u5236\uFF08RBAC\uFF09\u548C\u57FA\u4E8E\u5C5E\u6027\u7684\u8BBF\u95EE\u63A7\u5236\uFF08ABAC\uFF09"}),(0,e.jsx)("br",{}),(0,e.jsxs)(Me.Z,{bodyStyle:{paddingBottom:0,paddingTop:0},children:[(0,e.jsx)(ee.Z,{orientation:"left",children:"\u5E94\u7528\u89D2\u8272"}),(0,e.jsx)(W.Z.Group,{name:"roles",layout:"vertical",options:["\u8682\u8681\u533A\u5757\u94FEBaaS\u5E73\u53F0-\u7BA1\u7406\u5458","\u5BA1\u8BA1\u7BA1\u7406\u5458","Captain-\u96C6\u7FA4\u6269\u5BB9\u5DE5\u7A0B\u5E08","Captain-\u96C6\u7FA4\u8FD0\u7EF4\u5DE5\u7A0B\u5E08","Captain-\u96C6\u7FA4\u7BA1\u7406\u5458","Captain-\u8D85\u7EA7\u7BA1\u7406\u5458","\u51FD\u6570\u8BA1\u7B97\u7BA1\u7406\u5458","\u51FD\u6570\u8BA1\u7B97\u89C2\u5BDF\u8005"]})]}),(0,e.jsx)("br",{}),(0,e.jsxs)(Me.Z,{bodyStyle:{paddingBottom:0,paddingTop:0},children:[(0,e.jsx)(ee.Z,{orientation:"left",children:"\u5E94\u7528\u8D44\u6E90"}),E==null?void 0:E.map(function(C){var x,m,l,h,B;return(0,e.jsxs)("div",{children:[(0,e.jsx)(q.Z,{bordered:!1,children:(0,e.jsxs)(Jr,{header:C.name,children:[C.menus.length>0&&(0,e.jsx)(W.Z.Group,{name:"menu_".concat(C.id),label:"\u83DC\u5355\u6743\u9650",layout:"vertical",options:(x=C.menus)===null||x===void 0?void 0:x.map(function(w){return{label:w.name,value:w.id,onChange:v}})}),C.buttons.length>0&&(0,e.jsx)(W.Z.Group,{name:"button_".concat(C.id),label:"\u6309\u94AE\u6743\u9650",layout:"vertical",options:(m=C.buttons)===null||m===void 0?void 0:m.map(function(w){return{label:w.name,value:w.id,onChange:v}})}),C.apis.length>0&&(0,e.jsx)(W.Z.Group,{name:"api_".concat(C.id),layout:"vertical",label:"\u63A5\u53E3\u6743\u9650",options:(l=C.apis)===null||l===void 0?void 0:l.map(function(w){return{label:w.name,value:w.id,onChange:v}})}),C.datas.length>0&&(0,e.jsx)(W.Z.Group,{name:"data_".concat(C.id),layout:"vertical",label:"\u6570\u636E\u6743\u9650",options:(h=C.apis)===null||h===void 0?void 0:h.map(function(w){return{label:w.name,value:w.id,onChange:v}})}),C.others.length>0&&(0,e.jsx)(W.Z.Group,{name:"other_".concat(C.id),layout:"vertical",label:"\u5176\u4ED6\u6743\u9650",options:(B=C.apis)===null||B===void 0?void 0:B.map(function(w){return{label:w.name,value:w.id,onChange:v}})})]},C.id)},C.id),(0,e.jsx)("br",{})]},C.id)})]})]})},"update_permission")},qr=Qr,_r=function(T){var r=(0,R.useState)(X.SC.USER),n=p()(r,2),y=n[0],I=n[1],j=(0,R.useState)(!1),b=p()(j,2),D=b[0],u=b[1],s=(0,R.useRef)(),t=T.appId,E=[{title:"\u540D\u79F0",dataIndex:"name",ellipsis:!0,width:"300",fixed:"left"},{title:"\u6388\u6743\u65F6\u95F4",align:"center",dataIndex:"desc",search:!1},{title:"\u64CD\u4F5C",align:"center",valueType:"option",fixed:"right",width:150,render:function(c,A){return[(0,e.jsx)(qr,{onCancel:function(){},open:!0,subjectType:y,subjectId:A.id},A.id),(0,e.jsx)(Se.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(Ce.Z,{style:{color:"red"}}),onConfirm:k()(a()().mark(function Z(){return a()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:(0,U.IV)(A.id).then(function(d){if(d.success&&d.result){var o;K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(o=s.current)===null||o===void 0||o.reload();return}});case 1:case"end":return f.stop()}},Z)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u5220\u9664"},"remove")},"delete")]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(we.Z,{columns:E,options:!1,scroll:{x:700},pagination:{showQuickJumper:!0,defaultPageSize:10},style:{height:"calc(100vh - 190px)",overflow:"auto"},cardProps:{style:{minHeight:"100%"}},actionRef:s,request:U.zr,params:{appId:t,subjectType:y},rowKey:"id",dateFormatter:"string",toolbar:{menu:{type:"tab",activeKey:y,items:[{key:X.SC.USER,label:(0,e.jsx)("span",{children:"\u7528\u6237"})},{key:X.SC.USER_GROUP,label:(0,e.jsx)("span",{children:"\u7528\u6237\u7EC4"})},{key:X.SC.ORGANIZATION,label:(0,e.jsx)("span",{children:"\u7EC4\u7EC7\u673A\u6784"})}],onChange:function(c){I(c)}},actions:[(0,e.jsx)(fe.Z,{icon:(0,e.jsx)(ye.Z,{}),type:"primary",onClick:function(){u(!0)},children:"\u65B0\u589E\u6388\u6743"},"create")]}}),(0,e.jsx)(Xr,{subjectType:y,open:D,onCancel:function(){u(!1)},appId:t},"create")]})},ea=_r,ur=S(28058),sr=S(69400),lr=S(72269),de=S(26713),le=S(62113),pe=S(97269),Ke=S(50727),be=S(90672),Ue=S(58455),ra=function(r){var n=r.open,y=r.onCancel,I=r.onFinish,j=r.appId,b=(0,R.useState)(function(){return[]}),D=p()(b,2),u=D[0],s=D[1],t=(0,R.useState)(!1),E=p()(t,2),g=E[0],c=E[1],A=(0,R.useState)(0),Z=p()(A,2),i=Z[0],f=Z[1],d=(0,R.useRef)([]),o=H.Z.useForm(),F=p()(o,1),v=F[0],C=(0,R.useRef)();(0,R.useEffect)(function(){},[n]);var x=[{title:"\u6743\u9650\u7C7B\u578B",key:"type",dataIndex:"type",valueType:"select",width:80,fieldProps:{allowClear:!1,options:[{value:"DATA",label:"\u6570\u636E"},{value:"MENU",label:"\u83DC\u5355"},{value:"BUTTON",label:"\u6309\u94AE"},{value:"API",label:"API"},{value:"OTHER",label:"\u5176\u4ED6"}]},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u6743\u9650\u503C",dataIndex:"value",width:150,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u63CF\u8FF0",dataIndex:"name",width:150,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u64CD\u4F5C",fixed:"right",align:"center",width:30,valueType:"option"}];return(0,e.jsxs)(le.L,{formMapRef:d,current:i,onCurrentChange:f,stepsFormRender:function(l,h){return(0,e.jsx)(Ue.Z,{title:"\u521B\u5EFA\u8D44\u6E90",width:600,maskClosable:!0,destroyOnClose:!0,onClose:function(w){f(0),y(w)},open:n,footer:(0,e.jsx)(de.Z,{style:{float:"right"},children:h}),children:(0,e.jsx)(re.Z,{spinning:g,children:l})})},onFinish:function(){var m=k()(a()().mark(function l(h){var B;return a()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return c(!0),$.next=3,I==null?void 0:I(h);case 3:return B=$.sent,c(!1),f(0),$.abrupt("return",B);case 7:case"end":return $.stop()}},l)}));return function(l){return m.apply(this,arguments)}}(),children:[(0,e.jsxs)(le.L.StepForm,{scrollToFirstError:!0,name:"basic",title:"\u57FA\u672C\u4FE1\u606F",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},labelAlign:"right",children:[(0,e.jsx)(z.Z,{name:"name",label:"\u8D44\u6E90\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D44\u6E90\u540D\u79F0"},{validator:function(){var m=k()(a()().mark(function h(B,w){var $,L,M;return a()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(w){P.next=2;break}return P.abrupt("return",Promise.resolve());case 2:return P.next=4,(0,U.OR)(j,"NAME",w);case 4:if($=P.sent,L=$.success,M=$.result,L){P.next=9;break}return P.abrupt("return",Promise.reject());case 9:if(M){P.next=11;break}return P.abrupt("return",Promise.reject(new Error("\u8D44\u6E90\u540D\u79F0\u5DF2\u5B58\u5728")));case 11:case"end":return P.stop()}},h)}));function l(h,B){return m.apply(this,arguments)}return l}(),validateTrigger:["onBlur"]}]}),(0,e.jsx)(z.Z,{name:"code",label:"\u8D44\u6E90\u7F16\u7801",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u7F16\u7801",rules:[{required:!0,message:"\u8D44\u6E90\u7F16\u7801\u4E3A\u5FC5\u586B\u9879"},{validator:function(){var m=k()(a()().mark(function h(B,w){var $,L,M;return a()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(w){P.next=2;break}return P.abrupt("return",Promise.resolve());case 2:return c(!0),P.next=5,(0,U.OR)(j,"CODE",w);case 5:if($=P.sent,L=$.success,M=$.result,c(!1),L){P.next=11;break}return P.abrupt("return",Promise.reject());case 11:if(M){P.next=13;break}return P.abrupt("return",Promise.reject(new Error("\u8D44\u6E90\u7F16\u7801\u5DF2\u5B58\u5728")));case 13:case"end":return P.stop()}},h)}));function l(h,B){return m.apply(this,arguments)}return l}(),validateTrigger:["onBlur"]}],extra:"\u8D44\u6E90\u7F16\u7801\u5728\u5F53\u524D\u5E94\u7528\u4E2D\u7684\u552F\u4E00\u6807\u8BC6\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u4EC5\u652F\u6301\u82F1\u6587\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\uFF0C\u521B\u5EFA\u540E\u4E0D\u53EF\u4FEE\u6539\u3002"}),(0,e.jsx)(be.Z,{name:"desc",fieldProps:{rows:2},label:"\u8D44\u6E90\u63CF\u8FF0",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u63CF\u8FF0",rules:[{required:!0,message:"\u8D44\u6E90\u63CF\u8FF0\u4E3A\u5FC5\u586B\u9879"}]})]}),(0,e.jsx)(le.L.StepForm,{scrollToFirstError:!0,name:"actions",title:"\u6743\u9650\u9879",layout:"vertical",labelAlign:"right",onFinish:k()(a()().mark(function m(){var l;return a()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return c(!0),B.next=3,v.validateFields();case 3:if(l=B.sent,c(!1),!l){B.next=7;break}return B.abrupt("return",Promise.resolve(!0));case 7:return B.abrupt("return",Promise.resolve(!1));case 8:case"end":return B.stop()}},m)})),children:(0,e.jsx)(pe.A.Item,{label:"\u8D44\u6E90\u6743\u9650",name:"actions",trigger:"onValuesChange",rules:[{required:!0,message:"\u8D44\u6E90\u6743\u9650\u4E3A\u5FC5\u586B\u9879"}],tooltip:"\u4E3A\u8D44\u6E90\u5B9A\u4E49\u6743\u9650\uFF0C\u8BF7\u9009\u62E9\u6743\u9650\u7C7B\u578B\uFF0C\u5E76\u914D\u7F6E\u6743\u9650\u503C\u3002",children:(0,e.jsx)(Ke.Z,{rowKey:"key",scroll:{x:700},actionRef:C,toolBarRender:!1,columns:x,recordCreatorProps:{creatorButtonText:"\u6DFB\u52A0\u8D44\u6E90\u6743\u9650",newRecordType:"dataSource",position:"bottom",record:function(){return{key:Date.now()}}},editable:{form:v,type:"multiple",editableKeys:u,onChange:s,deletePopconfirmMessage:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6743\u9650\u8D44\u6E90\u5417\uFF1F",actionRender:function(l,h,B){return[B.delete]}}})})})]})},aa=ra,ir=S(95462),na=function(r){var n=r.open,y=r.onCancel,I=r.onFinish,j=r.id,b=r.appId,D=(0,R.useState)(!1),u=p()(D,2),s=u[0],t=u[1],E=(0,R.useState)(0),g=p()(E,2),c=g[0],A=g[1],Z=(0,R.useState)(function(){return[]}),i=p()(Z,2),f=i[0],d=i[1],o=(0,R.useRef)([]),F=H.Z.useForm(),v=p()(F,1),C=v[0],x=(0,R.useRef)();(0,Q.Z)(k()(a()().mark(function l(){var h,B,w,$,L;return a()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(!(n&&j)){V.next=14;break}return t(!0),V.next=4,(0,U.NZ)(j);case 4:if(h=V.sent,B=h.success,w=h.result,!(B&&w)){V.next=12;break}return o==null||($=o.current)===null||$===void 0||$.forEach(function(P){var O;P==null||(O=P.current)===null||O===void 0||O.setFieldsValue(N()(N()({},w),{},{id:j}))}),d((L=w.actions)===null||L===void 0?void 0:L.map(function(P){return P.id})),t(!1),V.abrupt("return");case 12:y(),K.ZP.warning("\u672A\u83B7\u53D6\u5230\u8BE5".concat(j,"\u8D44\u6E90\u6570\u636E\uFF01"));case 14:case"end":return V.stop()}},l)})),[j,y,n]);var m=[{title:"\u6743\u9650\u7C7B\u578B",key:"type",dataIndex:"type",valueType:"select",width:80,fieldProps:{allowClear:!1,options:[{value:"DATA",label:"\u6570\u636E"},{value:"MENU",label:"\u83DC\u5355"},{value:"BUTTON",label:"\u6309\u94AE"},{value:"API",label:"API"},{value:"OTHER",label:"\u5176\u4ED6"}]},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u6743\u9650\u503C",dataIndex:"value",copyable:!0,width:150,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u63CF\u8FF0",dataIndex:"name",width:150,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u64CD\u4F5C",fixed:"right",align:"center",width:30,valueType:"option"}];return(0,e.jsxs)(le.L,{formMapRef:o,current:c,onCurrentChange:A,stepsFormRender:function(h,B){return(0,e.jsx)(Ue.Z,{title:"\u4FEE\u6539\u8D44\u6E90",width:600,maskClosable:!0,destroyOnClose:!0,onClose:function($){A(0),y($)},open:n,footer:(0,e.jsx)(de.Z,{style:{float:"right"},children:B}),children:(0,e.jsx)(re.Z,{spinning:s,children:h})})},onFinish:function(){var l=k()(a()().mark(function h(B){var w;return a()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return t(!0),L.next=3,I==null?void 0:I(B);case 3:return w=L.sent,t(!1),A(0),L.abrupt("return",w);case 7:case"end":return L.stop()}},h)}));return function(h){return l.apply(this,arguments)}}(),children:[(0,e.jsxs)(le.L.StepForm,{scrollToFirstError:!0,name:"basic",title:"\u57FA\u672C\u4FE1\u606F",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},labelAlign:"right",children:[(0,e.jsx)(z.Z,{name:"id",hidden:!0}),(0,e.jsx)(z.Z,{name:"name",label:"\u8D44\u6E90\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D44\u6E90\u540D\u79F0"},{validator:function(){var l=k()(a()().mark(function B(w,$){var L,M,V;return a()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if($){O.next=2;break}return O.abrupt("return",Promise.resolve());case 2:return t(!0),O.next=5,(0,U.OR)(b,"NAME",$,j);case 5:if(L=O.sent,M=L.success,V=L.result,t(!1),M){O.next=11;break}return O.abrupt("return",Promise.reject());case 11:if(V){O.next=13;break}return O.abrupt("return",Promise.reject(new Error("\u8D44\u6E90\u540D\u79F0\u5DF2\u5B58\u5728")));case 13:case"end":return O.stop()}},B)}));function h(B,w){return l.apply(this,arguments)}return h}(),validateTrigger:["onBlur"]}]}),(0,e.jsx)(z.Z,{name:"code",label:"\u8D44\u6E90\u7F16\u7801",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u7F16\u7801",proFieldProps:{render:function(h){return h&&(0,e.jsx)(ir.Z,{copyable:{text:h},style:{marginBottom:"0"},children:(0,e.jsx)("span",{dangerouslySetInnerHTML:{__html:"<span>".concat(h,"</span>")}})})}},readonly:!0,extra:"\u8D44\u6E90\u7F16\u7801\u5728\u5F53\u524D\u5E94\u7528\u4E2D\u7684\u552F\u4E00\u6807\u8BC6\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u4EC5\u652F\u6301\u82F1\u6587\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\uFF0C\u521B\u5EFA\u540E\u4E0D\u53EF\u4FEE\u6539\u3002"}),(0,e.jsx)(be.Z,{name:"desc",fieldProps:{rows:2},label:"\u8D44\u6E90\u63CF\u8FF0",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u63CF\u8FF0"})]}),(0,e.jsx)(le.L.StepForm,{scrollToFirstError:!0,name:"actions",title:"\u6743\u9650\u9879",layout:"vertical",labelAlign:"right",onFinish:k()(a()().mark(function l(){var h;return a()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return t(!0),w.next=3,C.validateFields();case 3:if(h=w.sent,t(!1),!h){w.next=7;break}return w.abrupt("return",Promise.resolve(!0));case 7:return w.abrupt("return",Promise.resolve(!1));case 8:case"end":return w.stop()}},l)})),children:(0,e.jsx)(pe.A.Item,{label:"\u8D44\u6E90\u6743\u9650",name:"actions",trigger:"onValuesChange",rules:[{required:!0,message:"\u8D44\u6E90\u6743\u9650\u4E3A\u5FC5\u586B\u9879"}],tooltip:"\u4E3A\u8D44\u6E90\u5B9A\u4E49\u6743\u9650\uFF0C\u8BF7\u9009\u62E9\u6743\u9650\u7C7B\u578B\uFF0C\u5E76\u914D\u7F6E\u6743\u9650\u503C\u3002",children:(0,e.jsx)(Ke.Z,{rowKey:"id",scroll:{x:700},actionRef:x,toolBarRender:!1,columns:m,recordCreatorProps:{creatorButtonText:"\u6DFB\u52A0\u8D44\u6E90\u6743\u9650",newRecordType:"dataSource",position:"bottom",record:function(){return{id:Date.now()}}},editable:{form:C,type:"multiple",editableKeys:f,onChange:d,deletePopconfirmMessage:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6743\u9650\u8D44\u6E90\u5417\uFF1F",actionRender:function(h,B,w){return[w.delete]}}})})})]})},ta=na,ua=sr.Z.confirm,sa=function(T){var r=(0,R.useRef)(),n=T.appId,y=(0,R.useState)(!1),I=p()(y,2),j=I[0],b=I[1],D=(0,R.useState)(!1),u=p()(D,2),s=u[0],t=u[1],E=(0,R.useState)(),g=p()(E,2),c=g[0],A=g[1],Z=[{title:"\u8D44\u6E90\u540D\u79F0",dataIndex:"name",ellipsis:!0,fixed:"left",copyable:!1},{title:"\u8D44\u6E90\u7F16\u7801",dataIndex:"code",ellipsis:!0,copyable:!0},{title:"\u8D44\u6E90\u63CF\u8FF0",dataIndex:"desc",search:!1,ellipsis:!0,copyable:!1},{title:"\u72B6\u6001",dataIndex:"enabled",search:!1,align:"center",render:function(f,d){return(0,e.jsx)(lr.Z,{checked:f,onChange:function(){var o=k()(a()().mark(function F(v){var C,x,m;return a()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!v){h.next=9;break}return h.next=3,(0,U.PE)(d.id);case 3:if(C=h.sent,x=C.success,!x){h.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(m=r.current)===null||m===void 0||m.reload(),h.abrupt("return");case 9:ua({title:"\u8B66\u544A",icon:(0,e.jsx)(ur.Z,{}),content:"\u786E\u5B9A\u7981\u7528\u6B64\u8D44\u6E90\uFF1F",okText:"\u786E\u5B9A",okType:"danger",cancelText:"\u53D6\u6D88",centered:!0,onOk:function(){var B=k()(a()().mark(function $(){var L,M,V;return a()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,U._G)(d.id);case 2:if(L=O.sent,M=L.success,!M){O.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(V=r.current)===null||V===void 0||V.reload(),O.abrupt("return");case 8:case"end":return O.stop()}},$)}));function w(){return B.apply(this,arguments)}return w}(),onCancel:function(){}});case 10:case"end":return h.stop()}},F)}));return function(F){return o.apply(this,arguments)}}()})}},{title:"\u64CD\u4F5C",align:"center",valueType:"option",fixed:"right",width:150,render:function(f,d){return[(0,e.jsx)("a",{target:"_blank",onClick:function(){A(d.id),t(!0)},children:"\u4FEE\u6539"},"update"),(0,e.jsx)(Se.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(Ce.Z,{style:{color:"red"}}),onConfirm:k()(a()().mark(function o(){return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:(0,U.IV)(d.id).then(function(C){if(C.success&&C.result){var x;K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(x=r.current)===null||x===void 0||x.reload();return}});case 1:case"end":return v.stop()}},o)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u5220\u9664"},"remove")},"delete")]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(we.Z,{columns:Z,actionRef:r,request:U.UK,params:{appId:n},rowKey:"id",options:!1,scroll:{x:650},style:{height:"calc(100vh - 190px)",overflow:"auto"},cardProps:{style:{minHeight:"100%"}},toolbar:{actions:[(0,e.jsx)(fe.Z,{type:"primary",icon:(0,e.jsx)(ye.Z,{}),onClick:function(){b(!0)},children:"\u65B0\u589E\u8D44\u6E90"},"create")]},pagination:{showQuickJumper:!0,defaultPageSize:10},rowSelection:{selections:[ve.Z.SELECTION_ALL,ve.Z.SELECTION_INVERT]},tableAlertRender:function(f){var d=f.selectedRowKeys,o=f.onCleanSelected;return(0,e.jsx)(de.Z,{size:24,children:(0,e.jsxs)("span",{children:["\u5DF2\u9009 ",d.length," \u9879",(0,e.jsx)("a",{style:{marginLeft:8},onClick:o,children:"\u53D6\u6D88\u9009\u62E9"})]})})},tableAlertOptionRender:function(f){return(0,e.jsx)(de.Z,{size:16,children:(0,e.jsx)(Se.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(Ce.Z,{style:{color:"red"}}),onConfirm:k()(a()().mark(function d(){var o,F,v;return a()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,U.O0)(f.selectedRowKeys);case 2:if(o=x.sent,F=o.success,!F){x.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),f.onCleanSelected(),(v=r.current)===null||v===void 0||v.reload(),x.abrupt("return");case 9:case"end":return x.stop()}},d)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u6279\u91CF\u5220\u9664"},"remove")},"delete")})}}),(0,e.jsx)(aa,{appId:n,open:j,onCancel:function(){b(!1)},onFinish:function(){var i=k()(a()().mark(function f(d){var o,F,v;return a()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,U.bm)(N()(N()({},d),{},{appId:n}));case 2:if(o=x.sent,F=o.success,!F){x.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(v=r.current)===null||v===void 0||v.reload(),b(!1),x.abrupt("return",Promise.resolve(!0));case 9:return x.abrupt("return",Promise.resolve(!1));case 10:case"end":return x.stop()}},f)}));return function(f){return i.apply(this,arguments)}}()}),(0,e.jsx)(ta,{id:c,appId:n,open:s,onCancel:function(){t(!1)},onFinish:function(){var i=k()(a()().mark(function f(d){var o,F,v;return a()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,U.Y3)(N()(N()({},d),{},{appId:n}));case 2:o=x.sent,F=o.success,F&&((v=r.current)===null||v===void 0||v.reload(),t(!1),K.ZP.success("\u64CD\u4F5C\u6210\u529F"));case 5:case"end":return x.stop()}},f)}));return function(f){return i.apply(this,arguments)}}()})]})},la=S(25191),ia=q.Z.Panel,oa=function(r){var n=r.open,y=r.onCancel,I=r.onFinish,j=r.appId,b=(0,R.useRef)([]),D=(0,R.useState)(),u=p()(D,2),s=u[0],t=u[1],E=(0,R.useState)(!1),g=p()(E,2),c=g[0],A=g[1],Z=(0,R.useState)(0),i=p()(Z,2),f=i[0],d=i[1],o=(0,R.useState)([]),F=p()(o,2),v=F[0],C=F[1];(0,Q.Z)(k()(a()().mark(function m(){var l,h,B;return a()().wrap(function($){for(;;)switch($.prev=$.next){case 0:if(!n){$.next=9;break}return A(!0),b==null||(l=b.current)===null||l===void 0||l.forEach(function(L){var M;(M=L.current)===null||M===void 0||M.setFieldsValue({code:(0,la.MX)(9),appId:j})}),$.next=5,(0,U.Sf)({appId:j});case 5:h=$.sent,B=h.result,t(B),A(!1);case 9:case"end":return $.stop()}},m)})),[j,n]);var x=function(l){if(l.target.checked){C([].concat(Fe()(v),[l.target.value]));return}C(v==null?void 0:v.filter(function(h){return h!==l.target.value}))};return(0,e.jsxs)(le.L,{onFinish:function(){var m=k()(a()().mark(function l(h){var B;return a()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return A(!0),console.log("permissions",v),$.next=4,I==null?void 0:I(h);case 4:return B=$.sent,A(!1),d(0),$.abrupt("return",B);case 8:case"end":return $.stop()}},l)}));return function(l){return m.apply(this,arguments)}}(),current:f,onCurrentChange:d,formProps:{validateMessages:{required:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}},formMapRef:b,stepsFormRender:function(l,h){return(0,e.jsx)(Ue.Z,{title:"\u65B0\u589E\u89D2\u8272",width:600,forceRender:!0,onClose:function(){d(0),y()},open:n,footer:(0,e.jsx)(de.Z,{style:{float:"right"},children:h}),destroyOnClose:!0,children:(0,e.jsx)(re.Z,{spinning:c,children:l})})},children:[(0,e.jsxs)(le.L.StepForm,{scrollToFirstError:!0,name:"basic",title:"\u57FA\u672C\u4FE1\u606F",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},labelAlign:"right",children:[(0,e.jsx)(z.Z,{name:"appId",hidden:!0}),(0,e.jsx)(z.Z,{name:"name",label:"\u89D2\u8272\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",rules:[{required:!0,message:"\u89D2\u8272\u540D\u79F0\u4E3A\u5FC5\u586B\u9879"},{validator:function(){var m=k()(a()().mark(function h(B,w){var $,L,M;return a()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(w){P.next=2;break}return P.abrupt("return",Promise.resolve());case 2:return A(!0),P.next=5,(0,U.ld)(j,"NAME",w);case 5:if($=P.sent,L=$.success,M=$.result,A(!1),L){P.next=11;break}return P.abrupt("return",Promise.reject());case 11:if(M){P.next=13;break}return P.abrupt("return",Promise.reject(new Error("\u89D2\u8272\u540D\u79F0\u5DF2\u5B58\u5728")));case 13:case"end":return P.stop()}},h)}));function l(h,B){return m.apply(this,arguments)}return l}(),validateTrigger:["onBlur"]}]}),(0,e.jsx)(z.Z,{name:"code",label:"\u89D2\u8272\u6807\u8BC6",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u6807\u8BC6",rules:[{required:!0,message:"\u89D2\u8272\u6807\u8BC6\u4E3A\u5FC5\u586B\u9879"},{validator:function(){var m=k()(a()().mark(function h(B,w){var $,L,M;return a()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(w){P.next=2;break}return P.abrupt("return",Promise.resolve());case 2:return A(!0),P.next=5,(0,U.ld)(j,"CODE",w);case 5:if($=P.sent,L=$.success,M=$.result,A(!1),L){P.next=11;break}return P.abrupt("return",Promise.reject());case 11:if(M){P.next=13;break}return P.abrupt("return",Promise.reject(new Error("\u89D2\u8272\u6807\u8BC6\u5DF2\u5B58\u5728")));case 13:case"end":return P.stop()}},h)}));function l(h,B){return m.apply(this,arguments)}return l}(),validateTrigger:["onBlur"]}],extra:"\u89D2\u8272\u7F16\u7801\u5728\u5F53\u524D\u5E94\u7528\u4E2D\u7684\u552F\u4E00\u6807\u8BC6\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u4EC5\u652F\u6301\u82F1\u6587\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\uFF0C\u521B\u5EFA\u540E\u4E0D\u53EF\u4FEE\u6539\u3002"}),(0,e.jsx)(be.Z,{name:"remark",label:"\u89D2\u8272\u63CF\u8FF0",fieldProps:{rows:2},placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"})]}),(0,e.jsx)(le.L.StepForm,{scrollToFirstError:!0,name:"permission",title:"\u5206\u914D\u6743\u9650",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},children:s==null?void 0:s.map(function(m){var l,h,B,w,$;return(0,e.jsxs)("div",{children:[(0,e.jsx)(q.Z,{bordered:!1,children:(0,e.jsxs)(ia,{header:m.name,children:[m.menus.length>0&&(0,e.jsx)(W.Z.Group,{name:"menu_".concat(m.id),label:"\u83DC\u5355\u6743\u9650",layout:"vertical",options:(l=m.menus)===null||l===void 0?void 0:l.map(function(L){return{label:L.name,value:L.id,onChange:x}})}),m.buttons.length>0&&(0,e.jsx)(W.Z.Group,{name:"button_".concat(m.id),label:"\u6309\u94AE\u6743\u9650",layout:"vertical",options:(h=m.buttons)===null||h===void 0?void 0:h.map(function(L){return{label:L.name,value:L.id,onChange:x}})}),m.apis.length>0&&(0,e.jsx)(W.Z.Group,{name:"api_".concat(m.id),layout:"vertical",label:"\u63A5\u53E3\u6743\u9650",options:(B=m.apis)===null||B===void 0?void 0:B.map(function(L){return{label:L.name,value:L.id,onChange:x}})}),m.datas.length>0&&(0,e.jsx)(W.Z.Group,{name:"data_".concat(m.id),layout:"vertical",label:"\u6570\u636E\u6743\u9650",options:(w=m.apis)===null||w===void 0?void 0:w.map(function(L){return{label:L.name,value:L.id,onChange:x}})}),m.others.length>0&&(0,e.jsx)(W.Z.Group,{name:"other_".concat(m.id),layout:"vertical",label:"\u5176\u4ED6\u6743\u9650",options:($=m.apis)===null||$===void 0?void 0:$.map(function(L){return{label:L.name,value:L.id,onChange:x}})})]},m.id)},m.id),(0,e.jsx)("br",{})]},m.id)})})]},"create")},ca=oa,da=q.Z.Panel,pa=function(r){var n=r.open,y=r.onCancel,I=r.onFinish,j=r.id,b=(0,R.useState)(!1),D=p()(b,2),u=D[0],s=D[1],t=(0,R.useState)(),E=p()(t,2),g=E[0],c=E[1],A=(0,R.useRef)(),Z=(0,R.useRef)([]),i=(0,R.useState)(0),f=p()(i,2),d=f[0],o=f[1],F=(0,R.useState)([]),v=p()(F,2),C=v[0],x=v[1];(0,Q.Z)(k()(a()().mark(function l(){var h,B,w,$;return a()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!(n&&j)){M.next=14;break}return s(!0),c([]),M.next=5,(0,U.Yq)(j);case 5:if(h=M.sent,B=h.success,w=h.result,!(B&&w)){M.next=12;break}return Z==null||($=Z.current)===null||$===void 0||$.forEach(function(V){var P;(P=V.current)===null||P===void 0||P.setFieldsValue(N()({},w))}),s(!1),M.abrupt("return");case 12:y(),K.ZP.warning("\u672A\u83B7\u53D6\u5230\u8BE5".concat(j,"\u89D2\u8272\u6570\u636E\uFF01")).then();case 14:case"end":return M.stop()}},l)})),[j,y,n]);var m=function(h){if(h.target.checked){x([].concat(Fe()(C),[h.target.value]));return}x(C==null?void 0:C.filter(function(B){return B!==h.target.value}))};return(0,e.jsxs)(le.L,{onFinish:function(){var l=k()(a()().mark(function h(B){var w;return a()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return s(!0),console.log("permissions",C),L.next=4,I==null?void 0:I(B);case 4:return w=L.sent,s(!1),o(0),L.abrupt("return",w);case 8:case"end":return L.stop()}},h)}));return function(h){return l.apply(this,arguments)}}(),current:d,onCurrentChange:o,formProps:{validateMessages:{required:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}},formMapRef:Z,stepsFormRender:function(h,B){return(0,e.jsx)(Ue.Z,{title:"\u4FEE\u6539\u89D2\u8272",width:600,onClose:function(){o(0),y()},open:n,footer:(0,e.jsx)(de.Z,{style:{float:"right"},children:B}),destroyOnClose:!0,children:(0,e.jsxs)(re.Z,{spinning:u,children:[" ",h]})})},children:[(0,e.jsxs)(le.L.StepForm,{scrollToFirstError:!0,name:"basic",title:"\u57FA\u672C\u4FE1\u606F",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},labelAlign:"right",formRef:A,children:[(0,e.jsx)(z.Z,{name:"id",hidden:!0}),(0,e.jsx)(z.Z,{name:"appId",hidden:!0}),(0,e.jsx)(z.Z,{name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"},{validator:function(){var l=k()(a()().mark(function B(w,$){var L,M,V,P;return a()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if($){G.next=2;break}return G.abrupt("return",Promise.resolve());case 2:return s(!0),G.next=5,(0,U.ld)((L=A.current)===null||L===void 0?void 0:L.getFieldValue("appId"),"NAME",$,j);case 5:if(M=G.sent,V=M.success,P=M.result,s(!1),V){G.next=11;break}return G.abrupt("return",Promise.reject());case 11:if(P){G.next=13;break}return G.abrupt("return",Promise.reject(new Error("\u624B\u673A\u53F7\u5DF2\u5B58\u5728")));case 13:case"end":return G.stop()}},B)}));function h(B,w){return l.apply(this,arguments)}return h}(),validateTrigger:["onBlur"]}],placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"}),(0,e.jsx)(z.Z,{name:"code",label:"\u6807\u8BC6",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u6807\u8BC6",readonly:!0,proFieldProps:{render:function(h){return h&&(0,e.jsx)(ir.Z,{copyable:{text:h},style:{marginBottom:"0"},children:(0,e.jsx)("span",{dangerouslySetInnerHTML:{__html:"<span>".concat(h,"</span>")}})})}},extra:"\u89D2\u8272\u7F16\u7801\u5728\u5F53\u524D\u5E94\u7528\u4E2D\u7684\u552F\u4E00\u6807\u8BC6\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u4EC5\u652F\u6301\u82F1\u6587\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\uFF0C\u521B\u5EFA\u540E\u4E0D\u53EF\u4FEE\u6539\u3002"}),(0,e.jsx)(be.Z,{name:"remark",fieldProps:{rows:2},label:"\u63CF\u8FF0",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"})]}),(0,e.jsx)(le.L.StepForm,{scrollToFirstError:!0,name:"permission",title:"\u5206\u914D\u6743\u9650",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},children:g==null?void 0:g.map(function(l){var h,B,w,$,L;return(0,e.jsxs)("div",{children:[(0,e.jsx)(q.Z,{bordered:!1,children:(0,e.jsxs)(da,{header:l.name,children:[l.menus.length>0&&(0,e.jsx)(W.Z.Group,{name:"menu_".concat(l.id),label:"\u83DC\u5355\u6743\u9650",layout:"vertical",options:(h=l.menus)===null||h===void 0?void 0:h.map(function(M){return{label:M.name,value:M.id,onChange:m}})}),l.buttons.length>0&&(0,e.jsx)(W.Z.Group,{name:"button_".concat(l.id),label:"\u6309\u94AE\u6743\u9650",layout:"vertical",options:(B=l.buttons)===null||B===void 0?void 0:B.map(function(M){return{label:M.name,value:M.id,onChange:m}})}),l.apis.length>0&&(0,e.jsx)(W.Z.Group,{name:"api_".concat(l.id),layout:"vertical",label:"\u63A5\u53E3\u6743\u9650",options:(w=l.apis)===null||w===void 0?void 0:w.map(function(M){return{label:M.name,value:M.id,onChange:m}})}),l.datas.length>0&&(0,e.jsx)(W.Z.Group,{name:"data_".concat(l.id),layout:"vertical",label:"\u6570\u636E\u6743\u9650",options:($=l.apis)===null||$===void 0?void 0:$.map(function(M){return{label:M.name,value:M.id,onChange:m}})}),l.others.length>0&&(0,e.jsx)(W.Z.Group,{name:"other_".concat(l.id),layout:"vertical",label:"\u5176\u4ED6\u6743\u9650",options:(L=l.apis)===null||L===void 0?void 0:L.map(function(M){return{label:M.name,value:M.id,onChange:m}})})]},l.id)},l.id),(0,e.jsx)("br",{})]},l.id)})})]},"update")},ma=pa,fa=sr.Z.confirm,va=function(T){var r=(0,R.useRef)(),n=T.appId,y=(0,R.useState)(!1),I=p()(y,2),j=I[0],b=I[1],D=(0,R.useState)(!1),u=p()(D,2),s=u[0],t=u[1],E=(0,R.useState)(),g=p()(E,2),c=g[0],A=g[1],Z=[{title:"\u89D2\u8272\u540D\u79F0",dataIndex:"name",ellipsis:!0,fixed:"left"},{title:"\u89D2\u8272\u7F16\u7801",dataIndex:"code",copyable:!0,search:!1},{title:"\u72B6\u6001",dataIndex:"enabled",search:!1,align:"center",render:function(f,d){return(0,e.jsx)(lr.Z,{checked:f,onChange:function(){var o=k()(a()().mark(function F(v){var C,x,m;return a()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!v){h.next=9;break}return h.next=3,(0,U.Ko)(d.id);case 3:if(C=h.sent,x=C.success,!x){h.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(m=r.current)===null||m===void 0||m.reload(),h.abrupt("return");case 9:fa({title:"\u8B66\u544A",icon:(0,e.jsx)(ur.Z,{}),content:"\u786E\u5B9A\u7981\u7528\u6B64\u89D2\u8272\uFF1F",okText:"\u786E\u5B9A",okType:"danger",cancelText:"\u53D6\u6D88",centered:!0,onOk:function(){var B=k()(a()().mark(function $(){var L,M,V;return a()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,U.RN)(d.id);case 2:if(L=O.sent,M=L.success,!M){O.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(V=r.current)===null||V===void 0||V.reload(),O.abrupt("return");case 8:case"end":return O.stop()}},$)}));function w(){return B.apply(this,arguments)}return w}(),onCancel:function(){}});case 10:case"end":return h.stop()}},F)}));return function(F){return o.apply(this,arguments)}}()})}},{title:"\u89D2\u8272\u63CF\u8FF0",ellipsis:!0,dataIndex:"remark",search:!1,copyable:!1},{title:"\u64CD\u4F5C",align:"center",valueType:"option",width:180,fixed:"right",render:function(f,d){return[(0,e.jsx)("a",{target:"_blank",onClick:function(){t(!0),A(d.id)},children:"\u4FEE\u6539"},"update"),(0,e.jsx)(Se.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(Ce.Z,{style:{color:"red"}}),onConfirm:k()(a()().mark(function o(){var F,v,C;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,U.AO)(d.id);case 2:if(F=m.sent,v=F.success,!v){m.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(C=r.current)===null||C===void 0||C.reload(),m.abrupt("return");case 8:case"end":return m.stop()}},o)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u5220\u9664"},"remove")},"delete")]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(we.Z,{columns:Z,pagination:{showQuickJumper:!0,defaultPageSize:10},rowSelection:{selections:[ve.Z.SELECTION_ALL,ve.Z.SELECTION_INVERT]},style:{height:"calc(100vh - 190px)",overflow:"auto"},cardProps:{style:{minHeight:"100%"}},scroll:{x:700},options:!1,tableAlertRender:function(f){var d=f.selectedRowKeys,o=f.onCleanSelected;return(0,e.jsx)(de.Z,{size:24,children:(0,e.jsxs)("span",{children:["\u5DF2\u9009 ",d.length," \u9879",(0,e.jsx)("a",{style:{marginLeft:8},onClick:o,children:"\u53D6\u6D88\u9009\u62E9"})]})})},tableAlertOptionRender:function(f){return(0,e.jsx)(de.Z,{size:16,children:(0,e.jsx)(Se.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(Ce.Z,{style:{color:"red"}}),onConfirm:k()(a()().mark(function d(){var o,F,v;return a()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,U.O0)(f.selectedRowKeys);case 2:if(o=x.sent,F=o.success,!F){x.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),f.onCleanSelected(),(v=r.current)===null||v===void 0||v.reload(),x.abrupt("return");case 9:case"end":return x.stop()}},d)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u6279\u91CF\u5220\u9664"},"remove")},"delete")})},actionRef:r,params:{appId:n},request:U.TT,rowKey:"id",dateFormatter:"string",toolbar:{search:!1,actions:[(0,e.jsx)(fe.Z,{type:"primary",icon:(0,e.jsx)(ye.Z,{}),onClick:function(){b(!0)},children:"\u65B0\u589E\u89D2\u8272"},"create")]}}),(0,e.jsx)(ca,{appId:n,open:j,onCancel:function(){b(!1)},onFinish:function(){var i=k()(a()().mark(function f(d){var o,F,v,C;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,U.pW)(d);case 2:if(o=m.sent,F=o.success,v=o.result,!(F&&v)){m.next=10;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(C=r.current)===null||C===void 0||C.reload(),b(!1),m.abrupt("return");case 10:case"end":return m.stop()}},f)}));return function(f){return i.apply(this,arguments)}}()}),(0,e.jsx)(ma,{id:c,open:s,onCancel:function(){t(!1)},onFinish:function(){var i=k()(a()().mark(function f(d){var o,F,v,C;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,U.UC)(d);case 2:o=m.sent,F=o.success,v=o.result,F&&v&&((C=r.current)===null||C===void 0||C.reload(),t(!1),K.ZP.success("\u64CD\u4F5C\u6210\u529F"));case 6:case"end":return m.stop()}},f)}));return function(f){return i.apply(this,arguments)}}()})]})},ha=function(T){var r=T.app,n=r.id,y=r.initLoginType,I=r.authorizationType,j=r.initLoginUrl,b=H.Z.useForm(),D=p()(b,1),u=D[0],s=(0,R.useState)(!0),t=p()(s,2),E=t[0],g=t[1];return(0,Q.Z)(k()(a()().mark(function c(){var A,Z,i;return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return g(!0),d.next=3,(0,U.hq)(n);case 3:A=d.sent,Z=A.result,i=A.success,i&&Z&&u.setFieldsValue({initLoginType:y,authorizationType:I,initLoginUrl:j}),g(!1);case 8:case"end":return d.stop()}},c)}))),(0,e.jsx)(re.Z,{spinning:E,children:(0,e.jsx)(ue.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},message:"\u6682\u672A\u5B9E\u73B0"})})},ga=ha,Fa=function(T){var r=T.app,n=r.id,y=r.initLoginType,I=r.authorizationType,j=r.initLoginUrl,b=H.Z.useForm(),D=p()(b,1),u=D[0],s=(0,R.useState)(!0),t=p()(s,2),E=t[0],g=t[1];return(0,Q.Z)(k()(a()().mark(function c(){var A,Z,i;return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return g(!0),d.next=3,(0,U.hq)(n);case 3:A=d.sent,Z=A.result,i=A.success,i&&Z&&u.setFieldsValue(N()(N()({},Z),{},{initLoginType:y,authorizationType:I,initLoginUrl:j})),g(!1);case 8:case"end":return d.stop()}},c)}))),(0,e.jsx)(re.Z,{spinning:E,children:(0,e.jsx)(ue.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},message:"\u6682\u672A\u5B9E\u73B0"})})},Ca=Fa,xa=function(T){var r=T.app,n=r.id,y=r.initLoginType,I=r.authorizationType,j=H.Z.useForm(),b=p()(j,1),D=b[0],u=(0,R.useState)(!0),s=p()(u,2),t=s[0],E=s[1];return(0,Q.Z)(k()(a()().mark(function g(){var c,A,Z;return a()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return E(!0),f.next=3,(0,U.hq)(n);case 3:c=f.sent,A=c.result,Z=c.success,Z&&A&&D.setFieldsValue({initLoginType:y,authorizationType:I}),E(!1);case 8:case"end":return f.stop()}},g)}))),(0,e.jsx)(re.Z,{spinning:t,children:(0,e.jsx)(ue.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},message:"\u6682\u672A\u5B9E\u73B0"})})},Sa=xa,ya=S(5200),ba=S.n(ya),He=S(2236),je=S(52688),ae=S(64317),Ye=S(31199),ja=S(78234),or=S(69677),ie=S(17057),Ea=q.Z.Panel,Aa=function(T){var r=H.Z.useForm(),n=p()(r,1),y=n[0],I=T.protocolEndpoint,j=T.appId,b=T.collapsed,D=b===void 0?!0:b;return(0,Q.Z)(k()(a()().mark(function u(){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:y.setFieldsValue(I);case 1:case"end":return t.stop()}},u)})),[j,I]),(0,e.jsx)(pe.A,{layout:"horizontal",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}},labelAlign:"right",submitter:!1,form:y,children:(0,e.jsx)(q.Z,{ghost:!0,expandIconPosition:"start",defaultActiveKey:D?void 0:"config",children:(0,e.jsx)(Ea,{header:(0,e.jsx)("a",{children:"\u5E94\u7528\u914D\u7F6E\u4FE1\u606F"}),children:(0,e.jsx)(ue.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},description:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(z.Z,{label:"Issuer",name:"issuer",extra:"\u7528\u4E8E\u6807\u8BC6 token \u53D1\u653E\u6765\u6E90\u7684\u5B57\u6BB5\u3002\u540C\u65F6\u662F\u4E0B\u8FF0\u63A5\u53E3\u7684 baseUrl\u3002",proFieldProps:{render:function(s){return s&&(0,e.jsx)(ie.Z.Text,{copyable:!0,children:s})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(z.Z,{label:"\u53D1\u73B0\u7AEF\u70B9",name:"discoveryEndpoint",extra:"\u7528\u4E8E\u83B7\u53D6\u5F53\u524D IAM \u652F\u6301\u7684\u5404\u7AEF\u70B9\u4FE1\u606F\u548C\u652F\u6301\u7684\u6A21\u5F0F\u3001\u53C2\u6570\u4FE1\u606F\uFF0C\u53EF\u516C\u5F00\u8BBF\u95EE\u3002",proFieldProps:{render:function(s){return s&&(0,e.jsx)(ie.Z.Text,{copyable:!0,children:s})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(z.Z,{label:"\u6388\u6743\u7AEF\u70B9",name:"authorizationEndpoint",extra:"\u5E94\u7528\u53D1\u8D77\u5355\u70B9\u767B\u5F55\u7684\u5730\u5740\u3002",proFieldProps:{render:function(s){return s&&(0,e.jsx)(ie.Z.Text,{copyable:!0,children:s})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(z.Z,{label:"\u4EE4\u724C\u7AEF\u70B9",name:"tokenEndpoint",extra:"\u5E94\u7528\u5728\u5355\u70B9\u767B\u5F55\u8FC7\u7A0B\u4E2D\uFF0C\u62FF\u5230 code \u540E\uFF0C\u4ECE\u540E\u7AEF\u53D1\u53BB\u6362\u53D6 token \u7684\u63A5\u53E3\u5730\u5740\u3002",proFieldProps:{render:function(s){return s&&(0,e.jsx)(ie.Z.Text,{copyable:!0,children:s})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(z.Z,{label:"\u4EE4\u724C\u540A\u9500\u7AEF\u70B9",name:"revokeEndpoint",proFieldProps:{render:function(s){return s&&(0,e.jsx)(ie.Z.Text,{copyable:!0,children:s})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(z.Z,{label:"\u9A8C\u7B7E\u516C\u94A5\u7AEF\u70B9",name:"jwksEndpoint",extra:"\u7528\u4E8E\u9A8C\u8BC1 id_token\u3001\u5B8C\u6210 SSO \u6D41\u7A0B\u7684\u516C\u94A5\u7AEF\u70B9\u3002\u516C\u94A5\u53EF\u80FD\u4F1A\u8F6E\u8F6C\u3002",proFieldProps:{render:function(s){return s&&(0,e.jsx)(ie.Z.Text,{copyable:!0,children:s})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(z.Z,{label:"\u7528\u6237\u4FE1\u606F\u7AEF\u70B9",name:"userinfoEndpoint",extra:"\u5728\u8D26\u6237\u767B\u5F55\u540E\uFF0C\u4F7F\u7528 access_token \u8C03\u7528\u7528\u6237\u4FE1\u606F\u7AEF\u70B9\uFF0C\u83B7\u53D6\u8D26\u6237\u57FA\u672C\u4FE1\u606F\u3002",proFieldProps:{render:function(s){return s&&(0,e.jsx)(ie.Z.Text,{copyable:!0,children:s})}},readonly:!0,fieldProps:{autoComplete:"off"}})]})})},"config")})})},Za=S(48689),Pa=q.Z.Panel,cr={labelCol:{span:6},wrapperCol:{span:12}},dr={wrapperCol:{span:12,offset:6}},Ia=function(T){var r=T.app,n=r.id,y=r.template,I=H.Z.useForm(),j=p()(I,1),b=j[0],D=(0,R.useState)({}),u=p()(D,2),s=u[0],t=u[1],E=(0,R.useState)(!0),g=p()(E,2),c=g[0],A=g[1];return(0,ja.Z)(k()(a()().mark(function Z(){var i,f,d,o;return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return A(!0),v.next=3,(0,U.hq)(n);case 3:i=v.sent,f=i.result,d=i.success,d&&f&&(b.setFieldsValue(N()(N()({appId:n},f),{},{redirectUris:((o=f.redirectUris)===null||o===void 0?void 0:o.length)>0?f.redirectUris:[void 0]})),t(f.protocolEndpoint)),A(!1);case 8:case"end":return v.stop()}},Z)}))),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(re.Z,{spinning:c,children:[(0,e.jsx)(ue.Z,{showIcon:!0,message:(0,e.jsxs)("span",{children:["\u4E0D\u77E5\u9053\u600E\u4E48\u914D\u7F6E\uFF1F\u8BF7\u53C2\u8003 TopIAM \u914D\u7F6E"," ",(0,e.jsx)("a",{target:"_blank",href:"https://eiam.topiam.cn/docs/application/standard/oidc-sso",rel:"noreferrer",children:"OIDC \u5355\u70B9\u767B\u5F55"})," ","\u3002"]})}),(0,e.jsx)("br",{}),(0,e.jsxs)(pe.A,N()(N()({requiredMark:!0,layout:"horizontal"},cr),{},{form:b,scrollToFirstError:!0,onFinish:function(){var Z=k()(a()().mark(function i(f){var d,o;return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,U.$c)({id:n,template:y,config:(0,me.omit)(f,"id","template")});case 2:if(d=v.sent,o=d.success,!o){v.next=7;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),v.abrupt("return",!0);case 7:return K.ZP.error("\u64CD\u4F5C\u5931\u8D25"),v.abrupt("return",!1);case 9:case"end":return v.stop()}},i)}));return function(i){return Z.apply(this,arguments)}}(),submitter:{render:function(i,f){return(0,e.jsx)(He.S,{children:f})}},children:[(0,e.jsx)(z.Z,{name:"appId",hidden:!0}),(0,e.jsx)(W.Z.Group,{label:"\u6388\u6743\u6A21\u5F0F",layout:"vertical",name:"authGrantTypes",rules:[{required:!0,message:"\u8BF7\u52FE\u9009\u6388\u6743\u6A21\u5F0F"}],options:[{value:"authorization_code",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"\u6388\u6743\u7801\u6A21\u5F0F"}),(0,e.jsx)("span",{style:{color:"#999"},children:"authorization_code \u6A21\u5F0F\uFF0C\u7528\u4E8E\u8D26\u6237\u7684\u767B\u5F55\u8BA4\u8BC1\u3001\u6388\u6743\u3002"})]})},{value:"refresh_token",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"\u4EE4\u724C\u5237\u65B0\u6A21\u5F0F"}),(0,e.jsx)("span",{style:{color:"#999"},children:"refresh_token \u6A21\u5F0F\uFF0C\u7528\u4E8E\u65E2\u6709 token \u7684\u5EF6\u671F\u3002"})]})},{value:"implicit",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"\u9690\u5F0F\u6A21\u5F0F"}),(0,e.jsx)("span",{style:{color:"#999"},children:"implicit \u6A21\u5F0F\uFF0C\u7531\u4E8E\u534F\u8BAE\u672C\u8EAB\u7684\u5B89\u5168\u6027\uFF0C\u901A\u5E38\u4E0D\u63A8\u8350\u4F7F\u7528\u3002\u5982\u679C\u6709\u7279\u6B8A\u9700\u6C42\uFF0C\u53EF\u4EE5\u4F7F\u7528\u53D8\u4F53\u7684 PKCE \u7684\u6388\u6743\u7801\u6A21\u5F0F\u3002"})]})},{value:"password",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"\u5BC6\u7801\u6A21\u5F0F"}),(0,e.jsx)("span",{style:{color:"#999"},children:"password \u6A21\u5F0F\uFF0C\u7531\u4E8E\u534F\u8BAE\u672C\u8EAB\u7684\u5B89\u5168\u6027\uFF0C\u901A\u5E38\u4E0D\u63A8\u8350\u4F7F\u7528\u3002"})]})},{value:"device",disabled:!0,label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"\u8BBE\u5907\u6A21\u5F0F"}),(0,e.jsx)("span",{style:{color:"#999"},children:"device \u6A21\u5F0F\uFF0C\u517C\u5BB9\u8BBE\u5907\u53D1\u8D77\u7684\u767B\u5F55\u6D41\u7A0B\u3002\uFF08\u6682\u4E0D\u652F\u6301\uFF09"})]})}]}),(0,e.jsx)(xe.Z,{name:["authGrantTypes"],children:function(i){var f=i.authGrantTypes;return(f==null?void 0:f.includes("authorization_code"))&&(0,e.jsx)(je.Z,{label:"PKCE\uFF08\u7528\u4E8E\u6388\u6743\u7801\u6A21\u5F0F\uFF09",name:"requireProofKey",extra:"PKCE \uFF08Proof Key for Code Exchange\uFF09\u662F OAuth 2.0 \u7684\u5B89\u5168\u6027\u6269\u5C55\u6A21\u5F0F\uFF0C\u7528\u4E8E\u9632\u62A4 CSRF\u3001\u4E2D\u95F4\u4EBA\u8FDB\u653B\u7B49\u6076\u610F\u653B\u51FB\u3002"})}}),(0,e.jsx)(H.Z.List,{name:"redirectUris",rules:[{validator:function(){var Z=k()(a()().mark(function f(d,o){return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(o&&o.length>0)){v.next=2;break}return v.abrupt("return");case 2:throw new Error("\u8BF7\u914D\u7F6E\u767B\u5F55 Redirect URI");case 3:case"end":return v.stop()}},f)}));function i(f,d){return Z.apply(this,arguments)}return i}()}],children:function(i,f,d){var o=f.add,F=f.remove;return ba()(d),(0,e.jsxs)(e.Fragment,{children:[i.map(function(v,C){return(0,R.createElement)(H.Z.Item,N()(N()({},C===0?cr:dr),{},{required:!1,key:v.key,label:C===0?"\u767B\u5F55 Redirect URI":"",extra:C===i.length-1&&"Redirect URI \u767D\u540D\u5355\uFF0C\u5E94\u7528\u5728\u8BF7\u6C42\u767B\u5F55\u65F6\u643A\u5E26 redirect_uri \u53C2\u6570\uFF0C\u8BE5\u503C\u9700\u8981\u5728\u767D\u540D\u5355\u4E2D\uFF0CIAM \u624D\u4F1A\u5728\u8BA4\u8BC1\u5B8C\u6210\u540E\u53D1\u8D77\u8DF3\u8F6C\u3002\u82E5\u6709\u591A\u6761\uFF0C\u8BF7\u70B9\u51FB\u6DFB\u52A0\u8FDB\u884C\u6269\u5C55"}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,e.jsx)(H.Z.Item,N()(N()({},v),{},{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"\u8BF7\u914D\u7F6E\u767B\u5F55 Redirect URI"},{type:"url",message:"Redirect URI \u683C\u5F0F\u4E0D\u6B63\u786E"}],noStyle:!0,children:(0,e.jsx)(or.Z,{placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55 Redirect URI"})})),i.length>1?(0,e.jsx)(Za.Z,{onClick:function(){return F(v.name)}}):null]}))}),(0,e.jsx)(H.Z.Item,N()(N()({},dr),{},{children:(0,e.jsx)(fe.Z,{type:"dashed",onClick:function(){return o()},icon:(0,e.jsx)(ye.Z,{}),style:{width:"100%"},children:"\u6DFB\u52A0"})}))]})}}),(0,e.jsx)(ae.Z,{label:"\u6388\u6743\u8303\u56F4",name:"authorizationType",allowClear:!1,extra:"\u82E5\u9009\u62E9\u624B\u52A8\u6388\u6743\uFF0C\u9700\u8981\u5728 \u8BBF\u95EE\u6388\u6743 \u4E2D\u8FDB\u884C\u6743\u9650\u5206\u914D\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u8303\u56F4"}],options:[{value:ge.AUTHORIZATION,label:"\u624B\u52A8\u6388\u6743"},{value:ge.ALL_ACCESS,label:"\u5168\u5458\u53EF\u8BBF\u95EE"}]}),(0,e.jsx)(ae.Z,{label:"SSO \u53D1\u8D77\u65B9",name:"initLoginType",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u914D\u7F6E SSO \u53D1\u8D77\u65B9"}],options:[{value:he.APP,label:"\u53EA\u5141\u8BB8\u5E94\u7528\u53D1\u8D77"},{value:he.PORTAL_OR_APP,label:"\u652F\u6301\u95E8\u6237\u548C\u5E94\u7528\u53D1\u8D77"}],extra:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:"\u95E8\u6237\u53D1\u8D77\uFF1A\u7531 IAM \u95E8\u6237\u9875\u70B9\u51FB\u8FDB\u884C SSO \u3002"}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:"\u5E94\u7528\u53D1\u8D77\uFF1A\u7531\u5E94\u7528\u767B\u5F55\u4E3B\u52A8\u53D1\u8D77\u3002"})]})}),(0,e.jsx)(xe.Z,{name:["initLoginType"],children:function(i){return(i==null?void 0:i.initLoginType)===he.PORTAL_OR_APP&&(0,e.jsx)(z.Z,{label:"\u767B\u5F55\u53D1\u8D77\u5730\u5740",name:"initLoginUrl",rules:[{required:!0,message:"\u767B\u5F55\u53D1\u8D77\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A"}],fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u94FE\u63A5"},extra:"\u82E5\u60A8\u5E0C\u671B\u7531 TopIAM \u95E8\u6237\u9875\u8BBF\u95EE\u5E94\u7528\uFF0C\u8BF7\u586B\u5199 TopIAM \u53D1\u8D77 SSO \u8BF7\u6C42\u8BBF\u95EE\u7684\u5E94\u7528\u5730\u5740\u3002\u8BE5\u5730\u5740\u63A5\u6536\u5230\u8BF7\u6C42\uFF0C\u5E94\u5373\u523B\u8F6C\u5411 TopIAM / authorize \u6388\u6743\u7AEF\u70B9\u3002"})}}),(0,e.jsx)(ee.Z,{style:{margin:0}}),(0,e.jsx)(q.Z,{ghost:!0,expandIconPosition:"start",defaultActiveKey:"advanced",children:(0,e.jsxs)(Pa,{header:(0,e.jsx)("a",{children:"\u663E\u793A\u9AD8\u7EA7\u914D\u7F6E"}),children:[(0,e.jsx)(W.Z.Group,{label:"\u7528\u6237\u4FE1\u606F\u8303\u56F4",layout:"vertical",name:"grantScopes",rules:[{required:!0,message:"\u8BF7\u52FE\u9009\u7528\u6237\u4FE1\u606F\u8303\u56F4"}],extra:"\u7528\u6237\u767B\u5F55\u540E\uFF0C\u4F7F\u7528\u7528\u6237\u4FE1\u606F\u7AEF\u70B9\u6216\u89E3\u6790 id_token \u53EF\u4EE5\u83B7\u53D6\u5230\u7684\u5DF2\u767B\u5F55\u7528\u6237\u4FE1\u606F \u3002",options:[{value:"openid",label:"openid",disabled:!0},{value:"email",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"email"}),(0,e.jsx)("span",{style:{color:"#999"},children:"\u5E94\u7528\u53EF\u83B7\u53D6\u767B\u5F55\u7528\u6237\u90AE\u7BB1\u4FE1\u606F\u3002"})]})},{value:"phone",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"phone"}),(0,e.jsx)("span",{style:{color:"#999"},children:"\u5E94\u7528\u53EF\u83B7\u53D6\u767B\u5F55\u7528\u6237\u624B\u673A\u4FE1\u606F\u3002"})]})},{value:"profile",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"profile"}),(0,e.jsx)("span",{style:{color:"#999"},children:"\u5E94\u7528\u53EF\u83B7\u53D6\u767B\u5F55\u7528\u6237\u8BE6\u60C5\u4FE1\u606F\u3002"})]})}]}),(0,e.jsx)(Ye.Z,{label:"access_token \u6709\u6548\u671F",name:"accessTokenTimeToLive",addonAfter:"\u5206\u949F",extra:"access_token \u7528\u4E8E\u8BF7\u6C42 IAM \u63A5\u53E3\uFF0C\u8FC7\u671F\u540E\u9700\u8981\u4F7F\u7528 refresh_token \u5237\u65B0\uFF0C\u6216\u91CD\u65B0\u767B\u5F55\u3002"}),(0,e.jsx)(Ye.Z,{label:"refresh_token \u6709\u6548\u671F",name:"refreshTokenTimeToLive",addonAfter:"\u5206\u949F",extra:"\u7528\u4E8E\u83B7\u53D6\u65B0\u7684 access_token \u548C id_token\uFF0Crefresh_token \u8FC7\u671F\u540E\uFF0C\u7528\u6237\u9700\u8981\u91CD\u65B0\u767B\u5F55\u3002"}),(0,e.jsx)(Ye.Z,{label:"id_token \u6709\u6548\u671F",readonly:!0,name:"idTokenTimeToLive",addonAfter:"\u5206\u949F\uFF08\u6682\u4E0D\u652F\u6301\u4FEE\u6539\uFF09",extra:"id_token \u7528\u4E8E\u9274\u522B\u7528\u6237\u8EAB\u4EFD\uFF0CJWT\u683C\u5F0F\uFF0C\u5141\u8BB8\u5E94\u7528\u4F7F\u7528\u516C\u94A5\u81EA\u884C\u9A8C\u8BC1\u7528\u6237\u8EAB\u4EFD\u3002\u6700\u5C0F5\u5206\u949F\uFF0C\u6700\u592724\u5C0F\u65F6\uFF0C\u8FC7\u671F\u540E\u9700\u8981\u4F7F\u7528refresh_token \u5237\u65B0\uFF0C\u6216\u91CD\u65B0\u767B\u5F55\u3002"}),(0,e.jsx)(ae.Z,{options:[{value:"ES256",label:"ES256"},{value:"RS256",label:"RS256"}],label:"id_token \u7B7E\u540D\u7B97\u6CD5",name:"idTokenSignatureAlgorithm",allowClear:!1,extra:"id_token \u7B7E\u540D\u4F7F\u7528\u7684\u975E\u5BF9\u79F0\u7B97\u6CD5\u3002",rules:[{required:!0,message:"\u8BF7\u914D\u7F6E id_token \u7B7E\u540D\u7B97\u6CD5"}]})]},"advanced")})]})),(0,e.jsx)(ee.Z,{style:{margin:0}}),(0,e.jsx)(Aa,{appId:n,protocolEndpoint:s,collapsed:!0})]})})},wa=Ia,Ra=S(59022),pr=S(66017),Ta=q.Z.Panel,mr=function(T){var r=H.Z.useForm(),n=p()(r,1),y=n[0],I=T.protocolEndpoint,j=T.appId,b=T.collapsed,D=b===void 0?!0:b;(0,Q.Z)(k()(a()().mark(function s(){return a()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:y.setFieldsValue(I);case 1:case"end":return E.stop()}},s)})),[j,I]),(0,Q.Z)(k()(a()().mark(function s(){var t;return a()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,U.O$)(j,ke.SAML_SIGN);case 2:t=g.sent,t.success&&t.result&&t.result.forEach(function(c){c.usingType===ke.SAML_SIGN&&y.setFieldsValue({idpSignCert:c.cert})});case 4:case"end":return g.stop()}},s)})),[j]);var u=function(){var t=y.getFieldValue("idpSignCert");if(!!t){var E=new Blob([t],{type:"application/x-x509-ca-cert"}),g=URL.createObjectURL(E),c=document.createElement("a");c.href=g,c.download=j+"sign.cer",document.documentElement.appendChild(c),c.click(),document.documentElement.removeChild(c)}};return(0,e.jsx)(pe.A,{layout:"horizontal",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}},labelAlign:"right",submitter:!1,form:y,scrollToFirstError:!0,children:(0,e.jsx)(q.Z,{ghost:!0,expandIconPosition:"start",defaultActiveKey:D?void 0:"config",children:(0,e.jsx)(Ta,{header:(0,e.jsx)("a",{children:"\u5E94\u7528\u914D\u7F6E\u4FE1\u606F"}),children:(0,e.jsx)(ue.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},description:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(z.Z,{label:"IdP \u5143\u6570\u636E",name:"idpMetaEndpoint",extra:"\u82E5\u5E94\u7528\u652F\u6301 metadata \u914D\u7F6E\u4FE1\u606F\u4E0A\u4F20/\u62C9\u53D6\uFF0C\u53EF\u4EE5\u8282\u7701\u5927\u91CF\u914D\u7F6E\u6B65\u9AA4\u3002\u8BF7\u5728\u5E94\u7528 SSO \u914D\u7F6E\u4E2D\u5BFB\u627E\u662F\u5426\u6709 metadata \u4E0A\u4F20\u80FD\u529B\u3002",proFieldProps:{render:function(t){return t&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ie.Z.Text,{copyable:!0,children:t}),(0,e.jsxs)("a",{style:{whiteSpace:"nowrap",marginLeft:"10px"},onClick:k()(a()().mark(function E(){return a()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,U.zA)(j);case 2:case"end":return c.stop()}},E)})),children:[(0,e.jsx)(pr.Z,{}),"\u4E0B\u8F7D"]})]})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(z.Z,{label:"IdP \u552F\u4E00\u6807\u8BC6",name:"idpEntityIdEndpoint",extra:"IAM \u5728\u5E94\u7528\u4E2D\u7684\u6807\u8BC6\u3002\u9700\u8981\u5C06\u503C\u586B\u5199\u5728\u5E94\u7528\u5355\u70B9\u767B\u5F55\u914D\u7F6E\u4E2D\u3002",readonly:!0,proFieldProps:{render:function(t){return t&&(0,e.jsx)(ie.Z.Text,{copyable:!0,children:t})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(z.Z,{label:"IdP SSO \u5730\u5740",name:"idpSsoEndpoint",extra:"SAML \u534F\u8BAE\u652F\u6301 SP \u53D1\u8D77\u5355\u70B9\u767B\u5F55\uFF0C\u53EF\u80FD\u9700\u8981\u586B\u5199\u6B64\u5730\u5740\u5728\u5E94\u7528\u914D\u7F6E\u4E2D\u3002\u7531 IAM \u63D0\u4F9B\u3002\u53EF\u4EE5\u76F4\u63A5\u8BBF\u95EE\u8BE5\u5730\u5740\uFF0C\u8FDB\u884C\u5E94\u7528\u767B\u5F55\u3002",readonly:!0,proFieldProps:{render:function(t){return t&&(0,e.jsx)(ie.Z.Text,{copyable:!0,children:t})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(z.Z,{label:"\u5355\u70B9\u9000\u51FA\u5730\u5740",name:"idpSloEndpoint",extra:"SAML \u534F\u8BAE\u652F\u6301\u5355\u70B9\u9000\u51FA\uFF0C\u53EF\u80FD\u9700\u8981\u586B\u5199\u6B64\u5730\u5740\u5728\u5E94\u7528\u914D\u7F6E\u4E2D\u3002\u7531 IAM \u63D0\u4F9B\u3002",readonly:!0,proFieldProps:{render:function(t){return t&&(0,e.jsx)(ie.Z.Text,{copyable:!0,children:t})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(be.Z,{label:"\u7B7E\u540D\u516C\u94A5\u8BC1\u4E66",name:"idpSignCert",disabled:!0,fieldProps:{autoComplete:"off",rows:3},extra:(0,e.jsxs)("div",{style:{display:"inline-block"},children:[(0,e.jsx)("div",{style:{display:"inline-block"},children:"\u4E0B\u8F7D\u6216\u590D\u5236\u8BC1\u4E66\uFF0C\u5E76\u5BFC\u5165\u6216\u7C98\u8D34\u5230\u5E94\u7528\u4E2D\u3002"}),(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,e.jsx)(ie.Z.Paragraph,{style:{display:"inline-block"},copyable:{text:y.getFieldValue("idpSignCert")},children:(0,e.jsx)("a",{children:"\u590D\u5236\u8BC1\u4E66\u5185\u5BB9"})}),(0,e.jsxs)("a",{onClick:u,children:["\u4E0B\u8F7D\u8BC1\u4E66 .cer \u6587\u4EF6",(0,e.jsx)(pr.Z,{})]})]})]})})]})})},"config")})})},Ba=function(T){var r=T.app,n=r.id,y=r.template,I=H.Z.useForm(),j=p()(I,1),b=j[0],D=(0,R.useState)(!0),u=p()(D,2),s=u[0],t=u[1],E=(0,R.useState)([]),g=p()(E,2),c=g[0],A=g[1],Z=(0,R.useState)({}),i=p()(Z,2),f=i[0],d=i[1];return(0,Q.Z)(k()(a()().mark(function o(){var F,v,C;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return t(!0),(0,U.P3)(y).then(function(l){var h=l.success,B=l.result;h&&A(B)}),m.next=4,(0,U.hq)(n);case 4:F=m.sent,v=F.result,C=F.success,C&&v&&(b.setFieldsValue(N()({},(0,me.omit)(v,"protocolEndpoint"))),d(v.protocolEndpoint)),t(!1);case 9:case"end":return m.stop()}},o)})),[]),(0,e.jsxs)(re.Z,{spinning:s,children:[(0,e.jsx)(ue.Z,{showIcon:!0,message:(0,e.jsxs)(e.Fragment,{children:["\u4E0D\u77E5\u9053\u600E\u4E48\u914D\u7F6E\uFF1F\u8BF7\u53C2\u8003 ",(0,e.jsx)("a",{children:"\u5BF9\u63A5\u6587\u6863 "})," \u3002"]})}),(0,e.jsx)("br",{}),(0,e.jsxs)(pe.A,{requiredMark:!0,layout:"horizontal",labelCol:{span:6},wrapperCol:{span:12},form:b,scrollToFirstError:!0,onFinish:function(){var o=k()(a()().mark(function F(v){var C,x;return a()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,U.$c)({id:n,template:y,config:(0,me.omit)(v,"id","template")});case 2:if(C=l.sent,x=C.success,!x){l.next=7;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),l.abrupt("return",!0);case 7:return K.ZP.error("\u64CD\u4F5C\u5931\u8D25"),l.abrupt("return",!1);case 9:case"end":return l.stop()}},F)}));return function(F){return o.apply(this,arguments)}}(),submitter:{render:function(F,v){return(0,e.jsx)(He.S,{children:v})}},children:[(0,e.jsx)(Ra.Z,{layoutType:"Embed",columns:c,shouldUpdate:!1}),(0,e.jsx)(ae.Z,{label:"\u6388\u6743\u8303\u56F4",name:"authorizationType",allowClear:!1,extra:"\u82E5\u9009\u62E9\u624B\u52A8\u6388\u6743\uFF0C\u9700\u8981\u5728 \u8BBF\u95EE\u6388\u6743 \u4E2D\u8FDB\u884C\u6743\u9650\u5206\u914D\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u8303\u56F4"}],options:[{value:ge.AUTHORIZATION,label:"\u624B\u52A8\u6388\u6743"},{value:ge.ALL_ACCESS,label:"\u5168\u5458\u53EF\u8BBF\u95EE"}]})]}),(0,e.jsx)(ee.Z,{style:{margin:0}}),(0,e.jsx)(mr,{appId:n,protocolEndpoint:f,collapsed:!1})]})},Da=S(4499),$a=Ve.ZP.ConfigContext;function Oa(){var T=(0,R.useContext)($a),r=T.getPrefixCls,n=".".concat(r()),y=(0,ar.l)(function(){return se()({},"".concat(n,"-form-item"),{div:se()({},"".concat(n,"-form-item-control-input"),{width:"100%"})})});return{className:y}}var La=S(2058),We=S(83062),ka=q.Z.Panel,fr={labelCol:{xs:{span:24},sm:{span:7},md:{span:6}},wrapperCol:{xs:{span:24},sm:{span:13},md:{span:14}}},Ma=function(T){var r=T.app,n=r.id,y=r.template,I=H.Z.useForm(),j=p()(I,1),b=j[0],D=H.Z.useForm(),u=p()(D,1),s=u[0],t=(0,R.useState)(!0),E=p()(t,2),g=E[0],c=E[1],A=(0,R.useState)(),Z=p()(A,2),i=Z[0],f=Z[1],d=(0,R.useState)({}),o=p()(d,2),F=o[0],v=o[1],C=(0,R.useState)(function(){return[]}),x=p()(C,2),m=x[0],l=x[1],h=H.Z.useForm(),B=p()(h,1),w=B[0],$=Oa(),L=$.className,M=function(){var P=k()(a()().mark(function O(){var G,_,te,oe;return a()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return c(!0),J.next=3,(0,U.hq)(n);case 3:G=J.sent,_=G.result,te=G.success,te&&_&&(b.setFieldsValue(N()({},(0,me.omit)(_,"protocolEndpoint"))),l((oe=_.attributeStatements)===null||oe===void 0?void 0:oe.map(function(vr){return vr.key})),v(_.protocolEndpoint)),c(!1);case 8:case"end":return J.stop()}},O)}));return function(){return P.apply(this,arguments)}}();(0,Q.Z)(k()(a()().mark(function P(){return a()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,M();case 2:case"end":return G.stop()}},P)})),[]);var V=function(O){b.setFieldsValue({assertSigned:O.wantAssertionsSigned,spRequestsSigned:O.authnRequestsSigned,spSignCert:O.signCert,spAcsUrl:O.acsUrl,spEntityId:O.entityId,nameIdFormat:O.defaultNameIdFormat,acsBinding:O.defaultAcsBinding,spSloEnabled:O.sloEnabled,spSlsUrl:O.slsUrl,spSlsBinding:O.slsBinding})};return(0,e.jsx)("div",{className:L,children:(0,e.jsxs)(re.Z,{spinning:g,children:[(0,e.jsx)(ue.Z,{showIcon:!0,message:(0,e.jsxs)("span",{children:["\u4E0D\u77E5\u9053\u600E\u4E48\u914D\u7F6E\uFF1F\u8BF7\u53C2\u8003 TopIAM \u914D\u7F6E"," ",(0,e.jsx)("a",{target:"_blank",href:"https://eiam.topiam.cn/docs/application/standard/saml2-sso",rel:"noreferrer",children:"SAML \u5355\u70B9\u767B\u5F55"})," ","\u3002"]})}),(0,e.jsx)("br",{}),(0,e.jsx)(pe.A,N()(N()({layout:"horizontal"},fr),{},{form:s,submitter:!1,children:(0,e.jsx)(Da.Z,{rules:[{type:"url",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u5E94\u7528 metadata \u5730\u5740"}],colon:!1,label:(0,e.jsxs)(de.Z,{children:[(0,e.jsx)(La.Z,{showUploadList:!1,name:"file",maxCount:1,beforeUpload:function(){return!1},withCredentials:!0,accept:".xml",onChange:function(){var P=k()(a()().mark(function G(_){var te,oe,ne,J;return a()().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return te=Fe()(_.fileList),c(!0),c(!0),Te.next=5,(0,U.ZG)(te==null?void 0:te[0]);case 5:oe=Te.sent,ne=oe.result,J=oe.success,c(!1),J&&ne&&V(ne);case 10:case"end":return Te.stop()}},G)}));function O(G){return P.apply(this,arguments)}return O}(),children:(0,e.jsx)(fe.Z,{children:"\u4E0A\u4F20 SP \u5143\u6570\u636E "})}),(0,e.jsx)("span",{children:"\u6216"})]}),name:"metaDataUrl",extra:"SP \u5143\u6570\u636E\u4E3A\u5E94\u7528\u4FA7\u751F\u6210\u7684 SSO \u914D\u7F6E\u6587\u4EF6\u3002\u82E5\u5DF2\u6709\u5143\u6570\u636E\uFF0C\u76F4\u63A5\u5BFC\u5165\uFF0C\u53EF\u81EA\u52A8\u586B\u5145\u4E0B\u65B9 SSO \u53C2\u6570\uFF0C\u7B80\u5355\u5FEB\u6377\u3002",addonAfter:(0,e.jsx)(fe.Z,{onClick:k()(a()().mark(function P(){var O,G,_,te;return a()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(O=s.getFieldValue("metaDataUrl"),O){ne.next=4;break}return K.ZP.error("\u8BF7\u8F93\u5165\u5E94\u7528 metadata \u5730\u5740"),ne.abrupt("return");case 4:return ne.next=6,s.validateFields();case 6:return c(!0),ne.next=9,(0,U.XW)(O);case 9:G=ne.sent,_=G.result,te=G.success,c(!1),te&&_&&V(_);case 14:case"end":return ne.stop()}},P)})),children:"\u89E3\u6790"}),children:(0,e.jsx)(or.Z,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528 metadata \u5730\u5740"})})})),(0,e.jsxs)(pe.A,N()(N()({scrollToFirstError:!0,requiredMark:!0,layout:"horizontal"},fr),{},{form:b,onFinish:function(){var P=k()(a()().mark(function O(G){var _,te,oe;return a()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,w.validateFields();case 2:if(_=J.sent,c(!0),!_){J.next=15;break}return J.next=7,(0,U.$c)({id:n,template:y,config:(0,me.omit)(G,"id","template")});case 7:if(te=J.sent,oe=te.success,!oe){J.next=14;break}return K.ZP.success("\u4FDD\u5B58\u6210\u529F"),J.next=13,M();case 13:return J.abrupt("return",!0);case 14:K.ZP.error("\u4FDD\u5B58\u5931\u8D25");case 15:return c(!1),J.abrupt("return",!1);case 17:case"end":return J.stop()}},O)}));return function(O){return P.apply(this,arguments)}}(),submitter:{render:function(O,G){return(0,e.jsx)(He.S,{children:G})}},children:[(0,e.jsx)(z.Z,{label:"ACS URL",name:"spAcsUrl",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u5355\u70B9\u767B\u5F55\u5730\u5740"},extra:"\u5E94\u7528\u7684 SAML SSO \u6838\u5FC3\u5730\u5740\uFF0C\u4E0E IAM \u4EA4\u4E92\u5904\u7406\u5355\u70B9\u767B\u5F55\u8BF7\u6C42\u3002",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5355\u70B9\u767B\u5F55\u5730\u5740"}]}),(0,e.jsx)(z.Z,{label:"SP Entity ID",name:"spEntityId",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u552F\u4E00\u6807\u8BC6"},allowClear:!1,extra:"\u5E94\u7528\u5728 IAM \u4E2D\u7684\u6807\u8BC6\uFF0C\u901A\u5E38\u5728\u5E94\u7528\u4FA7\u83B7\u53D6\uFF0C\u683C\u5F0F\u901A\u5E38\u4E3A\u5E94\u7528 URI\u3002",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5E94\u7528\u552F\u4E00\u6807\u8BC6"}]}),(0,e.jsx)(ae.Z,{label:"Name ID \u7C7B\u578B",name:"nameIdValueType",options:[{value:"user.username",label:"\u7528\u6237\u540D"},{value:"user.fullName",label:"\u7528\u6237\u59D3\u540D"},{value:"user.nickName",label:"\u7528\u6237\u6635\u79F0"},{value:"user.email",label:"\u90AE\u7BB1\u5730\u5740"},{value:"app_user.username",label:"\u5E94\u7528\u8D26\u6237"}],fieldProps:{allowClear:!1},extra:"\u5355\u70B9\u767B\u5F55\u65F6\uFF0C\u5C06\u9009\u4E2D\u9879\u4F5C\u4E3A\u8D26\u6237\u6807\u8BC6\uFF0C\u4F20\u9012\u7ED9\u4E1A\u52A1\u7CFB\u7EDF\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9 Name ID"}]}),(0,e.jsx)(ee.Z,{}),(0,e.jsx)(ae.Z,{label:"\u6388\u6743\u8303\u56F4",name:"authorizationType",allowClear:!1,extra:"\u82E5\u9009\u62E9\u624B\u52A8\u6388\u6743\uFF0C\u9700\u8981\u5728 \u8BBF\u95EE\u6388\u6743 \u4E2D\u8FDB\u884C\u6743\u9650\u5206\u914D\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u8303\u56F4"}],options:[{value:ge.AUTHORIZATION,label:"\u624B\u52A8\u6388\u6743"},{value:ge.ALL_ACCESS,label:"\u5168\u5458\u53EF\u8BBF\u95EE"}]}),(0,e.jsx)(ae.Z,{label:"SSO \u53D1\u8D77\u65B9",name:"initLoginType",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u914D\u7F6E SSO \u53D1\u8D77\u65B9"}],fieldProps:{onChange:function(O){if(he.APP===O){f([{required:!0,message:"\u767B\u5F55\u53D1\u8D77\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A"}]);return}b.setFields([{name:"initLoginUrl",errors:[]}]),f([])}},options:[{value:he.APP,label:"\u53EA\u5141\u8BB8\u5E94\u7528\u53D1\u8D77"},{value:he.PORTAL_OR_APP,label:"\u652F\u6301\u95E8\u6237\u548C\u5E94\u7528\u53D1\u8D77"}],extra:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:"\u95E8\u6237\u53D1\u8D77\uFF1A\u7531 IAM \u95E8\u6237\u9875\u70B9\u51FB\u8FDB\u884C SSO \u3002"}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:"\u5E94\u7528\u53D1\u8D77\uFF1A\u7531\u5E94\u7528\u767B\u5F55\u4E3B\u52A8\u53D1\u8D77\u3002"})]})}),(0,e.jsx)(z.Z,{label:"\u767B\u5F55\u53D1\u8D77\u5730\u5740",name:"initLoginUrl",rules:i,fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u94FE\u63A5"},extra:"\u82E5\u5E94\u7528\u4EC5\u652F\u6301 SP \u53D1\u8D77 SSO\uFF0C\u60A8\u53C8\u5E0C\u671B\u5B9E\u73B0\u7531 IAM \u95E8\u6237\u9875\u53D1\u8D77\u767B\u5F55\uFF0C\u8BF7\u586B\u5199\u6B64\u9879\u3002\u95E8\u6237\u9875\u8BBF\u95EE\u5E94\u7528\u65F6\uFF0CIAM \u4F1A\u8DF3\u8F6C\u5230\u672C\u5730\u5740\uFF0C\u5E94\u5373\u523B\u81EA\u52A8\u5411 IAM \u53D1\u8D77 SAMLRequest \u767B\u5F55\u8BF7\u6C42\u3002\u5730\u5740\u53EF\u586B\u5199\u4E3A\u4EFB\u610F\u53D7\u4FDD\u62A4\u8D44\u6E90\u8BBF\u95EE\u5730\u5740\uFF0C\u5728\u672A\u767B\u5F55\u65F6\u4F1A\u81EA\u52A8\u89E6\u53D1 SAMLRequest \u5373\u53EF\u3002"}),(0,e.jsx)(ee.Z,{style:{margin:0}}),(0,e.jsx)(q.Z,{ghost:!0,expandIconPosition:"start",children:(0,e.jsxs)(ka,{header:(0,e.jsx)("a",{children:"\u663E\u793A\u9AD8\u7EA7\u914D\u7F6E"}),children:[(0,e.jsx)(z.Z,{label:"\u9ED8\u8BA4RelayState",name:"relayState",rules:[{type:"url",message:"RelayState \u683C\u5F0F\u4E0D\u6B63\u786E"}],fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u9ED8\u8BA4\u8DF3\u8F6C\u5730\u5740"},extra:"IDP \u53D1\u8D77 SSO \u767B\u5F55\u6210\u529F\u540E\uFF0C\u5E94\u7528\u5E94\u81EA\u52A8\u8DF3\u8F6C\u7684\u5730\u5740\u3002\u5728 SAML Response \u4E2D\u4F1A\u5728 RelayState \u53C2\u6570\u4E2D\u4F20\u9012\uFF0C\u5E94\u7528\u8BFB\u53D6\u540E\u5B9E\u73B0\u8DF3\u8F6C\u3002"}),(0,e.jsx)(ee.Z,{orientation:"left",plain:!0,children:"\u65AD\u8A00"}),(0,e.jsx)(z.Z,{label:"Audience",name:"audience",allowClear:!1,extra:"SAML\u65AD\u8A00\u7684\u76EE\u6807\u53D7\u4F17\uFF0C\u9ED8\u8BA4\u548CSP Entity ID\u76F8\u540C\u3002",placeholder:"\u8BF7\u8F93\u5165SAML\u65AD\u8A00\u7684\u76EE\u6807\u53D7\u4F17"}),(0,e.jsx)(ae.Z,{label:"NameID \u683C\u5F0F",name:"nameIdFormat",allowClear:!1,initialValue:"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified",rules:[{required:!0,message:"\u8BF7\u9009\u62E9 NameID \u5B57\u6BB5\u683C\u5F0F"}],extra:"SAML Response \u4E2D\u6307\u5B9A\u8D26\u6237\u6807\u8BC6 NameID \u5B57\u6BB5\u683C\u5F0F\u3002",options:[{value:"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified",label:"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified"},{value:"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress",label:"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"},{value:"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent",label:"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"},{value:"urn:oasis:names:tc:SAML:2.0:nameid-format:transient",label:"urn:oasis:names:tc:SAML:2.0:nameid-format:transient"}]}),(0,e.jsx)(ae.Z,{label:"ACS \u7ED1\u5B9A\u7C7B\u578B",name:"acsBinding",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9 ACS \u7ED1\u5B9A\u7C7B\u578B"}],extra:" \u6307\u5B9AIDP\u5411SP\u53D1\u9001\u65AD\u8A00\u8BF7\u6C42\u7684\u65B9\u5F0F\u3002",options:[{value:"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST",label:"HTTP-POST"},{value:"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect",label:"HTTP-Redirect"}]}),(0,e.jsx)(je.Z,{label:"\u662F\u5426\u52A0\u5BC6\u65AD\u8A00",name:"assertEncrypted",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u5BF9\u65AD\u8A00\u52A0\u5BC6"}]}),(0,e.jsx)(xe.Z,{name:["assertEncrypted"],children:function(O){var G=O.assertEncrypted;return G&&(0,e.jsx)(ae.Z,{label:"\u65AD\u8A00\u52A0\u5BC6\u7B97\u6CD5",name:"assertEncryptAlgorithm",extra:"\u65AD\u8A00\u52A0\u5BC6\u4F7F\u7528\u7684\u7B97\u6CD5",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u65AD\u8A00\u52A0\u5BC6\u4F7F\u7528\u7684\u7B97\u6CD5"}],options:[{value:"http://www.w3.org/2001/04/xmlenc#aes128-cbc",label:"AES128-CBC"},{value:"http://www.w3.org/2001/04/xmlenc#aes256-cbc",label:"AES256-CBC"}]})}}),(0,e.jsx)(je.Z,{label:"\u662F\u5426\u7B7E\u540D\u65AD\u8A00",name:"assertSigned",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u5BF9\u65AD\u8A00\u7B7E\u540D"}],initialValue:!0,extra:"\u662F\u5426\u5BF9\u65AD\u8A00\u4F7F\u7528IdP\u7684\u8BC1\u4E66\u7B7E\u540D\uFF0C\u5BF9\u5E94SP\u5143\u6570\u636E\u6587\u4EF6\u4E2D\u201CWantAssertionsSigned\u201D\u503C\u3002"}),(0,e.jsx)(xe.Z,{name:["assertSigned"],children:function(O){var G=O.assertSigned;return G&&(0,e.jsx)(ae.Z,{label:"\u65AD\u8A00\u7B7E\u540D\u7B97\u6CD5",name:"assertSignAlgorithm",extra:"\u65AD\u8A00\u7B7E\u540D\u4F7F\u7528\u7684\u7B97\u6CD5",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7B7E\u540D\u4F7F\u7528\u7684\u7B97\u6CD5"}],options:[{value:"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256",label:"RSA-SHA256"}]})}}),(0,e.jsx)(ae.Z,{label:"\u8EAB\u4EFD\u8BA4\u8BC1\u4E0A\u4E0B\u6587",name:"authnContextClassRef",extra:"SAML \u8EAB\u4EFD\u8BA4\u8BC1\u4E0A\u4E0B\u6587",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8EAB\u4EFD\u8BA4\u8BC1\u4E0A\u4E0B\u6587"}],options:[{value:"urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified",label:(0,e.jsx)(We.Z,{title:"urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified",placement:"topLeft",children:(0,e.jsx)("span",{children:"urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified"})})},{value:"urn:oasis:names:tc:SAML:2.0:ac:classes:Password",label:(0,e.jsx)(We.Z,{placement:"topLeft",title:"urn:oasis:names:tc:SAML:2.0:ac:classes:Password",children:(0,e.jsx)("span",{children:"urn:oasis:names:tc:SAML:2.0:ac:classes:Password"})})},{value:"urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport",label:(0,e.jsx)(We.Z,{placement:"topLeft",title:"urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport",children:(0,e.jsx)("span",{children:"urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"})})}]}),(0,e.jsx)(pe.A.Item,{label:"\u65AD\u8A00\u5C5E\u6027",name:"attributeStatements",trigger:"onValuesChange",children:(0,e.jsx)(Ke.Z,{rowKey:"key",toolBarRender:!1,scroll:{x:500},columns:[{title:"\u5C5E\u6027\u540D\u79F0",dataIndex:"name",fieldProps:{allowClear:!1},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u540D\u79F0\u683C\u5F0F",key:"nameFormat",dataIndex:"nameFormat",valueType:"select",ellipsis:!0,valueEnum:{"urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified":{text:"unspecified"},"urn:oasis:names:tc:SAML:2.0:attrname-format:basic":{text:"basic"},"urn:oasis:names:tc:SAML:2.0:attrname-format:uri":{text:"uri"}},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u5C5E\u6027\u503C",tooltip:"\u652F\u6301\u7684\u53D8\u91CF\uFF1A${user.phone}\u3001${user.username}\u3001${user.email}\u3001${app_user.nickName}\u3001${app_user.username}",dataIndex:"valueExpression",fieldProps:{allowClear:!1,placeholder:"\u53D8\u91CF\u503C"},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u64CD\u4F5C",valueType:"option",align:"center",fixed:"right",width:50}],recordCreatorProps:{creatorButtonText:"\u6DFB\u52A0\u65AD\u8A00\u5C5E\u6027",newRecordType:"dataSource",position:"bottom",record:function(){return{key:Date.now()}}},editable:{form:w,type:"multiple",editableKeys:m,onChange:l,deletePopconfirmMessage:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u6B64\u65AD\u8A00\u5C5E\u6027\u5417\uFF1F",actionRender:function(O,G,_){return[_.delete]}}})}),(0,e.jsx)(ee.Z,{orientation:"left",plain:!0,children:"\u54CD\u5E94\u7B7E\u540D"}),(0,e.jsx)(je.Z,{label:"\u662F\u5426\u7B7E\u540D\u54CD\u5E94",name:"responseSigned",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u5BF9\u54CD\u5E94\u7B7E\u540D"}],initialValue:!1}),(0,e.jsx)(xe.Z,{name:["responseSigned"],children:function(O){var G=O.responseSigned;return G&&(0,e.jsx)(ae.Z,{label:"\u54CD\u5E94\u7B7E\u540D\u7B97\u6CD5",name:"responseSignAlgorithm",extra:"\u65AD\u8A00\u54CD\u5E94\u4F7F\u7528\u7684\u7B97\u6CD5",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u54CD\u5E94\u7B7E\u540D\u4F7F\u7528\u7684\u7B97\u6CD5"}],options:[{value:"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256",label:"RSA-SHA256"}]})}}),(0,e.jsx)(ee.Z,{orientation:"left",plain:!0,children:"\u9A8C\u8BC1\u8BF7\u6C42"}),(0,e.jsx)(je.Z,{label:"\u9A8C\u8BC1\u8BF7\u6C42\u7B7E\u540D",name:"spRequestsSigned",initialValue:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u9A8C\u8BC1\u8BF7\u6C42\u7B7E\u540D"}],extra:"\u7528\u6765\u5BF9SAML Request\u7B7E\u540D\u8FDB\u884C\u9A8C\u8BC1\uFF0C\u5BF9\u5E94SP\u5143\u6570\u636E\u6587\u4EF6\u4E2D\u201CAuthnRequestsSigned\u201D\u503C\u3002"}),(0,e.jsx)(ee.Z,{orientation:"left",plain:!0,children:"\u5355\u70B9\u6CE8\u9500"}),(0,e.jsx)(je.Z,{label:"\u542F\u7528 SLO",name:"spSloEnabled",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u542F\u7528 SLO"}],initialValue:!1,extra:"SP \u662F\u5426\u652F\u6301\u5355\u70B9\u6CE8\u9500 (SLO) \u3002"}),(0,e.jsx)(xe.Z,{name:["spSloEnabled"],children:function(O){var G=O.spSloEnabled;return G&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(z.Z,{label:"\u5355\u70B9\u6CE8\u9500 URL",name:"spSlsUrl",rules:[{type:"url",message:"\u5355\u70B9\u6CE8\u9500\u5730\u5740\u683C\u5F0F\u4E0D\u6B63\u786E"},{required:!0,message:"\u8BF7\u8F93\u5165\u5355\u70B9\u6CE8\u9500\u5730\u5740"}],allowClear:!0,extra:"\u4F1A\u8BDD\u6CE8\u9500\u529F\u80FD\uFF0C\u7528\u6237\u5728 TopIAM \u6CE8\u9500\u4F1A\u8BDD\u540E\u901A\u77E5\u8BE5\u5730\u5740\u3002",placeholder:"\u8BF7\u8F93\u5165\u5355\u70B9\u6CE8\u9500\u5730\u5740"}),(0,e.jsx)(ae.Z,{label:"\u5355\u70B9\u6CE8\u9500\u7ED1\u5B9A\u7C7B\u578B",name:"spSlsBinding",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5355\u70B9\u6CE8\u9500\u7ED1\u5B9A\u7C7B\u578B"}],extra:" \u6307\u5B9A\u4E86 IDP \u5411 SP \u53D1\u9001 SLO \u8BF7\u6C42\u7684\u65B9\u5F0F\u3002",options:[{value:"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST",label:"HTTP-POST"},{value:"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect",label:"HTTP-Redirect"}]})]})}}),(0,e.jsx)(ee.Z,{}),(0,e.jsx)(be.Z,{label:"\u7B7E\u540D\u8BC1\u4E66",name:"spSignCert",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u9A8C\u8BC1\u7B7E\u540D\u8BC1\u4E66"}],extra:'SP\u516C\u94A5\u8BC1\u4E66\uFF0C\u7528\u6765\u9A8C\u8BC1SAML request\u7684\u7B7E\u540D\uFF0C\u5BF9\u5E94SP\u5143\u6570\u636E\u6587\u4EF6\u4E2Duse="signing"\u8BC1\u4E66\u5185\u5BB9\u3002',fieldProps:{autoComplete:"off",rows:3}})]},"advanced")})]})),(0,e.jsx)(ee.Z,{style:{margin:0}}),(0,e.jsx)(mr,{appId:n,protocolEndpoint:F,collapsed:!0})]})})},Ua=function(T){var r=T.app;return(0,e.jsxs)(e.Fragment,{children:[r.type===X.pR.CUSTOM_MADE&&(0,e.jsx)(Ba,{app:r}),r.type===X.pR.STANDARD&&(0,e.jsx)(Ma,{app:r})]})},Na=Ua,Ga=function(T){var r=T.appId,n=(0,R.useState)(!0),y=p()(n,2),I=y[0],j=y[1],b=(0,R.useState)(),D=p()(b,2),u=D[0],s=D[1];return(0,Q.Z)(k()(a()().mark(function t(){var E,g,c;return a()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return j(!0),Z.next=3,(0,U.Mq)(r);case 3:E=Z.sent,g=E.result,c=E.success,c&&g&&s(g),j(!1);case 8:case"end":return Z.stop()}},t)})),[]),(0,e.jsx)(Ge.Z,{title:"\u5355\u70B9\u767B\u5F55",style:{height:"calc(100vh - 190px)",overflow:"auto"},bodyStyle:{height:"100%"},headerBordered:!0,children:(0,e.jsxs)(rr.Z,{loading:I,active:!0,paragraph:{rows:5},children:[(u==null?void 0:u.protocol)===X.b$.SAML2&&(0,e.jsx)(Na,{app:u}),(u==null?void 0:u.protocol)===X.b$.CAS&&(0,e.jsx)(ga,{app:u}),(u==null?void 0:u.protocol)===X.b$.JWT&&(0,e.jsx)(Sa,{app:u}),(u==null?void 0:u.protocol)===X.b$.OIDC&&(0,e.jsx)(wa,{app:u}),(u==null?void 0:u.protocol)===X.b$.FORM&&(0,e.jsx)(Ca,{app:u})]})})},za=S(14855),Va=Ve.ZP.ConfigContext,Ka=function(r){var n,y,I,j,b,D,u,s,t,E,g,c,A=r.prefixCls;return c={},se()(c,"".concat(A,"-main"),{minHeight:"calc(100vh - 190px)"}),se()(c,"".concat(A,"-left"),se()({minHeight:"100%",overflow:"auto"},"".concat(A,"-left-menu"),(g={height:"calc(100vh - 190px)"},se()(g,"&.ant-menu-light.ant-menu-root.ant-menu-inline",{"border-inline-end":"none"}),se()(g,"&".concat(r.antCls,"-menu-light:not(").concat(r.antCls,"-menu-horizontal) ").concat(r.antCls,"-menu-item-selected"),{"background-color":(n=r.layout)===null||n===void 0||(y=n.sider)===null||y===void 0?void 0:y.colorBgMenuItemSelected,color:(I=r.layout)===null||I===void 0||(j=I.sider)===null||j===void 0?void 0:j.colorTextMenuSelected}),se()(g,"&".concat(r.antCls,"-menu-light:not(").concat(r.antCls,"-menu-horizontal) ").concat(r.antCls,"-menu-item:not(").concat(r.antCls,"-menu-item-selected):active"),{"background-color":(b=r.layout)===null||b===void 0||(D=b.sider)===null||D===void 0?void 0:D.colorBgMenuItemSelected,color:(u=r.layout)===null||u===void 0||(s=u.sider)===null||s===void 0?void 0:s.colorTextMenuActive}),se()(g,"&".concat(r.antCls,"-menu-light ").concat(r.antCls,"-menu-submenu-selected >").concat(r.antCls,"-menu-submenu-title"),{color:(t=r.layout)===null||t===void 0||(E=t.sider)===null||E===void 0?void 0:E.colorTextMenuSelected}),g))),se()(c,"".concat(A,"-right"),{minHeight:"100%",overflow:"auto"}),c};function Ha(T){var r=(0,R.useContext)(Va),n=r.getPrefixCls,y=".".concat(n());return(0,za.Xj)("AppConfig",function(I){var j=N()(N()({},I),{},{prefixCls:".".concat(T),antCls:y});return[Ka(j)]})}var Ee="app-config",Ya={xxl:3,xl:4,lg:5,md:24,sm:24,xs:24},Wa={xxl:21,xl:20,lg:19,md:24,sm:24,xs:24},Xa=function(){var T=(0,R.useState)(),r=p()(T,2),n=r[0],y=r[1],I=(0,R.useState)(),j=p()(I,2),b=j[0],D=j[1],u=(0,ze.useLocation)(),s=Ha(Ee),t=s.wrapSSR,E=s.hashId,g=(0,Le.parse)(u.search),c=g,A=c.type,Z=c.id,i=c.name,f=[{key:Y.BASIC,label:"\u57FA\u672C\u914D\u7F6E",icon:R.createElement(function(){return(0,e.jsx)(gr.Z,{})})},{key:Y.LOGIN_ACCESS,label:"\u767B\u5F55\u8BBF\u95EE",icon:R.createElement(function(){return(0,e.jsx)(Fr.Z,{})}),children:[{key:Y.PROTOCOL_CONFIG,label:"\u5355\u70B9\u767B\u5F55"},{key:Y.APP_ACCOUNT,label:"\u5E94\u7528\u8D26\u6237"},{key:Y.ACCESS_POLICY,label:"\u8BBF\u95EE\u6388\u6743"}]},{key:Y.ACCOUNT_SYNC,label:"\u8D26\u6237\u540C\u6B65",icon:R.createElement(function(){return(0,e.jsx)(Cr.Z,{})})},{key:Y.APP_PERMISSION,label:"\u6743\u9650\u7BA1\u7406",icon:R.createElement(function(){return(0,e.jsx)(xr.Z,{})}),children:[{key:Y.PERMISSION_RESOURCE,label:"\u8D44\u6E90\u7BA1\u7406"},{key:Y.PERMISSION_ROLE,label:"\u89D2\u8272\u7BA1\u7406"},{key:Y.PERMISSION_POLICY,label:"\u6388\u6743\u7BA1\u7406"}]}];return(0,Q.Z)(k()(a()().mark(function d(){return a()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(Z||(K.ZP.error("\u672A\u6307\u5B9A\u5E94\u7528"),De.m.push("/app")),!(!A||!(A.toUpperCase()in Y))){F.next=5;break}return y([Y.PROTOCOL_CONFIG]),De.m.replace({pathname:u.pathname,search:(0,Le.stringify)({type:Y.PROTOCOL_CONFIG,id:Z,name:i})}),F.abrupt("return");case 5:y([A]);case 6:case"end":return F.stop()}},d)})),[]),(0,Q.Z)(k()(a()().mark(function d(){return a()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:D(g.name);case 1:case"end":return F.stop()}},d)})),[u]),(0,e.jsx)(Sr._z,{title:b,style:{overflow:"hidden"},onBack:function(){De.m.push("/app")},children:t((0,e.jsxs)(yr.Z,{gutter:[16,16],className:Re()("".concat(Ee),"".concat(Ee,"-main"),E),children:[(0,e.jsx)(Xe.Z,N()(N()({},Ya),{},{className:Re()("".concat(Ee,"-left"),E),children:(0,e.jsx)(br.Z,{mode:"inline",selectedKeys:n,defaultOpenKeys:[Y.LOGIN_ACCESS,Y.APP_PERMISSION],className:Re()("".concat(Ee,"-left-menu"),E),items:f,onSelect:function(o){var F=o.selectedKeys;y(F),De.m.replace({pathname:u.pathname,search:(0,Le.stringify)({type:F==null?void 0:F[0],id:Z,name:i})})}})})),(0,e.jsxs)(Xe.Z,N()(N()({},Wa),{},{className:Re()("".concat(Ee,"-right"),E),children:[(n==null?void 0:n[0])===Y.BASIC&&(0,e.jsx)(Hr,{appId:Z}),(n==null?void 0:n[0])===Y.PROTOCOL_CONFIG&&(0,e.jsx)(Ga,{appId:Z}),(n==null?void 0:n[0])===Y.APP_ACCOUNT&&(0,e.jsx)(Nr,{appId:Z}),(n==null?void 0:n[0])===Y.ACCESS_POLICY&&(0,e.jsx)(kr,{appId:Z}),(n==null?void 0:n[0])===Y.ACCOUNT_SYNC&&(0,e.jsx)(Mr,{}),(n==null?void 0:n[0])===Y.PERMISSION_RESOURCE&&(0,e.jsx)(sa,{appId:Z}),(n==null?void 0:n[0])===Y.PERMISSION_ROLE&&(0,e.jsx)(va,{appId:Z}),(n==null?void 0:n[0])===Y.PERMISSION_POLICY&&(0,e.jsx)(ea,{appId:Z})]}))]}))})},Ja=Xa}}]);
