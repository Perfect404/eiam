/*
 * eiam-console - Employee Identity and Access Management Program
 * Copyright Â© 2020-2023 TopIAM (support@topiam.cn)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
"use strict";(self.webpackChunktopiam_console=self.webpackChunktopiam_console||[]).push([[3091],{10218:function(Je,Se,j){j.d(Se,{Z:function(){return Ce}});var ve=j(86977),r=j(22192),de=j(63342),L=function(te){var ge=te.avatar,N=te.username,z=te.size,$=z===void 0?"small":z;return(0,de.jsx)(de.Fragment,{children:ge?(0,de.jsx)(ve.C,{size:$,src:(0,de.jsx)(r.Z,{placeholder:!0,src:ge,fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3PTWBSGcbGzM6GCKqlIBRV0dHRJFarQ0eUT8LH4BnRU0NHR0UEFVdIlFRV7TzRksomPY8uykTk/zewQfKw/9znv4yvJynLv4uLiV2dBoDiBf4qP3/ARuCRABEFAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghgg0Aj8i0JO4OzsrPv69Wv+hi2qPHr0qNvf39+iI97soRIh4f3z58/u7du3SXX7Xt7Z2enevHmzfQe+oSN2apSAPj09TSrb+XKI/f379+08+A0cNRE2ANkupk+ACNPvkSPcAAEibACyXUyfABGm3yNHuAECRNgAZLuYPgEirKlHu7u7XdyytGwHAd8jjNyng4OD7vnz51dbPT8/7z58+NB9+/bt6jU/TI+AGWHEnrx48eJ/EsSmHzx40L18+fLyzxF3ZVMjEyDCiEDjMYZZS5wiPXnyZFbJaxMhQIQRGzHvWR7XCyOCXsOmiDAi1HmPMMQjDpbpEiDCiL358eNHurW/5SnWdIBbXiDCiA38/Pnzrce2YyZ4//59F3ePLNMl4PbpiL2J0L979+7yDtHDhw8vtzzvdGnEXdvUigSIsCLAWavHp/+qM0BcXMd/q25n1vF57TYBp0a3mUzilePj4+7k5KSLb6gt6ydAhPUzXnoPR0dHl79WGTNCfBnn1uvSCJdegQhLI1vvCk+fPu2ePXt2tZOYEV6/fn31dz+shwAR1sP1cqvLntbEN9MxA9xcYjsxS1jWR4AIa2Ibzx0tc44fYX/16lV6NDFLXH+YL32jwiACRBiEbf5KcXoTIsQSpzXx4N28Ja4BQoK7rgXiydbHjx/P25TaQAJEGAguWy0+2Q8PD6/Ki4R8EVl+bzBOnZY95fq9rj9zAkTI2SxdidBHqG9+skdw43borCXO/ZcJdraPWdv22uIEiLA4q7nvvCug8WTqzQveOH26fodo7g6uFe/a17W3+nFBAkRYENRdb1vkkz1CH9cPsVy/jrhr27PqMYvENYNlHAIesRiBYwRy0V+8iXP8+/fvX11Mr7L7ECueb/r48eMqm7FuI2BGWDEG8cm+7G3NEOfmdcTQw4h9/55lhm7DekRYKQPZF2ArbXTAyu4kDYB2YxUzwg0gi/41ztHnfQG26HbGel/crVrm7tNY+/1btkOEAZ2M05r4FB7r9GbAIdxaZYrHdOsgJ/wCEQY0J74TmOKnbxxT9n3FgGGWWsVdowHtjt9Nnvf7yQM2aZU/TIAIAxrw6dOnAWtZZcoEnBpNuTuObWMEiLAx1HY0ZQJEmHJ3HNvGCBBhY6jtaMoEiJB0Z29vL6ls58vxPcO8/zfrdo5qvKO+d3Fx8Wu8zf1dW4p/cPzLly/dtv9Ts/EbcvGAHhHyfBIhZ6NSiIBTo0LNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiEC/wGgKKC4YMA4TAAAAABJRU5ErkJggg=="})}):(0,de.jsx)(ve.C,{style:{color:"#f56a00",backgroundColor:"#fde3cf",verticalAlign:"middle"},size:"small",gap:1,children:N.substring(0,1).toLocaleUpperCase()})})},Ce=L},23113:function(Je,Se,j){j.d(Se,{Gh:function(){return te},SC:function(){return ge},Zw:function(){return r},gD:function(){return Ce},n6:function(){return de},o:function(){return N},pR:function(){return L},rD:function(){return ve}});var ve;(function(z){z.EX900005="EX900005",z.EX000102="EX000102",z.EX000202="EX000202",z.SUCCESS="200"})(ve||(ve={}));var r;(function(z){z.ALIYUN="aliyun",z.QI_NIU="qiniu",z.TENCENT="tencent",z.NET_EASE="netease",z.MAXMIND="maxmind"})(r||(r={}));var de;(function(z){z.ALIYUN="aliyun",z.TENCENT="tencent",z.GEE_TEST="geetest",z.HCAPTCHA="hcaptcha",z.RECAPTCHA="recaptcha"})(de||(de={}));var L;(function(z){z.STANDARD="standard",z.CUSTOM_MADE="custom_made"})(L||(L={}));var Ce;(function(z){z.SAML2="saml2",z.OIDC="oidc",z.CAS="cas",z.JWT="jwt",z.FORM="form",z.OAUTH2="oauth2"})(Ce||(Ce={}));var te;(function(z){z.ALLOW="ALLOW",z.DENY="DENY"})(te||(te={}));var ge;(function(z){z.ROLE="ROLE",z.RESOURCE="RESOURCE",z.USER="USER",z.ORGANIZATION="ORGANIZATION",z.USER_GROUP="USER_GROUP"})(ge||(ge={}));var N;(function(z){z.PHONE="PHONE",z.USERNAME="USERNAME",z.EMAIL="EMAIL"})(N||(N={}))},18739:function(Je,Se,j){j.r(Se),j.d(Se,{default:function(){return rn}});var ve=j(84019),r=j.n(ve),de=j(32061),L=j.n(de),Ce=j(77566),te=j.n(Ce),ge=j(76091),N=j.n(ge),z=j(7863),$=j.n(z),Be=j(75109),vr=j(15685),gr=j(47816),Ar=j(29113),Fr=j(16228),Cr=j(82925),xr=j(50804),X=j(15457),K=j(90914),Er=j(61109),R=j(79685),Te=j(9715),Sr=j(87907),e=j(63342),jr=function(t){var s=(0,R.useState)(),C=$()(s,2),y=C[0],b=C[1];(0,X.Z)(L()(r()().mark(function k(){var i,u,o;return r()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,Te.mB)();case 2:if(x.t0=x.sent,x.t0){x.next=5;break}x.t0={};case 5:i=x.t0,u=i.success,o=i.result,u&&o&&b([o]);case 9:case"end":return x.stop()}},k)})),[]);var h=function(){var k=L()(r()().mark(function i(u){var o,D,x,F;return r()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return o=u[u.length-1],o.loading=!0,I.next=4,(0,Te.z3)(o.id);case 4:D=I.sent,x=D.success,F=D.result,x&&F&&(o.children=te()(F),b(te()(y))),o.loading=!1;case 9:case"end":return I.stop()}},i)}));return function(u){return k.apply(this,arguments)}}();return(0,e.jsx)(Sr.Z,N()({fieldNames:{value:"id",label:"name"},options:y,loadData:h,changeOnSelect:!0,showCheckedStrategy:"SHOW_CHILD"},t))},yr=jr,Ve=yr,Ue=j(25374),se=j(54363),ie=j(97207),br=Ue.Z.Option,Ye,Zr=function(){var P=L()(r()().mark(function t(s){var C,y;return r()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return Ye=s,h.next=3,(0,Te.S4)({name:s});case 3:if(C=h.sent,y=C.data,Ye!==s){h.next=7;break}return h.abrupt("return",y==null?void 0:y.map(function(k){return{value:k.id,label:"".concat(k.name)}}));case 7:return h.abrupt("return",[]);case 8:case"end":return h.stop()}},t)}));return function(s){return P.apply(this,arguments)}}(),Pr=function(t){var s=(0,R.useState)([]),C=$()(s,2),y=C[0],b=C[1],h=(0,R.useState)(!1),k=$()(h,2),i=k[0],u=k[1],o=(0,R.useRef)(0),D=(0,R.useMemo)(function(){var w=function(v){o.current+=1;var n=o.current;b([]),u(!0),Zr(v).then(function(A){n===o.current&&(b(A),u(!1))})};return(0,ie.debounce)(w,600)},[]),x=function(){var w=L()(r()().mark(function I(v){return r()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:v?D(v):b([]);case 1:case"end":return A.stop()}},I)}));return function(v){return w.apply(this,arguments)}}(),F=y.map(function(w){return(0,e.jsx)(br,{value:w.value,children:w.label},w.value)});return(0,e.jsx)(Ue.Z,N()(N()({showSearch:!0,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onSearch:x,allowClear:!0,notFoundContent:i?(0,e.jsx)(se.Z,{size:"small"}):null},t),{},{children:F}))},Ir=Pr,He=Ir,W=j(13374),wr=j(39620),_=j.n(wr),qe=j(71775),De=j(47918),Rr=De.ZP.ConfigContext,Br=function(t){var s=t.prefixCls,C=t.antCls;return _()({},"".concat(s,"-popup"),_()({},"span".concat(C,"-select-item-option-state"),{display:"contents !important"}))};function Tr(P){var t=(0,R.useContext)(Rr),s=t.getPrefixCls,C=".".concat(s());return(0,qe.Xj)("UserSelectComponent",function(y){var b=N()(N()({},y),{},{prefixCls:".".concat(P),antCls:C});return[Br(b)]})}var Dr=j(68591),je=j.n(Dr),kr=j(10218),Xe="topiam-user-select",We,Or=function(){var P=L()(r()().mark(function t(s){var C,y;return r()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return We=s,h.next=3,(0,Te.lE)({username:s});case 3:if(C=h.sent,y=C.data,We!==s){h.next=7;break}return h.abrupt("return",y==null?void 0:y.map(function(k){return{id:k.id,username:"".concat(k.username),fullName:"".concat(k.fullName),avatar:"".concat(k.avatar),orgDisplayPath:"".concat(k.orgDisplayPath)}}));case 7:return h.abrupt("return",[]);case 8:case"end":return h.stop()}},t)}));return function(s){return P.apply(this,arguments)}}(),Lr=function(t){var s=Tr(Xe),C=s.wrapSSR,y=s.hashId,b=(0,R.useState)([]),h=$()(b,2),k=h[0],i=h[1],u=(0,R.useState)(!1),o=$()(u,2),D=o[0],x=o[1],F=(0,R.useRef)(0),w=(0,R.useMemo)(function(){var n=function(a){F.current+=1;var S=F.current;i([]),x(!0),Or(a).then(function(c){S===F.current&&(i(c),x(!1))})};return(0,ie.debounce)(n,600)},[]),I=function(){var n=L()(r()().mark(function A(a){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:a?w(a):i([]);case 1:case"end":return c.stop()}},A)}));return function(a){return n.apply(this,arguments)}}(),v=k.map(function(n){return{fullName:n.fullName,label:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,e.jsx)("div",{style:{marginRight:"0.5rem"},children:(0,e.jsx)(kr.Z,{avatar:n.avatar,username:n.fullName})}),(0,e.jsxs)("div",{style:{display:"block"},children:[(0,e.jsx)("span",{children:n.fullName}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:n.username})]})]}),(0,e.jsx)(W.Z,{style:{margin:3}})]}),value:n.id}});return(0,X.Z)(L()(r()().mark(function n(){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},n)})),[]),C((0,e.jsx)(Ue.Z,N()(N()({showSearch:!0,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onSearch:I,optionLabelProp:"fullName",allowClear:!0,notFoundContent:D?(0,e.jsx)(se.Z,{size:"small"}):null,options:v},t),{},{popupClassName:je()("".concat(Xe,"-popup"),y,t.popupClassName)})))},$r=Lr,Qe=$r,Y=j(23113),M=j(11880),xe=j(80591),ye=j(43637),_e=j(24766),er=j(21574),U=j(3723),me=j(85724),Pe=j(53802),J=j(69268),Ee=j(18054),Ae=j(28755),Fe=j(8821),Nr=function(t){var s=J.Z.useForm(),C=$()(s,1),y=C[0],b=t.open,h=t.onCancel,k=t.onFinish;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(_e.Y,{title:"\u6DFB\u52A0\u6388\u6743",width:600,open:b,form:y,scrollToFirstError:!0,layout:"horizontal",labelCol:{span:4},wrapperCol:{span:20},autoFocusFirstInput:!0,preserve:!1,modalProps:{forceRender:!0,destroyOnClose:!0,onCancel:function(u){y.resetFields(),h==null||h(u)}},onFinish:k,children:[(0,e.jsx)(er.Z.Group,{name:"subjectType",label:"\u6388\u6743\u7C7B\u578B",initialValue:Y.SC.USER,fieldProps:{onChange:function(){y.resetFields(["subjectIds"]),y.setFieldsValue({effect:Y.Gh.ALLOW})}},options:[{value:Y.SC.USER,label:"\u7528\u6237"},{value:Y.SC.USER_GROUP,label:"\u7528\u6237\u7EC4"},{value:Y.SC.ORGANIZATION,label:"\u7EC4\u7EC7\u673A\u6784"}],rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u7C7B\u578B"}]}),(0,e.jsx)(U.Z,{name:"effect",hidden:!0}),(0,e.jsx)(me.Z,{name:["subjectType"],children:function(u){var o=u.subjectType;return o===Y.SC.USER?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(J.Z.Item,{label:"\u6388\u6743\u7528\u6237",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u7528\u6237"}],children:(0,e.jsx)(Qe,{placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u641C\u7D22\u7528\u6237",mode:"multiple"})})}):o===Y.SC.USER_GROUP?(0,e.jsx)(J.Z.Item,{label:"\u6388\u6743\u5206\u7EC4",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u5206\u7EC4"}],children:(0,e.jsx)(He,{placeholder:"\u8BF7\u9009\u62E9\u6388\u6743\u5206\u7EC4",mode:"multiple"})}):o===Y.SC.ORGANIZATION?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(J.Z.Item,{label:"\u6388\u6743\u7EC4\u7EC7",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9009\u62E9\u7EC4\u7EC7\u8282\u70B9"}],children:(0,e.jsx)(Ve,{placeholder:"\u9009\u62E9\u7EC4\u7EC7\u8282\u70B9"})})}):(0,e.jsx)(e.Fragment,{})}})]})})},Mr=function(P){var t=(0,R.useRef)(),s=P.appId,C=(0,R.useState)(!1),y=$()(C,2),b=y[0],h=y[1],k=[{title:"\u6388\u6743\u4E3B\u4F53",dataIndex:"subjectName",ellipsis:!0,fixed:"left"},{title:"\u4E3B\u4F53\u7C7B\u578B",dataIndex:"subjectType",valueType:"select",ellipsis:!0,valueEnum:{USER:{text:"\u7528\u6237"},USER_GROUP:{text:"\u7528\u6237\u7EC4"},ORGANIZATION:{text:"\u7EC4\u7EC7\u673A\u6784"}}},{title:"\u6388\u6743\u65F6\u95F4",align:"center",ellipsis:!0,dataIndex:"createTime",valueType:"dateTime",search:!1},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:80,align:"center",fixed:"right",render:function(u,o){return[(0,e.jsx)(Ee.Z,{title:"\u60A8\u786E\u5B9A\u8981\u53D6\u6D88\u4E3B\u4F53\u6388\u6743\uFF1F\u53D6\u6D88\u6388\u6743\u540E\u4E0D\u53EF\u81EA\u52A8\u6062\u590D\u3002",placement:"bottomRight",icon:(0,e.jsx)(xe.Z,{style:{color:"red"}}),onConfirm:L()(r()().mark(function D(){var x,F,w;return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,M.AY)(o.id);case 2:if(x=v.sent,F=x.success,!F){v.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(w=t.current)===null||w===void 0||w.reload(),v.abrupt("return");case 8:case"end":return v.stop()}},D)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u53D6\u6D88\u6388\u6743"},"remove")},"delete")]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Pe.Z,{columns:k,actionRef:t,scroll:{x:700},rowSelection:{selections:[Ae.Z.SELECTION_ALL,Ae.Z.SELECTION_INVERT]},request:M.Je,params:{appId:s},rowKey:"id",search:{},options:!1,pagination:{defaultPageSize:5},style:{height:"calc(100vh - 190px)",overflow:"auto"},cardProps:{style:{minHeight:"100%"}},dateFormatter:"string",toolBarRender:function(){return[(0,e.jsx)(Fe.ZP,{icon:(0,e.jsx)(ye.Z,{}),type:"primary",onClick:function(){h(!0)},children:"\u6DFB\u52A0\u6388\u6743"},"add")]}}),(0,e.jsx)(Nr,{open:b,onCancel:function(){h(!1)},onFinish:function(){var i=L()(r()().mark(function u(o){var D,x,F;return r()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,(0,M.gI)(N()({appId:s},o));case 2:if(D=I.sent,x=D.success,!x){I.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(F=t.current)===null||F===void 0||F.reload(),I.abrupt("return",!0);case 8:return K.ZP.error("\u64CD\u4F5C\u5931\u8D25"),I.abrupt("return",!1);case 10:case"end":return I.stop()}},u)}));return function(u){return i.apply(this,arguments)}}()})]})},Ur=Mr,ze=j(63774),le=j(24380),Qr=function(){return(0,e.jsx)(ze.Z,{style:{height:"calc(100vh - 190px)",overflow:"auto"},bodyStyle:{height:"100%"},children:(0,e.jsx)(le.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},message:"\u6682\u672A\u5B9E\u73B0"})})},zr=j(80840),Gr=function(P){var t=(0,R.useRef)(),s=P.appId,C=P.protocol,y=[{title:"\u7CFB\u7EDF\u7528\u6237",dataIndex:"username",ellipsis:!0,fixed:"left"},{title:"\u5E94\u7528\u8D26\u6237",dataIndex:"account",ellipsis:!0},{title:"\u6DFB\u52A0\u65F6\u95F4",dataIndex:"createTime",valueType:"dateTime",search:!1,ellipsis:!0},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:80,align:"center",fixed:"right",render:function(k,i){return[(0,e.jsx)(Ee.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u6B64\u5E94\u7528\u8D26\u6237\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(xe.Z,{style:{color:"red"}}),onConfirm:L()(r()().mark(function u(){var o,D,x;return r()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,M.Zd)(i.id);case 2:if(o=w.sent,D=o.success,!D){w.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(x=t.current)===null||x===void 0||x.reload(),w.abrupt("return");case 8:case"end":return w.stop()}},u)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u5220\u9664"},"remove")},"delete")]}}],b=function(){var k=J.Z.useForm(),i=$()(k,1),u=i[0];return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(_e.Y,{title:"\u6DFB\u52A0\u5E94\u7528\u8D26\u6237",width:500,form:u,scrollToFirstError:!0,trigger:(0,e.jsx)(Fe.ZP,{icon:(0,e.jsx)(ye.Z,{}),type:"primary",children:"\u6DFB\u52A0\u5E94\u7528\u8D26\u6237"},"button"),layout:"vertical",autoFocusFirstInput:!0,preserve:!1,modalProps:{destroyOnClose:!0,onCancel:function(){u.resetFields()}},onFinish:function(){var o=L()(r()().mark(function D(x){var F,w,I,v,n;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return w=x,(F=w)!==null&&F!==void 0&&F.password&&(w=N()(N()({},w),{},{password:zr.DS.encode(x.password,!0)})),a.next=4,(0,M.o1)(N()({appId:s},w));case 4:if(I=a.sent,v=I.success,!v){a.next=10;break}return K.ZP.success("\u6DFB\u52A0\u6210\u529F"),(n=t.current)===null||n===void 0||n.reload(),a.abrupt("return",!0);case 10:return K.ZP.error("\u6DFB\u52A0\u5931\u8D25"),a.abrupt("return",!1);case 12:case"end":return a.stop()}},D)}));return function(D){return o.apply(this,arguments)}}(),children:[(0,e.jsx)(J.Z.Item,{label:"\u7CFB\u7EDF\u7528\u6237",name:"userId",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7CFB\u7EDF\u7528\u6237"}],children:(0,e.jsx)(Qe,{placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u3001\u624B\u673A\u6216\u90AE\u7BB1\u641C\u7D22\u7528\u6237"})}),C===Y.gD.FORM?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(U.Z,{label:"\u5E94\u7528\u7528\u6237\u540D",name:"account",placeholder:"\u8BF7\u8F93\u5165\u8D26\u6237\u8BBF\u95EE\u5E94\u7528\u65F6\u6240\u4F7F\u7528\u6237\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u6237\u8BBF\u95EE\u5E94\u7528\u65F6\u6240\u4F7F\u7528\u6237\u540D"}]}),(0,e.jsx)(U.Z.Password,{label:"\u5E94\u7528\u7528\u6237\u5BC6\u7801",name:"password",placeholder:"\u8BF7\u8F93\u5165\u8D26\u6237\u8BBF\u95EE\u5E94\u7528\u65F6\u6240\u4F7F\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u6237\u8BBF\u95EE\u5E94\u7528\u65F6\u6240\u4F7F\u5BC6\u7801"}]})]}):(0,e.jsx)(U.Z,{label:"\u5E94\u7528\u8EAB\u4EFD",name:"account",placeholder:"\u8BF7\u8F93\u5165\u8D26\u6237\u8BBF\u95EE\u5E94\u7528\u65F6\u6240\u4F7F\u8EAB\u4EFD",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u6237\u8BBF\u95EE\u5E94\u7528\u65F6\u6240\u4F7F\u8EAB\u4EFD"}]})]})})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(le.Z,{banner:!0,type:"info",message:" \u5982\u679C\u60A8\u914D\u7F6E\u4F7F\u7528\u3010\u7CFB\u7EDF\u8D26\u6237\u540D\u3011\uFF0C\u5E94\u7528\u8D26\u6237\u5C5E\u6027\u914D\u7F6E\u540E\u4E0D\u4F1A\u751F\u6548\uFF1B\u5982\u9700\u53D8\u66F4\uFF0C\u8BF7\u5728 \u534F\u8BAE\u914D\u7F6E \u66F4\u6539\u914D\u7F6E\u3002",style:{marginBottom:16}}),(0,e.jsx)(Pe.Z,{columns:y,actionRef:t,scroll:{x:700},rowSelection:{selections:[Ae.Z.SELECTION_ALL,Ae.Z.SELECTION_INVERT]},request:M.IC,params:{appId:s},rowKey:"id",search:{},style:{height:"calc(100vh - 244px)",overflow:"auto"},cardProps:{style:{minHeight:"100%"}},options:!1,pagination:{defaultPageSize:5},dateFormatter:"string",toolBarRender:function(){return[(0,e.jsx)(b,{},"create")]}})]})},Kr=Gr,fe=j(60305),rr=j(79696),Ge=j(59787),ke=j(30708),ar=j(84904),Jr=De.ZP.ConfigContext;function Vr(P){var t=(0,R.useContext)(Jr),s=t.getPrefixCls,C=".".concat(s()),y=(0,ar.l)(function(b){var h,k=b.token;return h={height:"calc(100vh - 190px)"},_()(h,".".concat(P,"-descriptions"),_()({},"".concat(C,"-descriptions-small ").concat(C,"-descriptions-row > th, ").concat(C,"-descriptions-small ").concat(C,"-descriptions-row > td"),{paddingBottom:"16px"})),_()(h,"@media screen and (max-width: ".concat(k.screenXL,"px)"),{height:"calc(100vh - 252px)"}),h});return{className:y}}var nr="user-detail-info",Yr=function(P){var t=P.appId,s=(0,R.useState)(!0),C=$()(s,2),y=C[0],b=C[1],h=(0,R.useState)(),k=$()(h,2),i=k[0],u=k[1],o=(0,Ge.useLocation)(),D=ke.Z.parse(o.search),x=Vr(nr),F=x.className;(0,X.Z)(L()(r()().mark(function I(){var v,n,A;return r()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return b(!0),S.next=3,(0,M.Mq)(t);case 3:v=S.sent,n=v.result,A=v.success,A&&n&&u(n),b(!1);case 8:case"end":return S.stop()}},I)})),[]);var w=function(){var I=L()(r()().mark(function v(n,A){var a,S;return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,M.KT)({id:A.id,name:A.name,remark:A.remark});case 2:if(a=f.sent,S=a.success,!S){f.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),u(N()({},A)),Ge.history.replace("/app/config?id=".concat(D.id,"&name=").concat(A.name,"&type=").concat(D.type)),f.abrupt("return",Promise.resolve(!0));case 9:return f.abrupt("return",Promise.resolve(!1));case 10:case"end":return f.stop()}},v)}));return function(n,A){return I.apply(this,arguments)}}();return(0,e.jsx)(ze.Z,{title:"\u57FA\u672C\u914D\u7F6E",headerBordered:!0,className:F,children:(0,e.jsx)(rr.Z,{loading:y,active:!0,paragraph:{rows:5},children:(0,e.jsx)("div",{className:je()("".concat(nr,"-descriptions")),children:(0,e.jsxs)(fe.vY,{size:"small",column:2,dataSource:(0,ie.omit)(i,"config"),editable:{onSave:w},children:[(0,e.jsx)(fe.vY.Item,{dataIndex:"name",label:"\u5E94\u7528\u540D\u79F0",copyable:!1,formItemProps:{rules:[{required:!0,message:"\u5E94\u7528\u540D\u79F0\u4E3A\u5FC5\u586B\u9879"}]}}),(0,e.jsx)(fe.vY.Item,{dataIndex:"enabled",label:"\u5E94\u7528\u72B6\u6001",editable:!1,valueEnum:{true:{text:"\u6B63\u5E38",status:"Success"},false:{text:"\u7981\u7528",status:"Error"}}}),(0,e.jsx)(fe.vY.Item,{dataIndex:"type",label:"\u5E94\u7528\u7C7B\u578B",editable:!1,valueEnum:{custom_made:{text:"\u5B9A\u5236\u5E94\u7528"},standard:{text:"\u6807\u51C6\u5E94\u7528"},self_developed:{text:"\u81EA\u7814\u5E94\u7528"}}}),(0,e.jsx)(fe.vY.Item,{dataIndex:"protocolName",label:"\u5E94\u7528\u534F\u8BAE",editable:!1}),(i==null?void 0:i.clientId)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(fe.vY.Item,{dataIndex:"clientId",label:"\u5BA2\u6237\u7AEF ID",valueType:"text",editable:!1,copyable:!0}),(0,e.jsx)(fe.vY.Item,{dataIndex:"clientSecret",label:"\u5BA2\u6237\u7AEF\u79D8\u94A5",valueType:"password",editable:!1,copyable:!0})]}),(0,e.jsx)(fe.vY.Item,{dataIndex:"createTime",label:"\u521B\u5EFA\u65F6\u95F4",valueType:"dateTime",copyable:!1,editable:!1}),(0,e.jsx)(fe.vY.Item,{dataIndex:"remark",label:"\u5907\u6CE8",valueType:"textarea",fieldProps:{rows:2,maxLength:20},copyable:!1})]})})})})},q;(function(P){P.BASIC="basic",P.PROTOCOL_CONFIG="protocol_config",P.ACCOUNT_SYNC="account_sync",P.ACCESS_POLICY="access_policy",P.LOGIN_ACCESS="login_access",P.PERMISSION_RESOURCE="permission_resource",P.PERMISSION_ROLE="permission_role",P.PERMISSION_POLICY="permission_policy",P.APP_PERMISSION="app_permission",P.APP_ACCOUNT="app_account"})(q||(q={}));var pe;(function(P){P.APP="only_app_init_sso",P.PORTAL_OR_APP="portal_or_app_init_sso"})(pe||(pe={}));var oe;(function(P){P.AUTHORIZATION="authorization",P.ALL_ACCESS="all_access"})(oe||(oe={}));var Oe;(function(P){P.SAML_SIGN="saml_sign"})(Oe||(Oe={}));var re=j(57346),Le=j(12790),tr=j(61715),H=j(64213),Hr=re.Z.Panel,qr=function(t){var s=(0,R.useState)(!1),C=$()(s,2),y=C[0],b=C[1],h=(0,R.useState)(),k=$()(h,2),i=k[0],u=k[1],o=(0,R.useState)([]),D=$()(o,2),x=D[0],F=D[1],w=t.open,I=t.appId,v=t.onCancel,n=t.subjectType;(0,X.Z)(L()(r()().mark(function a(){var S,c;return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!w){g.next=8;break}return b(!0),g.next=4,(0,M.Sf)({appId:I});case 4:S=g.sent,c=S.result,u(c),b(!1);case 8:case"end":return g.stop()}},a)})),[w,n]);var A=function(S){if(S.target.checked){F([].concat(te()(x),[S.target.value]));return}F(x==null?void 0:x.filter(function(c){return c!==S.target.value}))};return(0,e.jsx)(tr.a,{title:"\u6388\u6743",width:650,layout:"horizontal",labelCol:{span:4},open:w,wrapperCol:{span:19},onFinish:function(S){return b(!0),console.log("roles",S.roles),console.log("subjectIds",S.subjectIds),console.log("permissions",x),F([]),b(!1),Promise.resolve(!1)},drawerProps:{destroyOnClose:!0,onClose:function(S){F([]),v(S)}},children:(0,e.jsxs)(se.Z,{spinning:y,children:[(0,e.jsx)(le.Z,{message:"\u652F\u6301\u4E24\u79CD\u6743\u9650\u6A21\u578B\uFF1A\u57FA\u4E8E\u89D2\u8272\u7684\u8BBF\u95EE\u63A7\u5236\uFF08RBAC\uFF09\u548C\u57FA\u4E8E\u5C5E\u6027\u7684\u8BBF\u95EE\u63A7\u5236\uFF08ABAC\uFF09"}),(0,e.jsx)("br",{}),n===Y.SC.USER&&(0,e.jsx)(J.Z.Item,{label:"\u6388\u6743\u7528\u6237",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u7528\u6237"}],children:(0,e.jsx)(Qe,{placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u3001\u624B\u673A\u6216\u90AE\u7BB1\u641C\u7D22\u7528\u6237",mode:"multiple"})}),n===Y.SC.USER_GROUP&&(0,e.jsx)(J.Z.Item,{label:"\u6388\u6743\u7528\u6237\u7EC4",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u5206\u7EC4"}],children:(0,e.jsx)(He,{placeholder:"\u8BF7\u9009\u62E9\u6388\u6743\u5206\u7EC4",mode:"multiple"})}),n===Y.SC.ORGANIZATION&&(0,e.jsx)(J.Z.Item,{label:"\u6388\u6743\u7EC4\u7EC7",name:"subjectIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9009\u62E9\u7EC4\u7EC7\u8282\u70B9"}],children:(0,e.jsx)(Ve,{placeholder:"\u9009\u62E9\u7EC4\u7EC7\u8282\u70B9"})}),(0,e.jsxs)(Le.Z,{bodyStyle:{paddingBottom:0,paddingTop:0},children:[(0,e.jsx)(W.Z,{orientation:"left",children:"\u5E94\u7528\u89D2\u8272"}),(0,e.jsx)(H.Z.Group,{name:"roles",layout:"vertical",options:["\u8682\u8681\u533A\u5757\u94FEBaaS\u5E73\u53F0-\u7BA1\u7406\u5458","\u5BA1\u8BA1\u7BA1\u7406\u5458","Captain-\u96C6\u7FA4\u6269\u5BB9\u5DE5\u7A0B\u5E08","Captain-\u96C6\u7FA4\u8FD0\u7EF4\u5DE5\u7A0B\u5E08","Captain-\u96C6\u7FA4\u7BA1\u7406\u5458","Captain-\u8D85\u7EA7\u7BA1\u7406\u5458","\u51FD\u6570\u8BA1\u7B97\u7BA1\u7406\u5458","\u51FD\u6570\u8BA1\u7B97\u89C2\u5BDF\u8005"]})]}),(0,e.jsx)("br",{}),(0,e.jsxs)(Le.Z,{bodyStyle:{paddingBottom:0,paddingTop:0},children:[(0,e.jsx)(W.Z,{orientation:"left",children:"\u5E94\u7528\u8D44\u6E90"}),i==null?void 0:i.map(function(a){var S,c,f,g,p;return(0,e.jsxs)("div",{children:[(0,e.jsx)(re.Z,{bordered:!1,children:(0,e.jsxs)(Hr,{header:a.name,children:[a.menus.length>0&&(0,e.jsx)(H.Z.Group,{name:"menu_".concat(a.id),label:"\u83DC\u5355\u6743\u9650",layout:"vertical",options:(S=a.menus)===null||S===void 0?void 0:S.map(function(l){return{label:l.name,value:l.id,onChange:A}})}),a.buttons.length>0&&(0,e.jsx)(H.Z.Group,{name:"button_".concat(a.id),label:"\u6309\u94AE\u6743\u9650",layout:"vertical",options:(c=a.buttons)===null||c===void 0?void 0:c.map(function(l){return{label:l.name,value:l.id,onChange:A}})}),a.apis.length>0&&(0,e.jsx)(H.Z.Group,{name:"api_".concat(a.id),layout:"vertical",label:"\u63A5\u53E3\u6743\u9650",options:(f=a.apis)===null||f===void 0?void 0:f.map(function(l){return{label:l.name,value:l.id,onChange:A}})}),a.datas.length>0&&(0,e.jsx)(H.Z.Group,{name:"data_".concat(a.id),layout:"vertical",label:"\u6570\u636E\u6743\u9650",options:(g=a.apis)===null||g===void 0?void 0:g.map(function(l){return{label:l.name,value:l.id,onChange:A}})}),a.others.length>0&&(0,e.jsx)(H.Z.Group,{name:"other_".concat(a.id),layout:"vertical",label:"\u5176\u4ED6\u6743\u9650",options:(p=a.apis)===null||p===void 0?void 0:p.map(function(l){return{label:l.name,value:l.id,onChange:A}})})]},a.id)},a.id),(0,e.jsx)("br",{})]},a.id)})]})]})},"create_permission")},Xr=qr,Wr=re.Z.Panel,_r=function(t){var s=J.Z.useForm(),C=$()(s,1),y=C[0],b=(0,R.useState)(!1),h=$()(b,2),k=h[0],i=h[1],u=(0,R.useState)(),o=$()(u,2),D=o[0],x=o[1],F=t.open,w=t.onCancel,I=t.subjectType,v=t.subjectId,n=(0,R.useState)([]),A=$()(n,2),a=A[0],S=A[1];(0,X.Z)(L()(r()().mark(function f(){return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:F&&(i(!0),console.log(v),x([]),i(!1));case 1:case"end":return p.stop()}},f)})),[F,I,v]);var c=function(g){if(g.target.checked){S([].concat(te()(a),[g.target.value]));return}S(a==null?void 0:a.filter(function(p){return p!==g.target.value}))};return(0,e.jsx)(tr.a,{title:"\u6388\u6743",width:650,layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},form:y,scrollToFirstError:!0,trigger:(0,e.jsx)("a",{type:"primary",children:"\u4FEE\u6539"},"update"),onFinish:function(g){return i(!0),console.log("roles",g.roles),console.log("permissions",a),S([]),i(!1),Promise.resolve(!1)},drawerProps:{afterOpenChange:function(g){},destroyOnClose:!0,onClose:function(g){S([]),w(g)}},children:(0,e.jsxs)(se.Z,{spinning:k,children:[(0,e.jsx)(le.Z,{message:"\u652F\u6301\u4E24\u79CD\u6743\u9650\u6A21\u578B\uFF1A\u57FA\u4E8E\u89D2\u8272\u7684\u8BBF\u95EE\u63A7\u5236\uFF08RBAC\uFF09\u548C\u57FA\u4E8E\u5C5E\u6027\u7684\u8BBF\u95EE\u63A7\u5236\uFF08ABAC\uFF09"}),(0,e.jsx)("br",{}),(0,e.jsxs)(Le.Z,{bodyStyle:{paddingBottom:0,paddingTop:0},children:[(0,e.jsx)(W.Z,{orientation:"left",children:"\u5E94\u7528\u89D2\u8272"}),(0,e.jsx)(H.Z.Group,{name:"roles",layout:"vertical",options:["\u8682\u8681\u533A\u5757\u94FEBaaS\u5E73\u53F0-\u7BA1\u7406\u5458","\u5BA1\u8BA1\u7BA1\u7406\u5458","Captain-\u96C6\u7FA4\u6269\u5BB9\u5DE5\u7A0B\u5E08","Captain-\u96C6\u7FA4\u8FD0\u7EF4\u5DE5\u7A0B\u5E08","Captain-\u96C6\u7FA4\u7BA1\u7406\u5458","Captain-\u8D85\u7EA7\u7BA1\u7406\u5458","\u51FD\u6570\u8BA1\u7B97\u7BA1\u7406\u5458","\u51FD\u6570\u8BA1\u7B97\u89C2\u5BDF\u8005"]})]}),(0,e.jsx)("br",{}),(0,e.jsxs)(Le.Z,{bodyStyle:{paddingBottom:0,paddingTop:0},children:[(0,e.jsx)(W.Z,{orientation:"left",children:"\u5E94\u7528\u8D44\u6E90"}),D==null?void 0:D.map(function(f){var g,p,l,d,E;return(0,e.jsxs)("div",{children:[(0,e.jsx)(re.Z,{bordered:!1,children:(0,e.jsxs)(Wr,{header:f.name,children:[f.menus.length>0&&(0,e.jsx)(H.Z.Group,{name:"menu_".concat(f.id),label:"\u83DC\u5355\u6743\u9650",layout:"vertical",options:(g=f.menus)===null||g===void 0?void 0:g.map(function(B){return{label:B.name,value:B.id,onChange:c}})}),f.buttons.length>0&&(0,e.jsx)(H.Z.Group,{name:"button_".concat(f.id),label:"\u6309\u94AE\u6743\u9650",layout:"vertical",options:(p=f.buttons)===null||p===void 0?void 0:p.map(function(B){return{label:B.name,value:B.id,onChange:c}})}),f.apis.length>0&&(0,e.jsx)(H.Z.Group,{name:"api_".concat(f.id),layout:"vertical",label:"\u63A5\u53E3\u6743\u9650",options:(l=f.apis)===null||l===void 0?void 0:l.map(function(B){return{label:B.name,value:B.id,onChange:c}})}),f.datas.length>0&&(0,e.jsx)(H.Z.Group,{name:"data_".concat(f.id),layout:"vertical",label:"\u6570\u636E\u6743\u9650",options:(d=f.apis)===null||d===void 0?void 0:d.map(function(B){return{label:B.name,value:B.id,onChange:c}})}),f.others.length>0&&(0,e.jsx)(H.Z.Group,{name:"other_".concat(f.id),layout:"vertical",label:"\u5176\u4ED6\u6743\u9650",options:(E=f.apis)===null||E===void 0?void 0:E.map(function(B){return{label:B.name,value:B.id,onChange:c}})})]},f.id)},f.id),(0,e.jsx)("br",{})]},f.id)})]})]})},"update_permission")},ea=_r,ra=function(P){var t=(0,R.useState)(Y.SC.USER),s=$()(t,2),C=s[0],y=s[1],b=(0,R.useState)(!1),h=$()(b,2),k=h[0],i=h[1],u=(0,R.useRef)(),o=P.appId,D=[{title:"\u540D\u79F0",dataIndex:"name",ellipsis:!0,width:"300",fixed:"left"},{title:"\u6388\u6743\u65F6\u95F4",align:"center",dataIndex:"desc",search:!1},{title:"\u64CD\u4F5C",align:"center",valueType:"option",fixed:"right",width:150,render:function(F,w){return[(0,e.jsx)(ea,{onCancel:function(){},open:!0,subjectType:C,subjectId:w.id},w.id),(0,e.jsx)(Ee.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(xe.Z,{style:{color:"red"}}),onConfirm:L()(r()().mark(function I(){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:(0,M.IV)(w.id).then(function(A){if(A.success&&A.result){var a;K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(a=u.current)===null||a===void 0||a.reload();return}});case 1:case"end":return n.stop()}},I)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u5220\u9664"},"remove")},"delete")]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Pe.Z,{columns:D,options:!1,scroll:{x:700},pagination:{showQuickJumper:!0,defaultPageSize:10},style:{height:"calc(100vh - 190px)",overflow:"auto"},cardProps:{style:{minHeight:"100%"}},actionRef:u,request:M.zr,params:{appId:o,subjectType:C},rowKey:"id",dateFormatter:"string",toolbar:{menu:{type:"tab",activeKey:C,items:[{key:Y.SC.USER,label:(0,e.jsx)("span",{children:"\u7528\u6237"})},{key:Y.SC.USER_GROUP,label:(0,e.jsx)("span",{children:"\u7528\u6237\u7EC4"})},{key:Y.SC.ORGANIZATION,label:(0,e.jsx)("span",{children:"\u7EC4\u7EC7\u673A\u6784"})}],onChange:function(F){y(F)}},actions:[(0,e.jsx)(Fe.ZP,{icon:(0,e.jsx)(ye.Z,{}),type:"primary",onClick:function(){i(!0)},children:"\u65B0\u589E\u6388\u6743"},"create")]}}),(0,e.jsx)(Xr,{subjectType:C,open:k,onCancel:function(){i(!1)},appId:o},"create")]})},aa=ra,sr=j(36489),ur=j(60240),lr=j(38735),he=j(93973),ce=j(72103),be=j(90233),ue=j(24285),$e=j(65855),Ne=j(15874),na=function(t){var s=t.open,C=t.onCancel,y=t.onFinish,b=t.appId,h=(0,R.useState)(function(){return[]}),k=$()(h,2),i=k[0],u=k[1],o=(0,R.useState)(!1),D=$()(o,2),x=D[0],F=D[1],w=(0,R.useState)(0),I=$()(w,2),v=I[0],n=I[1],A=(0,R.useRef)([]),a=J.Z.useForm(),S=$()(a,1),c=S[0],f=(0,R.useRef)();(0,R.useEffect)(function(){},[s]);var g=[{title:"\u6743\u9650\u7C7B\u578B",key:"type",dataIndex:"type",valueType:"select",width:80,fieldProps:{allowClear:!1,options:[{value:"DATA",label:"\u6570\u636E"},{value:"MENU",label:"\u83DC\u5355"},{value:"BUTTON",label:"\u6309\u94AE"},{value:"API",label:"API"},{value:"OTHER",label:"\u5176\u4ED6"}]},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u6743\u9650\u503C",dataIndex:"value",width:150,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u63CF\u8FF0",dataIndex:"name",width:150,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u64CD\u4F5C",fixed:"right",align:"center",width:30,valueType:"option"}];return(0,e.jsxs)(ce.L,{formMapRef:A,current:v,onCurrentChange:n,stepsFormRender:function(l,d){return(0,e.jsx)(Ne.Z,{title:"\u521B\u5EFA\u8D44\u6E90",width:600,maskClosable:!0,destroyOnClose:!0,onClose:function(B){n(0),C(B)},open:s,footer:(0,e.jsx)(he.Z,{style:{float:"right"},children:d}),children:(0,e.jsx)(se.Z,{spinning:x,children:l})})},onFinish:function(){var p=L()(r()().mark(function l(d){var E;return r()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return F(!0),Z.next=3,y==null?void 0:y(d);case 3:return E=Z.sent,F(!1),n(0),Z.abrupt("return",E);case 7:case"end":return Z.stop()}},l)}));return function(l){return p.apply(this,arguments)}}(),children:[(0,e.jsxs)(ce.L.StepForm,{scrollToFirstError:!0,name:"basic",title:"\u57FA\u672C\u4FE1\u606F",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},labelAlign:"right",children:[(0,e.jsx)(U.Z,{name:"name",label:"\u8D44\u6E90\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D44\u6E90\u540D\u79F0"},{validator:function(){var p=L()(r()().mark(function d(E,B){var Z,m,T;return r()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(B){O.next=2;break}return O.abrupt("return",Promise.resolve());case 2:return O.next=4,(0,M.OR)(b,"NAME",B);case 4:if(Z=O.sent,m=Z.success,T=Z.result,m){O.next=9;break}return O.abrupt("return",Promise.reject());case 9:if(T){O.next=11;break}return O.abrupt("return",Promise.reject(new Error("\u8D44\u6E90\u540D\u79F0\u5DF2\u5B58\u5728")));case 11:case"end":return O.stop()}},d)}));function l(d,E){return p.apply(this,arguments)}return l}(),validateTrigger:["onBlur"]}]}),(0,e.jsx)(U.Z,{name:"code",label:"\u8D44\u6E90\u7F16\u7801",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u7F16\u7801",rules:[{required:!0,message:"\u8D44\u6E90\u7F16\u7801\u4E3A\u5FC5\u586B\u9879"},{validator:function(){var p=L()(r()().mark(function d(E,B){var Z,m,T;return r()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(B){O.next=2;break}return O.abrupt("return",Promise.resolve());case 2:return F(!0),O.next=5,(0,M.OR)(b,"CODE",B);case 5:if(Z=O.sent,m=Z.success,T=Z.result,F(!1),m){O.next=11;break}return O.abrupt("return",Promise.reject());case 11:if(T){O.next=13;break}return O.abrupt("return",Promise.reject(new Error("\u8D44\u6E90\u7F16\u7801\u5DF2\u5B58\u5728")));case 13:case"end":return O.stop()}},d)}));function l(d,E){return p.apply(this,arguments)}return l}(),validateTrigger:["onBlur"]}],extra:"\u8D44\u6E90\u7F16\u7801\u5728\u5F53\u524D\u5E94\u7528\u4E2D\u7684\u552F\u4E00\u6807\u8BC6\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u4EC5\u652F\u6301\u82F1\u6587\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\uFF0C\u521B\u5EFA\u540E\u4E0D\u53EF\u4FEE\u6539\u3002"}),(0,e.jsx)(be.Z,{name:"desc",fieldProps:{rows:2},label:"\u8D44\u6E90\u63CF\u8FF0",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u63CF\u8FF0",rules:[{required:!0,message:"\u8D44\u6E90\u63CF\u8FF0\u4E3A\u5FC5\u586B\u9879"}]})]}),(0,e.jsx)(ce.L.StepForm,{scrollToFirstError:!0,name:"actions",title:"\u6743\u9650\u9879",layout:"vertical",labelAlign:"right",onFinish:L()(r()().mark(function p(){var l;return r()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return F(!0),E.next=3,c.validateFields();case 3:if(l=E.sent,F(!1),!l){E.next=7;break}return E.abrupt("return",Promise.resolve(!0));case 7:return E.abrupt("return",Promise.resolve(!1));case 8:case"end":return E.stop()}},p)})),children:(0,e.jsx)(ue.A.Item,{label:"\u8D44\u6E90\u6743\u9650",name:"actions",trigger:"onValuesChange",rules:[{required:!0,message:"\u8D44\u6E90\u6743\u9650\u4E3A\u5FC5\u586B\u9879"}],tooltip:"\u4E3A\u8D44\u6E90\u5B9A\u4E49\u6743\u9650\uFF0C\u8BF7\u9009\u62E9\u6743\u9650\u7C7B\u578B\uFF0C\u5E76\u914D\u7F6E\u6743\u9650\u503C\u3002",children:(0,e.jsx)($e.Z,{rowKey:"key",scroll:{x:700},actionRef:f,toolBarRender:!1,columns:g,recordCreatorProps:{creatorButtonText:"\u6DFB\u52A0\u8D44\u6E90\u6743\u9650",newRecordType:"dataSource",position:"bottom",record:function(){return{key:Date.now()}}},editable:{form:c,type:"multiple",editableKeys:i,onChange:u,deletePopconfirmMessage:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6743\u9650\u8D44\u6E90\u5417\uFF1F",actionRender:function(l,d,E){return[E.delete]}}})})})]})},ta=na,ir=j(96569),sa=function(t){var s=t.open,C=t.onCancel,y=t.onFinish,b=t.id,h=t.appId,k=(0,R.useState)(!1),i=$()(k,2),u=i[0],o=i[1],D=(0,R.useState)(0),x=$()(D,2),F=x[0],w=x[1],I=(0,R.useState)(function(){return[]}),v=$()(I,2),n=v[0],A=v[1],a=(0,R.useRef)([]),S=J.Z.useForm(),c=$()(S,1),f=c[0],g=(0,R.useRef)();(0,X.Z)(L()(r()().mark(function l(){var d,E,B,Z,m;return r()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if(!(s&&b)){Q.next=14;break}return o(!0),Q.next=4,(0,M.NZ)(b);case 4:if(d=Q.sent,E=d.success,B=d.result,!(E&&B)){Q.next=12;break}return a==null||(Z=a.current)===null||Z===void 0||Z.forEach(function(O){var G;O==null||(G=O.current)===null||G===void 0||G.setFieldsValue(N()(N()({},B),{},{id:b}))}),A((m=B.actions)===null||m===void 0?void 0:m.map(function(O){return O.id})),o(!1),Q.abrupt("return");case 12:C(),K.ZP.warning("\u672A\u83B7\u53D6\u5230\u8BE5".concat(b,"\u8D44\u6E90\u6570\u636E\uFF01"));case 14:case"end":return Q.stop()}},l)})),[b,C,s]);var p=[{title:"\u6743\u9650\u7C7B\u578B",key:"type",dataIndex:"type",valueType:"select",width:80,fieldProps:{allowClear:!1,options:[{value:"DATA",label:"\u6570\u636E"},{value:"MENU",label:"\u83DC\u5355"},{value:"BUTTON",label:"\u6309\u94AE"},{value:"API",label:"API"},{value:"OTHER",label:"\u5176\u4ED6"}]},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u6743\u9650\u503C",dataIndex:"value",copyable:!0,width:150,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u63CF\u8FF0",dataIndex:"name",width:150,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u64CD\u4F5C",fixed:"right",align:"center",width:30,valueType:"option"}];return(0,e.jsxs)(ce.L,{formMapRef:a,current:F,onCurrentChange:w,stepsFormRender:function(d,E){return(0,e.jsx)(Ne.Z,{title:"\u4FEE\u6539\u8D44\u6E90",width:600,maskClosable:!0,destroyOnClose:!0,onClose:function(Z){w(0),C(Z)},open:s,footer:(0,e.jsx)(he.Z,{style:{float:"right"},children:E}),children:(0,e.jsx)(se.Z,{spinning:u,children:d})})},onFinish:function(){var l=L()(r()().mark(function d(E){var B;return r()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return o(!0),m.next=3,y==null?void 0:y(E);case 3:return B=m.sent,o(!1),w(0),m.abrupt("return",B);case 7:case"end":return m.stop()}},d)}));return function(d){return l.apply(this,arguments)}}(),children:[(0,e.jsxs)(ce.L.StepForm,{scrollToFirstError:!0,name:"basic",title:"\u57FA\u672C\u4FE1\u606F",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},labelAlign:"right",children:[(0,e.jsx)(U.Z,{name:"id",hidden:!0}),(0,e.jsx)(U.Z,{name:"name",label:"\u8D44\u6E90\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D44\u6E90\u540D\u79F0"},{validator:function(){var l=L()(r()().mark(function E(B,Z){var m,T,Q;return r()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(Z){G.next=2;break}return G.abrupt("return",Promise.resolve());case 2:return o(!0),G.next=5,(0,M.OR)(h,"NAME",Z,b);case 5:if(m=G.sent,T=m.success,Q=m.result,o(!1),T){G.next=11;break}return G.abrupt("return",Promise.reject());case 11:if(Q){G.next=13;break}return G.abrupt("return",Promise.reject(new Error("\u8D44\u6E90\u540D\u79F0\u5DF2\u5B58\u5728")));case 13:case"end":return G.stop()}},E)}));function d(E,B){return l.apply(this,arguments)}return d}(),validateTrigger:["onBlur"]}]}),(0,e.jsx)(U.Z,{name:"code",label:"\u8D44\u6E90\u7F16\u7801",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u7F16\u7801",proFieldProps:{render:function(d){return d&&(0,e.jsx)(ir.Z,{copyable:{text:d},style:{marginBottom:"0"},children:(0,e.jsx)("span",{dangerouslySetInnerHTML:{__html:"<span>".concat(d,"</span>")}})})}},readonly:!0,extra:"\u8D44\u6E90\u7F16\u7801\u5728\u5F53\u524D\u5E94\u7528\u4E2D\u7684\u552F\u4E00\u6807\u8BC6\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u4EC5\u652F\u6301\u82F1\u6587\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\uFF0C\u521B\u5EFA\u540E\u4E0D\u53EF\u4FEE\u6539\u3002"}),(0,e.jsx)(be.Z,{name:"desc",fieldProps:{rows:2},label:"\u8D44\u6E90\u63CF\u8FF0",placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u63CF\u8FF0"})]}),(0,e.jsx)(ce.L.StepForm,{scrollToFirstError:!0,name:"actions",title:"\u6743\u9650\u9879",layout:"vertical",labelAlign:"right",onFinish:L()(r()().mark(function l(){var d;return r()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return o(!0),B.next=3,f.validateFields();case 3:if(d=B.sent,o(!1),!d){B.next=7;break}return B.abrupt("return",Promise.resolve(!0));case 7:return B.abrupt("return",Promise.resolve(!1));case 8:case"end":return B.stop()}},l)})),children:(0,e.jsx)(ue.A.Item,{label:"\u8D44\u6E90\u6743\u9650",name:"actions",trigger:"onValuesChange",rules:[{required:!0,message:"\u8D44\u6E90\u6743\u9650\u4E3A\u5FC5\u586B\u9879"}],tooltip:"\u4E3A\u8D44\u6E90\u5B9A\u4E49\u6743\u9650\uFF0C\u8BF7\u9009\u62E9\u6743\u9650\u7C7B\u578B\uFF0C\u5E76\u914D\u7F6E\u6743\u9650\u503C\u3002",children:(0,e.jsx)($e.Z,{rowKey:"id",scroll:{x:700},actionRef:g,toolBarRender:!1,columns:p,recordCreatorProps:{creatorButtonText:"\u6DFB\u52A0\u8D44\u6E90\u6743\u9650",newRecordType:"dataSource",position:"bottom",record:function(){return{id:Date.now()}}},editable:{form:f,type:"multiple",editableKeys:n,onChange:A,deletePopconfirmMessage:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6743\u9650\u8D44\u6E90\u5417\uFF1F",actionRender:function(d,E,B){return[B.delete]}}})})})]})},ua=sa,la=ur.Z.confirm,ia=function(P){var t=(0,R.useRef)(),s=P.appId,C=(0,R.useState)(!1),y=$()(C,2),b=y[0],h=y[1],k=(0,R.useState)(!1),i=$()(k,2),u=i[0],o=i[1],D=(0,R.useState)(),x=$()(D,2),F=x[0],w=x[1],I=[{title:"\u8D44\u6E90\u540D\u79F0",dataIndex:"name",ellipsis:!0,fixed:"left",copyable:!1},{title:"\u8D44\u6E90\u7F16\u7801",dataIndex:"code",ellipsis:!0,copyable:!0},{title:"\u8D44\u6E90\u63CF\u8FF0",dataIndex:"desc",search:!1,ellipsis:!0,copyable:!1},{title:"\u72B6\u6001",dataIndex:"enabled",search:!1,align:"center",render:function(n,A){return(0,e.jsx)(lr.Z,{checked:n,onChange:function(){var a=L()(r()().mark(function S(c){var f,g,p;return r()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!c){d.next=9;break}return d.next=3,(0,M.PE)(A.id);case 3:if(f=d.sent,g=f.success,!g){d.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(p=t.current)===null||p===void 0||p.reload(),d.abrupt("return");case 9:la({title:"\u8B66\u544A",icon:(0,e.jsx)(sr.Z,{}),content:"\u786E\u5B9A\u7981\u7528\u6B64\u8D44\u6E90\uFF1F",okText:"\u786E\u5B9A",okType:"danger",cancelText:"\u53D6\u6D88",centered:!0,onOk:function(){var E=L()(r()().mark(function Z(){var m,T,Q;return r()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,(0,M._G)(A.id);case 2:if(m=G.sent,T=m.success,!T){G.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(Q=t.current)===null||Q===void 0||Q.reload(),G.abrupt("return");case 8:case"end":return G.stop()}},Z)}));function B(){return E.apply(this,arguments)}return B}(),onCancel:function(){}});case 10:case"end":return d.stop()}},S)}));return function(S){return a.apply(this,arguments)}}()})}},{title:"\u64CD\u4F5C",align:"center",valueType:"option",fixed:"right",width:150,render:function(n,A){return[(0,e.jsx)("a",{target:"_blank",onClick:function(){w(A.id),o(!0)},children:"\u4FEE\u6539"},"update"),(0,e.jsx)(Ee.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(xe.Z,{style:{color:"red"}}),onConfirm:L()(r()().mark(function a(){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:(0,M.IV)(A.id).then(function(f){if(f.success&&f.result){var g;K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(g=t.current)===null||g===void 0||g.reload();return}});case 1:case"end":return c.stop()}},a)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u5220\u9664"},"remove")},"delete")]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Pe.Z,{columns:I,actionRef:t,request:M.UK,params:{appId:s},rowKey:"id",options:!1,scroll:{x:650},style:{height:"calc(100vh - 190px)",overflow:"auto"},cardProps:{style:{minHeight:"100%"}},toolbar:{actions:[(0,e.jsx)(Fe.ZP,{type:"primary",icon:(0,e.jsx)(ye.Z,{}),onClick:function(){h(!0)},children:"\u65B0\u589E\u8D44\u6E90"},"create")]},pagination:{showQuickJumper:!0,defaultPageSize:10},rowSelection:{selections:[Ae.Z.SELECTION_ALL,Ae.Z.SELECTION_INVERT]},tableAlertRender:function(n){var A=n.selectedRowKeys,a=n.onCleanSelected;return(0,e.jsx)(he.Z,{size:24,children:(0,e.jsxs)("span",{children:["\u5DF2\u9009 ",A.length," \u9879",(0,e.jsx)("a",{style:{marginLeft:8},onClick:a,children:"\u53D6\u6D88\u9009\u62E9"})]})})},tableAlertOptionRender:function(n){return(0,e.jsx)(he.Z,{size:16,children:(0,e.jsx)(Ee.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(xe.Z,{style:{color:"red"}}),onConfirm:L()(r()().mark(function A(){var a,S,c;return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,M.O0)(n.selectedRowKeys);case 2:if(a=g.sent,S=a.success,!S){g.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),n.onCleanSelected(),(c=t.current)===null||c===void 0||c.reload(),g.abrupt("return");case 9:case"end":return g.stop()}},A)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u6279\u91CF\u5220\u9664"},"remove")},"delete")})}}),(0,e.jsx)(ta,{appId:s,open:b,onCancel:function(){h(!1)},onFinish:function(){var v=L()(r()().mark(function n(A){var a,S,c;return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,M.bm)(N()(N()({},A),{},{appId:s}));case 2:if(a=g.sent,S=a.success,!S){g.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(c=t.current)===null||c===void 0||c.reload(),h(!1),g.abrupt("return",Promise.resolve(!0));case 9:return g.abrupt("return",Promise.resolve(!1));case 10:case"end":return g.stop()}},n)}));return function(n){return v.apply(this,arguments)}}()}),(0,e.jsx)(ua,{id:F,appId:s,open:u,onCancel:function(){o(!1)},onFinish:function(){var v=L()(r()().mark(function n(A){var a,S,c;return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,M.Y3)(N()(N()({},A),{},{appId:s}));case 2:a=g.sent,S=a.success,S&&((c=t.current)===null||c===void 0||c.reload(),o(!1),K.ZP.success("\u64CD\u4F5C\u6210\u529F"));case 5:case"end":return g.stop()}},n)}));return function(n){return v.apply(this,arguments)}}()})]})},oa=j(7206),ca=re.Z.Panel,da=function(t){var s=t.open,C=t.onCancel,y=t.onFinish,b=t.appId,h=(0,R.useRef)([]),k=(0,R.useState)(),i=$()(k,2),u=i[0],o=i[1],D=(0,R.useState)(!1),x=$()(D,2),F=x[0],w=x[1],I=(0,R.useState)(0),v=$()(I,2),n=v[0],A=v[1],a=(0,R.useState)([]),S=$()(a,2),c=S[0],f=S[1];(0,X.Z)(L()(r()().mark(function p(){var l,d,E;return r()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(!s){Z.next=9;break}return w(!0),h==null||(l=h.current)===null||l===void 0||l.forEach(function(m){var T;(T=m.current)===null||T===void 0||T.setFieldsValue({code:(0,oa.MX)(9),appId:b})}),Z.next=5,(0,M.Sf)({appId:b});case 5:d=Z.sent,E=d.result,o(E),w(!1);case 9:case"end":return Z.stop()}},p)})),[b,s]);var g=function(l){if(l.target.checked){f([].concat(te()(c),[l.target.value]));return}f(c==null?void 0:c.filter(function(d){return d!==l.target.value}))};return(0,e.jsxs)(ce.L,{onFinish:function(){var p=L()(r()().mark(function l(d){var E;return r()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return w(!0),console.log("permissions",c),Z.next=4,y==null?void 0:y(d);case 4:return E=Z.sent,w(!1),A(0),Z.abrupt("return",E);case 8:case"end":return Z.stop()}},l)}));return function(l){return p.apply(this,arguments)}}(),current:n,onCurrentChange:A,formProps:{validateMessages:{required:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}},formMapRef:h,stepsFormRender:function(l,d){return(0,e.jsx)(Ne.Z,{title:"\u65B0\u589E\u89D2\u8272",width:600,forceRender:!0,onClose:function(){A(0),C()},open:s,footer:(0,e.jsx)(he.Z,{style:{float:"right"},children:d}),destroyOnClose:!0,children:(0,e.jsx)(se.Z,{spinning:F,children:l})})},children:[(0,e.jsxs)(ce.L.StepForm,{scrollToFirstError:!0,name:"basic",title:"\u57FA\u672C\u4FE1\u606F",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},labelAlign:"right",children:[(0,e.jsx)(U.Z,{name:"appId",hidden:!0}),(0,e.jsx)(U.Z,{name:"name",label:"\u89D2\u8272\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",rules:[{required:!0,message:"\u89D2\u8272\u540D\u79F0\u4E3A\u5FC5\u586B\u9879"},{validator:function(){var p=L()(r()().mark(function d(E,B){var Z,m,T;return r()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(B){O.next=2;break}return O.abrupt("return",Promise.resolve());case 2:return w(!0),O.next=5,(0,M.ld)(b,"NAME",B);case 5:if(Z=O.sent,m=Z.success,T=Z.result,w(!1),m){O.next=11;break}return O.abrupt("return",Promise.reject());case 11:if(T){O.next=13;break}return O.abrupt("return",Promise.reject(new Error("\u89D2\u8272\u540D\u79F0\u5DF2\u5B58\u5728")));case 13:case"end":return O.stop()}},d)}));function l(d,E){return p.apply(this,arguments)}return l}(),validateTrigger:["onBlur"]}]}),(0,e.jsx)(U.Z,{name:"code",label:"\u89D2\u8272\u6807\u8BC6",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u6807\u8BC6",rules:[{required:!0,message:"\u89D2\u8272\u6807\u8BC6\u4E3A\u5FC5\u586B\u9879"},{validator:function(){var p=L()(r()().mark(function d(E,B){var Z,m,T;return r()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(B){O.next=2;break}return O.abrupt("return",Promise.resolve());case 2:return w(!0),O.next=5,(0,M.ld)(b,"CODE",B);case 5:if(Z=O.sent,m=Z.success,T=Z.result,w(!1),m){O.next=11;break}return O.abrupt("return",Promise.reject());case 11:if(T){O.next=13;break}return O.abrupt("return",Promise.reject(new Error("\u89D2\u8272\u6807\u8BC6\u5DF2\u5B58\u5728")));case 13:case"end":return O.stop()}},d)}));function l(d,E){return p.apply(this,arguments)}return l}(),validateTrigger:["onBlur"]}],extra:"\u89D2\u8272\u7F16\u7801\u5728\u5F53\u524D\u5E94\u7528\u4E2D\u7684\u552F\u4E00\u6807\u8BC6\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u4EC5\u652F\u6301\u82F1\u6587\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\uFF0C\u521B\u5EFA\u540E\u4E0D\u53EF\u4FEE\u6539\u3002"}),(0,e.jsx)(be.Z,{name:"remark",label:"\u89D2\u8272\u63CF\u8FF0",fieldProps:{rows:2},placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"})]}),(0,e.jsx)(ce.L.StepForm,{scrollToFirstError:!0,name:"permission",title:"\u5206\u914D\u6743\u9650",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},children:u==null?void 0:u.map(function(p){var l,d,E,B,Z;return(0,e.jsxs)("div",{children:[(0,e.jsx)(re.Z,{bordered:!1,children:(0,e.jsxs)(ca,{header:p.name,children:[p.menus.length>0&&(0,e.jsx)(H.Z.Group,{name:"menu_".concat(p.id),label:"\u83DC\u5355\u6743\u9650",layout:"vertical",options:(l=p.menus)===null||l===void 0?void 0:l.map(function(m){return{label:m.name,value:m.id,onChange:g}})}),p.buttons.length>0&&(0,e.jsx)(H.Z.Group,{name:"button_".concat(p.id),label:"\u6309\u94AE\u6743\u9650",layout:"vertical",options:(d=p.buttons)===null||d===void 0?void 0:d.map(function(m){return{label:m.name,value:m.id,onChange:g}})}),p.apis.length>0&&(0,e.jsx)(H.Z.Group,{name:"api_".concat(p.id),layout:"vertical",label:"\u63A5\u53E3\u6743\u9650",options:(E=p.apis)===null||E===void 0?void 0:E.map(function(m){return{label:m.name,value:m.id,onChange:g}})}),p.datas.length>0&&(0,e.jsx)(H.Z.Group,{name:"data_".concat(p.id),layout:"vertical",label:"\u6570\u636E\u6743\u9650",options:(B=p.apis)===null||B===void 0?void 0:B.map(function(m){return{label:m.name,value:m.id,onChange:g}})}),p.others.length>0&&(0,e.jsx)(H.Z.Group,{name:"other_".concat(p.id),layout:"vertical",label:"\u5176\u4ED6\u6743\u9650",options:(Z=p.apis)===null||Z===void 0?void 0:Z.map(function(m){return{label:m.name,value:m.id,onChange:g}})})]},p.id)},p.id),(0,e.jsx)("br",{})]},p.id)})})]},"create")},pa=da,ma=re.Z.Panel,fa=function(t){var s=t.open,C=t.onCancel,y=t.onFinish,b=t.id,h=(0,R.useState)(!1),k=$()(h,2),i=k[0],u=k[1],o=(0,R.useState)(),D=$()(o,2),x=D[0],F=D[1],w=(0,R.useRef)(),I=(0,R.useRef)([]),v=(0,R.useState)(0),n=$()(v,2),A=n[0],a=n[1],S=(0,R.useState)([]),c=$()(S,2),f=c[0],g=c[1];(0,X.Z)(L()(r()().mark(function l(){var d,E,B,Z;return r()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!(s&&b)){T.next=14;break}return u(!0),F([]),T.next=5,(0,M.Yq)(b);case 5:if(d=T.sent,E=d.success,B=d.result,!(E&&B)){T.next=12;break}return I==null||(Z=I.current)===null||Z===void 0||Z.forEach(function(Q){var O;(O=Q.current)===null||O===void 0||O.setFieldsValue(N()({},B))}),u(!1),T.abrupt("return");case 12:C(),K.ZP.warning("\u672A\u83B7\u53D6\u5230\u8BE5".concat(b,"\u89D2\u8272\u6570\u636E\uFF01")).then();case 14:case"end":return T.stop()}},l)})),[b,C,s]);var p=function(d){if(d.target.checked){g([].concat(te()(f),[d.target.value]));return}g(f==null?void 0:f.filter(function(E){return E!==d.target.value}))};return(0,e.jsxs)(ce.L,{onFinish:function(){var l=L()(r()().mark(function d(E){var B;return r()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return u(!0),console.log("permissions",f),m.next=4,y==null?void 0:y(E);case 4:return B=m.sent,u(!1),a(0),m.abrupt("return",B);case 8:case"end":return m.stop()}},d)}));return function(d){return l.apply(this,arguments)}}(),current:A,onCurrentChange:a,formProps:{validateMessages:{required:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}},formMapRef:I,stepsFormRender:function(d,E){return(0,e.jsx)(Ne.Z,{title:"\u4FEE\u6539\u89D2\u8272",width:600,onClose:function(){a(0),C()},open:s,footer:(0,e.jsx)(he.Z,{style:{float:"right"},children:E}),destroyOnClose:!0,children:(0,e.jsxs)(se.Z,{spinning:i,children:[" ",d]})})},children:[(0,e.jsxs)(ce.L.StepForm,{scrollToFirstError:!0,name:"basic",title:"\u57FA\u672C\u4FE1\u606F",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},labelAlign:"right",formRef:w,children:[(0,e.jsx)(U.Z,{name:"id",hidden:!0}),(0,e.jsx)(U.Z,{name:"appId",hidden:!0}),(0,e.jsx)(U.Z,{name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"},{validator:function(){var l=L()(r()().mark(function E(B,Z){var m,T,Q,O;return r()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(Z){V.next=2;break}return V.abrupt("return",Promise.resolve());case 2:return u(!0),V.next=5,(0,M.ld)((m=w.current)===null||m===void 0?void 0:m.getFieldValue("appId"),"NAME",Z,b);case 5:if(T=V.sent,Q=T.success,O=T.result,u(!1),Q){V.next=11;break}return V.abrupt("return",Promise.reject());case 11:if(O){V.next=13;break}return V.abrupt("return",Promise.reject(new Error("\u624B\u673A\u53F7\u5DF2\u5B58\u5728")));case 13:case"end":return V.stop()}},E)}));function d(E,B){return l.apply(this,arguments)}return d}(),validateTrigger:["onBlur"]}],placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"}),(0,e.jsx)(U.Z,{name:"code",label:"\u6807\u8BC6",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u6807\u8BC6",readonly:!0,proFieldProps:{render:function(d){return d&&(0,e.jsx)(ir.Z,{copyable:{text:d},style:{marginBottom:"0"},children:(0,e.jsx)("span",{dangerouslySetInnerHTML:{__html:"<span>".concat(d,"</span>")}})})}},extra:"\u89D2\u8272\u7F16\u7801\u5728\u5F53\u524D\u5E94\u7528\u4E2D\u7684\u552F\u4E00\u6807\u8BC6\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u4EC5\u652F\u6301\u82F1\u6587\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\uFF0C\u521B\u5EFA\u540E\u4E0D\u53EF\u4FEE\u6539\u3002"}),(0,e.jsx)(be.Z,{name:"remark",fieldProps:{rows:2},label:"\u63CF\u8FF0",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"})]}),(0,e.jsx)(ce.L.StepForm,{scrollToFirstError:!0,name:"permission",title:"\u5206\u914D\u6743\u9650",layout:"horizontal",labelCol:{span:4},wrapperCol:{span:19},children:x==null?void 0:x.map(function(l){var d,E,B,Z,m;return(0,e.jsxs)("div",{children:[(0,e.jsx)(re.Z,{bordered:!1,children:(0,e.jsxs)(ma,{header:l.name,children:[l.menus.length>0&&(0,e.jsx)(H.Z.Group,{name:"menu_".concat(l.id),label:"\u83DC\u5355\u6743\u9650",layout:"vertical",options:(d=l.menus)===null||d===void 0?void 0:d.map(function(T){return{label:T.name,value:T.id,onChange:p}})}),l.buttons.length>0&&(0,e.jsx)(H.Z.Group,{name:"button_".concat(l.id),label:"\u6309\u94AE\u6743\u9650",layout:"vertical",options:(E=l.buttons)===null||E===void 0?void 0:E.map(function(T){return{label:T.name,value:T.id,onChange:p}})}),l.apis.length>0&&(0,e.jsx)(H.Z.Group,{name:"api_".concat(l.id),layout:"vertical",label:"\u63A5\u53E3\u6743\u9650",options:(B=l.apis)===null||B===void 0?void 0:B.map(function(T){return{label:T.name,value:T.id,onChange:p}})}),l.datas.length>0&&(0,e.jsx)(H.Z.Group,{name:"data_".concat(l.id),layout:"vertical",label:"\u6570\u636E\u6743\u9650",options:(Z=l.apis)===null||Z===void 0?void 0:Z.map(function(T){return{label:T.name,value:T.id,onChange:p}})}),l.others.length>0&&(0,e.jsx)(H.Z.Group,{name:"other_".concat(l.id),layout:"vertical",label:"\u5176\u4ED6\u6743\u9650",options:(m=l.apis)===null||m===void 0?void 0:m.map(function(T){return{label:T.name,value:T.id,onChange:p}})})]},l.id)},l.id),(0,e.jsx)("br",{})]},l.id)})})]},"update")},ha=fa,va=ur.Z.confirm,ga=function(P){var t=(0,R.useRef)(),s=P.appId,C=(0,R.useState)(!1),y=$()(C,2),b=y[0],h=y[1],k=(0,R.useState)(!1),i=$()(k,2),u=i[0],o=i[1],D=(0,R.useState)(),x=$()(D,2),F=x[0],w=x[1],I=[{title:"\u89D2\u8272\u540D\u79F0",dataIndex:"name",ellipsis:!0,fixed:"left"},{title:"\u89D2\u8272\u7F16\u7801",dataIndex:"code",copyable:!0,search:!1},{title:"\u72B6\u6001",dataIndex:"enabled",search:!1,align:"center",render:function(n,A){return(0,e.jsx)(lr.Z,{checked:n,onChange:function(){var a=L()(r()().mark(function S(c){var f,g,p;return r()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!c){d.next=9;break}return d.next=3,(0,M.Ko)(A.id);case 3:if(f=d.sent,g=f.success,!g){d.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(p=t.current)===null||p===void 0||p.reload(),d.abrupt("return");case 9:va({title:"\u8B66\u544A",icon:(0,e.jsx)(sr.Z,{}),content:"\u786E\u5B9A\u7981\u7528\u6B64\u89D2\u8272\uFF1F",okText:"\u786E\u5B9A",okType:"danger",cancelText:"\u53D6\u6D88",centered:!0,onOk:function(){var E=L()(r()().mark(function Z(){var m,T,Q;return r()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,(0,M.RN)(A.id);case 2:if(m=G.sent,T=m.success,!T){G.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(Q=t.current)===null||Q===void 0||Q.reload(),G.abrupt("return");case 8:case"end":return G.stop()}},Z)}));function B(){return E.apply(this,arguments)}return B}(),onCancel:function(){}});case 10:case"end":return d.stop()}},S)}));return function(S){return a.apply(this,arguments)}}()})}},{title:"\u89D2\u8272\u63CF\u8FF0",ellipsis:!0,dataIndex:"remark",search:!1,copyable:!1},{title:"\u64CD\u4F5C",align:"center",valueType:"option",width:180,fixed:"right",render:function(n,A){return[(0,e.jsx)("a",{target:"_blank",onClick:function(){o(!0),w(A.id)},children:"\u4FEE\u6539"},"update"),(0,e.jsx)(Ee.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(xe.Z,{style:{color:"red"}}),onConfirm:L()(r()().mark(function a(){var S,c,f;return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,M.AO)(A.id);case 2:if(S=p.sent,c=S.success,!c){p.next=8;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(f=t.current)===null||f===void 0||f.reload(),p.abrupt("return");case 8:case"end":return p.stop()}},a)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u5220\u9664"},"remove")},"delete")]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Pe.Z,{columns:I,pagination:{showQuickJumper:!0,defaultPageSize:10},rowSelection:{selections:[Ae.Z.SELECTION_ALL,Ae.Z.SELECTION_INVERT]},style:{height:"calc(100vh - 190px)",overflow:"auto"},cardProps:{style:{minHeight:"100%"}},scroll:{x:700},options:!1,tableAlertRender:function(n){var A=n.selectedRowKeys,a=n.onCleanSelected;return(0,e.jsx)(he.Z,{size:24,children:(0,e.jsxs)("span",{children:["\u5DF2\u9009 ",A.length," \u9879",(0,e.jsx)("a",{style:{marginLeft:8},onClick:a,children:"\u53D6\u6D88\u9009\u62E9"})]})})},tableAlertOptionRender:function(n){return(0,e.jsx)(he.Z,{size:16,children:(0,e.jsx)(Ee.Z,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",placement:"bottomRight",icon:(0,e.jsx)(xe.Z,{style:{color:"red"}}),onConfirm:L()(r()().mark(function A(){var a,S,c;return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,M.O0)(n.selectedRowKeys);case 2:if(a=g.sent,S=a.success,!S){g.next=9;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),n.onCleanSelected(),(c=t.current)===null||c===void 0||c.reload(),g.abrupt("return");case 9:case"end":return g.stop()}},A)})),okText:"\u662F",cancelText:"\u5426",children:(0,e.jsx)("a",{target:"_blank",style:{color:"red"},children:"\u6279\u91CF\u5220\u9664"},"remove")},"delete")})},actionRef:t,params:{appId:s},request:M.TT,rowKey:"id",dateFormatter:"string",toolbar:{search:!1,actions:[(0,e.jsx)(Fe.ZP,{type:"primary",icon:(0,e.jsx)(ye.Z,{}),onClick:function(){h(!0)},children:"\u65B0\u589E\u89D2\u8272"},"create")]}}),(0,e.jsx)(pa,{appId:s,open:b,onCancel:function(){h(!1)},onFinish:function(){var v=L()(r()().mark(function n(A){var a,S,c,f;return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,M.pW)(A);case 2:if(a=p.sent,S=a.success,c=a.result,!(S&&c)){p.next=10;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),(f=t.current)===null||f===void 0||f.reload(),h(!1),p.abrupt("return");case 10:case"end":return p.stop()}},n)}));return function(n){return v.apply(this,arguments)}}()}),(0,e.jsx)(ha,{id:F,open:u,onCancel:function(){o(!1)},onFinish:function(){var v=L()(r()().mark(function n(A){var a,S,c,f;return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,M.UC)(A);case 2:a=p.sent,S=a.success,c=a.result,S&&c&&((f=t.current)===null||f===void 0||f.reload(),o(!1),K.ZP.success("\u64CD\u4F5C\u6210\u529F"));case 6:case"end":return p.stop()}},n)}));return function(n){return v.apply(this,arguments)}}()})]})},Ie=j(58397),ae=j(27181),Me=j(60979),ne=j(76815),Aa=re.Z.Panel,Fa=function(P){var t=J.Z.useForm(),s=$()(t,1),C=s[0],y=P.protocolEndpoint,b=P.appId,h=P.collapsed,k=h===void 0?!0:h;return(0,X.Z)(L()(r()().mark(function i(){return r()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:C.setFieldsValue(y);case 1:case"end":return o.stop()}},i)})),[b,y]),(0,e.jsx)(ue.A,{layout:"horizontal",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}},labelAlign:"right",labelWrap:!0,submitter:!1,form:C,children:(0,e.jsx)(re.Z,{ghost:!0,expandIconPosition:"start",defaultActiveKey:k?void 0:"config",children:(0,e.jsx)(Aa,{header:(0,e.jsx)("a",{children:"\u5E94\u7528\u914D\u7F6E\u4FE1\u606F"}),children:(0,e.jsx)(le.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},description:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(U.Z,{label:"CAS \u670D\u52A1\u5730\u5740\u524D\u7F00",name:"casServerUrlPrefix",readonly:!0,proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"IdP SSO \u5730\u5740",name:"casSsoEndpoint",extra:"\u5E94\u7528\u53D1\u8D77\u5355\u70B9\u767B\u5F55\u7684\u5730\u5740\u3002",readonly:!0,proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"\u767B\u51FA\u7AEF\u70B9",name:"casSloEndpoint",extra:"\u5E94\u7528\u53D1\u8D77\u5355\u70B9\u767B\u51FA\u7684\u5730\u5740\u3002",readonly:!0,proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"service ticket \u68C0\u9A8C\u7AEF\u70B9\uFF08CAS 1.0\uFF09",name:"casValidateEndpoint",readonly:!0,proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"service ticket \u68C0\u9A8C\u7AEF\u70B9\uFF08CAS 2.0\uFF09",name:"casValidateV2Endpoint",readonly:!0,proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"service ticket \u68C0\u9A8C\u7AEF\u70B9\uFF08CAS 3.0\uFF09",name:"casValidateV3Endpoint",readonly:!0,proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},fieldProps:{autoComplete:"off"}})]})})},"config")})})},Ca={labelCol:{xs:{span:24},sm:{span:7},md:{span:6}},wrapperCol:{xs:{span:24},sm:{span:13},md:{span:14}}},xa=function(P){var t=P.app,s=t.id,C=t.template,y=J.Z.useForm(),b=$()(y,1),h=b[0],k=(0,R.useState)(!0),i=$()(k,2),u=i[0],o=i[1],D=(0,R.useState)({}),x=$()(D,2),F=x[0],w=x[1],I=function(){var v=L()(r()().mark(function n(){var A,a,S;return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return o(!0),f.next=3,(0,M.hq)(s);case 3:A=f.sent,a=A.result,S=A.success,S&&a&&(h.setFieldsValue(N()(N()({},(0,ie.omit)(a,"protocolEndpoint")),{},{appId:s})),w(a.protocolEndpoint)),o(!1);case 8:case"end":return f.stop()}},n)}));return function(){return v.apply(this,arguments)}}();return(0,X.Z)(L()(r()().mark(function v(){return r()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,I();case 2:case"end":return A.stop()}},v)})),[]),(0,e.jsxs)(se.Z,{spinning:u,children:[(0,e.jsxs)(ue.A,N()(N()({layout:"horizontal"},Ca),{},{form:h,scrollToFirstError:!0,onFinish:function(){var v=L()(r()().mark(function n(A){var a,S;return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return o(!0),f.next=3,(0,M.$c)({id:s,template:C,config:(0,ie.omit)(A,"id","template")}).finally(function(){o(!1)});case 3:if(a=f.sent,S=a.success,!S){f.next=10;break}return K.ZP.success("\u4FDD\u5B58\u6210\u529F"),f.next=9,I();case 9:return f.abrupt("return",!0);case 10:return K.ZP.error("\u4FDD\u5B58\u5931\u8D25"),f.abrupt("return",!1);case 12:case"end":return f.stop()}},n)}));return function(n){return v.apply(this,arguments)}}(),submitter:{render:function(n,A){return(0,e.jsx)(Ie.S,{children:A})}},children:[(0,e.jsx)(U.Z,{label:"CAS \u5BA2\u6237\u7AEF\u7684\u5730\u5740",name:"clientServiceUrl",fieldProps:{allowClear:!1},extra:"\u5355\u70B9\u767B\u5F55\u65F6\uFF0C\u5C06\u9009\u4E2D\u9879\u4F5C\u4E3A CAS \u7528\u6237\u6807\u8BC6\uFF0C\u4F20\u9012\u7ED9\u4E1A\u52A1\u7CFB\u7EDF\u3002",rules:[{required:!0,message:"\u8BF7\u8F93\u5165 CAS \u5BA2\u6237\u7AEF\u7684\u5730\u5740"},{type:"url",message:"CAS \u5BA2\u6237\u7AEF\u5730\u5740\u683C\u5F0F\u4E0D\u6B63\u786E"}]}),(0,e.jsx)(ae.Z,{label:"CAS \u7528\u6237\u6807\u8BC6",name:"userIdentityType",options:[{value:"user.username",label:"\u7528\u6237\u540D"},{value:"user.fullName",label:"\u7528\u6237\u59D3\u540D"},{value:"user.nickName",label:"\u7528\u6237\u6635\u79F0"},{value:"user.email",label:"\u90AE\u7BB1\u5730\u5740"},{value:"app_user.username",label:"\u5E94\u7528\u8D26\u6237"}],fieldProps:{allowClear:!1},extra:"\u5355\u70B9\u767B\u5F55\u65F6\uFF0C\u5C06\u9009\u4E2D\u9879\u4F5C\u4E3A CAS \u7528\u6237\u6807\u8BC6\uFF0C\u4F20\u9012\u7ED9\u4E1A\u52A1\u7CFB\u7EDF\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9 CAS \u7528\u6237\u6807\u8BC6"}]}),(0,e.jsx)(Me.Z,{name:"serviceTicketExpireTime",label:"ST \u8FC7\u671F\u65F6\u95F4",addonAfter:"\u79D2",extra:"ServiceTicket \u8FC7\u671F\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u914D\u7F6E ServiceTicket \u8FC7\u671F\u65F6\u95F4"}]}),(0,e.jsx)(W.Z,{}),(0,e.jsx)(ae.Z,{label:"\u6388\u6743\u8303\u56F4",name:"authorizationType",allowClear:!1,extra:"\u82E5\u9009\u62E9\u624B\u52A8\u6388\u6743\uFF0C\u9700\u8981\u5728 \u8BBF\u95EE\u6388\u6743 \u4E2D\u8FDB\u884C\u6743\u9650\u5206\u914D\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u8303\u56F4"}],options:[{value:oe.AUTHORIZATION,label:"\u624B\u52A8\u6388\u6743"},{value:oe.ALL_ACCESS,label:"\u5168\u5458\u53EF\u8BBF\u95EE"}]}),(0,e.jsx)(ae.Z,{label:"SSO \u53D1\u8D77\u65B9",name:"initLoginType",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u914D\u7F6E SSO \u53D1\u8D77\u65B9"}],options:[{value:pe.APP,label:"\u53EA\u5141\u8BB8\u5E94\u7528\u53D1\u8D77"},{value:pe.PORTAL_OR_APP,label:"\u652F\u6301\u95E8\u6237\u548C\u5E94\u7528\u53D1\u8D77"}],extra:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:"\u95E8\u6237\u53D1\u8D77\uFF1A\u7531 IAM \u95E8\u6237\u9875\u70B9\u51FB\u8FDB\u884C SSO \u3002"}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:"\u5E94\u7528\u53D1\u8D77\uFF1A\u7531\u5E94\u7528\u767B\u5F55\u4E3B\u52A8\u53D1\u8D77\u3002"})]})}),(0,e.jsx)(me.Z,{name:["initLoginType"],children:function(){return(0,e.jsx)(U.Z,{label:"\u767B\u5F55\u53D1\u8D77\u5730\u5740",name:"initLoginUrl",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u94FE\u63A5"},extra:"\u82E5\u5E94\u7528\u4EC5\u652F\u6301 SP \u53D1\u8D77 SSO\uFF0C\u60A8\u53C8\u5E0C\u671B\u5B9E\u73B0\u7531 IAM \u95E8\u6237\u9875\u53D1\u8D77\u767B\u5F55\uFF0C\u8BF7\u586B\u5199\u6B64\u9879\u3002\u95E8\u6237\u9875\u8BBF\u95EE\u5E94\u7528\u65F6\uFF0CIAM \u4F1A\u8DF3\u8F6C\u5230\u672C\u5730\u5740\uFF0C\u5E94\u5373\u523B\u81EA\u52A8\u5411 IAM \u53D1\u8D77 SAMLRequest \u767B\u5F55\u8BF7\u6C42\u3002\u5730\u5740\u53EF\u586B\u5199\u4E3A\u4EFB\u610F\u53D7\u4FDD\u62A4\u8D44\u6E90\u8BBF\u95EE\u5730\u5740\uFF0C\u5728\u672A\u767B\u5F55\u65F6\u4F1A\u81EA\u52A8\u89E6\u53D1 SAMLRequest \u5373\u53EF\u3002"})}})]})),(0,e.jsx)(W.Z,{style:{margin:0}}),(0,e.jsx)(Fa,{appId:t.id,protocolEndpoint:F,collapsed:!0})]})},Ea=xa,Sa=re.Z.Panel,ja=function(P){var t=J.Z.useForm(),s=$()(t,1),C=s[0],y=P.protocolEndpoint,b=P.appId,h=P.collapsed,k=h===void 0?!0:h;return(0,X.Z)(L()(r()().mark(function i(){return r()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:C.setFieldsValue(y);case 1:case"end":return o.stop()}},i)})),[b,y]),(0,e.jsx)(ue.A,{layout:"horizontal",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}},labelAlign:"right",submitter:!1,labelWrap:!0,form:C,children:(0,e.jsx)(re.Z,{ghost:!0,expandIconPosition:"start",defaultActiveKey:k?void 0:"config",children:(0,e.jsx)(Sa,{header:(0,e.jsx)("a",{children:"\u5E94\u7528\u914D\u7F6E\u4FE1\u606F"}),children:(0,e.jsx)(le.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},description:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(U.Z,{label:"IdP SSO \u5730\u5740",name:"idpSsoEndpoint",extra:"\u5E94\u7528\u53D1\u8D77\u5355\u70B9\u767B\u5F55\u7684\u5730\u5740\u3002",readonly:!0,proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},fieldProps:{autoComplete:"off"}})})})},"config")})})},ya={labelCol:{span:6},wrapperCol:{span:12}},ba=function(P){var t=P.app,s=t.id,C=t.template,y=J.Z.useForm(),b=$()(y,1),h=b[0],k=(0,R.useState)(!0),i=$()(k,2),u=i[0],o=i[1],D=J.Z.useForm(),x=$()(D,1),F=x[0],w=(0,R.useState)(function(){return[]}),I=$()(w,2),v=I[0],n=I[1],A=(0,R.useState)({}),a=$()(A,2),S=a[0],c=a[1],f=function(){var g=L()(r()().mark(function p(){var l,d,E;return r()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return o(!0),Z.next=3,(0,M.hq)(s);case 3:l=Z.sent,d=l.result,E=l.success,E&&d&&(h.setFieldsValue(N()(N()({},(0,ie.omit)(d,"protocolEndpoint")),{},{appId:s})),c(d.protocolEndpoint)),o(!1);case 8:case"end":return Z.stop()}},p)}));return function(){return g.apply(this,arguments)}}();return(0,X.Z)(L()(r()().mark(function g(){return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,f();case 2:case"end":return l.stop()}},g)})),[]),(0,e.jsxs)(se.Z,{spinning:u,children:[(0,e.jsx)(le.Z,{showIcon:!0,message:(0,e.jsxs)("span",{children:["\u4E0D\u77E5\u9053\u600E\u4E48\u914D\u7F6E\uFF1F\u8BF7\u53C2\u8003 TopIAM \u914D\u7F6E"," ",(0,e.jsx)("a",{target:"_blank",href:"https://eiam.topiam.cn/docs/application/standard/form-sso",rel:"noreferrer",children:"\u8868\u5355\u4EE3\u586B\u5355\u70B9\u767B\u5F55"})," ","\u3002"]})}),(0,e.jsx)("br",{}),(0,e.jsxs)(ue.A,N()(N()({form:h,requiredMark:!0,layout:"horizontal"},ya),{},{scrollToFirstError:!0,onFinish:function(){var g=L()(r()().mark(function p(l){var d,E,B;return r()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,F.validateFields();case 2:if(d=m.sent,o(!0),!d){m.next=15;break}return m.next=7,(0,M.$c)({id:s,template:C,config:(0,ie.omit)(l,"id","template")}).finally(function(){o(!1)});case 7:if(E=m.sent,B=E.success,!B){m.next=14;break}return K.ZP.success("\u4FDD\u5B58\u6210\u529F"),m.next=13,f();case 13:return m.abrupt("return",!0);case 14:K.ZP.error("\u4FDD\u5B58\u5931\u8D25");case 15:return m.abrupt("return",!1);case 16:case"end":return m.stop()}},p)}));return function(p){return g.apply(this,arguments)}}(),submitter:{render:function(p,l){return(0,e.jsx)(Ie.S,{children:l})}},children:[(0,e.jsx)(U.Z,{name:"appId",hidden:!0}),(0,e.jsx)(U.Z,{name:"loginUrl",label:"\u767B\u5F55\u63D0\u4EA4URL",placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u63D0\u4EA4URL",extra:"\u767B\u5F55\u8868\u5355\u63D0\u4EA4\u5B8C\u6574URL\uFF0C\u4EE5http://\u6216https://\u5F00\u5934\uFF0C\u5982\uFF1Ahttps://oa.xxxx.com/login",rules:[{required:!0,message:"\u5E94\u7528\u767B\u5F55URL\u4E3A\u5FC5\u586B\u9879"},{type:"url",message:"URL\u683C\u5F0F\u4E0D\u6B63\u786E"}]}),(0,e.jsx)(U.Z,{name:"usernameField",label:"\u767B\u5F55\u540D\u5C5E\u6027\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u540D\u5C5E\u6027\u540D\u79F0",extra:"username\u6807\u7B7E\u7684name\u5C5E\u6027",rules:[{required:!0,message:"\u767B\u5F55\u540D\u5C5E\u6027\u540D\u79F0\u4E3A\u5FC5\u586B\u9879"}]}),(0,e.jsx)(U.Z,{name:"passwordField",label:"\u767B\u5F55\u5BC6\u7801\u5C5E\u6027\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801\u5C5E\u6027\u540D\u79F0",extra:"password\u6807\u7B7E\u7684name\u5C5E\u6027",rules:[{required:!0,message:"\u767B\u5F55\u5BC6\u7801\u5C5E\u6027\u540D\u79F0\u4E3A\u5FC5\u586B\u9879"}]}),(0,e.jsx)(er.Z.Group,{name:"submitType",label:"\u767B\u5F55\u63D0\u4EA4\u65B9\u5F0F",initialValue:["post"],options:[{value:"post",label:"POST"},{value:"get",label:"GET"}],rules:[{required:!0,message:"\u767B\u5F55\u63D0\u4EA4\u65B9\u5F0F\u4E3A\u5FC5\u9009\u9879"}]}),(0,e.jsx)(W.Z,{}),(0,e.jsx)(ae.Z,{label:"\u6388\u6743\u8303\u56F4",name:"authorizationType",allowClear:!1,extra:"\u82E5\u9009\u62E9\u624B\u52A8\u6388\u6743\uFF0C\u9700\u8981\u5728 \u8BBF\u95EE\u6388\u6743 \u4E2D\u8FDB\u884C\u6743\u9650\u5206\u914D\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u8303\u56F4"}],options:[{value:oe.AUTHORIZATION,label:"\u624B\u52A8\u6388\u6743"},{value:oe.ALL_ACCESS,label:"\u5168\u5458\u53EF\u8BBF\u95EE"}]}),(0,e.jsx)(ae.Z,{label:"SSO \u53D1\u8D77\u65B9",name:"initLoginType",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u914D\u7F6E SSO \u53D1\u8D77\u65B9"}],options:[{value:pe.APP,label:"\u53EA\u5141\u8BB8\u5E94\u7528\u53D1\u8D77"},{value:pe.PORTAL_OR_APP,label:"\u652F\u6301\u95E8\u6237\u548C\u5E94\u7528\u53D1\u8D77"}],extra:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:"\u95E8\u6237\u53D1\u8D77\uFF1A\u7531 IAM \u95E8\u6237\u9875\u70B9\u51FB\u8FDB\u884C SSO \u3002"}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:"\u5E94\u7528\u53D1\u8D77\uFF1A\u7531\u5E94\u7528\u767B\u5F55\u4E3B\u52A8\u53D1\u8D77\u3002"})]})}),(0,e.jsx)(me.Z,{name:["initLoginType"],children:function(){return(0,e.jsx)(U.Z,{label:"\u767B\u5F55\u53D1\u8D77\u5730\u5740",name:"initLoginUrl",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u94FE\u63A5"},extra:"\u82E5\u5E94\u7528\u4EC5\u652F\u6301\u5E94\u7528\u53D1\u8D77 SSO\uFF0C\u60A8\u53C8\u5E0C\u671B\u5B9E\u73B0\u7531 IAM \u95E8\u6237\u9875\u53D1\u8D77\u767B\u5F55\uFF0C\u8BF7\u586B\u5199\u6B64\u9879\u3002\u95E8\u6237\u9875\u8BBF\u95EE\u5E94\u7528\u65F6\uFF0CIAM \u4F1A\u8DF3\u8F6C\u5230\u672C\u5730\u5740\uFF0C\u5E94\u5373\u523B\u81EA\u52A8\u5411 IAM \u53D1\u8D77 SSO \u767B\u5F55\u8BF7\u6C42\u3002\u5730\u5740\u53EF\u586B\u5199\u4E3A\u4EFB\u610F\u53D7\u4FDD\u62A4\u8D44\u6E90\u8BBF\u95EE\u5730\u5740\uFF0C\u5728\u672A\u767B\u5F55\u65F6\u4F1A\u81EA\u52A8\u89E6\u53D1 SSO \u5373\u53EF\u3002"})}}),(0,e.jsx)(W.Z,{}),(0,e.jsx)(ue.A.Item,{label:"\u767B\u5F55\u5176\u4ED6\u5B57\u6BB5",name:"otherField",trigger:"onValuesChange",children:(0,e.jsx)($e.Z,{rowKey:"key",toolBarRender:!1,scroll:{x:500},columns:[{title:"\u5C5E\u6027\u540D\u79F0",dataIndex:"fieldName",fieldProps:{allowClear:!1},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u5C5E\u6027\u503C",key:"fieldValue",dataIndex:"fieldValue",ellipsis:!0,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u64CD\u4F5C",valueType:"option",align:"center",fixed:"right",width:50}],recordCreatorProps:{creatorButtonText:"\u6DFB\u52A0\u5176\u4ED6\u5B57\u6BB5",newRecordType:"dataSource",position:"bottom",record:function(){return{key:Date.now()}}},editable:{form:F,type:"multiple",editableKeys:v,onChange:n,deletePopconfirmMessage:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u6B64\u5C5E\u6027\u5417\uFF1F",actionRender:function(p,l,d){return[d.delete]}}})})]})),(0,e.jsx)(W.Z,{style:{margin:0}}),(0,e.jsx)(ja,{appId:s,protocolEndpoint:S,collapsed:!0})]})},Za=ba,Pa=function(P){var t=P.app,s=t.id,C=t.initLoginType,y=t.authorizationType,b=J.Z.useForm(),h=$()(b,1),k=h[0],i=(0,R.useState)(!0),u=$()(i,2),o=u[0],D=u[1];return(0,X.Z)(L()(r()().mark(function x(){var F,w,I;return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return D(!0),n.next=3,(0,M.hq)(s);case 3:F=n.sent,w=F.result,I=F.success,I&&w&&k.setFieldsValue({initLoginType:C,authorizationType:y}),D(!1);case 8:case"end":return n.stop()}},x)})),[]),(0,e.jsx)(se.Z,{spinning:o,children:(0,e.jsx)(le.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},message:"\u6682\u672A\u5B9E\u73B0"})})},Ia=Pa,wa=j(10255),Ra=j.n(wa),Ze=j(66767),Ba=j(78035),or=j(10773),Ta=re.Z.Panel,Da=function(P){var t=J.Z.useForm(),s=$()(t,1),C=s[0],y=P.protocolEndpoint,b=P.appId,h=P.collapsed,k=h===void 0?!0:h;return(0,X.Z)(L()(r()().mark(function i(){return r()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:C.setFieldsValue(y);case 1:case"end":return o.stop()}},i)})),[b,y]),(0,e.jsx)(ue.A,{layout:"horizontal",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}},labelAlign:"right",submitter:!1,labelWrap:!0,form:C,children:(0,e.jsx)(re.Z,{ghost:!0,expandIconPosition:"start",defaultActiveKey:k?void 0:"config",children:(0,e.jsx)(Ta,{header:(0,e.jsx)("a",{children:"\u5E94\u7528\u914D\u7F6E\u4FE1\u606F"}),children:(0,e.jsx)(le.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},description:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(U.Z,{label:"Issuer",name:"issuer",extra:"\u7528\u4E8E\u6807\u8BC6 token \u53D1\u653E\u6765\u6E90\u7684\u5B57\u6BB5\u3002\u540C\u65F6\u662F\u4E0B\u8FF0\u63A5\u53E3\u7684 baseUrl\u3002",proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"\u53D1\u73B0\u7AEF\u70B9",name:"discoveryEndpoint",extra:"\u7528\u4E8E\u83B7\u53D6\u5F53\u524D IAM \u652F\u6301\u7684\u5404\u7AEF\u70B9\u4FE1\u606F\u548C\u652F\u6301\u7684\u6A21\u5F0F\u3001\u53C2\u6570\u4FE1\u606F\uFF0C\u53EF\u516C\u5F00\u8BBF\u95EE\u3002",proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"\u6388\u6743\u7AEF\u70B9",name:"authorizationEndpoint",extra:"\u5E94\u7528\u53D1\u8D77\u5355\u70B9\u767B\u5F55\u7684\u5730\u5740\u3002",proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"\u4EE4\u724C\u7AEF\u70B9",name:"tokenEndpoint",extra:"\u5E94\u7528\u5728\u5355\u70B9\u767B\u5F55\u8FC7\u7A0B\u4E2D\uFF0C\u62FF\u5230 code \u540E\uFF0C\u4ECE\u540E\u7AEF\u53D1\u53BB\u6362\u53D6 token \u7684\u63A5\u53E3\u5730\u5740\u3002",proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"\u4EE4\u724C\u540A\u9500\u7AEF\u70B9",name:"revokeEndpoint",proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"\u9A8C\u7B7E\u516C\u94A5\u7AEF\u70B9",name:"jwksEndpoint",extra:"\u7528\u4E8E\u9A8C\u8BC1 id_token\u3001\u5B8C\u6210 SSO \u6D41\u7A0B\u7684\u516C\u94A5\u7AEF\u70B9\u3002\u516C\u94A5\u53EF\u80FD\u4F1A\u8F6E\u8F6C\u3002",proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"\u7528\u6237\u4FE1\u606F\u7AEF\u70B9",name:"userinfoEndpoint",extra:"\u5728\u8D26\u6237\u767B\u5F55\u540E\uFF0C\u4F7F\u7528 access_token \u8C03\u7528\u7528\u6237\u4FE1\u606F\u7AEF\u70B9\uFF0C\u83B7\u53D6\u8D26\u6237\u57FA\u672C\u4FE1\u606F\u3002",proFieldProps:{render:function(u){return u&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:u})}},readonly:!0,fieldProps:{autoComplete:"off"}})]})})},"config")})})},ka=j(75827),Oa=re.Z.Panel,cr={labelCol:{span:6},wrapperCol:{span:12}},dr={wrapperCol:{span:12,offset:6}},La=function(P){var t=P.app,s=t.id,C=t.template,y=J.Z.useForm(),b=$()(y,1),h=b[0],k=(0,R.useState)({}),i=$()(k,2),u=i[0],o=i[1],D=(0,R.useState)(!0),x=$()(D,2),F=x[0],w=x[1];return(0,Ba.Z)(L()(r()().mark(function I(){var v,n,A,a;return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return w(!0),c.next=3,(0,M.hq)(s);case 3:v=c.sent,n=v.result,A=v.success,A&&n&&(h.setFieldsValue(N()(N()({appId:s},n),{},{redirectUris:((a=n.redirectUris)===null||a===void 0?void 0:a.length)>0?n.redirectUris:[void 0]})),o(n.protocolEndpoint)),w(!1);case 8:case"end":return c.stop()}},I)}))),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(se.Z,{spinning:F,children:[(0,e.jsx)(le.Z,{showIcon:!0,message:(0,e.jsxs)("span",{children:["\u4E0D\u77E5\u9053\u600E\u4E48\u914D\u7F6E\uFF1F\u8BF7\u53C2\u8003 TopIAM \u914D\u7F6E"," ",(0,e.jsx)("a",{target:"_blank",href:"https://eiam.topiam.cn/docs/application/standard/oidc-sso",rel:"noreferrer",children:"OIDC \u5355\u70B9\u767B\u5F55"})," ","\u3002"]})}),(0,e.jsx)("br",{}),(0,e.jsxs)(ue.A,N()(N()({requiredMark:!0,layout:"horizontal"},cr),{},{form:h,scrollToFirstError:!0,onFinish:function(){var I=L()(r()().mark(function v(n){var A,a;return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,M.$c)({id:s,template:C,config:(0,ie.omit)(n,"id","template")});case 2:if(A=c.sent,a=A.success,!a){c.next=7;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),c.abrupt("return",!0);case 7:return K.ZP.error("\u64CD\u4F5C\u5931\u8D25"),c.abrupt("return",!1);case 9:case"end":return c.stop()}},v)}));return function(v){return I.apply(this,arguments)}}(),submitter:{render:function(v,n){return(0,e.jsx)(Ie.S,{children:n})}},children:[(0,e.jsx)(U.Z,{name:"appId",hidden:!0}),(0,e.jsx)(H.Z.Group,{label:"\u6388\u6743\u6A21\u5F0F",layout:"vertical",name:"authGrantTypes",rules:[{required:!0,message:"\u8BF7\u52FE\u9009\u6388\u6743\u6A21\u5F0F"}],options:[{value:"authorization_code",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"\u6388\u6743\u7801\u6A21\u5F0F"}),(0,e.jsx)("span",{style:{color:"#999"},children:"authorization_code \u6A21\u5F0F\uFF0C\u7528\u4E8E\u8D26\u6237\u7684\u767B\u5F55\u8BA4\u8BC1\u3001\u6388\u6743\u3002"})]})},{value:"refresh_token",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"\u4EE4\u724C\u5237\u65B0\u6A21\u5F0F"}),(0,e.jsx)("span",{style:{color:"#999"},children:"refresh_token \u6A21\u5F0F\uFF0C\u7528\u4E8E\u65E2\u6709 token \u7684\u5EF6\u671F\u3002"})]})},{value:"implicit",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"\u9690\u5F0F\u6A21\u5F0F"}),(0,e.jsx)("span",{style:{color:"#999"},children:"implicit \u6A21\u5F0F\uFF0C\u7531\u4E8E\u534F\u8BAE\u672C\u8EAB\u7684\u5B89\u5168\u6027\uFF0C\u901A\u5E38\u4E0D\u63A8\u8350\u4F7F\u7528\u3002\u5982\u679C\u6709\u7279\u6B8A\u9700\u6C42\uFF0C\u53EF\u4EE5\u4F7F\u7528\u53D8\u4F53\u7684 PKCE \u7684\u6388\u6743\u7801\u6A21\u5F0F\u3002"})]})},{value:"password",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"\u5BC6\u7801\u6A21\u5F0F"}),(0,e.jsx)("span",{style:{color:"#999"},children:"password \u6A21\u5F0F\uFF0C\u7531\u4E8E\u534F\u8BAE\u672C\u8EAB\u7684\u5B89\u5168\u6027\uFF0C\u901A\u5E38\u4E0D\u63A8\u8350\u4F7F\u7528\u3002"})]})},{value:"device",disabled:!0,label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"\u8BBE\u5907\u6A21\u5F0F"}),(0,e.jsx)("span",{style:{color:"#999"},children:"device \u6A21\u5F0F\uFF0C\u517C\u5BB9\u8BBE\u5907\u53D1\u8D77\u7684\u767B\u5F55\u6D41\u7A0B\u3002\uFF08\u6682\u4E0D\u652F\u6301\uFF09"})]})}]}),(0,e.jsx)(me.Z,{name:["authGrantTypes"],children:function(v){var n=v.authGrantTypes;return(n==null?void 0:n.includes("authorization_code"))&&(0,e.jsx)(Ze.Z,{label:"PKCE\uFF08\u7528\u4E8E\u6388\u6743\u7801\u6A21\u5F0F\uFF09",name:"requireProofKey",extra:"PKCE \uFF08Proof Key for Code Exchange\uFF09\u662F OAuth 2.0 \u7684\u5B89\u5168\u6027\u6269\u5C55\u6A21\u5F0F\uFF0C\u7528\u4E8E\u9632\u62A4 CSRF\u3001\u4E2D\u95F4\u4EBA\u8FDB\u653B\u7B49\u6076\u610F\u653B\u51FB\u3002"})}}),(0,e.jsx)(J.Z.List,{name:"redirectUris",rules:[{validator:function(){var I=L()(r()().mark(function n(A,a){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(a&&a.length>0)){c.next=2;break}return c.abrupt("return");case 2:throw new Error("\u8BF7\u914D\u7F6E\u767B\u5F55 Redirect URI");case 3:case"end":return c.stop()}},n)}));function v(n,A){return I.apply(this,arguments)}return v}()}],children:function(v,n,A){var a=n.add,S=n.remove;return Ra()(A),(0,e.jsxs)(e.Fragment,{children:[v.map(function(c,f){return(0,R.createElement)(J.Z.Item,N()(N()({},f===0?cr:dr),{},{required:!1,key:c.key,label:f===0?"\u767B\u5F55 Redirect URI":"",extra:f===v.length-1&&"Redirect URI \u767D\u540D\u5355\uFF0C\u5E94\u7528\u5728\u8BF7\u6C42\u767B\u5F55\u65F6\u643A\u5E26 redirect_uri \u53C2\u6570\uFF0C\u8BE5\u503C\u9700\u8981\u5728\u767D\u540D\u5355\u4E2D\uFF0CIAM \u624D\u4F1A\u5728\u8BA4\u8BC1\u5B8C\u6210\u540E\u53D1\u8D77\u8DF3\u8F6C\u3002\u82E5\u6709\u591A\u6761\uFF0C\u8BF7\u70B9\u51FB\u6DFB\u52A0\u8FDB\u884C\u6269\u5C55"}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,e.jsx)(J.Z.Item,N()(N()({},c),{},{validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"\u8BF7\u914D\u7F6E\u767B\u5F55 Redirect URI"},{type:"url",message:"Redirect URI \u683C\u5F0F\u4E0D\u6B63\u786E"}],noStyle:!0,children:(0,e.jsx)(or.Z,{placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55 Redirect URI"})})),v.length>1?(0,e.jsx)(ka.Z,{onClick:function(){return S(c.name)}}):null]}))}),(0,e.jsx)(J.Z.Item,N()(N()({},dr),{},{children:(0,e.jsx)(Fe.ZP,{type:"dashed",onClick:function(){return a()},icon:(0,e.jsx)(ye.Z,{}),style:{width:"100%"},children:"\u6DFB\u52A0"})}))]})}}),(0,e.jsx)(ae.Z,{label:"\u6388\u6743\u8303\u56F4",name:"authorizationType",allowClear:!1,extra:"\u82E5\u9009\u62E9\u624B\u52A8\u6388\u6743\uFF0C\u9700\u8981\u5728 \u8BBF\u95EE\u6388\u6743 \u4E2D\u8FDB\u884C\u6743\u9650\u5206\u914D\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u8303\u56F4"}],options:[{value:oe.AUTHORIZATION,label:"\u624B\u52A8\u6388\u6743"},{value:oe.ALL_ACCESS,label:"\u5168\u5458\u53EF\u8BBF\u95EE"}]}),(0,e.jsx)(ae.Z,{label:"SSO \u53D1\u8D77\u65B9",name:"initLoginType",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u914D\u7F6E SSO \u53D1\u8D77\u65B9"}],options:[{value:pe.APP,label:"\u53EA\u5141\u8BB8\u5E94\u7528\u53D1\u8D77"},{value:pe.PORTAL_OR_APP,label:"\u652F\u6301\u95E8\u6237\u548C\u5E94\u7528\u53D1\u8D77"}],extra:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:"\u95E8\u6237\u53D1\u8D77\uFF1A\u7531 IAM \u95E8\u6237\u9875\u70B9\u51FB\u8FDB\u884C SSO \u3002"}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:"\u5E94\u7528\u53D1\u8D77\uFF1A\u7531\u5E94\u7528\u767B\u5F55\u4E3B\u52A8\u53D1\u8D77\u3002"})]})}),(0,e.jsx)(me.Z,{name:["initLoginType"],children:function(v){return(v==null?void 0:v.initLoginType)===pe.PORTAL_OR_APP&&(0,e.jsx)(U.Z,{label:"\u767B\u5F55\u53D1\u8D77\u5730\u5740",name:"initLoginUrl",rules:[{required:!0,message:"\u767B\u5F55\u53D1\u8D77\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A"}],fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u94FE\u63A5"},extra:"\u82E5\u60A8\u5E0C\u671B\u7531 TopIAM \u95E8\u6237\u9875\u8BBF\u95EE\u5E94\u7528\uFF0C\u8BF7\u586B\u5199 TopIAM \u53D1\u8D77 SSO \u8BF7\u6C42\u8BBF\u95EE\u7684\u5E94\u7528\u5730\u5740\u3002\u8BE5\u5730\u5740\u63A5\u6536\u5230\u8BF7\u6C42\uFF0C\u5E94\u5373\u523B\u8F6C\u5411 TopIAM / authorize \u6388\u6743\u7AEF\u70B9\u3002"})}}),(0,e.jsx)(W.Z,{style:{margin:0}}),(0,e.jsx)(re.Z,{ghost:!0,expandIconPosition:"start",defaultActiveKey:"advanced",children:(0,e.jsxs)(Oa,{header:(0,e.jsx)("a",{children:"\u663E\u793A\u9AD8\u7EA7\u914D\u7F6E"}),children:[(0,e.jsx)(H.Z.Group,{label:"\u7528\u6237\u4FE1\u606F\u8303\u56F4",layout:"vertical",name:"grantScopes",rules:[{required:!0,message:"\u8BF7\u52FE\u9009\u7528\u6237\u4FE1\u606F\u8303\u56F4"}],extra:"\u7528\u6237\u767B\u5F55\u540E\uFF0C\u4F7F\u7528\u7528\u6237\u4FE1\u606F\u7AEF\u70B9\u6216\u89E3\u6790 id_token \u53EF\u4EE5\u83B7\u53D6\u5230\u7684\u5DF2\u767B\u5F55\u7528\u6237\u4FE1\u606F \u3002",options:[{value:"openid",label:"openid",disabled:!0},{value:"email",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"email"}),(0,e.jsx)("span",{style:{color:"#999"},children:"\u5E94\u7528\u53EF\u83B7\u53D6\u767B\u5F55\u7528\u6237\u90AE\u7BB1\u4FE1\u606F\u3002"})]})},{value:"phone",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"phone"}),(0,e.jsx)("span",{style:{color:"#999"},children:"\u5E94\u7528\u53EF\u83B7\u53D6\u767B\u5F55\u7528\u6237\u624B\u673A\u4FE1\u606F\u3002"})]})},{value:"profile",label:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{marginRight:"12px"},children:"profile"}),(0,e.jsx)("span",{style:{color:"#999"},children:"\u5E94\u7528\u53EF\u83B7\u53D6\u767B\u5F55\u7528\u6237\u8BE6\u60C5\u4FE1\u606F\u3002"})]})}]}),(0,e.jsx)(Me.Z,{label:"access_token \u6709\u6548\u671F",name:"accessTokenTimeToLive",addonAfter:"\u5206\u949F",extra:"access_token \u7528\u4E8E\u8BF7\u6C42 IAM \u63A5\u53E3\uFF0C\u8FC7\u671F\u540E\u9700\u8981\u4F7F\u7528 refresh_token \u5237\u65B0\uFF0C\u6216\u91CD\u65B0\u767B\u5F55\u3002"}),(0,e.jsx)(Me.Z,{label:"refresh_token \u6709\u6548\u671F",name:"refreshTokenTimeToLive",addonAfter:"\u5206\u949F",extra:"\u7528\u4E8E\u83B7\u53D6\u65B0\u7684 access_token \u548C id_token\uFF0Crefresh_token \u8FC7\u671F\u540E\uFF0C\u7528\u6237\u9700\u8981\u91CD\u65B0\u767B\u5F55\u3002"}),(0,e.jsx)(Me.Z,{label:"id_token \u6709\u6548\u671F",readonly:!0,name:"idTokenTimeToLive",addonAfter:"\u5206\u949F\uFF08\u6682\u4E0D\u652F\u6301\u4FEE\u6539\uFF09",extra:"id_token \u7528\u4E8E\u9274\u522B\u7528\u6237\u8EAB\u4EFD\uFF0CJWT\u683C\u5F0F\uFF0C\u5141\u8BB8\u5E94\u7528\u4F7F\u7528\u516C\u94A5\u81EA\u884C\u9A8C\u8BC1\u7528\u6237\u8EAB\u4EFD\u3002\u6700\u5C0F5\u5206\u949F\uFF0C\u6700\u592724\u5C0F\u65F6\uFF0C\u8FC7\u671F\u540E\u9700\u8981\u4F7F\u7528refresh_token \u5237\u65B0\uFF0C\u6216\u91CD\u65B0\u767B\u5F55\u3002"}),(0,e.jsx)(ae.Z,{options:[{value:"ES256",label:"ES256"},{value:"RS256",label:"RS256"}],label:"id_token \u7B7E\u540D\u7B97\u6CD5",name:"idTokenSignatureAlgorithm",allowClear:!1,extra:"id_token \u7B7E\u540D\u4F7F\u7528\u7684\u975E\u5BF9\u79F0\u7B97\u6CD5\u3002",rules:[{required:!0,message:"\u8BF7\u914D\u7F6E id_token \u7B7E\u540D\u7B97\u6CD5"}]})]},"advanced")})]})),(0,e.jsx)(W.Z,{style:{margin:0}}),(0,e.jsx)(Da,{appId:s,protocolEndpoint:u,collapsed:!0})]})})},$a=La,Na=j(79549),pr=j(829),Ma=re.Z.Panel,mr=function(P){var t=J.Z.useForm(),s=$()(t,1),C=s[0],y=P.protocolEndpoint,b=P.appId,h=P.collapsed,k=h===void 0?!0:h;(0,X.Z)(L()(r()().mark(function u(){return r()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:C.setFieldsValue(y);case 1:case"end":return D.stop()}},u)})),[b,y]),(0,X.Z)(L()(r()().mark(function u(){var o;return r()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,M.O$)(b,Oe.SAML_SIGN);case 2:o=x.sent,o.success&&o.result&&o.result.forEach(function(F){F.usingType===Oe.SAML_SIGN&&C.setFieldsValue({idpSignCert:F.cert})});case 4:case"end":return x.stop()}},u)})),[b]);var i=function(){var o=C.getFieldValue("idpSignCert");if(o){var D=new Blob([o],{type:"application/x-x509-ca-cert"}),x=URL.createObjectURL(D),F=document.createElement("a");F.href=x,F.download=b+"sign.cer",document.documentElement.appendChild(F),F.click(),document.documentElement.removeChild(F)}};return(0,e.jsx)(ue.A,{layout:"horizontal",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}},labelAlign:"right",labelWrap:!0,submitter:!1,form:C,scrollToFirstError:!0,children:(0,e.jsx)(re.Z,{ghost:!0,expandIconPosition:"start",defaultActiveKey:k?void 0:"config",children:(0,e.jsx)(Ma,{header:(0,e.jsx)("a",{children:"\u5E94\u7528\u914D\u7F6E\u4FE1\u606F"}),children:(0,e.jsx)(le.Z,{style:{backgroundColor:"#f1f1f2",border:"1px solid #f1f1f2"},description:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(U.Z,{label:"IdP \u5143\u6570\u636E",name:"idpMetaEndpoint",extra:"\u82E5\u5E94\u7528\u652F\u6301 metadata \u914D\u7F6E\u4FE1\u606F\u4E0A\u4F20/\u62C9\u53D6\uFF0C\u53EF\u4EE5\u8282\u7701\u5927\u91CF\u914D\u7F6E\u6B65\u9AA4\u3002\u8BF7\u5728\u5E94\u7528 SSO \u914D\u7F6E\u4E2D\u5BFB\u627E\u662F\u5426\u6709 metadata \u4E0A\u4F20\u80FD\u529B\u3002",proFieldProps:{render:function(o){return o&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ne.Z.Text,{copyable:!0,children:o}),(0,e.jsxs)("a",{style:{whiteSpace:"nowrap",marginLeft:"10px"},onClick:L()(r()().mark(function D(){return r()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,M.zA)(b);case 2:case"end":return F.stop()}},D)})),children:[(0,e.jsx)(pr.Z,{}),"\u4E0B\u8F7D"]})]})}},readonly:!0,fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"IdP \u552F\u4E00\u6807\u8BC6",name:"idpEntityIdEndpoint",extra:"IAM \u5728\u5E94\u7528\u4E2D\u7684\u6807\u8BC6\u3002\u9700\u8981\u5C06\u503C\u586B\u5199\u5728\u5E94\u7528\u5355\u70B9\u767B\u5F55\u914D\u7F6E\u4E2D\u3002",readonly:!0,proFieldProps:{render:function(o){return o&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:o})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"IdP SSO \u5730\u5740",name:"idpSsoEndpoint",extra:"SAML \u534F\u8BAE\u652F\u6301 SP \u53D1\u8D77\u5355\u70B9\u767B\u5F55\uFF0C\u53EF\u80FD\u9700\u8981\u586B\u5199\u6B64\u5730\u5740\u5728\u5E94\u7528\u914D\u7F6E\u4E2D\u3002\u7531 IAM \u63D0\u4F9B\u3002\u53EF\u4EE5\u76F4\u63A5\u8BBF\u95EE\u8BE5\u5730\u5740\uFF0C\u8FDB\u884C\u5E94\u7528\u767B\u5F55\u3002",readonly:!0,proFieldProps:{render:function(o){return o&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:o})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(U.Z,{label:"\u5355\u70B9\u9000\u51FA\u5730\u5740",name:"idpSloEndpoint",extra:"SAML \u534F\u8BAE\u652F\u6301\u5355\u70B9\u9000\u51FA\uFF0C\u53EF\u80FD\u9700\u8981\u586B\u5199\u6B64\u5730\u5740\u5728\u5E94\u7528\u914D\u7F6E\u4E2D\u3002\u7531 IAM \u63D0\u4F9B\u3002",readonly:!0,proFieldProps:{render:function(o){return o&&(0,e.jsx)(ne.Z.Text,{copyable:!0,children:o})}},fieldProps:{autoComplete:"off"}}),(0,e.jsx)(be.Z,{label:"\u7B7E\u540D\u516C\u94A5\u8BC1\u4E66",name:"idpSignCert",disabled:!0,fieldProps:{autoComplete:"off",rows:3},extra:(0,e.jsxs)("div",{style:{display:"inline-block"},children:[(0,e.jsx)("div",{style:{display:"inline-block"},children:"\u4E0B\u8F7D\u6216\u590D\u5236\u8BC1\u4E66\uFF0C\u5E76\u5BFC\u5165\u6216\u7C98\u8D34\u5230\u5E94\u7528\u4E2D\u3002"}),(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,e.jsx)(ne.Z.Paragraph,{style:{display:"inline-block"},copyable:{text:C.getFieldValue("idpSignCert")},children:(0,e.jsx)("a",{children:"\u590D\u5236\u8BC1\u4E66\u5185\u5BB9"})}),(0,e.jsxs)("a",{onClick:i,children:["\u4E0B\u8F7D\u8BC1\u4E66 .cer \u6587\u4EF6",(0,e.jsx)(pr.Z,{})]})]})]})})]})})},"config")})})},Ua=function(P){var t=P.app,s=t.id,C=t.template,y=J.Z.useForm(),b=$()(y,1),h=b[0],k=(0,R.useState)(!0),i=$()(k,2),u=i[0],o=i[1],D=(0,R.useState)([]),x=$()(D,2),F=x[0],w=x[1],I=(0,R.useState)({}),v=$()(I,2),n=v[0],A=v[1];return(0,X.Z)(L()(r()().mark(function a(){var S,c,f;return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return o(!0),(0,M.P3)(C).then(function(l){var d=l.success,E=l.result;d&&w(E)}),p.next=4,(0,M.hq)(s);case 4:S=p.sent,c=S.result,f=S.success,f&&c&&(h.setFieldsValue(N()({},(0,ie.omit)(c,"protocolEndpoint"))),A(c.protocolEndpoint)),o(!1);case 9:case"end":return p.stop()}},a)})),[]),(0,e.jsxs)(se.Z,{spinning:u,children:[(0,e.jsx)(le.Z,{showIcon:!0,message:(0,e.jsxs)(e.Fragment,{children:["\u4E0D\u77E5\u9053\u600E\u4E48\u914D\u7F6E\uFF1F\u8BF7\u53C2\u8003 ",(0,e.jsx)("a",{children:"\u5BF9\u63A5\u6587\u6863 "})," \u3002"]})}),(0,e.jsx)("br",{}),(0,e.jsxs)(ue.A,{requiredMark:!0,layout:"horizontal",labelCol:{span:6},wrapperCol:{span:12},form:h,scrollToFirstError:!0,onFinish:function(){var a=L()(r()().mark(function S(c){var f,g;return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,M.$c)({id:s,template:C,config:(0,ie.omit)(c,"id","template")});case 2:if(f=l.sent,g=f.success,!g){l.next=7;break}return K.ZP.success("\u64CD\u4F5C\u6210\u529F"),l.abrupt("return",!0);case 7:return K.ZP.error("\u64CD\u4F5C\u5931\u8D25"),l.abrupt("return",!1);case 9:case"end":return l.stop()}},S)}));return function(S){return a.apply(this,arguments)}}(),submitter:{render:function(S,c){return(0,e.jsx)(Ie.S,{children:c})}},children:[(0,e.jsx)(Na.Z,{layoutType:"Embed",columns:F,shouldUpdate:!1}),(0,e.jsx)(ae.Z,{label:"\u6388\u6743\u8303\u56F4",name:"authorizationType",allowClear:!1,extra:"\u82E5\u9009\u62E9\u624B\u52A8\u6388\u6743\uFF0C\u9700\u8981\u5728 \u8BBF\u95EE\u6388\u6743 \u4E2D\u8FDB\u884C\u6743\u9650\u5206\u914D\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u8303\u56F4"}],options:[{value:oe.AUTHORIZATION,label:"\u624B\u52A8\u6388\u6743"},{value:oe.ALL_ACCESS,label:"\u5168\u5458\u53EF\u8BBF\u95EE"}]})]}),(0,e.jsx)(W.Z,{style:{margin:0}}),(0,e.jsx)(mr,{appId:s,protocolEndpoint:n,collapsed:!1})]})},Qa=j(69220),za=De.ZP.ConfigContext;function Ga(){var P=(0,R.useContext)(za),t=P.getPrefixCls,s=".".concat(t()),C=(0,ar.l)(function(){return _()({},"".concat(s,"-form-item"),{div:_()({},"".concat(s,"-form-item-control-input"),{width:"100%"})})});return{className:C}}var Ka=j(89804),Ke=j(18477),Ja=re.Z.Panel,fr={labelCol:{xs:{span:24},sm:{span:7},md:{span:6}},wrapperCol:{xs:{span:24},sm:{span:13},md:{span:14}}},Va=function(P){var t=P.app,s=t.id,C=t.template,y=J.Z.useForm(),b=$()(y,1),h=b[0],k=J.Z.useForm(),i=$()(k,1),u=i[0],o=(0,R.useState)(!0),D=$()(o,2),x=D[0],F=D[1],w=(0,R.useState)({}),I=$()(w,2),v=I[0],n=I[1],A=(0,R.useState)(function(){return[]}),a=$()(A,2),S=a[0],c=a[1],f=J.Z.useForm(),g=$()(f,1),p=g[0],l=Ga(),d=l.className,E=function(){var Z=L()(r()().mark(function m(){var T,Q,O,G;return r()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return F(!0),ee.next=3,(0,M.hq)(s);case 3:T=ee.sent,Q=T.result,O=T.success,O&&Q&&(h.setFieldsValue(N()({},(0,ie.omit)(Q,"protocolEndpoint"))),c((G=Q.attributeStatements)===null||G===void 0?void 0:G.map(function(hr){return hr.key})),n(Q.protocolEndpoint)),F(!1);case 8:case"end":return ee.stop()}},m)}));return function(){return Z.apply(this,arguments)}}();(0,X.Z)(L()(r()().mark(function Z(){return r()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,E();case 2:case"end":return T.stop()}},Z)})),[]);var B=function(m){h.setFieldsValue({assertSigned:m.wantAssertionsSigned,spRequestsSigned:m.authnRequestsSigned,spSignCert:m.signCert,spAcsUrl:m.acsUrl,spEntityId:m.entityId,nameIdFormat:m.defaultNameIdFormat,acsBinding:m.defaultAcsBinding,spSloEnabled:m.sloEnabled,spSlsUrl:m.slsUrl,spSlsBinding:m.slsBinding})};return(0,e.jsx)("div",{className:d,children:(0,e.jsxs)(se.Z,{spinning:x,children:[(0,e.jsx)(le.Z,{showIcon:!0,message:(0,e.jsxs)("span",{children:["\u4E0D\u77E5\u9053\u600E\u4E48\u914D\u7F6E\uFF1F\u8BF7\u53C2\u8003 TopIAM \u914D\u7F6E"," ",(0,e.jsx)("a",{target:"_blank",href:"https://eiam.topiam.cn/docs/application/standard/saml2-sso",rel:"noreferrer",children:"SAML \u5355\u70B9\u767B\u5F55"})," ","\u3002"]})}),(0,e.jsx)("br",{}),(0,e.jsx)(ue.A,N()(N()({layout:"horizontal"},fr),{},{form:u,submitter:!1,children:(0,e.jsx)(Qa.Z,{rules:[{type:"url",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u5E94\u7528 metadata \u5730\u5740"}],colon:!1,label:(0,e.jsxs)(he.Z,{children:[(0,e.jsx)(Ka.Z,{showUploadList:!1,name:"file",maxCount:1,beforeUpload:function(){return!1},withCredentials:!0,accept:".xml",onChange:function(){var Z=L()(r()().mark(function T(Q){var O,G,V,ee;return r()().wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:return O=te()(Q.fileList),F(!0),F(!0),Re.next=5,(0,M.ZG)(O==null?void 0:O[0]);case 5:G=Re.sent,V=G.result,ee=G.success,F(!1),ee&&V&&B(V);case 10:case"end":return Re.stop()}},T)}));function m(T){return Z.apply(this,arguments)}return m}(),children:(0,e.jsx)(Fe.ZP,{children:"\u4E0A\u4F20 SP \u5143\u6570\u636E "})}),(0,e.jsx)("span",{children:"\u6216"})]}),name:"metaDataUrl",extra:"SP \u5143\u6570\u636E\u4E3A\u5E94\u7528\u4FA7\u751F\u6210\u7684 SSO \u914D\u7F6E\u6587\u4EF6\u3002\u82E5\u5DF2\u6709\u5143\u6570\u636E\uFF0C\u76F4\u63A5\u5BFC\u5165\uFF0C\u53EF\u81EA\u52A8\u586B\u5145\u4E0B\u65B9 SSO \u53C2\u6570\uFF0C\u7B80\u5355\u5FEB\u6377\u3002",addonAfter:(0,e.jsx)(Fe.ZP,{onClick:L()(r()().mark(function Z(){var m,T,Q,O;return r()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(m=u.getFieldValue("metaDataUrl"),m){V.next=4;break}return K.ZP.error("\u8BF7\u8F93\u5165\u5E94\u7528 metadata \u5730\u5740"),V.abrupt("return");case 4:return V.next=6,u.validateFields();case 6:return F(!0),V.next=9,(0,M.XW)(m);case 9:T=V.sent,Q=T.result,O=T.success,F(!1),O&&Q&&B(Q);case 14:case"end":return V.stop()}},Z)})),children:"\u89E3\u6790"}),children:(0,e.jsx)(or.Z,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528 metadata \u5730\u5740"})})})),(0,e.jsxs)(ue.A,N()(N()({scrollToFirstError:!0,requiredMark:!0,layout:"horizontal"},fr),{},{form:h,onFinish:function(){var Z=L()(r()().mark(function m(T){var Q,O,G;return r()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,p.validateFields();case 2:if(Q=ee.sent,F(!0),!Q){ee.next=15;break}return ee.next=7,(0,M.$c)({id:s,template:C,config:(0,ie.omit)(T,"id","template")}).finally(function(){F(!1)});case 7:if(O=ee.sent,G=O.success,!G){ee.next=14;break}return K.ZP.success("\u4FDD\u5B58\u6210\u529F"),ee.next=13,E();case 13:return ee.abrupt("return",!0);case 14:K.ZP.error("\u4FDD\u5B58\u5931\u8D25");case 15:return F(!1),ee.abrupt("return",!1);case 17:case"end":return ee.stop()}},m)}));return function(m){return Z.apply(this,arguments)}}(),submitter:{render:function(m,T){return(0,e.jsx)(Ie.S,{children:T})}},children:[(0,e.jsx)(U.Z,{label:"ACS URL",name:"spAcsUrl",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u5355\u70B9\u767B\u5F55\u5730\u5740"},extra:"\u5E94\u7528\u7684 SAML SSO \u6838\u5FC3\u5730\u5740\uFF0C\u4E0E IAM \u4EA4\u4E92\u5904\u7406\u5355\u70B9\u767B\u5F55\u8BF7\u6C42\u3002",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5355\u70B9\u767B\u5F55\u5730\u5740"}]}),(0,e.jsx)(U.Z,{label:"SP Entity ID",name:"spEntityId",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u552F\u4E00\u6807\u8BC6"},allowClear:!1,extra:"\u5E94\u7528\u5728 IAM \u4E2D\u7684\u6807\u8BC6\uFF0C\u901A\u5E38\u5728\u5E94\u7528\u4FA7\u83B7\u53D6\uFF0C\u683C\u5F0F\u901A\u5E38\u4E3A\u5E94\u7528 URI\u3002",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5E94\u7528\u552F\u4E00\u6807\u8BC6"}]}),(0,e.jsx)(ae.Z,{label:"Name ID \u7C7B\u578B",name:"nameIdValueType",options:[{value:"user.username",label:"\u7528\u6237\u540D"},{value:"user.fullName",label:"\u7528\u6237\u59D3\u540D"},{value:"user.nickName",label:"\u7528\u6237\u6635\u79F0"},{value:"user.email",label:"\u90AE\u7BB1\u5730\u5740"},{value:"app_user.username",label:"\u5E94\u7528\u8D26\u6237"}],fieldProps:{allowClear:!1},extra:"\u5355\u70B9\u767B\u5F55\u65F6\uFF0C\u5C06\u9009\u4E2D\u9879\u4F5C\u4E3A\u8D26\u6237\u6807\u8BC6\uFF0C\u4F20\u9012\u7ED9\u4E1A\u52A1\u7CFB\u7EDF\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9 Name ID"}]}),(0,e.jsx)(W.Z,{}),(0,e.jsx)(ae.Z,{label:"\u6388\u6743\u8303\u56F4",name:"authorizationType",allowClear:!1,extra:"\u82E5\u9009\u62E9\u624B\u52A8\u6388\u6743\uFF0C\u9700\u8981\u5728 \u8BBF\u95EE\u6388\u6743 \u4E2D\u8FDB\u884C\u6743\u9650\u5206\u914D\u3002",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u8303\u56F4"}],options:[{value:oe.AUTHORIZATION,label:"\u624B\u52A8\u6388\u6743"},{value:oe.ALL_ACCESS,label:"\u5168\u5458\u53EF\u8BBF\u95EE"}]}),(0,e.jsx)(ae.Z,{label:"SSO \u53D1\u8D77\u65B9",name:"initLoginType",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u914D\u7F6E SSO \u53D1\u8D77\u65B9"}],options:[{value:pe.APP,label:"\u53EA\u5141\u8BB8\u5E94\u7528\u53D1\u8D77"},{value:pe.PORTAL_OR_APP,label:"\u652F\u6301\u95E8\u6237\u548C\u5E94\u7528\u53D1\u8D77"}],extra:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:"\u95E8\u6237\u53D1\u8D77\uFF1A\u7531 IAM \u95E8\u6237\u9875\u70B9\u51FB\u8FDB\u884C SSO \u3002"}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:"\u5E94\u7528\u53D1\u8D77\uFF1A\u7531\u5E94\u7528\u767B\u5F55\u4E3B\u52A8\u53D1\u8D77\u3002"})]})}),(0,e.jsx)(me.Z,{name:["initLoginType"],children:function(m){return(0,e.jsx)(U.Z,{label:"\u767B\u5F55\u53D1\u8D77\u5730\u5740",name:"initLoginUrl",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u94FE\u63A5"},extra:"\u82E5\u5E94\u7528\u4EC5\u652F\u6301 SP \u53D1\u8D77 SSO\uFF0C\u60A8\u53C8\u5E0C\u671B\u5B9E\u73B0\u7531 IAM \u95E8\u6237\u9875\u53D1\u8D77\u767B\u5F55\uFF0C\u8BF7\u586B\u5199\u6B64\u9879\u3002\u95E8\u6237\u9875\u8BBF\u95EE\u5E94\u7528\u65F6\uFF0CIAM \u4F1A\u8DF3\u8F6C\u5230\u672C\u5730\u5740\uFF0C\u5E94\u5373\u523B\u81EA\u52A8\u5411 IAM \u53D1\u8D77 SAMLRequest \u767B\u5F55\u8BF7\u6C42\u3002\u5730\u5740\u53EF\u586B\u5199\u4E3A\u4EFB\u610F\u53D7\u4FDD\u62A4\u8D44\u6E90\u8BBF\u95EE\u5730\u5740\uFF0C\u5728\u672A\u767B\u5F55\u65F6\u4F1A\u81EA\u52A8\u89E6\u53D1 SAMLRequest \u5373\u53EF\u3002"})}}),(0,e.jsx)(W.Z,{style:{margin:0}}),(0,e.jsx)(re.Z,{ghost:!0,expandIconPosition:"start",children:(0,e.jsxs)(Ja,{header:(0,e.jsx)("a",{children:"\u663E\u793A\u9AD8\u7EA7\u914D\u7F6E"}),children:[(0,e.jsx)(U.Z,{label:"\u9ED8\u8BA4RelayState",name:"relayState",rules:[{type:"url",message:"RelayState \u683C\u5F0F\u4E0D\u6B63\u786E"}],fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u9ED8\u8BA4\u8DF3\u8F6C\u5730\u5740"},extra:"IDP \u53D1\u8D77 SSO \u767B\u5F55\u6210\u529F\u540E\uFF0C\u5E94\u7528\u5E94\u81EA\u52A8\u8DF3\u8F6C\u7684\u5730\u5740\u3002\u5728 SAML Response \u4E2D\u4F1A\u5728 RelayState \u53C2\u6570\u4E2D\u4F20\u9012\uFF0C\u5E94\u7528\u8BFB\u53D6\u540E\u5B9E\u73B0\u8DF3\u8F6C\u3002"}),(0,e.jsx)(W.Z,{orientation:"left",plain:!0,children:"\u65AD\u8A00"}),(0,e.jsx)(U.Z,{label:"Audience",name:"audience",allowClear:!1,extra:"SAML\u65AD\u8A00\u7684\u76EE\u6807\u53D7\u4F17\uFF0C\u9ED8\u8BA4\u548CSP Entity ID\u76F8\u540C\u3002",placeholder:"\u8BF7\u8F93\u5165SAML\u65AD\u8A00\u7684\u76EE\u6807\u53D7\u4F17"}),(0,e.jsx)(ae.Z,{label:"NameID \u683C\u5F0F",name:"nameIdFormat",allowClear:!1,initialValue:"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified",rules:[{required:!0,message:"\u8BF7\u9009\u62E9 NameID \u5B57\u6BB5\u683C\u5F0F"}],extra:"SAML Response \u4E2D\u6307\u5B9A\u8D26\u6237\u6807\u8BC6 NameID \u5B57\u6BB5\u683C\u5F0F\u3002",options:[{value:"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified",label:"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified"},{value:"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress",label:"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"},{value:"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent",label:"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"},{value:"urn:oasis:names:tc:SAML:2.0:nameid-format:transient",label:"urn:oasis:names:tc:SAML:2.0:nameid-format:transient"}]}),(0,e.jsx)(ae.Z,{label:"ACS \u7ED1\u5B9A\u7C7B\u578B",name:"acsBinding",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9 ACS \u7ED1\u5B9A\u7C7B\u578B"}],extra:" \u6307\u5B9AIDP\u5411SP\u53D1\u9001\u65AD\u8A00\u8BF7\u6C42\u7684\u65B9\u5F0F\u3002",options:[{value:"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST",label:"HTTP-POST"},{value:"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect",label:"HTTP-Redirect"}]}),(0,e.jsx)(Ze.Z,{label:"\u662F\u5426\u52A0\u5BC6\u65AD\u8A00",name:"assertEncrypted",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u5BF9\u65AD\u8A00\u52A0\u5BC6"}]}),(0,e.jsx)(me.Z,{name:["assertEncrypted"],children:function(m){var T=m.assertEncrypted;return T&&(0,e.jsx)(ae.Z,{label:"\u65AD\u8A00\u52A0\u5BC6\u7B97\u6CD5",name:"assertEncryptAlgorithm",extra:"\u65AD\u8A00\u52A0\u5BC6\u4F7F\u7528\u7684\u7B97\u6CD5",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u65AD\u8A00\u52A0\u5BC6\u4F7F\u7528\u7684\u7B97\u6CD5"}],options:[{value:"http://www.w3.org/2001/04/xmlenc#aes128-cbc",label:"AES128-CBC"},{value:"http://www.w3.org/2001/04/xmlenc#aes256-cbc",label:"AES256-CBC"}]})}}),(0,e.jsx)(Ze.Z,{label:"\u662F\u5426\u7B7E\u540D\u65AD\u8A00",name:"assertSigned",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u5BF9\u65AD\u8A00\u7B7E\u540D"}],initialValue:!0,extra:"\u662F\u5426\u5BF9\u65AD\u8A00\u4F7F\u7528IdP\u7684\u8BC1\u4E66\u7B7E\u540D\uFF0C\u5BF9\u5E94SP\u5143\u6570\u636E\u6587\u4EF6\u4E2D\u201CWantAssertionsSigned\u201D\u503C\u3002"}),(0,e.jsx)(me.Z,{name:["assertSigned"],children:function(m){var T=m.assertSigned;return T&&(0,e.jsx)(ae.Z,{label:"\u65AD\u8A00\u7B7E\u540D\u7B97\u6CD5",name:"assertSignAlgorithm",extra:"\u65AD\u8A00\u7B7E\u540D\u4F7F\u7528\u7684\u7B97\u6CD5",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7B7E\u540D\u4F7F\u7528\u7684\u7B97\u6CD5"}],options:[{value:"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256",label:"RSA-SHA256"}]})}}),(0,e.jsx)(ae.Z,{label:"\u8EAB\u4EFD\u8BA4\u8BC1\u4E0A\u4E0B\u6587",name:"authnContextClassRef",extra:"SAML \u8EAB\u4EFD\u8BA4\u8BC1\u4E0A\u4E0B\u6587",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8EAB\u4EFD\u8BA4\u8BC1\u4E0A\u4E0B\u6587"}],options:[{value:"urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified",label:(0,e.jsx)(Ke.Z,{title:"urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified",placement:"topLeft",children:(0,e.jsx)("span",{children:"urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified"})})},{value:"urn:oasis:names:tc:SAML:2.0:ac:classes:Password",label:(0,e.jsx)(Ke.Z,{placement:"topLeft",title:"urn:oasis:names:tc:SAML:2.0:ac:classes:Password",children:(0,e.jsx)("span",{children:"urn:oasis:names:tc:SAML:2.0:ac:classes:Password"})})},{value:"urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport",label:(0,e.jsx)(Ke.Z,{placement:"topLeft",title:"urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport",children:(0,e.jsx)("span",{children:"urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"})})}]}),(0,e.jsx)(ue.A.Item,{label:"\u65AD\u8A00\u5C5E\u6027",name:"attributeStatements",trigger:"onValuesChange",children:(0,e.jsx)($e.Z,{rowKey:"key",toolBarRender:!1,scroll:{x:500},columns:[{title:"\u5C5E\u6027\u540D\u79F0",dataIndex:"name",fieldProps:{allowClear:!1},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u540D\u79F0\u683C\u5F0F",key:"nameFormat",dataIndex:"nameFormat",valueType:"select",ellipsis:!0,valueEnum:{"urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified":{text:"unspecified"},"urn:oasis:names:tc:SAML:2.0:attrname-format:basic":{text:"basic"},"urn:oasis:names:tc:SAML:2.0:attrname-format:uri":{text:"uri"}},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u5C5E\u6027\u503C",tooltip:"\u652F\u6301\u7684\u53D8\u91CF\uFF1A${user.phone}\u3001${user.username}\u3001${user.email}\u3001${app_user.nickName}\u3001${app_user.username}",dataIndex:"valueExpression",fieldProps:{allowClear:!1,placeholder:"\u53D8\u91CF\u503C"},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u64CD\u4F5C",valueType:"option",align:"center",fixed:"right",width:50}],recordCreatorProps:{creatorButtonText:"\u6DFB\u52A0\u65AD\u8A00\u5C5E\u6027",newRecordType:"dataSource",position:"bottom",record:function(){return{key:Date.now()}}},editable:{form:p,type:"multiple",editableKeys:S,onChange:c,deletePopconfirmMessage:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u6B64\u65AD\u8A00\u5C5E\u6027\u5417\uFF1F",actionRender:function(m,T,Q){return[Q.delete]}}})}),(0,e.jsx)(W.Z,{orientation:"left",plain:!0,children:"\u54CD\u5E94\u7B7E\u540D"}),(0,e.jsx)(Ze.Z,{label:"\u662F\u5426\u7B7E\u540D\u54CD\u5E94",name:"responseSigned",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u5BF9\u54CD\u5E94\u7B7E\u540D"}],initialValue:!1}),(0,e.jsx)(me.Z,{name:["responseSigned"],children:function(m){var T=m.responseSigned;return T&&(0,e.jsx)(ae.Z,{label:"\u54CD\u5E94\u7B7E\u540D\u7B97\u6CD5",name:"responseSignAlgorithm",extra:"\u65AD\u8A00\u54CD\u5E94\u4F7F\u7528\u7684\u7B97\u6CD5",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u54CD\u5E94\u7B7E\u540D\u4F7F\u7528\u7684\u7B97\u6CD5"}],options:[{value:"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256",label:"RSA-SHA256"}]})}}),(0,e.jsx)(W.Z,{orientation:"left",plain:!0,children:"\u9A8C\u8BC1\u8BF7\u6C42"}),(0,e.jsx)(Ze.Z,{label:"\u9A8C\u8BC1\u8BF7\u6C42\u7B7E\u540D",name:"spRequestsSigned",initialValue:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u9A8C\u8BC1\u8BF7\u6C42\u7B7E\u540D"}],extra:"\u7528\u6765\u5BF9SAML Request\u7B7E\u540D\u8FDB\u884C\u9A8C\u8BC1\uFF0C\u5BF9\u5E94SP\u5143\u6570\u636E\u6587\u4EF6\u4E2D\u201CAuthnRequestsSigned\u201D\u503C\u3002"}),(0,e.jsx)(W.Z,{orientation:"left",plain:!0,children:"\u5355\u70B9\u6CE8\u9500"}),(0,e.jsx)(Ze.Z,{label:"\u542F\u7528 SLO",name:"spSloEnabled",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u542F\u7528 SLO"}],initialValue:!1,extra:"SP \u662F\u5426\u652F\u6301\u5355\u70B9\u6CE8\u9500 (SLO) \u3002"}),(0,e.jsx)(me.Z,{name:["spSloEnabled"],children:function(m){var T=m.spSloEnabled;return T&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(U.Z,{label:"\u5355\u70B9\u6CE8\u9500 URL",name:"spSlsUrl",rules:[{type:"url",message:"\u5355\u70B9\u6CE8\u9500\u5730\u5740\u683C\u5F0F\u4E0D\u6B63\u786E"},{required:!0,message:"\u8BF7\u8F93\u5165\u5355\u70B9\u6CE8\u9500\u5730\u5740"}],allowClear:!0,extra:"\u4F1A\u8BDD\u6CE8\u9500\u529F\u80FD\uFF0C\u7528\u6237\u5728 TopIAM \u6CE8\u9500\u4F1A\u8BDD\u540E\u901A\u77E5\u8BE5\u5730\u5740\u3002",placeholder:"\u8BF7\u8F93\u5165\u5355\u70B9\u6CE8\u9500\u5730\u5740"}),(0,e.jsx)(ae.Z,{label:"\u5355\u70B9\u6CE8\u9500\u7ED1\u5B9A\u7C7B\u578B",name:"spSlsBinding",allowClear:!1,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5355\u70B9\u6CE8\u9500\u7ED1\u5B9A\u7C7B\u578B"}],extra:" \u6307\u5B9A\u4E86 IDP \u5411 SP \u53D1\u9001 SLO \u8BF7\u6C42\u7684\u65B9\u5F0F\u3002",options:[{value:"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST",label:"HTTP-POST"},{value:"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect",label:"HTTP-Redirect"}]})]})}}),(0,e.jsx)(W.Z,{}),(0,e.jsx)(be.Z,{label:"\u7B7E\u540D\u8BC1\u4E66",name:"spSignCert",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u9A8C\u8BC1\u7B7E\u540D\u8BC1\u4E66"}],extra:'SP\u516C\u94A5\u8BC1\u4E66\uFF0C\u7528\u6765\u9A8C\u8BC1SAML request\u7684\u7B7E\u540D\uFF0C\u5BF9\u5E94SP\u5143\u6570\u636E\u6587\u4EF6\u4E2Duse="signing"\u8BC1\u4E66\u5185\u5BB9\u3002',fieldProps:{autoComplete:"off",rows:3}})]},"advanced")})]})),(0,e.jsx)(W.Z,{style:{margin:0}}),(0,e.jsx)(mr,{appId:s,protocolEndpoint:v,collapsed:!0})]})})},Ya=function(P){var t=P.app;return(0,e.jsxs)(e.Fragment,{children:[t.type===Y.pR.CUSTOM_MADE&&(0,e.jsx)(Ua,{app:t}),t.type===Y.pR.STANDARD&&(0,e.jsx)(Va,{app:t})]})},Ha=Ya,qa=function(P){var t=P.appId,s=(0,R.useState)(!0),C=$()(s,2),y=C[0],b=C[1],h=(0,R.useState)(),k=$()(h,2),i=k[0],u=k[1];return(0,X.Z)(L()(r()().mark(function o(){var D,x,F;return r()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return b(!0),I.next=3,(0,M.Mq)(t);case 3:D=I.sent,x=D.result,F=D.success,F&&x&&u(x),b(!1);case 8:case"end":return I.stop()}},o)})),[]),(0,e.jsx)(ze.Z,{title:"\u5355\u70B9\u767B\u5F55",style:{height:"calc(100vh - 190px)",overflow:"auto"},bodyStyle:{height:"100%"},headerBordered:!0,children:(0,e.jsxs)(rr.Z,{loading:y,active:!0,paragraph:{rows:5},children:[(i==null?void 0:i.protocol)===Y.gD.SAML2&&(0,e.jsx)(Ha,{app:i}),(i==null?void 0:i.protocol)===Y.gD.CAS&&(0,e.jsx)(Ea,{app:i}),(i==null?void 0:i.protocol)===Y.gD.JWT&&(0,e.jsx)(Ia,{app:i}),(i==null?void 0:i.protocol)===Y.gD.OIDC&&(0,e.jsx)($a,{app:i}),(i==null?void 0:i.protocol)===Y.gD.FORM&&(0,e.jsx)(Za,{app:i})]})})},Xa=De.ZP.ConfigContext,Wa=function(t){var s,C,y,b,h,k,i,u,o,D,x,F,w,I,v=t.prefixCls,n=t.antCls;return I={},_()(I,"".concat(v),(F={},_()(F,"&-main",{display:"flex"}),_()(F,"&-left",_()({minHeight:"100%",overflow:"auto",marginRight:t.margin,width:"200px"},"&-menu",(x={height:"calc(100vh - 190px)"},_()(x,"&".concat(n,"-menu-light").concat(n,"-menu-root").concat(n,"-menu-inline"),{"border-inline-end":"none"}),_()(x,"&".concat(n,"-menu-light:not(").concat(n,"-menu-horizontal) ").concat(n,"-menu-item-selected"),{"background-color":(s=t.layout)===null||s===void 0||(C=s.sider)===null||C===void 0?void 0:C.colorBgMenuItemSelected,color:(y=t.layout)===null||y===void 0||(b=y.sider)===null||b===void 0?void 0:b.colorTextMenuSelected}),_()(x,"&".concat(n,"-menu-light:not(").concat(n,"-menu-horizontal) ").concat(n,"-menu-item:not(").concat(n,"-menu-item-selected):active"),{"background-color":(h=t.layout)===null||h===void 0||(k=h.sider)===null||k===void 0?void 0:k.colorBgMenuItemSelected,color:(i=t.layout)===null||i===void 0||(u=i.sider)===null||u===void 0?void 0:u.colorTextMenuActive}),_()(x,"&".concat(n,"-menu-light ").concat(n,"-menu-submenu-selected >").concat(n,"-menu-submenu-title"),{color:(o=t.layout)===null||o===void 0||(D=o.sider)===null||D===void 0?void 0:D.colorTextMenuSelected}),x))),_()(F,"&-right",{flex:1,minHeight:"100%",overflow:"auto"}),F)),_()(I,"@media screen and (max-width: ".concat(t.screenXL,"px)"),_()({},"".concat(v),(w={},_()(w,"&-main",{flexDirection:"column"}),_()(w,"&-left",_()({width:"100%",border:"none",marginRight:0,marginBottom:t.margin},"&-menu",{height:"auto"})),w))),I};function _a(P){var t=(0,R.useContext)(Xa),s=t.getPrefixCls,C=".".concat(s());return(0,qe.Xj)("AppConfig",function(y){var b=N()(N()({},y),{},{prefixCls:".".concat(P),antCls:C});return[Wa(b)]})}var we="app-config",en=function(){var P=(0,R.useState)(),t=$()(P,2),s=t[0],C=t[1],y=(0,R.useState)(),b=$()(y,2),h=b[0],k=b[1],i=(0,Ge.useLocation)(),u=_a(we),o=u.wrapSSR,D=u.hashId,x=(0,R.useState)({mode:"inline"}),F=$()(x,2),w=F[0],I=F[1],v=(0,R.useRef)(),n=function(){requestAnimationFrame(function(){if(v.current){var d="inline";window.innerWidth<1200&&(d="horizontal"),I(N()(N()({},w),{},{mode:d}))}})};(0,R.useLayoutEffect)(function(){return v.current&&(window.addEventListener("resize",n),n()),function(){window.removeEventListener("resize",n)}},[n]);var A=ke.Z.parse(i.search),a=A,S=a.type,c=a.id,f=a.name,g=a.protocol,p=[{key:q.BASIC,label:"\u57FA\u672C\u914D\u7F6E",icon:R.createElement(function(){return(0,e.jsx)(vr.Z,{})})},{key:q.LOGIN_ACCESS,label:"\u767B\u5F55\u8BBF\u95EE",icon:R.createElement(function(){return(0,e.jsx)(gr.Z,{})}),children:[{key:q.PROTOCOL_CONFIG,label:"\u5355\u70B9\u767B\u5F55"}].concat(te()(!g||g===Y.gD.OIDC?[]:[{key:q.APP_ACCOUNT,label:"\u5E94\u7528\u8D26\u6237"}]),[{key:q.ACCESS_POLICY,label:"\u8BBF\u95EE\u6388\u6743"}])},{key:q.ACCOUNT_SYNC,label:"\u8D26\u6237\u540C\u6B65",icon:R.createElement(function(){return(0,e.jsx)(Ar.Z,{})})},{key:q.APP_PERMISSION,label:"\u6743\u9650\u7BA1\u7406",icon:R.createElement(function(){return(0,e.jsx)(Fr.Z,{})}),children:[{key:q.PERMISSION_RESOURCE,label:"\u8D44\u6E90\u7BA1\u7406"},{key:q.PERMISSION_ROLE,label:"\u89D2\u8272\u7BA1\u7406"},{key:q.PERMISSION_POLICY,label:"\u6388\u6743\u7BA1\u7406"}]}];return(0,X.Z)(L()(r()().mark(function l(){return r()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(!c||!g)){E.next=4;break}return K.ZP.error("\u672A\u6307\u5B9A\u5E94\u7528"),Be.m.push("/app"),E.abrupt("return");case 4:if(!(!S||!(S.toUpperCase()in q))){E.next=8;break}return C([q.PROTOCOL_CONFIG]),Be.m.replace({pathname:i.pathname,search:ke.Z.stringify({type:q.PROTOCOL_CONFIG,id:c,protocol:g,name:f})}),E.abrupt("return");case 8:C([S]);case 9:case"end":return E.stop()}},l)})),[]),(0,X.Z)(L()(r()().mark(function l(){return r()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:k(A.name);case 1:case"end":return E.stop()}},l)})),[i]),o((0,e.jsx)(Cr._z,{title:h,style:{overflow:"hidden"},onBack:function(){Be.m.push("/app")},children:(0,e.jsx)(xr.f,{children:(0,e.jsxs)("div",{className:je()("".concat(we,"-main"),D),ref:function(d){d&&(v.current=d)},children:[(0,e.jsx)("div",{className:je()("".concat(we,"-left"),D),children:(0,e.jsx)(Er.Z,{mode:w.mode,selectedKeys:s,className:je()("".concat(we,"-left-menu"),D),items:p,onSelect:function(d){var E=d.selectedKeys;C(E),Be.m.replace({pathname:i.pathname,search:ke.Z.stringify({type:E==null?void 0:E[0],id:c,protocol:g,name:f})})}})}),(0,e.jsxs)("div",{className:je()("".concat(we,"-right"),D),children:[(s==null?void 0:s[0])===q.BASIC&&(0,e.jsx)(Yr,{appId:c}),(s==null?void 0:s[0])===q.PROTOCOL_CONFIG&&(0,e.jsx)(qa,{appId:c}),(s==null?void 0:s[0])===q.APP_ACCOUNT&&(0,e.jsx)(Kr,{appId:c,protocol:g}),(s==null?void 0:s[0])===q.ACCESS_POLICY&&(0,e.jsx)(Ur,{appId:c}),(s==null?void 0:s[0])===q.ACCOUNT_SYNC&&(0,e.jsx)(Qr,{}),(s==null?void 0:s[0])===q.PERMISSION_RESOURCE&&(0,e.jsx)(ia,{appId:c}),(s==null?void 0:s[0])===q.PERMISSION_ROLE&&(0,e.jsx)(ga,{appId:c}),(s==null?void 0:s[0])===q.PERMISSION_POLICY&&(0,e.jsx)(aa,{appId:c})]})]})})}))},rn=en}}]);
